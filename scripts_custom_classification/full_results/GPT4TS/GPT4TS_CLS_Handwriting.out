Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.158933162689209
Epoch: 1, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.385 Vali Acc: 0.044 Test Loss: 3.385 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 2.501065969467163
Epoch: 2, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.351 Vali Acc: 0.104 Test Loss: 3.351 Test Acc: 0.104
Validation loss decreased (-0.043496 --> -0.103496).  Saving model ...
Epoch: 3 cost time: 2.533907651901245
Epoch: 3, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.265 Vali Acc: 0.113 Test Loss: 3.265 Test Acc: 0.113
Validation loss decreased (-0.103496 --> -0.112909).  Saving model ...
Epoch: 4 cost time: 2.581109046936035
Epoch: 4, Steps: 10 | Train Loss: 2.467 Vali Loss: 3.152 Vali Acc: 0.121 Test Loss: 3.152 Test Acc: 0.121
Validation loss decreased (-0.112909 --> -0.121145).  Saving model ...
Epoch: 5 cost time: 2.2691192626953125
Epoch: 5, Steps: 10 | Train Loss: 1.994 Vali Loss: 3.259 Vali Acc: 0.178 Test Loss: 3.259 Test Acc: 0.178
Validation loss decreased (-0.121145 --> -0.177614).  Saving model ...
Epoch: 6 cost time: 1.5337960720062256
Epoch: 6, Steps: 10 | Train Loss: 1.441 Vali Loss: 3.473 Vali Acc: 0.188 Test Loss: 3.473 Test Acc: 0.188
Validation loss decreased (-0.177614 --> -0.188201).  Saving model ...
Epoch: 7 cost time: 2.208739995956421
Epoch: 7, Steps: 10 | Train Loss: 0.959 Vali Loss: 4.243 Vali Acc: 0.220 Test Loss: 4.243 Test Acc: 0.220
Validation loss decreased (-0.188201 --> -0.219958).  Saving model ...
Epoch: 8 cost time: 2.2369227409362793
Epoch: 8, Steps: 10 | Train Loss: 0.548 Vali Loss: 5.013 Vali Acc: 0.226 Test Loss: 5.013 Test Acc: 0.226
Validation loss decreased (-0.219958 --> -0.225832).  Saving model ...
Epoch: 9 cost time: 2.2915518283843994
Epoch: 9, Steps: 10 | Train Loss: 0.209 Vali Loss: 6.001 Vali Acc: 0.256 Test Loss: 6.001 Test Acc: 0.256
Validation loss decreased (-0.225832 --> -0.256411).  Saving model ...
Epoch: 10 cost time: 2.1816606521606445
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 6.891 Vali Acc: 0.214 Test Loss: 6.891 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.35640287399292
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 7.544 Vali Acc: 0.235 Test Loss: 7.544 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.204801082611084
Epoch: 12, Steps: 10 | Train Loss: 0.129 Vali Loss: 7.932 Vali Acc: 0.245 Test Loss: 7.932 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5778183937072754
Epoch: 13, Steps: 10 | Train Loss: 0.130 Vali Loss: 7.846 Vali Acc: 0.244 Test Loss: 7.846 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3590004444122314
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 8.641 Vali Acc: 0.246 Test Loss: 8.641 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.404043674468994
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 8.425 Vali Acc: 0.261 Test Loss: 8.425 Test Acc: 0.261
Validation loss decreased (-0.256411 --> -0.261092).  Saving model ...
Epoch: 16 cost time: 2.163910150527954
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 9.714 Vali Acc: 0.246 Test Loss: 9.714 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2669193744659424
Epoch: 17, Steps: 10 | Train Loss: 0.139 Vali Loss: 9.627 Vali Acc: 0.238 Test Loss: 9.627 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0068724155426025
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 9.979 Vali Acc: 0.238 Test Loss: 9.979 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5486271381378174
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 10.558 Vali Acc: 0.241 Test Loss: 10.558 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1479170322418213
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 10.855 Vali Acc: 0.238 Test Loss: 10.855 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.651824712753296
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 11.427 Vali Acc: 0.221 Test Loss: 11.427 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8449211120605469
Epoch: 22, Steps: 10 | Train Loss: 0.096 Vali Loss: 11.596 Vali Acc: 0.220 Test Loss: 11.596 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7684240341186523
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 12.058 Vali Acc: 0.216 Test Loss: 12.058 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2349483966827393
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 12.882 Vali Acc: 0.214 Test Loss: 12.882 Test Acc: 0.214
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9738781452178955
Epoch: 25, Steps: 10 | Train Loss: 0.052 Vali Loss: 12.373 Vali Acc: 0.227 Test Loss: 12.373 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 45013274
model size : 186.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9088053703308105
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.316 Vali Acc: 0.046 Test Loss: 3.316 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.38238525390625
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.387 Vali Acc: 0.069 Test Loss: 3.387 Test Acc: 0.069
Validation loss decreased (-0.045849 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 1.448850154876709
Epoch: 3, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.266 Vali Acc: 0.095 Test Loss: 3.266 Test Acc: 0.095
Validation loss decreased (-0.069378 --> -0.095261).  Saving model ...
Epoch: 4 cost time: 1.8898577690124512
Epoch: 4, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.225 Vali Acc: 0.125 Test Loss: 3.225 Test Acc: 0.125
Validation loss decreased (-0.095261 --> -0.124674).  Saving model ...
Epoch: 5 cost time: 1.4999258518218994
Epoch: 5, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.252 Vali Acc: 0.133 Test Loss: 3.252 Test Acc: 0.133
Validation loss decreased (-0.124674 --> -0.132909).  Saving model ...
Epoch: 6 cost time: 1.959712028503418
Epoch: 6, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.163 Vali Acc: 0.207 Test Loss: 3.163 Test Acc: 0.207
Validation loss decreased (-0.132909 --> -0.207027).  Saving model ...
Epoch: 7 cost time: 2.3214356899261475
Epoch: 7, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.730 Vali Acc: 0.185 Test Loss: 3.730 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7935011386871338
Epoch: 8, Steps: 10 | Train Loss: 0.988 Vali Loss: 4.151 Vali Acc: 0.215 Test Loss: 4.151 Test Acc: 0.215
Validation loss decreased (-0.207027 --> -0.215253).  Saving model ...
Epoch: 9 cost time: 1.7374153137207031
Epoch: 9, Steps: 10 | Train Loss: 0.508 Vali Loss: 4.389 Vali Acc: 0.252 Test Loss: 4.389 Test Acc: 0.252
Validation loss decreased (-0.215253 --> -0.251721).  Saving model ...
Epoch: 10 cost time: 1.8446757793426514
Epoch: 10, Steps: 10 | Train Loss: 0.293 Vali Loss: 4.823 Vali Acc: 0.240 Test Loss: 4.823 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.091430902481079
Epoch: 11, Steps: 10 | Train Loss: 0.235 Vali Loss: 5.202 Vali Acc: 0.242 Test Loss: 5.202 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5997731685638428
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 5.511 Vali Acc: 0.254 Test Loss: 5.511 Test Acc: 0.254
Validation loss decreased (-0.251721 --> -0.254063).  Saving model ...
Epoch: 13 cost time: 1.4013957977294922
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.756 Vali Acc: 0.274 Test Loss: 5.756 Test Acc: 0.274
Validation loss decreased (-0.254063 --> -0.274060).  Saving model ...
Epoch: 14 cost time: 1.5213675498962402
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.974 Vali Acc: 0.269 Test Loss: 5.974 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.31187105178833
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.831 Vali Acc: 0.291 Test Loss: 5.831 Test Acc: 0.291
Validation loss decreased (-0.274060 --> -0.290530).  Saving model ...
Epoch: 16 cost time: 1.376173973083496
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.080 Vali Acc: 0.284 Test Loss: 6.080 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.609619379043579
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.099 Vali Acc: 0.291 Test Loss: 6.099 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6353206634521484
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 6.282 Vali Acc: 0.275 Test Loss: 6.282 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4141592979431152
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.516 Vali Acc: 0.285 Test Loss: 6.516 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9461307525634766
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.581 Vali Acc: 0.286 Test Loss: 6.581 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4312810897827148
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.457 Vali Acc: 0.269 Test Loss: 6.457 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8437445163726807
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.627 Vali Acc: 0.268 Test Loss: 6.627 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7061679363250732
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.448 Vali Acc: 0.293 Test Loss: 6.448 Test Acc: 0.293
Validation loss decreased (-0.290530 --> -0.292877).  Saving model ...
Epoch: 24 cost time: 1.5761148929595947
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.669 Vali Acc: 0.284 Test Loss: 6.669 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.596879482269287
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.679 Vali Acc: 0.276 Test Loss: 6.679 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.447439432144165
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.663 Vali Acc: 0.291 Test Loss: 6.663 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3316476345062256
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.643 Vali Acc: 0.286 Test Loss: 6.643 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5042071342468262
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.592 Vali Acc: 0.293 Test Loss: 6.592 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3251962661743164
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.586 Vali Acc: 0.291 Test Loss: 6.586 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2861289978027344
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.596 Vali Acc: 0.292 Test Loss: 6.596 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2819187641143799
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.571 Vali Acc: 0.292 Test Loss: 6.571 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.494727373123169
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.568 Vali Acc: 0.291 Test Loss: 6.568 Test Acc: 0.291
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1091501712799072
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.568 Vali Acc: 0.298 Test Loss: 6.568 Test Acc: 0.298
Validation loss decreased (-0.292877 --> -0.297581).  Saving model ...
Epoch: 34 cost time: 1.6611368656158447
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.564 Vali Acc: 0.298 Test Loss: 6.564 Test Acc: 0.298
Validation loss decreased (-0.297581 --> -0.297581).  Saving model ...
Epoch: 35 cost time: 1.6269111633300781
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.568 Vali Acc: 0.296 Test Loss: 6.568 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8593838214874268
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.553 Vali Acc: 0.296 Test Loss: 6.553 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6636216640472412
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.550 Vali Acc: 0.298 Test Loss: 6.550 Test Acc: 0.298
Validation loss decreased (-0.297581 --> -0.297582).  Saving model ...
Epoch: 38 cost time: 1.4787976741790771
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.547 Vali Acc: 0.295 Test Loss: 6.547 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3847925662994385
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.554 Vali Acc: 0.298 Test Loss: 6.554 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.026057243347168
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.558 Vali Acc: 0.300 Test Loss: 6.558 Test Acc: 0.300
Validation loss decreased (-0.297582 --> -0.299934).  Saving model ...
Epoch: 41 cost time: 1.9455440044403076
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.522 Vali Acc: 0.301 Test Loss: 6.522 Test Acc: 0.301
Validation loss decreased (-0.299934 --> -0.301111).  Saving model ...
Epoch: 42 cost time: 1.8972179889678955
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.506 Vali Acc: 0.299 Test Loss: 6.506 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6320722103118896
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.511 Vali Acc: 0.301 Test Loss: 6.511 Test Acc: 0.301
Validation loss decreased (-0.301111 --> -0.301111).  Saving model ...
Epoch: 44 cost time: 1.6593635082244873
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.514 Vali Acc: 0.300 Test Loss: 6.514 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5010643005371094
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.519 Vali Acc: 0.299 Test Loss: 6.519 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.8744587898254395
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.529 Vali Acc: 0.301 Test Loss: 6.529 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8580553531646729
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.566 Vali Acc: 0.299 Test Loss: 6.566 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2510411739349365
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.582 Vali Acc: 0.296 Test Loss: 6.582 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2108941078186035
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.596 Vali Acc: 0.295 Test Loss: 6.596 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8776819705963135
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.593 Vali Acc: 0.299 Test Loss: 6.593 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 44239130
model size : 183.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.996741533279419
Epoch: 1, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.301 Vali Acc: 0.051 Test Loss: 3.301 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.7843372821807861
Epoch: 2, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.333 Vali Acc: 0.062 Test Loss: 3.333 Test Acc: 0.062
Validation loss decreased (-0.050555 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 1.6740870475769043
Epoch: 3, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.326 Vali Acc: 0.080 Test Loss: 3.326 Test Acc: 0.080
Validation loss decreased (-0.062320 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 1.7126593589782715
Epoch: 4, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.240 Vali Acc: 0.100 Test Loss: 3.240 Test Acc: 0.100
Validation loss decreased (-0.079967 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 1.2594902515411377
Epoch: 5, Steps: 10 | Train Loss: 2.605 Vali Loss: 3.205 Vali Acc: 0.124 Test Loss: 3.205 Test Acc: 0.124
Validation loss decreased (-0.099968 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 0.9449963569641113
Epoch: 6, Steps: 10 | Train Loss: 2.296 Vali Loss: 3.154 Vali Acc: 0.171 Test Loss: 3.154 Test Acc: 0.171
Validation loss decreased (-0.123497 --> -0.170557).  Saving model ...
Epoch: 7 cost time: 1.2398087978363037
Epoch: 7, Steps: 10 | Train Loss: 1.772 Vali Loss: 3.255 Vali Acc: 0.194 Test Loss: 3.255 Test Acc: 0.194
Validation loss decreased (-0.170557 --> -0.194085).  Saving model ...
Epoch: 8 cost time: 1.1495957374572754
Epoch: 8, Steps: 10 | Train Loss: 1.315 Vali Loss: 3.531 Vali Acc: 0.195 Test Loss: 3.531 Test Acc: 0.195
Validation loss decreased (-0.194085 --> -0.195259).  Saving model ...
Epoch: 9 cost time: 0.8008337020874023
Epoch: 9, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.786 Vali Acc: 0.225 Test Loss: 3.786 Test Acc: 0.225
Validation loss decreased (-0.195259 --> -0.224668).  Saving model ...
Epoch: 10 cost time: 1.4829366207122803
Epoch: 10, Steps: 10 | Train Loss: 0.617 Vali Loss: 4.025 Vali Acc: 0.242 Test Loss: 4.025 Test Acc: 0.242
Validation loss decreased (-0.224668 --> -0.242313).  Saving model ...
Epoch: 11 cost time: 1.3300843238830566
Epoch: 11, Steps: 10 | Train Loss: 0.307 Vali Loss: 4.134 Vali Acc: 0.279 Test Loss: 4.134 Test Acc: 0.279
Validation loss decreased (-0.242313 --> -0.278782).  Saving model ...
Epoch: 12 cost time: 1.3707220554351807
Epoch: 12, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.446 Vali Acc: 0.259 Test Loss: 4.446 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7440357208251953
Epoch: 13, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.562 Vali Acc: 0.284 Test Loss: 4.562 Test Acc: 0.284
Validation loss decreased (-0.278782 --> -0.283484).  Saving model ...
Epoch: 14 cost time: 1.806532859802246
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.733 Vali Acc: 0.281 Test Loss: 4.733 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6279182434082031
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.790 Vali Acc: 0.289 Test Loss: 4.790 Test Acc: 0.289
Validation loss decreased (-0.283484 --> -0.289364).  Saving model ...
Epoch: 16 cost time: 1.2932662963867188
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.912 Vali Acc: 0.286 Test Loss: 4.912 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1390917301177979
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.952 Vali Acc: 0.296 Test Loss: 4.952 Test Acc: 0.296
Validation loss decreased (-0.289364 --> -0.296421).  Saving model ...
Epoch: 18 cost time: 1.1427016258239746
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.101 Vali Acc: 0.289 Test Loss: 5.101 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7939651012420654
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.364 Vali Acc: 0.286 Test Loss: 5.364 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6185259819030762
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.201 Vali Acc: 0.293 Test Loss: 5.201 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1465497016906738
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.176 Vali Acc: 0.294 Test Loss: 5.176 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.327620506286621
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.345 Vali Acc: 0.293 Test Loss: 5.345 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.193861961364746
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.264 Vali Acc: 0.293 Test Loss: 5.264 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6641857624053955
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.287 Vali Acc: 0.293 Test Loss: 5.287 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.528486728668213
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.278 Vali Acc: 0.305 Test Loss: 5.278 Test Acc: 0.305
Validation loss decreased (-0.296421 --> -0.304653).  Saving model ...
Epoch: 26 cost time: 1.7966690063476562
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.317 Vali Acc: 0.302 Test Loss: 5.317 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9633374214172363
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.343 Vali Acc: 0.304 Test Loss: 5.343 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9160797595977783
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.309 Vali Acc: 0.301 Test Loss: 5.309 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1823885440826416
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.291 Vali Acc: 0.301 Test Loss: 5.291 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.560570240020752
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.350 Vali Acc: 0.301 Test Loss: 5.350 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2862253189086914
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.278 Vali Acc: 0.304 Test Loss: 5.278 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3859217166900635
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.293 Vali Acc: 0.308 Test Loss: 5.293 Test Acc: 0.308
Validation loss decreased (-0.304653 --> -0.308182).  Saving model ...
Epoch: 33 cost time: 0.9633162021636963
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.298 Vali Acc: 0.311 Test Loss: 5.298 Test Acc: 0.311
Validation loss decreased (-0.308182 --> -0.310535).  Saving model ...
Epoch: 34 cost time: 1.697265386581421
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.326 Vali Acc: 0.312 Test Loss: 5.326 Test Acc: 0.312
Validation loss decreased (-0.310535 --> -0.311711).  Saving model ...
Epoch: 35 cost time: 1.5168519020080566
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.349 Vali Acc: 0.309 Test Loss: 5.349 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6491482257843018
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.396 Vali Acc: 0.309 Test Loss: 5.396 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4225294589996338
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.409 Vali Acc: 0.313 Test Loss: 5.409 Test Acc: 0.313
Validation loss decreased (-0.311711 --> -0.312887).  Saving model ...
Epoch: 38 cost time: 1.720484733581543
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.421 Vali Acc: 0.311 Test Loss: 5.421 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8983290195465088
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.437 Vali Acc: 0.309 Test Loss: 5.437 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8579800128936768
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.472 Vali Acc: 0.309 Test Loss: 5.472 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.578089952468872
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.484 Vali Acc: 0.311 Test Loss: 5.484 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.822646141052246
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.436 Vali Acc: 0.304 Test Loss: 5.436 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4699504375457764
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.428 Vali Acc: 0.307 Test Loss: 5.428 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3349614143371582
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.421 Vali Acc: 0.307 Test Loss: 5.421 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.6782803535461426
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.441 Vali Acc: 0.306 Test Loss: 5.441 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.609013319015503
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.480 Vali Acc: 0.308 Test Loss: 5.480 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.5023601055145264
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.555 Vali Acc: 0.302 Test Loss: 5.555 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 43895066
model size : 182.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4741458892822266
Epoch: 1, Steps: 10 | Train Loss: 3.486 Vali Loss: 3.351 Vali Acc: 0.062 Test Loss: 3.351 Test Acc: 0.062
Validation loss decreased (inf --> -0.062319).  Saving model ...
Epoch: 2 cost time: 1.65134859085083
Epoch: 2, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.368 Vali Acc: 0.069 Test Loss: 3.368 Test Acc: 0.069
Validation loss decreased (-0.062319 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 1.8050036430358887
Epoch: 3, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.237 Vali Acc: 0.101 Test Loss: 3.237 Test Acc: 0.101
Validation loss decreased (-0.069378 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 2.143372058868408
Epoch: 4, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.259 Vali Acc: 0.158 Test Loss: 3.259 Test Acc: 0.158
Validation loss decreased (-0.101144 --> -0.157614).  Saving model ...
Epoch: 5 cost time: 2.3026771545410156
Epoch: 5, Steps: 10 | Train Loss: 2.137 Vali Loss: 3.139 Vali Acc: 0.185 Test Loss: 3.139 Test Acc: 0.185
Validation loss decreased (-0.157614 --> -0.184674).  Saving model ...
Epoch: 6 cost time: 2.2343075275421143
Epoch: 6, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.441 Vali Acc: 0.216 Test Loss: 3.441 Test Acc: 0.216
Validation loss decreased (-0.184674 --> -0.216436).  Saving model ...
Epoch: 7 cost time: 2.310831069946289
Epoch: 7, Steps: 10 | Train Loss: 0.807 Vali Loss: 4.123 Vali Acc: 0.229 Test Loss: 4.123 Test Acc: 0.229
Validation loss decreased (-0.216436 --> -0.229371).  Saving model ...
Epoch: 8 cost time: 2.2984395027160645
Epoch: 8, Steps: 10 | Train Loss: 0.427 Vali Loss: 5.386 Vali Acc: 0.224 Test Loss: 5.386 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2975852489471436
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 5.963 Vali Acc: 0.252 Test Loss: 5.963 Test Acc: 0.252
Validation loss decreased (-0.229371 --> -0.251705).  Saving model ...
Epoch: 10 cost time: 1.718193531036377
Epoch: 10, Steps: 10 | Train Loss: 0.194 Vali Loss: 6.462 Vali Acc: 0.264 Test Loss: 6.462 Test Acc: 0.264
Validation loss decreased (-0.251705 --> -0.263465).  Saving model ...
Epoch: 11 cost time: 1.7567408084869385
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 7.548 Vali Acc: 0.251 Test Loss: 7.548 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8749940395355225
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 7.455 Vali Acc: 0.266 Test Loss: 7.455 Test Acc: 0.266
Validation loss decreased (-0.263465 --> -0.265808).  Saving model ...
Epoch: 13 cost time: 1.8171279430389404
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 8.249 Vali Acc: 0.252 Test Loss: 8.249 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8342950344085693
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 8.234 Vali Acc: 0.269 Test Loss: 8.234 Test Acc: 0.269
Validation loss decreased (-0.265808 --> -0.269329).  Saving model ...
Epoch: 15 cost time: 2.153000831604004
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 8.689 Vali Acc: 0.274 Test Loss: 8.689 Test Acc: 0.274
Validation loss decreased (-0.269329 --> -0.274031).  Saving model ...
Epoch: 16 cost time: 1.9989559650421143
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 8.804 Vali Acc: 0.274 Test Loss: 8.804 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2049787044525146
Epoch: 17, Steps: 10 | Train Loss: 0.077 Vali Loss: 9.804 Vali Acc: 0.215 Test Loss: 9.804 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.03471302986145
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 9.263 Vali Acc: 0.272 Test Loss: 9.263 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8188412189483643
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 9.941 Vali Acc: 0.264 Test Loss: 9.941 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4429333209991455
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 10.169 Vali Acc: 0.246 Test Loss: 10.169 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.608891248703003
Epoch: 21, Steps: 10 | Train Loss: 0.129 Vali Loss: 9.820 Vali Acc: 0.280 Test Loss: 9.820 Test Acc: 0.280
Validation loss decreased (-0.274031 --> -0.279902).  Saving model ...
Epoch: 22 cost time: 1.8589606285095215
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 10.290 Vali Acc: 0.265 Test Loss: 10.290 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4818859100341797
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 10.478 Vali Acc: 0.261 Test Loss: 10.478 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8612041473388672
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 10.588 Vali Acc: 0.273 Test Loss: 10.588 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8718299865722656
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 12.794 Vali Acc: 0.234 Test Loss: 12.794 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.264556646347046
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 12.236 Vali Acc: 0.258 Test Loss: 12.236 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.129138469696045
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 12.668 Vali Acc: 0.242 Test Loss: 12.668 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.071815252304077
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 12.709 Vali Acc: 0.260 Test Loss: 12.709 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1967976093292236
Epoch: 29, Steps: 10 | Train Loss: 0.073 Vali Loss: 12.387 Vali Acc: 0.256 Test Loss: 12.387 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.983607292175293
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 13.889 Vali Acc: 0.248 Test Loss: 13.889 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.739964485168457
Epoch: 31, Steps: 10 | Train Loss: 0.224 Vali Loss: 13.166 Vali Acc: 0.279 Test Loss: 13.166 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 45020186
model size : 186.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2076876163482666
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.348 Vali Acc: 0.040 Test Loss: 3.348 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.4495794773101807
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.383 Vali Acc: 0.078 Test Loss: 3.383 Test Acc: 0.078
Validation loss decreased (-0.039967 --> -0.077613).  Saving model ...
Epoch: 3 cost time: 1.3720102310180664
Epoch: 3, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.269 Vali Acc: 0.096 Test Loss: 3.269 Test Acc: 0.096
Validation loss decreased (-0.077613 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 1.7420234680175781
Epoch: 4, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.293 Vali Acc: 0.104 Test Loss: 3.293 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103496).  Saving model ...
Epoch: 5 cost time: 1.3509867191314697
Epoch: 5, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.146 Vali Acc: 0.142 Test Loss: 3.146 Test Acc: 0.142
Validation loss decreased (-0.103496 --> -0.142321).  Saving model ...
Epoch: 6 cost time: 1.6545507907867432
Epoch: 6, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.263 Vali Acc: 0.176 Test Loss: 3.263 Test Acc: 0.176
Validation loss decreased (-0.142321 --> -0.176438).  Saving model ...
Epoch: 7 cost time: 1.5507452487945557
Epoch: 7, Steps: 10 | Train Loss: 1.385 Vali Loss: 3.473 Vali Acc: 0.220 Test Loss: 3.473 Test Acc: 0.220
Validation loss decreased (-0.176438 --> -0.219965).  Saving model ...
Epoch: 8 cost time: 1.4182779788970947
Epoch: 8, Steps: 10 | Train Loss: 0.884 Vali Loss: 4.092 Vali Acc: 0.249 Test Loss: 4.092 Test Acc: 0.249
Validation loss decreased (-0.219965 --> -0.249371).  Saving model ...
Epoch: 9 cost time: 1.4803097248077393
Epoch: 9, Steps: 10 | Train Loss: 0.578 Vali Loss: 4.463 Vali Acc: 0.253 Test Loss: 4.463 Test Acc: 0.253
Validation loss decreased (-0.249371 --> -0.252897).  Saving model ...
Epoch: 10 cost time: 1.6770365238189697
Epoch: 10, Steps: 10 | Train Loss: 0.346 Vali Loss: 4.628 Vali Acc: 0.271 Test Loss: 4.628 Test Acc: 0.271
Validation loss decreased (-0.252897 --> -0.270542).  Saving model ...
Epoch: 11 cost time: 1.7703986167907715
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 5.113 Vali Acc: 0.272 Test Loss: 5.113 Test Acc: 0.272
Validation loss decreased (-0.270542 --> -0.271714).  Saving model ...
Epoch: 12 cost time: 1.4812586307525635
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 5.174 Vali Acc: 0.285 Test Loss: 5.174 Test Acc: 0.285
Validation loss decreased (-0.271714 --> -0.284654).  Saving model ...
Epoch: 13 cost time: 1.6208984851837158
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 5.940 Vali Acc: 0.273 Test Loss: 5.940 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1586577892303467
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.917 Vali Acc: 0.271 Test Loss: 5.917 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1613361835479736
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 6.164 Vali Acc: 0.285 Test Loss: 6.164 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.304368257522583
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.320 Vali Acc: 0.278 Test Loss: 6.320 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4200966358184814
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.342 Vali Acc: 0.288 Test Loss: 6.342 Test Acc: 0.288
Validation loss decreased (-0.284654 --> -0.288172).  Saving model ...
Epoch: 18 cost time: 1.1572370529174805
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.255 Vali Acc: 0.292 Test Loss: 6.255 Test Acc: 0.292
Validation loss decreased (-0.288172 --> -0.291702).  Saving model ...
Epoch: 19 cost time: 1.3549222946166992
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.194 Vali Acc: 0.311 Test Loss: 6.194 Test Acc: 0.311
Validation loss decreased (-0.291702 --> -0.310526).  Saving model ...
Epoch: 20 cost time: 1.414017677307129
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.394 Vali Acc: 0.301 Test Loss: 6.394 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5046570301055908
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.678 Vali Acc: 0.288 Test Loss: 6.678 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.470625400543213
Epoch: 22, Steps: 10 | Train Loss: 0.102 Vali Loss: 6.633 Vali Acc: 0.294 Test Loss: 6.633 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7449045181274414
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.588 Vali Acc: 0.293 Test Loss: 6.588 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6333696842193604
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.575 Vali Acc: 0.307 Test Loss: 6.575 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4755194187164307
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.678 Vali Acc: 0.294 Test Loss: 6.678 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0968379974365234
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.056 Vali Acc: 0.271 Test Loss: 7.056 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1994938850402832
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 7.251 Vali Acc: 0.289 Test Loss: 7.251 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1378648281097412
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.357 Vali Acc: 0.288 Test Loss: 7.357 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1423323154449463
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.204 Vali Acc: 0.292 Test Loss: 7.204 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 44246042
model size : 183.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.464451551437378
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.291 Vali Acc: 0.045 Test Loss: 3.291 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.8180112838745117
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.380 Vali Acc: 0.067 Test Loss: 3.380 Test Acc: 0.067
Validation loss decreased (-0.044673 --> -0.067025).  Saving model ...
Epoch: 3 cost time: 1.483027458190918
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.356 Vali Acc: 0.074 Test Loss: 3.356 Test Acc: 0.074
Validation loss decreased (-0.067025 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 1.5730433464050293
Epoch: 4, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.258 Vali Acc: 0.109 Test Loss: 3.258 Test Acc: 0.109
Validation loss decreased (-0.074084 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 1.7337944507598877
Epoch: 5, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.212 Vali Acc: 0.115 Test Loss: 3.212 Test Acc: 0.115
Validation loss decreased (-0.109379 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 1.5429050922393799
Epoch: 6, Steps: 10 | Train Loss: 2.507 Vali Loss: 3.135 Vali Acc: 0.145 Test Loss: 3.135 Test Acc: 0.145
Validation loss decreased (-0.115262 --> -0.144675).  Saving model ...
Epoch: 7 cost time: 1.7156267166137695
Epoch: 7, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.169 Vali Acc: 0.161 Test Loss: 3.169 Test Acc: 0.161
Validation loss decreased (-0.144675 --> -0.161145).  Saving model ...
Epoch: 8 cost time: 1.3515040874481201
Epoch: 8, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.274 Vali Acc: 0.213 Test Loss: 3.274 Test Acc: 0.213
Validation loss decreased (-0.161145 --> -0.212908).  Saving model ...
Epoch: 9 cost time: 1.3355810642242432
Epoch: 9, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.549 Vali Acc: 0.228 Test Loss: 3.549 Test Acc: 0.228
Validation loss decreased (-0.212908 --> -0.228200).  Saving model ...
Epoch: 10 cost time: 1.5744285583496094
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.763 Vali Acc: 0.254 Test Loss: 3.763 Test Acc: 0.254
Validation loss decreased (-0.228200 --> -0.254080).  Saving model ...
Epoch: 11 cost time: 1.506859540939331
Epoch: 11, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.875 Vali Acc: 0.265 Test Loss: 3.875 Test Acc: 0.265
Validation loss decreased (-0.254080 --> -0.264667).  Saving model ...
Epoch: 12 cost time: 1.1335530281066895
Epoch: 12, Steps: 10 | Train Loss: 0.333 Vali Loss: 4.089 Vali Acc: 0.280 Test Loss: 4.089 Test Acc: 0.280
Validation loss decreased (-0.264667 --> -0.279959).  Saving model ...
Epoch: 13 cost time: 1.5876874923706055
Epoch: 13, Steps: 10 | Train Loss: 0.170 Vali Loss: 4.425 Vali Acc: 0.272 Test Loss: 4.425 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7516214847564697
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.529 Vali Acc: 0.304 Test Loss: 4.529 Test Acc: 0.304
Validation loss decreased (-0.279959 --> -0.303484).  Saving model ...
Epoch: 15 cost time: 1.3889498710632324
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.592 Vali Acc: 0.299 Test Loss: 4.592 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5675506591796875
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.655 Vali Acc: 0.306 Test Loss: 4.655 Test Acc: 0.306
Validation loss decreased (-0.303484 --> -0.305836).  Saving model ...
Epoch: 17 cost time: 1.6758098602294922
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.795 Vali Acc: 0.312 Test Loss: 4.795 Test Acc: 0.312
Validation loss decreased (-0.305836 --> -0.311717).  Saving model ...
Epoch: 18 cost time: 1.4013879299163818
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.974 Vali Acc: 0.305 Test Loss: 4.974 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9975922107696533
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.962 Vali Acc: 0.305 Test Loss: 4.962 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6287727355957031
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.962 Vali Acc: 0.306 Test Loss: 4.962 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6821000576019287
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.147 Vali Acc: 0.302 Test Loss: 5.147 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9433677196502686
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.144 Vali Acc: 0.296 Test Loss: 5.144 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1587278842926025
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.196 Vali Acc: 0.313 Test Loss: 5.196 Test Acc: 0.313
Validation loss decreased (-0.311717 --> -0.312889).  Saving model ...
Epoch: 24 cost time: 1.1307201385498047
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.258 Vali Acc: 0.309 Test Loss: 5.258 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9488353729248047
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.146 Vali Acc: 0.327 Test Loss: 5.146 Test Acc: 0.327
Validation loss decreased (-0.312889 --> -0.327007).  Saving model ...
Epoch: 26 cost time: 1.4013023376464844
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.106 Vali Acc: 0.319 Test Loss: 5.106 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7229866981506348
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.126 Vali Acc: 0.322 Test Loss: 5.126 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5934488773345947
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.182 Vali Acc: 0.322 Test Loss: 5.182 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9901726245880127
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.188 Vali Acc: 0.322 Test Loss: 5.188 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.161449670791626
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.201 Vali Acc: 0.328 Test Loss: 5.201 Test Acc: 0.328
Validation loss decreased (-0.327007 --> -0.328183).  Saving model ...
Epoch: 31 cost time: 1.5131733417510986
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.241 Vali Acc: 0.325 Test Loss: 5.241 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0050766468048096
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.232 Vali Acc: 0.329 Test Loss: 5.232 Test Acc: 0.329
Validation loss decreased (-0.328183 --> -0.329359).  Saving model ...
Epoch: 33 cost time: 1.5634922981262207
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.234 Vali Acc: 0.333 Test Loss: 5.234 Test Acc: 0.333
Validation loss decreased (-0.329359 --> -0.332889).  Saving model ...
Epoch: 34 cost time: 1.2058494091033936
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.370 Vali Acc: 0.327 Test Loss: 5.370 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.284602165222168
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.342 Vali Acc: 0.331 Test Loss: 5.342 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9496738910675049
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.380 Vali Acc: 0.336 Test Loss: 5.380 Test Acc: 0.336
Validation loss decreased (-0.332889 --> -0.336417).  Saving model ...
Epoch: 37 cost time: 0.9089109897613525
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.358 Vali Acc: 0.327 Test Loss: 5.358 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6768403053283691
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.670 Vali Acc: 0.302 Test Loss: 5.670 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0053625106811523
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.624 Vali Acc: 0.311 Test Loss: 5.624 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.016932725906372
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.382 Vali Acc: 0.329 Test Loss: 5.382 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3290729522705078
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.331 Vali Acc: 0.325 Test Loss: 5.331 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.365044355392456
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.337 Vali Acc: 0.326 Test Loss: 5.337 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.483630657196045
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.353 Vali Acc: 0.331 Test Loss: 5.353 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.627298355102539
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.356 Vali Acc: 0.335 Test Loss: 5.356 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.5925841331481934
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.366 Vali Acc: 0.340 Test Loss: 5.366 Test Acc: 0.340
Validation loss decreased (-0.336417 --> -0.339946).  Saving model ...
Epoch: 46 cost time: 1.5741815567016602
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.368 Vali Acc: 0.340 Test Loss: 5.368 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.64107084274292
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.366 Vali Acc: 0.335 Test Loss: 5.366 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.6211156845092773
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.369 Vali Acc: 0.335 Test Loss: 5.369 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.322392463684082
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.381 Vali Acc: 0.335 Test Loss: 5.381 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.416386365890503
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.392 Vali Acc: 0.341 Test Loss: 5.392 Test Acc: 0.341
Validation loss decreased (-0.339946 --> -0.341123).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 43858970
model size : 181.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3961706161499023
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.358 Vali Acc: 0.049 Test Loss: 3.358 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 1.88502836227417
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.389 Vali Acc: 0.088 Test Loss: 3.389 Test Acc: 0.088
Validation loss decreased (-0.049378 --> -0.088201).  Saving model ...
Epoch: 3 cost time: 1.9847297668457031
Epoch: 3, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.301 Vali Acc: 0.086 Test Loss: 3.301 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5342752933502197
Epoch: 4, Steps: 10 | Train Loss: 2.632 Vali Loss: 3.215 Vali Acc: 0.140 Test Loss: 3.215 Test Acc: 0.140
Validation loss decreased (-0.088201 --> -0.139968).  Saving model ...
Epoch: 5 cost time: 1.722405195236206
Epoch: 5, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.170 Vali Acc: 0.145 Test Loss: 3.170 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144674).  Saving model ...
Epoch: 6 cost time: 1.6697947978973389
Epoch: 6, Steps: 10 | Train Loss: 1.622 Vali Loss: 3.417 Vali Acc: 0.193 Test Loss: 3.417 Test Acc: 0.193
Validation loss decreased (-0.144674 --> -0.192907).  Saving model ...
Epoch: 7 cost time: 1.6212244033813477
Epoch: 7, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.985 Vali Acc: 0.189 Test Loss: 3.985 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3739104270935059
Epoch: 8, Steps: 10 | Train Loss: 0.654 Vali Loss: 4.419 Vali Acc: 0.238 Test Loss: 4.419 Test Acc: 0.238
Validation loss decreased (-0.192907 --> -0.237603).  Saving model ...
Epoch: 9 cost time: 1.5842583179473877
Epoch: 9, Steps: 10 | Train Loss: 0.311 Vali Loss: 4.922 Vali Acc: 0.242 Test Loss: 4.922 Test Acc: 0.242
Validation loss decreased (-0.237603 --> -0.242304).  Saving model ...
Epoch: 10 cost time: 1.3192589282989502
Epoch: 10, Steps: 10 | Train Loss: 0.227 Vali Loss: 6.136 Vali Acc: 0.206 Test Loss: 6.136 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4144635200500488
Epoch: 11, Steps: 10 | Train Loss: 0.188 Vali Loss: 5.704 Vali Acc: 0.260 Test Loss: 5.704 Test Acc: 0.260
Validation loss decreased (-0.242304 --> -0.259943).  Saving model ...
Epoch: 12 cost time: 1.4284765720367432
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 6.364 Vali Acc: 0.256 Test Loss: 6.364 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6920585632324219
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.481 Vali Acc: 0.279 Test Loss: 6.481 Test Acc: 0.279
Validation loss decreased (-0.259943 --> -0.278759).  Saving model ...
Epoch: 14 cost time: 1.686406135559082
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 6.837 Vali Acc: 0.251 Test Loss: 6.837 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5267512798309326
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 7.371 Vali Acc: 0.264 Test Loss: 7.371 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1980552673339844
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 7.472 Vali Acc: 0.273 Test Loss: 7.472 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.24686598777771
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 7.345 Vali Acc: 0.265 Test Loss: 7.345 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4300251007080078
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 7.778 Vali Acc: 0.244 Test Loss: 7.778 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.414025068283081
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 7.562 Vali Acc: 0.272 Test Loss: 7.562 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1803009510040283
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 7.863 Vali Acc: 0.253 Test Loss: 7.863 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.283736228942871
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.040 Vali Acc: 0.266 Test Loss: 8.040 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.726708173751831
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.925 Vali Acc: 0.285 Test Loss: 7.925 Test Acc: 0.285
Validation loss decreased (-0.278759 --> -0.284627).  Saving model ...
Epoch: 23 cost time: 1.147765874862671
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.814 Vali Acc: 0.288 Test Loss: 7.814 Test Acc: 0.288
Validation loss decreased (-0.284627 --> -0.288157).  Saving model ...
Epoch: 24 cost time: 1.4233627319335938
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.851 Vali Acc: 0.292 Test Loss: 7.851 Test Acc: 0.292
Validation loss decreased (-0.288157 --> -0.291686).  Saving model ...
Epoch: 25 cost time: 1.4318571090698242
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.298 Vali Acc: 0.254 Test Loss: 8.298 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3539671897888184
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.186 Vali Acc: 0.275 Test Loss: 8.186 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2784273624420166
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 8.181 Vali Acc: 0.282 Test Loss: 8.181 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2079284191131592
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 8.475 Vali Acc: 0.266 Test Loss: 8.475 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.246361255645752
Epoch: 29, Steps: 10 | Train Loss: 0.067 Vali Loss: 8.628 Vali Acc: 0.248 Test Loss: 8.628 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3008060455322266
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.624 Vali Acc: 0.261 Test Loss: 8.624 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6886637210845947
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.676 Vali Acc: 0.252 Test Loss: 8.676 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5682778358459473
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 9.161 Vali Acc: 0.254 Test Loss: 9.161 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4965760707855225
Epoch: 33, Steps: 10 | Train Loss: 0.203 Vali Loss: 8.822 Vali Acc: 0.259 Test Loss: 8.822 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2115919589996338
Epoch: 34, Steps: 10 | Train Loss: 0.102 Vali Loss: 9.389 Vali Acc: 0.218 Test Loss: 9.389 Test Acc: 0.218
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2917647058823529
model parameter : 44489498
model size : 184.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7175588607788086
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.324 Vali Acc: 0.046 Test Loss: 3.324 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.1426997184753418
Epoch: 2, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.389 Vali Acc: 0.080 Test Loss: 3.389 Test Acc: 0.080
Validation loss decreased (-0.045849 --> -0.079966).  Saving model ...
Epoch: 3 cost time: 1.3803086280822754
Epoch: 3, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.307 Vali Acc: 0.079 Test Loss: 3.307 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1195335388183594
Epoch: 4, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.257 Vali Acc: 0.109 Test Loss: 3.257 Test Acc: 0.109
Validation loss decreased (-0.079966 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 1.09273362159729
Epoch: 5, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.213 Vali Acc: 0.131 Test Loss: 3.213 Test Acc: 0.131
Validation loss decreased (-0.109379 --> -0.130556).  Saving model ...
Epoch: 6 cost time: 1.4116573333740234
Epoch: 6, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.220 Vali Acc: 0.166 Test Loss: 3.220 Test Acc: 0.166
Validation loss decreased (-0.130556 --> -0.165850).  Saving model ...
Epoch: 7 cost time: 1.2110929489135742
Epoch: 7, Steps: 10 | Train Loss: 1.607 Vali Loss: 3.367 Vali Acc: 0.191 Test Loss: 3.367 Test Acc: 0.191
Validation loss decreased (-0.165850 --> -0.190555).  Saving model ...
Epoch: 8 cost time: 1.466609001159668
Epoch: 8, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.715 Vali Acc: 0.220 Test Loss: 3.715 Test Acc: 0.220
Validation loss decreased (-0.190555 --> -0.219963).  Saving model ...
Epoch: 9 cost time: 1.348982334136963
Epoch: 9, Steps: 10 | Train Loss: 0.670 Vali Loss: 4.227 Vali Acc: 0.219 Test Loss: 4.227 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.201207160949707
Epoch: 10, Steps: 10 | Train Loss: 0.455 Vali Loss: 4.317 Vali Acc: 0.258 Test Loss: 4.317 Test Acc: 0.258
Validation loss decreased (-0.219963 --> -0.257604).  Saving model ...
Epoch: 11 cost time: 0.913536548614502
Epoch: 11, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.534 Vali Acc: 0.254 Test Loss: 4.534 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0960156917572021
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.794 Vali Acc: 0.284 Test Loss: 4.794 Test Acc: 0.284
Validation loss decreased (-0.257604 --> -0.283481).  Saving model ...
Epoch: 13 cost time: 1.1820788383483887
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 5.546 Vali Acc: 0.268 Test Loss: 5.546 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0442845821380615
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 5.343 Vali Acc: 0.293 Test Loss: 5.343 Test Acc: 0.293
Validation loss decreased (-0.283481 --> -0.292888).  Saving model ...
Epoch: 15 cost time: 1.0678901672363281
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.534 Vali Acc: 0.286 Test Loss: 5.534 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.333085060119629
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.585 Vali Acc: 0.296 Test Loss: 5.585 Test Acc: 0.296
Validation loss decreased (-0.292888 --> -0.296415).  Saving model ...
Epoch: 17 cost time: 1.2001335620880127
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.646 Vali Acc: 0.293 Test Loss: 5.646 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3446509838104248
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.716 Vali Acc: 0.284 Test Loss: 5.716 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1437702178955078
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.900 Vali Acc: 0.299 Test Loss: 5.900 Test Acc: 0.299
Validation loss decreased (-0.296415 --> -0.298765).  Saving model ...
Epoch: 20 cost time: 1.1419517993927002
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.121 Vali Acc: 0.294 Test Loss: 6.121 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6084413528442383
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.756 Vali Acc: 0.305 Test Loss: 5.756 Test Acc: 0.305
Validation loss decreased (-0.298765 --> -0.304648).  Saving model ...
Epoch: 22 cost time: 1.3527872562408447
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.751 Vali Acc: 0.304 Test Loss: 5.751 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2998311519622803
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.758 Vali Acc: 0.313 Test Loss: 5.758 Test Acc: 0.313
Validation loss decreased (-0.304648 --> -0.312884).  Saving model ...
Epoch: 24 cost time: 1.118326187133789
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.738 Vali Acc: 0.311 Test Loss: 5.738 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4570181369781494
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.751 Vali Acc: 0.306 Test Loss: 5.751 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2267310619354248
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.788 Vali Acc: 0.313 Test Loss: 5.788 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4256823062896729
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.824 Vali Acc: 0.308 Test Loss: 5.824 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1940608024597168
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.820 Vali Acc: 0.306 Test Loss: 5.820 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1607015132904053
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.795 Vali Acc: 0.306 Test Loss: 5.795 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.298267126083374
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.783 Vali Acc: 0.307 Test Loss: 5.783 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2998058795928955
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.880 Vali Acc: 0.296 Test Loss: 5.880 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6565184593200684
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.392 Vali Acc: 0.282 Test Loss: 6.392 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9581198692321777
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.123 Vali Acc: 0.302 Test Loss: 6.123 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 44080922
model size : 182.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9556634426116943
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.328 Vali Acc: 0.058 Test Loss: 3.328 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.6120667457580566
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.327 Vali Acc: 0.059 Test Loss: 3.327 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.6847946643829346
Epoch: 3, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.336 Vali Acc: 0.073 Test Loss: 3.336 Test Acc: 0.073
Validation loss decreased (-0.058790 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.6447358131408691
Epoch: 4, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.285 Vali Acc: 0.089 Test Loss: 3.285 Test Acc: 0.089
Validation loss decreased (-0.072908 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 0.6560978889465332
Epoch: 5, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.233 Vali Acc: 0.099 Test Loss: 3.233 Test Acc: 0.099
Validation loss decreased (-0.089379 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 1.0857768058776855
Epoch: 6, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.190 Vali Acc: 0.133 Test Loss: 3.190 Test Acc: 0.133
Validation loss decreased (-0.098791 --> -0.132909).  Saving model ...
Epoch: 7 cost time: 0.7457828521728516
Epoch: 7, Steps: 10 | Train Loss: 2.259 Vali Loss: 3.182 Vali Acc: 0.151 Test Loss: 3.182 Test Acc: 0.151
Validation loss decreased (-0.132909 --> -0.150556).  Saving model ...
Epoch: 8 cost time: 0.7993662357330322
Epoch: 8, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.314 Vali Acc: 0.191 Test Loss: 3.314 Test Acc: 0.191
Validation loss decreased (-0.150556 --> -0.190555).  Saving model ...
Epoch: 9 cost time: 1.0486857891082764
Epoch: 9, Steps: 10 | Train Loss: 1.371 Vali Loss: 3.392 Vali Acc: 0.218 Test Loss: 3.392 Test Acc: 0.218
Validation loss decreased (-0.190555 --> -0.217613).  Saving model ...
Epoch: 10 cost time: 0.892963171005249
Epoch: 10, Steps: 10 | Train Loss: 0.959 Vali Loss: 3.667 Vali Acc: 0.245 Test Loss: 3.667 Test Acc: 0.245
Validation loss decreased (-0.217613 --> -0.244669).  Saving model ...
Epoch: 11 cost time: 0.6670172214508057
Epoch: 11, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.799 Vali Acc: 0.235 Test Loss: 3.799 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.950037956237793
Epoch: 12, Steps: 10 | Train Loss: 0.353 Vali Loss: 4.056 Vali Acc: 0.266 Test Loss: 4.056 Test Acc: 0.266
Validation loss decreased (-0.244669 --> -0.265842).  Saving model ...
Epoch: 13 cost time: 1.0090382099151611
Epoch: 13, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.198 Vali Acc: 0.267 Test Loss: 4.198 Test Acc: 0.267
Validation loss decreased (-0.265842 --> -0.267017).  Saving model ...
Epoch: 14 cost time: 0.8059356212615967
Epoch: 14, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.619 Vali Acc: 0.247 Test Loss: 4.619 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.675635576248169
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.559 Vali Acc: 0.273 Test Loss: 4.559 Test Acc: 0.273
Validation loss decreased (-0.267017 --> -0.272896).  Saving model ...
Epoch: 16 cost time: 0.8227143287658691
Epoch: 16, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.666 Vali Acc: 0.273 Test Loss: 4.666 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6603612899780273
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.714 Vali Acc: 0.280 Test Loss: 4.714 Test Acc: 0.280
Validation loss decreased (-0.272896 --> -0.279953).  Saving model ...
Epoch: 18 cost time: 1.3123493194580078
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.834 Vali Acc: 0.275 Test Loss: 4.834 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.805356502532959
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.883 Vali Acc: 0.281 Test Loss: 4.883 Test Acc: 0.281
Validation loss decreased (-0.279953 --> -0.281128).  Saving model ...
Epoch: 20 cost time: 0.9000818729400635
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.887 Vali Acc: 0.284 Test Loss: 4.887 Test Acc: 0.284
Validation loss decreased (-0.281128 --> -0.283481).  Saving model ...
Epoch: 21 cost time: 1.1271045207977295
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.183 Vali Acc: 0.279 Test Loss: 5.183 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3651413917541504
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.035 Vali Acc: 0.298 Test Loss: 5.035 Test Acc: 0.298
Validation loss decreased (-0.283481 --> -0.297597).  Saving model ...
Epoch: 23 cost time: 1.2498207092285156
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.987 Vali Acc: 0.296 Test Loss: 4.987 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.998767614364624
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.993 Vali Acc: 0.285 Test Loss: 4.993 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5933454036712646
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.170 Vali Acc: 0.287 Test Loss: 5.170 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8493964672088623
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.076 Vali Acc: 0.286 Test Loss: 5.076 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.964808464050293
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.112 Vali Acc: 0.296 Test Loss: 5.112 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9673047065734863
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.133 Vali Acc: 0.300 Test Loss: 5.133 Test Acc: 0.300
Validation loss decreased (-0.297597 --> -0.299949).  Saving model ...
Epoch: 29 cost time: 1.098215103149414
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.135 Vali Acc: 0.292 Test Loss: 5.135 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0544297695159912
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.113 Vali Acc: 0.293 Test Loss: 5.113 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8654394149780273
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.109 Vali Acc: 0.296 Test Loss: 5.109 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8817639350891113
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.104 Vali Acc: 0.298 Test Loss: 5.104 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9473567008972168
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.120 Vali Acc: 0.301 Test Loss: 5.120 Test Acc: 0.301
Validation loss decreased (-0.299949 --> -0.301125).  Saving model ...
Epoch: 34 cost time: 0.7785451412200928
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.152 Vali Acc: 0.300 Test Loss: 5.152 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9279024600982666
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.186 Vali Acc: 0.298 Test Loss: 5.186 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1089410781860352
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.187 Vali Acc: 0.295 Test Loss: 5.187 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9850456714630127
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.239 Vali Acc: 0.291 Test Loss: 5.239 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8725554943084717
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.274 Vali Acc: 0.294 Test Loss: 5.274 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8721232414245605
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.279 Vali Acc: 0.295 Test Loss: 5.279 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6789562702178955
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.258 Vali Acc: 0.300 Test Loss: 5.258 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8084819316864014
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.246 Vali Acc: 0.306 Test Loss: 5.246 Test Acc: 0.306
Validation loss decreased (-0.301125 --> -0.305830).  Saving model ...
Epoch: 42 cost time: 0.9309971332550049
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.238 Vali Acc: 0.307 Test Loss: 5.238 Test Acc: 0.307
Validation loss decreased (-0.305830 --> -0.307006).  Saving model ...
Epoch: 43 cost time: 0.988379955291748
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.234 Vali Acc: 0.306 Test Loss: 5.234 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9487597942352295
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.233 Vali Acc: 0.305 Test Loss: 5.233 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7414240837097168
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.253 Vali Acc: 0.306 Test Loss: 5.253 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7791152000427246
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.255 Vali Acc: 0.312 Test Loss: 5.255 Test Acc: 0.312
Validation loss decreased (-0.307006 --> -0.311712).  Saving model ...
Epoch: 47 cost time: 0.8190536499023438
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.275 Vali Acc: 0.309 Test Loss: 5.275 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8921082019805908
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.306 Vali Acc: 0.309 Test Loss: 5.306 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.892848014831543
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.317 Vali Acc: 0.301 Test Loss: 5.317 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.24369215965271
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.326 Vali Acc: 0.302 Test Loss: 5.326 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 43801370
model size : 181.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4457943439483643
Epoch: 1, Steps: 10 | Train Loss: 3.449 Vali Loss: 3.359 Vali Acc: 0.059 Test Loss: 3.359 Test Acc: 0.059
Validation loss decreased (inf --> -0.058790).  Saving model ...
Epoch: 2 cost time: 1.1194133758544922
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.375 Vali Acc: 0.062 Test Loss: 3.375 Test Acc: 0.062
Validation loss decreased (-0.058790 --> -0.062319).  Saving model ...
Epoch: 3 cost time: 1.1051819324493408
Epoch: 3, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.278 Vali Acc: 0.078 Test Loss: 3.278 Test Acc: 0.078
Validation loss decreased (-0.062319 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 1.169903039932251
Epoch: 4, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.188 Vali Acc: 0.138 Test Loss: 3.188 Test Acc: 0.138
Validation loss decreased (-0.077614 --> -0.137615).  Saving model ...
Epoch: 5 cost time: 1.3757457733154297
Epoch: 5, Steps: 10 | Train Loss: 2.289 Vali Loss: 3.137 Vali Acc: 0.162 Test Loss: 3.137 Test Acc: 0.162
Validation loss decreased (-0.137615 --> -0.162322).  Saving model ...
Epoch: 6 cost time: 1.205627202987671
Epoch: 6, Steps: 10 | Train Loss: 1.792 Vali Loss: 3.196 Vali Acc: 0.201 Test Loss: 3.196 Test Acc: 0.201
Validation loss decreased (-0.162322 --> -0.201145).  Saving model ...
Epoch: 7 cost time: 1.2903451919555664
Epoch: 7, Steps: 10 | Train Loss: 1.140 Vali Loss: 3.730 Vali Acc: 0.229 Test Loss: 3.730 Test Acc: 0.229
Validation loss decreased (-0.201145 --> -0.229374).  Saving model ...
Epoch: 8 cost time: 1.3164255619049072
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 4.278 Vali Acc: 0.241 Test Loss: 4.278 Test Acc: 0.241
Validation loss decreased (-0.229374 --> -0.241134).  Saving model ...
Epoch: 9 cost time: 1.3301284313201904
Epoch: 9, Steps: 10 | Train Loss: 0.434 Vali Loss: 4.691 Vali Acc: 0.252 Test Loss: 4.691 Test Acc: 0.252
Validation loss decreased (-0.241134 --> -0.251718).  Saving model ...
Epoch: 10 cost time: 1.2378566265106201
Epoch: 10, Steps: 10 | Train Loss: 0.211 Vali Loss: 5.180 Vali Acc: 0.265 Test Loss: 5.180 Test Acc: 0.265
Validation loss decreased (-0.251718 --> -0.264654).  Saving model ...
Epoch: 11 cost time: 1.22784423828125
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 5.639 Vali Acc: 0.253 Test Loss: 5.639 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9990401268005371
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 6.006 Vali Acc: 0.255 Test Loss: 6.006 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0352940559387207
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 6.102 Vali Acc: 0.278 Test Loss: 6.102 Test Acc: 0.278
Validation loss decreased (-0.264654 --> -0.277586).  Saving model ...
Epoch: 14 cost time: 1.3128180503845215
Epoch: 14, Steps: 10 | Train Loss: 0.098 Vali Loss: 6.189 Vali Acc: 0.279 Test Loss: 6.189 Test Acc: 0.279
Validation loss decreased (-0.277586 --> -0.278762).  Saving model ...
Epoch: 15 cost time: 1.026731252670288
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 7.141 Vali Acc: 0.253 Test Loss: 7.141 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.731774091720581
Epoch: 16, Steps: 10 | Train Loss: 0.143 Vali Loss: 7.172 Vali Acc: 0.269 Test Loss: 7.172 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7511730194091797
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.698 Vali Acc: 0.274 Test Loss: 6.698 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1291251182556152
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 6.956 Vali Acc: 0.285 Test Loss: 6.956 Test Acc: 0.285
Validation loss decreased (-0.278762 --> -0.284636).  Saving model ...
Epoch: 19 cost time: 1.5260605812072754
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.118 Vali Acc: 0.255 Test Loss: 8.118 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4790468215942383
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.554 Vali Acc: 0.284 Test Loss: 7.554 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4880640506744385
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 8.193 Vali Acc: 0.265 Test Loss: 8.193 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4296870231628418
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 8.063 Vali Acc: 0.284 Test Loss: 8.063 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2369883060455322
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.881 Vali Acc: 0.288 Test Loss: 7.881 Test Acc: 0.288
Validation loss decreased (-0.284636 --> -0.288156).  Saving model ...
Epoch: 24 cost time: 1.6114740371704102
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.744 Vali Acc: 0.294 Test Loss: 7.744 Test Acc: 0.294
Validation loss decreased (-0.288156 --> -0.294040).  Saving model ...
Epoch: 25 cost time: 1.2673909664154053
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.072 Vali Acc: 0.293 Test Loss: 8.072 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1140081882476807
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.193 Vali Acc: 0.293 Test Loss: 8.193 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3194990158081055
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.397 Vali Acc: 0.289 Test Loss: 8.397 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1296815872192383
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.152 Vali Acc: 0.292 Test Loss: 8.152 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.088019609451294
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.144 Vali Acc: 0.289 Test Loss: 8.144 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.307934045791626
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.171 Vali Acc: 0.288 Test Loss: 8.171 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2501463890075684
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.145 Vali Acc: 0.289 Test Loss: 8.145 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2191932201385498
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.101 Vali Acc: 0.293 Test Loss: 8.101 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4847283363342285
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.082 Vali Acc: 0.295 Test Loss: 8.082 Test Acc: 0.295
Validation loss decreased (-0.294040 --> -0.295213).  Saving model ...
Epoch: 34 cost time: 1.3873183727264404
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.084 Vali Acc: 0.294 Test Loss: 8.084 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.253507137298584
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.084 Vali Acc: 0.295 Test Loss: 8.084 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0497455596923828
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.118 Vali Acc: 0.292 Test Loss: 8.118 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1783277988433838
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.208 Vali Acc: 0.293 Test Loss: 8.208 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1113076210021973
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.240 Vali Acc: 0.292 Test Loss: 8.240 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1143779754638672
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.228 Vali Acc: 0.291 Test Loss: 8.228 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1947579383850098
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.210 Vali Acc: 0.293 Test Loss: 8.210 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0847501754760742
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.188 Vali Acc: 0.298 Test Loss: 8.188 Test Acc: 0.298
Validation loss decreased (-0.295213 --> -0.297565).  Saving model ...
Epoch: 42 cost time: 1.1461830139160156
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.178 Vali Acc: 0.300 Test Loss: 8.178 Test Acc: 0.300
Validation loss decreased (-0.297565 --> -0.299918).  Saving model ...
Epoch: 43 cost time: 1.5130088329315186
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.175 Vali Acc: 0.300 Test Loss: 8.175 Test Acc: 0.300
Validation loss decreased (-0.299918 --> -0.299918).  Saving model ...
Epoch: 44 cost time: 1.2519981861114502
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.170 Vali Acc: 0.301 Test Loss: 8.170 Test Acc: 0.301
Validation loss decreased (-0.299918 --> -0.301095).  Saving model ...
Epoch: 45 cost time: 1.2610433101654053
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.162 Vali Acc: 0.300 Test Loss: 8.162 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3655343055725098
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.156 Vali Acc: 0.301 Test Loss: 8.156 Test Acc: 0.301
Validation loss decreased (-0.301095 --> -0.301095).  Saving model ...
Epoch: 47 cost time: 1.4367225170135498
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.151 Vali Acc: 0.301 Test Loss: 8.151 Test Acc: 0.301
Validation loss decreased (-0.301095 --> -0.301095).  Saving model ...
Epoch: 48 cost time: 1.1421253681182861
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.153 Vali Acc: 0.301 Test Loss: 8.153 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9483425617218018
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.153 Vali Acc: 0.301 Test Loss: 8.153 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9200544357299805
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.154 Vali Acc: 0.301 Test Loss: 8.154 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 44496410
model size : 184.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.534571409225464
Epoch: 1, Steps: 10 | Train Loss: 3.428 Vali Loss: 3.313 Vali Acc: 0.039 Test Loss: 3.313 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.1011526584625244
Epoch: 2, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.392 Vali Acc: 0.061 Test Loss: 3.392 Test Acc: 0.061
Validation loss decreased (-0.038790 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 1.0890250205993652
Epoch: 3, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.343 Vali Acc: 0.079 Test Loss: 3.343 Test Acc: 0.079
Validation loss decreased (-0.061143 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 1.1239814758300781
Epoch: 4, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.250 Vali Acc: 0.116 Test Loss: 3.250 Test Acc: 0.116
Validation loss decreased (-0.078790 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.9228506088256836
Epoch: 5, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.214 Vali Acc: 0.135 Test Loss: 3.214 Test Acc: 0.135
Validation loss decreased (-0.116438 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 0.8792235851287842
Epoch: 6, Steps: 10 | Train Loss: 2.091 Vali Loss: 3.181 Vali Acc: 0.164 Test Loss: 3.181 Test Acc: 0.164
Validation loss decreased (-0.135262 --> -0.163498).  Saving model ...
Epoch: 7 cost time: 0.9539287090301514
Epoch: 7, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.439 Vali Acc: 0.189 Test Loss: 3.439 Test Acc: 0.189
Validation loss decreased (-0.163498 --> -0.189377).  Saving model ...
Epoch: 8 cost time: 0.8813557624816895
Epoch: 8, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.765 Vali Acc: 0.224 Test Loss: 3.765 Test Acc: 0.224
Validation loss decreased (-0.189377 --> -0.223492).  Saving model ...
Epoch: 9 cost time: 0.9842000007629395
Epoch: 9, Steps: 10 | Train Loss: 0.715 Vali Loss: 4.030 Vali Acc: 0.225 Test Loss: 4.030 Test Acc: 0.225
Validation loss decreased (-0.223492 --> -0.224666).  Saving model ...
Epoch: 10 cost time: 0.9641497135162354
Epoch: 10, Steps: 10 | Train Loss: 0.281 Vali Loss: 4.276 Vali Acc: 0.282 Test Loss: 4.276 Test Acc: 0.282
Validation loss decreased (-0.224666 --> -0.282310).  Saving model ...
Epoch: 11 cost time: 1.036736249923706
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 4.760 Vali Acc: 0.246 Test Loss: 4.760 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0890333652496338
Epoch: 12, Steps: 10 | Train Loss: 0.110 Vali Loss: 5.062 Vali Acc: 0.276 Test Loss: 5.062 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.134847640991211
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 5.383 Vali Acc: 0.279 Test Loss: 5.383 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0303690433502197
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 5.596 Vali Acc: 0.252 Test Loss: 5.596 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0422003269195557
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 5.628 Vali Acc: 0.282 Test Loss: 5.628 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2151963710784912
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.020 Vali Acc: 0.275 Test Loss: 6.020 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0918471813201904
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.720 Vali Acc: 0.296 Test Loss: 5.720 Test Acc: 0.296
Validation loss decreased (-0.282310 --> -0.296413).  Saving model ...
Epoch: 18 cost time: 1.4860460758209229
Epoch: 18, Steps: 10 | Train Loss: 0.075 Vali Loss: 5.958 Vali Acc: 0.280 Test Loss: 5.958 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.259688138961792
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.855 Vali Acc: 0.272 Test Loss: 5.855 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.228755235671997
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 6.117 Vali Acc: 0.293 Test Loss: 6.117 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0821335315704346
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.289 Vali Acc: 0.298 Test Loss: 6.289 Test Acc: 0.298
Validation loss decreased (-0.296413 --> -0.297584).  Saving model ...
Epoch: 22 cost time: 1.0388109683990479
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.073 Vali Acc: 0.294 Test Loss: 6.073 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.024271011352539
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.119 Vali Acc: 0.306 Test Loss: 6.119 Test Acc: 0.306
Validation loss decreased (-0.297584 --> -0.305821).  Saving model ...
Epoch: 24 cost time: 0.8007745742797852
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.138 Vali Acc: 0.304 Test Loss: 6.138 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.328742504119873
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.508 Vali Acc: 0.292 Test Loss: 6.508 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.416335105895996
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.064 Vali Acc: 0.306 Test Loss: 6.064 Test Acc: 0.306
Validation loss decreased (-0.305821 --> -0.305822).  Saving model ...
Epoch: 27 cost time: 1.3271281719207764
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.299 Vali Acc: 0.299 Test Loss: 6.299 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3964085578918457
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 6.625 Vali Acc: 0.298 Test Loss: 6.625 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2824294567108154
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.539 Vali Acc: 0.284 Test Loss: 6.539 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0688457489013672
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.365 Vali Acc: 0.296 Test Loss: 6.365 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.292348861694336
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.527 Vali Acc: 0.301 Test Loss: 6.527 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1404800415039062
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.582 Vali Acc: 0.305 Test Loss: 6.582 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1647887229919434
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.603 Vali Acc: 0.302 Test Loss: 6.603 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.103844404220581
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.627 Vali Acc: 0.308 Test Loss: 6.627 Test Acc: 0.308
Validation loss decreased (-0.305822 --> -0.308169).  Saving model ...
Epoch: 35 cost time: 1.000535249710083
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.639 Vali Acc: 0.309 Test Loss: 6.639 Test Acc: 0.309
Validation loss decreased (-0.308169 --> -0.309345).  Saving model ...
Epoch: 36 cost time: 0.7224693298339844
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.617 Vali Acc: 0.313 Test Loss: 6.617 Test Acc: 0.313
Validation loss decreased (-0.309345 --> -0.312875).  Saving model ...
Epoch: 37 cost time: 1.2652018070220947
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.573 Vali Acc: 0.316 Test Loss: 6.573 Test Acc: 0.316
Validation loss decreased (-0.312875 --> -0.316405).  Saving model ...
Epoch: 38 cost time: 1.3740806579589844
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.547 Vali Acc: 0.314 Test Loss: 6.547 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.868417501449585
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.539 Vali Acc: 0.315 Test Loss: 6.539 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1821281909942627
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.535 Vali Acc: 0.315 Test Loss: 6.535 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.063037633895874
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.522 Vali Acc: 0.316 Test Loss: 6.522 Test Acc: 0.316
Validation loss decreased (-0.316405 --> -0.316405).  Saving model ...
Epoch: 42 cost time: 0.7089848518371582
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.511 Vali Acc: 0.318 Test Loss: 6.511 Test Acc: 0.318
Validation loss decreased (-0.316405 --> -0.317582).  Saving model ...
Epoch: 43 cost time: 0.9718461036682129
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.504 Vali Acc: 0.320 Test Loss: 6.504 Test Acc: 0.320
Validation loss decreased (-0.317582 --> -0.319935).  Saving model ...
Epoch: 44 cost time: 1.1171233654022217
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.509 Vali Acc: 0.316 Test Loss: 6.509 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2893619537353516
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.484 Vali Acc: 0.318 Test Loss: 6.484 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3932957649230957
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.474 Vali Acc: 0.319 Test Loss: 6.474 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2761471271514893
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.466 Vali Acc: 0.319 Test Loss: 6.466 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7446684837341309
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.460 Vali Acc: 0.321 Test Loss: 6.460 Test Acc: 0.321
Validation loss decreased (-0.319935 --> -0.321112).  Saving model ...
Epoch: 49 cost time: 1.1909992694854736
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.451 Vali Acc: 0.325 Test Loss: 6.451 Test Acc: 0.325
Validation loss decreased (-0.321112 --> -0.324641).  Saving model ...
Epoch: 50 cost time: 1.4450349807739258
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.457 Vali Acc: 0.325 Test Loss: 6.457 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 44087834
model size : 182.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5769968032836914
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.310 Vali Acc: 0.044 Test Loss: 3.310 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.8392424583435059
Epoch: 2, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.351 Vali Acc: 0.053 Test Loss: 3.351 Test Acc: 0.053
Validation loss decreased (-0.043496 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.066162347793579
Epoch: 3, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.331 Vali Acc: 0.071 Test Loss: 3.331 Test Acc: 0.071
Validation loss decreased (-0.052908 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.9344155788421631
Epoch: 4, Steps: 10 | Train Loss: 2.995 Vali Loss: 3.286 Vali Acc: 0.079 Test Loss: 3.286 Test Acc: 0.079
Validation loss decreased (-0.070555 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.744312047958374
Epoch: 5, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.240 Vali Acc: 0.111 Test Loss: 3.240 Test Acc: 0.111
Validation loss decreased (-0.078791 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 0.6880249977111816
Epoch: 6, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.181 Vali Acc: 0.122 Test Loss: 3.181 Test Acc: 0.122
Validation loss decreased (-0.110556 --> -0.122321).  Saving model ...
Epoch: 7 cost time: 0.8893561363220215
Epoch: 7, Steps: 10 | Train Loss: 2.274 Vali Loss: 3.170 Vali Acc: 0.154 Test Loss: 3.170 Test Acc: 0.154
Validation loss decreased (-0.122321 --> -0.154086).  Saving model ...
Epoch: 8 cost time: 0.8333308696746826
Epoch: 8, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.237 Vali Acc: 0.175 Test Loss: 3.237 Test Acc: 0.175
Validation loss decreased (-0.154086 --> -0.175262).  Saving model ...
Epoch: 9 cost time: 0.8223347663879395
Epoch: 9, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.537 Vali Acc: 0.207 Test Loss: 3.537 Test Acc: 0.207
Validation loss decreased (-0.175262 --> -0.207023).  Saving model ...
Epoch: 10 cost time: 0.8000497817993164
Epoch: 10, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.687 Vali Acc: 0.228 Test Loss: 3.687 Test Acc: 0.228
Validation loss decreased (-0.207023 --> -0.228198).  Saving model ...
Epoch: 11 cost time: 0.901073694229126
Epoch: 11, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.973 Vali Acc: 0.240 Test Loss: 3.973 Test Acc: 0.240
Validation loss decreased (-0.228198 --> -0.239960).  Saving model ...
Epoch: 12 cost time: 0.7079944610595703
Epoch: 12, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.856 Vali Acc: 0.271 Test Loss: 3.856 Test Acc: 0.271
Validation loss decreased (-0.239960 --> -0.270550).  Saving model ...
Epoch: 13 cost time: 0.8635478019714355
Epoch: 13, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.346 Vali Acc: 0.254 Test Loss: 4.346 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8724851608276367
Epoch: 14, Steps: 10 | Train Loss: 0.168 Vali Loss: 4.389 Vali Acc: 0.272 Test Loss: 4.389 Test Acc: 0.272
Validation loss decreased (-0.270550 --> -0.271721).  Saving model ...
Epoch: 15 cost time: 1.0474648475646973
Epoch: 15, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.469 Vali Acc: 0.288 Test Loss: 4.469 Test Acc: 0.288
Validation loss decreased (-0.271721 --> -0.288191).  Saving model ...
Epoch: 16 cost time: 0.8692572116851807
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.730 Vali Acc: 0.281 Test Loss: 4.730 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8339107036590576
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.633 Vali Acc: 0.287 Test Loss: 4.633 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9498722553253174
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.903 Vali Acc: 0.276 Test Loss: 4.903 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8539688587188721
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.949 Vali Acc: 0.280 Test Loss: 4.949 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6370642185211182
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.818 Vali Acc: 0.302 Test Loss: 4.818 Test Acc: 0.302
Validation loss decreased (-0.288191 --> -0.302305).  Saving model ...
Epoch: 21 cost time: 0.9972813129425049
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.926 Vali Acc: 0.299 Test Loss: 4.926 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8940286636352539
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.015 Vali Acc: 0.291 Test Loss: 5.015 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9164869785308838
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.102 Vali Acc: 0.284 Test Loss: 5.102 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7839088439941406
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.131 Vali Acc: 0.298 Test Loss: 5.131 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8569045066833496
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.052 Vali Acc: 0.298 Test Loss: 5.052 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.952416181564331
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.060 Vali Acc: 0.304 Test Loss: 5.060 Test Acc: 0.304
Validation loss decreased (-0.302305 --> -0.303479).  Saving model ...
Epoch: 27 cost time: 0.6911828517913818
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.040 Vali Acc: 0.304 Test Loss: 5.040 Test Acc: 0.304
Validation loss decreased (-0.303479 --> -0.303479).  Saving model ...
Epoch: 28 cost time: 1.0985198020935059
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.078 Vali Acc: 0.299 Test Loss: 5.078 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0185225009918213
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.100 Vali Acc: 0.302 Test Loss: 5.100 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9277451038360596
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.096 Vali Acc: 0.307 Test Loss: 5.096 Test Acc: 0.307
Validation loss decreased (-0.303479 --> -0.307008).  Saving model ...
Epoch: 31 cost time: 1.0214900970458984
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.055 Vali Acc: 0.308 Test Loss: 5.055 Test Acc: 0.308
Validation loss decreased (-0.307008 --> -0.308185).  Saving model ...
Epoch: 32 cost time: 0.8555965423583984
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.126 Vali Acc: 0.304 Test Loss: 5.126 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1363716125488281
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.381 Vali Acc: 0.298 Test Loss: 5.381 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9866433143615723
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.368 Vali Acc: 0.291 Test Loss: 5.368 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0462660789489746
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.264 Vali Acc: 0.305 Test Loss: 5.264 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9734292030334473
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.220 Vali Acc: 0.305 Test Loss: 5.220 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9979968070983887
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.231 Vali Acc: 0.307 Test Loss: 5.231 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8350365161895752
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.259 Vali Acc: 0.307 Test Loss: 5.259 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.962336540222168
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.280 Vali Acc: 0.306 Test Loss: 5.280 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7428312301635742
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.298 Vali Acc: 0.309 Test Loss: 5.298 Test Acc: 0.309
Validation loss decreased (-0.308185 --> -0.309359).  Saving model ...
Epoch: 41 cost time: 1.0507032871246338
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.298 Vali Acc: 0.307 Test Loss: 5.298 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7389721870422363
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.300 Vali Acc: 0.305 Test Loss: 5.300 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0100960731506348
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.347 Vali Acc: 0.311 Test Loss: 5.347 Test Acc: 0.311
Validation loss decreased (-0.309359 --> -0.310535).  Saving model ...
Epoch: 44 cost time: 0.7435650825500488
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.363 Vali Acc: 0.311 Test Loss: 5.363 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8299939632415771
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.356 Vali Acc: 0.311 Test Loss: 5.356 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.114232063293457
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.372 Vali Acc: 0.307 Test Loss: 5.372 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8882253170013428
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.387 Vali Acc: 0.313 Test Loss: 5.387 Test Acc: 0.313
Validation loss decreased (-0.310535 --> -0.312887).  Saving model ...
Epoch: 48 cost time: 0.9425601959228516
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.394 Vali Acc: 0.307 Test Loss: 5.394 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8041276931762695
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.377 Vali Acc: 0.305 Test Loss: 5.377 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9954569339752197
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.372 Vali Acc: 0.302 Test Loss: 5.372 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 43786778
model size : 181.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0056004524230957
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.356 Vali Acc: 0.041 Test Loss: 3.356 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.1785895824432373
Epoch: 2, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.387 Vali Acc: 0.048 Test Loss: 3.387 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048201).  Saving model ...
Epoch: 3 cost time: 1.1399869918823242
Epoch: 3, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.296 Vali Acc: 0.108 Test Loss: 3.296 Test Acc: 0.108
Validation loss decreased (-0.048201 --> -0.108202).  Saving model ...
Epoch: 4 cost time: 1.45707106590271
Epoch: 4, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.241 Vali Acc: 0.099 Test Loss: 3.241 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5266950130462646
Epoch: 5, Steps: 10 | Train Loss: 2.374 Vali Loss: 3.213 Vali Acc: 0.159 Test Loss: 3.213 Test Acc: 0.159
Validation loss decreased (-0.108202 --> -0.158791).  Saving model ...
Epoch: 6 cost time: 1.6718194484710693
Epoch: 6, Steps: 10 | Train Loss: 1.771 Vali Loss: 3.244 Vali Acc: 0.189 Test Loss: 3.244 Test Acc: 0.189
Validation loss decreased (-0.158791 --> -0.189379).  Saving model ...
Epoch: 7 cost time: 1.561715841293335
Epoch: 7, Steps: 10 | Train Loss: 1.241 Vali Loss: 3.751 Vali Acc: 0.231 Test Loss: 3.751 Test Acc: 0.231
Validation loss decreased (-0.189379 --> -0.230551).  Saving model ...
Epoch: 8 cost time: 1.280336618423462
Epoch: 8, Steps: 10 | Train Loss: 0.664 Vali Loss: 4.309 Vali Acc: 0.238 Test Loss: 4.309 Test Acc: 0.238
Validation loss decreased (-0.230551 --> -0.237604).  Saving model ...
Epoch: 9 cost time: 1.8063251972198486
Epoch: 9, Steps: 10 | Train Loss: 0.382 Vali Loss: 4.920 Vali Acc: 0.258 Test Loss: 4.920 Test Acc: 0.258
Validation loss decreased (-0.237604 --> -0.257598).  Saving model ...
Epoch: 10 cost time: 1.45674729347229
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 5.399 Vali Acc: 0.238 Test Loss: 5.399 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6371243000030518
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 6.023 Vali Acc: 0.264 Test Loss: 6.023 Test Acc: 0.264
Validation loss decreased (-0.257598 --> -0.263469).  Saving model ...
Epoch: 12 cost time: 1.4617702960968018
Epoch: 12, Steps: 10 | Train Loss: 0.264 Vali Loss: 6.077 Vali Acc: 0.291 Test Loss: 6.077 Test Acc: 0.291
Validation loss decreased (-0.263469 --> -0.290527).  Saving model ...
Epoch: 13 cost time: 1.841261386871338
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 6.668 Vali Acc: 0.253 Test Loss: 6.668 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8086154460906982
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 6.974 Vali Acc: 0.267 Test Loss: 6.974 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4245696067810059
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 6.813 Vali Acc: 0.266 Test Loss: 6.813 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.710341215133667
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 6.997 Vali Acc: 0.275 Test Loss: 6.997 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6999859809875488
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.388 Vali Acc: 0.267 Test Loss: 7.388 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6785807609558105
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.552 Vali Acc: 0.288 Test Loss: 7.552 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9785616397857666
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 7.525 Vali Acc: 0.288 Test Loss: 7.525 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8484399318695068
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 7.726 Vali Acc: 0.278 Test Loss: 7.726 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.057629346847534
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 8.325 Vali Acc: 0.260 Test Loss: 8.325 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.794482946395874
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 8.172 Vali Acc: 0.272 Test Loss: 8.172 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 44503322
model size : 184.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.659064769744873
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.329 Vali Acc: 0.045 Test Loss: 3.329 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.2162249088287354
Epoch: 2, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.340 Vali Acc: 0.064 Test Loss: 3.340 Test Acc: 0.064
Validation loss decreased (-0.044673 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 1.1918225288391113
Epoch: 3, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.296 Vali Acc: 0.078 Test Loss: 3.296 Test Acc: 0.078
Validation loss decreased (-0.063496 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 1.0548624992370605
Epoch: 4, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.267 Vali Acc: 0.096 Test Loss: 3.267 Test Acc: 0.096
Validation loss decreased (-0.077614 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 1.1966609954833984
Epoch: 5, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.206 Vali Acc: 0.116 Test Loss: 3.206 Test Acc: 0.116
Validation loss decreased (-0.096438 --> -0.116439).  Saving model ...
Epoch: 6 cost time: 1.1013271808624268
Epoch: 6, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.208 Vali Acc: 0.149 Test Loss: 3.208 Test Acc: 0.149
Validation loss decreased (-0.116439 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 1.1552438735961914
Epoch: 7, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.284 Vali Acc: 0.174 Test Loss: 3.284 Test Acc: 0.174
Validation loss decreased (-0.149380 --> -0.174085).  Saving model ...
Epoch: 8 cost time: 1.248460292816162
Epoch: 8, Steps: 10 | Train Loss: 1.215 Vali Loss: 3.579 Vali Acc: 0.228 Test Loss: 3.579 Test Acc: 0.228
Validation loss decreased (-0.174085 --> -0.228200).  Saving model ...
Epoch: 9 cost time: 1.1829493045806885
Epoch: 9, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.983 Vali Acc: 0.212 Test Loss: 3.983 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3170628547668457
Epoch: 10, Steps: 10 | Train Loss: 0.533 Vali Loss: 4.144 Vali Acc: 0.261 Test Loss: 4.144 Test Acc: 0.261
Validation loss decreased (-0.228200 --> -0.261135).  Saving model ...
Epoch: 11 cost time: 1.232717514038086
Epoch: 11, Steps: 10 | Train Loss: 0.280 Vali Loss: 4.382 Vali Acc: 0.254 Test Loss: 4.382 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8749432563781738
Epoch: 12, Steps: 10 | Train Loss: 0.201 Vali Loss: 4.556 Vali Acc: 0.255 Test Loss: 4.556 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.307941198348999
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 4.947 Vali Acc: 0.265 Test Loss: 4.947 Test Acc: 0.265
Validation loss decreased (-0.261135 --> -0.264656).  Saving model ...
Epoch: 14 cost time: 1.029618740081787
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.851 Vali Acc: 0.278 Test Loss: 4.851 Test Acc: 0.278
Validation loss decreased (-0.264656 --> -0.277599).  Saving model ...
Epoch: 15 cost time: 0.9969029426574707
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 5.121 Vali Acc: 0.286 Test Loss: 5.121 Test Acc: 0.286
Validation loss decreased (-0.277599 --> -0.285831).  Saving model ...
Epoch: 16 cost time: 1.0982773303985596
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.213 Vali Acc: 0.272 Test Loss: 5.213 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6688780784606934
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 5.427 Vali Acc: 0.273 Test Loss: 5.427 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0289497375488281
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.323 Vali Acc: 0.280 Test Loss: 5.323 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2470636367797852
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.281 Vali Acc: 0.284 Test Loss: 5.281 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3098866939544678
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.396 Vali Acc: 0.288 Test Loss: 5.396 Test Acc: 0.288
Validation loss decreased (-0.285831 --> -0.288181).  Saving model ...
Epoch: 21 cost time: 1.244051218032837
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.531 Vali Acc: 0.286 Test Loss: 5.531 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2208797931671143
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.464 Vali Acc: 0.295 Test Loss: 5.464 Test Acc: 0.295
Validation loss decreased (-0.288181 --> -0.295239).  Saving model ...
Epoch: 23 cost time: 1.0504555702209473
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.413 Vali Acc: 0.294 Test Loss: 5.413 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9991421699523926
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.462 Vali Acc: 0.291 Test Loss: 5.462 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2279391288757324
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.462 Vali Acc: 0.295 Test Loss: 5.462 Test Acc: 0.295
Validation loss decreased (-0.295239 --> -0.295239).  Saving model ...
Epoch: 26 cost time: 1.0871071815490723
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.514 Vali Acc: 0.299 Test Loss: 5.514 Test Acc: 0.299
Validation loss decreased (-0.295239 --> -0.298768).  Saving model ...
Epoch: 27 cost time: 0.8337464332580566
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.532 Vali Acc: 0.299 Test Loss: 5.532 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9434995651245117
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.545 Vali Acc: 0.293 Test Loss: 5.545 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7685840129852295
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.577 Vali Acc: 0.293 Test Loss: 5.577 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7580153942108154
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.571 Vali Acc: 0.296 Test Loss: 5.571 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2227756977081299
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.506 Vali Acc: 0.299 Test Loss: 5.506 Test Acc: 0.299
Validation loss decreased (-0.298768 --> -0.298768).  Saving model ...
Epoch: 32 cost time: 1.1539630889892578
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.486 Vali Acc: 0.299 Test Loss: 5.486 Test Acc: 0.299
Validation loss decreased (-0.298768 --> -0.298769).  Saving model ...
Epoch: 33 cost time: 1.2121365070343018
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.512 Vali Acc: 0.300 Test Loss: 5.512 Test Acc: 0.300
Validation loss decreased (-0.298769 --> -0.299945).  Saving model ...
Epoch: 34 cost time: 0.7919158935546875
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.551 Vali Acc: 0.300 Test Loss: 5.551 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6349983215332031
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.567 Vali Acc: 0.294 Test Loss: 5.567 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.095346450805664
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.579 Vali Acc: 0.299 Test Loss: 5.579 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0223824977874756
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.565 Vali Acc: 0.300 Test Loss: 5.565 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0982797145843506
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.583 Vali Acc: 0.298 Test Loss: 5.583 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4939262866973877
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.596 Vali Acc: 0.300 Test Loss: 5.596 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7092471122741699
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.593 Vali Acc: 0.300 Test Loss: 5.593 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0419695377349854
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.594 Vali Acc: 0.298 Test Loss: 5.594 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6957030296325684
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.609 Vali Acc: 0.295 Test Loss: 5.609 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4716970920562744
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.650 Vali Acc: 0.293 Test Loss: 5.650 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3
model parameter : 43987226
model size : 182.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4468820095062256
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.329 Vali Acc: 0.034 Test Loss: 3.329 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.9733872413635254
Epoch: 2, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.335 Vali Acc: 0.064 Test Loss: 3.335 Test Acc: 0.064
Validation loss decreased (-0.034084 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.9529373645782471
Epoch: 3, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.342 Vali Acc: 0.065 Test Loss: 3.342 Test Acc: 0.065
Validation loss decreased (-0.063496 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 0.8012704849243164
Epoch: 4, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.305 Vali Acc: 0.078 Test Loss: 3.305 Test Acc: 0.078
Validation loss decreased (-0.064672 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 0.9368765354156494
Epoch: 5, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.273 Vali Acc: 0.100 Test Loss: 3.273 Test Acc: 0.100
Validation loss decreased (-0.077614 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 1.0255322456359863
Epoch: 6, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.227 Vali Acc: 0.108 Test Loss: 3.227 Test Acc: 0.108
Validation loss decreased (-0.099967 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.805872917175293
Epoch: 7, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.176 Vali Acc: 0.133 Test Loss: 3.176 Test Acc: 0.133
Validation loss decreased (-0.108203 --> -0.132909).  Saving model ...
Epoch: 8 cost time: 0.9676203727722168
Epoch: 8, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.237 Vali Acc: 0.172 Test Loss: 3.237 Test Acc: 0.172
Validation loss decreased (-0.132909 --> -0.171732).  Saving model ...
Epoch: 9 cost time: 0.6775557994842529
Epoch: 9, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.310 Vali Acc: 0.207 Test Loss: 3.310 Test Acc: 0.207
Validation loss decreased (-0.171732 --> -0.207026).  Saving model ...
Epoch: 10 cost time: 0.8378109931945801
Epoch: 10, Steps: 10 | Train Loss: 1.153 Vali Loss: 3.423 Vali Acc: 0.229 Test Loss: 3.423 Test Acc: 0.229
Validation loss decreased (-0.207026 --> -0.229378).  Saving model ...
Epoch: 11 cost time: 1.001729965209961
Epoch: 11, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.624 Vali Acc: 0.229 Test Loss: 3.624 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.618736982345581
Epoch: 12, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.857 Vali Acc: 0.247 Test Loss: 3.857 Test Acc: 0.247
Validation loss decreased (-0.229378 --> -0.247020).  Saving model ...
Epoch: 13 cost time: 0.8154833316802979
Epoch: 13, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.925 Vali Acc: 0.269 Test Loss: 3.925 Test Acc: 0.269
Validation loss decreased (-0.247020 --> -0.269373).  Saving model ...
Epoch: 14 cost time: 0.6968033313751221
Epoch: 14, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.057 Vali Acc: 0.255 Test Loss: 4.057 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0621156692504883
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.271 Vali Acc: 0.271 Test Loss: 4.271 Test Acc: 0.271
Validation loss decreased (-0.269373 --> -0.270546).  Saving model ...
Epoch: 16 cost time: 0.7503666877746582
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.536 Vali Acc: 0.264 Test Loss: 4.536 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7013251781463623
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.505 Vali Acc: 0.287 Test Loss: 4.505 Test Acc: 0.287
Validation loss decreased (-0.270546 --> -0.287014).  Saving model ...
Epoch: 18 cost time: 0.8320918083190918
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.468 Vali Acc: 0.276 Test Loss: 4.468 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7732298374176025
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.582 Vali Acc: 0.273 Test Loss: 4.582 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7639193534851074
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.688 Vali Acc: 0.284 Test Loss: 4.688 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7217116355895996
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.686 Vali Acc: 0.288 Test Loss: 4.686 Test Acc: 0.288
Validation loss decreased (-0.287014 --> -0.288188).  Saving model ...
Epoch: 22 cost time: 0.7973062992095947
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.751 Vali Acc: 0.275 Test Loss: 4.751 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7043373584747314
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.785 Vali Acc: 0.279 Test Loss: 4.785 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7709288597106934
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.718 Vali Acc: 0.296 Test Loss: 4.718 Test Acc: 0.296
Validation loss decreased (-0.288188 --> -0.296423).  Saving model ...
Epoch: 25 cost time: 0.8133223056793213
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.823 Vali Acc: 0.289 Test Loss: 4.823 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9575424194335938
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.857 Vali Acc: 0.285 Test Loss: 4.857 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5802130699157715
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.883 Vali Acc: 0.285 Test Loss: 4.883 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.893230676651001
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.887 Vali Acc: 0.287 Test Loss: 4.887 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9481580257415771
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.887 Vali Acc: 0.281 Test Loss: 4.887 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7804543972015381
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.889 Vali Acc: 0.285 Test Loss: 4.889 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6138401031494141
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.894 Vali Acc: 0.285 Test Loss: 4.894 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7801141738891602
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.058 Vali Acc: 0.288 Test Loss: 5.058 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9874863624572754
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.113 Vali Acc: 0.293 Test Loss: 5.113 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6068217754364014
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.145 Vali Acc: 0.289 Test Loss: 5.145 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 43750682
model size : 181.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.714416742324829
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.331 Vali Acc: 0.067 Test Loss: 3.331 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 0.8861269950866699
Epoch: 2, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.368 Vali Acc: 0.089 Test Loss: 3.368 Test Acc: 0.089
Validation loss decreased (-0.067026 --> -0.089378).  Saving model ...
Epoch: 3 cost time: 1.1783761978149414
Epoch: 3, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.260 Vali Acc: 0.091 Test Loss: 3.260 Test Acc: 0.091
Validation loss decreased (-0.089378 --> -0.090556).  Saving model ...
Epoch: 4 cost time: 1.149869680404663
Epoch: 4, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.214 Vali Acc: 0.133 Test Loss: 3.214 Test Acc: 0.133
Validation loss decreased (-0.090556 --> -0.132909).  Saving model ...
Epoch: 5 cost time: 1.1895666122436523
Epoch: 5, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.182 Vali Acc: 0.147 Test Loss: 3.182 Test Acc: 0.147
Validation loss decreased (-0.132909 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 1.0479142665863037
Epoch: 6, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.353 Vali Acc: 0.204 Test Loss: 3.353 Test Acc: 0.204
Validation loss decreased (-0.147027 --> -0.203496).  Saving model ...
Epoch: 7 cost time: 1.6462080478668213
Epoch: 7, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.867 Vali Acc: 0.200 Test Loss: 3.867 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2986705303192139
Epoch: 8, Steps: 10 | Train Loss: 0.633 Vali Loss: 4.541 Vali Acc: 0.235 Test Loss: 4.541 Test Acc: 0.235
Validation loss decreased (-0.203496 --> -0.235249).  Saving model ...
Epoch: 9 cost time: 1.0641038417816162
Epoch: 9, Steps: 10 | Train Loss: 0.309 Vali Loss: 5.316 Vali Acc: 0.233 Test Loss: 5.316 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2004516124725342
Epoch: 10, Steps: 10 | Train Loss: 0.277 Vali Loss: 5.842 Vali Acc: 0.245 Test Loss: 5.842 Test Acc: 0.245
Validation loss decreased (-0.235249 --> -0.244647).  Saving model ...
Epoch: 11 cost time: 1.5410277843475342
Epoch: 11, Steps: 10 | Train Loss: 0.230 Vali Loss: 5.766 Vali Acc: 0.260 Test Loss: 5.766 Test Acc: 0.260
Validation loss decreased (-0.244647 --> -0.259942).  Saving model ...
Epoch: 12 cost time: 1.4082551002502441
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 6.276 Vali Acc: 0.271 Test Loss: 6.276 Test Acc: 0.271
Validation loss decreased (-0.259942 --> -0.270525).  Saving model ...
Epoch: 13 cost time: 1.68442702293396
Epoch: 13, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.057 Vali Acc: 0.265 Test Loss: 6.057 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.049875020980835
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 6.654 Vali Acc: 0.273 Test Loss: 6.654 Test Acc: 0.273
Validation loss decreased (-0.270525 --> -0.272875).  Saving model ...
Epoch: 15 cost time: 1.236840009689331
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.720 Vali Acc: 0.285 Test Loss: 6.720 Test Acc: 0.285
Validation loss decreased (-0.272875 --> -0.284639).  Saving model ...
Epoch: 16 cost time: 1.2186095714569092
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.827 Vali Acc: 0.258 Test Loss: 6.827 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3055768013000488
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.898 Vali Acc: 0.299 Test Loss: 6.898 Test Acc: 0.299
Validation loss decreased (-0.284639 --> -0.298755).  Saving model ...
Epoch: 18 cost time: 1.405219554901123
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.075 Vali Acc: 0.275 Test Loss: 7.075 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6627776622772217
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.479 Vali Acc: 0.274 Test Loss: 7.479 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.447693109512329
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 8.134 Vali Acc: 0.261 Test Loss: 8.134 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2916679382324219
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 8.985 Vali Acc: 0.259 Test Loss: 8.985 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4794881343841553
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 8.393 Vali Acc: 0.261 Test Loss: 8.393 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2705574035644531
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.225 Vali Acc: 0.265 Test Loss: 8.225 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1557869911193848
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.593 Vali Acc: 0.273 Test Loss: 8.593 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4550929069519043
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 8.186 Vali Acc: 0.262 Test Loss: 8.186 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4917783737182617
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.597 Vali Acc: 0.265 Test Loss: 8.597 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6931469440460205
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 8.689 Vali Acc: 0.275 Test Loss: 8.689 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 44488730
model size : 184.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6337077617645264
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.307 Vali Acc: 0.033 Test Loss: 3.307 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.0863454341888428
Epoch: 2, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.373 Vali Acc: 0.055 Test Loss: 3.373 Test Acc: 0.055
Validation loss decreased (-0.032908 --> -0.055260).  Saving model ...
Epoch: 3 cost time: 0.9980359077453613
Epoch: 3, Steps: 10 | Train Loss: 3.077 Vali Loss: 3.355 Vali Acc: 0.089 Test Loss: 3.355 Test Acc: 0.089
Validation loss decreased (-0.055260 --> -0.089378).  Saving model ...
Epoch: 4 cost time: 0.7165353298187256
Epoch: 4, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.233 Vali Acc: 0.092 Test Loss: 3.233 Test Acc: 0.092
Validation loss decreased (-0.089378 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 0.7903165817260742
Epoch: 5, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.187 Vali Acc: 0.125 Test Loss: 3.187 Test Acc: 0.125
Validation loss decreased (-0.091732 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 0.9808065891265869
Epoch: 6, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.195 Vali Acc: 0.158 Test Loss: 3.195 Test Acc: 0.158
Validation loss decreased (-0.124674 --> -0.157615).  Saving model ...
Epoch: 7 cost time: 1.1454675197601318
Epoch: 7, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.312 Vali Acc: 0.199 Test Loss: 3.312 Test Acc: 0.199
Validation loss decreased (-0.157615 --> -0.198790).  Saving model ...
Epoch: 8 cost time: 1.1130120754241943
Epoch: 8, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.554 Vali Acc: 0.199 Test Loss: 3.554 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2995879650115967
Epoch: 9, Steps: 10 | Train Loss: 0.909 Vali Loss: 4.019 Vali Acc: 0.222 Test Loss: 4.019 Test Acc: 0.222
Validation loss decreased (-0.198790 --> -0.222313).  Saving model ...
Epoch: 10 cost time: 0.9849991798400879
Epoch: 10, Steps: 10 | Train Loss: 0.574 Vali Loss: 4.079 Vali Acc: 0.253 Test Loss: 4.079 Test Acc: 0.253
Validation loss decreased (-0.222313 --> -0.252900).  Saving model ...
Epoch: 11 cost time: 1.0006012916564941
Epoch: 11, Steps: 10 | Train Loss: 0.372 Vali Loss: 4.519 Vali Acc: 0.253 Test Loss: 4.519 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.933953046798706
Epoch: 12, Steps: 10 | Train Loss: 0.273 Vali Loss: 4.726 Vali Acc: 0.249 Test Loss: 4.726 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9486134052276611
Epoch: 13, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.717 Vali Acc: 0.272 Test Loss: 4.717 Test Acc: 0.272
Validation loss decreased (-0.252900 --> -0.271718).  Saving model ...
Epoch: 14 cost time: 0.9212753772735596
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 5.125 Vali Acc: 0.251 Test Loss: 5.125 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.192246437072754
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 5.034 Vali Acc: 0.274 Test Loss: 5.034 Test Acc: 0.274
Validation loss decreased (-0.271718 --> -0.274067).  Saving model ...
Epoch: 16 cost time: 1.2140693664550781
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.257 Vali Acc: 0.279 Test Loss: 5.257 Test Acc: 0.279
Validation loss decreased (-0.274067 --> -0.278771).  Saving model ...
Epoch: 17 cost time: 1.13527250289917
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 5.354 Vali Acc: 0.288 Test Loss: 5.354 Test Acc: 0.288
Validation loss decreased (-0.278771 --> -0.288182).  Saving model ...
Epoch: 18 cost time: 1.1461365222930908
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.441 Vali Acc: 0.294 Test Loss: 5.441 Test Acc: 0.294
Validation loss decreased (-0.288182 --> -0.294063).  Saving model ...
Epoch: 19 cost time: 1.2586121559143066
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.617 Vali Acc: 0.291 Test Loss: 5.617 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1226527690887451
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.589 Vali Acc: 0.295 Test Loss: 5.589 Test Acc: 0.295
Validation loss decreased (-0.294063 --> -0.295238).  Saving model ...
Epoch: 21 cost time: 1.1984772682189941
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.525 Vali Acc: 0.294 Test Loss: 5.525 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2223351001739502
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.784 Vali Acc: 0.282 Test Loss: 5.784 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9005181789398193
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.553 Vali Acc: 0.301 Test Loss: 5.553 Test Acc: 0.301
Validation loss decreased (-0.295238 --> -0.301121).  Saving model ...
Epoch: 24 cost time: 1.3933203220367432
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.514 Vali Acc: 0.304 Test Loss: 5.514 Test Acc: 0.304
Validation loss decreased (-0.301121 --> -0.303474).  Saving model ...
Epoch: 25 cost time: 1.1036334037780762
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.597 Vali Acc: 0.302 Test Loss: 5.597 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.063591718673706
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.673 Vali Acc: 0.304 Test Loss: 5.673 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0705654621124268
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.651 Vali Acc: 0.302 Test Loss: 5.651 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0100905895233154
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.626 Vali Acc: 0.304 Test Loss: 5.626 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9790635108947754
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.615 Vali Acc: 0.306 Test Loss: 5.615 Test Acc: 0.306
Validation loss decreased (-0.303474 --> -0.305826).  Saving model ...
Epoch: 30 cost time: 1.2143409252166748
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.627 Vali Acc: 0.307 Test Loss: 5.627 Test Acc: 0.307
Validation loss decreased (-0.305826 --> -0.307003).  Saving model ...
Epoch: 31 cost time: 1.2090556621551514
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.739 Vali Acc: 0.292 Test Loss: 5.739 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.733818531036377
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.707 Vali Acc: 0.304 Test Loss: 5.707 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9005093574523926
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.686 Vali Acc: 0.304 Test Loss: 5.686 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8476095199584961
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.697 Vali Acc: 0.304 Test Loss: 5.697 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8763687610626221
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.705 Vali Acc: 0.302 Test Loss: 5.705 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9433684349060059
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.730 Vali Acc: 0.300 Test Loss: 5.730 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.977104902267456
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.736 Vali Acc: 0.299 Test Loss: 5.736 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9294910430908203
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.756 Vali Acc: 0.304 Test Loss: 5.756 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8533267974853516
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.763 Vali Acc: 0.301 Test Loss: 5.763 Test Acc: 0.301
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7679076194763184
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.762 Vali Acc: 0.307 Test Loss: 5.762 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 43994138
model size : 182.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2755043506622314
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.333 Vali Acc: 0.039 Test Loss: 3.333 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.8104078769683838
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.324 Vali Acc: 0.031 Test Loss: 3.324 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7656576633453369
Epoch: 3, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.322 Vali Acc: 0.062 Test Loss: 3.322 Test Acc: 0.062
Validation loss decreased (-0.038790 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.6997873783111572
Epoch: 4, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.304 Vali Acc: 0.051 Test Loss: 3.304 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8467297554016113
Epoch: 5, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.252 Vali Acc: 0.085 Test Loss: 3.252 Test Acc: 0.085
Validation loss decreased (-0.062320 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.6969683170318604
Epoch: 6, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.225 Vali Acc: 0.106 Test Loss: 3.225 Test Acc: 0.106
Validation loss decreased (-0.084673 --> -0.105850).  Saving model ...
Epoch: 7 cost time: 0.6528778076171875
Epoch: 7, Steps: 10 | Train Loss: 2.395 Vali Loss: 3.173 Vali Acc: 0.139 Test Loss: 3.173 Test Acc: 0.139
Validation loss decreased (-0.105850 --> -0.138792).  Saving model ...
Epoch: 8 cost time: 0.878598690032959
Epoch: 8, Steps: 10 | Train Loss: 2.118 Vali Loss: 3.260 Vali Acc: 0.158 Test Loss: 3.260 Test Acc: 0.158
Validation loss decreased (-0.138792 --> -0.157614).  Saving model ...
Epoch: 9 cost time: 0.7416398525238037
Epoch: 9, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.316 Vali Acc: 0.202 Test Loss: 3.316 Test Acc: 0.202
Validation loss decreased (-0.157614 --> -0.202320).  Saving model ...
Epoch: 10 cost time: 0.8781032562255859
Epoch: 10, Steps: 10 | Train Loss: 1.186 Vali Loss: 3.542 Vali Acc: 0.218 Test Loss: 3.542 Test Acc: 0.218
Validation loss decreased (-0.202320 --> -0.217612).  Saving model ...
Epoch: 11 cost time: 0.7896935939788818
Epoch: 11, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.663 Vali Acc: 0.233 Test Loss: 3.663 Test Acc: 0.233
Validation loss decreased (-0.217612 --> -0.232905).  Saving model ...
Epoch: 12 cost time: 0.7824962139129639
Epoch: 12, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.891 Vali Acc: 0.249 Test Loss: 3.891 Test Acc: 0.249
Validation loss decreased (-0.232905 --> -0.249373).  Saving model ...
Epoch: 13 cost time: 0.7022924423217773
Epoch: 13, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.970 Vali Acc: 0.264 Test Loss: 3.970 Test Acc: 0.264
Validation loss decreased (-0.249373 --> -0.263490).  Saving model ...
Epoch: 14 cost time: 0.778083324432373
Epoch: 14, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.164 Vali Acc: 0.255 Test Loss: 4.164 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5842351913452148
Epoch: 15, Steps: 10 | Train Loss: 0.172 Vali Loss: 4.319 Vali Acc: 0.262 Test Loss: 4.319 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6814966201782227
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.354 Vali Acc: 0.282 Test Loss: 4.354 Test Acc: 0.282
Validation loss decreased (-0.263490 --> -0.282309).  Saving model ...
Epoch: 17 cost time: 0.8184890747070312
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.513 Vali Acc: 0.275 Test Loss: 4.513 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9671416282653809
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.596 Vali Acc: 0.282 Test Loss: 4.596 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9392611980438232
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.754 Vali Acc: 0.280 Test Loss: 4.754 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8815641403198242
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.735 Vali Acc: 0.288 Test Loss: 4.735 Test Acc: 0.288
Validation loss decreased (-0.282309 --> -0.288188).  Saving model ...
Epoch: 21 cost time: 0.9836914539337158
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.716 Vali Acc: 0.282 Test Loss: 4.716 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8319258689880371
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.731 Vali Acc: 0.293 Test Loss: 4.731 Test Acc: 0.293
Validation loss decreased (-0.288188 --> -0.292894).  Saving model ...
Epoch: 23 cost time: 0.6678774356842041
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.830 Vali Acc: 0.289 Test Loss: 4.830 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.660362720489502
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.888 Vali Acc: 0.286 Test Loss: 4.888 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5999147891998291
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.903 Vali Acc: 0.286 Test Loss: 4.903 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6042828559875488
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.972 Vali Acc: 0.286 Test Loss: 4.972 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7220058441162109
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.004 Vali Acc: 0.285 Test Loss: 5.004 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.718407154083252
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.033 Vali Acc: 0.298 Test Loss: 5.033 Test Acc: 0.298
Validation loss decreased (-0.292894 --> -0.297597).  Saving model ...
Epoch: 29 cost time: 0.8476099967956543
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.002 Vali Acc: 0.298 Test Loss: 5.002 Test Acc: 0.298
Validation loss decreased (-0.297597 --> -0.297597).  Saving model ...
Epoch: 30 cost time: 0.753777265548706
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.021 Vali Acc: 0.298 Test Loss: 5.021 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6053590774536133
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.034 Vali Acc: 0.292 Test Loss: 5.034 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7417771816253662
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.039 Vali Acc: 0.293 Test Loss: 5.039 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7638771533966064
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.026 Vali Acc: 0.298 Test Loss: 5.026 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6842484474182129
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.044 Vali Acc: 0.294 Test Loss: 5.044 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8138642311096191
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.078 Vali Acc: 0.305 Test Loss: 5.078 Test Acc: 0.305
Validation loss decreased (-0.297597 --> -0.304655).  Saving model ...
Epoch: 36 cost time: 0.685896635055542
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.103 Vali Acc: 0.300 Test Loss: 5.103 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6482217311859131
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.130 Vali Acc: 0.296 Test Loss: 5.130 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7574937343597412
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.136 Vali Acc: 0.296 Test Loss: 5.136 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6227314472198486
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.121 Vali Acc: 0.296 Test Loss: 5.121 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7398059368133545
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.119 Vali Acc: 0.295 Test Loss: 5.119 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6242120265960693
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.137 Vali Acc: 0.298 Test Loss: 5.137 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.739964485168457
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.157 Vali Acc: 0.295 Test Loss: 5.157 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6772608757019043
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.171 Vali Acc: 0.298 Test Loss: 5.171 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7621264457702637
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.257 Vali Acc: 0.294 Test Loss: 5.257 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6971304416656494
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.421 Vali Acc: 0.288 Test Loss: 5.421 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 43736090
model size : 181.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.603137731552124
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.329 Vali Acc: 0.041 Test Loss: 3.329 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.194420576095581
Epoch: 2, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.392 Vali Acc: 0.071 Test Loss: 3.392 Test Acc: 0.071
Validation loss decreased (-0.041143 --> -0.070554).  Saving model ...
Epoch: 3 cost time: 1.0140266418457031
Epoch: 3, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.272 Vali Acc: 0.072 Test Loss: 3.272 Test Acc: 0.072
Validation loss decreased (-0.070554 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 0.8760712146759033
Epoch: 4, Steps: 10 | Train Loss: 2.741 Vali Loss: 3.239 Vali Acc: 0.119 Test Loss: 3.239 Test Acc: 0.119
Validation loss decreased (-0.071732 --> -0.118791).  Saving model ...
Epoch: 5 cost time: 0.966205358505249
Epoch: 5, Steps: 10 | Train Loss: 2.419 Vali Loss: 3.159 Vali Acc: 0.153 Test Loss: 3.159 Test Acc: 0.153
Validation loss decreased (-0.118791 --> -0.152910).  Saving model ...
Epoch: 6 cost time: 0.9501972198486328
Epoch: 6, Steps: 10 | Train Loss: 1.960 Vali Loss: 3.170 Vali Acc: 0.186 Test Loss: 3.170 Test Acc: 0.186
Validation loss decreased (-0.152910 --> -0.185851).  Saving model ...
Epoch: 7 cost time: 1.0265917778015137
Epoch: 7, Steps: 10 | Train Loss: 1.469 Vali Loss: 3.489 Vali Acc: 0.206 Test Loss: 3.489 Test Acc: 0.206
Validation loss decreased (-0.185851 --> -0.205847).  Saving model ...
Epoch: 8 cost time: 0.7725176811218262
Epoch: 8, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.970 Vali Acc: 0.219 Test Loss: 3.970 Test Acc: 0.219
Validation loss decreased (-0.205847 --> -0.218784).  Saving model ...
Epoch: 9 cost time: 1.0099027156829834
Epoch: 9, Steps: 10 | Train Loss: 0.636 Vali Loss: 4.486 Vali Acc: 0.238 Test Loss: 4.486 Test Acc: 0.238
Validation loss decreased (-0.218784 --> -0.237602).  Saving model ...
Epoch: 10 cost time: 0.9651284217834473
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 4.748 Vali Acc: 0.248 Test Loss: 4.748 Test Acc: 0.248
Validation loss decreased (-0.237602 --> -0.248188).  Saving model ...
Epoch: 11 cost time: 1.143456220626831
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.967 Vali Acc: 0.256 Test Loss: 4.967 Test Acc: 0.256
Validation loss decreased (-0.248188 --> -0.256421).  Saving model ...
Epoch: 12 cost time: 1.0661466121673584
Epoch: 12, Steps: 10 | Train Loss: 0.113 Vali Loss: 5.225 Vali Acc: 0.272 Test Loss: 5.225 Test Acc: 0.272
Validation loss decreased (-0.256421 --> -0.271712).  Saving model ...
Epoch: 13 cost time: 1.2316327095031738
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.401 Vali Acc: 0.279 Test Loss: 5.401 Test Acc: 0.279
Validation loss decreased (-0.271712 --> -0.278770).  Saving model ...
Epoch: 14 cost time: 1.3645596504211426
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.560 Vali Acc: 0.284 Test Loss: 5.560 Test Acc: 0.284
Validation loss decreased (-0.278770 --> -0.283474).  Saving model ...
Epoch: 15 cost time: 1.7368369102478027
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.900 Vali Acc: 0.278 Test Loss: 5.900 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9771120548248291
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.687 Vali Acc: 0.278 Test Loss: 5.687 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0366027355194092
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.585 Vali Acc: 0.296 Test Loss: 5.585 Test Acc: 0.296
Validation loss decreased (-0.283474 --> -0.296415).  Saving model ...
Epoch: 18 cost time: 0.9974887371063232
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.371 Vali Acc: 0.267 Test Loss: 6.371 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9851324558258057
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.161 Vali Acc: 0.282 Test Loss: 6.161 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1753523349761963
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.895 Vali Acc: 0.295 Test Loss: 5.895 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0581965446472168
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.859 Vali Acc: 0.302 Test Loss: 5.859 Test Acc: 0.302
Validation loss decreased (-0.296415 --> -0.302294).  Saving model ...
Epoch: 22 cost time: 1.0130703449249268
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.885 Vali Acc: 0.305 Test Loss: 5.885 Test Acc: 0.305
Validation loss decreased (-0.302294 --> -0.304647).  Saving model ...
Epoch: 23 cost time: 0.7332448959350586
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.906 Vali Acc: 0.306 Test Loss: 5.906 Test Acc: 0.306
Validation loss decreased (-0.304647 --> -0.305823).  Saving model ...
Epoch: 24 cost time: 1.2932043075561523
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.967 Vali Acc: 0.294 Test Loss: 5.967 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9992246627807617
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.958 Vali Acc: 0.295 Test Loss: 5.958 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0950942039489746
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.929 Vali Acc: 0.298 Test Loss: 5.929 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.260293960571289
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.908 Vali Acc: 0.299 Test Loss: 5.908 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0835013389587402
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.910 Vali Acc: 0.302 Test Loss: 5.910 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.103898286819458
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.921 Vali Acc: 0.304 Test Loss: 5.921 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1989595890045166
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.962 Vali Acc: 0.302 Test Loss: 5.962 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3219921588897705
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.976 Vali Acc: 0.304 Test Loss: 5.976 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9426984786987305
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.997 Vali Acc: 0.302 Test Loss: 5.997 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0959017276763916
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.019 Vali Acc: 0.301 Test Loss: 6.019 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 44237594
model size : 183.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.651817798614502
Epoch: 1, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.322 Vali Acc: 0.047 Test Loss: 3.322 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.9058883190155029
Epoch: 2, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.329 Vali Acc: 0.067 Test Loss: 3.329 Test Acc: 0.067
Validation loss decreased (-0.047026 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 1.033931016921997
Epoch: 3, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.321 Vali Acc: 0.089 Test Loss: 3.321 Test Acc: 0.089
Validation loss decreased (-0.067026 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.8225538730621338
Epoch: 4, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.263 Vali Acc: 0.091 Test Loss: 3.263 Test Acc: 0.091
Validation loss decreased (-0.089379 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 0.8310110569000244
Epoch: 5, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.193 Vali Acc: 0.114 Test Loss: 3.193 Test Acc: 0.114
Validation loss decreased (-0.090556 --> -0.114086).  Saving model ...
Epoch: 6 cost time: 0.6197240352630615
Epoch: 6, Steps: 10 | Train Loss: 2.437 Vali Loss: 3.191 Vali Acc: 0.140 Test Loss: 3.191 Test Acc: 0.140
Validation loss decreased (-0.114086 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 1.0939233303070068
Epoch: 7, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.190 Vali Acc: 0.174 Test Loss: 3.190 Test Acc: 0.174
Validation loss decreased (-0.139968 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 1.1461975574493408
Epoch: 8, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.418 Vali Acc: 0.215 Test Loss: 3.418 Test Acc: 0.215
Validation loss decreased (-0.174086 --> -0.215260).  Saving model ...
Epoch: 9 cost time: 0.9038686752319336
Epoch: 9, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.672 Vali Acc: 0.233 Test Loss: 3.672 Test Acc: 0.233
Validation loss decreased (-0.215260 --> -0.232904).  Saving model ...
Epoch: 10 cost time: 0.9284634590148926
Epoch: 10, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.908 Vali Acc: 0.256 Test Loss: 3.908 Test Acc: 0.256
Validation loss decreased (-0.232904 --> -0.256432).  Saving model ...
Epoch: 11 cost time: 1.0595448017120361
Epoch: 11, Steps: 10 | Train Loss: 0.351 Vali Loss: 4.143 Vali Acc: 0.273 Test Loss: 4.143 Test Acc: 0.273
Validation loss decreased (-0.256432 --> -0.272900).  Saving model ...
Epoch: 12 cost time: 0.9722800254821777
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.285 Vali Acc: 0.255 Test Loss: 4.285 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7140893936157227
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.570 Vali Acc: 0.271 Test Loss: 4.570 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1292896270751953
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.858 Vali Acc: 0.262 Test Loss: 4.858 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8404338359832764
Epoch: 15, Steps: 10 | Train Loss: 0.089 Vali Loss: 5.006 Vali Acc: 0.276 Test Loss: 5.006 Test Acc: 0.276
Validation loss decreased (-0.272900 --> -0.276421).  Saving model ...
Epoch: 16 cost time: 0.6791512966156006
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.146 Vali Acc: 0.264 Test Loss: 5.146 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.84596848487854
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.209 Vali Acc: 0.282 Test Loss: 5.209 Test Acc: 0.282
Validation loss decreased (-0.276421 --> -0.282301).  Saving model ...
Epoch: 18 cost time: 0.7333412170410156
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.160 Vali Acc: 0.306 Test Loss: 5.160 Test Acc: 0.306
Validation loss decreased (-0.282301 --> -0.305831).  Saving model ...
Epoch: 19 cost time: 0.6403605937957764
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.312 Vali Acc: 0.293 Test Loss: 5.312 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8229022026062012
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.379 Vali Acc: 0.295 Test Loss: 5.379 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5817530155181885
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.263 Vali Acc: 0.295 Test Loss: 5.263 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6282615661621094
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.349 Vali Acc: 0.284 Test Loss: 5.349 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8939375877380371
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.455 Vali Acc: 0.282 Test Loss: 5.455 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.907508134841919
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.423 Vali Acc: 0.289 Test Loss: 5.423 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2253389358520508
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.380 Vali Acc: 0.295 Test Loss: 5.380 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.174785852432251
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.346 Vali Acc: 0.298 Test Loss: 5.346 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3916335105895996
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.346 Vali Acc: 0.299 Test Loss: 5.346 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0114784240722656
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.348 Vali Acc: 0.295 Test Loss: 5.348 Test Acc: 0.295
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 43915034
model size : 182.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.255206823348999
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.339 Vali Acc: 0.053 Test Loss: 3.339 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.7852773666381836
Epoch: 2, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.314 Vali Acc: 0.059 Test Loss: 3.314 Test Acc: 0.059
Validation loss decreased (-0.052908 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.749065637588501
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.333 Vali Acc: 0.060 Test Loss: 3.333 Test Acc: 0.060
Validation loss decreased (-0.058790 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.779883623123169
Epoch: 4, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.306 Vali Acc: 0.078 Test Loss: 3.306 Test Acc: 0.078
Validation loss decreased (-0.059967 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 0.6710543632507324
Epoch: 5, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.257 Vali Acc: 0.100 Test Loss: 3.257 Test Acc: 0.100
Validation loss decreased (-0.077614 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.6481478214263916
Epoch: 6, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.221 Vali Acc: 0.116 Test Loss: 3.221 Test Acc: 0.116
Validation loss decreased (-0.099967 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.7960124015808105
Epoch: 7, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.198 Vali Acc: 0.133 Test Loss: 3.198 Test Acc: 0.133
Validation loss decreased (-0.116438 --> -0.132909).  Saving model ...
Epoch: 8 cost time: 0.8593428134918213
Epoch: 8, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.245 Vali Acc: 0.165 Test Loss: 3.245 Test Acc: 0.165
Validation loss decreased (-0.132909 --> -0.164673).  Saving model ...
Epoch: 9 cost time: 0.7589890956878662
Epoch: 9, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.365 Vali Acc: 0.186 Test Loss: 3.365 Test Acc: 0.186
Validation loss decreased (-0.164673 --> -0.185849).  Saving model ...
Epoch: 10 cost time: 0.6634442806243896
Epoch: 10, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.458 Vali Acc: 0.213 Test Loss: 3.458 Test Acc: 0.213
Validation loss decreased (-0.185849 --> -0.212907).  Saving model ...
Epoch: 11 cost time: 0.8339946269989014
Epoch: 11, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.572 Vali Acc: 0.247 Test Loss: 3.572 Test Acc: 0.247
Validation loss decreased (-0.212907 --> -0.247023).  Saving model ...
Epoch: 12 cost time: 1.0389056205749512
Epoch: 12, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.810 Vali Acc: 0.236 Test Loss: 3.810 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7707679271697998
Epoch: 13, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.867 Vali Acc: 0.260 Test Loss: 3.867 Test Acc: 0.260
Validation loss decreased (-0.247023 --> -0.259961).  Saving model ...
Epoch: 14 cost time: 0.8209402561187744
Epoch: 14, Steps: 10 | Train Loss: 0.298 Vali Loss: 4.035 Vali Acc: 0.261 Test Loss: 4.035 Test Acc: 0.261
Validation loss decreased (-0.259961 --> -0.261136).  Saving model ...
Epoch: 15 cost time: 0.7953040599822998
Epoch: 15, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.185 Vali Acc: 0.273 Test Loss: 4.185 Test Acc: 0.273
Validation loss decreased (-0.261136 --> -0.272899).  Saving model ...
Epoch: 16 cost time: 0.9702355861663818
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.240 Vali Acc: 0.281 Test Loss: 4.240 Test Acc: 0.281
Validation loss decreased (-0.272899 --> -0.281134).  Saving model ...
Epoch: 17 cost time: 0.8369286060333252
Epoch: 17, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.399 Vali Acc: 0.286 Test Loss: 4.399 Test Acc: 0.286
Validation loss decreased (-0.281134 --> -0.285838).  Saving model ...
Epoch: 18 cost time: 0.8143413066864014
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.498 Vali Acc: 0.273 Test Loss: 4.498 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9260025024414062
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.664 Vali Acc: 0.278 Test Loss: 4.664 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.689509391784668
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.622 Vali Acc: 0.298 Test Loss: 4.622 Test Acc: 0.298
Validation loss decreased (-0.285838 --> -0.297601).  Saving model ...
Epoch: 21 cost time: 0.9852371215820312
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.635 Vali Acc: 0.293 Test Loss: 4.635 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0096731185913086
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.723 Vali Acc: 0.293 Test Loss: 4.723 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8593723773956299
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.764 Vali Acc: 0.294 Test Loss: 4.764 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8097660541534424
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.711 Vali Acc: 0.300 Test Loss: 4.711 Test Acc: 0.300
Validation loss decreased (-0.297601 --> -0.299953).  Saving model ...
Epoch: 25 cost time: 1.0194156169891357
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.780 Vali Acc: 0.296 Test Loss: 4.780 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.063312292098999
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.885 Vali Acc: 0.295 Test Loss: 4.885 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.893151044845581
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.910 Vali Acc: 0.293 Test Loss: 4.910 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8853671550750732
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.865 Vali Acc: 0.304 Test Loss: 4.865 Test Acc: 0.304
Validation loss decreased (-0.299953 --> -0.303481).  Saving model ...
Epoch: 29 cost time: 0.807063102722168
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.948 Vali Acc: 0.285 Test Loss: 4.948 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7434132099151611
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.883 Vali Acc: 0.302 Test Loss: 4.883 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8372993469238281
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.860 Vali Acc: 0.294 Test Loss: 4.860 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8088173866271973
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.885 Vali Acc: 0.296 Test Loss: 4.885 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7346043586730957
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.896 Vali Acc: 0.295 Test Loss: 4.896 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8415205478668213
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.921 Vali Acc: 0.301 Test Loss: 4.921 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6507716178894043
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.953 Vali Acc: 0.304 Test Loss: 4.953 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6791431903839111
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.974 Vali Acc: 0.298 Test Loss: 4.974 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6326625347137451
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.991 Vali Acc: 0.298 Test Loss: 4.991 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7971155643463135
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.986 Vali Acc: 0.298 Test Loss: 4.986 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 43721498
model size : 181.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.425161838531494
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.338 Vali Acc: 0.040 Test Loss: 3.338 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.2132112979888916
Epoch: 2, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.333 Vali Acc: 0.066 Test Loss: 3.333 Test Acc: 0.066
Validation loss decreased (-0.039967 --> -0.065849).  Saving model ...
Epoch: 3 cost time: 0.6827666759490967
Epoch: 3, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.275 Vali Acc: 0.069 Test Loss: 3.275 Test Acc: 0.069
Validation loss decreased (-0.065849 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 1.0637378692626953
Epoch: 4, Steps: 10 | Train Loss: 2.705 Vali Loss: 3.215 Vali Acc: 0.126 Test Loss: 3.215 Test Acc: 0.126
Validation loss decreased (-0.069379 --> -0.125850).  Saving model ...
Epoch: 5 cost time: 1.5442450046539307
Epoch: 5, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.193 Vali Acc: 0.171 Test Loss: 3.193 Test Acc: 0.171
Validation loss decreased (-0.125850 --> -0.170556).  Saving model ...
Epoch: 6 cost time: 1.481407880783081
Epoch: 6, Steps: 10 | Train Loss: 1.897 Vali Loss: 3.182 Vali Acc: 0.192 Test Loss: 3.182 Test Acc: 0.192
Validation loss decreased (-0.170556 --> -0.191733).  Saving model ...
Epoch: 7 cost time: 1.0953457355499268
Epoch: 7, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.579 Vali Acc: 0.218 Test Loss: 3.579 Test Acc: 0.218
Validation loss decreased (-0.191733 --> -0.217611).  Saving model ...
Epoch: 8 cost time: 1.321852207183838
Epoch: 8, Steps: 10 | Train Loss: 0.894 Vali Loss: 4.260 Vali Acc: 0.209 Test Loss: 4.260 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.499091386795044
Epoch: 9, Steps: 10 | Train Loss: 0.546 Vali Loss: 4.452 Vali Acc: 0.259 Test Loss: 4.452 Test Acc: 0.259
Validation loss decreased (-0.217611 --> -0.258779).  Saving model ...
Epoch: 10 cost time: 1.2155590057373047
Epoch: 10, Steps: 10 | Train Loss: 0.283 Vali Loss: 4.898 Vali Acc: 0.268 Test Loss: 4.898 Test Acc: 0.268
Validation loss decreased (-0.258779 --> -0.268186).  Saving model ...
Epoch: 11 cost time: 1.3847355842590332
Epoch: 11, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.834 Vali Acc: 0.288 Test Loss: 4.834 Test Acc: 0.288
Validation loss decreased (-0.268186 --> -0.288187).  Saving model ...
Epoch: 12 cost time: 1.180272102355957
Epoch: 12, Steps: 10 | Train Loss: 0.133 Vali Loss: 5.710 Vali Acc: 0.264 Test Loss: 5.710 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9965016841888428
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.124 Vali Acc: 0.281 Test Loss: 5.124 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6465792655944824
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.470 Vali Acc: 0.281 Test Loss: 5.470 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1197023391723633
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.713 Vali Acc: 0.269 Test Loss: 5.713 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.348862886428833
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.569 Vali Acc: 0.286 Test Loss: 5.569 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.064809799194336
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 5.801 Vali Acc: 0.276 Test Loss: 5.801 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2909822463989258
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 6.390 Vali Acc: 0.264 Test Loss: 6.390 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3756186962127686
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.036 Vali Acc: 0.285 Test Loss: 6.036 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9723927974700928
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.808 Vali Acc: 0.304 Test Loss: 5.808 Test Acc: 0.304
Validation loss decreased (-0.288187 --> -0.303471).  Saving model ...
Epoch: 21 cost time: 1.1301448345184326
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.837 Vali Acc: 0.313 Test Loss: 5.837 Test Acc: 0.313
Validation loss decreased (-0.303471 --> -0.312883).  Saving model ...
Epoch: 22 cost time: 1.199843168258667
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.999 Vali Acc: 0.304 Test Loss: 5.999 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2669730186462402
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.131 Vali Acc: 0.301 Test Loss: 6.131 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2461774349212646
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.851 Vali Acc: 0.316 Test Loss: 5.851 Test Acc: 0.316
Validation loss decreased (-0.312883 --> -0.316412).  Saving model ...
Epoch: 25 cost time: 1.0125482082366943
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.878 Vali Acc: 0.309 Test Loss: 5.878 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1213603019714355
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.033 Vali Acc: 0.298 Test Loss: 6.033 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0400886535644531
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.082 Vali Acc: 0.300 Test Loss: 6.082 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.105334997177124
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.072 Vali Acc: 0.298 Test Loss: 6.072 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1772618293762207
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.036 Vali Acc: 0.296 Test Loss: 6.036 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1974518299102783
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.021 Vali Acc: 0.299 Test Loss: 6.021 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1846542358398438
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.007 Vali Acc: 0.299 Test Loss: 6.007 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1588406562805176
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.997 Vali Acc: 0.302 Test Loss: 5.997 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.135805606842041
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.025 Vali Acc: 0.300 Test Loss: 6.025 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.086083173751831
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.016 Vali Acc: 0.304 Test Loss: 6.016 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 44244506
model size : 183.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1976335048675537
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.355 Vali Acc: 0.036 Test Loss: 3.355 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.6949286460876465
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.330 Vali Acc: 0.040 Test Loss: 3.330 Test Acc: 0.040
Validation loss decreased (-0.036437 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.984877347946167
Epoch: 3, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.329 Vali Acc: 0.076 Test Loss: 3.329 Test Acc: 0.076
Validation loss decreased (-0.039967 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.9669179916381836
Epoch: 4, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.286 Vali Acc: 0.076 Test Loss: 3.286 Test Acc: 0.076
Validation loss decreased (-0.076437 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.1555447578430176
Epoch: 5, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.207 Vali Acc: 0.104 Test Loss: 3.207 Test Acc: 0.104
Validation loss decreased (-0.076438 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 1.1646418571472168
Epoch: 6, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.173 Vali Acc: 0.133 Test Loss: 3.173 Test Acc: 0.133
Validation loss decreased (-0.103497 --> -0.132909).  Saving model ...
Epoch: 7 cost time: 1.0147874355316162
Epoch: 7, Steps: 10 | Train Loss: 1.863 Vali Loss: 3.223 Vali Acc: 0.188 Test Loss: 3.223 Test Acc: 0.188
Validation loss decreased (-0.132909 --> -0.188203).  Saving model ...
Epoch: 8 cost time: 1.0750412940979004
Epoch: 8, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.484 Vali Acc: 0.199 Test Loss: 3.484 Test Acc: 0.199
Validation loss decreased (-0.188203 --> -0.198789).  Saving model ...
Epoch: 9 cost time: 1.2494494915008545
Epoch: 9, Steps: 10 | Train Loss: 0.980 Vali Loss: 3.727 Vali Acc: 0.247 Test Loss: 3.727 Test Acc: 0.247
Validation loss decreased (-0.198789 --> -0.247022).  Saving model ...
Epoch: 10 cost time: 1.2601318359375
Epoch: 10, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.921 Vali Acc: 0.242 Test Loss: 3.921 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9441936016082764
Epoch: 11, Steps: 10 | Train Loss: 0.331 Vali Loss: 4.151 Vali Acc: 0.256 Test Loss: 4.151 Test Acc: 0.256
Validation loss decreased (-0.247022 --> -0.256429).  Saving model ...
Epoch: 12 cost time: 0.8127391338348389
Epoch: 12, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.210 Vali Acc: 0.284 Test Loss: 4.210 Test Acc: 0.284
Validation loss decreased (-0.256429 --> -0.283487).  Saving model ...
Epoch: 13 cost time: 1.1033806800842285
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.503 Vali Acc: 0.272 Test Loss: 4.503 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1018869876861572
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.694 Vali Acc: 0.258 Test Loss: 4.694 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9806439876556396
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.767 Vali Acc: 0.288 Test Loss: 4.767 Test Acc: 0.288
Validation loss decreased (-0.283487 --> -0.288188).  Saving model ...
Epoch: 16 cost time: 0.9233641624450684
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.907 Vali Acc: 0.280 Test Loss: 4.907 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8905797004699707
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.970 Vali Acc: 0.281 Test Loss: 4.970 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8918960094451904
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.145 Vali Acc: 0.273 Test Loss: 5.145 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.014833688735962
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.114 Vali Acc: 0.288 Test Loss: 5.114 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8708183765411377
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.149 Vali Acc: 0.294 Test Loss: 5.149 Test Acc: 0.294
Validation loss decreased (-0.288188 --> -0.294066).  Saving model ...
Epoch: 21 cost time: 1.0531516075134277
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.152 Vali Acc: 0.291 Test Loss: 5.152 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2367496490478516
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.150 Vali Acc: 0.298 Test Loss: 5.150 Test Acc: 0.298
Validation loss decreased (-0.294066 --> -0.297596).  Saving model ...
Epoch: 23 cost time: 0.722489595413208
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.130 Vali Acc: 0.295 Test Loss: 5.130 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0223727226257324
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.175 Vali Acc: 0.296 Test Loss: 5.175 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.735020637512207
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.225 Vali Acc: 0.305 Test Loss: 5.225 Test Acc: 0.305
Validation loss decreased (-0.297596 --> -0.304654).  Saving model ...
Epoch: 26 cost time: 0.9887440204620361
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.234 Vali Acc: 0.306 Test Loss: 5.234 Test Acc: 0.306
Validation loss decreased (-0.304654 --> -0.305830).  Saving model ...
Epoch: 27 cost time: 0.8809072971343994
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.245 Vali Acc: 0.304 Test Loss: 5.245 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1324622631072998
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.264 Vali Acc: 0.304 Test Loss: 5.264 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0156433582305908
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.246 Vali Acc: 0.304 Test Loss: 5.246 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9203522205352783
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.230 Vali Acc: 0.308 Test Loss: 5.230 Test Acc: 0.308
Validation loss decreased (-0.305830 --> -0.308183).  Saving model ...
Epoch: 31 cost time: 1.0499556064605713
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.246 Vali Acc: 0.305 Test Loss: 5.246 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0422751903533936
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.271 Vali Acc: 0.304 Test Loss: 5.271 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0272374153137207
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.266 Vali Acc: 0.308 Test Loss: 5.266 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0961511135101318
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.268 Vali Acc: 0.309 Test Loss: 5.268 Test Acc: 0.309
Validation loss decreased (-0.308183 --> -0.309359).  Saving model ...
Epoch: 35 cost time: 1.0767161846160889
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.317 Vali Acc: 0.304 Test Loss: 5.317 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9762492179870605
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.323 Vali Acc: 0.311 Test Loss: 5.323 Test Acc: 0.311
Validation loss decreased (-0.309359 --> -0.310535).  Saving model ...
Epoch: 37 cost time: 0.9729211330413818
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.320 Vali Acc: 0.311 Test Loss: 5.320 Test Acc: 0.311
Validation loss decreased (-0.310535 --> -0.310535).  Saving model ...
Epoch: 38 cost time: 0.6336774826049805
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.325 Vali Acc: 0.306 Test Loss: 5.325 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.022139310836792
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.332 Vali Acc: 0.311 Test Loss: 5.332 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1956896781921387
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.347 Vali Acc: 0.309 Test Loss: 5.347 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2018842697143555
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.357 Vali Acc: 0.309 Test Loss: 5.357 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8062083721160889
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.358 Vali Acc: 0.307 Test Loss: 5.358 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2129740715026855
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.361 Vali Acc: 0.305 Test Loss: 5.361 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.245168924331665
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.368 Vali Acc: 0.312 Test Loss: 5.368 Test Acc: 0.312
Validation loss decreased (-0.310535 --> -0.311711).  Saving model ...
Epoch: 45 cost time: 1.2652041912078857
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.376 Vali Acc: 0.311 Test Loss: 5.376 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.104480504989624
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.394 Vali Acc: 0.308 Test Loss: 5.394 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2521178722381592
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.416 Vali Acc: 0.307 Test Loss: 5.416 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.126018762588501
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.441 Vali Acc: 0.306 Test Loss: 5.441 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1521174907684326
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.458 Vali Acc: 0.308 Test Loss: 5.458 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1037626266479492
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.460 Vali Acc: 0.306 Test Loss: 5.460 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 43921946
model size : 182.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1263692378997803
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.327 Vali Acc: 0.051 Test Loss: 3.327 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.7043147087097168
Epoch: 2, Steps: 10 | Train Loss: 3.179 Vali Loss: 3.297 Vali Acc: 0.054 Test Loss: 3.297 Test Acc: 0.054
Validation loss decreased (-0.050555 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.8982656002044678
Epoch: 3, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.321 Vali Acc: 0.071 Test Loss: 3.321 Test Acc: 0.071
Validation loss decreased (-0.054085 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.8981337547302246
Epoch: 4, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.308 Vali Acc: 0.078 Test Loss: 3.308 Test Acc: 0.078
Validation loss decreased (-0.070555 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 0.6872289180755615
Epoch: 5, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.274 Vali Acc: 0.096 Test Loss: 3.274 Test Acc: 0.096
Validation loss decreased (-0.077614 --> -0.096438).  Saving model ...
Epoch: 6 cost time: 0.7701108455657959
Epoch: 6, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.236 Vali Acc: 0.107 Test Loss: 3.236 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 0.7137930393218994
Epoch: 7, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.188 Vali Acc: 0.136 Test Loss: 3.188 Test Acc: 0.136
Validation loss decreased (-0.107026 --> -0.136439).  Saving model ...
Epoch: 8 cost time: 0.7229113578796387
Epoch: 8, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.150 Vali Acc: 0.171 Test Loss: 3.150 Test Acc: 0.171
Validation loss decreased (-0.136439 --> -0.170557).  Saving model ...
Epoch: 9 cost time: 0.7546985149383545
Epoch: 9, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.265 Vali Acc: 0.185 Test Loss: 3.265 Test Acc: 0.185
Validation loss decreased (-0.170557 --> -0.184673).  Saving model ...
Epoch: 10 cost time: 0.9111096858978271
Epoch: 10, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.413 Vali Acc: 0.187 Test Loss: 3.413 Test Acc: 0.187
Validation loss decreased (-0.184673 --> -0.187025).  Saving model ...
Epoch: 11 cost time: 0.7326269149780273
Epoch: 11, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.597 Vali Acc: 0.208 Test Loss: 3.597 Test Acc: 0.208
Validation loss decreased (-0.187025 --> -0.208199).  Saving model ...
Epoch: 12 cost time: 0.669858455657959
Epoch: 12, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.669 Vali Acc: 0.216 Test Loss: 3.669 Test Acc: 0.216
Validation loss decreased (-0.208199 --> -0.216434).  Saving model ...
Epoch: 13 cost time: 0.778275728225708
Epoch: 13, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.842 Vali Acc: 0.240 Test Loss: 3.842 Test Acc: 0.240
Validation loss decreased (-0.216434 --> -0.239962).  Saving model ...
Epoch: 14 cost time: 0.6875801086425781
Epoch: 14, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.894 Vali Acc: 0.258 Test Loss: 3.894 Test Acc: 0.258
Validation loss decreased (-0.239962 --> -0.257608).  Saving model ...
Epoch: 15 cost time: 0.7279610633850098
Epoch: 15, Steps: 10 | Train Loss: 0.221 Vali Loss: 4.014 Vali Acc: 0.253 Test Loss: 4.014 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7314488887786865
Epoch: 16, Steps: 10 | Train Loss: 0.161 Vali Loss: 4.195 Vali Acc: 0.261 Test Loss: 4.195 Test Acc: 0.261
Validation loss decreased (-0.257608 --> -0.261135).  Saving model ...
Epoch: 17 cost time: 0.6585445404052734
Epoch: 17, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.214 Vali Acc: 0.282 Test Loss: 4.214 Test Acc: 0.282
Validation loss decreased (-0.261135 --> -0.282311).  Saving model ...
Epoch: 18 cost time: 0.6664590835571289
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.285 Vali Acc: 0.281 Test Loss: 4.285 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4935266971588135
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.270 Vali Acc: 0.289 Test Loss: 4.270 Test Acc: 0.289
Validation loss decreased (-0.282311 --> -0.289369).  Saving model ...
Epoch: 20 cost time: 0.6753194332122803
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.323 Vali Acc: 0.285 Test Loss: 4.323 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6850507259368896
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.383 Vali Acc: 0.295 Test Loss: 4.383 Test Acc: 0.295
Validation loss decreased (-0.289369 --> -0.295250).  Saving model ...
Epoch: 22 cost time: 0.7868430614471436
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.444 Vali Acc: 0.299 Test Loss: 4.444 Test Acc: 0.299
Validation loss decreased (-0.295250 --> -0.298779).  Saving model ...
Epoch: 23 cost time: 0.7320258617401123
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.589 Vali Acc: 0.286 Test Loss: 4.589 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.541358470916748
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.586 Vali Acc: 0.293 Test Loss: 4.586 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5806126594543457
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.602 Vali Acc: 0.294 Test Loss: 4.602 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5586719512939453
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.706 Vali Acc: 0.291 Test Loss: 4.706 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8452255725860596
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.751 Vali Acc: 0.281 Test Loss: 4.751 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8174147605895996
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.787 Vali Acc: 0.289 Test Loss: 4.787 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7437968254089355
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.752 Vali Acc: 0.291 Test Loss: 4.752 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8497674465179443
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.766 Vali Acc: 0.295 Test Loss: 4.766 Test Acc: 0.295
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8424115180969238
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.799 Vali Acc: 0.284 Test Loss: 4.799 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8695647716522217
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.801 Vali Acc: 0.294 Test Loss: 4.801 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 43706906
model size : 181.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5497348308563232
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.333 Vali Acc: 0.039 Test Loss: 3.333 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.0074267387390137
Epoch: 2, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.384 Vali Acc: 0.096 Test Loss: 3.384 Test Acc: 0.096
Validation loss decreased (-0.038790 --> -0.096437).  Saving model ...
Epoch: 3 cost time: 1.0301294326782227
Epoch: 3, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.313 Vali Acc: 0.112 Test Loss: 3.313 Test Acc: 0.112
Validation loss decreased (-0.096437 --> -0.111732).  Saving model ...
Epoch: 4 cost time: 1.1076462268829346
Epoch: 4, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.178 Vali Acc: 0.142 Test Loss: 3.178 Test Acc: 0.142
Validation loss decreased (-0.111732 --> -0.142321).  Saving model ...
Epoch: 5 cost time: 1.0685961246490479
Epoch: 5, Steps: 10 | Train Loss: 2.419 Vali Loss: 3.171 Vali Acc: 0.188 Test Loss: 3.171 Test Acc: 0.188
Validation loss decreased (-0.142321 --> -0.188204).  Saving model ...
Epoch: 6 cost time: 1.2505829334259033
Epoch: 6, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.234 Vali Acc: 0.207 Test Loss: 3.234 Test Acc: 0.207
Validation loss decreased (-0.188204 --> -0.207026).  Saving model ...
Epoch: 7 cost time: 1.1665184497833252
Epoch: 7, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.576 Vali Acc: 0.236 Test Loss: 3.576 Test Acc: 0.236
Validation loss decreased (-0.207026 --> -0.236435).  Saving model ...
Epoch: 8 cost time: 1.059845209121704
Epoch: 8, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.940 Vali Acc: 0.245 Test Loss: 3.940 Test Acc: 0.245
Validation loss decreased (-0.236435 --> -0.244666).  Saving model ...
Epoch: 9 cost time: 0.9865033626556396
Epoch: 9, Steps: 10 | Train Loss: 0.411 Vali Loss: 4.444 Vali Acc: 0.240 Test Loss: 4.444 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1193656921386719
Epoch: 10, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.801 Vali Acc: 0.258 Test Loss: 4.801 Test Acc: 0.258
Validation loss decreased (-0.244666 --> -0.257599).  Saving model ...
Epoch: 11 cost time: 1.0149385929107666
Epoch: 11, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.889 Vali Acc: 0.294 Test Loss: 4.889 Test Acc: 0.294
Validation loss decreased (-0.257599 --> -0.294069).  Saving model ...
Epoch: 12 cost time: 0.9596419334411621
Epoch: 12, Steps: 10 | Train Loss: 0.094 Vali Loss: 5.413 Vali Acc: 0.267 Test Loss: 5.413 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7460827827453613
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.449 Vali Acc: 0.282 Test Loss: 5.449 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0344011783599854
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.656 Vali Acc: 0.276 Test Loss: 5.656 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8592262268066406
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.900 Vali Acc: 0.274 Test Loss: 5.900 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.315445899963379
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.820 Vali Acc: 0.294 Test Loss: 5.820 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9590084552764893
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 6.037 Vali Acc: 0.288 Test Loss: 6.037 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.317784070968628
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.966 Vali Acc: 0.287 Test Loss: 5.966 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.373548984527588
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 5.919 Vali Acc: 0.282 Test Loss: 5.919 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3440525531768799
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.977 Vali Acc: 0.272 Test Loss: 5.977 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2561728954315186
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.886 Vali Acc: 0.289 Test Loss: 5.886 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29411764705882354
model parameter : 44258330
model size : 183.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.877664804458618
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.332 Vali Acc: 0.045 Test Loss: 3.332 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.8906512260437012
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.358 Vali Acc: 0.060 Test Loss: 3.358 Test Acc: 0.060
Validation loss decreased (-0.044673 --> -0.059966).  Saving model ...
Epoch: 3 cost time: 1.0767486095428467
Epoch: 3, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.330 Vali Acc: 0.085 Test Loss: 3.330 Test Acc: 0.085
Validation loss decreased (-0.059966 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 1.068716287612915
Epoch: 4, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.275 Vali Acc: 0.102 Test Loss: 3.275 Test Acc: 0.102
Validation loss decreased (-0.084673 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 0.6760764122009277
Epoch: 5, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.242 Vali Acc: 0.109 Test Loss: 3.242 Test Acc: 0.109
Validation loss decreased (-0.102320 --> -0.109379).  Saving model ...
Epoch: 6 cost time: 1.335676908493042
Epoch: 6, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.186 Vali Acc: 0.152 Test Loss: 3.186 Test Acc: 0.152
Validation loss decreased (-0.109379 --> -0.151733).  Saving model ...
Epoch: 7 cost time: 1.1496186256408691
Epoch: 7, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.165 Vali Acc: 0.156 Test Loss: 3.165 Test Acc: 0.156
Validation loss decreased (-0.151733 --> -0.156439).  Saving model ...
Epoch: 8 cost time: 0.9976980686187744
Epoch: 8, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.319 Vali Acc: 0.208 Test Loss: 3.319 Test Acc: 0.208
Validation loss decreased (-0.156439 --> -0.208202).  Saving model ...
Epoch: 9 cost time: 1.0451760292053223
Epoch: 9, Steps: 10 | Train Loss: 1.164 Vali Loss: 3.469 Vali Acc: 0.228 Test Loss: 3.469 Test Acc: 0.228
Validation loss decreased (-0.208202 --> -0.228201).  Saving model ...
Epoch: 10 cost time: 0.9976606369018555
Epoch: 10, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.809 Vali Acc: 0.248 Test Loss: 3.809 Test Acc: 0.248
Validation loss decreased (-0.228201 --> -0.248197).  Saving model ...
Epoch: 11 cost time: 1.0497004985809326
Epoch: 11, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.950 Vali Acc: 0.279 Test Loss: 3.950 Test Acc: 0.279
Validation loss decreased (-0.248197 --> -0.278784).  Saving model ...
Epoch: 12 cost time: 1.1232154369354248
Epoch: 12, Steps: 10 | Train Loss: 0.334 Vali Loss: 4.174 Vali Acc: 0.291 Test Loss: 4.174 Test Acc: 0.291
Validation loss decreased (-0.278784 --> -0.290546).  Saving model ...
Epoch: 13 cost time: 1.2532134056091309
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 4.404 Vali Acc: 0.274 Test Loss: 4.404 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0237057209014893
Epoch: 14, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.513 Vali Acc: 0.304 Test Loss: 4.513 Test Acc: 0.304
Validation loss decreased (-0.290546 --> -0.303484).  Saving model ...
Epoch: 15 cost time: 1.2096624374389648
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.744 Vali Acc: 0.294 Test Loss: 4.744 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2741820812225342
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.770 Vali Acc: 0.305 Test Loss: 4.770 Test Acc: 0.305
Validation loss decreased (-0.303484 --> -0.304658).  Saving model ...
Epoch: 17 cost time: 0.9580256938934326
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.056 Vali Acc: 0.279 Test Loss: 5.056 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9643011093139648
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.959 Vali Acc: 0.292 Test Loss: 4.959 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1864817142486572
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.972 Vali Acc: 0.302 Test Loss: 4.972 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0239286422729492
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.045 Vali Acc: 0.305 Test Loss: 5.045 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1377882957458496
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.142 Vali Acc: 0.294 Test Loss: 5.142 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3059773445129395
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.189 Vali Acc: 0.294 Test Loss: 5.189 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4278926849365234
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.049 Vali Acc: 0.314 Test Loss: 5.049 Test Acc: 0.314
Validation loss decreased (-0.304658 --> -0.314067).  Saving model ...
Epoch: 24 cost time: 1.3293027877807617
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.104 Vali Acc: 0.308 Test Loss: 5.104 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2692761421203613
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.241 Vali Acc: 0.302 Test Loss: 5.241 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1035242080688477
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.223 Vali Acc: 0.301 Test Loss: 5.223 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1777026653289795
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.145 Vali Acc: 0.308 Test Loss: 5.145 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1968426704406738
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.246 Vali Acc: 0.313 Test Loss: 5.246 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9493865966796875
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.257 Vali Acc: 0.309 Test Loss: 5.257 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2356445789337158
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.267 Vali Acc: 0.311 Test Loss: 5.267 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.07243013381958
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.266 Vali Acc: 0.314 Test Loss: 5.266 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.005990982055664
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.283 Vali Acc: 0.313 Test Loss: 5.283 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1476836204528809
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.269 Vali Acc: 0.318 Test Loss: 5.269 Test Acc: 0.318
Validation loss decreased (-0.314067 --> -0.317594).  Saving model ...
Epoch: 34 cost time: 0.9905776977539062
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.275 Vali Acc: 0.311 Test Loss: 5.275 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0631084442138672
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.299 Vali Acc: 0.314 Test Loss: 5.299 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.053081750869751
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.340 Vali Acc: 0.315 Test Loss: 5.340 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.178349256515503
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.369 Vali Acc: 0.315 Test Loss: 5.369 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1221425533294678
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.395 Vali Acc: 0.318 Test Loss: 5.395 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0399911403656006
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.402 Vali Acc: 0.313 Test Loss: 5.402 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1325299739837646
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.386 Vali Acc: 0.312 Test Loss: 5.386 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.031893014907837
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.422 Vali Acc: 0.318 Test Loss: 5.422 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1054024696350098
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.457 Vali Acc: 0.315 Test Loss: 5.457 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6280953884124756
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.424 Vali Acc: 0.313 Test Loss: 5.424 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 43892762
model size : 182.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2864134311676025
Epoch: 1, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.395 Vali Acc: 0.047 Test Loss: 3.395 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.7319073677062988
Epoch: 2, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.333 Vali Acc: 0.040 Test Loss: 3.333 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6581752300262451
Epoch: 3, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.302 Vali Acc: 0.060 Test Loss: 3.302 Test Acc: 0.060
Validation loss decreased (-0.047025 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.7411763668060303
Epoch: 4, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.287 Vali Acc: 0.064 Test Loss: 3.287 Test Acc: 0.064
Validation loss decreased (-0.059967 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.6732721328735352
Epoch: 5, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.278 Vali Acc: 0.085 Test Loss: 3.278 Test Acc: 0.085
Validation loss decreased (-0.063497 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.7120881080627441
Epoch: 6, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.256 Vali Acc: 0.119 Test Loss: 3.256 Test Acc: 0.119
Validation loss decreased (-0.084673 --> -0.118791).  Saving model ...
Epoch: 7 cost time: 0.7339873313903809
Epoch: 7, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.195 Vali Acc: 0.139 Test Loss: 3.195 Test Acc: 0.139
Validation loss decreased (-0.118791 --> -0.138792).  Saving model ...
Epoch: 8 cost time: 0.5451710224151611
Epoch: 8, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.198 Vali Acc: 0.164 Test Loss: 3.198 Test Acc: 0.164
Validation loss decreased (-0.138792 --> -0.163497).  Saving model ...
Epoch: 9 cost time: 0.6764283180236816
Epoch: 9, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.330 Vali Acc: 0.181 Test Loss: 3.330 Test Acc: 0.181
Validation loss decreased (-0.163497 --> -0.181143).  Saving model ...
Epoch: 10 cost time: 0.5524423122406006
Epoch: 10, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.407 Vali Acc: 0.196 Test Loss: 3.407 Test Acc: 0.196
Validation loss decreased (-0.181143 --> -0.196437).  Saving model ...
Epoch: 11 cost time: 0.7105212211608887
Epoch: 11, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.437 Vali Acc: 0.216 Test Loss: 3.437 Test Acc: 0.216
Validation loss decreased (-0.196437 --> -0.216436).  Saving model ...
Epoch: 12 cost time: 0.6665759086608887
Epoch: 12, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.586 Vali Acc: 0.221 Test Loss: 3.586 Test Acc: 0.221
Validation loss decreased (-0.216436 --> -0.221141).  Saving model ...
Epoch: 13 cost time: 0.6057708263397217
Epoch: 13, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.621 Vali Acc: 0.249 Test Loss: 3.621 Test Acc: 0.249
Validation loss decreased (-0.221141 --> -0.249376).  Saving model ...
Epoch: 14 cost time: 0.6119322776794434
Epoch: 14, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.768 Vali Acc: 0.260 Test Loss: 3.768 Test Acc: 0.260
Validation loss decreased (-0.249376 --> -0.259962).  Saving model ...
Epoch: 15 cost time: 0.7339036464691162
Epoch: 15, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.902 Vali Acc: 0.272 Test Loss: 3.902 Test Acc: 0.272
Validation loss decreased (-0.259962 --> -0.271726).  Saving model ...
Epoch: 16 cost time: 0.6372537612915039
Epoch: 16, Steps: 10 | Train Loss: 0.174 Vali Loss: 4.060 Vali Acc: 0.255 Test Loss: 4.060 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5933578014373779
Epoch: 17, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.027 Vali Acc: 0.279 Test Loss: 4.027 Test Acc: 0.279
Validation loss decreased (-0.271726 --> -0.278783).  Saving model ...
Epoch: 18 cost time: 0.6222264766693115
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.254 Vali Acc: 0.267 Test Loss: 4.254 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.607975959777832
Epoch: 19, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.347 Vali Acc: 0.271 Test Loss: 4.347 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6152892112731934
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.336 Vali Acc: 0.284 Test Loss: 4.336 Test Acc: 0.284
Validation loss decreased (-0.278783 --> -0.283486).  Saving model ...
Epoch: 21 cost time: 0.6876735687255859
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.367 Vali Acc: 0.279 Test Loss: 4.367 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6248462200164795
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.519 Vali Acc: 0.267 Test Loss: 4.519 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6760175228118896
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.518 Vali Acc: 0.286 Test Loss: 4.518 Test Acc: 0.286
Validation loss decreased (-0.283486 --> -0.285837).  Saving model ...
Epoch: 24 cost time: 0.663999080657959
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.489 Vali Acc: 0.289 Test Loss: 4.489 Test Acc: 0.289
Validation loss decreased (-0.285837 --> -0.289367).  Saving model ...
Epoch: 25 cost time: 0.6992049217224121
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.510 Vali Acc: 0.288 Test Loss: 4.510 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6677184104919434
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.526 Vali Acc: 0.287 Test Loss: 4.526 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6260087490081787
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.540 Vali Acc: 0.288 Test Loss: 4.540 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6762747764587402
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.532 Vali Acc: 0.293 Test Loss: 4.532 Test Acc: 0.293
Validation loss decreased (-0.289367 --> -0.292896).  Saving model ...
Epoch: 29 cost time: 0.8024938106536865
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.550 Vali Acc: 0.296 Test Loss: 4.550 Test Acc: 0.296
Validation loss decreased (-0.292896 --> -0.296425).  Saving model ...
Epoch: 30 cost time: 0.7184188365936279
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.560 Vali Acc: 0.292 Test Loss: 4.560 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6193971633911133
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.602 Vali Acc: 0.296 Test Loss: 4.602 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6288917064666748
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.649 Vali Acc: 0.286 Test Loss: 4.649 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6913259029388428
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.652 Vali Acc: 0.288 Test Loss: 4.652 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8301401138305664
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.644 Vali Acc: 0.294 Test Loss: 4.644 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6508808135986328
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.655 Vali Acc: 0.301 Test Loss: 4.655 Test Acc: 0.301
Validation loss decreased (-0.296425 --> -0.301130).  Saving model ...
Epoch: 36 cost time: 0.6448824405670166
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.666 Vali Acc: 0.301 Test Loss: 4.666 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.728837251663208
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.696 Vali Acc: 0.300 Test Loss: 4.696 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6721117496490479
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.720 Vali Acc: 0.296 Test Loss: 4.720 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7234029769897461
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.753 Vali Acc: 0.295 Test Loss: 4.753 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7326512336730957
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.773 Vali Acc: 0.292 Test Loss: 4.773 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7479820251464844
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.772 Vali Acc: 0.292 Test Loss: 4.772 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6457598209381104
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.774 Vali Acc: 0.301 Test Loss: 4.774 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6491947174072266
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.769 Vali Acc: 0.298 Test Loss: 4.769 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6517384052276611
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.770 Vali Acc: 0.295 Test Loss: 4.770 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5922746658325195
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.799 Vali Acc: 0.294 Test Loss: 4.799 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 43699226
model size : 181.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6176462173461914
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.293 Vali Acc: 0.042 Test Loss: 3.293 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.1244053840637207
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.403 Vali Acc: 0.078 Test Loss: 3.403 Test Acc: 0.078
Validation loss decreased (-0.042320 --> -0.077613).  Saving model ...
Epoch: 3 cost time: 1.2144005298614502
Epoch: 3, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.323 Vali Acc: 0.068 Test Loss: 3.323 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0167102813720703
Epoch: 4, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.236 Vali Acc: 0.119 Test Loss: 3.236 Test Acc: 0.119
Validation loss decreased (-0.077613 --> -0.118791).  Saving model ...
Epoch: 5 cost time: 1.0233154296875
Epoch: 5, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.178 Vali Acc: 0.139 Test Loss: 3.178 Test Acc: 0.139
Validation loss decreased (-0.118791 --> -0.138792).  Saving model ...
Epoch: 6 cost time: 0.9511921405792236
Epoch: 6, Steps: 10 | Train Loss: 1.906 Vali Loss: 3.302 Vali Acc: 0.200 Test Loss: 3.302 Test Acc: 0.200
Validation loss decreased (-0.138792 --> -0.199967).  Saving model ...
Epoch: 7 cost time: 1.0463147163391113
Epoch: 7, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.595 Vali Acc: 0.205 Test Loss: 3.595 Test Acc: 0.205
Validation loss decreased (-0.199967 --> -0.204670).  Saving model ...
Epoch: 8 cost time: 1.1449987888336182
Epoch: 8, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.716 Vali Acc: 0.227 Test Loss: 3.716 Test Acc: 0.227
Validation loss decreased (-0.204670 --> -0.227022).  Saving model ...
Epoch: 9 cost time: 1.106462001800537
Epoch: 9, Steps: 10 | Train Loss: 0.459 Vali Loss: 4.140 Vali Acc: 0.232 Test Loss: 4.140 Test Acc: 0.232
Validation loss decreased (-0.227022 --> -0.231723).  Saving model ...
Epoch: 10 cost time: 1.1909582614898682
Epoch: 10, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.322 Vali Acc: 0.244 Test Loss: 4.322 Test Acc: 0.244
Validation loss decreased (-0.231723 --> -0.243486).  Saving model ...
Epoch: 11 cost time: 0.9961881637573242
Epoch: 11, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.530 Vali Acc: 0.273 Test Loss: 4.530 Test Acc: 0.273
Validation loss decreased (-0.243486 --> -0.272896).  Saving model ...
Epoch: 12 cost time: 0.6754777431488037
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.858 Vali Acc: 0.268 Test Loss: 4.858 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8547229766845703
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.116 Vali Acc: 0.260 Test Loss: 5.116 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8748574256896973
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.297 Vali Acc: 0.284 Test Loss: 5.297 Test Acc: 0.284
Validation loss decreased (-0.272896 --> -0.283476).  Saving model ...
Epoch: 15 cost time: 1.1184563636779785
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.326 Vali Acc: 0.294 Test Loss: 5.326 Test Acc: 0.294
Validation loss decreased (-0.283476 --> -0.294064).  Saving model ...
Epoch: 16 cost time: 0.9738123416900635
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.380 Vali Acc: 0.276 Test Loss: 5.380 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1219804286956787
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.413 Vali Acc: 0.282 Test Loss: 5.413 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9740259647369385
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.381 Vali Acc: 0.288 Test Loss: 5.381 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.341275691986084
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.285 Vali Acc: 0.294 Test Loss: 5.285 Test Acc: 0.294
Validation loss decreased (-0.294064 --> -0.294065).  Saving model ...
Epoch: 20 cost time: 1.0455241203308105
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.367 Vali Acc: 0.289 Test Loss: 5.367 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9422545433044434
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.742 Vali Acc: 0.273 Test Loss: 5.742 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8766598701477051
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.482 Vali Acc: 0.286 Test Loss: 5.482 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6371111869812012
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.397 Vali Acc: 0.299 Test Loss: 5.397 Test Acc: 0.299
Validation loss decreased (-0.294065 --> -0.298770).  Saving model ...
Epoch: 24 cost time: 1.1584079265594482
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.408 Vali Acc: 0.296 Test Loss: 5.408 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1094119548797607
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.421 Vali Acc: 0.296 Test Loss: 5.421 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2907335758209229
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.744 Vali Acc: 0.276 Test Loss: 5.744 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.527860164642334
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.795 Vali Acc: 0.281 Test Loss: 5.795 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2127645015716553
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.759 Vali Acc: 0.286 Test Loss: 5.759 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2016921043395996
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.669 Vali Acc: 0.285 Test Loss: 5.669 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1335089206695557
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.663 Vali Acc: 0.289 Test Loss: 5.663 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2883095741271973
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.794 Vali Acc: 0.286 Test Loss: 5.794 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.230374813079834
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.679 Vali Acc: 0.288 Test Loss: 5.679 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1141924858093262
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.065 Vali Acc: 0.280 Test Loss: 6.065 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 44114714
model size : 182.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.232879161834717
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.318 Vali Acc: 0.034 Test Loss: 3.318 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.9978232383728027
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.338 Vali Acc: 0.044 Test Loss: 3.338 Test Acc: 0.044
Validation loss decreased (-0.034084 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.8929650783538818
Epoch: 3, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.345 Vali Acc: 0.085 Test Loss: 3.345 Test Acc: 0.085
Validation loss decreased (-0.043496 --> -0.084672).  Saving model ...
Epoch: 4 cost time: 1.0454940795898438
Epoch: 4, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.273 Vali Acc: 0.086 Test Loss: 3.273 Test Acc: 0.086
Validation loss decreased (-0.084672 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.9824304580688477
Epoch: 5, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.252 Vali Acc: 0.105 Test Loss: 3.252 Test Acc: 0.105
Validation loss decreased (-0.085850 --> -0.104673).  Saving model ...
Epoch: 6 cost time: 0.8433837890625
Epoch: 6, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.171 Vali Acc: 0.146 Test Loss: 3.171 Test Acc: 0.146
Validation loss decreased (-0.104673 --> -0.145851).  Saving model ...
Epoch: 7 cost time: 1.0516903400421143
Epoch: 7, Steps: 10 | Train Loss: 2.106 Vali Loss: 3.217 Vali Acc: 0.175 Test Loss: 3.217 Test Acc: 0.175
Validation loss decreased (-0.145851 --> -0.175262).  Saving model ...
Epoch: 8 cost time: 1.098093032836914
Epoch: 8, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.320 Vali Acc: 0.202 Test Loss: 3.320 Test Acc: 0.202
Validation loss decreased (-0.175262 --> -0.202320).  Saving model ...
Epoch: 9 cost time: 1.0608491897583008
Epoch: 9, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.521 Vali Acc: 0.219 Test Loss: 3.521 Test Acc: 0.219
Validation loss decreased (-0.202320 --> -0.218788).  Saving model ...
Epoch: 10 cost time: 0.9204192161560059
Epoch: 10, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.706 Vali Acc: 0.234 Test Loss: 3.706 Test Acc: 0.234
Validation loss decreased (-0.218788 --> -0.234081).  Saving model ...
Epoch: 11 cost time: 0.8830399513244629
Epoch: 11, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.887 Vali Acc: 0.239 Test Loss: 3.887 Test Acc: 0.239
Validation loss decreased (-0.234081 --> -0.238785).  Saving model ...
Epoch: 12 cost time: 0.8711049556732178
Epoch: 12, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.154 Vali Acc: 0.253 Test Loss: 4.154 Test Acc: 0.253
Validation loss decreased (-0.238785 --> -0.252900).  Saving model ...
Epoch: 13 cost time: 0.9084732532501221
Epoch: 13, Steps: 10 | Train Loss: 0.224 Vali Loss: 4.229 Vali Acc: 0.265 Test Loss: 4.229 Test Acc: 0.265
Validation loss decreased (-0.252900 --> -0.264664).  Saving model ...
Epoch: 14 cost time: 0.9517536163330078
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.340 Vali Acc: 0.266 Test Loss: 4.340 Test Acc: 0.266
Validation loss decreased (-0.264664 --> -0.265839).  Saving model ...
Epoch: 15 cost time: 0.8899903297424316
Epoch: 15, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.445 Vali Acc: 0.281 Test Loss: 4.445 Test Acc: 0.281
Validation loss decreased (-0.265839 --> -0.281132).  Saving model ...
Epoch: 16 cost time: 1.3194384574890137
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.606 Vali Acc: 0.276 Test Loss: 4.606 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0301342010498047
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.695 Vali Acc: 0.267 Test Loss: 4.695 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1886186599731445
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.826 Vali Acc: 0.260 Test Loss: 4.826 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1312556266784668
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.738 Vali Acc: 0.280 Test Loss: 4.738 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8467504978179932
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.685 Vali Acc: 0.296 Test Loss: 4.685 Test Acc: 0.296
Validation loss decreased (-0.281132 --> -0.296424).  Saving model ...
Epoch: 21 cost time: 1.0146069526672363
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.750 Vali Acc: 0.295 Test Loss: 4.750 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6752607822418213
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.817 Vali Acc: 0.294 Test Loss: 4.817 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7367904186248779
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.859 Vali Acc: 0.291 Test Loss: 4.859 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6405529975891113
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.853 Vali Acc: 0.289 Test Loss: 4.853 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7477631568908691
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.840 Vali Acc: 0.287 Test Loss: 4.840 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6243853569030762
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.852 Vali Acc: 0.294 Test Loss: 4.852 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.668532133102417
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.886 Vali Acc: 0.295 Test Loss: 4.886 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.687004566192627
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.924 Vali Acc: 0.294 Test Loss: 4.924 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5831539630889893
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.996 Vali Acc: 0.295 Test Loss: 4.996 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7965960502624512
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.015 Vali Acc: 0.294 Test Loss: 5.015 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 43856666
model size : 181.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.023237466812134
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.370 Vali Acc: 0.024 Test Loss: 3.370 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 0.6677255630493164
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.345 Vali Acc: 0.045 Test Loss: 3.345 Test Acc: 0.045
Validation loss decreased (-0.023496 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 0.6992549896240234
Epoch: 3, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.362 Vali Acc: 0.060 Test Loss: 3.362 Test Acc: 0.060
Validation loss decreased (-0.044672 --> -0.059966).  Saving model ...
Epoch: 4 cost time: 0.6016795635223389
Epoch: 4, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.328 Vali Acc: 0.069 Test Loss: 3.328 Test Acc: 0.069
Validation loss decreased (-0.059966 --> -0.069378).  Saving model ...
Epoch: 5 cost time: 0.5982732772827148
Epoch: 5, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.288 Vali Acc: 0.079 Test Loss: 3.288 Test Acc: 0.079
Validation loss decreased (-0.069378 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.6149861812591553
Epoch: 6, Steps: 10 | Train Loss: 2.777 Vali Loss: 3.274 Vali Acc: 0.101 Test Loss: 3.274 Test Acc: 0.101
Validation loss decreased (-0.078791 --> -0.101144).  Saving model ...
Epoch: 7 cost time: 0.5998218059539795
Epoch: 7, Steps: 10 | Train Loss: 2.576 Vali Loss: 3.231 Vali Acc: 0.112 Test Loss: 3.231 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.6998729705810547
Epoch: 8, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.258 Vali Acc: 0.132 Test Loss: 3.258 Test Acc: 0.132
Validation loss decreased (-0.111732 --> -0.131732).  Saving model ...
Epoch: 9 cost time: 0.6957168579101562
Epoch: 9, Steps: 10 | Train Loss: 1.934 Vali Loss: 3.244 Vali Acc: 0.165 Test Loss: 3.244 Test Acc: 0.165
Validation loss decreased (-0.131732 --> -0.164673).  Saving model ...
Epoch: 10 cost time: 0.7275547981262207
Epoch: 10, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.358 Vali Acc: 0.189 Test Loss: 3.358 Test Acc: 0.189
Validation loss decreased (-0.164673 --> -0.189378).  Saving model ...
Epoch: 11 cost time: 0.618861198425293
Epoch: 11, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.522 Vali Acc: 0.206 Test Loss: 3.522 Test Acc: 0.206
Validation loss decreased (-0.189378 --> -0.205847).  Saving model ...
Epoch: 12 cost time: 0.631840705871582
Epoch: 12, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.653 Vali Acc: 0.213 Test Loss: 3.653 Test Acc: 0.213
Validation loss decreased (-0.205847 --> -0.212905).  Saving model ...
Epoch: 13 cost time: 0.5835144519805908
Epoch: 13, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.734 Vali Acc: 0.221 Test Loss: 3.734 Test Acc: 0.221
Validation loss decreased (-0.212905 --> -0.221139).  Saving model ...
Epoch: 14 cost time: 0.661750316619873
Epoch: 14, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.842 Vali Acc: 0.249 Test Loss: 3.842 Test Acc: 0.249
Validation loss decreased (-0.221139 --> -0.249373).  Saving model ...
Epoch: 15 cost time: 0.6097066402435303
Epoch: 15, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.909 Vali Acc: 0.264 Test Loss: 3.909 Test Acc: 0.264
Validation loss decreased (-0.249373 --> -0.263490).  Saving model ...
Epoch: 16 cost time: 0.5822975635528564
Epoch: 16, Steps: 10 | Train Loss: 0.207 Vali Loss: 4.076 Vali Acc: 0.268 Test Loss: 4.076 Test Acc: 0.268
Validation loss decreased (-0.263490 --> -0.268195).  Saving model ...
Epoch: 17 cost time: 0.68389892578125
Epoch: 17, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.215 Vali Acc: 0.284 Test Loss: 4.215 Test Acc: 0.284
Validation loss decreased (-0.268195 --> -0.283487).  Saving model ...
Epoch: 18 cost time: 0.6791715621948242
Epoch: 18, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.190 Vali Acc: 0.276 Test Loss: 4.190 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7002155780792236
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.380 Vali Acc: 0.279 Test Loss: 4.380 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6087915897369385
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.454 Vali Acc: 0.268 Test Loss: 4.454 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6860735416412354
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.532 Vali Acc: 0.282 Test Loss: 4.532 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6224231719970703
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.485 Vali Acc: 0.279 Test Loss: 4.485 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6952576637268066
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.521 Vali Acc: 0.289 Test Loss: 4.521 Test Acc: 0.289
Validation loss decreased (-0.283487 --> -0.289367).  Saving model ...
Epoch: 24 cost time: 0.6120586395263672
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.614 Vali Acc: 0.286 Test Loss: 4.614 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7565593719482422
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.642 Vali Acc: 0.280 Test Loss: 4.642 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6636474132537842
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.684 Vali Acc: 0.292 Test Loss: 4.684 Test Acc: 0.292
Validation loss decreased (-0.289367 --> -0.291718).  Saving model ...
Epoch: 27 cost time: 0.6638836860656738
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.703 Vali Acc: 0.286 Test Loss: 4.703 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6369826793670654
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.700 Vali Acc: 0.292 Test Loss: 4.700 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6876094341278076
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.725 Vali Acc: 0.292 Test Loss: 4.725 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5717298984527588
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.751 Vali Acc: 0.289 Test Loss: 4.751 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5899112224578857
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.788 Vali Acc: 0.291 Test Loss: 4.788 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5849087238311768
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.806 Vali Acc: 0.288 Test Loss: 4.806 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6377594470977783
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.838 Vali Acc: 0.293 Test Loss: 4.838 Test Acc: 0.293
Validation loss decreased (-0.291718 --> -0.292893).  Saving model ...
Epoch: 34 cost time: 0.6480655670166016
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.877 Vali Acc: 0.294 Test Loss: 4.877 Test Acc: 0.294
Validation loss decreased (-0.292893 --> -0.294069).  Saving model ...
Epoch: 35 cost time: 0.6600942611694336
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.887 Vali Acc: 0.295 Test Loss: 4.887 Test Acc: 0.295
Validation loss decreased (-0.294069 --> -0.295245).  Saving model ...
Epoch: 36 cost time: 0.7009193897247314
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.942 Vali Acc: 0.289 Test Loss: 4.942 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7143056392669678
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.961 Vali Acc: 0.292 Test Loss: 4.961 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6988515853881836
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.962 Vali Acc: 0.296 Test Loss: 4.962 Test Acc: 0.296
Validation loss decreased (-0.295245 --> -0.296421).  Saving model ...
Epoch: 39 cost time: 0.6739118099212646
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.967 Vali Acc: 0.295 Test Loss: 4.967 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7324337959289551
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.969 Vali Acc: 0.293 Test Loss: 4.969 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7017414569854736
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.996 Vali Acc: 0.295 Test Loss: 4.996 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7776434421539307
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.032 Vali Acc: 0.294 Test Loss: 5.032 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6111340522766113
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.102 Vali Acc: 0.294 Test Loss: 5.102 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6823451519012451
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.101 Vali Acc: 0.291 Test Loss: 5.101 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6203505992889404
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.070 Vali Acc: 0.294 Test Loss: 5.070 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6648049354553223
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.063 Vali Acc: 0.294 Test Loss: 5.063 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6309292316436768
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.069 Vali Acc: 0.293 Test Loss: 5.069 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7609667778015137
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.077 Vali Acc: 0.291 Test Loss: 5.077 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 43684634
model size : 181.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2802200317382812
Epoch: 1, Steps: 10 | Train Loss: 3.419 Vali Loss: 3.341 Vali Acc: 0.045 Test Loss: 3.341 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.7964582443237305
Epoch: 2, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.339 Vali Acc: 0.060 Test Loss: 3.339 Test Acc: 0.060
Validation loss decreased (-0.044672 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.6227598190307617
Epoch: 3, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.328 Vali Acc: 0.087 Test Loss: 3.328 Test Acc: 0.087
Validation loss decreased (-0.059967 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 0.7419636249542236
Epoch: 4, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.251 Vali Acc: 0.105 Test Loss: 3.251 Test Acc: 0.105
Validation loss decreased (-0.087026 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 0.8371989727020264
Epoch: 5, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.166 Vali Acc: 0.129 Test Loss: 3.166 Test Acc: 0.129
Validation loss decreased (-0.104673 --> -0.129380).  Saving model ...
Epoch: 6 cost time: 0.7461466789245605
Epoch: 6, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.200 Vali Acc: 0.146 Test Loss: 3.200 Test Acc: 0.146
Validation loss decreased (-0.129380 --> -0.145850).  Saving model ...
Epoch: 7 cost time: 0.8422942161560059
Epoch: 7, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.273 Vali Acc: 0.206 Test Loss: 3.273 Test Acc: 0.206
Validation loss decreased (-0.145850 --> -0.205850).  Saving model ...
Epoch: 8 cost time: 0.8589835166931152
Epoch: 8, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.695 Vali Acc: 0.234 Test Loss: 3.695 Test Acc: 0.234
Validation loss decreased (-0.205850 --> -0.234081).  Saving model ...
Epoch: 9 cost time: 1.0103635787963867
Epoch: 9, Steps: 10 | Train Loss: 0.737 Vali Loss: 4.285 Vali Acc: 0.229 Test Loss: 4.285 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9568893909454346
Epoch: 10, Steps: 10 | Train Loss: 0.442 Vali Loss: 4.389 Vali Acc: 0.254 Test Loss: 4.389 Test Acc: 0.254
Validation loss decreased (-0.234081 --> -0.254074).  Saving model ...
Epoch: 11 cost time: 0.8202428817749023
Epoch: 11, Steps: 10 | Train Loss: 0.295 Vali Loss: 4.580 Vali Acc: 0.278 Test Loss: 4.580 Test Acc: 0.278
Validation loss decreased (-0.254074 --> -0.277601).  Saving model ...
Epoch: 12 cost time: 0.9575867652893066
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.808 Vali Acc: 0.269 Test Loss: 4.808 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1367154121398926
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 5.054 Vali Acc: 0.274 Test Loss: 5.054 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9594149589538574
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 5.136 Vali Acc: 0.278 Test Loss: 5.136 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9829823970794678
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.155 Vali Acc: 0.280 Test Loss: 5.155 Test Acc: 0.280
Validation loss decreased (-0.277601 --> -0.279948).  Saving model ...
Epoch: 16 cost time: 0.8517520427703857
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.352 Vali Acc: 0.266 Test Loss: 5.352 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8846089839935303
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.198 Vali Acc: 0.302 Test Loss: 5.198 Test Acc: 0.302
Validation loss decreased (-0.279948 --> -0.302301).  Saving model ...
Epoch: 18 cost time: 1.0823330879211426
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.363 Vali Acc: 0.294 Test Loss: 5.363 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.84486985206604
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.439 Vali Acc: 0.284 Test Loss: 5.439 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7783169746398926
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.448 Vali Acc: 0.294 Test Loss: 5.448 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8903992176055908
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.572 Vali Acc: 0.293 Test Loss: 5.572 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9740269184112549
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.553 Vali Acc: 0.292 Test Loss: 5.553 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8154029846191406
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.477 Vali Acc: 0.296 Test Loss: 5.477 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7987797260284424
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.488 Vali Acc: 0.304 Test Loss: 5.488 Test Acc: 0.304
Validation loss decreased (-0.302301 --> -0.303475).  Saving model ...
Epoch: 25 cost time: 0.8143770694732666
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.521 Vali Acc: 0.302 Test Loss: 5.521 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.845341682434082
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.705 Vali Acc: 0.291 Test Loss: 5.705 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6508572101593018
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.620 Vali Acc: 0.306 Test Loss: 5.620 Test Acc: 0.306
Validation loss decreased (-0.303475 --> -0.305826).  Saving model ...
Epoch: 28 cost time: 0.8577525615692139
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.618 Vali Acc: 0.298 Test Loss: 5.618 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8171648979187012
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.606 Vali Acc: 0.295 Test Loss: 5.606 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8741028308868408
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.589 Vali Acc: 0.299 Test Loss: 5.589 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0719118118286133
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.594 Vali Acc: 0.301 Test Loss: 5.594 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8504593372344971
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.608 Vali Acc: 0.308 Test Loss: 5.608 Test Acc: 0.308
Validation loss decreased (-0.305826 --> -0.308179).  Saving model ...
Epoch: 33 cost time: 1.1343095302581787
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.640 Vali Acc: 0.311 Test Loss: 5.640 Test Acc: 0.311
Validation loss decreased (-0.308179 --> -0.310532).  Saving model ...
Epoch: 34 cost time: 0.7880911827087402
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.636 Vali Acc: 0.314 Test Loss: 5.636 Test Acc: 0.314
Validation loss decreased (-0.310532 --> -0.314061).  Saving model ...
Epoch: 35 cost time: 0.6590268611907959
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.708 Vali Acc: 0.306 Test Loss: 5.708 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6111376285552979
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.737 Vali Acc: 0.304 Test Loss: 5.737 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6527047157287598
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.768 Vali Acc: 0.296 Test Loss: 5.768 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6635830402374268
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.750 Vali Acc: 0.301 Test Loss: 5.750 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7419731616973877
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.740 Vali Acc: 0.302 Test Loss: 5.740 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1910505294799805
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.732 Vali Acc: 0.306 Test Loss: 5.732 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.001108169555664
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.726 Vali Acc: 0.309 Test Loss: 5.726 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2813940048217773
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.730 Vali Acc: 0.311 Test Loss: 5.730 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0354468822479248
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.740 Vali Acc: 0.312 Test Loss: 5.740 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.053330421447754
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.748 Vali Acc: 0.311 Test Loss: 5.748 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 44107034
model size : 182.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.29657244682312
Epoch: 1, Steps: 10 | Train Loss: 3.422 Vali Loss: 3.318 Vali Acc: 0.039 Test Loss: 3.318 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.7667672634124756
Epoch: 2, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.321 Vali Acc: 0.060 Test Loss: 3.321 Test Acc: 0.060
Validation loss decreased (-0.038790 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.7921726703643799
Epoch: 3, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.356 Vali Acc: 0.052 Test Loss: 3.356 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.845585823059082
Epoch: 4, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.326 Vali Acc: 0.085 Test Loss: 3.326 Test Acc: 0.085
Validation loss decreased (-0.059967 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 0.8253800868988037
Epoch: 5, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.246 Vali Acc: 0.111 Test Loss: 3.246 Test Acc: 0.111
Validation loss decreased (-0.084673 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 0.8674345016479492
Epoch: 6, Steps: 10 | Train Loss: 2.602 Vali Loss: 3.210 Vali Acc: 0.113 Test Loss: 3.210 Test Acc: 0.113
Validation loss decreased (-0.110556 --> -0.112909).  Saving model ...
Epoch: 7 cost time: 0.7540872097015381
Epoch: 7, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.223 Vali Acc: 0.159 Test Loss: 3.223 Test Acc: 0.159
Validation loss decreased (-0.112909 --> -0.158791).  Saving model ...
Epoch: 8 cost time: 0.928840160369873
Epoch: 8, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.295 Vali Acc: 0.196 Test Loss: 3.295 Test Acc: 0.196
Validation loss decreased (-0.158791 --> -0.196438).  Saving model ...
Epoch: 9 cost time: 0.8306400775909424
Epoch: 9, Steps: 10 | Train Loss: 1.241 Vali Loss: 3.571 Vali Acc: 0.218 Test Loss: 3.571 Test Acc: 0.218
Validation loss decreased (-0.196438 --> -0.217611).  Saving model ...
Epoch: 10 cost time: 0.8922622203826904
Epoch: 10, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.680 Vali Acc: 0.239 Test Loss: 3.680 Test Acc: 0.239
Validation loss decreased (-0.217611 --> -0.238787).  Saving model ...
Epoch: 11 cost time: 0.7862145900726318
Epoch: 11, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.865 Vali Acc: 0.248 Test Loss: 3.865 Test Acc: 0.248
Validation loss decreased (-0.238787 --> -0.248197).  Saving model ...
Epoch: 12 cost time: 0.7750625610351562
Epoch: 12, Steps: 10 | Train Loss: 0.405 Vali Loss: 4.019 Vali Acc: 0.267 Test Loss: 4.019 Test Acc: 0.267
Validation loss decreased (-0.248197 --> -0.267019).  Saving model ...
Epoch: 13 cost time: 0.7225832939147949
Epoch: 13, Steps: 10 | Train Loss: 0.252 Vali Loss: 4.049 Vali Acc: 0.268 Test Loss: 4.049 Test Acc: 0.268
Validation loss decreased (-0.267019 --> -0.268195).  Saving model ...
Epoch: 14 cost time: 0.6699273586273193
Epoch: 14, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.338 Vali Acc: 0.276 Test Loss: 4.338 Test Acc: 0.276
Validation loss decreased (-0.268195 --> -0.276427).  Saving model ...
Epoch: 15 cost time: 0.8086442947387695
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.304 Vali Acc: 0.288 Test Loss: 4.304 Test Acc: 0.288
Validation loss decreased (-0.276427 --> -0.288192).  Saving model ...
Epoch: 16 cost time: 0.866039514541626
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.532 Vali Acc: 0.267 Test Loss: 4.532 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8113653659820557
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.511 Vali Acc: 0.291 Test Loss: 4.511 Test Acc: 0.291
Validation loss decreased (-0.288192 --> -0.290543).  Saving model ...
Epoch: 18 cost time: 0.9519023895263672
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.662 Vali Acc: 0.281 Test Loss: 4.662 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.814978837966919
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.655 Vali Acc: 0.288 Test Loss: 4.655 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8211250305175781
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.679 Vali Acc: 0.298 Test Loss: 4.679 Test Acc: 0.298
Validation loss decreased (-0.290543 --> -0.297600).  Saving model ...
Epoch: 21 cost time: 0.8802733421325684
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.833 Vali Acc: 0.298 Test Loss: 4.833 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7967731952667236
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.807 Vali Acc: 0.304 Test Loss: 4.807 Test Acc: 0.304
Validation loss decreased (-0.297600 --> -0.303481).  Saving model ...
Epoch: 23 cost time: 0.8504714965820312
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.787 Vali Acc: 0.309 Test Loss: 4.787 Test Acc: 0.309
Validation loss decreased (-0.303481 --> -0.309364).  Saving model ...
Epoch: 24 cost time: 0.8608343601226807
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.815 Vali Acc: 0.305 Test Loss: 4.815 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6401302814483643
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.827 Vali Acc: 0.304 Test Loss: 4.827 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.083603858947754
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.847 Vali Acc: 0.309 Test Loss: 4.847 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0420794486999512
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.877 Vali Acc: 0.306 Test Loss: 4.877 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8352055549621582
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.892 Vali Acc: 0.312 Test Loss: 4.892 Test Acc: 0.312
Validation loss decreased (-0.309364 --> -0.311716).  Saving model ...
Epoch: 29 cost time: 0.7746670246124268
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.883 Vali Acc: 0.301 Test Loss: 4.883 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8254492282867432
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.899 Vali Acc: 0.306 Test Loss: 4.899 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8102240562438965
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.865 Vali Acc: 0.308 Test Loss: 4.865 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8271307945251465
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.857 Vali Acc: 0.307 Test Loss: 4.857 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8296475410461426
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.886 Vali Acc: 0.312 Test Loss: 4.886 Test Acc: 0.312
Validation loss decreased (-0.311716 --> -0.311716).  Saving model ...
Epoch: 34 cost time: 0.7677247524261475
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.918 Vali Acc: 0.308 Test Loss: 4.918 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.79506516456604
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.949 Vali Acc: 0.309 Test Loss: 4.949 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.802623987197876
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.009 Vali Acc: 0.307 Test Loss: 5.009 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9284131526947021
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.029 Vali Acc: 0.309 Test Loss: 5.029 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9328985214233398
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.030 Vali Acc: 0.312 Test Loss: 5.030 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9194035530090332
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.027 Vali Acc: 0.308 Test Loss: 5.027 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7183752059936523
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.028 Vali Acc: 0.306 Test Loss: 5.028 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.948204755783081
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.049 Vali Acc: 0.305 Test Loss: 5.049 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8276169300079346
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.179 Vali Acc: 0.292 Test Loss: 5.179 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8826906681060791
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.203 Vali Acc: 0.298 Test Loss: 5.203 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 43827482
model size : 181.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.035748243331909
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.362 Vali Acc: 0.029 Test Loss: 3.362 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.7053804397583008
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.331 Vali Acc: 0.042 Test Loss: 3.331 Test Acc: 0.042
Validation loss decreased (-0.029378 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.6828718185424805
Epoch: 3, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.323 Vali Acc: 0.049 Test Loss: 3.323 Test Acc: 0.049
Validation loss decreased (-0.042320 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.6922299861907959
Epoch: 4, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.313 Vali Acc: 0.067 Test Loss: 3.313 Test Acc: 0.067
Validation loss decreased (-0.049379 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.8974478244781494
Epoch: 5, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.284 Vali Acc: 0.094 Test Loss: 3.284 Test Acc: 0.094
Validation loss decreased (-0.067026 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.7967021465301514
Epoch: 6, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.248 Vali Acc: 0.122 Test Loss: 3.248 Test Acc: 0.122
Validation loss decreased (-0.094085 --> -0.122320).  Saving model ...
Epoch: 7 cost time: 0.77103590965271
Epoch: 7, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.223 Vali Acc: 0.139 Test Loss: 3.223 Test Acc: 0.139
Validation loss decreased (-0.122320 --> -0.138791).  Saving model ...
Epoch: 8 cost time: 0.8325388431549072
Epoch: 8, Steps: 10 | Train Loss: 2.286 Vali Loss: 3.181 Vali Acc: 0.151 Test Loss: 3.181 Test Acc: 0.151
Validation loss decreased (-0.138791 --> -0.150556).  Saving model ...
Epoch: 9 cost time: 0.810391902923584
Epoch: 9, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.259 Vali Acc: 0.173 Test Loss: 3.259 Test Acc: 0.173
Validation loss decreased (-0.150556 --> -0.172909).  Saving model ...
Epoch: 10 cost time: 0.7607190608978271
Epoch: 10, Steps: 10 | Train Loss: 1.513 Vali Loss: 3.297 Vali Acc: 0.204 Test Loss: 3.297 Test Acc: 0.204
Validation loss decreased (-0.172909 --> -0.203496).  Saving model ...
Epoch: 11 cost time: 0.7187564373016357
Epoch: 11, Steps: 10 | Train Loss: 1.155 Vali Loss: 3.421 Vali Acc: 0.214 Test Loss: 3.421 Test Acc: 0.214
Validation loss decreased (-0.203496 --> -0.214083).  Saving model ...
Epoch: 12 cost time: 0.7045848369598389
Epoch: 12, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.608 Vali Acc: 0.221 Test Loss: 3.608 Test Acc: 0.221
Validation loss decreased (-0.214083 --> -0.221140).  Saving model ...
Epoch: 13 cost time: 0.7384922504425049
Epoch: 13, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.658 Vali Acc: 0.248 Test Loss: 3.658 Test Acc: 0.248
Validation loss decreased (-0.221140 --> -0.248199).  Saving model ...
Epoch: 14 cost time: 0.7390570640563965
Epoch: 14, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.831 Vali Acc: 0.252 Test Loss: 3.831 Test Acc: 0.252
Validation loss decreased (-0.248199 --> -0.251726).  Saving model ...
Epoch: 15 cost time: 0.7349750995635986
Epoch: 15, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.746 Vali Acc: 0.269 Test Loss: 3.746 Test Acc: 0.269
Validation loss decreased (-0.251726 --> -0.269374).  Saving model ...
Epoch: 16 cost time: 0.7022037506103516
Epoch: 16, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.162 Vali Acc: 0.254 Test Loss: 4.162 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7973499298095703
Epoch: 17, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.037 Vali Acc: 0.284 Test Loss: 4.037 Test Acc: 0.284
Validation loss decreased (-0.269374 --> -0.283489).  Saving model ...
Epoch: 18 cost time: 0.7302408218383789
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.180 Vali Acc: 0.280 Test Loss: 4.180 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8479723930358887
Epoch: 19, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.267 Vali Acc: 0.299 Test Loss: 4.267 Test Acc: 0.299
Validation loss decreased (-0.283489 --> -0.298781).  Saving model ...
Epoch: 20 cost time: 0.6752567291259766
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.388 Vali Acc: 0.294 Test Loss: 4.388 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6793942451477051
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.421 Vali Acc: 0.279 Test Loss: 4.421 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7433087825775146
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.557 Vali Acc: 0.273 Test Loss: 4.557 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8831174373626709
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.536 Vali Acc: 0.285 Test Loss: 4.536 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7452788352966309
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.561 Vali Acc: 0.284 Test Loss: 4.561 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.75960373878479
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.582 Vali Acc: 0.287 Test Loss: 4.582 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7677264213562012
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.590 Vali Acc: 0.298 Test Loss: 4.590 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6880698204040527
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.631 Vali Acc: 0.294 Test Loss: 4.631 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7891969680786133
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.665 Vali Acc: 0.284 Test Loss: 4.665 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7514989376068115
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.703 Vali Acc: 0.286 Test Loss: 4.703 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 43698458
model size : 181.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.696354389190674
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.339 Vali Acc: 0.045 Test Loss: 3.339 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.9514555931091309
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.375 Vali Acc: 0.066 Test Loss: 3.375 Test Acc: 0.066
Validation loss decreased (-0.044672 --> -0.065849).  Saving model ...
Epoch: 3 cost time: 0.9827523231506348
Epoch: 3, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.321 Vali Acc: 0.081 Test Loss: 3.321 Test Acc: 0.081
Validation loss decreased (-0.065849 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 1.044898271560669
Epoch: 4, Steps: 10 | Train Loss: 2.882 Vali Loss: 3.270 Vali Acc: 0.091 Test Loss: 3.270 Test Acc: 0.091
Validation loss decreased (-0.081143 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 1.0281274318695068
Epoch: 5, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.224 Vali Acc: 0.149 Test Loss: 3.224 Test Acc: 0.149
Validation loss decreased (-0.090556 --> -0.149380).  Saving model ...
Epoch: 6 cost time: 1.0332283973693848
Epoch: 6, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.233 Vali Acc: 0.155 Test Loss: 3.233 Test Acc: 0.155
Validation loss decreased (-0.149380 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 0.9724464416503906
Epoch: 7, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.278 Vali Acc: 0.198 Test Loss: 3.278 Test Acc: 0.198
Validation loss decreased (-0.155262 --> -0.197614).  Saving model ...
Epoch: 8 cost time: 0.9254794120788574
Epoch: 8, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.681 Vali Acc: 0.224 Test Loss: 3.681 Test Acc: 0.224
Validation loss decreased (-0.197614 --> -0.223493).  Saving model ...
Epoch: 9 cost time: 1.059175968170166
Epoch: 9, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.878 Vali Acc: 0.255 Test Loss: 3.878 Test Acc: 0.255
Validation loss decreased (-0.223493 --> -0.255255).  Saving model ...
Epoch: 10 cost time: 1.0647830963134766
Epoch: 10, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.956 Vali Acc: 0.272 Test Loss: 3.956 Test Acc: 0.272
Validation loss decreased (-0.255255 --> -0.271725).  Saving model ...
Epoch: 11 cost time: 1.0907859802246094
Epoch: 11, Steps: 10 | Train Loss: 0.215 Vali Loss: 4.283 Vali Acc: 0.285 Test Loss: 4.283 Test Acc: 0.285
Validation loss decreased (-0.271725 --> -0.284663).  Saving model ...
Epoch: 12 cost time: 1.3655726909637451
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.605 Vali Acc: 0.272 Test Loss: 4.605 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6015040874481201
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.648 Vali Acc: 0.284 Test Loss: 4.648 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0122692584991455
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.931 Vali Acc: 0.291 Test Loss: 4.931 Test Acc: 0.291
Validation loss decreased (-0.284663 --> -0.290539).  Saving model ...
Epoch: 15 cost time: 1.0240497589111328
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.945 Vali Acc: 0.296 Test Loss: 4.945 Test Acc: 0.296
Validation loss decreased (-0.290539 --> -0.296421).  Saving model ...
Epoch: 16 cost time: 0.9558525085449219
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.106 Vali Acc: 0.301 Test Loss: 5.106 Test Acc: 0.301
Validation loss decreased (-0.296421 --> -0.301125).  Saving model ...
Epoch: 17 cost time: 1.393019437789917
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.940 Vali Acc: 0.307 Test Loss: 4.940 Test Acc: 0.307
Validation loss decreased (-0.301125 --> -0.307009).  Saving model ...
Epoch: 18 cost time: 1.0035429000854492
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.995 Vali Acc: 0.306 Test Loss: 4.995 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9154171943664551
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.968 Vali Acc: 0.309 Test Loss: 4.968 Test Acc: 0.309
Validation loss decreased (-0.307009 --> -0.309362).  Saving model ...
Epoch: 20 cost time: 0.9118518829345703
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.014 Vali Acc: 0.315 Test Loss: 5.014 Test Acc: 0.315
Validation loss decreased (-0.309362 --> -0.315244).  Saving model ...
Epoch: 21 cost time: 0.8558602333068848
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.078 Vali Acc: 0.319 Test Loss: 5.078 Test Acc: 0.319
Validation loss decreased (-0.315244 --> -0.318773).  Saving model ...
Epoch: 22 cost time: 0.9180328845977783
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.109 Vali Acc: 0.315 Test Loss: 5.109 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9281151294708252
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.112 Vali Acc: 0.315 Test Loss: 5.112 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3156535625457764
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.136 Vali Acc: 0.314 Test Loss: 5.136 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9385251998901367
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.124 Vali Acc: 0.309 Test Loss: 5.124 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9259183406829834
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.142 Vali Acc: 0.320 Test Loss: 5.142 Test Acc: 0.320
Validation loss decreased (-0.318773 --> -0.319949).  Saving model ...
Epoch: 27 cost time: 1.3663365840911865
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.163 Vali Acc: 0.319 Test Loss: 5.163 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4438447952270508
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.185 Vali Acc: 0.316 Test Loss: 5.185 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3328766822814941
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.218 Vali Acc: 0.313 Test Loss: 5.218 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2047686576843262
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.217 Vali Acc: 0.314 Test Loss: 5.217 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0929536819458008
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.198 Vali Acc: 0.316 Test Loss: 5.198 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0884923934936523
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.189 Vali Acc: 0.319 Test Loss: 5.189 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.08567476272583
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.209 Vali Acc: 0.316 Test Loss: 5.209 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0291273593902588
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.223 Vali Acc: 0.315 Test Loss: 5.223 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7448320388793945
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.226 Vali Acc: 0.313 Test Loss: 5.226 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0078380107879639
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.231 Vali Acc: 0.313 Test Loss: 5.231 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 44020250
model size : 182.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0841760635375977
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.386 Vali Acc: 0.040 Test Loss: 3.386 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.9875938892364502
Epoch: 2, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.341 Vali Acc: 0.071 Test Loss: 3.341 Test Acc: 0.071
Validation loss decreased (-0.039966 --> -0.070555).  Saving model ...
Epoch: 3 cost time: 0.9379620552062988
Epoch: 3, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.338 Vali Acc: 0.086 Test Loss: 3.338 Test Acc: 0.086
Validation loss decreased (-0.070555 --> -0.085849).  Saving model ...
Epoch: 4 cost time: 0.8408563137054443
Epoch: 4, Steps: 10 | Train Loss: 3.013 Vali Loss: 3.294 Vali Acc: 0.069 Test Loss: 3.294 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8339674472808838
Epoch: 5, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.253 Vali Acc: 0.101 Test Loss: 3.253 Test Acc: 0.101
Validation loss decreased (-0.085849 --> -0.101144).  Saving model ...
Epoch: 6 cost time: 0.9789834022521973
Epoch: 6, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.220 Vali Acc: 0.128 Test Loss: 3.220 Test Acc: 0.128
Validation loss decreased (-0.101144 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 0.6620397567749023
Epoch: 7, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.228 Vali Acc: 0.146 Test Loss: 3.228 Test Acc: 0.146
Validation loss decreased (-0.128203 --> -0.145850).  Saving model ...
Epoch: 8 cost time: 0.9534549713134766
Epoch: 8, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.306 Vali Acc: 0.174 Test Loss: 3.306 Test Acc: 0.174
Validation loss decreased (-0.145850 --> -0.174085).  Saving model ...
Epoch: 9 cost time: 0.8283631801605225
Epoch: 9, Steps: 10 | Train Loss: 1.445 Vali Loss: 3.542 Vali Acc: 0.188 Test Loss: 3.542 Test Acc: 0.188
Validation loss decreased (-0.174085 --> -0.188200).  Saving model ...
Epoch: 10 cost time: 0.8516268730163574
Epoch: 10, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.602 Vali Acc: 0.211 Test Loss: 3.602 Test Acc: 0.211
Validation loss decreased (-0.188200 --> -0.210552).  Saving model ...
Epoch: 11 cost time: 0.8160207271575928
Epoch: 11, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.847 Vali Acc: 0.232 Test Loss: 3.847 Test Acc: 0.232
Validation loss decreased (-0.210552 --> -0.231726).  Saving model ...
Epoch: 12 cost time: 0.8185281753540039
Epoch: 12, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.825 Vali Acc: 0.246 Test Loss: 3.825 Test Acc: 0.246
Validation loss decreased (-0.231726 --> -0.245844).  Saving model ...
Epoch: 13 cost time: 0.8461711406707764
Epoch: 13, Steps: 10 | Train Loss: 0.356 Vali Loss: 4.058 Vali Acc: 0.255 Test Loss: 4.058 Test Acc: 0.255
Validation loss decreased (-0.245844 --> -0.255254).  Saving model ...
Epoch: 14 cost time: 0.9373226165771484
Epoch: 14, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.057 Vali Acc: 0.261 Test Loss: 4.057 Test Acc: 0.261
Validation loss decreased (-0.255254 --> -0.261136).  Saving model ...
Epoch: 15 cost time: 1.0370116233825684
Epoch: 15, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.482 Vali Acc: 0.271 Test Loss: 4.482 Test Acc: 0.271
Validation loss decreased (-0.261136 --> -0.270543).  Saving model ...
Epoch: 16 cost time: 1.0103342533111572
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.337 Vali Acc: 0.296 Test Loss: 4.337 Test Acc: 0.296
Validation loss decreased (-0.270543 --> -0.296427).  Saving model ...
Epoch: 17 cost time: 0.7118697166442871
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.439 Vali Acc: 0.284 Test Loss: 4.439 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7178139686584473
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.529 Vali Acc: 0.291 Test Loss: 4.529 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6798477172851562
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.553 Vali Acc: 0.307 Test Loss: 4.553 Test Acc: 0.307
Validation loss decreased (-0.296427 --> -0.307013).  Saving model ...
Epoch: 20 cost time: 0.6699414253234863
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.593 Vali Acc: 0.300 Test Loss: 4.593 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6856415271759033
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.652 Vali Acc: 0.302 Test Loss: 4.652 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6469790935516357
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.668 Vali Acc: 0.308 Test Loss: 4.668 Test Acc: 0.308
Validation loss decreased (-0.307013 --> -0.308189).  Saving model ...
Epoch: 23 cost time: 0.6209309101104736
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.634 Vali Acc: 0.306 Test Loss: 4.634 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.588740348815918
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.667 Vali Acc: 0.304 Test Loss: 4.667 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6816604137420654
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.705 Vali Acc: 0.300 Test Loss: 4.705 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7051503658294678
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.689 Vali Acc: 0.308 Test Loss: 4.689 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7149660587310791
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.774 Vali Acc: 0.313 Test Loss: 4.774 Test Acc: 0.313
Validation loss decreased (-0.308189 --> -0.312893).  Saving model ...
Epoch: 28 cost time: 0.8195979595184326
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.852 Vali Acc: 0.304 Test Loss: 4.852 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6470539569854736
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.846 Vali Acc: 0.302 Test Loss: 4.846 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6645739078521729
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.811 Vali Acc: 0.312 Test Loss: 4.811 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6463079452514648
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.781 Vali Acc: 0.316 Test Loss: 4.781 Test Acc: 0.316
Validation loss decreased (-0.312893 --> -0.316423).  Saving model ...
Epoch: 32 cost time: 0.889657735824585
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.800 Vali Acc: 0.313 Test Loss: 4.800 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8116848468780518
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.810 Vali Acc: 0.309 Test Loss: 4.810 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8135116100311279
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.829 Vali Acc: 0.314 Test Loss: 4.829 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7574005126953125
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.862 Vali Acc: 0.312 Test Loss: 4.862 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6780834197998047
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.875 Vali Acc: 0.307 Test Loss: 4.875 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7425150871276855
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.886 Vali Acc: 0.307 Test Loss: 4.886 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.853863000869751
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.879 Vali Acc: 0.309 Test Loss: 4.879 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6140894889831543
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.902 Vali Acc: 0.314 Test Loss: 4.902 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9734899997711182
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.906 Vali Acc: 0.313 Test Loss: 4.906 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1072649955749512
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.892 Vali Acc: 0.315 Test Loss: 4.892 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 43805210
model size : 181.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3876287937164307
Epoch: 1, Steps: 10 | Train Loss: 3.439 Vali Loss: 3.350 Vali Acc: 0.035 Test Loss: 3.350 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.6783828735351562
Epoch: 2, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.303 Vali Acc: 0.053 Test Loss: 3.303 Test Acc: 0.053
Validation loss decreased (-0.035261 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.7942001819610596
Epoch: 3, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.304 Vali Acc: 0.060 Test Loss: 3.304 Test Acc: 0.060
Validation loss decreased (-0.052908 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.655224084854126
Epoch: 4, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.326 Vali Acc: 0.071 Test Loss: 3.326 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 0.7266387939453125
Epoch: 5, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.307 Vali Acc: 0.081 Test Loss: 3.307 Test Acc: 0.081
Validation loss decreased (-0.070555 --> -0.081143).  Saving model ...
Epoch: 6 cost time: 0.5689771175384521
Epoch: 6, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.264 Vali Acc: 0.096 Test Loss: 3.264 Test Acc: 0.096
Validation loss decreased (-0.081143 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 0.5667352676391602
Epoch: 7, Steps: 10 | Train Loss: 2.740 Vali Loss: 3.221 Vali Acc: 0.105 Test Loss: 3.221 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104674).  Saving model ...
Epoch: 8 cost time: 0.5875647068023682
Epoch: 8, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.239 Vali Acc: 0.125 Test Loss: 3.239 Test Acc: 0.125
Validation loss decreased (-0.104674 --> -0.124673).  Saving model ...
Epoch: 9 cost time: 0.6039981842041016
Epoch: 9, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.205 Vali Acc: 0.153 Test Loss: 3.205 Test Acc: 0.153
Validation loss decreased (-0.124673 --> -0.152909).  Saving model ...
Epoch: 10 cost time: 0.603644847869873
Epoch: 10, Steps: 10 | Train Loss: 1.923 Vali Loss: 3.327 Vali Acc: 0.153 Test Loss: 3.327 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6787538528442383
Epoch: 11, Steps: 10 | Train Loss: 1.526 Vali Loss: 3.332 Vali Acc: 0.176 Test Loss: 3.332 Test Acc: 0.176
Validation loss decreased (-0.152909 --> -0.176437).  Saving model ...
Epoch: 12 cost time: 0.559145450592041
Epoch: 12, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.409 Vali Acc: 0.196 Test Loss: 3.409 Test Acc: 0.196
Validation loss decreased (-0.176437 --> -0.196437).  Saving model ...
Epoch: 13 cost time: 0.5958032608032227
Epoch: 13, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.535 Vali Acc: 0.233 Test Loss: 3.535 Test Acc: 0.233
Validation loss decreased (-0.196437 --> -0.232906).  Saving model ...
Epoch: 14 cost time: 0.6002955436706543
Epoch: 14, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.602 Vali Acc: 0.244 Test Loss: 3.602 Test Acc: 0.244
Validation loss decreased (-0.232906 --> -0.243493).  Saving model ...
Epoch: 15 cost time: 0.6442234516143799
Epoch: 15, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.673 Vali Acc: 0.259 Test Loss: 3.673 Test Acc: 0.259
Validation loss decreased (-0.243493 --> -0.258787).  Saving model ...
Epoch: 16 cost time: 0.620596170425415
Epoch: 16, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.843 Vali Acc: 0.255 Test Loss: 3.843 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5659682750701904
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.901 Vali Acc: 0.264 Test Loss: 3.901 Test Acc: 0.264
Validation loss decreased (-0.258787 --> -0.263490).  Saving model ...
Epoch: 18 cost time: 0.5929689407348633
Epoch: 18, Steps: 10 | Train Loss: 0.176 Vali Loss: 4.000 Vali Acc: 0.278 Test Loss: 4.000 Test Acc: 0.278
Validation loss decreased (-0.263490 --> -0.277607).  Saving model ...
Epoch: 19 cost time: 0.7315738201141357
Epoch: 19, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.174 Vali Acc: 0.267 Test Loss: 4.174 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6266024112701416
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.149 Vali Acc: 0.274 Test Loss: 4.149 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.600327730178833
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.241 Vali Acc: 0.280 Test Loss: 4.241 Test Acc: 0.280
Validation loss decreased (-0.277607 --> -0.279958).  Saving model ...
Epoch: 22 cost time: 0.6958622932434082
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.294 Vali Acc: 0.281 Test Loss: 4.294 Test Acc: 0.281
Validation loss decreased (-0.279958 --> -0.281134).  Saving model ...
Epoch: 23 cost time: 0.6268486976623535
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.426 Vali Acc: 0.274 Test Loss: 4.426 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6987674236297607
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.468 Vali Acc: 0.280 Test Loss: 4.468 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7108645439147949
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.431 Vali Acc: 0.292 Test Loss: 4.431 Test Acc: 0.292
Validation loss decreased (-0.281134 --> -0.291720).  Saving model ...
Epoch: 26 cost time: 0.6657357215881348
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.484 Vali Acc: 0.286 Test Loss: 4.484 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7473149299621582
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.623 Vali Acc: 0.276 Test Loss: 4.623 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6556797027587891
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.533 Vali Acc: 0.281 Test Loss: 4.533 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6174716949462891
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.555 Vali Acc: 0.281 Test Loss: 4.555 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6785297393798828
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.553 Vali Acc: 0.293 Test Loss: 4.553 Test Acc: 0.293
Validation loss decreased (-0.291720 --> -0.292896).  Saving model ...
Epoch: 31 cost time: 0.8683648109436035
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.589 Vali Acc: 0.284 Test Loss: 4.589 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.802239179611206
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.583 Vali Acc: 0.284 Test Loss: 4.583 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6010630130767822
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.593 Vali Acc: 0.286 Test Loss: 4.593 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7461416721343994
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.644 Vali Acc: 0.284 Test Loss: 4.644 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8195147514343262
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.690 Vali Acc: 0.273 Test Loss: 4.690 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8104426860809326
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.719 Vali Acc: 0.274 Test Loss: 4.719 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.792212724685669
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.727 Vali Acc: 0.276 Test Loss: 4.727 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6037120819091797
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.753 Vali Acc: 0.284 Test Loss: 4.753 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7090718746185303
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.787 Vali Acc: 0.289 Test Loss: 4.787 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7308387756347656
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.807 Vali Acc: 0.286 Test Loss: 4.807 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 43676186
model size : 181.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1925952434539795
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.338 Vali Acc: 0.035 Test Loss: 3.338 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.8242826461791992
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.357 Vali Acc: 0.048 Test Loss: 3.357 Test Acc: 0.048
Validation loss decreased (-0.035261 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.9303233623504639
Epoch: 3, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.334 Vali Acc: 0.072 Test Loss: 3.334 Test Acc: 0.072
Validation loss decreased (-0.048202 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 0.8593184947967529
Epoch: 4, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.251 Vali Acc: 0.089 Test Loss: 3.251 Test Acc: 0.089
Validation loss decreased (-0.071731 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 1.0313410758972168
Epoch: 5, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.229 Vali Acc: 0.114 Test Loss: 3.229 Test Acc: 0.114
Validation loss decreased (-0.089379 --> -0.114085).  Saving model ...
Epoch: 6 cost time: 1.0048432350158691
Epoch: 6, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.194 Vali Acc: 0.166 Test Loss: 3.194 Test Acc: 0.166
Validation loss decreased (-0.114085 --> -0.165850).  Saving model ...
Epoch: 7 cost time: 0.9561948776245117
Epoch: 7, Steps: 10 | Train Loss: 1.992 Vali Loss: 3.201 Vali Acc: 0.180 Test Loss: 3.201 Test Acc: 0.180
Validation loss decreased (-0.165850 --> -0.179968).  Saving model ...
Epoch: 8 cost time: 0.8187539577484131
Epoch: 8, Steps: 10 | Train Loss: 1.435 Vali Loss: 3.427 Vali Acc: 0.232 Test Loss: 3.427 Test Acc: 0.232
Validation loss decreased (-0.179968 --> -0.231730).  Saving model ...
Epoch: 9 cost time: 0.9002454280853271
Epoch: 9, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.703 Vali Acc: 0.253 Test Loss: 3.703 Test Acc: 0.253
Validation loss decreased (-0.231730 --> -0.252904).  Saving model ...
Epoch: 10 cost time: 0.6056468486785889
Epoch: 10, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.854 Vali Acc: 0.261 Test Loss: 3.854 Test Acc: 0.261
Validation loss decreased (-0.252904 --> -0.261138).  Saving model ...
Epoch: 11 cost time: 0.922060489654541
Epoch: 11, Steps: 10 | Train Loss: 0.352 Vali Loss: 4.048 Vali Acc: 0.282 Test Loss: 4.048 Test Acc: 0.282
Validation loss decreased (-0.261138 --> -0.282312).  Saving model ...
Epoch: 12 cost time: 1.0086090564727783
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.248 Vali Acc: 0.279 Test Loss: 4.248 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.861452579498291
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.227 Vali Acc: 0.312 Test Loss: 4.227 Test Acc: 0.312
Validation loss decreased (-0.282312 --> -0.311722).  Saving model ...
Epoch: 14 cost time: 1.1590328216552734
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.578 Vali Acc: 0.301 Test Loss: 4.578 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1486244201660156
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.717 Vali Acc: 0.306 Test Loss: 4.717 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0715129375457764
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.688 Vali Acc: 0.319 Test Loss: 4.688 Test Acc: 0.319
Validation loss decreased (-0.311722 --> -0.318777).  Saving model ...
Epoch: 17 cost time: 0.92337965965271
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.838 Vali Acc: 0.309 Test Loss: 4.838 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.808875322341919
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.831 Vali Acc: 0.320 Test Loss: 4.831 Test Acc: 0.320
Validation loss decreased (-0.318777 --> -0.319952).  Saving model ...
Epoch: 19 cost time: 0.9219095706939697
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.060 Vali Acc: 0.304 Test Loss: 5.060 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9747586250305176
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.932 Vali Acc: 0.322 Test Loss: 4.932 Test Acc: 0.322
Validation loss decreased (-0.319952 --> -0.322304).  Saving model ...
Epoch: 21 cost time: 1.000138521194458
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.869 Vali Acc: 0.326 Test Loss: 4.869 Test Acc: 0.326
Validation loss decreased (-0.322304 --> -0.325834).  Saving model ...
Epoch: 22 cost time: 1.454409122467041
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.906 Vali Acc: 0.321 Test Loss: 4.906 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0671789646148682
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.954 Vali Acc: 0.322 Test Loss: 4.954 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3261101245880127
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.016 Vali Acc: 0.313 Test Loss: 5.016 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1551332473754883
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.032 Vali Acc: 0.315 Test Loss: 5.032 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1904034614562988
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.039 Vali Acc: 0.321 Test Loss: 5.039 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.935391902923584
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.044 Vali Acc: 0.316 Test Loss: 5.044 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2309668064117432
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.052 Vali Acc: 0.314 Test Loss: 5.052 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.326735258102417
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.126 Vali Acc: 0.314 Test Loss: 5.126 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.219243049621582
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.164 Vali Acc: 0.304 Test Loss: 5.164 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8288650512695312
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.119 Vali Acc: 0.313 Test Loss: 5.119 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 43983386
model size : 182.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2835922241210938
Epoch: 1, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.341 Vali Acc: 0.046 Test Loss: 3.341 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.8469235897064209
Epoch: 2, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.307 Vali Acc: 0.066 Test Loss: 3.307 Test Acc: 0.066
Validation loss decreased (-0.045849 --> -0.065849).  Saving model ...
Epoch: 3 cost time: 0.7866237163543701
Epoch: 3, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.314 Vali Acc: 0.075 Test Loss: 3.314 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.7766327857971191
Epoch: 4, Steps: 10 | Train Loss: 3.013 Vali Loss: 3.275 Vali Acc: 0.088 Test Loss: 3.275 Test Acc: 0.088
Validation loss decreased (-0.075261 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 0.9061603546142578
Epoch: 5, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.257 Vali Acc: 0.094 Test Loss: 3.257 Test Acc: 0.094
Validation loss decreased (-0.088203 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.836057186126709
Epoch: 6, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.233 Vali Acc: 0.121 Test Loss: 3.233 Test Acc: 0.121
Validation loss decreased (-0.094085 --> -0.121144).  Saving model ...
Epoch: 7 cost time: 0.6761720180511475
Epoch: 7, Steps: 10 | Train Loss: 2.387 Vali Loss: 3.205 Vali Acc: 0.129 Test Loss: 3.205 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129380).  Saving model ...
Epoch: 8 cost time: 0.7869508266448975
Epoch: 8, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.202 Vali Acc: 0.186 Test Loss: 3.202 Test Acc: 0.186
Validation loss decreased (-0.129380 --> -0.185850).  Saving model ...
Epoch: 9 cost time: 0.7656369209289551
Epoch: 9, Steps: 10 | Train Loss: 1.619 Vali Loss: 3.334 Vali Acc: 0.184 Test Loss: 3.334 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7010502815246582
Epoch: 10, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.466 Vali Acc: 0.216 Test Loss: 3.466 Test Acc: 0.216
Validation loss decreased (-0.185850 --> -0.216436).  Saving model ...
Epoch: 11 cost time: 0.6891946792602539
Epoch: 11, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.651 Vali Acc: 0.233 Test Loss: 3.651 Test Acc: 0.233
Validation loss decreased (-0.216436 --> -0.232905).  Saving model ...
Epoch: 12 cost time: 0.7107183933258057
Epoch: 12, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.706 Vali Acc: 0.249 Test Loss: 3.706 Test Acc: 0.249
Validation loss decreased (-0.232905 --> -0.249375).  Saving model ...
Epoch: 13 cost time: 0.7362351417541504
Epoch: 13, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.834 Vali Acc: 0.245 Test Loss: 3.834 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7572455406188965
Epoch: 14, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.941 Vali Acc: 0.256 Test Loss: 3.941 Test Acc: 0.256
Validation loss decreased (-0.249375 --> -0.256431).  Saving model ...
Epoch: 15 cost time: 0.7871744632720947
Epoch: 15, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.983 Vali Acc: 0.275 Test Loss: 3.983 Test Acc: 0.275
Validation loss decreased (-0.256431 --> -0.275254).  Saving model ...
Epoch: 16 cost time: 0.7380971908569336
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.173 Vali Acc: 0.274 Test Loss: 4.173 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8048713207244873
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.273 Vali Acc: 0.282 Test Loss: 4.273 Test Acc: 0.282
Validation loss decreased (-0.275254 --> -0.282310).  Saving model ...
Epoch: 18 cost time: 0.6994147300720215
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.279 Vali Acc: 0.289 Test Loss: 4.279 Test Acc: 0.289
Validation loss decreased (-0.282310 --> -0.289369).  Saving model ...
Epoch: 19 cost time: 0.6130070686340332
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.315 Vali Acc: 0.302 Test Loss: 4.315 Test Acc: 0.302
Validation loss decreased (-0.289369 --> -0.302310).  Saving model ...
Epoch: 20 cost time: 0.655933141708374
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.384 Vali Acc: 0.292 Test Loss: 4.384 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6457879543304443
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.461 Vali Acc: 0.294 Test Loss: 4.461 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7090799808502197
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.464 Vali Acc: 0.301 Test Loss: 4.464 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7364380359649658
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.483 Vali Acc: 0.301 Test Loss: 4.483 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8889832496643066
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.528 Vali Acc: 0.300 Test Loss: 4.528 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6271846294403076
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.544 Vali Acc: 0.294 Test Loss: 4.544 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8047857284545898
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.593 Vali Acc: 0.295 Test Loss: 4.593 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6875395774841309
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.627 Vali Acc: 0.292 Test Loss: 4.627 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7088954448699951
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.656 Vali Acc: 0.288 Test Loss: 4.656 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9201793670654297
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.640 Vali Acc: 0.299 Test Loss: 4.640 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 43789850
model size : 181.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.219860553741455
Epoch: 1, Steps: 10 | Train Loss: 3.421 Vali Loss: 3.358 Vali Acc: 0.055 Test Loss: 3.358 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.6814122200012207
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.302 Vali Acc: 0.034 Test Loss: 3.302 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6215076446533203
Epoch: 3, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.290 Vali Acc: 0.058 Test Loss: 3.290 Test Acc: 0.058
Validation loss decreased (-0.055261 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.5899918079376221
Epoch: 4, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.308 Vali Acc: 0.060 Test Loss: 3.308 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.6541385650634766
Epoch: 5, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.313 Vali Acc: 0.061 Test Loss: 3.313 Test Acc: 0.061
Validation loss decreased (-0.059967 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 0.6375162601470947
Epoch: 6, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.273 Vali Acc: 0.105 Test Loss: 3.273 Test Acc: 0.105
Validation loss decreased (-0.061143 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 0.6829636096954346
Epoch: 7, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.257 Vali Acc: 0.114 Test Loss: 3.257 Test Acc: 0.114
Validation loss decreased (-0.104673 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.5987606048583984
Epoch: 8, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.233 Vali Acc: 0.125 Test Loss: 3.233 Test Acc: 0.125
Validation loss decreased (-0.114085 --> -0.124674).  Saving model ...
Epoch: 9 cost time: 0.631873369216919
Epoch: 9, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.241 Vali Acc: 0.141 Test Loss: 3.241 Test Acc: 0.141
Validation loss decreased (-0.124674 --> -0.141144).  Saving model ...
Epoch: 10 cost time: 0.6979584693908691
Epoch: 10, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.238 Vali Acc: 0.181 Test Loss: 3.238 Test Acc: 0.181
Validation loss decreased (-0.141144 --> -0.181144).  Saving model ...
Epoch: 11 cost time: 0.6143186092376709
Epoch: 11, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.291 Vali Acc: 0.189 Test Loss: 3.291 Test Acc: 0.189
Validation loss decreased (-0.181144 --> -0.189379).  Saving model ...
Epoch: 12 cost time: 0.670863151550293
Epoch: 12, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.358 Vali Acc: 0.221 Test Loss: 3.358 Test Acc: 0.221
Validation loss decreased (-0.189379 --> -0.221143).  Saving model ...
Epoch: 13 cost time: 0.6160955429077148
Epoch: 13, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.435 Vali Acc: 0.228 Test Loss: 3.435 Test Acc: 0.228
Validation loss decreased (-0.221143 --> -0.228201).  Saving model ...
Epoch: 14 cost time: 0.6646473407745361
Epoch: 14, Steps: 10 | Train Loss: 0.717 Vali Loss: 3.588 Vali Acc: 0.233 Test Loss: 3.588 Test Acc: 0.233
Validation loss decreased (-0.228201 --> -0.232905).  Saving model ...
Epoch: 15 cost time: 0.5968203544616699
Epoch: 15, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.689 Vali Acc: 0.241 Test Loss: 3.689 Test Acc: 0.241
Validation loss decreased (-0.232905 --> -0.241140).  Saving model ...
Epoch: 16 cost time: 0.5989608764648438
Epoch: 16, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.692 Vali Acc: 0.262 Test Loss: 3.692 Test Acc: 0.262
Validation loss decreased (-0.241140 --> -0.262316).  Saving model ...
Epoch: 17 cost time: 0.5904901027679443
Epoch: 17, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.811 Vali Acc: 0.273 Test Loss: 3.811 Test Acc: 0.273
Validation loss decreased (-0.262316 --> -0.272903).  Saving model ...
Epoch: 18 cost time: 0.5823893547058105
Epoch: 18, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.802 Vali Acc: 0.275 Test Loss: 3.802 Test Acc: 0.275
Validation loss decreased (-0.272903 --> -0.275256).  Saving model ...
Epoch: 19 cost time: 0.6504647731781006
Epoch: 19, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.947 Vali Acc: 0.273 Test Loss: 3.947 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6647882461547852
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.077 Vali Acc: 0.282 Test Loss: 4.077 Test Acc: 0.282
Validation loss decreased (-0.275256 --> -0.282312).  Saving model ...
Epoch: 21 cost time: 0.665226936340332
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.107 Vali Acc: 0.287 Test Loss: 4.107 Test Acc: 0.287
Validation loss decreased (-0.282312 --> -0.287018).  Saving model ...
Epoch: 22 cost time: 0.7164795398712158
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.214 Vali Acc: 0.275 Test Loss: 4.214 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7290806770324707
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.220 Vali Acc: 0.288 Test Loss: 4.220 Test Acc: 0.288
Validation loss decreased (-0.287018 --> -0.288193).  Saving model ...
Epoch: 24 cost time: 0.616863489151001
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.162 Vali Acc: 0.293 Test Loss: 4.162 Test Acc: 0.293
Validation loss decreased (-0.288193 --> -0.292900).  Saving model ...
Epoch: 25 cost time: 0.6702587604522705
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.181 Vali Acc: 0.299 Test Loss: 4.181 Test Acc: 0.299
Validation loss decreased (-0.292900 --> -0.298782).  Saving model ...
Epoch: 26 cost time: 0.6411838531494141
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.268 Vali Acc: 0.289 Test Loss: 4.268 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5759258270263672
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.309 Vali Acc: 0.289 Test Loss: 4.309 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6121470928192139
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.328 Vali Acc: 0.293 Test Loss: 4.328 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.64021897315979
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.369 Vali Acc: 0.293 Test Loss: 4.369 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6783509254455566
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.411 Vali Acc: 0.292 Test Loss: 4.411 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5865762233734131
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.438 Vali Acc: 0.294 Test Loss: 4.438 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.713853120803833
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.414 Vali Acc: 0.299 Test Loss: 4.414 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6844081878662109
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.416 Vali Acc: 0.294 Test Loss: 4.416 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7119956016540527
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.455 Vali Acc: 0.294 Test Loss: 4.455 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6206846237182617
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.503 Vali Acc: 0.294 Test Loss: 4.503 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 43682330
model size : 181.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.497077465057373
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.332 Vali Acc: 0.041 Test Loss: 3.332 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.8402552604675293
Epoch: 2, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.356 Vali Acc: 0.052 Test Loss: 3.356 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.843289852142334
Epoch: 3, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.362 Vali Acc: 0.060 Test Loss: 3.362 Test Acc: 0.060
Validation loss decreased (-0.051731 --> -0.059966).  Saving model ...
Epoch: 4 cost time: 0.8667895793914795
Epoch: 4, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.283 Vali Acc: 0.075 Test Loss: 3.283 Test Acc: 0.075
Validation loss decreased (-0.059966 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.738461971282959
Epoch: 5, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.212 Vali Acc: 0.121 Test Loss: 3.212 Test Acc: 0.121
Validation loss decreased (-0.075261 --> -0.121144).  Saving model ...
Epoch: 6 cost time: 0.7124049663543701
Epoch: 6, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.244 Vali Acc: 0.140 Test Loss: 3.244 Test Acc: 0.140
Validation loss decreased (-0.121144 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 0.8563206195831299
Epoch: 7, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.266 Vali Acc: 0.166 Test Loss: 3.266 Test Acc: 0.166
Validation loss decreased (-0.139968 --> -0.165850).  Saving model ...
Epoch: 8 cost time: 0.7511794567108154
Epoch: 8, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.393 Vali Acc: 0.211 Test Loss: 3.393 Test Acc: 0.211
Validation loss decreased (-0.165850 --> -0.210554).  Saving model ...
Epoch: 9 cost time: 0.5617275238037109
Epoch: 9, Steps: 10 | Train Loss: 1.110 Vali Loss: 3.578 Vali Acc: 0.233 Test Loss: 3.578 Test Acc: 0.233
Validation loss decreased (-0.210554 --> -0.232905).  Saving model ...
Epoch: 10 cost time: 0.5822021961212158
Epoch: 10, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.729 Vali Acc: 0.242 Test Loss: 3.729 Test Acc: 0.242
Validation loss decreased (-0.232905 --> -0.242316).  Saving model ...
Epoch: 11 cost time: 0.6752452850341797
Epoch: 11, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.900 Vali Acc: 0.264 Test Loss: 3.900 Test Acc: 0.264
Validation loss decreased (-0.242316 --> -0.263490).  Saving model ...
Epoch: 12 cost time: 0.9401552677154541
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.087 Vali Acc: 0.276 Test Loss: 4.087 Test Acc: 0.276
Validation loss decreased (-0.263490 --> -0.276430).  Saving model ...
Epoch: 13 cost time: 0.9286363124847412
Epoch: 13, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.321 Vali Acc: 0.264 Test Loss: 4.321 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7825560569763184
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.466 Vali Acc: 0.266 Test Loss: 4.466 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8793590068817139
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.566 Vali Acc: 0.266 Test Loss: 4.566 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0165507793426514
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.466 Vali Acc: 0.299 Test Loss: 4.466 Test Acc: 0.299
Validation loss decreased (-0.276430 --> -0.298779).  Saving model ...
Epoch: 17 cost time: 0.9833381175994873
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.566 Vali Acc: 0.284 Test Loss: 4.566 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1220102310180664
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.695 Vali Acc: 0.294 Test Loss: 4.695 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0990705490112305
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.644 Vali Acc: 0.299 Test Loss: 4.644 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.07295823097229
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.728 Vali Acc: 0.292 Test Loss: 4.728 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9583098888397217
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.754 Vali Acc: 0.294 Test Loss: 4.754 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8532931804656982
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.783 Vali Acc: 0.294 Test Loss: 4.783 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0597741603851318
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.781 Vali Acc: 0.301 Test Loss: 4.781 Test Acc: 0.301
Validation loss decreased (-0.298779 --> -0.301129).  Saving model ...
Epoch: 24 cost time: 0.9461853504180908
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.774 Vali Acc: 0.301 Test Loss: 4.774 Test Acc: 0.301
Validation loss decreased (-0.301129 --> -0.301129).  Saving model ...
Epoch: 25 cost time: 1.0330679416656494
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.787 Vali Acc: 0.305 Test Loss: 4.787 Test Acc: 0.305
Validation loss decreased (-0.301129 --> -0.304658).  Saving model ...
Epoch: 26 cost time: 0.8055074214935303
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.804 Vali Acc: 0.301 Test Loss: 4.804 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.14699387550354
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.821 Vali Acc: 0.296 Test Loss: 4.821 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8395261764526367
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.842 Vali Acc: 0.293 Test Loss: 4.842 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0332584381103516
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.858 Vali Acc: 0.298 Test Loss: 4.858 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0385527610778809
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.870 Vali Acc: 0.298 Test Loss: 4.870 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.057523488998413
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.900 Vali Acc: 0.295 Test Loss: 4.900 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0395445823669434
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.905 Vali Acc: 0.300 Test Loss: 4.905 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0016298294067383
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.888 Vali Acc: 0.304 Test Loss: 4.888 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5763645172119141
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.897 Vali Acc: 0.307 Test Loss: 4.897 Test Acc: 0.307
Validation loss decreased (-0.304658 --> -0.307010).  Saving model ...
Epoch: 35 cost time: 1.0884208679199219
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.907 Vali Acc: 0.301 Test Loss: 4.907 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2602274417877197
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.936 Vali Acc: 0.301 Test Loss: 4.936 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.901585578918457
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.937 Vali Acc: 0.300 Test Loss: 4.937 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9531974792480469
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.926 Vali Acc: 0.305 Test Loss: 4.926 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9128286838531494
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.931 Vali Acc: 0.308 Test Loss: 4.931 Test Acc: 0.308
Validation loss decreased (-0.307010 --> -0.308186).  Saving model ...
Epoch: 40 cost time: 1.0782039165496826
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.939 Vali Acc: 0.305 Test Loss: 4.939 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.883188009262085
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.951 Vali Acc: 0.305 Test Loss: 4.951 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5951740741729736
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.970 Vali Acc: 0.308 Test Loss: 4.970 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8694779872894287
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.990 Vali Acc: 0.302 Test Loss: 4.990 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0542585849761963
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.995 Vali Acc: 0.306 Test Loss: 4.995 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7009501457214355
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.998 Vali Acc: 0.308 Test Loss: 4.998 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8453242778778076
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.999 Vali Acc: 0.306 Test Loss: 4.999 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9866092205047607
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.014 Vali Acc: 0.305 Test Loss: 5.014 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0094332695007324
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.033 Vali Acc: 0.305 Test Loss: 5.033 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9707105159759521
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.040 Vali Acc: 0.302 Test Loss: 5.040 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 43953434
model size : 182.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.16135311126709
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.321 Vali Acc: 0.045 Test Loss: 3.321 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.6118171215057373
Epoch: 2, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.309 Vali Acc: 0.040 Test Loss: 3.309 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5665063858032227
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.319 Vali Acc: 0.048 Test Loss: 3.319 Test Acc: 0.048
Validation loss decreased (-0.044673 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.758763313293457
Epoch: 4, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.334 Vali Acc: 0.071 Test Loss: 3.334 Test Acc: 0.071
Validation loss decreased (-0.048202 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 0.7550048828125
Epoch: 5, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.287 Vali Acc: 0.092 Test Loss: 3.287 Test Acc: 0.092
Validation loss decreased (-0.070555 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.7902896404266357
Epoch: 6, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.257 Vali Acc: 0.112 Test Loss: 3.257 Test Acc: 0.112
Validation loss decreased (-0.091732 --> -0.111732).  Saving model ...
Epoch: 7 cost time: 0.7665600776672363
Epoch: 7, Steps: 10 | Train Loss: 2.476 Vali Loss: 3.222 Vali Acc: 0.144 Test Loss: 3.222 Test Acc: 0.144
Validation loss decreased (-0.111732 --> -0.143497).  Saving model ...
Epoch: 8 cost time: 0.751223087310791
Epoch: 8, Steps: 10 | Train Loss: 2.165 Vali Loss: 3.211 Vali Acc: 0.180 Test Loss: 3.211 Test Acc: 0.180
Validation loss decreased (-0.143497 --> -0.179968).  Saving model ...
Epoch: 9 cost time: 0.656956672668457
Epoch: 9, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.298 Vali Acc: 0.198 Test Loss: 3.298 Test Acc: 0.198
Validation loss decreased (-0.179968 --> -0.197614).  Saving model ...
Epoch: 10 cost time: 0.6197412014007568
Epoch: 10, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.463 Vali Acc: 0.213 Test Loss: 3.463 Test Acc: 0.213
Validation loss decreased (-0.197614 --> -0.212907).  Saving model ...
Epoch: 11 cost time: 0.7724120616912842
Epoch: 11, Steps: 10 | Train Loss: 0.926 Vali Loss: 3.486 Vali Acc: 0.235 Test Loss: 3.486 Test Acc: 0.235
Validation loss decreased (-0.212907 --> -0.235259).  Saving model ...
Epoch: 12 cost time: 0.6268341541290283
Epoch: 12, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.573 Vali Acc: 0.246 Test Loss: 3.573 Test Acc: 0.246
Validation loss decreased (-0.235259 --> -0.245847).  Saving model ...
Epoch: 13 cost time: 0.7492697238922119
Epoch: 13, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.681 Vali Acc: 0.261 Test Loss: 3.681 Test Acc: 0.261
Validation loss decreased (-0.245847 --> -0.261140).  Saving model ...
Epoch: 14 cost time: 0.7732901573181152
Epoch: 14, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.851 Vali Acc: 0.266 Test Loss: 3.851 Test Acc: 0.266
Validation loss decreased (-0.261140 --> -0.265844).  Saving model ...
Epoch: 15 cost time: 0.7764687538146973
Epoch: 15, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.884 Vali Acc: 0.280 Test Loss: 3.884 Test Acc: 0.280
Validation loss decreased (-0.265844 --> -0.279961).  Saving model ...
Epoch: 16 cost time: 0.6946709156036377
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.095 Vali Acc: 0.258 Test Loss: 4.095 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7806985378265381
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.166 Vali Acc: 0.275 Test Loss: 4.166 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8077731132507324
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.251 Vali Acc: 0.291 Test Loss: 4.251 Test Acc: 0.291
Validation loss decreased (-0.279961 --> -0.290546).  Saving model ...
Epoch: 19 cost time: 0.8156945705413818
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.225 Vali Acc: 0.291 Test Loss: 4.225 Test Acc: 0.291
Validation loss decreased (-0.290546 --> -0.290546).  Saving model ...
Epoch: 20 cost time: 0.8067891597747803
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.264 Vali Acc: 0.306 Test Loss: 4.264 Test Acc: 0.306
Validation loss decreased (-0.290546 --> -0.305840).  Saving model ...
Epoch: 21 cost time: 0.6924269199371338
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.322 Vali Acc: 0.299 Test Loss: 4.322 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7305006980895996
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.391 Vali Acc: 0.300 Test Loss: 4.391 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.68609619140625
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.445 Vali Acc: 0.293 Test Loss: 4.445 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7397661209106445
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.463 Vali Acc: 0.299 Test Loss: 4.463 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7290751934051514
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.505 Vali Acc: 0.302 Test Loss: 4.505 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7304537296295166
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.540 Vali Acc: 0.296 Test Loss: 4.540 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6979751586914062
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.528 Vali Acc: 0.296 Test Loss: 4.528 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7093110084533691
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.528 Vali Acc: 0.294 Test Loss: 4.528 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7785992622375488
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.538 Vali Acc: 0.295 Test Loss: 4.538 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6825549602508545
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.576 Vali Acc: 0.293 Test Loss: 4.576 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 43781402
model size : 181.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9508917331695557
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.337 Vali Acc: 0.054 Test Loss: 3.337 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 0.667616605758667
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.315 Vali Acc: 0.052 Test Loss: 3.315 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6442921161651611
Epoch: 3, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.310 Vali Acc: 0.051 Test Loss: 3.310 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6255087852478027
Epoch: 4, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.300 Vali Acc: 0.064 Test Loss: 3.300 Test Acc: 0.064
Validation loss decreased (-0.054084 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 0.7032332420349121
Epoch: 5, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.292 Vali Acc: 0.071 Test Loss: 3.292 Test Acc: 0.071
Validation loss decreased (-0.063496 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 0.66463303565979
Epoch: 6, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.281 Vali Acc: 0.079 Test Loss: 3.281 Test Acc: 0.079
Validation loss decreased (-0.070555 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.7058742046356201
Epoch: 7, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.257 Vali Acc: 0.098 Test Loss: 3.257 Test Acc: 0.098
Validation loss decreased (-0.078791 --> -0.097614).  Saving model ...
Epoch: 8 cost time: 0.6952450275421143
Epoch: 8, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.246 Vali Acc: 0.105 Test Loss: 3.246 Test Acc: 0.105
Validation loss decreased (-0.097614 --> -0.104673).  Saving model ...
Epoch: 9 cost time: 0.6310861110687256
Epoch: 9, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.267 Vali Acc: 0.122 Test Loss: 3.267 Test Acc: 0.122
Validation loss decreased (-0.104673 --> -0.122320).  Saving model ...
Epoch: 10 cost time: 0.6628470420837402
Epoch: 10, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.272 Vali Acc: 0.149 Test Loss: 3.272 Test Acc: 0.149
Validation loss decreased (-0.122320 --> -0.149379).  Saving model ...
Epoch: 11 cost time: 0.7222094535827637
Epoch: 11, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.300 Vali Acc: 0.180 Test Loss: 3.300 Test Acc: 0.180
Validation loss decreased (-0.149379 --> -0.179967).  Saving model ...
Epoch: 12 cost time: 0.6996698379516602
Epoch: 12, Steps: 10 | Train Loss: 1.314 Vali Loss: 3.398 Vali Acc: 0.187 Test Loss: 3.398 Test Acc: 0.187
Validation loss decreased (-0.179967 --> -0.187025).  Saving model ...
Epoch: 13 cost time: 0.6675944328308105
Epoch: 13, Steps: 10 | Train Loss: 1.039 Vali Loss: 3.346 Vali Acc: 0.213 Test Loss: 3.346 Test Acc: 0.213
Validation loss decreased (-0.187025 --> -0.212908).  Saving model ...
Epoch: 14 cost time: 0.6390640735626221
Epoch: 14, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.455 Vali Acc: 0.231 Test Loss: 3.455 Test Acc: 0.231
Validation loss decreased (-0.212908 --> -0.230554).  Saving model ...
Epoch: 15 cost time: 0.7414257526397705
Epoch: 15, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.533 Vali Acc: 0.238 Test Loss: 3.533 Test Acc: 0.238
Validation loss decreased (-0.230554 --> -0.237612).  Saving model ...
Epoch: 16 cost time: 0.7343630790710449
Epoch: 16, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.649 Vali Acc: 0.246 Test Loss: 3.649 Test Acc: 0.246
Validation loss decreased (-0.237612 --> -0.245846).  Saving model ...
Epoch: 17 cost time: 0.701911211013794
Epoch: 17, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.748 Vali Acc: 0.269 Test Loss: 3.748 Test Acc: 0.269
Validation loss decreased (-0.245846 --> -0.269374).  Saving model ...
Epoch: 18 cost time: 0.6013197898864746
Epoch: 18, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.727 Vali Acc: 0.266 Test Loss: 3.727 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7015037536621094
Epoch: 19, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.811 Vali Acc: 0.273 Test Loss: 3.811 Test Acc: 0.273
Validation loss decreased (-0.269374 --> -0.272903).  Saving model ...
Epoch: 20 cost time: 0.701002836227417
Epoch: 20, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.849 Vali Acc: 0.279 Test Loss: 3.849 Test Acc: 0.279
Validation loss decreased (-0.272903 --> -0.278785).  Saving model ...
Epoch: 21 cost time: 0.6108176708221436
Epoch: 21, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.020 Vali Acc: 0.280 Test Loss: 4.020 Test Acc: 0.280
Validation loss decreased (-0.278785 --> -0.279960).  Saving model ...
Epoch: 22 cost time: 0.7163457870483398
Epoch: 22, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.008 Vali Acc: 0.280 Test Loss: 4.008 Test Acc: 0.280
Validation loss decreased (-0.279960 --> -0.279960).  Saving model ...
Epoch: 23 cost time: 0.7510828971862793
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.004 Vali Acc: 0.285 Test Loss: 4.004 Test Acc: 0.285
Validation loss decreased (-0.279960 --> -0.284666).  Saving model ...
Epoch: 24 cost time: 0.7091388702392578
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.056 Vali Acc: 0.284 Test Loss: 4.056 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6000087261199951
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.157 Vali Acc: 0.282 Test Loss: 4.157 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6728601455688477
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.202 Vali Acc: 0.285 Test Loss: 4.202 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6020159721374512
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.200 Vali Acc: 0.284 Test Loss: 4.200 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7211933135986328
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.205 Vali Acc: 0.289 Test Loss: 4.205 Test Acc: 0.289
Validation loss decreased (-0.284666 --> -0.289370).  Saving model ...
Epoch: 29 cost time: 0.6552152633666992
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.230 Vali Acc: 0.285 Test Loss: 4.230 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6556925773620605
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.244 Vali Acc: 0.287 Test Loss: 4.244 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7109925746917725
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.271 Vali Acc: 0.292 Test Loss: 4.271 Test Acc: 0.292
Validation loss decreased (-0.289370 --> -0.291722).  Saving model ...
Epoch: 32 cost time: 0.765749454498291
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.289 Vali Acc: 0.293 Test Loss: 4.289 Test Acc: 0.293
Validation loss decreased (-0.291722 --> -0.292898).  Saving model ...
Epoch: 33 cost time: 0.739417314529419
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.315 Vali Acc: 0.298 Test Loss: 4.315 Test Acc: 0.298
Validation loss decreased (-0.292898 --> -0.297604).  Saving model ...
Epoch: 34 cost time: 0.6791501045227051
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.351 Vali Acc: 0.294 Test Loss: 4.351 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.699775218963623
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.369 Vali Acc: 0.293 Test Loss: 4.369 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.625483512878418
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.389 Vali Acc: 0.296 Test Loss: 4.389 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6373617649078369
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.411 Vali Acc: 0.295 Test Loss: 4.411 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5265824794769287
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.425 Vali Acc: 0.299 Test Loss: 4.425 Test Acc: 0.299
Validation loss decreased (-0.297604 --> -0.298779).  Saving model ...
Epoch: 39 cost time: 0.5921506881713867
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.436 Vali Acc: 0.296 Test Loss: 4.436 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.500694751739502
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.468 Vali Acc: 0.295 Test Loss: 4.468 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5614039897918701
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.500 Vali Acc: 0.293 Test Loss: 4.500 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5254485607147217
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.517 Vali Acc: 0.295 Test Loss: 4.517 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5429601669311523
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.525 Vali Acc: 0.300 Test Loss: 4.525 Test Acc: 0.300
Validation loss decreased (-0.298779 --> -0.299955).  Saving model ...
Epoch: 44 cost time: 0.5508110523223877
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.535 Vali Acc: 0.300 Test Loss: 4.535 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6836552619934082
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.545 Vali Acc: 0.299 Test Loss: 4.545 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5787665843963623
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.558 Vali Acc: 0.295 Test Loss: 4.558 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5881063938140869
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.568 Vali Acc: 0.292 Test Loss: 4.568 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6127161979675293
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.557 Vali Acc: 0.298 Test Loss: 4.557 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6390175819396973
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.552 Vali Acc: 0.300 Test Loss: 4.552 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5550956726074219
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.564 Vali Acc: 0.300 Test Loss: 4.564 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el6_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3
model parameter : 43695386
model size : 181.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8390913009643555
Epoch: 1, Steps: 10 | Train Loss: 3.421 Vali Loss: 3.388 Vali Acc: 0.038 Test Loss: 3.388 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.086423635482788
Epoch: 2, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.341 Vali Acc: 0.102 Test Loss: 3.341 Test Acc: 0.102
Validation loss decreased (-0.037613 --> -0.102320).  Saving model ...
Epoch: 3 cost time: 1.3020391464233398
Epoch: 3, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.269 Vali Acc: 0.111 Test Loss: 3.269 Test Acc: 0.111
Validation loss decreased (-0.102320 --> -0.110556).  Saving model ...
Epoch: 4 cost time: 1.4215505123138428
Epoch: 4, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.140 Vali Acc: 0.121 Test Loss: 3.140 Test Acc: 0.121
Validation loss decreased (-0.110556 --> -0.121145).  Saving model ...
Epoch: 5 cost time: 0.8165161609649658
Epoch: 5, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.280 Vali Acc: 0.181 Test Loss: 3.280 Test Acc: 0.181
Validation loss decreased (-0.121145 --> -0.181144).  Saving model ...
Epoch: 6 cost time: 1.1528980731964111
Epoch: 6, Steps: 10 | Train Loss: 1.329 Vali Loss: 3.487 Vali Acc: 0.193 Test Loss: 3.487 Test Acc: 0.193
Validation loss decreased (-0.181144 --> -0.192906).  Saving model ...
Epoch: 7 cost time: 1.0159223079681396
Epoch: 7, Steps: 10 | Train Loss: 0.828 Vali Loss: 4.246 Vali Acc: 0.229 Test Loss: 4.246 Test Acc: 0.229
Validation loss decreased (-0.192906 --> -0.229369).  Saving model ...
Epoch: 8 cost time: 1.1659159660339355
Epoch: 8, Steps: 10 | Train Loss: 0.539 Vali Loss: 4.980 Vali Acc: 0.220 Test Loss: 4.980 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3625297546386719
Epoch: 9, Steps: 10 | Train Loss: 0.215 Vali Loss: 5.616 Vali Acc: 0.246 Test Loss: 5.616 Test Acc: 0.246
Validation loss decreased (-0.229369 --> -0.245826).  Saving model ...
Epoch: 10 cost time: 1.2469878196716309
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 6.701 Vali Acc: 0.228 Test Loss: 6.701 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3945870399475098
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 7.721 Vali Acc: 0.254 Test Loss: 7.721 Test Acc: 0.254
Validation loss decreased (-0.245826 --> -0.254040).  Saving model ...
Epoch: 12 cost time: 0.9927823543548584
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 8.156 Vali Acc: 0.227 Test Loss: 8.156 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0729494094848633
Epoch: 13, Steps: 10 | Train Loss: 0.142 Vali Loss: 7.818 Vali Acc: 0.275 Test Loss: 7.818 Test Acc: 0.275
Validation loss decreased (-0.254040 --> -0.275216).  Saving model ...
Epoch: 14 cost time: 1.1675670146942139
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 8.856 Vali Acc: 0.232 Test Loss: 8.856 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0279912948608398
Epoch: 15, Steps: 10 | Train Loss: 0.087 Vali Loss: 8.387 Vali Acc: 0.241 Test Loss: 8.387 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2358648777008057
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 9.833 Vali Acc: 0.207 Test Loss: 9.833 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1052064895629883
Epoch: 17, Steps: 10 | Train Loss: 0.128 Vali Loss: 10.301 Vali Acc: 0.233 Test Loss: 10.301 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0717275142669678
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 9.964 Vali Acc: 0.264 Test Loss: 9.964 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1270520687103271
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 11.948 Vali Acc: 0.221 Test Loss: 11.948 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.246781349182129
Epoch: 20, Steps: 10 | Train Loss: 0.147 Vali Loss: 11.333 Vali Acc: 0.214 Test Loss: 11.333 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1494886875152588
Epoch: 21, Steps: 10 | Train Loss: 0.270 Vali Loss: 11.330 Vali Acc: 0.208 Test Loss: 11.330 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1848626136779785
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 12.192 Vali Acc: 0.200 Test Loss: 12.192 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1141138076782227
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 11.650 Vali Acc: 0.225 Test Loss: 11.650 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 37925402
model size : 159.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5331265926361084
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.318 Vali Acc: 0.045 Test Loss: 3.318 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.0577354431152344
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.384 Vali Acc: 0.072 Test Loss: 3.384 Test Acc: 0.072
Validation loss decreased (-0.044673 --> -0.071731).  Saving model ...
Epoch: 3 cost time: 0.9686613082885742
Epoch: 3, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.266 Vali Acc: 0.094 Test Loss: 3.266 Test Acc: 0.094
Validation loss decreased (-0.071731 --> -0.094085).  Saving model ...
Epoch: 4 cost time: 0.8407444953918457
Epoch: 4, Steps: 10 | Train Loss: 2.713 Vali Loss: 3.224 Vali Acc: 0.122 Test Loss: 3.224 Test Acc: 0.122
Validation loss decreased (-0.094085 --> -0.122321).  Saving model ...
Epoch: 5 cost time: 0.8552582263946533
Epoch: 5, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.244 Vali Acc: 0.151 Test Loss: 3.244 Test Acc: 0.151
Validation loss decreased (-0.122321 --> -0.150556).  Saving model ...
Epoch: 6 cost time: 0.9253261089324951
Epoch: 6, Steps: 10 | Train Loss: 1.910 Vali Loss: 3.157 Vali Acc: 0.209 Test Loss: 3.157 Test Acc: 0.209
Validation loss decreased (-0.150556 --> -0.209380).  Saving model ...
Epoch: 7 cost time: 0.8775918483734131
Epoch: 7, Steps: 10 | Train Loss: 1.351 Vali Loss: 3.688 Vali Acc: 0.194 Test Loss: 3.688 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9095933437347412
Epoch: 8, Steps: 10 | Train Loss: 0.973 Vali Loss: 4.051 Vali Acc: 0.227 Test Loss: 4.051 Test Acc: 0.227
Validation loss decreased (-0.209380 --> -0.227018).  Saving model ...
Epoch: 9 cost time: 0.9823307991027832
Epoch: 9, Steps: 10 | Train Loss: 0.537 Vali Loss: 4.506 Vali Acc: 0.240 Test Loss: 4.506 Test Acc: 0.240
Validation loss decreased (-0.227018 --> -0.239955).  Saving model ...
Epoch: 10 cost time: 1.024583339691162
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 4.849 Vali Acc: 0.256 Test Loss: 4.849 Test Acc: 0.256
Validation loss decreased (-0.239955 --> -0.256422).  Saving model ...
Epoch: 11 cost time: 0.9556636810302734
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 5.414 Vali Acc: 0.234 Test Loss: 5.414 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.976884126663208
Epoch: 12, Steps: 10 | Train Loss: 0.269 Vali Loss: 5.488 Vali Acc: 0.265 Test Loss: 5.488 Test Acc: 0.265
Validation loss decreased (-0.256422 --> -0.264651).  Saving model ...
Epoch: 13 cost time: 0.9433243274688721
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 5.794 Vali Acc: 0.262 Test Loss: 5.794 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8764069080352783
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 6.040 Vali Acc: 0.254 Test Loss: 6.040 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9066188335418701
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.067 Vali Acc: 0.293 Test Loss: 6.067 Test Acc: 0.293
Validation loss decreased (-0.264651 --> -0.292881).  Saving model ...
Epoch: 16 cost time: 0.8693487644195557
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.995 Vali Acc: 0.288 Test Loss: 5.995 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0580623149871826
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.299 Vali Acc: 0.291 Test Loss: 6.299 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8382694721221924
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.561 Vali Acc: 0.278 Test Loss: 6.561 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8630466461181641
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.863 Vali Acc: 0.264 Test Loss: 6.863 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6809453964233398
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.842 Vali Acc: 0.287 Test Loss: 6.842 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0072271823883057
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 6.394 Vali Acc: 0.282 Test Loss: 6.394 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9381527900695801
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.911 Vali Acc: 0.291 Test Loss: 6.911 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7809433937072754
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.199 Vali Acc: 0.267 Test Loss: 7.199 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8775901794433594
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.751 Vali Acc: 0.298 Test Loss: 6.751 Test Acc: 0.298
Validation loss decreased (-0.292881 --> -0.297580).  Saving model ...
Epoch: 25 cost time: 1.033081293106079
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.839 Vali Acc: 0.288 Test Loss: 6.839 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8184034824371338
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.854 Vali Acc: 0.292 Test Loss: 6.854 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6914408206939697
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.737 Vali Acc: 0.291 Test Loss: 6.737 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6302492618560791
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.740 Vali Acc: 0.292 Test Loss: 6.740 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6005697250366211
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.780 Vali Acc: 0.298 Test Loss: 6.780 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6545073986053467
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.782 Vali Acc: 0.302 Test Loss: 6.782 Test Acc: 0.302
Validation loss decreased (-0.297580 --> -0.302285).  Saving model ...
Epoch: 31 cost time: 0.7136139869689941
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.770 Vali Acc: 0.300 Test Loss: 6.770 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7590479850769043
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.760 Vali Acc: 0.301 Test Loss: 6.760 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7718038558959961
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.763 Vali Acc: 0.304 Test Loss: 6.763 Test Acc: 0.304
Validation loss decreased (-0.302285 --> -0.303462).  Saving model ...
Epoch: 34 cost time: 0.8315384387969971
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.767 Vali Acc: 0.304 Test Loss: 6.767 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6754212379455566
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.759 Vali Acc: 0.304 Test Loss: 6.759 Test Acc: 0.304
Validation loss decreased (-0.303462 --> -0.303462).  Saving model ...
Epoch: 36 cost time: 0.8669486045837402
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.730 Vali Acc: 0.304 Test Loss: 6.730 Test Acc: 0.304
Validation loss decreased (-0.303462 --> -0.303462).  Saving model ...
Epoch: 37 cost time: 0.9328062534332275
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.725 Vali Acc: 0.306 Test Loss: 6.725 Test Acc: 0.306
Validation loss decreased (-0.303462 --> -0.305815).  Saving model ...
Epoch: 38 cost time: 0.64666748046875
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.737 Vali Acc: 0.305 Test Loss: 6.737 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6624526977539062
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.758 Vali Acc: 0.307 Test Loss: 6.758 Test Acc: 0.307
Validation loss decreased (-0.305815 --> -0.306991).  Saving model ...
Epoch: 40 cost time: 1.0103974342346191
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.786 Vali Acc: 0.305 Test Loss: 6.786 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9334564208984375
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.780 Vali Acc: 0.306 Test Loss: 6.780 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.124495506286621
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.785 Vali Acc: 0.306 Test Loss: 6.785 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8426358699798584
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.784 Vali Acc: 0.307 Test Loss: 6.784 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7981555461883545
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.780 Vali Acc: 0.306 Test Loss: 6.780 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8370695114135742
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.777 Vali Acc: 0.309 Test Loss: 6.777 Test Acc: 0.309
Validation loss decreased (-0.306991 --> -0.309344).  Saving model ...
Epoch: 46 cost time: 0.8402066230773926
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.774 Vali Acc: 0.309 Test Loss: 6.774 Test Acc: 0.309
Validation loss decreased (-0.309344 --> -0.309344).  Saving model ...
Epoch: 47 cost time: 0.8244035243988037
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.780 Vali Acc: 0.309 Test Loss: 6.780 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7218635082244873
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.777 Vali Acc: 0.311 Test Loss: 6.777 Test Acc: 0.311
Validation loss decreased (-0.309344 --> -0.310520).  Saving model ...
Epoch: 49 cost time: 0.7885284423828125
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.779 Vali Acc: 0.312 Test Loss: 6.779 Test Acc: 0.312
Validation loss decreased (-0.310520 --> -0.311697).  Saving model ...
Epoch: 50 cost time: 0.7499980926513672
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.780 Vali Acc: 0.311 Test Loss: 6.780 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 37151258
model size : 156.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8319509029388428
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.302 Vali Acc: 0.051 Test Loss: 3.302 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.6849946975708008
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.337 Vali Acc: 0.061 Test Loss: 3.337 Test Acc: 0.061
Validation loss decreased (-0.050555 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.6412992477416992
Epoch: 3, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.328 Vali Acc: 0.079 Test Loss: 3.328 Test Acc: 0.079
Validation loss decreased (-0.061143 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 0.6344757080078125
Epoch: 4, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.230 Vali Acc: 0.112 Test Loss: 3.230 Test Acc: 0.112
Validation loss decreased (-0.078790 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 0.6853525638580322
Epoch: 5, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.195 Vali Acc: 0.120 Test Loss: 3.195 Test Acc: 0.120
Validation loss decreased (-0.111732 --> -0.119968).  Saving model ...
Epoch: 6 cost time: 0.7580885887145996
Epoch: 6, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.142 Vali Acc: 0.168 Test Loss: 3.142 Test Acc: 0.168
Validation loss decreased (-0.119968 --> -0.168204).  Saving model ...
Epoch: 7 cost time: 0.7041153907775879
Epoch: 7, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.203 Vali Acc: 0.196 Test Loss: 3.203 Test Acc: 0.196
Validation loss decreased (-0.168204 --> -0.196439).  Saving model ...
Epoch: 8 cost time: 0.6989021301269531
Epoch: 8, Steps: 10 | Train Loss: 1.342 Vali Loss: 3.377 Vali Acc: 0.200 Test Loss: 3.377 Test Acc: 0.200
Validation loss decreased (-0.196439 --> -0.199966).  Saving model ...
Epoch: 9 cost time: 0.7309024333953857
Epoch: 9, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.603 Vali Acc: 0.252 Test Loss: 3.603 Test Acc: 0.252
Validation loss decreased (-0.199966 --> -0.251729).  Saving model ...
Epoch: 10 cost time: 0.8585262298583984
Epoch: 10, Steps: 10 | Train Loss: 0.595 Vali Loss: 4.026 Vali Acc: 0.233 Test Loss: 4.026 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6798481941223145
Epoch: 11, Steps: 10 | Train Loss: 0.390 Vali Loss: 4.034 Vali Acc: 0.267 Test Loss: 4.034 Test Acc: 0.267
Validation loss decreased (-0.251729 --> -0.267018).  Saving model ...
Epoch: 12 cost time: 0.7065708637237549
Epoch: 12, Steps: 10 | Train Loss: 0.245 Vali Loss: 4.281 Vali Acc: 0.264 Test Loss: 4.281 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6433284282684326
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.496 Vali Acc: 0.286 Test Loss: 4.496 Test Acc: 0.286
Validation loss decreased (-0.267018 --> -0.285837).  Saving model ...
Epoch: 14 cost time: 0.6812939643859863
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.644 Vali Acc: 0.271 Test Loss: 4.644 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6427907943725586
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 5.254 Vali Acc: 0.259 Test Loss: 5.254 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0018088817596436
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.975 Vali Acc: 0.288 Test Loss: 4.975 Test Acc: 0.288
Validation loss decreased (-0.285837 --> -0.288186).  Saving model ...
Epoch: 17 cost time: 0.8475072383880615
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.003 Vali Acc: 0.285 Test Loss: 5.003 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5655686855316162
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.998 Vali Acc: 0.296 Test Loss: 4.998 Test Acc: 0.296
Validation loss decreased (-0.288186 --> -0.296421).  Saving model ...
Epoch: 19 cost time: 0.8140933513641357
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.154 Vali Acc: 0.288 Test Loss: 5.154 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7936689853668213
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.219 Vali Acc: 0.285 Test Loss: 5.219 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6805076599121094
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.196 Vali Acc: 0.300 Test Loss: 5.196 Test Acc: 0.300
Validation loss decreased (-0.296421 --> -0.299948).  Saving model ...
Epoch: 22 cost time: 0.9313979148864746
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.179 Vali Acc: 0.308 Test Loss: 5.179 Test Acc: 0.308
Validation loss decreased (-0.299948 --> -0.308184).  Saving model ...
Epoch: 23 cost time: 0.670147180557251
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.185 Vali Acc: 0.307 Test Loss: 5.185 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5188238620758057
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.223 Vali Acc: 0.298 Test Loss: 5.223 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7174208164215088
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.235 Vali Acc: 0.299 Test Loss: 5.235 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6521897315979004
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.251 Vali Acc: 0.298 Test Loss: 5.251 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5273549556732178
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.269 Vali Acc: 0.302 Test Loss: 5.269 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6493749618530273
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.301 Vali Acc: 0.295 Test Loss: 5.301 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6544477939605713
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.315 Vali Acc: 0.296 Test Loss: 5.315 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6465311050415039
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.332 Vali Acc: 0.300 Test Loss: 5.332 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.772381067276001
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.334 Vali Acc: 0.306 Test Loss: 5.334 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.764481782913208
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.352 Vali Acc: 0.302 Test Loss: 5.352 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 36807194
model size : 155.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6502180099487305
Epoch: 1, Steps: 10 | Train Loss: 3.483 Vali Loss: 3.356 Vali Acc: 0.060 Test Loss: 3.356 Test Acc: 0.060
Validation loss decreased (inf --> -0.059966).  Saving model ...
Epoch: 2 cost time: 1.0340404510498047
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.371 Vali Acc: 0.068 Test Loss: 3.371 Test Acc: 0.068
Validation loss decreased (-0.059966 --> -0.068202).  Saving model ...
Epoch: 3 cost time: 1.002964735031128
Epoch: 3, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.220 Vali Acc: 0.108 Test Loss: 3.220 Test Acc: 0.108
Validation loss decreased (-0.068202 --> -0.108203).  Saving model ...
Epoch: 4 cost time: 1.0025272369384766
Epoch: 4, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.269 Vali Acc: 0.154 Test Loss: 3.269 Test Acc: 0.154
Validation loss decreased (-0.108203 --> -0.154085).  Saving model ...
Epoch: 5 cost time: 1.059445858001709
Epoch: 5, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.140 Vali Acc: 0.202 Test Loss: 3.140 Test Acc: 0.202
Validation loss decreased (-0.154085 --> -0.202322).  Saving model ...
Epoch: 6 cost time: 1.08833909034729
Epoch: 6, Steps: 10 | Train Loss: 1.322 Vali Loss: 3.514 Vali Acc: 0.215 Test Loss: 3.514 Test Acc: 0.215
Validation loss decreased (-0.202322 --> -0.215259).  Saving model ...
Epoch: 7 cost time: 1.2088007926940918
Epoch: 7, Steps: 10 | Train Loss: 0.810 Vali Loss: 4.122 Vali Acc: 0.221 Test Loss: 4.122 Test Acc: 0.221
Validation loss decreased (-0.215259 --> -0.221135).  Saving model ...
Epoch: 8 cost time: 1.0695669651031494
Epoch: 8, Steps: 10 | Train Loss: 0.522 Vali Loss: 5.108 Vali Acc: 0.232 Test Loss: 5.108 Test Acc: 0.232
Validation loss decreased (-0.221135 --> -0.231714).  Saving model ...
Epoch: 9 cost time: 1.1720705032348633
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 6.051 Vali Acc: 0.234 Test Loss: 6.051 Test Acc: 0.234
Validation loss decreased (-0.231714 --> -0.234057).  Saving model ...
Epoch: 10 cost time: 1.1794517040252686
Epoch: 10, Steps: 10 | Train Loss: 0.272 Vali Loss: 6.431 Vali Acc: 0.255 Test Loss: 6.431 Test Acc: 0.255
Validation loss decreased (-0.234057 --> -0.255230).  Saving model ...
Epoch: 11 cost time: 1.0701727867126465
Epoch: 11, Steps: 10 | Train Loss: 0.331 Vali Loss: 7.597 Vali Acc: 0.251 Test Loss: 7.597 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3377883434295654
Epoch: 12, Steps: 10 | Train Loss: 0.119 Vali Loss: 7.207 Vali Acc: 0.246 Test Loss: 7.207 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.200059175491333
Epoch: 13, Steps: 10 | Train Loss: 0.148 Vali Loss: 7.507 Vali Acc: 0.238 Test Loss: 7.507 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1806879043579102
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 7.910 Vali Acc: 0.236 Test Loss: 7.910 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1887853145599365
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 8.252 Vali Acc: 0.264 Test Loss: 8.252 Test Acc: 0.264
Validation loss decreased (-0.255230 --> -0.263447).  Saving model ...
Epoch: 16 cost time: 1.0136456489562988
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 9.256 Vali Acc: 0.247 Test Loss: 9.256 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0015811920166016
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 8.854 Vali Acc: 0.256 Test Loss: 8.854 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.147566795349121
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 8.877 Vali Acc: 0.271 Test Loss: 8.877 Test Acc: 0.271
Validation loss decreased (-0.263447 --> -0.270499).  Saving model ...
Epoch: 19 cost time: 1.0807030200958252
Epoch: 19, Steps: 10 | Train Loss: 0.080 Vali Loss: 8.775 Vali Acc: 0.287 Test Loss: 8.775 Test Acc: 0.287
Validation loss decreased (-0.270499 --> -0.286971).  Saving model ...
Epoch: 20 cost time: 1.0782585144042969
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 8.943 Vali Acc: 0.269 Test Loss: 8.943 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1377949714660645
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.934 Vali Acc: 0.276 Test Loss: 8.934 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3220059871673584
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.964 Vali Acc: 0.266 Test Loss: 8.964 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0557262897491455
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 9.190 Vali Acc: 0.265 Test Loss: 9.190 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0663337707519531
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 9.735 Vali Acc: 0.264 Test Loss: 9.735 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.115577220916748
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 9.998 Vali Acc: 0.249 Test Loss: 9.998 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1268579959869385
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 10.465 Vali Acc: 0.265 Test Loss: 10.465 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0670051574707031
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 11.046 Vali Acc: 0.253 Test Loss: 11.046 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2152929306030273
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 10.858 Vali Acc: 0.262 Test Loss: 10.858 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1512610912322998
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 11.821 Vali Acc: 0.227 Test Loss: 11.821 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 37932314
model size : 159.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3879811763763428
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.351 Vali Acc: 0.041 Test Loss: 3.351 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.6743314266204834
Epoch: 2, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.379 Vali Acc: 0.076 Test Loss: 3.379 Test Acc: 0.076
Validation loss decreased (-0.041143 --> -0.076437).  Saving model ...
Epoch: 3 cost time: 0.8401658535003662
Epoch: 3, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.265 Vali Acc: 0.098 Test Loss: 3.265 Test Acc: 0.098
Validation loss decreased (-0.076437 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 0.7168257236480713
Epoch: 4, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.292 Vali Acc: 0.106 Test Loss: 3.292 Test Acc: 0.106
Validation loss decreased (-0.097614 --> -0.105849).  Saving model ...
Epoch: 5 cost time: 0.959909200668335
Epoch: 5, Steps: 10 | Train Loss: 2.452 Vali Loss: 3.153 Vali Acc: 0.139 Test Loss: 3.153 Test Acc: 0.139
Validation loss decreased (-0.105849 --> -0.138792).  Saving model ...
Epoch: 6 cost time: 0.981558084487915
Epoch: 6, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.227 Vali Acc: 0.174 Test Loss: 3.227 Test Acc: 0.174
Validation loss decreased (-0.138792 --> -0.174085).  Saving model ...
Epoch: 7 cost time: 0.9386506080627441
Epoch: 7, Steps: 10 | Train Loss: 1.517 Vali Loss: 3.350 Vali Acc: 0.208 Test Loss: 3.350 Test Acc: 0.208
Validation loss decreased (-0.174085 --> -0.208202).  Saving model ...
Epoch: 8 cost time: 1.1576571464538574
Epoch: 8, Steps: 10 | Train Loss: 0.933 Vali Loss: 3.915 Vali Acc: 0.232 Test Loss: 3.915 Test Acc: 0.232
Validation loss decreased (-0.208202 --> -0.231726).  Saving model ...
Epoch: 9 cost time: 0.7420272827148438
Epoch: 9, Steps: 10 | Train Loss: 0.550 Vali Loss: 4.500 Vali Acc: 0.233 Test Loss: 4.500 Test Acc: 0.233
Validation loss decreased (-0.231726 --> -0.232896).  Saving model ...
Epoch: 10 cost time: 0.7845141887664795
Epoch: 10, Steps: 10 | Train Loss: 0.506 Vali Loss: 5.021 Vali Acc: 0.248 Test Loss: 5.021 Test Acc: 0.248
Validation loss decreased (-0.232896 --> -0.248185).  Saving model ...
Epoch: 11 cost time: 0.8908586502075195
Epoch: 11, Steps: 10 | Train Loss: 0.246 Vali Loss: 5.027 Vali Acc: 0.256 Test Loss: 5.027 Test Acc: 0.256
Validation loss decreased (-0.248185 --> -0.256420).  Saving model ...
Epoch: 12 cost time: 0.6888465881347656
Epoch: 12, Steps: 10 | Train Loss: 0.148 Vali Loss: 5.263 Vali Acc: 0.278 Test Loss: 5.263 Test Acc: 0.278
Validation loss decreased (-0.256420 --> -0.277594).  Saving model ...
Epoch: 13 cost time: 0.7550046443939209
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.646 Vali Acc: 0.276 Test Loss: 5.646 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8233475685119629
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.641 Vali Acc: 0.284 Test Loss: 5.641 Test Acc: 0.284
Validation loss decreased (-0.277594 --> -0.283473).  Saving model ...
Epoch: 15 cost time: 0.8130979537963867
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.166 Vali Acc: 0.284 Test Loss: 6.166 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7937819957733154
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.989 Vali Acc: 0.298 Test Loss: 5.989 Test Acc: 0.298
Validation loss decreased (-0.283473 --> -0.297587).  Saving model ...
Epoch: 17 cost time: 0.6708478927612305
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.888 Vali Acc: 0.305 Test Loss: 5.888 Test Acc: 0.305
Validation loss decreased (-0.297587 --> -0.304647).  Saving model ...
Epoch: 18 cost time: 0.892117977142334
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.421 Vali Acc: 0.265 Test Loss: 6.421 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.786851167678833
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.483 Vali Acc: 0.294 Test Loss: 6.483 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7580828666687012
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.354 Vali Acc: 0.280 Test Loss: 6.354 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9083945751190186
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.452 Vali Acc: 0.287 Test Loss: 6.452 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9824063777923584
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.600 Vali Acc: 0.294 Test Loss: 6.600 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8249669075012207
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.573 Vali Acc: 0.305 Test Loss: 6.573 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0175561904907227
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.564 Vali Acc: 0.307 Test Loss: 6.564 Test Acc: 0.307
Validation loss decreased (-0.304647 --> -0.306993).  Saving model ...
Epoch: 25 cost time: 0.839663028717041
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.524 Vali Acc: 0.304 Test Loss: 6.524 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7292523384094238
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.389 Vali Acc: 0.307 Test Loss: 6.389 Test Acc: 0.307
Validation loss decreased (-0.306993 --> -0.306995).  Saving model ...
Epoch: 27 cost time: 0.8044140338897705
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.335 Vali Acc: 0.307 Test Loss: 6.335 Test Acc: 0.307
Validation loss decreased (-0.306995 --> -0.306995).  Saving model ...
Epoch: 28 cost time: 0.8043167591094971
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.308 Vali Acc: 0.309 Test Loss: 6.308 Test Acc: 0.309
Validation loss decreased (-0.306995 --> -0.309349).  Saving model ...
Epoch: 29 cost time: 0.7996842861175537
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.316 Vali Acc: 0.312 Test Loss: 6.316 Test Acc: 0.312
Validation loss decreased (-0.309349 --> -0.311702).  Saving model ...
Epoch: 30 cost time: 0.7877366542816162
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.341 Vali Acc: 0.314 Test Loss: 6.341 Test Acc: 0.314
Validation loss decreased (-0.311702 --> -0.314054).  Saving model ...
Epoch: 31 cost time: 0.8490262031555176
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.345 Vali Acc: 0.315 Test Loss: 6.345 Test Acc: 0.315
Validation loss decreased (-0.314054 --> -0.315231).  Saving model ...
Epoch: 32 cost time: 0.8539321422576904
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.357 Vali Acc: 0.318 Test Loss: 6.357 Test Acc: 0.318
Validation loss decreased (-0.315231 --> -0.317583).  Saving model ...
Epoch: 33 cost time: 0.8705101013183594
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.357 Vali Acc: 0.319 Test Loss: 6.357 Test Acc: 0.319
Validation loss decreased (-0.317583 --> -0.318760).  Saving model ...
Epoch: 34 cost time: 0.7198135852813721
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.360 Vali Acc: 0.325 Test Loss: 6.360 Test Acc: 0.325
Validation loss decreased (-0.318760 --> -0.324642).  Saving model ...
Epoch: 35 cost time: 0.8076860904693604
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.366 Vali Acc: 0.327 Test Loss: 6.366 Test Acc: 0.327
Validation loss decreased (-0.324642 --> -0.326995).  Saving model ...
Epoch: 36 cost time: 0.6888985633850098
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.367 Vali Acc: 0.326 Test Loss: 6.367 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6443898677825928
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.385 Vali Acc: 0.322 Test Loss: 6.385 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7440371513366699
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.403 Vali Acc: 0.321 Test Loss: 6.403 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8452074527740479
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.438 Vali Acc: 0.320 Test Loss: 6.438 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9577910900115967
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.469 Vali Acc: 0.319 Test Loss: 6.469 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9093153476715088
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.471 Vali Acc: 0.319 Test Loss: 6.471 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7421121597290039
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.470 Vali Acc: 0.319 Test Loss: 6.470 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9453284740447998
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.460 Vali Acc: 0.321 Test Loss: 6.460 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9137775897979736
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.454 Vali Acc: 0.321 Test Loss: 6.454 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8156285285949707
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.435 Vali Acc: 0.320 Test Loss: 6.435 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 37158170
model size : 156.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3953208923339844
Epoch: 1, Steps: 10 | Train Loss: 3.385 Vali Loss: 3.290 Vali Acc: 0.047 Test Loss: 3.290 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.8208692073822021
Epoch: 2, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.383 Vali Acc: 0.069 Test Loss: 3.383 Test Acc: 0.069
Validation loss decreased (-0.047026 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.56557297706604
Epoch: 3, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.348 Vali Acc: 0.072 Test Loss: 3.348 Test Acc: 0.072
Validation loss decreased (-0.069378 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 1.0776822566986084
Epoch: 4, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.250 Vali Acc: 0.115 Test Loss: 3.250 Test Acc: 0.115
Validation loss decreased (-0.071731 --> -0.115262).  Saving model ...
Epoch: 5 cost time: 0.8747761249542236
Epoch: 5, Steps: 10 | Train Loss: 2.741 Vali Loss: 3.210 Vali Acc: 0.124 Test Loss: 3.210 Test Acc: 0.124
Validation loss decreased (-0.115262 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 0.9965341091156006
Epoch: 6, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.122 Vali Acc: 0.142 Test Loss: 3.122 Test Acc: 0.142
Validation loss decreased (-0.123497 --> -0.142322).  Saving model ...
Epoch: 7 cost time: 0.6339139938354492
Epoch: 7, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.151 Vali Acc: 0.171 Test Loss: 3.151 Test Acc: 0.171
Validation loss decreased (-0.142322 --> -0.170557).  Saving model ...
Epoch: 8 cost time: 0.7919058799743652
Epoch: 8, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.278 Vali Acc: 0.205 Test Loss: 3.278 Test Acc: 0.205
Validation loss decreased (-0.170557 --> -0.204673).  Saving model ...
Epoch: 9 cost time: 0.7712318897247314
Epoch: 9, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.400 Vali Acc: 0.241 Test Loss: 3.400 Test Acc: 0.241
Validation loss decreased (-0.204673 --> -0.241142).  Saving model ...
Epoch: 10 cost time: 0.7534594535827637
Epoch: 10, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.680 Vali Acc: 0.255 Test Loss: 3.680 Test Acc: 0.255
Validation loss decreased (-0.241142 --> -0.255257).  Saving model ...
Epoch: 11 cost time: 0.5526525974273682
Epoch: 11, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.815 Vali Acc: 0.274 Test Loss: 3.815 Test Acc: 0.274
Validation loss decreased (-0.255257 --> -0.274079).  Saving model ...
Epoch: 12 cost time: 0.8252832889556885
Epoch: 12, Steps: 10 | Train Loss: 0.293 Vali Loss: 4.096 Vali Acc: 0.285 Test Loss: 4.096 Test Acc: 0.285
Validation loss decreased (-0.274079 --> -0.284665).  Saving model ...
Epoch: 13 cost time: 0.9194414615631104
Epoch: 13, Steps: 10 | Train Loss: 0.221 Vali Loss: 4.327 Vali Acc: 0.258 Test Loss: 4.327 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7780883312225342
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.437 Vali Acc: 0.299 Test Loss: 4.437 Test Acc: 0.299
Validation loss decreased (-0.284665 --> -0.298779).  Saving model ...
Epoch: 15 cost time: 0.679440975189209
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.474 Vali Acc: 0.301 Test Loss: 4.474 Test Acc: 0.301
Validation loss decreased (-0.298779 --> -0.301132).  Saving model ...
Epoch: 16 cost time: 0.6405925750732422
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.585 Vali Acc: 0.311 Test Loss: 4.585 Test Acc: 0.311
Validation loss decreased (-0.301132 --> -0.310542).  Saving model ...
Epoch: 17 cost time: 0.9864449501037598
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.850 Vali Acc: 0.306 Test Loss: 4.850 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8355448246002197
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.881 Vali Acc: 0.307 Test Loss: 4.881 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9257662296295166
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.111 Vali Acc: 0.287 Test Loss: 5.111 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7972609996795654
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.943 Vali Acc: 0.315 Test Loss: 4.943 Test Acc: 0.315
Validation loss decreased (-0.310542 --> -0.315245).  Saving model ...
Epoch: 21 cost time: 0.8370623588562012
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.023 Vali Acc: 0.322 Test Loss: 5.023 Test Acc: 0.322
Validation loss decreased (-0.315245 --> -0.322303).  Saving model ...
Epoch: 22 cost time: 0.8484663963317871
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.079 Vali Acc: 0.329 Test Loss: 5.079 Test Acc: 0.329
Validation loss decreased (-0.322303 --> -0.329361).  Saving model ...
Epoch: 23 cost time: 0.9745352268218994
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.051 Vali Acc: 0.334 Test Loss: 5.051 Test Acc: 0.334
Validation loss decreased (-0.329361 --> -0.334067).  Saving model ...
Epoch: 24 cost time: 0.8510360717773438
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.038 Vali Acc: 0.334 Test Loss: 5.038 Test Acc: 0.334
Validation loss decreased (-0.334067 --> -0.334067).  Saving model ...
Epoch: 25 cost time: 0.74411940574646
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.028 Vali Acc: 0.332 Test Loss: 5.028 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6204335689544678
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.113 Vali Acc: 0.328 Test Loss: 5.113 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8285923004150391
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.140 Vali Acc: 0.335 Test Loss: 5.140 Test Acc: 0.335
Validation loss decreased (-0.334067 --> -0.335243).  Saving model ...
Epoch: 28 cost time: 0.9530484676361084
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.160 Vali Acc: 0.336 Test Loss: 5.160 Test Acc: 0.336
Validation loss decreased (-0.335243 --> -0.336419).  Saving model ...
Epoch: 29 cost time: 0.9852430820465088
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.170 Vali Acc: 0.333 Test Loss: 5.170 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0745835304260254
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.196 Vali Acc: 0.338 Test Loss: 5.196 Test Acc: 0.338
Validation loss decreased (-0.336419 --> -0.337595).  Saving model ...
Epoch: 31 cost time: 0.8101587295532227
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.204 Vali Acc: 0.333 Test Loss: 5.204 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5480310916900635
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.186 Vali Acc: 0.331 Test Loss: 5.186 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5354273319244385
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.179 Vali Acc: 0.327 Test Loss: 5.179 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7983360290527344
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.195 Vali Acc: 0.329 Test Loss: 5.195 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7738478183746338
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.199 Vali Acc: 0.329 Test Loss: 5.199 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8087971210479736
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.200 Vali Acc: 0.329 Test Loss: 5.200 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6527159214019775
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.204 Vali Acc: 0.334 Test Loss: 5.204 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7884113788604736
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.223 Vali Acc: 0.328 Test Loss: 5.223 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7767410278320312
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.231 Vali Acc: 0.334 Test Loss: 5.231 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.754366397857666
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.268 Vali Acc: 0.334 Test Loss: 5.268 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 36771098
model size : 154.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.413015604019165
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.359 Vali Acc: 0.051 Test Loss: 3.359 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.0773465633392334
Epoch: 2, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.389 Vali Acc: 0.088 Test Loss: 3.389 Test Acc: 0.088
Validation loss decreased (-0.050555 --> -0.088201).  Saving model ...
Epoch: 3 cost time: 0.975743293762207
Epoch: 3, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.291 Vali Acc: 0.098 Test Loss: 3.291 Test Acc: 0.098
Validation loss decreased (-0.088201 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 1.2416582107543945
Epoch: 4, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.212 Vali Acc: 0.138 Test Loss: 3.212 Test Acc: 0.138
Validation loss decreased (-0.097614 --> -0.137615).  Saving model ...
Epoch: 5 cost time: 0.9759800434112549
Epoch: 5, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.171 Vali Acc: 0.158 Test Loss: 3.171 Test Acc: 0.158
Validation loss decreased (-0.137615 --> -0.157615).  Saving model ...
Epoch: 6 cost time: 1.2084507942199707
Epoch: 6, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.371 Vali Acc: 0.206 Test Loss: 3.371 Test Acc: 0.206
Validation loss decreased (-0.157615 --> -0.205849).  Saving model ...
Epoch: 7 cost time: 1.1463170051574707
Epoch: 7, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.822 Vali Acc: 0.202 Test Loss: 3.822 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0301036834716797
Epoch: 8, Steps: 10 | Train Loss: 0.638 Vali Loss: 4.453 Vali Acc: 0.232 Test Loss: 4.453 Test Acc: 0.232
Validation loss decreased (-0.205849 --> -0.231720).  Saving model ...
Epoch: 9 cost time: 0.996030330657959
Epoch: 9, Steps: 10 | Train Loss: 0.415 Vali Loss: 4.924 Vali Acc: 0.239 Test Loss: 4.924 Test Acc: 0.239
Validation loss decreased (-0.231720 --> -0.238774).  Saving model ...
Epoch: 10 cost time: 0.9164133071899414
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 5.694 Vali Acc: 0.248 Test Loss: 5.694 Test Acc: 0.248
Validation loss decreased (-0.238774 --> -0.248178).  Saving model ...
Epoch: 11 cost time: 1.1963376998901367
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 5.658 Vali Acc: 0.259 Test Loss: 5.658 Test Acc: 0.259
Validation loss decreased (-0.248178 --> -0.258767).  Saving model ...
Epoch: 12 cost time: 1.0015594959259033
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 6.331 Vali Acc: 0.242 Test Loss: 6.331 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9314424991607666
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 6.527 Vali Acc: 0.248 Test Loss: 6.527 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0615079402923584
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 6.890 Vali Acc: 0.260 Test Loss: 6.890 Test Acc: 0.260
Validation loss decreased (-0.258767 --> -0.259931).  Saving model ...
Epoch: 15 cost time: 1.0546917915344238
Epoch: 15, Steps: 10 | Train Loss: 0.096 Vali Loss: 7.290 Vali Acc: 0.269 Test Loss: 7.290 Test Acc: 0.269
Validation loss decreased (-0.259931 --> -0.269339).  Saving model ...
Epoch: 16 cost time: 1.1329851150512695
Epoch: 16, Steps: 10 | Train Loss: 0.137 Vali Loss: 7.170 Vali Acc: 0.260 Test Loss: 7.170 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0098381042480469
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 8.024 Vali Acc: 0.267 Test Loss: 8.024 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9152638912200928
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 7.494 Vali Acc: 0.280 Test Loss: 7.494 Test Acc: 0.280
Validation loss decreased (-0.269339 --> -0.279925).  Saving model ...
Epoch: 19 cost time: 0.9652109146118164
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 7.460 Vali Acc: 0.265 Test Loss: 7.460 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1932835578918457
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.598 Vali Acc: 0.282 Test Loss: 7.598 Test Acc: 0.282
Validation loss decreased (-0.279925 --> -0.282277).  Saving model ...
Epoch: 21 cost time: 1.1647326946258545
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.504 Vali Acc: 0.295 Test Loss: 7.504 Test Acc: 0.295
Validation loss decreased (-0.282277 --> -0.295219).  Saving model ...
Epoch: 22 cost time: 1.0380804538726807
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.459 Vali Acc: 0.302 Test Loss: 7.459 Test Acc: 0.302
Validation loss decreased (-0.295219 --> -0.302278).  Saving model ...
Epoch: 23 cost time: 1.0322442054748535
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.136 Vali Acc: 0.272 Test Loss: 8.136 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.071359634399414
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.071 Vali Acc: 0.288 Test Loss: 8.071 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9511072635650635
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 8.004 Vali Acc: 0.280 Test Loss: 8.004 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9601931571960449
Epoch: 26, Steps: 10 | Train Loss: 0.052 Vali Loss: 8.305 Vali Acc: 0.296 Test Loss: 8.305 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9399287700653076
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 8.956 Vali Acc: 0.261 Test Loss: 8.956 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9271109104156494
Epoch: 28, Steps: 10 | Train Loss: 0.103 Vali Loss: 8.323 Vali Acc: 0.284 Test Loss: 8.323 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9697377681732178
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.410 Vali Acc: 0.269 Test Loss: 8.410 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9960412979125977
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 8.461 Vali Acc: 0.262 Test Loss: 8.461 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.033973217010498
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 8.516 Vali Acc: 0.274 Test Loss: 8.516 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0818760395050049
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.706 Vali Acc: 0.275 Test Loss: 8.706 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 37401626
model size : 157.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2848987579345703
Epoch: 1, Steps: 10 | Train Loss: 3.462 Vali Loss: 3.322 Vali Acc: 0.048 Test Loss: 3.322 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.5873603820800781
Epoch: 2, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.394 Vali Acc: 0.079 Test Loss: 3.394 Test Acc: 0.079
Validation loss decreased (-0.048202 --> -0.078790).  Saving model ...
Epoch: 3 cost time: 0.5649359226226807
Epoch: 3, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.306 Vali Acc: 0.081 Test Loss: 3.306 Test Acc: 0.081
Validation loss decreased (-0.078790 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 0.5904109477996826
Epoch: 4, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.256 Vali Acc: 0.118 Test Loss: 3.256 Test Acc: 0.118
Validation loss decreased (-0.081143 --> -0.117614).  Saving model ...
Epoch: 5 cost time: 0.7559874057769775
Epoch: 5, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.212 Vali Acc: 0.132 Test Loss: 3.212 Test Acc: 0.132
Validation loss decreased (-0.117614 --> -0.131733).  Saving model ...
Epoch: 6 cost time: 0.5623595714569092
Epoch: 6, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.226 Vali Acc: 0.165 Test Loss: 3.226 Test Acc: 0.165
Validation loss decreased (-0.131733 --> -0.164674).  Saving model ...
Epoch: 7 cost time: 0.8795557022094727
Epoch: 7, Steps: 10 | Train Loss: 1.589 Vali Loss: 3.301 Vali Acc: 0.202 Test Loss: 3.301 Test Acc: 0.202
Validation loss decreased (-0.164674 --> -0.202320).  Saving model ...
Epoch: 8 cost time: 0.6261162757873535
Epoch: 8, Steps: 10 | Train Loss: 1.094 Vali Loss: 3.646 Vali Acc: 0.231 Test Loss: 3.646 Test Acc: 0.231
Validation loss decreased (-0.202320 --> -0.230552).  Saving model ...
Epoch: 9 cost time: 0.9466283321380615
Epoch: 9, Steps: 10 | Train Loss: 0.598 Vali Loss: 4.057 Vali Acc: 0.229 Test Loss: 4.057 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8629145622253418
Epoch: 10, Steps: 10 | Train Loss: 0.397 Vali Loss: 4.273 Vali Acc: 0.267 Test Loss: 4.273 Test Acc: 0.267
Validation loss decreased (-0.230552 --> -0.267016).  Saving model ...
Epoch: 11 cost time: 0.768911600112915
Epoch: 11, Steps: 10 | Train Loss: 0.262 Vali Loss: 4.721 Vali Acc: 0.272 Test Loss: 4.721 Test Acc: 0.272
Validation loss decreased (-0.267016 --> -0.271717).  Saving model ...
Epoch: 12 cost time: 0.5989823341369629
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.834 Vali Acc: 0.274 Test Loss: 4.834 Test Acc: 0.274
Validation loss decreased (-0.271717 --> -0.274069).  Saving model ...
Epoch: 13 cost time: 0.8024337291717529
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 5.065 Vali Acc: 0.286 Test Loss: 5.065 Test Acc: 0.286
Validation loss decreased (-0.274069 --> -0.285832).  Saving model ...
Epoch: 14 cost time: 0.6753849983215332
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.374 Vali Acc: 0.281 Test Loss: 5.374 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8009264469146729
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 5.326 Vali Acc: 0.292 Test Loss: 5.326 Test Acc: 0.292
Validation loss decreased (-0.285832 --> -0.291711).  Saving model ...
Epoch: 16 cost time: 0.5839042663574219
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.834 Vali Acc: 0.274 Test Loss: 5.834 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8120098114013672
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.491 Vali Acc: 0.309 Test Loss: 5.491 Test Acc: 0.309
Validation loss decreased (-0.291711 --> -0.309357).  Saving model ...
Epoch: 18 cost time: 0.7796440124511719
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.396 Vali Acc: 0.308 Test Loss: 5.396 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7851715087890625
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.474 Vali Acc: 0.308 Test Loss: 5.474 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8572721481323242
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.656 Vali Acc: 0.300 Test Loss: 5.656 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5501728057861328
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.795 Vali Acc: 0.300 Test Loss: 5.795 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8159093856811523
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.695 Vali Acc: 0.304 Test Loss: 5.695 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7900240421295166
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.690 Vali Acc: 0.304 Test Loss: 5.690 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7798421382904053
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.668 Vali Acc: 0.306 Test Loss: 5.668 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0766963958740234
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.627 Vali Acc: 0.311 Test Loss: 5.627 Test Acc: 0.311
Validation loss decreased (-0.309357 --> -0.310532).  Saving model ...
Epoch: 26 cost time: 0.9050476551055908
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.624 Vali Acc: 0.314 Test Loss: 5.624 Test Acc: 0.314
Validation loss decreased (-0.310532 --> -0.314061).  Saving model ...
Epoch: 27 cost time: 0.8406307697296143
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.666 Vali Acc: 0.312 Test Loss: 5.666 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9183521270751953
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.686 Vali Acc: 0.311 Test Loss: 5.686 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9261913299560547
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.698 Vali Acc: 0.305 Test Loss: 5.698 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9445152282714844
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.935 Vali Acc: 0.293 Test Loss: 5.935 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.020874261856079
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.866 Vali Acc: 0.301 Test Loss: 5.866 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8531455993652344
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.809 Vali Acc: 0.311 Test Loss: 5.809 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6724555492401123
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.794 Vali Acc: 0.314 Test Loss: 5.794 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8742263317108154
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.775 Vali Acc: 0.315 Test Loss: 5.775 Test Acc: 0.315
Validation loss decreased (-0.314061 --> -0.315236).  Saving model ...
Epoch: 35 cost time: 0.6426537036895752
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.752 Vali Acc: 0.311 Test Loss: 5.752 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9466943740844727
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.744 Vali Acc: 0.309 Test Loss: 5.744 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7724742889404297
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.736 Vali Acc: 0.313 Test Loss: 5.736 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7821588516235352
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.740 Vali Acc: 0.314 Test Loss: 5.740 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8400735855102539
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.761 Vali Acc: 0.314 Test Loss: 5.761 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8071560859680176
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.761 Vali Acc: 0.315 Test Loss: 5.761 Test Acc: 0.315
Validation loss decreased (-0.315236 --> -0.315237).  Saving model ...
Epoch: 41 cost time: 0.6290500164031982
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.766 Vali Acc: 0.316 Test Loss: 5.766 Test Acc: 0.316
Validation loss decreased (-0.315237 --> -0.316413).  Saving model ...
Epoch: 42 cost time: 0.8420474529266357
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.772 Vali Acc: 0.318 Test Loss: 5.772 Test Acc: 0.318
Validation loss decreased (-0.316413 --> -0.317589).  Saving model ...
Epoch: 43 cost time: 0.7890660762786865
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.797 Vali Acc: 0.315 Test Loss: 5.797 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8689167499542236
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.811 Vali Acc: 0.314 Test Loss: 5.811 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7848210334777832
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.809 Vali Acc: 0.314 Test Loss: 5.809 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7885944843292236
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.803 Vali Acc: 0.316 Test Loss: 5.803 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7536642551422119
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.793 Vali Acc: 0.321 Test Loss: 5.793 Test Acc: 0.321
Validation loss decreased (-0.317589 --> -0.321119).  Saving model ...
Epoch: 48 cost time: 0.803602933883667
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.822 Vali Acc: 0.319 Test Loss: 5.822 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8184607028961182
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.837 Vali Acc: 0.316 Test Loss: 5.837 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.817793607711792
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.812 Vali Acc: 0.320 Test Loss: 5.812 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 36993050
model size : 155.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1294779777526855
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.327 Vali Acc: 0.056 Test Loss: 3.327 Test Acc: 0.056
Validation loss decreased (inf --> -0.056437).  Saving model ...
Epoch: 2 cost time: 0.6476736068725586
Epoch: 2, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.329 Vali Acc: 0.055 Test Loss: 3.329 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6959006786346436
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.337 Vali Acc: 0.073 Test Loss: 3.337 Test Acc: 0.073
Validation loss decreased (-0.056437 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.6806306838989258
Epoch: 4, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.284 Vali Acc: 0.092 Test Loss: 3.284 Test Acc: 0.092
Validation loss decreased (-0.072908 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 0.7384932041168213
Epoch: 5, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.234 Vali Acc: 0.098 Test Loss: 3.234 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097615).  Saving model ...
Epoch: 6 cost time: 0.7189867496490479
Epoch: 6, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.193 Vali Acc: 0.125 Test Loss: 3.193 Test Acc: 0.125
Validation loss decreased (-0.097615 --> -0.124674).  Saving model ...
Epoch: 7 cost time: 0.7240340709686279
Epoch: 7, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.174 Vali Acc: 0.159 Test Loss: 3.174 Test Acc: 0.159
Validation loss decreased (-0.124674 --> -0.158792).  Saving model ...
Epoch: 8 cost time: 0.5561008453369141
Epoch: 8, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.344 Vali Acc: 0.174 Test Loss: 3.344 Test Acc: 0.174
Validation loss decreased (-0.158792 --> -0.174084).  Saving model ...
Epoch: 9 cost time: 0.7699224948883057
Epoch: 9, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.402 Vali Acc: 0.229 Test Loss: 3.402 Test Acc: 0.229
Validation loss decreased (-0.174084 --> -0.229378).  Saving model ...
Epoch: 10 cost time: 0.7166774272918701
Epoch: 10, Steps: 10 | Train Loss: 0.970 Vali Loss: 3.690 Vali Acc: 0.226 Test Loss: 3.690 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7573583126068115
Epoch: 11, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.809 Vali Acc: 0.256 Test Loss: 3.809 Test Acc: 0.256
Validation loss decreased (-0.229378 --> -0.256432).  Saving model ...
Epoch: 12 cost time: 0.6015787124633789
Epoch: 12, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.961 Vali Acc: 0.260 Test Loss: 3.961 Test Acc: 0.260
Validation loss decreased (-0.256432 --> -0.259960).  Saving model ...
Epoch: 13 cost time: 0.8158743381500244
Epoch: 13, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.110 Vali Acc: 0.271 Test Loss: 4.110 Test Acc: 0.271
Validation loss decreased (-0.259960 --> -0.270547).  Saving model ...
Epoch: 14 cost time: 0.6978123188018799
Epoch: 14, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.503 Vali Acc: 0.260 Test Loss: 4.503 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.741767406463623
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.702 Vali Acc: 0.273 Test Loss: 4.702 Test Acc: 0.273
Validation loss decreased (-0.270547 --> -0.272894).  Saving model ...
Epoch: 16 cost time: 0.7790727615356445
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.654 Vali Acc: 0.264 Test Loss: 4.654 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7884912490844727
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.575 Vali Acc: 0.293 Test Loss: 4.575 Test Acc: 0.293
Validation loss decreased (-0.272894 --> -0.292895).  Saving model ...
Epoch: 18 cost time: 0.6434435844421387
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.939 Vali Acc: 0.274 Test Loss: 4.939 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7167234420776367
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.952 Vali Acc: 0.275 Test Loss: 4.952 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9828712940216064
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.937 Vali Acc: 0.295 Test Loss: 4.937 Test Acc: 0.295
Validation loss decreased (-0.292895 --> -0.295245).  Saving model ...
Epoch: 21 cost time: 0.5381841659545898
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.984 Vali Acc: 0.295 Test Loss: 4.984 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0300166606903076
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.919 Vali Acc: 0.289 Test Loss: 4.919 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7442073822021484
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.896 Vali Acc: 0.293 Test Loss: 4.896 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7730014324188232
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.944 Vali Acc: 0.298 Test Loss: 4.944 Test Acc: 0.298
Validation loss decreased (-0.295245 --> -0.297598).  Saving model ...
Epoch: 25 cost time: 0.8152360916137695
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.977 Vali Acc: 0.293 Test Loss: 4.977 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0331048965454102
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.012 Vali Acc: 0.294 Test Loss: 5.012 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7307991981506348
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.033 Vali Acc: 0.291 Test Loss: 5.033 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8666276931762695
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.057 Vali Acc: 0.294 Test Loss: 5.057 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8735706806182861
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.068 Vali Acc: 0.296 Test Loss: 5.068 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7081623077392578
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.061 Vali Acc: 0.308 Test Loss: 5.061 Test Acc: 0.308
Validation loss decreased (-0.297598 --> -0.308185).  Saving model ...
Epoch: 31 cost time: 0.7682197093963623
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.081 Vali Acc: 0.301 Test Loss: 5.081 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.72402024269104
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.108 Vali Acc: 0.295 Test Loss: 5.108 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7781736850738525
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.156 Vali Acc: 0.292 Test Loss: 5.156 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6667132377624512
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.210 Vali Acc: 0.295 Test Loss: 5.210 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0868418216705322
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.172 Vali Acc: 0.296 Test Loss: 5.172 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7486617565155029
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.176 Vali Acc: 0.300 Test Loss: 5.176 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9751172065734863
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.197 Vali Acc: 0.298 Test Loss: 5.197 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6394391059875488
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.192 Vali Acc: 0.307 Test Loss: 5.192 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7417340278625488
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.196 Vali Acc: 0.309 Test Loss: 5.196 Test Acc: 0.309
Validation loss decreased (-0.308185 --> -0.309360).  Saving model ...
Epoch: 40 cost time: 0.7238318920135498
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.192 Vali Acc: 0.306 Test Loss: 5.192 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8042161464691162
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.203 Vali Acc: 0.302 Test Loss: 5.203 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7496938705444336
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.216 Vali Acc: 0.302 Test Loss: 5.216 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.696387529373169
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.242 Vali Acc: 0.304 Test Loss: 5.242 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7641303539276123
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.256 Vali Acc: 0.299 Test Loss: 5.256 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5026960372924805
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.255 Vali Acc: 0.298 Test Loss: 5.255 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7386388778686523
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.247 Vali Acc: 0.299 Test Loss: 5.247 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7382590770721436
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.256 Vali Acc: 0.302 Test Loss: 5.256 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7235054969787598
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.288 Vali Acc: 0.305 Test Loss: 5.288 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7404289245605469
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.310 Vali Acc: 0.301 Test Loss: 5.310 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 36713498
model size : 154.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4860172271728516
Epoch: 1, Steps: 10 | Train Loss: 3.433 Vali Loss: 3.361 Vali Acc: 0.055 Test Loss: 3.361 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 1.2382850646972656
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.377 Vali Acc: 0.069 Test Loss: 3.377 Test Acc: 0.069
Validation loss decreased (-0.055261 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.9521207809448242
Epoch: 3, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.276 Vali Acc: 0.080 Test Loss: 3.276 Test Acc: 0.080
Validation loss decreased (-0.069378 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 0.7131609916687012
Epoch: 4, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.186 Vali Acc: 0.141 Test Loss: 3.186 Test Acc: 0.141
Validation loss decreased (-0.079967 --> -0.141145).  Saving model ...
Epoch: 5 cost time: 0.6786143779754639
Epoch: 5, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.142 Vali Acc: 0.165 Test Loss: 3.142 Test Acc: 0.165
Validation loss decreased (-0.141145 --> -0.164674).  Saving model ...
Epoch: 6 cost time: 0.8002731800079346
Epoch: 6, Steps: 10 | Train Loss: 1.724 Vali Loss: 3.231 Vali Acc: 0.202 Test Loss: 3.231 Test Acc: 0.202
Validation loss decreased (-0.164674 --> -0.202321).  Saving model ...
Epoch: 7 cost time: 0.8065333366394043
Epoch: 7, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.608 Vali Acc: 0.225 Test Loss: 3.608 Test Acc: 0.225
Validation loss decreased (-0.202321 --> -0.224670).  Saving model ...
Epoch: 8 cost time: 0.6056158542633057
Epoch: 8, Steps: 10 | Train Loss: 0.648 Vali Loss: 4.494 Vali Acc: 0.219 Test Loss: 4.494 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1458370685577393
Epoch: 9, Steps: 10 | Train Loss: 0.410 Vali Loss: 4.718 Vali Acc: 0.236 Test Loss: 4.718 Test Acc: 0.236
Validation loss decreased (-0.224670 --> -0.236423).  Saving model ...
Epoch: 10 cost time: 0.9807024002075195
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 5.367 Vali Acc: 0.262 Test Loss: 5.367 Test Acc: 0.262
Validation loss decreased (-0.236423 --> -0.262299).  Saving model ...
Epoch: 11 cost time: 0.8709843158721924
Epoch: 11, Steps: 10 | Train Loss: 0.129 Vali Loss: 5.779 Vali Acc: 0.267 Test Loss: 5.779 Test Acc: 0.267
Validation loss decreased (-0.262299 --> -0.267001).  Saving model ...
Epoch: 12 cost time: 1.098705530166626
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 6.069 Vali Acc: 0.294 Test Loss: 6.069 Test Acc: 0.294
Validation loss decreased (-0.267001 --> -0.294057).  Saving model ...
Epoch: 13 cost time: 0.7212715148925781
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 6.508 Vali Acc: 0.265 Test Loss: 6.508 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6973071098327637
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 6.909 Vali Acc: 0.288 Test Loss: 6.909 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8462862968444824
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 7.050 Vali Acc: 0.279 Test Loss: 7.050 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9767673015594482
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 8.019 Vali Acc: 0.238 Test Loss: 8.019 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8738956451416016
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 7.363 Vali Acc: 0.278 Test Loss: 7.363 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.832871675491333
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 7.478 Vali Acc: 0.276 Test Loss: 7.478 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7337875366210938
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 7.829 Vali Acc: 0.273 Test Loss: 7.829 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.163478136062622
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 8.146 Vali Acc: 0.281 Test Loss: 8.146 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1027247905731201
Epoch: 21, Steps: 10 | Train Loss: 0.166 Vali Loss: 8.145 Vali Acc: 0.271 Test Loss: 8.145 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9774601459503174
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 8.785 Vali Acc: 0.266 Test Loss: 8.785 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29411764705882354
model parameter : 37408538
model size : 157.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8669886589050293
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.313 Vali Acc: 0.038 Test Loss: 3.313 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.76371169090271
Epoch: 2, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.392 Vali Acc: 0.062 Test Loss: 3.392 Test Acc: 0.062
Validation loss decreased (-0.037614 --> -0.062319).  Saving model ...
Epoch: 3 cost time: 0.7060098648071289
Epoch: 3, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.346 Vali Acc: 0.079 Test Loss: 3.346 Test Acc: 0.079
Validation loss decreased (-0.062319 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 0.8014490604400635
Epoch: 4, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.240 Vali Acc: 0.127 Test Loss: 3.240 Test Acc: 0.127
Validation loss decreased (-0.078790 --> -0.127026).  Saving model ...
Epoch: 5 cost time: 0.7242660522460938
Epoch: 5, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.210 Vali Acc: 0.128 Test Loss: 3.210 Test Acc: 0.128
Validation loss decreased (-0.127026 --> -0.128203).  Saving model ...
Epoch: 6 cost time: 0.7770931720733643
Epoch: 6, Steps: 10 | Train Loss: 2.075 Vali Loss: 3.157 Vali Acc: 0.168 Test Loss: 3.157 Test Acc: 0.168
Validation loss decreased (-0.128203 --> -0.168204).  Saving model ...
Epoch: 7 cost time: 0.760951042175293
Epoch: 7, Steps: 10 | Train Loss: 1.551 Vali Loss: 3.409 Vali Acc: 0.182 Test Loss: 3.409 Test Acc: 0.182
Validation loss decreased (-0.168204 --> -0.182319).  Saving model ...
Epoch: 8 cost time: 0.7515261173248291
Epoch: 8, Steps: 10 | Train Loss: 1.060 Vali Loss: 3.762 Vali Acc: 0.224 Test Loss: 3.762 Test Acc: 0.224
Validation loss decreased (-0.182319 --> -0.223492).  Saving model ...
Epoch: 9 cost time: 0.7964849472045898
Epoch: 9, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.932 Vali Acc: 0.247 Test Loss: 3.932 Test Acc: 0.247
Validation loss decreased (-0.223492 --> -0.247020).  Saving model ...
Epoch: 10 cost time: 0.577357292175293
Epoch: 10, Steps: 10 | Train Loss: 0.440 Vali Loss: 4.282 Vali Acc: 0.266 Test Loss: 4.282 Test Acc: 0.266
Validation loss decreased (-0.247020 --> -0.265840).  Saving model ...
Epoch: 11 cost time: 0.5665755271911621
Epoch: 11, Steps: 10 | Train Loss: 0.269 Vali Loss: 4.543 Vali Acc: 0.273 Test Loss: 4.543 Test Acc: 0.273
Validation loss decreased (-0.265840 --> -0.272896).  Saving model ...
Epoch: 12 cost time: 0.9401564598083496
Epoch: 12, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.921 Vali Acc: 0.262 Test Loss: 4.921 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7105956077575684
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 5.301 Vali Acc: 0.268 Test Loss: 5.301 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6985228061676025
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 5.402 Vali Acc: 0.296 Test Loss: 5.402 Test Acc: 0.296
Validation loss decreased (-0.272896 --> -0.296417).  Saving model ...
Epoch: 15 cost time: 0.8253791332244873
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.374 Vali Acc: 0.296 Test Loss: 5.374 Test Acc: 0.296
Validation loss decreased (-0.296417 --> -0.296417).  Saving model ...
Epoch: 16 cost time: 0.8096327781677246
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.444 Vali Acc: 0.294 Test Loss: 5.444 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7943115234375
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.522 Vali Acc: 0.299 Test Loss: 5.522 Test Acc: 0.299
Validation loss decreased (-0.296417 --> -0.298768).  Saving model ...
Epoch: 18 cost time: 0.9008486270904541
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.803 Vali Acc: 0.293 Test Loss: 5.803 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.826695442199707
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.599 Vali Acc: 0.304 Test Loss: 5.599 Test Acc: 0.304
Validation loss decreased (-0.298768 --> -0.303473).  Saving model ...
Epoch: 20 cost time: 0.8633837699890137
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.556 Vali Acc: 0.305 Test Loss: 5.556 Test Acc: 0.305
Validation loss decreased (-0.303473 --> -0.304650).  Saving model ...
Epoch: 21 cost time: 0.7874565124511719
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.641 Vali Acc: 0.307 Test Loss: 5.641 Test Acc: 0.307
Validation loss decreased (-0.304650 --> -0.307002).  Saving model ...
Epoch: 22 cost time: 0.6263606548309326
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.564 Vali Acc: 0.316 Test Loss: 5.564 Test Acc: 0.316
Validation loss decreased (-0.307002 --> -0.316415).  Saving model ...
Epoch: 23 cost time: 0.8544795513153076
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.670 Vali Acc: 0.321 Test Loss: 5.670 Test Acc: 0.321
Validation loss decreased (-0.316415 --> -0.321120).  Saving model ...
Epoch: 24 cost time: 0.9387404918670654
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.681 Vali Acc: 0.315 Test Loss: 5.681 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9392435550689697
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.644 Vali Acc: 0.313 Test Loss: 5.644 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.579810619354248
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.686 Vali Acc: 0.309 Test Loss: 5.686 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6725413799285889
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.709 Vali Acc: 0.309 Test Loss: 5.709 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8224673271179199
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.696 Vali Acc: 0.314 Test Loss: 5.696 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8404891490936279
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.694 Vali Acc: 0.319 Test Loss: 5.694 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.804816722869873
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.695 Vali Acc: 0.316 Test Loss: 5.695 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7716259956359863
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.712 Vali Acc: 0.316 Test Loss: 5.712 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8523471355438232
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.741 Vali Acc: 0.320 Test Loss: 5.741 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9932851791381836
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.767 Vali Acc: 0.324 Test Loss: 5.767 Test Acc: 0.324
Validation loss decreased (-0.321120 --> -0.323472).  Saving model ...
Epoch: 34 cost time: 0.7291378974914551
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.788 Vali Acc: 0.325 Test Loss: 5.788 Test Acc: 0.325
Validation loss decreased (-0.323472 --> -0.324648).  Saving model ...
Epoch: 35 cost time: 0.7416892051696777
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.826 Vali Acc: 0.325 Test Loss: 5.826 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6623151302337646
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.831 Vali Acc: 0.325 Test Loss: 5.831 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6819350719451904
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.825 Vali Acc: 0.322 Test Loss: 5.825 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7046289443969727
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.864 Vali Acc: 0.321 Test Loss: 5.864 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5513203144073486
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.871 Vali Acc: 0.322 Test Loss: 5.871 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7789885997772217
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.863 Vali Acc: 0.321 Test Loss: 5.863 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7648463249206543
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.855 Vali Acc: 0.321 Test Loss: 5.855 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7723703384399414
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.857 Vali Acc: 0.321 Test Loss: 5.857 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7432608604431152
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.862 Vali Acc: 0.319 Test Loss: 5.862 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8421578407287598
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.868 Vali Acc: 0.319 Test Loss: 5.868 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 36999962
model size : 155.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0981178283691406
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.311 Vali Acc: 0.047 Test Loss: 3.311 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.6063001155853271
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.351 Vali Acc: 0.056 Test Loss: 3.351 Test Acc: 0.056
Validation loss decreased (-0.047026 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.6313221454620361
Epoch: 3, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.331 Vali Acc: 0.071 Test Loss: 3.331 Test Acc: 0.071
Validation loss decreased (-0.056437 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.6103901863098145
Epoch: 4, Steps: 10 | Train Loss: 2.968 Vali Loss: 3.286 Vali Acc: 0.075 Test Loss: 3.286 Test Acc: 0.075
Validation loss decreased (-0.070555 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.6174101829528809
Epoch: 5, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.236 Vali Acc: 0.106 Test Loss: 3.236 Test Acc: 0.106
Validation loss decreased (-0.075261 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 0.5772418975830078
Epoch: 6, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.187 Vali Acc: 0.114 Test Loss: 3.187 Test Acc: 0.114
Validation loss decreased (-0.105850 --> -0.114086).  Saving model ...
Epoch: 7 cost time: 0.5740447044372559
Epoch: 7, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.190 Vali Acc: 0.140 Test Loss: 3.190 Test Acc: 0.140
Validation loss decreased (-0.114086 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 0.6959018707275391
Epoch: 8, Steps: 10 | Train Loss: 1.972 Vali Loss: 3.186 Vali Acc: 0.175 Test Loss: 3.186 Test Acc: 0.175
Validation loss decreased (-0.139968 --> -0.175262).  Saving model ...
Epoch: 9 cost time: 0.624692440032959
Epoch: 9, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.423 Vali Acc: 0.201 Test Loss: 3.423 Test Acc: 0.201
Validation loss decreased (-0.175262 --> -0.201142).  Saving model ...
Epoch: 10 cost time: 0.5809471607208252
Epoch: 10, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.613 Vali Acc: 0.216 Test Loss: 3.613 Test Acc: 0.216
Validation loss decreased (-0.201142 --> -0.216434).  Saving model ...
Epoch: 11 cost time: 0.5891969203948975
Epoch: 11, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.793 Vali Acc: 0.249 Test Loss: 3.793 Test Acc: 0.249
Validation loss decreased (-0.216434 --> -0.249374).  Saving model ...
Epoch: 12 cost time: 0.6134450435638428
Epoch: 12, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.941 Vali Acc: 0.252 Test Loss: 3.941 Test Acc: 0.252
Validation loss decreased (-0.249374 --> -0.251725).  Saving model ...
Epoch: 13 cost time: 0.6056818962097168
Epoch: 13, Steps: 10 | Train Loss: 0.333 Vali Loss: 4.136 Vali Acc: 0.279 Test Loss: 4.136 Test Acc: 0.279
Validation loss decreased (-0.251725 --> -0.278782).  Saving model ...
Epoch: 14 cost time: 0.5961954593658447
Epoch: 14, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.388 Vali Acc: 0.267 Test Loss: 4.388 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6939306259155273
Epoch: 15, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.454 Vali Acc: 0.264 Test Loss: 4.454 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6397595405578613
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.551 Vali Acc: 0.281 Test Loss: 4.551 Test Acc: 0.281
Validation loss decreased (-0.278782 --> -0.281131).  Saving model ...
Epoch: 17 cost time: 0.6681535243988037
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.677 Vali Acc: 0.279 Test Loss: 4.677 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5555105209350586
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.035 Vali Acc: 0.271 Test Loss: 5.035 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.65096116065979
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 5.082 Vali Acc: 0.275 Test Loss: 5.082 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6422300338745117
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.988 Vali Acc: 0.286 Test Loss: 4.988 Test Acc: 0.286
Validation loss decreased (-0.281131 --> -0.285832).  Saving model ...
Epoch: 21 cost time: 0.6964943408966064
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.161 Vali Acc: 0.264 Test Loss: 5.161 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6134095191955566
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.033 Vali Acc: 0.286 Test Loss: 5.033 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5508801937103271
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.183 Vali Acc: 0.282 Test Loss: 5.183 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5951285362243652
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.161 Vali Acc: 0.294 Test Loss: 5.161 Test Acc: 0.294
Validation loss decreased (-0.285832 --> -0.294066).  Saving model ...
Epoch: 25 cost time: 0.6353235244750977
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.196 Vali Acc: 0.292 Test Loss: 5.196 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.632453441619873
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.199 Vali Acc: 0.294 Test Loss: 5.199 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6303343772888184
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.178 Vali Acc: 0.298 Test Loss: 5.178 Test Acc: 0.298
Validation loss decreased (-0.294066 --> -0.297595).  Saving model ...
Epoch: 28 cost time: 0.6816327571868896
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.207 Vali Acc: 0.306 Test Loss: 5.207 Test Acc: 0.306
Validation loss decreased (-0.297595 --> -0.305830).  Saving model ...
Epoch: 29 cost time: 0.6483235359191895
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.287 Vali Acc: 0.296 Test Loss: 5.287 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.591646671295166
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.292 Vali Acc: 0.298 Test Loss: 5.292 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.612797737121582
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.319 Vali Acc: 0.296 Test Loss: 5.319 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6231567859649658
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.313 Vali Acc: 0.295 Test Loss: 5.313 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5767462253570557
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.277 Vali Acc: 0.294 Test Loss: 5.277 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.576636791229248
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.242 Vali Acc: 0.295 Test Loss: 5.242 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7102856636047363
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.248 Vali Acc: 0.293 Test Loss: 5.248 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6328849792480469
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.248 Vali Acc: 0.295 Test Loss: 5.248 Test Acc: 0.295
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6961374282836914
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.265 Vali Acc: 0.299 Test Loss: 5.265 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6019690036773682
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.280 Vali Acc: 0.300 Test Loss: 5.280 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 36698906
model size : 154.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.41117787361145
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.356 Vali Acc: 0.039 Test Loss: 3.356 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.114166498184204
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.390 Vali Acc: 0.047 Test Loss: 3.390 Test Acc: 0.047
Validation loss decreased (-0.038790 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 1.285588026046753
Epoch: 3, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.296 Vali Acc: 0.107 Test Loss: 3.296 Test Acc: 0.107
Validation loss decreased (-0.047025 --> -0.107026).  Saving model ...
Epoch: 4 cost time: 0.8043737411499023
Epoch: 4, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.228 Vali Acc: 0.100 Test Loss: 3.228 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0025875568389893
Epoch: 5, Steps: 10 | Train Loss: 2.329 Vali Loss: 3.218 Vali Acc: 0.161 Test Loss: 3.218 Test Acc: 0.161
Validation loss decreased (-0.107026 --> -0.161144).  Saving model ...
Epoch: 6 cost time: 0.7948095798492432
Epoch: 6, Steps: 10 | Train Loss: 1.761 Vali Loss: 3.244 Vali Acc: 0.195 Test Loss: 3.244 Test Acc: 0.195
Validation loss decreased (-0.161144 --> -0.195262).  Saving model ...
Epoch: 7 cost time: 0.9842052459716797
Epoch: 7, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.777 Vali Acc: 0.213 Test Loss: 3.777 Test Acc: 0.213
Validation loss decreased (-0.195262 --> -0.212903).  Saving model ...
Epoch: 8 cost time: 0.8690762519836426
Epoch: 8, Steps: 10 | Train Loss: 0.649 Vali Loss: 4.254 Vali Acc: 0.242 Test Loss: 4.254 Test Acc: 0.242
Validation loss decreased (-0.212903 --> -0.242310).  Saving model ...
Epoch: 9 cost time: 1.006270408630371
Epoch: 9, Steps: 10 | Train Loss: 0.383 Vali Loss: 4.983 Vali Acc: 0.252 Test Loss: 4.983 Test Acc: 0.252
Validation loss decreased (-0.242310 --> -0.251715).  Saving model ...
Epoch: 10 cost time: 0.6938488483428955
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 5.432 Vali Acc: 0.234 Test Loss: 5.432 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0972113609313965
Epoch: 11, Steps: 10 | Train Loss: 0.131 Vali Loss: 5.674 Vali Acc: 0.255 Test Loss: 5.674 Test Acc: 0.255
Validation loss decreased (-0.251715 --> -0.255237).  Saving model ...
Epoch: 12 cost time: 1.0969269275665283
Epoch: 12, Steps: 10 | Train Loss: 0.114 Vali Loss: 6.372 Vali Acc: 0.266 Test Loss: 6.372 Test Acc: 0.266
Validation loss decreased (-0.255237 --> -0.265819).  Saving model ...
Epoch: 13 cost time: 1.0161185264587402
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 6.748 Vali Acc: 0.272 Test Loss: 6.748 Test Acc: 0.272
Validation loss decreased (-0.265819 --> -0.271697).  Saving model ...
Epoch: 14 cost time: 0.6940031051635742
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 6.951 Vali Acc: 0.273 Test Loss: 6.951 Test Acc: 0.273
Validation loss decreased (-0.271697 --> -0.272872).  Saving model ...
Epoch: 15 cost time: 0.9849202632904053
Epoch: 15, Steps: 10 | Train Loss: 0.114 Vali Loss: 6.643 Vali Acc: 0.273 Test Loss: 6.643 Test Acc: 0.273
Validation loss decreased (-0.272872 --> -0.272875).  Saving model ...
Epoch: 16 cost time: 0.7695789337158203
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 6.961 Vali Acc: 0.264 Test Loss: 6.961 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0244266986846924
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 7.175 Vali Acc: 0.276 Test Loss: 7.175 Test Acc: 0.276
Validation loss decreased (-0.272875 --> -0.276399).  Saving model ...
Epoch: 18 cost time: 1.164163589477539
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 7.394 Vali Acc: 0.274 Test Loss: 7.394 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9794893264770508
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 7.971 Vali Acc: 0.255 Test Loss: 7.971 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1701669692993164
Epoch: 20, Steps: 10 | Train Loss: 0.094 Vali Loss: 7.496 Vali Acc: 0.274 Test Loss: 7.496 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0873932838439941
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 7.922 Vali Acc: 0.273 Test Loss: 7.922 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0137746334075928
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 7.934 Vali Acc: 0.300 Test Loss: 7.934 Test Acc: 0.300
Validation loss decreased (-0.276399 --> -0.299921).  Saving model ...
Epoch: 23 cost time: 1.0653047561645508
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 8.537 Vali Acc: 0.248 Test Loss: 8.537 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6521999835968018
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 8.208 Vali Acc: 0.276 Test Loss: 8.208 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9670062065124512
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 9.345 Vali Acc: 0.226 Test Loss: 9.345 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9839050769805908
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 8.334 Vali Acc: 0.279 Test Loss: 8.334 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0157201290130615
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 8.258 Vali Acc: 0.281 Test Loss: 8.258 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.348480463027954
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.140 Vali Acc: 0.295 Test Loss: 8.140 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9470458030700684
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 8.332 Vali Acc: 0.285 Test Loss: 8.332 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7064132690429688
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.549 Vali Acc: 0.274 Test Loss: 8.549 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2309303283691406
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.988 Vali Acc: 0.264 Test Loss: 8.988 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1347124576568604
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 8.651 Vali Acc: 0.272 Test Loss: 8.651 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3
model parameter : 37415450
model size : 157.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.454470157623291
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.330 Vali Acc: 0.046 Test Loss: 3.330 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.7589852809906006
Epoch: 2, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.342 Vali Acc: 0.060 Test Loss: 3.342 Test Acc: 0.060
Validation loss decreased (-0.045849 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.5481832027435303
Epoch: 3, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.297 Vali Acc: 0.073 Test Loss: 3.297 Test Acc: 0.073
Validation loss decreased (-0.059967 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.8946132659912109
Epoch: 4, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.261 Vali Acc: 0.095 Test Loss: 3.261 Test Acc: 0.095
Validation loss decreased (-0.072908 --> -0.095262).  Saving model ...
Epoch: 5 cost time: 0.5971033573150635
Epoch: 5, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.201 Vali Acc: 0.114 Test Loss: 3.201 Test Acc: 0.114
Validation loss decreased (-0.095262 --> -0.114086).  Saving model ...
Epoch: 6 cost time: 0.7646815776824951
Epoch: 6, Steps: 10 | Train Loss: 2.247 Vali Loss: 3.213 Vali Acc: 0.145 Test Loss: 3.213 Test Acc: 0.145
Validation loss decreased (-0.114086 --> -0.144674).  Saving model ...
Epoch: 7 cost time: 0.5986948013305664
Epoch: 7, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.304 Vali Acc: 0.172 Test Loss: 3.304 Test Acc: 0.172
Validation loss decreased (-0.144674 --> -0.171732).  Saving model ...
Epoch: 8 cost time: 0.8034441471099854
Epoch: 8, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.590 Vali Acc: 0.218 Test Loss: 3.590 Test Acc: 0.218
Validation loss decreased (-0.171732 --> -0.217611).  Saving model ...
Epoch: 9 cost time: 0.7601568698883057
Epoch: 9, Steps: 10 | Train Loss: 0.849 Vali Loss: 4.109 Vali Acc: 0.209 Test Loss: 4.109 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8267436027526855
Epoch: 10, Steps: 10 | Train Loss: 0.627 Vali Loss: 4.053 Vali Acc: 0.258 Test Loss: 4.053 Test Acc: 0.258
Validation loss decreased (-0.217611 --> -0.257607).  Saving model ...
Epoch: 11 cost time: 0.773524284362793
Epoch: 11, Steps: 10 | Train Loss: 0.279 Vali Loss: 4.425 Vali Acc: 0.255 Test Loss: 4.425 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6993589401245117
Epoch: 12, Steps: 10 | Train Loss: 0.181 Vali Loss: 4.573 Vali Acc: 0.275 Test Loss: 4.573 Test Acc: 0.275
Validation loss decreased (-0.257607 --> -0.275248).  Saving model ...
Epoch: 13 cost time: 0.9064009189605713
Epoch: 13, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.763 Vali Acc: 0.278 Test Loss: 4.763 Test Acc: 0.278
Validation loss decreased (-0.275248 --> -0.277599).  Saving model ...
Epoch: 14 cost time: 0.7990801334381104
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.759 Vali Acc: 0.298 Test Loss: 4.759 Test Acc: 0.298
Validation loss decreased (-0.277599 --> -0.297599).  Saving model ...
Epoch: 15 cost time: 0.8441836833953857
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.300 Vali Acc: 0.279 Test Loss: 5.300 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8630447387695312
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.298 Vali Acc: 0.293 Test Loss: 5.298 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8823983669281006
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.355 Vali Acc: 0.280 Test Loss: 5.355 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8729400634765625
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.537 Vali Acc: 0.286 Test Loss: 5.537 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7920591831207275
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.278 Vali Acc: 0.305 Test Loss: 5.278 Test Acc: 0.305
Validation loss decreased (-0.297599 --> -0.304653).  Saving model ...
Epoch: 20 cost time: 0.7970902919769287
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.299 Vali Acc: 0.292 Test Loss: 5.299 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7547459602355957
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.417 Vali Acc: 0.296 Test Loss: 5.417 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7820091247558594
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.490 Vali Acc: 0.299 Test Loss: 5.490 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7775998115539551
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.401 Vali Acc: 0.309 Test Loss: 5.401 Test Acc: 0.309
Validation loss decreased (-0.304653 --> -0.309358).  Saving model ...
Epoch: 24 cost time: 0.8084309101104736
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.540 Vali Acc: 0.298 Test Loss: 5.540 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7704555988311768
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.489 Vali Acc: 0.294 Test Loss: 5.489 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8977930545806885
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.531 Vali Acc: 0.305 Test Loss: 5.531 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9356169700622559
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.686 Vali Acc: 0.291 Test Loss: 5.686 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0986931324005127
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.709 Vali Acc: 0.305 Test Loss: 5.709 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9310641288757324
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.645 Vali Acc: 0.291 Test Loss: 5.645 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9676268100738525
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.664 Vali Acc: 0.295 Test Loss: 5.664 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1011202335357666
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.650 Vali Acc: 0.312 Test Loss: 5.650 Test Acc: 0.312
Validation loss decreased (-0.309358 --> -0.311708).  Saving model ...
Epoch: 32 cost time: 0.8393697738647461
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.696 Vali Acc: 0.318 Test Loss: 5.696 Test Acc: 0.318
Validation loss decreased (-0.311708 --> -0.317590).  Saving model ...
Epoch: 33 cost time: 0.8097865581512451
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.710 Vali Acc: 0.312 Test Loss: 5.710 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9311842918395996
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.709 Vali Acc: 0.305 Test Loss: 5.709 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9511382579803467
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.703 Vali Acc: 0.302 Test Loss: 5.703 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8547167778015137
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.701 Vali Acc: 0.306 Test Loss: 5.701 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.76519775390625
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.712 Vali Acc: 0.306 Test Loss: 5.712 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8833003044128418
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.713 Vali Acc: 0.306 Test Loss: 5.713 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9394528865814209
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.716 Vali Acc: 0.305 Test Loss: 5.716 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6701779365539551
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.720 Vali Acc: 0.311 Test Loss: 5.720 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9031059741973877
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.701 Vali Acc: 0.311 Test Loss: 5.701 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.891660213470459
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.704 Vali Acc: 0.307 Test Loss: 5.704 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 36899354
model size : 155.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0725183486938477
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.329 Vali Acc: 0.038 Test Loss: 3.329 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.5967991352081299
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.337 Vali Acc: 0.064 Test Loss: 3.337 Test Acc: 0.064
Validation loss decreased (-0.037614 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.5751926898956299
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.339 Vali Acc: 0.067 Test Loss: 3.339 Test Acc: 0.067
Validation loss decreased (-0.063496 --> -0.067025).  Saving model ...
Epoch: 4 cost time: 0.7697279453277588
Epoch: 4, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.298 Vali Acc: 0.079 Test Loss: 3.298 Test Acc: 0.079
Validation loss decreased (-0.067025 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.7672767639160156
Epoch: 5, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.266 Vali Acc: 0.095 Test Loss: 3.266 Test Acc: 0.095
Validation loss decreased (-0.078791 --> -0.095261).  Saving model ...
Epoch: 6 cost time: 0.6943445205688477
Epoch: 6, Steps: 10 | Train Loss: 2.647 Vali Loss: 3.215 Vali Acc: 0.118 Test Loss: 3.215 Test Acc: 0.118
Validation loss decreased (-0.095261 --> -0.117615).  Saving model ...
Epoch: 7 cost time: 0.7172846794128418
Epoch: 7, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.184 Vali Acc: 0.129 Test Loss: 3.184 Test Acc: 0.129
Validation loss decreased (-0.117615 --> -0.129380).  Saving model ...
Epoch: 8 cost time: 0.6810271739959717
Epoch: 8, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.260 Vali Acc: 0.180 Test Loss: 3.260 Test Acc: 0.180
Validation loss decreased (-0.129380 --> -0.179967).  Saving model ...
Epoch: 9 cost time: 0.7560622692108154
Epoch: 9, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.346 Vali Acc: 0.208 Test Loss: 3.346 Test Acc: 0.208
Validation loss decreased (-0.179967 --> -0.208202).  Saving model ...
Epoch: 10 cost time: 0.7571775913238525
Epoch: 10, Steps: 10 | Train Loss: 1.039 Vali Loss: 3.438 Vali Acc: 0.233 Test Loss: 3.438 Test Acc: 0.233
Validation loss decreased (-0.208202 --> -0.232907).  Saving model ...
Epoch: 11 cost time: 0.7480103969573975
Epoch: 11, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.542 Vali Acc: 0.239 Test Loss: 3.542 Test Acc: 0.239
Validation loss decreased (-0.232907 --> -0.238788).  Saving model ...
Epoch: 12 cost time: 0.617722749710083
Epoch: 12, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.745 Vali Acc: 0.255 Test Loss: 3.745 Test Acc: 0.255
Validation loss decreased (-0.238788 --> -0.255257).  Saving model ...
Epoch: 13 cost time: 0.862384557723999
Epoch: 13, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.847 Vali Acc: 0.271 Test Loss: 3.847 Test Acc: 0.271
Validation loss decreased (-0.255257 --> -0.270550).  Saving model ...
Epoch: 14 cost time: 0.6670107841491699
Epoch: 14, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.006 Vali Acc: 0.276 Test Loss: 4.006 Test Acc: 0.276
Validation loss decreased (-0.270550 --> -0.276431).  Saving model ...
Epoch: 15 cost time: 0.7604799270629883
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.193 Vali Acc: 0.288 Test Loss: 4.193 Test Acc: 0.288
Validation loss decreased (-0.276431 --> -0.288193).  Saving model ...
Epoch: 16 cost time: 0.7190456390380859
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.187 Vali Acc: 0.294 Test Loss: 4.187 Test Acc: 0.294
Validation loss decreased (-0.288193 --> -0.294076).  Saving model ...
Epoch: 17 cost time: 0.7436695098876953
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.555 Vali Acc: 0.282 Test Loss: 4.555 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.813439130783081
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.536 Vali Acc: 0.278 Test Loss: 4.536 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8094630241394043
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.510 Vali Acc: 0.288 Test Loss: 4.510 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7496902942657471
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.602 Vali Acc: 0.282 Test Loss: 4.602 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6917519569396973
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.671 Vali Acc: 0.278 Test Loss: 4.671 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7721500396728516
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.753 Vali Acc: 0.289 Test Loss: 4.753 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7558872699737549
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.778 Vali Acc: 0.294 Test Loss: 4.778 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5809931755065918
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.668 Vali Acc: 0.295 Test Loss: 4.668 Test Acc: 0.295
Validation loss decreased (-0.294076 --> -0.295247).  Saving model ...
Epoch: 25 cost time: 0.5808632373809814
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.720 Vali Acc: 0.295 Test Loss: 4.720 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6889240741729736
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.858 Vali Acc: 0.286 Test Loss: 4.858 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6949985027313232
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.827 Vali Acc: 0.299 Test Loss: 4.827 Test Acc: 0.299
Validation loss decreased (-0.295247 --> -0.298775).  Saving model ...
Epoch: 28 cost time: 0.7367861270904541
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.777 Vali Acc: 0.300 Test Loss: 4.777 Test Acc: 0.300
Validation loss decreased (-0.298775 --> -0.299952).  Saving model ...
Epoch: 29 cost time: 0.6898956298828125
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.791 Vali Acc: 0.305 Test Loss: 4.791 Test Acc: 0.305
Validation loss decreased (-0.299952 --> -0.304658).  Saving model ...
Epoch: 30 cost time: 0.7296411991119385
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.836 Vali Acc: 0.304 Test Loss: 4.836 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6341209411621094
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.842 Vali Acc: 0.292 Test Loss: 4.842 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6373448371887207
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.862 Vali Acc: 0.298 Test Loss: 4.862 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.64878249168396
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.911 Vali Acc: 0.304 Test Loss: 4.911 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6538033485412598
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.965 Vali Acc: 0.299 Test Loss: 4.965 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7195765972137451
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.967 Vali Acc: 0.301 Test Loss: 4.967 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6718180179595947
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.995 Vali Acc: 0.307 Test Loss: 4.995 Test Acc: 0.307
Validation loss decreased (-0.304658 --> -0.307009).  Saving model ...
Epoch: 37 cost time: 0.7119903564453125
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.002 Vali Acc: 0.307 Test Loss: 5.002 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6772942543029785
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.010 Vali Acc: 0.305 Test Loss: 5.010 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7189199924468994
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.982 Vali Acc: 0.309 Test Loss: 4.982 Test Acc: 0.309
Validation loss decreased (-0.307009 --> -0.309362).  Saving model ...
Epoch: 40 cost time: 0.6579790115356445
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.984 Vali Acc: 0.309 Test Loss: 4.984 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6732099056243896
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.007 Vali Acc: 0.301 Test Loss: 5.007 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6698977947235107
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.029 Vali Acc: 0.308 Test Loss: 5.029 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6791431903839111
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.036 Vali Acc: 0.300 Test Loss: 5.036 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6880826950073242
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.048 Vali Acc: 0.304 Test Loss: 5.048 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.652642011642456
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.051 Vali Acc: 0.309 Test Loss: 5.051 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6707549095153809
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.063 Vali Acc: 0.313 Test Loss: 5.063 Test Acc: 0.313
Validation loss decreased (-0.309362 --> -0.312891).  Saving model ...
Epoch: 47 cost time: 0.6265692710876465
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.092 Vali Acc: 0.305 Test Loss: 5.092 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5830245018005371
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.117 Vali Acc: 0.301 Test Loss: 5.117 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6099750995635986
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.121 Vali Acc: 0.304 Test Loss: 5.121 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6562650203704834
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.151 Vali Acc: 0.301 Test Loss: 5.151 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 36662810
model size : 154.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5040438175201416
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.334 Vali Acc: 0.062 Test Loss: 3.334 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 1.0714023113250732
Epoch: 2, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.365 Vali Acc: 0.093 Test Loss: 3.365 Test Acc: 0.093
Validation loss decreased (-0.062320 --> -0.092908).  Saving model ...
Epoch: 3 cost time: 0.9833347797393799
Epoch: 3, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.254 Vali Acc: 0.098 Test Loss: 3.254 Test Acc: 0.098
Validation loss decreased (-0.092908 --> -0.097615).  Saving model ...
Epoch: 4 cost time: 1.0400099754333496
Epoch: 4, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.204 Vali Acc: 0.133 Test Loss: 3.204 Test Acc: 0.133
Validation loss decreased (-0.097615 --> -0.132909).  Saving model ...
Epoch: 5 cost time: 0.7241253852844238
Epoch: 5, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.182 Vali Acc: 0.149 Test Loss: 3.182 Test Acc: 0.149
Validation loss decreased (-0.132909 --> -0.149380).  Saving model ...
Epoch: 6 cost time: 0.8007838726043701
Epoch: 6, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.341 Vali Acc: 0.206 Test Loss: 3.341 Test Acc: 0.206
Validation loss decreased (-0.149380 --> -0.205849).  Saving model ...
Epoch: 7 cost time: 0.8823668956756592
Epoch: 7, Steps: 10 | Train Loss: 1.201 Vali Loss: 3.797 Vali Acc: 0.211 Test Loss: 3.797 Test Acc: 0.211
Validation loss decreased (-0.205849 --> -0.210550).  Saving model ...
Epoch: 8 cost time: 0.946429967880249
Epoch: 8, Steps: 10 | Train Loss: 0.642 Vali Loss: 4.530 Vali Acc: 0.222 Test Loss: 4.530 Test Acc: 0.222
Validation loss decreased (-0.210550 --> -0.222308).  Saving model ...
Epoch: 9 cost time: 0.6710498332977295
Epoch: 9, Steps: 10 | Train Loss: 0.434 Vali Loss: 4.862 Vali Acc: 0.252 Test Loss: 4.862 Test Acc: 0.252
Validation loss decreased (-0.222308 --> -0.251716).  Saving model ...
Epoch: 10 cost time: 1.0094366073608398
Epoch: 10, Steps: 10 | Train Loss: 0.191 Vali Loss: 5.242 Vali Acc: 0.261 Test Loss: 5.242 Test Acc: 0.261
Validation loss decreased (-0.251716 --> -0.261124).  Saving model ...
Epoch: 11 cost time: 0.8769388198852539
Epoch: 11, Steps: 10 | Train Loss: 0.137 Vali Loss: 5.686 Vali Acc: 0.251 Test Loss: 5.686 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7169737815856934
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.800 Vali Acc: 0.286 Test Loss: 5.800 Test Acc: 0.286
Validation loss decreased (-0.261124 --> -0.285824).  Saving model ...
Epoch: 13 cost time: 0.963991641998291
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.385 Vali Acc: 0.271 Test Loss: 6.385 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8409922122955322
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 6.589 Vali Acc: 0.266 Test Loss: 6.589 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9290318489074707
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.759 Vali Acc: 0.268 Test Loss: 6.759 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8808941841125488
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 7.115 Vali Acc: 0.269 Test Loss: 7.115 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7926661968231201
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.954 Vali Acc: 0.287 Test Loss: 6.954 Test Acc: 0.287
Validation loss decreased (-0.285824 --> -0.286989).  Saving model ...
Epoch: 18 cost time: 0.9019360542297363
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.338 Vali Acc: 0.275 Test Loss: 7.338 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8047454357147217
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.169 Vali Acc: 0.294 Test Loss: 7.169 Test Acc: 0.294
Validation loss decreased (-0.286989 --> -0.294046).  Saving model ...
Epoch: 20 cost time: 0.9530503749847412
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.295 Vali Acc: 0.289 Test Loss: 7.295 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0619173049926758
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.286 Vali Acc: 0.293 Test Loss: 7.286 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9638962745666504
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.207 Vali Acc: 0.289 Test Loss: 7.207 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.021538496017456
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.162 Vali Acc: 0.288 Test Loss: 7.162 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9034078121185303
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.131 Vali Acc: 0.292 Test Loss: 7.131 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6802194118499756
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.122 Vali Acc: 0.292 Test Loss: 7.122 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9298233985900879
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.026 Vali Acc: 0.298 Test Loss: 7.026 Test Acc: 0.298
Validation loss decreased (-0.294046 --> -0.297577).  Saving model ...
Epoch: 27 cost time: 0.7935290336608887
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.000 Vali Acc: 0.299 Test Loss: 7.000 Test Acc: 0.299
Validation loss decreased (-0.297577 --> -0.298754).  Saving model ...
Epoch: 28 cost time: 0.8863873481750488
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.035 Vali Acc: 0.296 Test Loss: 7.035 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7904167175292969
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.064 Vali Acc: 0.294 Test Loss: 7.064 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8690059185028076
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.085 Vali Acc: 0.295 Test Loss: 7.085 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8079206943511963
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.089 Vali Acc: 0.295 Test Loss: 7.089 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9427249431610107
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.077 Vali Acc: 0.294 Test Loss: 7.077 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8476409912109375
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.071 Vali Acc: 0.293 Test Loss: 7.071 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0171630382537842
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.084 Vali Acc: 0.295 Test Loss: 7.084 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9748063087463379
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.139 Vali Acc: 0.293 Test Loss: 7.139 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9757091999053955
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.161 Vali Acc: 0.294 Test Loss: 7.161 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.000678539276123
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.162 Vali Acc: 0.294 Test Loss: 7.162 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 37400858
model size : 157.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.361341953277588
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.308 Vali Acc: 0.034 Test Loss: 3.308 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.7045419216156006
Epoch: 2, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.375 Vali Acc: 0.052 Test Loss: 3.375 Test Acc: 0.052
Validation loss decreased (-0.034085 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.7598307132720947
Epoch: 3, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.358 Vali Acc: 0.091 Test Loss: 3.358 Test Acc: 0.091
Validation loss decreased (-0.051731 --> -0.090555).  Saving model ...
Epoch: 4 cost time: 0.9257547855377197
Epoch: 4, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.235 Vali Acc: 0.093 Test Loss: 3.235 Test Acc: 0.093
Validation loss decreased (-0.090555 --> -0.092909).  Saving model ...
Epoch: 5 cost time: 0.7496020793914795
Epoch: 5, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.191 Vali Acc: 0.125 Test Loss: 3.191 Test Acc: 0.125
Validation loss decreased (-0.092909 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 0.5956697463989258
Epoch: 6, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.203 Vali Acc: 0.154 Test Loss: 3.203 Test Acc: 0.154
Validation loss decreased (-0.124674 --> -0.154086).  Saving model ...
Epoch: 7 cost time: 0.8910574913024902
Epoch: 7, Steps: 10 | Train Loss: 1.852 Vali Loss: 3.291 Vali Acc: 0.198 Test Loss: 3.291 Test Acc: 0.198
Validation loss decreased (-0.154086 --> -0.197614).  Saving model ...
Epoch: 8 cost time: 0.811854362487793
Epoch: 8, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.582 Vali Acc: 0.188 Test Loss: 3.582 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7449238300323486
Epoch: 9, Steps: 10 | Train Loss: 0.894 Vali Loss: 4.013 Vali Acc: 0.209 Test Loss: 4.013 Test Acc: 0.209
Validation loss decreased (-0.197614 --> -0.209372).  Saving model ...
Epoch: 10 cost time: 0.8377974033355713
Epoch: 10, Steps: 10 | Train Loss: 0.521 Vali Loss: 4.216 Vali Acc: 0.248 Test Loss: 4.216 Test Acc: 0.248
Validation loss decreased (-0.209372 --> -0.248193).  Saving model ...
Epoch: 11 cost time: 0.9731388092041016
Epoch: 11, Steps: 10 | Train Loss: 0.448 Vali Loss: 4.365 Vali Acc: 0.258 Test Loss: 4.365 Test Acc: 0.258
Validation loss decreased (-0.248193 --> -0.257603).  Saving model ...
Epoch: 12 cost time: 0.8029887676239014
Epoch: 12, Steps: 10 | Train Loss: 0.277 Vali Loss: 4.752 Vali Acc: 0.240 Test Loss: 4.752 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7641749382019043
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.716 Vali Acc: 0.269 Test Loss: 4.716 Test Acc: 0.269
Validation loss decreased (-0.257603 --> -0.269365).  Saving model ...
Epoch: 14 cost time: 0.7460525035858154
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.995 Vali Acc: 0.275 Test Loss: 4.995 Test Acc: 0.275
Validation loss decreased (-0.269365 --> -0.275244).  Saving model ...
Epoch: 15 cost time: 0.758065938949585
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.124 Vali Acc: 0.281 Test Loss: 5.124 Test Acc: 0.281
Validation loss decreased (-0.275244 --> -0.281125).  Saving model ...
Epoch: 16 cost time: 0.7166798114776611
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.190 Vali Acc: 0.301 Test Loss: 5.190 Test Acc: 0.301
Validation loss decreased (-0.281125 --> -0.301125).  Saving model ...
Epoch: 17 cost time: 0.839367151260376
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.009 Vali Acc: 0.255 Test Loss: 6.009 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6209235191345215
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.696 Vali Acc: 0.294 Test Loss: 5.696 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8395309448242188
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.406 Vali Acc: 0.305 Test Loss: 5.406 Test Acc: 0.305
Validation loss decreased (-0.301125 --> -0.304652).  Saving model ...
Epoch: 20 cost time: 0.9396748542785645
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.486 Vali Acc: 0.292 Test Loss: 5.486 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6713831424713135
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.540 Vali Acc: 0.294 Test Loss: 5.540 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9126486778259277
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.686 Vali Acc: 0.293 Test Loss: 5.686 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7556262016296387
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.516 Vali Acc: 0.312 Test Loss: 5.516 Test Acc: 0.312
Validation loss decreased (-0.304652 --> -0.311710).  Saving model ...
Epoch: 24 cost time: 0.8039255142211914
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.510 Vali Acc: 0.307 Test Loss: 5.510 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.729724645614624
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.782 Vali Acc: 0.298 Test Loss: 5.782 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8311805725097656
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.756 Vali Acc: 0.300 Test Loss: 5.756 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9443080425262451
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.716 Vali Acc: 0.309 Test Loss: 5.716 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8100810050964355
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.864 Vali Acc: 0.299 Test Loss: 5.864 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0396349430084229
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.814 Vali Acc: 0.301 Test Loss: 5.814 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7921590805053711
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.722 Vali Acc: 0.294 Test Loss: 5.722 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8076591491699219
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.700 Vali Acc: 0.296 Test Loss: 5.700 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9034476280212402
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.722 Vali Acc: 0.300 Test Loss: 5.722 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9362726211547852
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.755 Vali Acc: 0.307 Test Loss: 5.755 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 36906266
model size : 155.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.862579345703125
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.334 Vali Acc: 0.040 Test Loss: 3.334 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.7220196723937988
Epoch: 2, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.326 Vali Acc: 0.034 Test Loss: 3.326 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7075037956237793
Epoch: 3, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.319 Vali Acc: 0.060 Test Loss: 3.319 Test Acc: 0.060
Validation loss decreased (-0.039967 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.6816811561584473
Epoch: 4, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.301 Vali Acc: 0.051 Test Loss: 3.301 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7287459373474121
Epoch: 5, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.256 Vali Acc: 0.081 Test Loss: 3.256 Test Acc: 0.081
Validation loss decreased (-0.059967 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 0.6528029441833496
Epoch: 6, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.222 Vali Acc: 0.102 Test Loss: 3.222 Test Acc: 0.102
Validation loss decreased (-0.081144 --> -0.102321).  Saving model ...
Epoch: 7 cost time: 0.6090712547302246
Epoch: 7, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.169 Vali Acc: 0.145 Test Loss: 3.169 Test Acc: 0.145
Validation loss decreased (-0.102321 --> -0.144674).  Saving model ...
Epoch: 8 cost time: 0.7286157608032227
Epoch: 8, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.241 Vali Acc: 0.153 Test Loss: 3.241 Test Acc: 0.153
Validation loss decreased (-0.144674 --> -0.152909).  Saving model ...
Epoch: 9 cost time: 0.6351721286773682
Epoch: 9, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.324 Vali Acc: 0.201 Test Loss: 3.324 Test Acc: 0.201
Validation loss decreased (-0.152909 --> -0.201143).  Saving model ...
Epoch: 10 cost time: 0.6544160842895508
Epoch: 10, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.506 Vali Acc: 0.204 Test Loss: 3.506 Test Acc: 0.204
Validation loss decreased (-0.201143 --> -0.203494).  Saving model ...
Epoch: 11 cost time: 0.7459537982940674
Epoch: 11, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.616 Vali Acc: 0.239 Test Loss: 3.616 Test Acc: 0.239
Validation loss decreased (-0.203494 --> -0.238787).  Saving model ...
Epoch: 12 cost time: 0.6859805583953857
Epoch: 12, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.962 Vali Acc: 0.245 Test Loss: 3.962 Test Acc: 0.245
Validation loss decreased (-0.238787 --> -0.244666).  Saving model ...
Epoch: 13 cost time: 0.5939381122589111
Epoch: 13, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.938 Vali Acc: 0.254 Test Loss: 3.938 Test Acc: 0.254
Validation loss decreased (-0.244666 --> -0.254078).  Saving model ...
Epoch: 14 cost time: 0.6411755084991455
Epoch: 14, Steps: 10 | Train Loss: 0.259 Vali Loss: 4.154 Vali Acc: 0.264 Test Loss: 4.154 Test Acc: 0.264
Validation loss decreased (-0.254078 --> -0.263488).  Saving model ...
Epoch: 15 cost time: 0.6838245391845703
Epoch: 15, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.300 Vali Acc: 0.274 Test Loss: 4.300 Test Acc: 0.274
Validation loss decreased (-0.263488 --> -0.274075).  Saving model ...
Epoch: 16 cost time: 0.6244072914123535
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.423 Vali Acc: 0.269 Test Loss: 4.423 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6393439769744873
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.630 Vali Acc: 0.280 Test Loss: 4.630 Test Acc: 0.280
Validation loss decreased (-0.274075 --> -0.279954).  Saving model ...
Epoch: 18 cost time: 0.6278800964355469
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.627 Vali Acc: 0.285 Test Loss: 4.627 Test Acc: 0.285
Validation loss decreased (-0.279954 --> -0.284660).  Saving model ...
Epoch: 19 cost time: 0.5679986476898193
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.714 Vali Acc: 0.282 Test Loss: 4.714 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6602866649627686
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.783 Vali Acc: 0.288 Test Loss: 4.783 Test Acc: 0.288
Validation loss decreased (-0.284660 --> -0.288187).  Saving model ...
Epoch: 21 cost time: 0.5787363052368164
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.825 Vali Acc: 0.292 Test Loss: 4.825 Test Acc: 0.292
Validation loss decreased (-0.288187 --> -0.291716).  Saving model ...
Epoch: 22 cost time: 0.6385478973388672
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.857 Vali Acc: 0.295 Test Loss: 4.857 Test Acc: 0.295
Validation loss decreased (-0.291716 --> -0.295246).  Saving model ...
Epoch: 23 cost time: 0.6519134044647217
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.858 Vali Acc: 0.308 Test Loss: 4.858 Test Acc: 0.308
Validation loss decreased (-0.295246 --> -0.308187).  Saving model ...
Epoch: 24 cost time: 0.6321525573730469
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.801 Vali Acc: 0.301 Test Loss: 4.801 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5781459808349609
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.842 Vali Acc: 0.299 Test Loss: 4.842 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6723992824554443
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.015 Vali Acc: 0.285 Test Loss: 5.015 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.695321798324585
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.991 Vali Acc: 0.294 Test Loss: 4.991 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6734962463378906
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.026 Vali Acc: 0.294 Test Loss: 5.026 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7877485752105713
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.039 Vali Acc: 0.287 Test Loss: 5.039 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6541273593902588
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.135 Vali Acc: 0.285 Test Loss: 5.135 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.619239330291748
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.150 Vali Acc: 0.285 Test Loss: 5.150 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6206228733062744
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.128 Vali Acc: 0.292 Test Loss: 5.128 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.612311601638794
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.109 Vali Acc: 0.292 Test Loss: 5.109 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 36648218
model size : 154.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1439247131347656
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.331 Vali Acc: 0.045 Test Loss: 3.331 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.729062557220459
Epoch: 2, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.388 Vali Acc: 0.075 Test Loss: 3.388 Test Acc: 0.075
Validation loss decreased (-0.044673 --> -0.075260).  Saving model ...
Epoch: 3 cost time: 0.6955130100250244
Epoch: 3, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.276 Vali Acc: 0.069 Test Loss: 3.276 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7225325107574463
Epoch: 4, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.236 Vali Acc: 0.118 Test Loss: 3.236 Test Acc: 0.118
Validation loss decreased (-0.075260 --> -0.117615).  Saving model ...
Epoch: 5 cost time: 0.6441190242767334
Epoch: 5, Steps: 10 | Train Loss: 2.409 Vali Loss: 3.161 Vali Acc: 0.154 Test Loss: 3.161 Test Acc: 0.154
Validation loss decreased (-0.117615 --> -0.154086).  Saving model ...
Epoch: 6 cost time: 0.7666225433349609
Epoch: 6, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.175 Vali Acc: 0.192 Test Loss: 3.175 Test Acc: 0.192
Validation loss decreased (-0.154086 --> -0.191733).  Saving model ...
Epoch: 7 cost time: 0.8651745319366455
Epoch: 7, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.492 Vali Acc: 0.207 Test Loss: 3.492 Test Acc: 0.207
Validation loss decreased (-0.191733 --> -0.207024).  Saving model ...
Epoch: 8 cost time: 0.6852829456329346
Epoch: 8, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.954 Vali Acc: 0.225 Test Loss: 3.954 Test Acc: 0.225
Validation loss decreased (-0.207024 --> -0.224666).  Saving model ...
Epoch: 9 cost time: 0.9600837230682373
Epoch: 9, Steps: 10 | Train Loss: 0.613 Vali Loss: 4.592 Vali Acc: 0.241 Test Loss: 4.592 Test Acc: 0.241
Validation loss decreased (-0.224666 --> -0.241131).  Saving model ...
Epoch: 10 cost time: 0.8289940357208252
Epoch: 10, Steps: 10 | Train Loss: 0.411 Vali Loss: 4.735 Vali Acc: 0.251 Test Loss: 4.735 Test Acc: 0.251
Validation loss decreased (-0.241131 --> -0.250541).  Saving model ...
Epoch: 11 cost time: 0.8193905353546143
Epoch: 11, Steps: 10 | Train Loss: 0.209 Vali Loss: 4.905 Vali Acc: 0.269 Test Loss: 4.905 Test Acc: 0.269
Validation loss decreased (-0.250541 --> -0.269363).  Saving model ...
Epoch: 12 cost time: 0.8111882209777832
Epoch: 12, Steps: 10 | Train Loss: 0.114 Vali Loss: 5.137 Vali Acc: 0.262 Test Loss: 5.137 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7269675731658936
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 5.654 Vali Acc: 0.252 Test Loss: 5.654 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7231204509735107
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 5.907 Vali Acc: 0.272 Test Loss: 5.907 Test Acc: 0.272
Validation loss decreased (-0.269363 --> -0.271706).  Saving model ...
Epoch: 15 cost time: 0.849062442779541
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 6.821 Vali Acc: 0.234 Test Loss: 6.821 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7725567817687988
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 6.043 Vali Acc: 0.278 Test Loss: 6.043 Test Acc: 0.278
Validation loss decreased (-0.271706 --> -0.277587).  Saving model ...
Epoch: 17 cost time: 0.8459875583648682
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.006 Vali Acc: 0.282 Test Loss: 6.006 Test Acc: 0.282
Validation loss decreased (-0.277587 --> -0.282293).  Saving model ...
Epoch: 18 cost time: 1.0104360580444336
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.279 Vali Acc: 0.291 Test Loss: 6.279 Test Acc: 0.291
Validation loss decreased (-0.282293 --> -0.290525).  Saving model ...
Epoch: 19 cost time: 0.7273790836334229
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.181 Vali Acc: 0.285 Test Loss: 6.181 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.731412410736084
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.036 Vali Acc: 0.289 Test Loss: 6.036 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8231141567230225
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.062 Vali Acc: 0.299 Test Loss: 6.062 Test Acc: 0.299
Validation loss decreased (-0.290525 --> -0.298763).  Saving model ...
Epoch: 22 cost time: 0.7684857845306396
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.421 Vali Acc: 0.294 Test Loss: 6.421 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8030142784118652
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.154 Vali Acc: 0.306 Test Loss: 6.154 Test Acc: 0.306
Validation loss decreased (-0.298763 --> -0.305821).  Saving model ...
Epoch: 24 cost time: 1.069061517715454
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.423 Vali Acc: 0.294 Test Loss: 6.423 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.000816822052002
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 6.335 Vali Acc: 0.302 Test Loss: 6.335 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8948464393615723
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.687 Vali Acc: 0.291 Test Loss: 6.687 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9598307609558105
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.682 Vali Acc: 0.294 Test Loss: 6.682 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9425761699676514
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.610 Vali Acc: 0.294 Test Loss: 6.610 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9743959903717041
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.538 Vali Acc: 0.304 Test Loss: 6.538 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8305244445800781
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.479 Vali Acc: 0.301 Test Loss: 6.479 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7811052799224854
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.451 Vali Acc: 0.296 Test Loss: 6.451 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9946944713592529
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.435 Vali Acc: 0.299 Test Loss: 6.435 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7514171600341797
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.418 Vali Acc: 0.304 Test Loss: 6.418 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 37149722
model size : 156.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0100796222686768
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.321 Vali Acc: 0.046 Test Loss: 3.321 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.8560512065887451
Epoch: 2, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.329 Vali Acc: 0.069 Test Loss: 3.329 Test Acc: 0.069
Validation loss decreased (-0.045849 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.8278098106384277
Epoch: 3, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.319 Vali Acc: 0.084 Test Loss: 3.319 Test Acc: 0.084
Validation loss decreased (-0.069378 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.7511420249938965
Epoch: 4, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.262 Vali Acc: 0.094 Test Loss: 3.262 Test Acc: 0.094
Validation loss decreased (-0.083496 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 0.6805191040039062
Epoch: 5, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.187 Vali Acc: 0.121 Test Loss: 3.187 Test Acc: 0.121
Validation loss decreased (-0.094085 --> -0.121145).  Saving model ...
Epoch: 6 cost time: 0.5251989364624023
Epoch: 6, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.185 Vali Acc: 0.141 Test Loss: 3.185 Test Acc: 0.141
Validation loss decreased (-0.121145 --> -0.141145).  Saving model ...
Epoch: 7 cost time: 0.6750309467315674
Epoch: 7, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.157 Vali Acc: 0.174 Test Loss: 3.157 Test Acc: 0.174
Validation loss decreased (-0.141145 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 0.6232233047485352
Epoch: 8, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.385 Vali Acc: 0.207 Test Loss: 3.385 Test Acc: 0.207
Validation loss decreased (-0.174086 --> -0.207025).  Saving model ...
Epoch: 9 cost time: 0.8624846935272217
Epoch: 9, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.631 Vali Acc: 0.240 Test Loss: 3.631 Test Acc: 0.240
Validation loss decreased (-0.207025 --> -0.239964).  Saving model ...
Epoch: 10 cost time: 0.5617308616638184
Epoch: 10, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.875 Vali Acc: 0.244 Test Loss: 3.875 Test Acc: 0.244
Validation loss decreased (-0.239964 --> -0.243491).  Saving model ...
Epoch: 11 cost time: 0.7174074649810791
Epoch: 11, Steps: 10 | Train Loss: 0.365 Vali Loss: 4.074 Vali Acc: 0.275 Test Loss: 4.074 Test Acc: 0.275
Validation loss decreased (-0.243491 --> -0.275253).  Saving model ...
Epoch: 12 cost time: 0.7119531631469727
Epoch: 12, Steps: 10 | Train Loss: 0.166 Vali Loss: 4.290 Vali Acc: 0.272 Test Loss: 4.290 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.705219030380249
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.616 Vali Acc: 0.287 Test Loss: 4.616 Test Acc: 0.287
Validation loss decreased (-0.275253 --> -0.287013).  Saving model ...
Epoch: 14 cost time: 0.527219295501709
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.669 Vali Acc: 0.286 Test Loss: 4.669 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5315098762512207
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.749 Vali Acc: 0.280 Test Loss: 4.749 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6112160682678223
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.889 Vali Acc: 0.280 Test Loss: 4.889 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.57354736328125
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.886 Vali Acc: 0.285 Test Loss: 4.886 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5297601222991943
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.081 Vali Acc: 0.280 Test Loss: 5.081 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6017684936523438
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.173 Vali Acc: 0.279 Test Loss: 5.173 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5946452617645264
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.191 Vali Acc: 0.284 Test Loss: 5.191 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7915053367614746
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.153 Vali Acc: 0.288 Test Loss: 5.153 Test Acc: 0.288
Validation loss decreased (-0.287013 --> -0.288184).  Saving model ...
Epoch: 22 cost time: 0.8635721206665039
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.107 Vali Acc: 0.294 Test Loss: 5.107 Test Acc: 0.294
Validation loss decreased (-0.288184 --> -0.294067).  Saving model ...
Epoch: 23 cost time: 0.6230196952819824
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.202 Vali Acc: 0.295 Test Loss: 5.202 Test Acc: 0.295
Validation loss decreased (-0.294067 --> -0.295242).  Saving model ...
Epoch: 24 cost time: 0.6136858463287354
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.164 Vali Acc: 0.295 Test Loss: 5.164 Test Acc: 0.295
Validation loss decreased (-0.295242 --> -0.295242).  Saving model ...
Epoch: 25 cost time: 0.6293048858642578
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.258 Vali Acc: 0.291 Test Loss: 5.258 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.754777193069458
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.283 Vali Acc: 0.292 Test Loss: 5.283 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7778744697570801
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.290 Vali Acc: 0.299 Test Loss: 5.290 Test Acc: 0.299
Validation loss decreased (-0.295242 --> -0.298771).  Saving model ...
Epoch: 28 cost time: 0.8529407978057861
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.321 Vali Acc: 0.292 Test Loss: 5.321 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7881975173950195
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.237 Vali Acc: 0.295 Test Loss: 5.237 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7458348274230957
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.224 Vali Acc: 0.295 Test Loss: 5.224 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7510592937469482
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.269 Vali Acc: 0.295 Test Loss: 5.269 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.849478006362915
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.267 Vali Acc: 0.299 Test Loss: 5.267 Test Acc: 0.299
Validation loss decreased (-0.298771 --> -0.298771).  Saving model ...
Epoch: 33 cost time: 0.8997037410736084
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.300 Vali Acc: 0.298 Test Loss: 5.300 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.906550407409668
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.333 Vali Acc: 0.295 Test Loss: 5.333 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.007817268371582
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.330 Vali Acc: 0.295 Test Loss: 5.330 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8065972328186035
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.334 Vali Acc: 0.295 Test Loss: 5.334 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.764606237411499
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.349 Vali Acc: 0.300 Test Loss: 5.349 Test Acc: 0.300
Validation loss decreased (-0.298771 --> -0.299947).  Saving model ...
Epoch: 38 cost time: 0.7322444915771484
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.357 Vali Acc: 0.300 Test Loss: 5.357 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7022407054901123
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.358 Vali Acc: 0.298 Test Loss: 5.358 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5562629699707031
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.368 Vali Acc: 0.304 Test Loss: 5.368 Test Acc: 0.304
Validation loss decreased (-0.299947 --> -0.303476).  Saving model ...
Epoch: 41 cost time: 0.8243067264556885
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.339 Vali Acc: 0.308 Test Loss: 5.339 Test Acc: 0.308
Validation loss decreased (-0.303476 --> -0.308182).  Saving model ...
Epoch: 42 cost time: 0.5857086181640625
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.353 Vali Acc: 0.304 Test Loss: 5.353 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.760972261428833
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.387 Vali Acc: 0.301 Test Loss: 5.387 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7494213581085205
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.404 Vali Acc: 0.302 Test Loss: 5.404 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8803448677062988
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.400 Vali Acc: 0.299 Test Loss: 5.400 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8364596366882324
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.385 Vali Acc: 0.304 Test Loss: 5.385 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8538813591003418
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.379 Vali Acc: 0.309 Test Loss: 5.379 Test Acc: 0.309
Validation loss decreased (-0.308182 --> -0.309358).  Saving model ...
Epoch: 48 cost time: 0.9572005271911621
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.437 Vali Acc: 0.301 Test Loss: 5.437 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8027386665344238
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.448 Vali Acc: 0.302 Test Loss: 5.448 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7300167083740234
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.454 Vali Acc: 0.301 Test Loss: 5.454 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 36827162
model size : 155.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2597126960754395
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.343 Vali Acc: 0.054 Test Loss: 3.343 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 0.6496946811676025
Epoch: 2, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.316 Vali Acc: 0.059 Test Loss: 3.316 Test Acc: 0.059
Validation loss decreased (-0.054084 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.6703100204467773
Epoch: 3, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.336 Vali Acc: 0.060 Test Loss: 3.336 Test Acc: 0.060
Validation loss decreased (-0.058790 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.6636254787445068
Epoch: 4, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.305 Vali Acc: 0.085 Test Loss: 3.305 Test Acc: 0.085
Validation loss decreased (-0.059967 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 0.6775758266448975
Epoch: 5, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.253 Vali Acc: 0.100 Test Loss: 3.253 Test Acc: 0.100
Validation loss decreased (-0.084673 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.688957691192627
Epoch: 6, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.213 Vali Acc: 0.116 Test Loss: 3.213 Test Acc: 0.116
Validation loss decreased (-0.099967 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.6682724952697754
Epoch: 7, Steps: 10 | Train Loss: 2.435 Vali Loss: 3.182 Vali Acc: 0.135 Test Loss: 3.182 Test Acc: 0.135
Validation loss decreased (-0.116438 --> -0.135262).  Saving model ...
Epoch: 8 cost time: 0.5508823394775391
Epoch: 8, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.240 Vali Acc: 0.166 Test Loss: 3.240 Test Acc: 0.166
Validation loss decreased (-0.135262 --> -0.165850).  Saving model ...
Epoch: 9 cost time: 0.6336445808410645
Epoch: 9, Steps: 10 | Train Loss: 1.569 Vali Loss: 3.384 Vali Acc: 0.182 Test Loss: 3.384 Test Acc: 0.182
Validation loss decreased (-0.165850 --> -0.182319).  Saving model ...
Epoch: 10 cost time: 0.6901850700378418
Epoch: 10, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.459 Vali Acc: 0.201 Test Loss: 3.459 Test Acc: 0.201
Validation loss decreased (-0.182319 --> -0.201142).  Saving model ...
Epoch: 11 cost time: 0.6651871204376221
Epoch: 11, Steps: 10 | Train Loss: 0.889 Vali Loss: 3.686 Vali Acc: 0.228 Test Loss: 3.686 Test Acc: 0.228
Validation loss decreased (-0.201142 --> -0.228198).  Saving model ...
Epoch: 12 cost time: 0.8033256530761719
Epoch: 12, Steps: 10 | Train Loss: 0.579 Vali Loss: 3.682 Vali Acc: 0.251 Test Loss: 3.682 Test Acc: 0.251
Validation loss decreased (-0.228198 --> -0.250551).  Saving model ...
Epoch: 13 cost time: 0.5977106094360352
Epoch: 13, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.904 Vali Acc: 0.265 Test Loss: 3.904 Test Acc: 0.265
Validation loss decreased (-0.250551 --> -0.264667).  Saving model ...
Epoch: 14 cost time: 0.7160959243774414
Epoch: 14, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.993 Vali Acc: 0.267 Test Loss: 3.993 Test Acc: 0.267
Validation loss decreased (-0.264667 --> -0.267019).  Saving model ...
Epoch: 15 cost time: 0.6920032501220703
Epoch: 15, Steps: 10 | Train Loss: 0.166 Vali Loss: 4.284 Vali Acc: 0.247 Test Loss: 4.284 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6643993854522705
Epoch: 16, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.259 Vali Acc: 0.280 Test Loss: 4.259 Test Acc: 0.280
Validation loss decreased (-0.267019 --> -0.279957).  Saving model ...
Epoch: 17 cost time: 0.6543669700622559
Epoch: 17, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.397 Vali Acc: 0.286 Test Loss: 4.397 Test Acc: 0.286
Validation loss decreased (-0.279957 --> -0.285838).  Saving model ...
Epoch: 18 cost time: 0.6629781723022461
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.459 Vali Acc: 0.274 Test Loss: 4.459 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7073967456817627
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.531 Vali Acc: 0.281 Test Loss: 4.531 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6321680545806885
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.577 Vali Acc: 0.293 Test Loss: 4.577 Test Acc: 0.293
Validation loss decreased (-0.285838 --> -0.292895).  Saving model ...
Epoch: 21 cost time: 0.6716444492340088
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.603 Vali Acc: 0.292 Test Loss: 4.603 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6094048023223877
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.634 Vali Acc: 0.288 Test Loss: 4.634 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6607246398925781
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.602 Vali Acc: 0.293 Test Loss: 4.602 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5289721488952637
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.655 Vali Acc: 0.298 Test Loss: 4.655 Test Acc: 0.298
Validation loss decreased (-0.292895 --> -0.297601).  Saving model ...
Epoch: 25 cost time: 0.7042758464813232
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.683 Vali Acc: 0.301 Test Loss: 4.683 Test Acc: 0.301
Validation loss decreased (-0.297601 --> -0.301130).  Saving model ...
Epoch: 26 cost time: 0.7229568958282471
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.718 Vali Acc: 0.304 Test Loss: 4.718 Test Acc: 0.304
Validation loss decreased (-0.301130 --> -0.303482).  Saving model ...
Epoch: 27 cost time: 0.6646769046783447
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.781 Vali Acc: 0.308 Test Loss: 4.781 Test Acc: 0.308
Validation loss decreased (-0.303482 --> -0.308187).  Saving model ...
Epoch: 28 cost time: 0.6481819152832031
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.825 Vali Acc: 0.307 Test Loss: 4.825 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6443006992340088
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.879 Vali Acc: 0.302 Test Loss: 4.879 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5364842414855957
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.888 Vali Acc: 0.302 Test Loss: 4.888 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.636070728302002
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.863 Vali Acc: 0.300 Test Loss: 4.863 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.656264066696167
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.898 Vali Acc: 0.300 Test Loss: 4.898 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6973249912261963
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.913 Vali Acc: 0.302 Test Loss: 4.913 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6845505237579346
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.912 Vali Acc: 0.308 Test Loss: 4.912 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6864452362060547
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.918 Vali Acc: 0.309 Test Loss: 4.918 Test Acc: 0.309
Validation loss decreased (-0.308187 --> -0.309363).  Saving model ...
Epoch: 36 cost time: 0.697188138961792
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.929 Vali Acc: 0.312 Test Loss: 4.929 Test Acc: 0.312
Validation loss decreased (-0.309363 --> -0.311715).  Saving model ...
Epoch: 37 cost time: 0.6716234683990479
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.952 Vali Acc: 0.314 Test Loss: 4.952 Test Acc: 0.314
Validation loss decreased (-0.311715 --> -0.314068).  Saving model ...
Epoch: 38 cost time: 0.7465558052062988
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.965 Vali Acc: 0.307 Test Loss: 4.965 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6335289478302002
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.988 Vali Acc: 0.311 Test Loss: 4.988 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6161460876464844
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.994 Vali Acc: 0.308 Test Loss: 4.994 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6556036472320557
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.975 Vali Acc: 0.307 Test Loss: 4.975 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6708669662475586
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.981 Vali Acc: 0.307 Test Loss: 4.981 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6396958827972412
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.030 Vali Acc: 0.308 Test Loss: 5.030 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7068161964416504
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.053 Vali Acc: 0.309 Test Loss: 5.053 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6352992057800293
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.061 Vali Acc: 0.313 Test Loss: 5.061 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6201691627502441
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.045 Vali Acc: 0.314 Test Loss: 5.045 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6420507431030273
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.040 Vali Acc: 0.320 Test Loss: 5.040 Test Acc: 0.320
Validation loss decreased (-0.314068 --> -0.319950).  Saving model ...
Epoch: 48 cost time: 0.6094341278076172
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.044 Vali Acc: 0.313 Test Loss: 5.044 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6210353374481201
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.056 Vali Acc: 0.311 Test Loss: 5.056 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6328561305999756
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.085 Vali Acc: 0.308 Test Loss: 5.085 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 36633626
model size : 154.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.368919849395752
Epoch: 1, Steps: 10 | Train Loss: 3.377 Vali Loss: 3.338 Vali Acc: 0.041 Test Loss: 3.338 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.0180084705352783
Epoch: 2, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.335 Vali Acc: 0.069 Test Loss: 3.335 Test Acc: 0.069
Validation loss decreased (-0.041143 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 1.1142034530639648
Epoch: 3, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.276 Vali Acc: 0.073 Test Loss: 3.276 Test Acc: 0.073
Validation loss decreased (-0.069378 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.9017288684844971
Epoch: 4, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.218 Vali Acc: 0.131 Test Loss: 3.218 Test Acc: 0.131
Validation loss decreased (-0.072908 --> -0.130556).  Saving model ...
Epoch: 5 cost time: 0.8404018878936768
Epoch: 5, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.195 Vali Acc: 0.171 Test Loss: 3.195 Test Acc: 0.171
Validation loss decreased (-0.130556 --> -0.170556).  Saving model ...
Epoch: 6 cost time: 0.8885478973388672
Epoch: 6, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.170 Vali Acc: 0.202 Test Loss: 3.170 Test Acc: 0.202
Validation loss decreased (-0.170556 --> -0.202321).  Saving model ...
Epoch: 7 cost time: 1.0983736515045166
Epoch: 7, Steps: 10 | Train Loss: 1.288 Vali Loss: 3.554 Vali Acc: 0.225 Test Loss: 3.554 Test Acc: 0.225
Validation loss decreased (-0.202321 --> -0.224670).  Saving model ...
Epoch: 8 cost time: 0.8326208591461182
Epoch: 8, Steps: 10 | Train Loss: 0.850 Vali Loss: 4.175 Vali Acc: 0.208 Test Loss: 4.175 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0067024230957031
Epoch: 9, Steps: 10 | Train Loss: 0.513 Vali Loss: 4.413 Vali Acc: 0.240 Test Loss: 4.413 Test Acc: 0.240
Validation loss decreased (-0.224670 --> -0.239956).  Saving model ...
Epoch: 10 cost time: 0.9227919578552246
Epoch: 10, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.555 Vali Acc: 0.273 Test Loss: 4.555 Test Acc: 0.273
Validation loss decreased (-0.239956 --> -0.272896).  Saving model ...
Epoch: 11 cost time: 0.9607217311859131
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.955 Vali Acc: 0.275 Test Loss: 4.955 Test Acc: 0.275
Validation loss decreased (-0.272896 --> -0.275245).  Saving model ...
Epoch: 12 cost time: 1.011486530303955
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 5.164 Vali Acc: 0.284 Test Loss: 5.164 Test Acc: 0.284
Validation loss decreased (-0.275245 --> -0.283478).  Saving model ...
Epoch: 13 cost time: 0.9347958564758301
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 5.268 Vali Acc: 0.289 Test Loss: 5.268 Test Acc: 0.289
Validation loss decreased (-0.283478 --> -0.289359).  Saving model ...
Epoch: 14 cost time: 0.9770817756652832
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 5.223 Vali Acc: 0.293 Test Loss: 5.223 Test Acc: 0.293
Validation loss decreased (-0.289359 --> -0.292889).  Saving model ...
Epoch: 15 cost time: 0.8755836486816406
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.570 Vali Acc: 0.287 Test Loss: 5.570 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9079082012176514
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.762 Vali Acc: 0.286 Test Loss: 5.762 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6464862823486328
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.529 Vali Acc: 0.311 Test Loss: 5.529 Test Acc: 0.311
Validation loss decreased (-0.292889 --> -0.310533).  Saving model ...
Epoch: 18 cost time: 0.7714481353759766
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.719 Vali Acc: 0.306 Test Loss: 5.719 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9137458801269531
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.840 Vali Acc: 0.296 Test Loss: 5.840 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9881947040557861
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.785 Vali Acc: 0.308 Test Loss: 5.785 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1392607688903809
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.800 Vali Acc: 0.304 Test Loss: 5.800 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9346306324005127
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.794 Vali Acc: 0.307 Test Loss: 5.794 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9822237491607666
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.819 Vali Acc: 0.312 Test Loss: 5.819 Test Acc: 0.312
Validation loss decreased (-0.310533 --> -0.311707).  Saving model ...
Epoch: 24 cost time: 0.8647074699401855
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.794 Vali Acc: 0.312 Test Loss: 5.794 Test Acc: 0.312
Validation loss decreased (-0.311707 --> -0.311707).  Saving model ...
Epoch: 25 cost time: 0.9202497005462646
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.735 Vali Acc: 0.319 Test Loss: 5.735 Test Acc: 0.319
Validation loss decreased (-0.311707 --> -0.318766).  Saving model ...
Epoch: 26 cost time: 0.9269330501556396
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.697 Vali Acc: 0.325 Test Loss: 5.697 Test Acc: 0.325
Validation loss decreased (-0.318766 --> -0.324649).  Saving model ...
Epoch: 27 cost time: 0.9917223453521729
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.689 Vali Acc: 0.328 Test Loss: 5.689 Test Acc: 0.328
Validation loss decreased (-0.324649 --> -0.328178).  Saving model ...
Epoch: 28 cost time: 0.873211145401001
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.685 Vali Acc: 0.325 Test Loss: 5.685 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9550871849060059
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.698 Vali Acc: 0.324 Test Loss: 5.698 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9896557331085205
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.729 Vali Acc: 0.319 Test Loss: 5.729 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9353272914886475
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.732 Vali Acc: 0.327 Test Loss: 5.732 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6811313629150391
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.739 Vali Acc: 0.327 Test Loss: 5.739 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6737616062164307
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.744 Vali Acc: 0.327 Test Loss: 5.744 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6670486927032471
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.750 Vali Acc: 0.320 Test Loss: 5.750 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6459560394287109
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.764 Vali Acc: 0.324 Test Loss: 5.764 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7668395042419434
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.789 Vali Acc: 0.326 Test Loss: 5.789 Test Acc: 0.326
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.808574914932251
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.816 Vali Acc: 0.324 Test Loss: 5.816 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 37156634
model size : 156.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.257857084274292
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.351 Vali Acc: 0.040 Test Loss: 3.351 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.8164138793945312
Epoch: 2, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.330 Vali Acc: 0.049 Test Loss: 3.330 Test Acc: 0.049
Validation loss decreased (-0.039966 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.7351131439208984
Epoch: 3, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.333 Vali Acc: 0.074 Test Loss: 3.333 Test Acc: 0.074
Validation loss decreased (-0.049378 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 0.7735304832458496
Epoch: 4, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.281 Vali Acc: 0.078 Test Loss: 3.281 Test Acc: 0.078
Validation loss decreased (-0.074084 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 0.6277894973754883
Epoch: 5, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.205 Vali Acc: 0.107 Test Loss: 3.205 Test Acc: 0.107
Validation loss decreased (-0.077614 --> -0.107027).  Saving model ...
Epoch: 6 cost time: 0.6916909217834473
Epoch: 6, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.180 Vali Acc: 0.138 Test Loss: 3.180 Test Acc: 0.138
Validation loss decreased (-0.107027 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 0.8216903209686279
Epoch: 7, Steps: 10 | Train Loss: 1.932 Vali Loss: 3.230 Vali Acc: 0.193 Test Loss: 3.230 Test Acc: 0.193
Validation loss decreased (-0.137615 --> -0.192909).  Saving model ...
Epoch: 8 cost time: 0.7117400169372559
Epoch: 8, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.440 Vali Acc: 0.201 Test Loss: 3.440 Test Acc: 0.201
Validation loss decreased (-0.192909 --> -0.201142).  Saving model ...
Epoch: 9 cost time: 0.7031457424163818
Epoch: 9, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.817 Vali Acc: 0.218 Test Loss: 3.817 Test Acc: 0.218
Validation loss decreased (-0.201142 --> -0.217609).  Saving model ...
Epoch: 10 cost time: 0.7958447933197021
Epoch: 10, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.966 Vali Acc: 0.244 Test Loss: 3.966 Test Acc: 0.244
Validation loss decreased (-0.217609 --> -0.243490).  Saving model ...
Epoch: 11 cost time: 0.665285587310791
Epoch: 11, Steps: 10 | Train Loss: 0.376 Vali Loss: 4.216 Vali Acc: 0.240 Test Loss: 4.216 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7304317951202393
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.357 Vali Acc: 0.260 Test Loss: 4.357 Test Acc: 0.260
Validation loss decreased (-0.243490 --> -0.259956).  Saving model ...
Epoch: 13 cost time: 0.512298583984375
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 4.510 Vali Acc: 0.264 Test Loss: 4.510 Test Acc: 0.264
Validation loss decreased (-0.259956 --> -0.263484).  Saving model ...
Epoch: 14 cost time: 0.6933417320251465
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.603 Vali Acc: 0.264 Test Loss: 4.603 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5482954978942871
Epoch: 15, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.648 Vali Acc: 0.291 Test Loss: 4.648 Test Acc: 0.291
Validation loss decreased (-0.263484 --> -0.290542).  Saving model ...
Epoch: 16 cost time: 0.8149125576019287
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.927 Vali Acc: 0.266 Test Loss: 4.927 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7505097389221191
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.944 Vali Acc: 0.280 Test Loss: 4.944 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8435139656066895
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.071 Vali Acc: 0.284 Test Loss: 5.071 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7535457611083984
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.172 Vali Acc: 0.291 Test Loss: 5.172 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7855985164642334
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.924 Vali Acc: 0.304 Test Loss: 4.924 Test Acc: 0.304
Validation loss decreased (-0.290542 --> -0.303480).  Saving model ...
Epoch: 21 cost time: 0.8113491535186768
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.126 Vali Acc: 0.276 Test Loss: 5.126 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.859745979309082
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.199 Vali Acc: 0.289 Test Loss: 5.199 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7729525566101074
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.174 Vali Acc: 0.295 Test Loss: 5.174 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7347426414489746
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.198 Vali Acc: 0.289 Test Loss: 5.198 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7945582866668701
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.156 Vali Acc: 0.291 Test Loss: 5.156 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7845196723937988
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.163 Vali Acc: 0.292 Test Loss: 5.163 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6808843612670898
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.190 Vali Acc: 0.291 Test Loss: 5.190 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8381009101867676
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.273 Vali Acc: 0.292 Test Loss: 5.273 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.04201340675354
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.289 Vali Acc: 0.292 Test Loss: 5.289 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7960536479949951
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.242 Vali Acc: 0.291 Test Loss: 5.242 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 36834074
model size : 155.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9131369590759277
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.325 Vali Acc: 0.049 Test Loss: 3.325 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.6634161472320557
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.295 Vali Acc: 0.055 Test Loss: 3.295 Test Acc: 0.055
Validation loss decreased (-0.049379 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.66292405128479
Epoch: 3, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.320 Vali Acc: 0.071 Test Loss: 3.320 Test Acc: 0.071
Validation loss decreased (-0.055261 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.6795496940612793
Epoch: 4, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.306 Vali Acc: 0.076 Test Loss: 3.306 Test Acc: 0.076
Validation loss decreased (-0.070555 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 0.6976666450500488
Epoch: 5, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.271 Vali Acc: 0.102 Test Loss: 3.271 Test Acc: 0.102
Validation loss decreased (-0.076438 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 0.6920959949493408
Epoch: 6, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.236 Vali Acc: 0.101 Test Loss: 3.236 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.581002950668335
Epoch: 7, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.180 Vali Acc: 0.134 Test Loss: 3.180 Test Acc: 0.134
Validation loss decreased (-0.102320 --> -0.134086).  Saving model ...
Epoch: 8 cost time: 0.5916638374328613
Epoch: 8, Steps: 10 | Train Loss: 2.020 Vali Loss: 3.196 Vali Acc: 0.167 Test Loss: 3.196 Test Acc: 0.167
Validation loss decreased (-0.134086 --> -0.167027).  Saving model ...
Epoch: 9 cost time: 0.6746339797973633
Epoch: 9, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.347 Vali Acc: 0.194 Test Loss: 3.347 Test Acc: 0.194
Validation loss decreased (-0.167027 --> -0.194084).  Saving model ...
Epoch: 10 cost time: 0.4915022850036621
Epoch: 10, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.468 Vali Acc: 0.186 Test Loss: 3.468 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4862966537475586
Epoch: 11, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.586 Vali Acc: 0.222 Test Loss: 3.586 Test Acc: 0.222
Validation loss decreased (-0.194084 --> -0.222317).  Saving model ...
Epoch: 12 cost time: 0.590278148651123
Epoch: 12, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.648 Vali Acc: 0.226 Test Loss: 3.648 Test Acc: 0.226
Validation loss decreased (-0.222317 --> -0.225846).  Saving model ...
Epoch: 13 cost time: 0.584813117980957
Epoch: 13, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.738 Vali Acc: 0.236 Test Loss: 3.738 Test Acc: 0.236
Validation loss decreased (-0.225846 --> -0.236433).  Saving model ...
Epoch: 14 cost time: 0.5866637229919434
Epoch: 14, Steps: 10 | Train Loss: 0.323 Vali Loss: 4.005 Vali Acc: 0.239 Test Loss: 4.005 Test Acc: 0.239
Validation loss decreased (-0.236433 --> -0.238783).  Saving model ...
Epoch: 15 cost time: 0.57521653175354
Epoch: 15, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.942 Vali Acc: 0.259 Test Loss: 3.942 Test Acc: 0.259
Validation loss decreased (-0.238783 --> -0.258784).  Saving model ...
Epoch: 16 cost time: 0.5646464824676514
Epoch: 16, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.164 Vali Acc: 0.266 Test Loss: 4.164 Test Acc: 0.266
Validation loss decreased (-0.258784 --> -0.265841).  Saving model ...
Epoch: 17 cost time: 0.6107070446014404
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.253 Vali Acc: 0.269 Test Loss: 4.253 Test Acc: 0.269
Validation loss decreased (-0.265841 --> -0.269369).  Saving model ...
Epoch: 18 cost time: 0.6403284072875977
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.234 Vali Acc: 0.281 Test Loss: 4.234 Test Acc: 0.281
Validation loss decreased (-0.269369 --> -0.281134).  Saving model ...
Epoch: 19 cost time: 0.6797938346862793
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.363 Vali Acc: 0.274 Test Loss: 4.363 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5457401275634766
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.475 Vali Acc: 0.274 Test Loss: 4.475 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5961344242095947
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.417 Vali Acc: 0.282 Test Loss: 4.417 Test Acc: 0.282
Validation loss decreased (-0.281134 --> -0.282309).  Saving model ...
Epoch: 22 cost time: 0.6383028030395508
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.472 Vali Acc: 0.288 Test Loss: 4.472 Test Acc: 0.288
Validation loss decreased (-0.282309 --> -0.288191).  Saving model ...
Epoch: 23 cost time: 0.6557061672210693
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.624 Vali Acc: 0.282 Test Loss: 4.624 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6595466136932373
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.613 Vali Acc: 0.285 Test Loss: 4.613 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5824358463287354
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.579 Vali Acc: 0.296 Test Loss: 4.579 Test Acc: 0.296
Validation loss decreased (-0.288191 --> -0.296425).  Saving model ...
Epoch: 26 cost time: 0.5488090515136719
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.553 Vali Acc: 0.298 Test Loss: 4.553 Test Acc: 0.298
Validation loss decreased (-0.296425 --> -0.297602).  Saving model ...
Epoch: 27 cost time: 0.6399431228637695
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.602 Vali Acc: 0.292 Test Loss: 4.602 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6014890670776367
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.673 Vali Acc: 0.282 Test Loss: 4.673 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6773018836975098
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.658 Vali Acc: 0.288 Test Loss: 4.658 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6030194759368896
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.684 Vali Acc: 0.286 Test Loss: 4.684 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5977687835693359
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.707 Vali Acc: 0.289 Test Loss: 4.707 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5000612735748291
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.725 Vali Acc: 0.296 Test Loss: 4.725 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.587827205657959
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.772 Vali Acc: 0.293 Test Loss: 4.772 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5251402854919434
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.779 Vali Acc: 0.294 Test Loss: 4.779 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5574662685394287
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.776 Vali Acc: 0.295 Test Loss: 4.776 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5324070453643799
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.807 Vali Acc: 0.292 Test Loss: 4.807 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 36619034
model size : 154.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1297218799591064
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.334 Vali Acc: 0.040 Test Loss: 3.334 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.7799532413482666
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.385 Vali Acc: 0.091 Test Loss: 3.385 Test Acc: 0.091
Validation loss decreased (-0.039967 --> -0.090554).  Saving model ...
Epoch: 3 cost time: 0.8196005821228027
Epoch: 3, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.317 Vali Acc: 0.102 Test Loss: 3.317 Test Acc: 0.102
Validation loss decreased (-0.090554 --> -0.102320).  Saving model ...
Epoch: 4 cost time: 0.7950003147125244
Epoch: 4, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.176 Vali Acc: 0.148 Test Loss: 3.176 Test Acc: 0.148
Validation loss decreased (-0.102320 --> -0.148204).  Saving model ...
Epoch: 5 cost time: 1.166745662689209
Epoch: 5, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.173 Vali Acc: 0.189 Test Loss: 3.173 Test Acc: 0.189
Validation loss decreased (-0.148204 --> -0.189380).  Saving model ...
Epoch: 6 cost time: 0.8908472061157227
Epoch: 6, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.223 Vali Acc: 0.201 Test Loss: 3.223 Test Acc: 0.201
Validation loss decreased (-0.189380 --> -0.201144).  Saving model ...
Epoch: 7 cost time: 0.8853006362915039
Epoch: 7, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.487 Vali Acc: 0.216 Test Loss: 3.487 Test Acc: 0.216
Validation loss decreased (-0.201144 --> -0.216436).  Saving model ...
Epoch: 8 cost time: 0.5816941261291504
Epoch: 8, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.860 Vali Acc: 0.234 Test Loss: 3.860 Test Acc: 0.234
Validation loss decreased (-0.216436 --> -0.234079).  Saving model ...
Epoch: 9 cost time: 0.6472232341766357
Epoch: 9, Steps: 10 | Train Loss: 0.509 Vali Loss: 4.381 Vali Acc: 0.239 Test Loss: 4.381 Test Acc: 0.239
Validation loss decreased (-0.234079 --> -0.238780).  Saving model ...
Epoch: 10 cost time: 0.5953571796417236
Epoch: 10, Steps: 10 | Train Loss: 0.231 Vali Loss: 4.429 Vali Acc: 0.275 Test Loss: 4.429 Test Acc: 0.275
Validation loss decreased (-0.238780 --> -0.275250).  Saving model ...
Epoch: 11 cost time: 0.5919411182403564
Epoch: 11, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.989 Vali Acc: 0.281 Test Loss: 4.989 Test Acc: 0.281
Validation loss decreased (-0.275250 --> -0.281127).  Saving model ...
Epoch: 12 cost time: 0.8142850399017334
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.388 Vali Acc: 0.262 Test Loss: 5.388 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.707791805267334
Epoch: 13, Steps: 10 | Train Loss: 0.095 Vali Loss: 5.378 Vali Acc: 0.294 Test Loss: 5.378 Test Acc: 0.294
Validation loss decreased (-0.281127 --> -0.294064).  Saving model ...
Epoch: 14 cost time: 0.7894055843353271
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.319 Vali Acc: 0.274 Test Loss: 5.319 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7186274528503418
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.573 Vali Acc: 0.294 Test Loss: 5.573 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5891602039337158
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.560 Vali Acc: 0.304 Test Loss: 5.560 Test Acc: 0.304
Validation loss decreased (-0.294064 --> -0.303474).  Saving model ...
Epoch: 17 cost time: 0.810795783996582
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.476 Vali Acc: 0.307 Test Loss: 5.476 Test Acc: 0.307
Validation loss decreased (-0.303474 --> -0.307004).  Saving model ...
Epoch: 18 cost time: 0.6796767711639404
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.533 Vali Acc: 0.311 Test Loss: 5.533 Test Acc: 0.311
Validation loss decreased (-0.307004 --> -0.310533).  Saving model ...
Epoch: 19 cost time: 0.6671080589294434
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.792 Vali Acc: 0.304 Test Loss: 5.792 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9139156341552734
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.781 Vali Acc: 0.287 Test Loss: 5.781 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8736696243286133
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.879 Vali Acc: 0.300 Test Loss: 5.879 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6454038619995117
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.937 Vali Acc: 0.308 Test Loss: 5.937 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8247566223144531
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 6.196 Vali Acc: 0.311 Test Loss: 6.196 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7917680740356445
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.176 Vali Acc: 0.299 Test Loss: 6.176 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9210898876190186
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.265 Vali Acc: 0.304 Test Loss: 6.265 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.787736177444458
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.186 Vali Acc: 0.307 Test Loss: 6.186 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7361865043640137
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.209 Vali Acc: 0.315 Test Loss: 6.209 Test Acc: 0.315
Validation loss decreased (-0.310533 --> -0.315232).  Saving model ...
Epoch: 28 cost time: 0.6342787742614746
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.205 Vali Acc: 0.312 Test Loss: 6.205 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7433221340179443
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.137 Vali Acc: 0.318 Test Loss: 6.137 Test Acc: 0.318
Validation loss decreased (-0.315232 --> -0.317586).  Saving model ...
Epoch: 30 cost time: 0.7439634799957275
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.367 Vali Acc: 0.295 Test Loss: 6.367 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6676990985870361
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.450 Vali Acc: 0.295 Test Loss: 6.450 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9307420253753662
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.347 Vali Acc: 0.305 Test Loss: 6.347 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.986365795135498
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.230 Vali Acc: 0.312 Test Loss: 6.230 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.745516300201416
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.235 Vali Acc: 0.312 Test Loss: 6.235 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7418005466461182
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.242 Vali Acc: 0.312 Test Loss: 6.242 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6702678203582764
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.235 Vali Acc: 0.309 Test Loss: 6.235 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7994632720947266
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.233 Vali Acc: 0.309 Test Loss: 6.233 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7575879096984863
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.237 Vali Acc: 0.309 Test Loss: 6.237 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8455038070678711
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.241 Vali Acc: 0.308 Test Loss: 6.241 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 37170458
model size : 156.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3943893909454346
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.335 Vali Acc: 0.042 Test Loss: 3.335 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.9976677894592285
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.360 Vali Acc: 0.059 Test Loss: 3.360 Test Acc: 0.059
Validation loss decreased (-0.042320 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.6840922832489014
Epoch: 3, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.333 Vali Acc: 0.082 Test Loss: 3.333 Test Acc: 0.082
Validation loss decreased (-0.058790 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 0.7282295227050781
Epoch: 4, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.275 Vali Acc: 0.106 Test Loss: 3.275 Test Acc: 0.106
Validation loss decreased (-0.082320 --> -0.105850).  Saving model ...
Epoch: 5 cost time: 0.7168183326721191
Epoch: 5, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.230 Vali Acc: 0.118 Test Loss: 3.230 Test Acc: 0.118
Validation loss decreased (-0.105850 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 0.6665666103363037
Epoch: 6, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.178 Vali Acc: 0.154 Test Loss: 3.178 Test Acc: 0.154
Validation loss decreased (-0.117615 --> -0.154086).  Saving model ...
Epoch: 7 cost time: 0.8005530834197998
Epoch: 7, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.174 Vali Acc: 0.172 Test Loss: 3.174 Test Acc: 0.172
Validation loss decreased (-0.154086 --> -0.171733).  Saving model ...
Epoch: 8 cost time: 0.7365548610687256
Epoch: 8, Steps: 10 | Train Loss: 1.522 Vali Loss: 3.398 Vali Acc: 0.212 Test Loss: 3.398 Test Acc: 0.212
Validation loss decreased (-0.171733 --> -0.211731).  Saving model ...
Epoch: 9 cost time: 0.6529695987701416
Epoch: 9, Steps: 10 | Train Loss: 1.167 Vali Loss: 3.544 Vali Acc: 0.239 Test Loss: 3.544 Test Acc: 0.239
Validation loss decreased (-0.211731 --> -0.238788).  Saving model ...
Epoch: 10 cost time: 0.6545825004577637
Epoch: 10, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.870 Vali Acc: 0.262 Test Loss: 3.870 Test Acc: 0.262
Validation loss decreased (-0.238788 --> -0.262314).  Saving model ...
Epoch: 11 cost time: 0.6557111740112305
Epoch: 11, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.884 Vali Acc: 0.274 Test Loss: 3.884 Test Acc: 0.274
Validation loss decreased (-0.262314 --> -0.274079).  Saving model ...
Epoch: 12 cost time: 0.6314036846160889
Epoch: 12, Steps: 10 | Train Loss: 0.296 Vali Loss: 4.225 Vali Acc: 0.262 Test Loss: 4.225 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5928828716278076
Epoch: 13, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.312 Vali Acc: 0.276 Test Loss: 4.312 Test Acc: 0.276
Validation loss decreased (-0.274079 --> -0.276427).  Saving model ...
Epoch: 14 cost time: 0.7069716453552246
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.474 Vali Acc: 0.275 Test Loss: 4.474 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7494492530822754
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.631 Vali Acc: 0.292 Test Loss: 4.631 Test Acc: 0.292
Validation loss decreased (-0.276427 --> -0.291718).  Saving model ...
Epoch: 16 cost time: 0.865450382232666
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.786 Vali Acc: 0.293 Test Loss: 4.786 Test Acc: 0.293
Validation loss decreased (-0.291718 --> -0.292893).  Saving model ...
Epoch: 17 cost time: 0.7594456672668457
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.796 Vali Acc: 0.307 Test Loss: 4.796 Test Acc: 0.307
Validation loss decreased (-0.292893 --> -0.307011).  Saving model ...
Epoch: 18 cost time: 0.989823579788208
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.851 Vali Acc: 0.291 Test Loss: 4.851 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6231575012207031
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.952 Vali Acc: 0.296 Test Loss: 4.952 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7015213966369629
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.076 Vali Acc: 0.291 Test Loss: 5.076 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7284121513366699
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.041 Vali Acc: 0.298 Test Loss: 5.041 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6702859401702881
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.073 Vali Acc: 0.287 Test Loss: 5.073 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7100648880004883
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.995 Vali Acc: 0.302 Test Loss: 4.995 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6579747200012207
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.108 Vali Acc: 0.300 Test Loss: 5.108 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5021209716796875
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.101 Vali Acc: 0.302 Test Loss: 5.101 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6052963733673096
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.069 Vali Acc: 0.309 Test Loss: 5.069 Test Acc: 0.309
Validation loss decreased (-0.307011 --> -0.309361).  Saving model ...
Epoch: 27 cost time: 0.6584539413452148
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.066 Vali Acc: 0.305 Test Loss: 5.066 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.904177188873291
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.094 Vali Acc: 0.306 Test Loss: 5.094 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7007505893707275
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.102 Vali Acc: 0.309 Test Loss: 5.102 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6327521800994873
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.100 Vali Acc: 0.304 Test Loss: 5.100 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9047286510467529
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.107 Vali Acc: 0.312 Test Loss: 5.107 Test Acc: 0.312
Validation loss decreased (-0.309361 --> -0.311714).  Saving model ...
Epoch: 32 cost time: 0.6844668388366699
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.133 Vali Acc: 0.313 Test Loss: 5.133 Test Acc: 0.313
Validation loss decreased (-0.311714 --> -0.312890).  Saving model ...
Epoch: 33 cost time: 0.6786677837371826
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.173 Vali Acc: 0.305 Test Loss: 5.173 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6647512912750244
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.190 Vali Acc: 0.313 Test Loss: 5.190 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6773815155029297
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.271 Vali Acc: 0.308 Test Loss: 5.271 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6983902454376221
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.290 Vali Acc: 0.307 Test Loss: 5.290 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7708406448364258
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.312 Vali Acc: 0.307 Test Loss: 5.312 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7794017791748047
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.294 Vali Acc: 0.305 Test Loss: 5.294 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6968696117401123
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.290 Vali Acc: 0.304 Test Loss: 5.290 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8609058856964111
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.293 Vali Acc: 0.307 Test Loss: 5.293 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6498198509216309
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.299 Vali Acc: 0.302 Test Loss: 5.299 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2571005821228027
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.316 Vali Acc: 0.304 Test Loss: 5.316 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 36804890
model size : 155.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.132277727127075
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.394 Vali Acc: 0.049 Test Loss: 3.394 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.8079924583435059
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.332 Vali Acc: 0.041 Test Loss: 3.332 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5181243419647217
Epoch: 3, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.301 Vali Acc: 0.058 Test Loss: 3.301 Test Acc: 0.058
Validation loss decreased (-0.049378 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.649857759475708
Epoch: 4, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.283 Vali Acc: 0.066 Test Loss: 3.283 Test Acc: 0.066
Validation loss decreased (-0.057614 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 0.7155563831329346
Epoch: 5, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.273 Vali Acc: 0.095 Test Loss: 3.273 Test Acc: 0.095
Validation loss decreased (-0.065850 --> -0.095261).  Saving model ...
Epoch: 6 cost time: 0.8533062934875488
Epoch: 6, Steps: 10 | Train Loss: 2.778 Vali Loss: 3.247 Vali Acc: 0.118 Test Loss: 3.247 Test Acc: 0.118
Validation loss decreased (-0.095261 --> -0.117615).  Saving model ...
Epoch: 7 cost time: 0.9527313709259033
Epoch: 7, Steps: 10 | Train Loss: 2.516 Vali Loss: 3.182 Vali Acc: 0.135 Test Loss: 3.182 Test Acc: 0.135
Validation loss decreased (-0.117615 --> -0.135262).  Saving model ...
Epoch: 8 cost time: 0.685462474822998
Epoch: 8, Steps: 10 | Train Loss: 2.202 Vali Loss: 3.168 Vali Acc: 0.174 Test Loss: 3.168 Test Acc: 0.174
Validation loss decreased (-0.135262 --> -0.174086).  Saving model ...
Epoch: 9 cost time: 0.8164489269256592
Epoch: 9, Steps: 10 | Train Loss: 1.779 Vali Loss: 3.269 Vali Acc: 0.175 Test Loss: 3.269 Test Acc: 0.175
Validation loss decreased (-0.174086 --> -0.175261).  Saving model ...
Epoch: 10 cost time: 0.7904009819030762
Epoch: 10, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.364 Vali Acc: 0.202 Test Loss: 3.364 Test Acc: 0.202
Validation loss decreased (-0.175261 --> -0.202319).  Saving model ...
Epoch: 11 cost time: 0.6842103004455566
Epoch: 11, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.486 Vali Acc: 0.207 Test Loss: 3.486 Test Acc: 0.207
Validation loss decreased (-0.202319 --> -0.207024).  Saving model ...
Epoch: 12 cost time: 0.64125657081604
Epoch: 12, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.591 Vali Acc: 0.227 Test Loss: 3.591 Test Acc: 0.227
Validation loss decreased (-0.207024 --> -0.227023).  Saving model ...
Epoch: 13 cost time: 0.6246368885040283
Epoch: 13, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.704 Vali Acc: 0.231 Test Loss: 3.704 Test Acc: 0.231
Validation loss decreased (-0.227023 --> -0.230551).  Saving model ...
Epoch: 14 cost time: 0.577601432800293
Epoch: 14, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.740 Vali Acc: 0.253 Test Loss: 3.740 Test Acc: 0.253
Validation loss decreased (-0.230551 --> -0.252904).  Saving model ...
Epoch: 15 cost time: 0.6506097316741943
Epoch: 15, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.861 Vali Acc: 0.262 Test Loss: 3.861 Test Acc: 0.262
Validation loss decreased (-0.252904 --> -0.262314).  Saving model ...
Epoch: 16 cost time: 0.8226151466369629
Epoch: 16, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.024 Vali Acc: 0.264 Test Loss: 4.024 Test Acc: 0.264
Validation loss decreased (-0.262314 --> -0.263489).  Saving model ...
Epoch: 17 cost time: 0.6312434673309326
Epoch: 17, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.108 Vali Acc: 0.276 Test Loss: 4.108 Test Acc: 0.276
Validation loss decreased (-0.263489 --> -0.276430).  Saving model ...
Epoch: 18 cost time: 0.703782320022583
Epoch: 18, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.234 Vali Acc: 0.276 Test Loss: 4.234 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6586301326751709
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.287 Vali Acc: 0.268 Test Loss: 4.287 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7903127670288086
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.422 Vali Acc: 0.264 Test Loss: 4.422 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9319190979003906
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.347 Vali Acc: 0.280 Test Loss: 4.347 Test Acc: 0.280
Validation loss decreased (-0.276430 --> -0.279957).  Saving model ...
Epoch: 22 cost time: 0.9651973247528076
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.410 Vali Acc: 0.280 Test Loss: 4.410 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7844252586364746
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.396 Vali Acc: 0.285 Test Loss: 4.396 Test Acc: 0.285
Validation loss decreased (-0.279957 --> -0.284662).  Saving model ...
Epoch: 24 cost time: 0.8599746227264404
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.465 Vali Acc: 0.284 Test Loss: 4.465 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8866176605224609
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.500 Vali Acc: 0.286 Test Loss: 4.500 Test Acc: 0.286
Validation loss decreased (-0.284662 --> -0.285837).  Saving model ...
Epoch: 26 cost time: 0.7740814685821533
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.460 Vali Acc: 0.302 Test Loss: 4.460 Test Acc: 0.302
Validation loss decreased (-0.285837 --> -0.302308).  Saving model ...
Epoch: 27 cost time: 0.6396334171295166
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.475 Vali Acc: 0.304 Test Loss: 4.475 Test Acc: 0.304
Validation loss decreased (-0.302308 --> -0.303485).  Saving model ...
Epoch: 28 cost time: 0.7358911037445068
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.520 Vali Acc: 0.304 Test Loss: 4.520 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.609316349029541
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.584 Vali Acc: 0.302 Test Loss: 4.584 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5679135322570801
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.584 Vali Acc: 0.296 Test Loss: 4.584 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6342203617095947
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.594 Vali Acc: 0.298 Test Loss: 4.594 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6218454837799072
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.620 Vali Acc: 0.292 Test Loss: 4.620 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6428797245025635
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.647 Vali Acc: 0.292 Test Loss: 4.647 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5538554191589355
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.648 Vali Acc: 0.288 Test Loss: 4.648 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.575772762298584
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.659 Vali Acc: 0.291 Test Loss: 4.659 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7928593158721924
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.674 Vali Acc: 0.294 Test Loss: 4.674 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6765952110290527
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.692 Vali Acc: 0.289 Test Loss: 4.692 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 36611354
model size : 154.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.405181884765625
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.294 Vali Acc: 0.042 Test Loss: 3.294 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.1359007358551025
Epoch: 2, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.406 Vali Acc: 0.076 Test Loss: 3.406 Test Acc: 0.076
Validation loss decreased (-0.042320 --> -0.076437).  Saving model ...
Epoch: 3 cost time: 0.7967891693115234
Epoch: 3, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.316 Vali Acc: 0.073 Test Loss: 3.316 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8761351108551025
Epoch: 4, Steps: 10 | Train Loss: 2.799 Vali Loss: 3.227 Vali Acc: 0.115 Test Loss: 3.227 Test Acc: 0.115
Validation loss decreased (-0.076437 --> -0.115262).  Saving model ...
Epoch: 5 cost time: 0.982579231262207
Epoch: 5, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.187 Vali Acc: 0.145 Test Loss: 3.187 Test Acc: 0.145
Validation loss decreased (-0.115262 --> -0.144674).  Saving model ...
Epoch: 6 cost time: 1.2517988681793213
Epoch: 6, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.302 Vali Acc: 0.191 Test Loss: 3.302 Test Acc: 0.191
Validation loss decreased (-0.144674 --> -0.190555).  Saving model ...
Epoch: 7 cost time: 0.8182470798492432
Epoch: 7, Steps: 10 | Train Loss: 1.357 Vali Loss: 3.586 Vali Acc: 0.191 Test Loss: 3.586 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9177901744842529
Epoch: 8, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.693 Vali Acc: 0.231 Test Loss: 3.693 Test Acc: 0.231
Validation loss decreased (-0.190555 --> -0.230551).  Saving model ...
Epoch: 9 cost time: 0.6550383567810059
Epoch: 9, Steps: 10 | Train Loss: 0.486 Vali Loss: 4.012 Vali Acc: 0.248 Test Loss: 4.012 Test Acc: 0.248
Validation loss decreased (-0.230551 --> -0.248195).  Saving model ...
Epoch: 10 cost time: 1.1130001544952393
Epoch: 10, Steps: 10 | Train Loss: 0.244 Vali Loss: 4.179 Vali Acc: 0.271 Test Loss: 4.179 Test Acc: 0.271
Validation loss decreased (-0.248195 --> -0.270546).  Saving model ...
Epoch: 11 cost time: 1.2428584098815918
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.557 Vali Acc: 0.254 Test Loss: 4.557 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7992072105407715
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.688 Vali Acc: 0.267 Test Loss: 4.688 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9529495239257812
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.733 Vali Acc: 0.286 Test Loss: 4.733 Test Acc: 0.286
Validation loss decreased (-0.270546 --> -0.285835).  Saving model ...
Epoch: 14 cost time: 1.2575936317443848
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.952 Vali Acc: 0.280 Test Loss: 4.952 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7935218811035156
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.095 Vali Acc: 0.275 Test Loss: 5.095 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0707614421844482
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.484 Vali Acc: 0.265 Test Loss: 5.484 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6896262168884277
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.251 Vali Acc: 0.274 Test Loss: 5.251 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0552361011505127
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.130 Vali Acc: 0.276 Test Loss: 5.130 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3041515350341797
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.175 Vali Acc: 0.285 Test Loss: 5.175 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4629878997802734
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.140 Vali Acc: 0.285 Test Loss: 5.140 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7570803165435791
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.144 Vali Acc: 0.288 Test Loss: 5.144 Test Acc: 0.288
Validation loss decreased (-0.285835 --> -0.288184).  Saving model ...
Epoch: 22 cost time: 0.9457008838653564
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.311 Vali Acc: 0.287 Test Loss: 5.311 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2076971530914307
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.321 Vali Acc: 0.289 Test Loss: 5.321 Test Acc: 0.289
Validation loss decreased (-0.288184 --> -0.289359).  Saving model ...
Epoch: 24 cost time: 1.0142974853515625
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.369 Vali Acc: 0.287 Test Loss: 5.369 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.952415943145752
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.452 Vali Acc: 0.285 Test Loss: 5.452 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2871789932250977
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.481 Vali Acc: 0.278 Test Loss: 5.481 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3456730842590332
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.527 Vali Acc: 0.291 Test Loss: 5.527 Test Acc: 0.291
Validation loss decreased (-0.289359 --> -0.290533).  Saving model ...
Epoch: 28 cost time: 0.9833934307098389
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.571 Vali Acc: 0.282 Test Loss: 5.571 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8025624752044678
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.517 Vali Acc: 0.294 Test Loss: 5.517 Test Acc: 0.294
Validation loss decreased (-0.290533 --> -0.294062).  Saving model ...
Epoch: 30 cost time: 0.9804916381835938
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.527 Vali Acc: 0.285 Test Loss: 5.527 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0743613243103027
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.675 Vali Acc: 0.285 Test Loss: 5.675 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.364436149597168
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.667 Vali Acc: 0.282 Test Loss: 5.667 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1607890129089355
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.799 Vali Acc: 0.293 Test Loss: 5.799 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0412349700927734
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.735 Vali Acc: 0.288 Test Loss: 5.735 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.103916883468628
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.838 Vali Acc: 0.280 Test Loss: 5.838 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1755850315093994
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.764 Vali Acc: 0.287 Test Loss: 5.764 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3964660167694092
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.743 Vali Acc: 0.289 Test Loss: 5.743 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0520095825195312
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.806 Vali Acc: 0.294 Test Loss: 5.806 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0150659084320068
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.841 Vali Acc: 0.296 Test Loss: 5.841 Test Acc: 0.296
Validation loss decreased (-0.294062 --> -0.296412).  Saving model ...
Epoch: 40 cost time: 0.8802199363708496
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.850 Vali Acc: 0.296 Test Loss: 5.850 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8396756649017334
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.818 Vali Acc: 0.301 Test Loss: 5.818 Test Acc: 0.301
Validation loss decreased (-0.296412 --> -0.301118).  Saving model ...
Epoch: 42 cost time: 1.2812583446502686
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.780 Vali Acc: 0.304 Test Loss: 5.780 Test Acc: 0.304
Validation loss decreased (-0.301118 --> -0.303472).  Saving model ...
Epoch: 43 cost time: 0.9209482669830322
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.807 Vali Acc: 0.293 Test Loss: 5.807 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9556589126586914
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.841 Vali Acc: 0.296 Test Loss: 5.841 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.172661542892456
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.818 Vali Acc: 0.300 Test Loss: 5.818 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8760678768157959
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.870 Vali Acc: 0.287 Test Loss: 5.870 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.100128173828125
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.850 Vali Acc: 0.293 Test Loss: 5.850 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2994160652160645
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.848 Vali Acc: 0.301 Test Loss: 5.848 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1437036991119385
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.855 Vali Acc: 0.304 Test Loss: 5.855 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8781225681304932
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.864 Vali Acc: 0.304 Test Loss: 5.864 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 37026842
model size : 155.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0888047218322754
Epoch: 1, Steps: 10 | Train Loss: 3.364 Vali Loss: 3.319 Vali Acc: 0.036 Test Loss: 3.319 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.849360466003418
Epoch: 2, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.340 Vali Acc: 0.054 Test Loss: 3.340 Test Acc: 0.054
Validation loss decreased (-0.036437 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 1.0915770530700684
Epoch: 3, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.345 Vali Acc: 0.082 Test Loss: 3.345 Test Acc: 0.082
Validation loss decreased (-0.054084 --> -0.082319).  Saving model ...
Epoch: 4 cost time: 0.9269406795501709
Epoch: 4, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.268 Vali Acc: 0.091 Test Loss: 3.268 Test Acc: 0.091
Validation loss decreased (-0.082319 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 0.8832151889801025
Epoch: 5, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.250 Vali Acc: 0.104 Test Loss: 3.250 Test Acc: 0.104
Validation loss decreased (-0.090556 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.8713095188140869
Epoch: 6, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.167 Vali Acc: 0.152 Test Loss: 3.167 Test Acc: 0.152
Validation loss decreased (-0.103497 --> -0.151733).  Saving model ...
Epoch: 7 cost time: 0.9612581729888916
Epoch: 7, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.215 Vali Acc: 0.181 Test Loss: 3.215 Test Acc: 0.181
Validation loss decreased (-0.151733 --> -0.181144).  Saving model ...
Epoch: 8 cost time: 1.1373693943023682
Epoch: 8, Steps: 10 | Train Loss: 1.643 Vali Loss: 3.281 Vali Acc: 0.194 Test Loss: 3.281 Test Acc: 0.194
Validation loss decreased (-0.181144 --> -0.194085).  Saving model ...
Epoch: 9 cost time: 0.8608129024505615
Epoch: 9, Steps: 10 | Train Loss: 1.108 Vali Loss: 3.523 Vali Acc: 0.229 Test Loss: 3.523 Test Acc: 0.229
Validation loss decreased (-0.194085 --> -0.229377).  Saving model ...
Epoch: 10 cost time: 0.8811919689178467
Epoch: 10, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.748 Vali Acc: 0.238 Test Loss: 3.748 Test Acc: 0.238
Validation loss decreased (-0.229377 --> -0.237610).  Saving model ...
Epoch: 11 cost time: 1.036203384399414
Epoch: 11, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.789 Vali Acc: 0.251 Test Loss: 3.789 Test Acc: 0.251
Validation loss decreased (-0.237610 --> -0.250550).  Saving model ...
Epoch: 12 cost time: 0.8261086940765381
Epoch: 12, Steps: 10 | Train Loss: 0.278 Vali Loss: 4.046 Vali Acc: 0.261 Test Loss: 4.046 Test Acc: 0.261
Validation loss decreased (-0.250550 --> -0.261136).  Saving model ...
Epoch: 13 cost time: 0.9060983657836914
Epoch: 13, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.159 Vali Acc: 0.269 Test Loss: 4.159 Test Acc: 0.269
Validation loss decreased (-0.261136 --> -0.269370).  Saving model ...
Epoch: 14 cost time: 0.9278740882873535
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.456 Vali Acc: 0.271 Test Loss: 4.456 Test Acc: 0.271
Validation loss decreased (-0.269370 --> -0.270544).  Saving model ...
Epoch: 15 cost time: 0.9059967994689941
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.514 Vali Acc: 0.266 Test Loss: 4.514 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9578680992126465
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.635 Vali Acc: 0.266 Test Loss: 4.635 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1970324516296387
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.710 Vali Acc: 0.272 Test Loss: 4.710 Test Acc: 0.272
Validation loss decreased (-0.270544 --> -0.271718).  Saving model ...
Epoch: 18 cost time: 1.1180694103240967
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.765 Vali Acc: 0.284 Test Loss: 4.765 Test Acc: 0.284
Validation loss decreased (-0.271718 --> -0.283482).  Saving model ...
Epoch: 19 cost time: 1.1015558242797852
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.840 Vali Acc: 0.265 Test Loss: 4.840 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0885095596313477
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.828 Vali Acc: 0.282 Test Loss: 4.828 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9853270053863525
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.836 Vali Acc: 0.293 Test Loss: 4.836 Test Acc: 0.293
Validation loss decreased (-0.283482 --> -0.292893).  Saving model ...
Epoch: 22 cost time: 0.8724160194396973
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.905 Vali Acc: 0.295 Test Loss: 4.905 Test Acc: 0.295
Validation loss decreased (-0.292893 --> -0.295245).  Saving model ...
Epoch: 23 cost time: 0.8281357288360596
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.952 Vali Acc: 0.300 Test Loss: 4.952 Test Acc: 0.300
Validation loss decreased (-0.295245 --> -0.299950).  Saving model ...
Epoch: 24 cost time: 0.8280918598175049
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.886 Vali Acc: 0.296 Test Loss: 4.886 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8612723350524902
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.894 Vali Acc: 0.294 Test Loss: 4.894 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8620510101318359
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.990 Vali Acc: 0.288 Test Loss: 4.990 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9058623313903809
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.994 Vali Acc: 0.300 Test Loss: 4.994 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8710544109344482
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.979 Vali Acc: 0.305 Test Loss: 4.979 Test Acc: 0.305
Validation loss decreased (-0.299950 --> -0.304656).  Saving model ...
Epoch: 29 cost time: 0.763329267501831
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.024 Vali Acc: 0.304 Test Loss: 5.024 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7878704071044922
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.040 Vali Acc: 0.301 Test Loss: 5.040 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9989516735076904
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.042 Vali Acc: 0.307 Test Loss: 5.042 Test Acc: 0.307
Validation loss decreased (-0.304656 --> -0.307008).  Saving model ...
Epoch: 32 cost time: 1.5191779136657715
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.020 Vali Acc: 0.305 Test Loss: 5.020 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8336427211761475
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.047 Vali Acc: 0.306 Test Loss: 5.047 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0676772594451904
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.077 Vali Acc: 0.306 Test Loss: 5.077 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8160231113433838
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.090 Vali Acc: 0.309 Test Loss: 5.090 Test Acc: 0.309
Validation loss decreased (-0.307008 --> -0.309361).  Saving model ...
Epoch: 36 cost time: 0.8693287372589111
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.090 Vali Acc: 0.309 Test Loss: 5.090 Test Acc: 0.309
Validation loss decreased (-0.309361 --> -0.309361).  Saving model ...
Epoch: 37 cost time: 1.136763334274292
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.111 Vali Acc: 0.309 Test Loss: 5.111 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.849628210067749
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.120 Vali Acc: 0.312 Test Loss: 5.120 Test Acc: 0.312
Validation loss decreased (-0.309361 --> -0.311714).  Saving model ...
Epoch: 39 cost time: 0.9341895580291748
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.152 Vali Acc: 0.308 Test Loss: 5.152 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9390149116516113
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.163 Vali Acc: 0.309 Test Loss: 5.163 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.631481409072876
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.175 Vali Acc: 0.307 Test Loss: 5.175 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0439236164093018
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.135 Vali Acc: 0.309 Test Loss: 5.135 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.244610071182251
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.130 Vali Acc: 0.308 Test Loss: 5.130 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6246788501739502
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.148 Vali Acc: 0.309 Test Loss: 5.148 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5874693393707275
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.176 Vali Acc: 0.308 Test Loss: 5.176 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.889462947845459
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.200 Vali Acc: 0.305 Test Loss: 5.200 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7197787761688232
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.208 Vali Acc: 0.307 Test Loss: 5.208 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6677100658416748
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.216 Vali Acc: 0.311 Test Loss: 5.216 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 36768794
model size : 154.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.324899435043335
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.370 Vali Acc: 0.024 Test Loss: 3.370 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 0.8011608123779297
Epoch: 2, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.348 Vali Acc: 0.041 Test Loss: 3.348 Test Acc: 0.041
Validation loss decreased (-0.023496 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.5477869510650635
Epoch: 3, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.366 Vali Acc: 0.059 Test Loss: 3.366 Test Acc: 0.059
Validation loss decreased (-0.041143 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 0.6368751525878906
Epoch: 4, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.328 Vali Acc: 0.071 Test Loss: 3.328 Test Acc: 0.071
Validation loss decreased (-0.058790 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 0.5840282440185547
Epoch: 5, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.287 Vali Acc: 0.085 Test Loss: 3.287 Test Acc: 0.085
Validation loss decreased (-0.070555 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.63238525390625
Epoch: 6, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.274 Vali Acc: 0.108 Test Loss: 3.274 Test Acc: 0.108
Validation loss decreased (-0.084673 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.5482907295227051
Epoch: 7, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.234 Vali Acc: 0.108 Test Loss: 3.234 Test Acc: 0.108
Validation loss decreased (-0.108203 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.6297440528869629
Epoch: 8, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.251 Vali Acc: 0.133 Test Loss: 3.251 Test Acc: 0.133
Validation loss decreased (-0.108203 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 0.5919907093048096
Epoch: 9, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.253 Vali Acc: 0.153 Test Loss: 3.253 Test Acc: 0.153
Validation loss decreased (-0.132909 --> -0.152909).  Saving model ...
Epoch: 10 cost time: 0.9503984451293945
Epoch: 10, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.382 Vali Acc: 0.194 Test Loss: 3.382 Test Acc: 0.194
Validation loss decreased (-0.152909 --> -0.194084).  Saving model ...
Epoch: 11 cost time: 0.520836591720581
Epoch: 11, Steps: 10 | Train Loss: 1.277 Vali Loss: 3.468 Vali Acc: 0.207 Test Loss: 3.468 Test Acc: 0.207
Validation loss decreased (-0.194084 --> -0.207024).  Saving model ...
Epoch: 12 cost time: 0.6168980598449707
Epoch: 12, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.589 Vali Acc: 0.229 Test Loss: 3.589 Test Acc: 0.229
Validation loss decreased (-0.207024 --> -0.229376).  Saving model ...
Epoch: 13 cost time: 0.6043391227722168
Epoch: 13, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.719 Vali Acc: 0.225 Test Loss: 3.719 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.556415319442749
Epoch: 14, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.842 Vali Acc: 0.249 Test Loss: 3.842 Test Acc: 0.249
Validation loss decreased (-0.229376 --> -0.249373).  Saving model ...
Epoch: 15 cost time: 0.9412069320678711
Epoch: 15, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.866 Vali Acc: 0.261 Test Loss: 3.866 Test Acc: 0.261
Validation loss decreased (-0.249373 --> -0.261138).  Saving model ...
Epoch: 16 cost time: 0.9139657020568848
Epoch: 16, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.057 Vali Acc: 0.259 Test Loss: 4.057 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7507286071777344
Epoch: 17, Steps: 10 | Train Loss: 0.179 Vali Loss: 4.125 Vali Acc: 0.266 Test Loss: 4.125 Test Acc: 0.266
Validation loss decreased (-0.261138 --> -0.265841).  Saving model ...
Epoch: 18 cost time: 0.8821408748626709
Epoch: 18, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.099 Vali Acc: 0.273 Test Loss: 4.099 Test Acc: 0.273
Validation loss decreased (-0.265841 --> -0.272900).  Saving model ...
Epoch: 19 cost time: 0.8202793598175049
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.314 Vali Acc: 0.289 Test Loss: 4.314 Test Acc: 0.289
Validation loss decreased (-0.272900 --> -0.289369).  Saving model ...
Epoch: 20 cost time: 0.7570264339447021
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.369 Vali Acc: 0.284 Test Loss: 4.369 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6147372722625732
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.541 Vali Acc: 0.267 Test Loss: 4.541 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8892452716827393
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.529 Vali Acc: 0.273 Test Loss: 4.529 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8190977573394775
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.538 Vali Acc: 0.284 Test Loss: 4.538 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7595789432525635
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.625 Vali Acc: 0.288 Test Loss: 4.625 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8406112194061279
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.665 Vali Acc: 0.282 Test Loss: 4.665 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7531330585479736
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.668 Vali Acc: 0.280 Test Loss: 4.668 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6975631713867188
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.709 Vali Acc: 0.280 Test Loss: 4.709 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5598886013031006
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.713 Vali Acc: 0.286 Test Loss: 4.713 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6320133209228516
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.726 Vali Acc: 0.288 Test Loss: 4.726 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28941176470588237
model parameter : 36596762
model size : 154.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.103595733642578
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.341 Vali Acc: 0.042 Test Loss: 3.341 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.967918872833252
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.340 Vali Acc: 0.060 Test Loss: 3.340 Test Acc: 0.060
Validation loss decreased (-0.042320 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.0096378326416016
Epoch: 3, Steps: 10 | Train Loss: 3.057 Vali Loss: 3.324 Vali Acc: 0.089 Test Loss: 3.324 Test Acc: 0.089
Validation loss decreased (-0.059967 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.7667758464813232
Epoch: 4, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.237 Vali Acc: 0.113 Test Loss: 3.237 Test Acc: 0.113
Validation loss decreased (-0.089379 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 0.5544624328613281
Epoch: 5, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.154 Vali Acc: 0.139 Test Loss: 3.154 Test Acc: 0.139
Validation loss decreased (-0.112909 --> -0.138792).  Saving model ...
Epoch: 6 cost time: 0.6908700466156006
Epoch: 6, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.194 Vali Acc: 0.167 Test Loss: 3.194 Test Acc: 0.167
Validation loss decreased (-0.138792 --> -0.167027).  Saving model ...
Epoch: 7 cost time: 0.7168989181518555
Epoch: 7, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.339 Vali Acc: 0.209 Test Loss: 3.339 Test Acc: 0.209
Validation loss decreased (-0.167027 --> -0.209378).  Saving model ...
Epoch: 8 cost time: 0.7495970726013184
Epoch: 8, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.725 Vali Acc: 0.251 Test Loss: 3.725 Test Acc: 0.251
Validation loss decreased (-0.209378 --> -0.250551).  Saving model ...
Epoch: 9 cost time: 0.9315276145935059
Epoch: 9, Steps: 10 | Train Loss: 0.664 Vali Loss: 4.080 Vali Acc: 0.268 Test Loss: 4.080 Test Acc: 0.268
Validation loss decreased (-0.250551 --> -0.268194).  Saving model ...
Epoch: 10 cost time: 1.3011023998260498
Epoch: 10, Steps: 10 | Train Loss: 0.392 Vali Loss: 4.319 Vali Acc: 0.266 Test Loss: 4.319 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6029098033905029
Epoch: 11, Steps: 10 | Train Loss: 0.263 Vali Loss: 4.617 Vali Acc: 0.273 Test Loss: 4.617 Test Acc: 0.273
Validation loss decreased (-0.268194 --> -0.272895).  Saving model ...
Epoch: 12 cost time: 0.7903909683227539
Epoch: 12, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.858 Vali Acc: 0.260 Test Loss: 4.858 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7004098892211914
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 5.041 Vali Acc: 0.281 Test Loss: 5.041 Test Acc: 0.281
Validation loss decreased (-0.272895 --> -0.281126).  Saving model ...
Epoch: 14 cost time: 0.6281814575195312
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 5.363 Vali Acc: 0.256 Test Loss: 5.363 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7739081382751465
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.313 Vali Acc: 0.269 Test Loss: 5.313 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6943042278289795
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.380 Vali Acc: 0.301 Test Loss: 5.380 Test Acc: 0.301
Validation loss decreased (-0.281126 --> -0.301123).  Saving model ...
Epoch: 17 cost time: 0.6240706443786621
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.718 Vali Acc: 0.291 Test Loss: 5.718 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5557222366333008
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.639 Vali Acc: 0.284 Test Loss: 5.639 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8111183643341064
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.628 Vali Acc: 0.291 Test Loss: 5.628 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6957542896270752
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.609 Vali Acc: 0.305 Test Loss: 5.609 Test Acc: 0.305
Validation loss decreased (-0.301123 --> -0.304650).  Saving model ...
Epoch: 21 cost time: 1.1877593994140625
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.640 Vali Acc: 0.307 Test Loss: 5.640 Test Acc: 0.307
Validation loss decreased (-0.304650 --> -0.307002).  Saving model ...
Epoch: 22 cost time: 0.9974899291992188
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.693 Vali Acc: 0.301 Test Loss: 5.693 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5135064125061035
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.671 Vali Acc: 0.300 Test Loss: 5.671 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5167114734649658
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.619 Vali Acc: 0.311 Test Loss: 5.619 Test Acc: 0.311
Validation loss decreased (-0.307002 --> -0.310532).  Saving model ...
Epoch: 25 cost time: 1.140800952911377
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.594 Vali Acc: 0.311 Test Loss: 5.594 Test Acc: 0.311
Validation loss decreased (-0.310532 --> -0.310532).  Saving model ...
Epoch: 26 cost time: 0.8045122623443604
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.593 Vali Acc: 0.314 Test Loss: 5.593 Test Acc: 0.314
Validation loss decreased (-0.310532 --> -0.314062).  Saving model ...
Epoch: 27 cost time: 0.920109748840332
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.589 Vali Acc: 0.313 Test Loss: 5.589 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7847452163696289
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.592 Vali Acc: 0.315 Test Loss: 5.592 Test Acc: 0.315
Validation loss decreased (-0.314062 --> -0.315238).  Saving model ...
Epoch: 29 cost time: 0.6709446907043457
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.601 Vali Acc: 0.314 Test Loss: 5.601 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0902032852172852
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.626 Vali Acc: 0.305 Test Loss: 5.626 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8375387191772461
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.641 Vali Acc: 0.302 Test Loss: 5.641 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5976991653442383
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.646 Vali Acc: 0.304 Test Loss: 5.646 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6876959800720215
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.690 Vali Acc: 0.311 Test Loss: 5.690 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1275203227996826
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.748 Vali Acc: 0.308 Test Loss: 5.748 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2028629779815674
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.754 Vali Acc: 0.311 Test Loss: 5.754 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.869560718536377
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.740 Vali Acc: 0.311 Test Loss: 5.740 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8104076385498047
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.708 Vali Acc: 0.314 Test Loss: 5.708 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0147504806518555
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.702 Vali Acc: 0.318 Test Loss: 5.702 Test Acc: 0.318
Validation loss decreased (-0.315238 --> -0.317590).  Saving model ...
Epoch: 39 cost time: 1.2400507926940918
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.709 Vali Acc: 0.321 Test Loss: 5.709 Test Acc: 0.321
Validation loss decreased (-0.317590 --> -0.321119).  Saving model ...
Epoch: 40 cost time: 0.5858628749847412
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.726 Vali Acc: 0.324 Test Loss: 5.726 Test Acc: 0.324
Validation loss decreased (-0.321119 --> -0.323472).  Saving model ...
Epoch: 41 cost time: 0.5842380523681641
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.738 Vali Acc: 0.324 Test Loss: 5.738 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5616011619567871
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.748 Vali Acc: 0.324 Test Loss: 5.748 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6138427257537842
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.752 Vali Acc: 0.321 Test Loss: 5.752 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7264227867126465
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.754 Vali Acc: 0.320 Test Loss: 5.754 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9603326320648193
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.769 Vali Acc: 0.320 Test Loss: 5.769 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.015064001083374
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.785 Vali Acc: 0.319 Test Loss: 5.785 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.200166940689087
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.783 Vali Acc: 0.319 Test Loss: 5.783 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7820477485656738
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.789 Vali Acc: 0.320 Test Loss: 5.789 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7960917949676514
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.789 Vali Acc: 0.319 Test Loss: 5.789 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6874752044677734
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.796 Vali Acc: 0.321 Test Loss: 5.796 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 37019162
model size : 155.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8848886489868164
Epoch: 1, Steps: 10 | Train Loss: 3.425 Vali Loss: 3.320 Vali Acc: 0.040 Test Loss: 3.320 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.8087468147277832
Epoch: 2, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.321 Vali Acc: 0.059 Test Loss: 3.321 Test Acc: 0.059
Validation loss decreased (-0.039967 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.5233044624328613
Epoch: 3, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.356 Vali Acc: 0.054 Test Loss: 3.356 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.850090503692627
Epoch: 4, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.327 Vali Acc: 0.084 Test Loss: 3.327 Test Acc: 0.084
Validation loss decreased (-0.058790 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 1.021937370300293
Epoch: 5, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.240 Vali Acc: 0.108 Test Loss: 3.240 Test Acc: 0.108
Validation loss decreased (-0.083496 --> -0.108203).  Saving model ...
Epoch: 6 cost time: 0.7831659317016602
Epoch: 6, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.200 Vali Acc: 0.124 Test Loss: 3.200 Test Acc: 0.124
Validation loss decreased (-0.108203 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 0.9018292427062988
Epoch: 7, Steps: 10 | Train Loss: 2.334 Vali Loss: 3.220 Vali Acc: 0.158 Test Loss: 3.220 Test Acc: 0.158
Validation loss decreased (-0.123497 --> -0.157615).  Saving model ...
Epoch: 8 cost time: 0.6114885807037354
Epoch: 8, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.235 Vali Acc: 0.185 Test Loss: 3.235 Test Acc: 0.185
Validation loss decreased (-0.157615 --> -0.184674).  Saving model ...
Epoch: 9 cost time: 0.6565260887145996
Epoch: 9, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.456 Vali Acc: 0.204 Test Loss: 3.456 Test Acc: 0.204
Validation loss decreased (-0.184674 --> -0.203495).  Saving model ...
Epoch: 10 cost time: 0.5786793231964111
Epoch: 10, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.605 Vali Acc: 0.216 Test Loss: 3.605 Test Acc: 0.216
Validation loss decreased (-0.203495 --> -0.216435).  Saving model ...
Epoch: 11 cost time: 0.6377263069152832
Epoch: 11, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.699 Vali Acc: 0.244 Test Loss: 3.699 Test Acc: 0.244
Validation loss decreased (-0.216435 --> -0.243492).  Saving model ...
Epoch: 12 cost time: 0.6630980968475342
Epoch: 12, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.946 Vali Acc: 0.259 Test Loss: 3.946 Test Acc: 0.259
Validation loss decreased (-0.243492 --> -0.258784).  Saving model ...
Epoch: 13 cost time: 0.6913352012634277
Epoch: 13, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.965 Vali Acc: 0.268 Test Loss: 3.965 Test Acc: 0.268
Validation loss decreased (-0.258784 --> -0.268196).  Saving model ...
Epoch: 14 cost time: 0.6339755058288574
Epoch: 14, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.184 Vali Acc: 0.286 Test Loss: 4.184 Test Acc: 0.286
Validation loss decreased (-0.268196 --> -0.285841).  Saving model ...
Epoch: 15 cost time: 0.6257193088531494
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.272 Vali Acc: 0.288 Test Loss: 4.272 Test Acc: 0.288
Validation loss decreased (-0.285841 --> -0.288193).  Saving model ...
Epoch: 16 cost time: 0.6382324695587158
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.408 Vali Acc: 0.286 Test Loss: 4.408 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6171658039093018
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.477 Vali Acc: 0.282 Test Loss: 4.477 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5611331462860107
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.630 Vali Acc: 0.287 Test Loss: 4.630 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6362440586090088
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.678 Vali Acc: 0.280 Test Loss: 4.678 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8118171691894531
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.548 Vali Acc: 0.306 Test Loss: 4.548 Test Acc: 0.306
Validation loss decreased (-0.288193 --> -0.305837).  Saving model ...
Epoch: 21 cost time: 0.6694028377532959
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.601 Vali Acc: 0.306 Test Loss: 4.601 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6167855262756348
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.697 Vali Acc: 0.301 Test Loss: 4.697 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6410133838653564
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.719 Vali Acc: 0.306 Test Loss: 4.719 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.751054048538208
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.747 Vali Acc: 0.306 Test Loss: 4.747 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6157450675964355
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.849 Vali Acc: 0.295 Test Loss: 4.849 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6001756191253662
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.825 Vali Acc: 0.296 Test Loss: 4.825 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5944252014160156
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.804 Vali Acc: 0.298 Test Loss: 4.804 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6557862758636475
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.870 Vali Acc: 0.296 Test Loss: 4.870 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6842103004455566
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.895 Vali Acc: 0.298 Test Loss: 4.895 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5978000164031982
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.908 Vali Acc: 0.301 Test Loss: 4.908 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 36739610
model size : 154.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0923004150390625
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.362 Vali Acc: 0.031 Test Loss: 3.362 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.6336138248443604
Epoch: 2, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.332 Vali Acc: 0.039 Test Loss: 3.332 Test Acc: 0.039
Validation loss decreased (-0.030555 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.7761588096618652
Epoch: 3, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.323 Vali Acc: 0.051 Test Loss: 3.323 Test Acc: 0.051
Validation loss decreased (-0.038790 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.6562168598175049
Epoch: 4, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.313 Vali Acc: 0.067 Test Loss: 3.313 Test Acc: 0.067
Validation loss decreased (-0.050555 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.9096493721008301
Epoch: 5, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.285 Vali Acc: 0.098 Test Loss: 3.285 Test Acc: 0.098
Validation loss decreased (-0.067026 --> -0.097614).  Saving model ...
Epoch: 6 cost time: 0.634934663772583
Epoch: 6, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.250 Vali Acc: 0.114 Test Loss: 3.250 Test Acc: 0.114
Validation loss decreased (-0.097614 --> -0.114085).  Saving model ...
Epoch: 7 cost time: 0.7034780979156494
Epoch: 7, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.235 Vali Acc: 0.133 Test Loss: 3.235 Test Acc: 0.133
Validation loss decreased (-0.114085 --> -0.132909).  Saving model ...
Epoch: 8 cost time: 0.5483336448669434
Epoch: 8, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.190 Vali Acc: 0.147 Test Loss: 3.190 Test Acc: 0.147
Validation loss decreased (-0.132909 --> -0.147027).  Saving model ...
Epoch: 9 cost time: 0.8806302547454834
Epoch: 9, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.237 Vali Acc: 0.184 Test Loss: 3.237 Test Acc: 0.184
Validation loss decreased (-0.147027 --> -0.183497).  Saving model ...
Epoch: 10 cost time: 0.8054699897766113
Epoch: 10, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.281 Vali Acc: 0.215 Test Loss: 3.281 Test Acc: 0.215
Validation loss decreased (-0.183497 --> -0.215261).  Saving model ...
Epoch: 11 cost time: 0.8541171550750732
Epoch: 11, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.390 Vali Acc: 0.228 Test Loss: 3.390 Test Acc: 0.228
Validation loss decreased (-0.215261 --> -0.228201).  Saving model ...
Epoch: 12 cost time: 0.6066038608551025
Epoch: 12, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.537 Vali Acc: 0.231 Test Loss: 3.537 Test Acc: 0.231
Validation loss decreased (-0.228201 --> -0.230553).  Saving model ...
Epoch: 13 cost time: 0.7180840969085693
Epoch: 13, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.591 Vali Acc: 0.245 Test Loss: 3.591 Test Acc: 0.245
Validation loss decreased (-0.230553 --> -0.244670).  Saving model ...
Epoch: 14 cost time: 0.6326446533203125
Epoch: 14, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.743 Vali Acc: 0.256 Test Loss: 3.743 Test Acc: 0.256
Validation loss decreased (-0.244670 --> -0.256433).  Saving model ...
Epoch: 15 cost time: 0.6874675750732422
Epoch: 15, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.834 Vali Acc: 0.261 Test Loss: 3.834 Test Acc: 0.261
Validation loss decreased (-0.256433 --> -0.261138).  Saving model ...
Epoch: 16 cost time: 0.8159430027008057
Epoch: 16, Steps: 10 | Train Loss: 0.226 Vali Loss: 4.006 Vali Acc: 0.278 Test Loss: 4.006 Test Acc: 0.278
Validation loss decreased (-0.261138 --> -0.277607).  Saving model ...
Epoch: 17 cost time: 0.7649838924407959
Epoch: 17, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.030 Vali Acc: 0.293 Test Loss: 4.030 Test Acc: 0.293
Validation loss decreased (-0.277607 --> -0.292901).  Saving model ...
Epoch: 18 cost time: 0.6818430423736572
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.259 Vali Acc: 0.268 Test Loss: 4.259 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8703885078430176
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.273 Vali Acc: 0.281 Test Loss: 4.273 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9101803302764893
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.354 Vali Acc: 0.279 Test Loss: 4.354 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7642176151275635
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.410 Vali Acc: 0.289 Test Loss: 4.410 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7326653003692627
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.417 Vali Acc: 0.291 Test Loss: 4.417 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.689021110534668
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.431 Vali Acc: 0.291 Test Loss: 4.431 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7302219867706299
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.431 Vali Acc: 0.286 Test Loss: 4.431 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5824062824249268
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.486 Vali Acc: 0.291 Test Loss: 4.486 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6581730842590332
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.552 Vali Acc: 0.288 Test Loss: 4.552 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6019034385681152
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.598 Vali Acc: 0.286 Test Loss: 4.598 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 36610586
model size : 154.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0609121322631836
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.340 Vali Acc: 0.045 Test Loss: 3.340 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.7204124927520752
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.380 Vali Acc: 0.059 Test Loss: 3.380 Test Acc: 0.059
Validation loss decreased (-0.044672 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.5410890579223633
Epoch: 3, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.322 Vali Acc: 0.086 Test Loss: 3.322 Test Acc: 0.086
Validation loss decreased (-0.058790 --> -0.085849).  Saving model ...
Epoch: 4 cost time: 0.6245689392089844
Epoch: 4, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.270 Vali Acc: 0.093 Test Loss: 3.270 Test Acc: 0.093
Validation loss decreased (-0.085849 --> -0.092908).  Saving model ...
Epoch: 5 cost time: 0.965869665145874
Epoch: 5, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.224 Vali Acc: 0.147 Test Loss: 3.224 Test Acc: 0.147
Validation loss decreased (-0.092908 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 0.779240608215332
Epoch: 6, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.233 Vali Acc: 0.142 Test Loss: 3.233 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8683311939239502
Epoch: 7, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.169 Vali Acc: 0.176 Test Loss: 3.169 Test Acc: 0.176
Validation loss decreased (-0.147027 --> -0.176439).  Saving model ...
Epoch: 8 cost time: 1.2565369606018066
Epoch: 8, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.470 Vali Acc: 0.201 Test Loss: 3.470 Test Acc: 0.201
Validation loss decreased (-0.176439 --> -0.201142).  Saving model ...
Epoch: 9 cost time: 1.1072301864624023
Epoch: 9, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.860 Vali Acc: 0.241 Test Loss: 3.860 Test Acc: 0.241
Validation loss decreased (-0.201142 --> -0.241138).  Saving model ...
Epoch: 10 cost time: 0.8813381195068359
Epoch: 10, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.922 Vali Acc: 0.269 Test Loss: 3.922 Test Acc: 0.269
Validation loss decreased (-0.241138 --> -0.269373).  Saving model ...
Epoch: 11 cost time: 0.9943869113922119
Epoch: 11, Steps: 10 | Train Loss: 0.346 Vali Loss: 4.367 Vali Acc: 0.271 Test Loss: 4.367 Test Acc: 0.271
Validation loss decreased (-0.269373 --> -0.270545).  Saving model ...
Epoch: 12 cost time: 1.0608718395233154
Epoch: 12, Steps: 10 | Train Loss: 0.216 Vali Loss: 4.389 Vali Acc: 0.276 Test Loss: 4.389 Test Acc: 0.276
Validation loss decreased (-0.270545 --> -0.276427).  Saving model ...
Epoch: 13 cost time: 0.8495547771453857
Epoch: 13, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.670 Vali Acc: 0.282 Test Loss: 4.670 Test Acc: 0.282
Validation loss decreased (-0.276427 --> -0.282306).  Saving model ...
Epoch: 14 cost time: 1.2991437911987305
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.933 Vali Acc: 0.301 Test Loss: 4.933 Test Acc: 0.301
Validation loss decreased (-0.282306 --> -0.301127).  Saving model ...
Epoch: 15 cost time: 0.6763761043548584
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.008 Vali Acc: 0.292 Test Loss: 5.008 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7069308757781982
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.226 Vali Acc: 0.289 Test Loss: 5.226 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.917341947555542
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.185 Vali Acc: 0.295 Test Loss: 5.185 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3026270866394043
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.154 Vali Acc: 0.302 Test Loss: 5.154 Test Acc: 0.302
Validation loss decreased (-0.301127 --> -0.302301).  Saving model ...
Epoch: 19 cost time: 1.2009406089782715
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.092 Vali Acc: 0.307 Test Loss: 5.092 Test Acc: 0.307
Validation loss decreased (-0.302301 --> -0.307008).  Saving model ...
Epoch: 20 cost time: 1.2048742771148682
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.096 Vali Acc: 0.312 Test Loss: 5.096 Test Acc: 0.312
Validation loss decreased (-0.307008 --> -0.311714).  Saving model ...
Epoch: 21 cost time: 0.634702205657959
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.255 Vali Acc: 0.305 Test Loss: 5.255 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1234424114227295
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.280 Vali Acc: 0.311 Test Loss: 5.280 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7238144874572754
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.306 Vali Acc: 0.312 Test Loss: 5.306 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9801855087280273
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.312 Vali Acc: 0.314 Test Loss: 5.312 Test Acc: 0.314
Validation loss decreased (-0.311714 --> -0.314065).  Saving model ...
Epoch: 25 cost time: 1.0735962390899658
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.276 Vali Acc: 0.311 Test Loss: 5.276 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.864466667175293
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.263 Vali Acc: 0.312 Test Loss: 5.263 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0076243877410889
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.298 Vali Acc: 0.311 Test Loss: 5.298 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8715131282806396
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.304 Vali Acc: 0.316 Test Loss: 5.304 Test Acc: 0.316
Validation loss decreased (-0.314065 --> -0.316418).  Saving model ...
Epoch: 29 cost time: 1.349498987197876
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.357 Vali Acc: 0.314 Test Loss: 5.357 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8879308700561523
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.368 Vali Acc: 0.314 Test Loss: 5.368 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1119399070739746
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.360 Vali Acc: 0.313 Test Loss: 5.360 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5499296188354492
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.319 Vali Acc: 0.308 Test Loss: 5.319 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7558817863464355
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.326 Vali Acc: 0.313 Test Loss: 5.326 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2689037322998047
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.328 Vali Acc: 0.320 Test Loss: 5.328 Test Acc: 0.320
Validation loss decreased (-0.316418 --> -0.319947).  Saving model ...
Epoch: 35 cost time: 0.8084897994995117
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.347 Vali Acc: 0.314 Test Loss: 5.347 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.144301414489746
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.366 Vali Acc: 0.314 Test Loss: 5.366 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8299932479858398
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.372 Vali Acc: 0.316 Test Loss: 5.372 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0393669605255127
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.386 Vali Acc: 0.314 Test Loss: 5.386 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7235088348388672
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.403 Vali Acc: 0.315 Test Loss: 5.403 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0803415775299072
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.423 Vali Acc: 0.315 Test Loss: 5.423 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.924213171005249
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.436 Vali Acc: 0.318 Test Loss: 5.436 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.852849006652832
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.443 Vali Acc: 0.316 Test Loss: 5.443 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7675981521606445
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.443 Vali Acc: 0.315 Test Loss: 5.443 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5967197418212891
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.446 Vali Acc: 0.319 Test Loss: 5.446 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 36932378
model size : 155.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.421994686126709
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.385 Vali Acc: 0.039 Test Loss: 3.385 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.6787986755371094
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.340 Vali Acc: 0.074 Test Loss: 3.340 Test Acc: 0.074
Validation loss decreased (-0.038790 --> -0.074084).  Saving model ...
Epoch: 3 cost time: 0.6037209033966064
Epoch: 3, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.336 Vali Acc: 0.088 Test Loss: 3.336 Test Acc: 0.088
Validation loss decreased (-0.074084 --> -0.088202).  Saving model ...
Epoch: 4 cost time: 0.6256239414215088
Epoch: 4, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.292 Vali Acc: 0.076 Test Loss: 3.292 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6248822212219238
Epoch: 5, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.253 Vali Acc: 0.100 Test Loss: 3.253 Test Acc: 0.100
Validation loss decreased (-0.088202 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.7392618656158447
Epoch: 6, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.217 Vali Acc: 0.139 Test Loss: 3.217 Test Acc: 0.139
Validation loss decreased (-0.099967 --> -0.138791).  Saving model ...
Epoch: 7 cost time: 0.7669768333435059
Epoch: 7, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.255 Vali Acc: 0.158 Test Loss: 3.255 Test Acc: 0.158
Validation loss decreased (-0.138791 --> -0.157615).  Saving model ...
Epoch: 8 cost time: 0.7156109809875488
Epoch: 8, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.355 Vali Acc: 0.174 Test Loss: 3.355 Test Acc: 0.174
Validation loss decreased (-0.157615 --> -0.174084).  Saving model ...
Epoch: 9 cost time: 0.5511813163757324
Epoch: 9, Steps: 10 | Train Loss: 1.383 Vali Loss: 3.515 Vali Acc: 0.199 Test Loss: 3.515 Test Acc: 0.199
Validation loss decreased (-0.174084 --> -0.198788).  Saving model ...
Epoch: 10 cost time: 0.6460549831390381
Epoch: 10, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.640 Vali Acc: 0.216 Test Loss: 3.640 Test Acc: 0.216
Validation loss decreased (-0.198788 --> -0.216434).  Saving model ...
Epoch: 11 cost time: 0.9661295413970947
Epoch: 11, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.828 Vali Acc: 0.234 Test Loss: 3.828 Test Acc: 0.234
Validation loss decreased (-0.216434 --> -0.234079).  Saving model ...
Epoch: 12 cost time: 0.7015302181243896
Epoch: 12, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.843 Vali Acc: 0.261 Test Loss: 3.843 Test Acc: 0.261
Validation loss decreased (-0.234079 --> -0.261138).  Saving model ...
Epoch: 13 cost time: 0.7221364974975586
Epoch: 13, Steps: 10 | Train Loss: 0.321 Vali Loss: 4.003 Vali Acc: 0.261 Test Loss: 4.003 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8806343078613281
Epoch: 14, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.965 Vali Acc: 0.289 Test Loss: 3.965 Test Acc: 0.289
Validation loss decreased (-0.261138 --> -0.289372).  Saving model ...
Epoch: 15 cost time: 0.7337765693664551
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.295 Vali Acc: 0.278 Test Loss: 4.295 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5950314998626709
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.300 Vali Acc: 0.287 Test Loss: 4.300 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8066916465759277
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.341 Vali Acc: 0.302 Test Loss: 4.341 Test Acc: 0.302
Validation loss decreased (-0.289372 --> -0.302310).  Saving model ...
Epoch: 18 cost time: 0.9344940185546875
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.418 Vali Acc: 0.302 Test Loss: 4.418 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9063398838043213
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.504 Vali Acc: 0.309 Test Loss: 4.504 Test Acc: 0.309
Validation loss decreased (-0.302310 --> -0.309367).  Saving model ...
Epoch: 20 cost time: 0.7544045448303223
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.505 Vali Acc: 0.302 Test Loss: 4.505 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0372226238250732
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.566 Vali Acc: 0.306 Test Loss: 4.566 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7570664882659912
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.635 Vali Acc: 0.311 Test Loss: 4.635 Test Acc: 0.311
Validation loss decreased (-0.309367 --> -0.310542).  Saving model ...
Epoch: 23 cost time: 0.5692229270935059
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.661 Vali Acc: 0.304 Test Loss: 4.661 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7105014324188232
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.770 Vali Acc: 0.300 Test Loss: 4.770 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7149438858032227
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.613 Vali Acc: 0.309 Test Loss: 4.613 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7995612621307373
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.636 Vali Acc: 0.306 Test Loss: 4.636 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6813969612121582
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.660 Vali Acc: 0.305 Test Loss: 4.660 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7109501361846924
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.706 Vali Acc: 0.302 Test Loss: 4.706 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8528451919555664
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.716 Vali Acc: 0.305 Test Loss: 4.716 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6102643013000488
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.730 Vali Acc: 0.307 Test Loss: 4.730 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7411816120147705
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.732 Vali Acc: 0.308 Test Loss: 4.732 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8848221302032471
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.748 Vali Acc: 0.316 Test Loss: 4.748 Test Acc: 0.316
Validation loss decreased (-0.310542 --> -0.316423).  Saving model ...
Epoch: 33 cost time: 0.7566335201263428
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.776 Vali Acc: 0.316 Test Loss: 4.776 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.621267557144165
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.863 Vali Acc: 0.308 Test Loss: 4.863 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.673760175704956
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.905 Vali Acc: 0.311 Test Loss: 4.905 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6416060924530029
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.913 Vali Acc: 0.308 Test Loss: 4.913 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6180543899536133
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.896 Vali Acc: 0.311 Test Loss: 4.896 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7067108154296875
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.884 Vali Acc: 0.313 Test Loss: 4.884 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5786416530609131
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.883 Vali Acc: 0.320 Test Loss: 4.883 Test Acc: 0.320
Validation loss decreased (-0.316423 --> -0.319951).  Saving model ...
Epoch: 40 cost time: 0.9062108993530273
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.893 Vali Acc: 0.321 Test Loss: 4.893 Test Acc: 0.321
Validation loss decreased (-0.319951 --> -0.321128).  Saving model ...
Epoch: 41 cost time: 0.8200793266296387
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.903 Vali Acc: 0.318 Test Loss: 4.903 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7233619689941406
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.907 Vali Acc: 0.321 Test Loss: 4.907 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6773221492767334
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.916 Vali Acc: 0.324 Test Loss: 4.916 Test Acc: 0.324
Validation loss decreased (-0.321128 --> -0.323480).  Saving model ...
Epoch: 44 cost time: 0.6063461303710938
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.924 Vali Acc: 0.322 Test Loss: 4.924 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5833978652954102
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.949 Vali Acc: 0.319 Test Loss: 4.949 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7397210597991943
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.956 Vali Acc: 0.321 Test Loss: 4.956 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9754912853240967
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.950 Vali Acc: 0.327 Test Loss: 4.950 Test Acc: 0.327
Validation loss decreased (-0.323480 --> -0.327009).  Saving model ...
Epoch: 48 cost time: 0.5251288414001465
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.948 Vali Acc: 0.328 Test Loss: 4.948 Test Acc: 0.328
Validation loss decreased (-0.327009 --> -0.328186).  Saving model ...
Epoch: 49 cost time: 0.677323579788208
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.948 Vali Acc: 0.327 Test Loss: 4.948 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7074124813079834
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.957 Vali Acc: 0.331 Test Loss: 4.957 Test Acc: 0.331
Validation loss decreased (-0.328186 --> -0.330539).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 36717338
model size : 154.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4041590690612793
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.350 Vali Acc: 0.039 Test Loss: 3.350 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.672309160232544
Epoch: 2, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.305 Vali Acc: 0.051 Test Loss: 3.305 Test Acc: 0.051
Validation loss decreased (-0.038790 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.6474103927612305
Epoch: 3, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.307 Vali Acc: 0.061 Test Loss: 3.307 Test Acc: 0.061
Validation loss decreased (-0.050555 --> -0.061143).  Saving model ...
Epoch: 4 cost time: 0.6385221481323242
Epoch: 4, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.330 Vali Acc: 0.071 Test Loss: 3.330 Test Acc: 0.071
Validation loss decreased (-0.061143 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 0.5705833435058594
Epoch: 5, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.306 Vali Acc: 0.082 Test Loss: 3.306 Test Acc: 0.082
Validation loss decreased (-0.070555 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 0.9169282913208008
Epoch: 6, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.262 Vali Acc: 0.098 Test Loss: 3.262 Test Acc: 0.098
Validation loss decreased (-0.082320 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 0.7754309177398682
Epoch: 7, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.219 Vali Acc: 0.107 Test Loss: 3.219 Test Acc: 0.107
Validation loss decreased (-0.097614 --> -0.107027).  Saving model ...
Epoch: 8 cost time: 0.6799459457397461
Epoch: 8, Steps: 10 | Train Loss: 2.486 Vali Loss: 3.247 Vali Acc: 0.120 Test Loss: 3.247 Test Acc: 0.120
Validation loss decreased (-0.107027 --> -0.119968).  Saving model ...
Epoch: 9 cost time: 0.9335842132568359
Epoch: 9, Steps: 10 | Train Loss: 2.100 Vali Loss: 3.222 Vali Acc: 0.168 Test Loss: 3.222 Test Acc: 0.168
Validation loss decreased (-0.119968 --> -0.168203).  Saving model ...
Epoch: 10 cost time: 0.7715556621551514
Epoch: 10, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.344 Vali Acc: 0.171 Test Loss: 3.344 Test Acc: 0.171
Validation loss decreased (-0.168203 --> -0.170555).  Saving model ...
Epoch: 11 cost time: 0.6834328174591064
Epoch: 11, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.358 Vali Acc: 0.199 Test Loss: 3.358 Test Acc: 0.199
Validation loss decreased (-0.170555 --> -0.198790).  Saving model ...
Epoch: 12 cost time: 0.799229621887207
Epoch: 12, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.414 Vali Acc: 0.224 Test Loss: 3.414 Test Acc: 0.224
Validation loss decreased (-0.198790 --> -0.223495).  Saving model ...
Epoch: 13 cost time: 0.685234785079956
Epoch: 13, Steps: 10 | Train Loss: 0.927 Vali Loss: 3.542 Vali Acc: 0.252 Test Loss: 3.542 Test Acc: 0.252
Validation loss decreased (-0.223495 --> -0.251729).  Saving model ...
Epoch: 14 cost time: 0.6692087650299072
Epoch: 14, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.582 Vali Acc: 0.254 Test Loss: 3.582 Test Acc: 0.254
Validation loss decreased (-0.251729 --> -0.254082).  Saving model ...
Epoch: 15 cost time: 0.6707854270935059
Epoch: 15, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.668 Vali Acc: 0.267 Test Loss: 3.668 Test Acc: 0.267
Validation loss decreased (-0.254082 --> -0.267022).  Saving model ...
Epoch: 16 cost time: 0.5606667995452881
Epoch: 16, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.797 Vali Acc: 0.264 Test Loss: 3.797 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5296139717102051
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.845 Vali Acc: 0.282 Test Loss: 3.845 Test Acc: 0.282
Validation loss decreased (-0.267022 --> -0.282314).  Saving model ...
Epoch: 18 cost time: 0.5339655876159668
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.956 Vali Acc: 0.269 Test Loss: 3.956 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6028687953948975
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.129 Vali Acc: 0.281 Test Loss: 4.129 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6869387626647949
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.153 Vali Acc: 0.294 Test Loss: 4.153 Test Acc: 0.294
Validation loss decreased (-0.282314 --> -0.294076).  Saving model ...
Epoch: 21 cost time: 0.6556906700134277
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.125 Vali Acc: 0.302 Test Loss: 4.125 Test Acc: 0.302
Validation loss decreased (-0.294076 --> -0.302312).  Saving model ...
Epoch: 22 cost time: 0.5948314666748047
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.188 Vali Acc: 0.287 Test Loss: 4.188 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6764926910400391
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.273 Vali Acc: 0.294 Test Loss: 4.273 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5840268135070801
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.278 Vali Acc: 0.292 Test Loss: 4.278 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5345017910003662
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.304 Vali Acc: 0.295 Test Loss: 4.304 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6350653171539307
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.394 Vali Acc: 0.293 Test Loss: 4.394 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6072754859924316
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.442 Vali Acc: 0.296 Test Loss: 4.442 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7444887161254883
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.446 Vali Acc: 0.294 Test Loss: 4.446 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7643551826477051
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.427 Vali Acc: 0.300 Test Loss: 4.427 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.684380292892456
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.443 Vali Acc: 0.300 Test Loss: 4.443 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5436267852783203
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.476 Vali Acc: 0.296 Test Loss: 4.476 Test Acc: 0.296
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 36588314
model size : 154.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.561464786529541
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.338 Vali Acc: 0.034 Test Loss: 3.338 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.8374722003936768
Epoch: 2, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.358 Vali Acc: 0.048 Test Loss: 3.358 Test Acc: 0.048
Validation loss decreased (-0.034084 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.9921479225158691
Epoch: 3, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.333 Vali Acc: 0.073 Test Loss: 3.333 Test Acc: 0.073
Validation loss decreased (-0.048202 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 1.0147051811218262
Epoch: 4, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.245 Vali Acc: 0.104 Test Loss: 3.245 Test Acc: 0.104
Validation loss decreased (-0.072908 --> -0.103497).  Saving model ...
Epoch: 5 cost time: 0.9656221866607666
Epoch: 5, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.221 Vali Acc: 0.113 Test Loss: 3.221 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 0.847973108291626
Epoch: 6, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.187 Vali Acc: 0.174 Test Loss: 3.187 Test Acc: 0.174
Validation loss decreased (-0.112909 --> -0.174086).  Saving model ...
Epoch: 7 cost time: 1.1934700012207031
Epoch: 7, Steps: 10 | Train Loss: 2.019 Vali Loss: 3.232 Vali Acc: 0.174 Test Loss: 3.232 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.03891921043396
Epoch: 8, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.367 Vali Acc: 0.228 Test Loss: 3.367 Test Acc: 0.228
Validation loss decreased (-0.174086 --> -0.228202).  Saving model ...
Epoch: 9 cost time: 1.0976312160491943
Epoch: 9, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.647 Vali Acc: 0.256 Test Loss: 3.647 Test Acc: 0.256
Validation loss decreased (-0.228202 --> -0.256434).  Saving model ...
Epoch: 10 cost time: 0.5403885841369629
Epoch: 10, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.809 Vali Acc: 0.282 Test Loss: 3.809 Test Acc: 0.282
Validation loss decreased (-0.256434 --> -0.282315).  Saving model ...
Epoch: 11 cost time: 0.5120773315429688
Epoch: 11, Steps: 10 | Train Loss: 0.348 Vali Loss: 4.051 Vali Acc: 0.269 Test Loss: 4.051 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.651043176651001
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.175 Vali Acc: 0.299 Test Loss: 4.175 Test Acc: 0.299
Validation loss decreased (-0.282315 --> -0.298782).  Saving model ...
Epoch: 13 cost time: 0.5333907604217529
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.460 Vali Acc: 0.284 Test Loss: 4.460 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5750854015350342
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.372 Vali Acc: 0.304 Test Loss: 4.372 Test Acc: 0.304
Validation loss decreased (-0.298782 --> -0.303486).  Saving model ...
Epoch: 15 cost time: 0.6067583560943604
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.628 Vali Acc: 0.305 Test Loss: 4.628 Test Acc: 0.305
Validation loss decreased (-0.303486 --> -0.304660).  Saving model ...
Epoch: 16 cost time: 0.7516837120056152
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.774 Vali Acc: 0.309 Test Loss: 4.774 Test Acc: 0.309
Validation loss decreased (-0.304660 --> -0.309364).  Saving model ...
Epoch: 17 cost time: 0.72896409034729
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.740 Vali Acc: 0.312 Test Loss: 4.740 Test Acc: 0.312
Validation loss decreased (-0.309364 --> -0.311717).  Saving model ...
Epoch: 18 cost time: 0.5757272243499756
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.725 Vali Acc: 0.324 Test Loss: 4.725 Test Acc: 0.324
Validation loss decreased (-0.311717 --> -0.323482).  Saving model ...
Epoch: 19 cost time: 0.6621875762939453
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.735 Vali Acc: 0.324 Test Loss: 4.735 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6299951076507568
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.773 Vali Acc: 0.320 Test Loss: 4.773 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7375478744506836
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.807 Vali Acc: 0.314 Test Loss: 4.807 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6922171115875244
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.995 Vali Acc: 0.307 Test Loss: 4.995 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.930234432220459
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.919 Vali Acc: 0.313 Test Loss: 4.919 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7018997669219971
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.870 Vali Acc: 0.318 Test Loss: 4.870 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6272203922271729
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.900 Vali Acc: 0.321 Test Loss: 4.900 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7096855640411377
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.974 Vali Acc: 0.316 Test Loss: 4.974 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7442429065704346
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.977 Vali Acc: 0.320 Test Loss: 4.977 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7706501483917236
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.995 Vali Acc: 0.322 Test Loss: 4.995 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 36895514
model size : 155.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.432556390762329
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.341 Vali Acc: 0.047 Test Loss: 3.341 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.7319703102111816
Epoch: 2, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.306 Vali Acc: 0.067 Test Loss: 3.306 Test Acc: 0.067
Validation loss decreased (-0.047025 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.6692104339599609
Epoch: 3, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.311 Vali Acc: 0.076 Test Loss: 3.311 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.7670600414276123
Epoch: 4, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.269 Vali Acc: 0.086 Test Loss: 3.269 Test Acc: 0.086
Validation loss decreased (-0.076437 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.755084753036499
Epoch: 5, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.246 Vali Acc: 0.094 Test Loss: 3.246 Test Acc: 0.094
Validation loss decreased (-0.085850 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.7221252918243408
Epoch: 6, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.222 Vali Acc: 0.119 Test Loss: 3.222 Test Acc: 0.119
Validation loss decreased (-0.094085 --> -0.118791).  Saving model ...
Epoch: 7 cost time: 0.9954643249511719
Epoch: 7, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.193 Vali Acc: 0.125 Test Loss: 3.193 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124674).  Saving model ...
Epoch: 8 cost time: 0.9003260135650635
Epoch: 8, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.193 Vali Acc: 0.185 Test Loss: 3.193 Test Acc: 0.185
Validation loss decreased (-0.124674 --> -0.184674).  Saving model ...
Epoch: 9 cost time: 0.8557548522949219
Epoch: 9, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.348 Vali Acc: 0.191 Test Loss: 3.348 Test Acc: 0.191
Validation loss decreased (-0.184674 --> -0.190555).  Saving model ...
Epoch: 10 cost time: 0.5659136772155762
Epoch: 10, Steps: 10 | Train Loss: 1.230 Vali Loss: 3.480 Vali Acc: 0.219 Test Loss: 3.480 Test Acc: 0.219
Validation loss decreased (-0.190555 --> -0.218789).  Saving model ...
Epoch: 11 cost time: 0.8759109973907471
Epoch: 11, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.569 Vali Acc: 0.244 Test Loss: 3.569 Test Acc: 0.244
Validation loss decreased (-0.218789 --> -0.243494).  Saving model ...
Epoch: 12 cost time: 0.7986154556274414
Epoch: 12, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.672 Vali Acc: 0.256 Test Loss: 3.672 Test Acc: 0.256
Validation loss decreased (-0.243494 --> -0.256434).  Saving model ...
Epoch: 13 cost time: 0.8106794357299805
Epoch: 13, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.783 Vali Acc: 0.262 Test Loss: 3.783 Test Acc: 0.262
Validation loss decreased (-0.256434 --> -0.262315).  Saving model ...
Epoch: 14 cost time: 0.7848951816558838
Epoch: 14, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.890 Vali Acc: 0.269 Test Loss: 3.890 Test Acc: 0.269
Validation loss decreased (-0.262315 --> -0.269373).  Saving model ...
Epoch: 15 cost time: 0.7432246208190918
Epoch: 15, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.029 Vali Acc: 0.275 Test Loss: 4.029 Test Acc: 0.275
Validation loss decreased (-0.269373 --> -0.275254).  Saving model ...
Epoch: 16 cost time: 0.7403566837310791
Epoch: 16, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.297 Vali Acc: 0.275 Test Loss: 4.297 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7085964679718018
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.313 Vali Acc: 0.278 Test Loss: 4.313 Test Acc: 0.278
Validation loss decreased (-0.275254 --> -0.277604).  Saving model ...
Epoch: 18 cost time: 0.6945686340332031
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.424 Vali Acc: 0.281 Test Loss: 4.424 Test Acc: 0.281
Validation loss decreased (-0.277604 --> -0.281132).  Saving model ...
Epoch: 19 cost time: 0.6753838062286377
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.406 Vali Acc: 0.285 Test Loss: 4.406 Test Acc: 0.285
Validation loss decreased (-0.281132 --> -0.284662).  Saving model ...
Epoch: 20 cost time: 0.6509914398193359
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.409 Vali Acc: 0.280 Test Loss: 4.409 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5944092273712158
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.467 Vali Acc: 0.286 Test Loss: 4.467 Test Acc: 0.286
Validation loss decreased (-0.284662 --> -0.285838).  Saving model ...
Epoch: 22 cost time: 0.6247594356536865
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.536 Vali Acc: 0.284 Test Loss: 4.536 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6109881401062012
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.543 Vali Acc: 0.287 Test Loss: 4.543 Test Acc: 0.287
Validation loss decreased (-0.285838 --> -0.287013).  Saving model ...
Epoch: 24 cost time: 0.621417760848999
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.551 Vali Acc: 0.289 Test Loss: 4.551 Test Acc: 0.289
Validation loss decreased (-0.287013 --> -0.289366).  Saving model ...
Epoch: 25 cost time: 0.7056477069854736
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.542 Vali Acc: 0.288 Test Loss: 4.542 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6781387329101562
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.551 Vali Acc: 0.293 Test Loss: 4.551 Test Acc: 0.293
Validation loss decreased (-0.289366 --> -0.292896).  Saving model ...
Epoch: 27 cost time: 0.8820383548736572
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.567 Vali Acc: 0.289 Test Loss: 4.567 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7411923408508301
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.602 Vali Acc: 0.288 Test Loss: 4.602 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7057197093963623
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.647 Vali Acc: 0.293 Test Loss: 4.647 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6051750183105469
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.653 Vali Acc: 0.296 Test Loss: 4.653 Test Acc: 0.296
Validation loss decreased (-0.292896 --> -0.296424).  Saving model ...
Epoch: 31 cost time: 0.6524264812469482
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.669 Vali Acc: 0.294 Test Loss: 4.669 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8056457042694092
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.684 Vali Acc: 0.292 Test Loss: 4.684 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.662625789642334
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.717 Vali Acc: 0.296 Test Loss: 4.717 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7547769546508789
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.717 Vali Acc: 0.300 Test Loss: 4.717 Test Acc: 0.300
Validation loss decreased (-0.296424 --> -0.299953).  Saving model ...
Epoch: 35 cost time: 0.6376082897186279
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.722 Vali Acc: 0.299 Test Loss: 4.722 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6516993045806885
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.727 Vali Acc: 0.295 Test Loss: 4.727 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6330087184906006
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.743 Vali Acc: 0.296 Test Loss: 4.743 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7179684638977051
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.750 Vali Acc: 0.301 Test Loss: 4.750 Test Acc: 0.301
Validation loss decreased (-0.299953 --> -0.301129).  Saving model ...
Epoch: 39 cost time: 0.5980281829833984
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.762 Vali Acc: 0.301 Test Loss: 4.762 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6415507793426514
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.755 Vali Acc: 0.305 Test Loss: 4.755 Test Acc: 0.305
Validation loss decreased (-0.301129 --> -0.304658).  Saving model ...
Epoch: 41 cost time: 0.6369876861572266
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.767 Vali Acc: 0.296 Test Loss: 4.767 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6522016525268555
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.799 Vali Acc: 0.296 Test Loss: 4.799 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6351816654205322
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.827 Vali Acc: 0.300 Test Loss: 4.827 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6357343196868896
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.843 Vali Acc: 0.296 Test Loss: 4.843 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.600191593170166
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.859 Vali Acc: 0.295 Test Loss: 4.859 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7676272392272949
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.875 Vali Acc: 0.298 Test Loss: 4.875 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6715538501739502
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.890 Vali Acc: 0.295 Test Loss: 4.890 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.742210865020752
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.893 Vali Acc: 0.294 Test Loss: 4.893 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6225895881652832
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.884 Vali Acc: 0.295 Test Loss: 4.884 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8053798675537109
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.887 Vali Acc: 0.298 Test Loss: 4.887 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 36701978
model size : 154.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0170187950134277
Epoch: 1, Steps: 10 | Train Loss: 3.425 Vali Loss: 3.358 Vali Acc: 0.049 Test Loss: 3.358 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.6565968990325928
Epoch: 2, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.302 Vali Acc: 0.033 Test Loss: 3.302 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6635463237762451
Epoch: 3, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.290 Vali Acc: 0.060 Test Loss: 3.290 Test Acc: 0.060
Validation loss decreased (-0.049378 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.5934774875640869
Epoch: 4, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.304 Vali Acc: 0.062 Test Loss: 3.304 Test Acc: 0.062
Validation loss decreased (-0.059967 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.515906810760498
Epoch: 5, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.305 Vali Acc: 0.066 Test Loss: 3.305 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 0.6107072830200195
Epoch: 6, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.267 Vali Acc: 0.104 Test Loss: 3.267 Test Acc: 0.104
Validation loss decreased (-0.065849 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 0.5660738945007324
Epoch: 7, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.247 Vali Acc: 0.116 Test Loss: 3.247 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 0.6608068943023682
Epoch: 8, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.214 Vali Acc: 0.125 Test Loss: 3.214 Test Acc: 0.125
Validation loss decreased (-0.116438 --> -0.124674).  Saving model ...
Epoch: 9 cost time: 0.6429777145385742
Epoch: 9, Steps: 10 | Train Loss: 2.395 Vali Loss: 3.192 Vali Acc: 0.139 Test Loss: 3.192 Test Acc: 0.139
Validation loss decreased (-0.124674 --> -0.138792).  Saving model ...
Epoch: 10 cost time: 0.5688896179199219
Epoch: 10, Steps: 10 | Train Loss: 2.015 Vali Loss: 3.184 Vali Acc: 0.171 Test Loss: 3.184 Test Acc: 0.171
Validation loss decreased (-0.138792 --> -0.170556).  Saving model ...
Epoch: 11 cost time: 0.6059825420379639
Epoch: 11, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.242 Vali Acc: 0.167 Test Loss: 3.242 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6651146411895752
Epoch: 12, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.314 Vali Acc: 0.202 Test Loss: 3.314 Test Acc: 0.202
Validation loss decreased (-0.170556 --> -0.202320).  Saving model ...
Epoch: 13 cost time: 0.5995502471923828
Epoch: 13, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.402 Vali Acc: 0.219 Test Loss: 3.402 Test Acc: 0.219
Validation loss decreased (-0.202320 --> -0.218790).  Saving model ...
Epoch: 14 cost time: 0.5564773082733154
Epoch: 14, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.478 Vali Acc: 0.239 Test Loss: 3.478 Test Acc: 0.239
Validation loss decreased (-0.218790 --> -0.238789).  Saving model ...
Epoch: 15 cost time: 0.6118831634521484
Epoch: 15, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.603 Vali Acc: 0.239 Test Loss: 3.603 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5759286880493164
Epoch: 16, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.676 Vali Acc: 0.259 Test Loss: 3.676 Test Acc: 0.259
Validation loss decreased (-0.238789 --> -0.258787).  Saving model ...
Epoch: 17 cost time: 0.6775259971618652
Epoch: 17, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.824 Vali Acc: 0.264 Test Loss: 3.824 Test Acc: 0.264
Validation loss decreased (-0.258787 --> -0.263491).  Saving model ...
Epoch: 18 cost time: 0.570364236831665
Epoch: 18, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.849 Vali Acc: 0.268 Test Loss: 3.849 Test Acc: 0.268
Validation loss decreased (-0.263491 --> -0.268197).  Saving model ...
Epoch: 19 cost time: 0.6002743244171143
Epoch: 19, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.005 Vali Acc: 0.261 Test Loss: 4.005 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.607170581817627
Epoch: 20, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.102 Vali Acc: 0.260 Test Loss: 4.102 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7848260402679443
Epoch: 21, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.116 Vali Acc: 0.275 Test Loss: 4.116 Test Acc: 0.275
Validation loss decreased (-0.268197 --> -0.275253).  Saving model ...
Epoch: 22 cost time: 0.5837478637695312
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.166 Vali Acc: 0.275 Test Loss: 4.166 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5225648880004883
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.259 Vali Acc: 0.275 Test Loss: 4.259 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5872180461883545
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.266 Vali Acc: 0.282 Test Loss: 4.266 Test Acc: 0.282
Validation loss decreased (-0.275253 --> -0.282310).  Saving model ...
Epoch: 25 cost time: 0.5933527946472168
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.280 Vali Acc: 0.280 Test Loss: 4.280 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5581498146057129
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.340 Vali Acc: 0.280 Test Loss: 4.340 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8179924488067627
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.387 Vali Acc: 0.284 Test Loss: 4.387 Test Acc: 0.284
Validation loss decreased (-0.282310 --> -0.283486).  Saving model ...
Epoch: 28 cost time: 0.5525031089782715
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.425 Vali Acc: 0.281 Test Loss: 4.425 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.49896907806396484
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.448 Vali Acc: 0.285 Test Loss: 4.448 Test Acc: 0.285
Validation loss decreased (-0.283486 --> -0.284661).  Saving model ...
Epoch: 30 cost time: 0.5074179172515869
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.465 Vali Acc: 0.282 Test Loss: 4.465 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5889558792114258
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.491 Vali Acc: 0.286 Test Loss: 4.491 Test Acc: 0.286
Validation loss decreased (-0.284661 --> -0.285837).  Saving model ...
Epoch: 32 cost time: 0.5655736923217773
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.508 Vali Acc: 0.286 Test Loss: 4.508 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7178776264190674
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.502 Vali Acc: 0.287 Test Loss: 4.502 Test Acc: 0.287
Validation loss decreased (-0.285837 --> -0.287014).  Saving model ...
Epoch: 34 cost time: 0.5457179546356201
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.512 Vali Acc: 0.285 Test Loss: 4.512 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.583629846572876
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.531 Vali Acc: 0.285 Test Loss: 4.531 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4861433506011963
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.524 Vali Acc: 0.281 Test Loss: 4.524 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.546328067779541
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.548 Vali Acc: 0.280 Test Loss: 4.548 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6055667400360107
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.564 Vali Acc: 0.282 Test Loss: 4.564 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.48355531692504883
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.603 Vali Acc: 0.288 Test Loss: 4.603 Test Acc: 0.288
Validation loss decreased (-0.287014 --> -0.288189).  Saving model ...
Epoch: 40 cost time: 0.5516092777252197
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.642 Vali Acc: 0.289 Test Loss: 4.642 Test Acc: 0.289
Validation loss decreased (-0.288189 --> -0.289365).  Saving model ...
Epoch: 41 cost time: 0.6453101634979248
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.659 Vali Acc: 0.288 Test Loss: 4.659 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7820158004760742
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.664 Vali Acc: 0.291 Test Loss: 4.664 Test Acc: 0.291
Validation loss decreased (-0.289365 --> -0.290542).  Saving model ...
Epoch: 43 cost time: 0.7824318408966064
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.696 Vali Acc: 0.291 Test Loss: 4.696 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7165310382843018
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.726 Vali Acc: 0.289 Test Loss: 4.726 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5574638843536377
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.734 Vali Acc: 0.287 Test Loss: 4.734 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6440300941467285
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.742 Vali Acc: 0.288 Test Loss: 4.742 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6913032531738281
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.765 Vali Acc: 0.284 Test Loss: 4.765 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5819368362426758
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.764 Vali Acc: 0.284 Test Loss: 4.764 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6424241065979004
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.779 Vali Acc: 0.288 Test Loss: 4.779 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6184930801391602
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.782 Vali Acc: 0.284 Test Loss: 4.782 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 36594458
model size : 154.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7090799808502197
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.335 Vali Acc: 0.044 Test Loss: 3.335 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.9384350776672363
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.357 Vali Acc: 0.054 Test Loss: 3.357 Test Acc: 0.054
Validation loss decreased (-0.043496 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.6250467300415039
Epoch: 3, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.361 Vali Acc: 0.054 Test Loss: 3.361 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6131119728088379
Epoch: 4, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.277 Vali Acc: 0.082 Test Loss: 3.277 Test Acc: 0.082
Validation loss decreased (-0.054084 --> -0.082320).  Saving model ...
Epoch: 5 cost time: 0.6208844184875488
Epoch: 5, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.209 Vali Acc: 0.120 Test Loss: 3.209 Test Acc: 0.120
Validation loss decreased (-0.082320 --> -0.119968).  Saving model ...
Epoch: 6 cost time: 0.8055195808410645
Epoch: 6, Steps: 10 | Train Loss: 2.401 Vali Loss: 3.239 Vali Acc: 0.144 Test Loss: 3.239 Test Acc: 0.144
Validation loss decreased (-0.119968 --> -0.143497).  Saving model ...
Epoch: 7 cost time: 0.6781961917877197
Epoch: 7, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.245 Vali Acc: 0.174 Test Loss: 3.245 Test Acc: 0.174
Validation loss decreased (-0.143497 --> -0.174085).  Saving model ...
Epoch: 8 cost time: 0.6094460487365723
Epoch: 8, Steps: 10 | Train Loss: 1.469 Vali Loss: 3.391 Vali Acc: 0.212 Test Loss: 3.391 Test Acc: 0.212
Validation loss decreased (-0.174085 --> -0.211731).  Saving model ...
Epoch: 9 cost time: 0.6399350166320801
Epoch: 9, Steps: 10 | Train Loss: 1.066 Vali Loss: 3.529 Vali Acc: 0.222 Test Loss: 3.529 Test Acc: 0.222
Validation loss decreased (-0.211731 --> -0.222318).  Saving model ...
Epoch: 10 cost time: 0.7047991752624512
Epoch: 10, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.789 Vali Acc: 0.252 Test Loss: 3.789 Test Acc: 0.252
Validation loss decreased (-0.222318 --> -0.251727).  Saving model ...
Epoch: 11 cost time: 0.6042490005493164
Epoch: 11, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.783 Vali Acc: 0.276 Test Loss: 3.783 Test Acc: 0.276
Validation loss decreased (-0.251727 --> -0.276433).  Saving model ...
Epoch: 12 cost time: 0.9958252906799316
Epoch: 12, Steps: 10 | Train Loss: 0.209 Vali Loss: 4.134 Vali Acc: 0.276 Test Loss: 4.134 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7656702995300293
Epoch: 13, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.326 Vali Acc: 0.266 Test Loss: 4.326 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7502100467681885
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.381 Vali Acc: 0.278 Test Loss: 4.381 Test Acc: 0.278
Validation loss decreased (-0.276433 --> -0.277603).  Saving model ...
Epoch: 15 cost time: 0.8756024837493896
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.518 Vali Acc: 0.282 Test Loss: 4.518 Test Acc: 0.282
Validation loss decreased (-0.277603 --> -0.282308).  Saving model ...
Epoch: 16 cost time: 0.5812704563140869
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.520 Vali Acc: 0.295 Test Loss: 4.520 Test Acc: 0.295
Validation loss decreased (-0.282308 --> -0.295249).  Saving model ...
Epoch: 17 cost time: 0.6103627681732178
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.616 Vali Acc: 0.281 Test Loss: 4.616 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6124231815338135
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.661 Vali Acc: 0.293 Test Loss: 4.661 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.570742130279541
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.661 Vali Acc: 0.293 Test Loss: 4.661 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7587261199951172
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.774 Vali Acc: 0.281 Test Loss: 4.774 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6497976779937744
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.656 Vali Acc: 0.295 Test Loss: 4.656 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6806540489196777
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.764 Vali Acc: 0.292 Test Loss: 4.764 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1605451107025146
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.805 Vali Acc: 0.298 Test Loss: 4.805 Test Acc: 0.298
Validation loss decreased (-0.295249 --> -0.297599).  Saving model ...
Epoch: 24 cost time: 0.7187092304229736
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.751 Vali Acc: 0.299 Test Loss: 4.751 Test Acc: 0.299
Validation loss decreased (-0.297599 --> -0.298776).  Saving model ...
Epoch: 25 cost time: 0.7071058750152588
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.739 Vali Acc: 0.295 Test Loss: 4.739 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6780266761779785
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.763 Vali Acc: 0.291 Test Loss: 4.763 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6746878623962402
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.788 Vali Acc: 0.289 Test Loss: 4.788 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5384485721588135
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.801 Vali Acc: 0.289 Test Loss: 4.801 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.058150053024292
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.834 Vali Acc: 0.292 Test Loss: 4.834 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6259400844573975
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.859 Vali Acc: 0.292 Test Loss: 4.859 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8821148872375488
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.876 Vali Acc: 0.296 Test Loss: 4.876 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6525962352752686
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.887 Vali Acc: 0.294 Test Loss: 4.887 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5788683891296387
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.889 Vali Acc: 0.295 Test Loss: 4.889 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7895405292510986
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.892 Vali Acc: 0.299 Test Loss: 4.892 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 36865562
model size : 155.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8888487815856934
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.322 Vali Acc: 0.041 Test Loss: 3.322 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.5980985164642334
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.312 Vali Acc: 0.040 Test Loss: 3.312 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6812012195587158
Epoch: 3, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.322 Vali Acc: 0.051 Test Loss: 3.322 Test Acc: 0.051
Validation loss decreased (-0.041143 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.551105260848999
Epoch: 4, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.337 Vali Acc: 0.071 Test Loss: 3.337 Test Acc: 0.071
Validation loss decreased (-0.050555 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 0.6549487113952637
Epoch: 5, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.287 Vali Acc: 0.089 Test Loss: 3.287 Test Acc: 0.089
Validation loss decreased (-0.070555 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 0.6167042255401611
Epoch: 6, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.250 Vali Acc: 0.114 Test Loss: 3.250 Test Acc: 0.114
Validation loss decreased (-0.089379 --> -0.114085).  Saving model ...
Epoch: 7 cost time: 0.7165052890777588
Epoch: 7, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.218 Vali Acc: 0.149 Test Loss: 3.218 Test Acc: 0.149
Validation loss decreased (-0.114085 --> -0.149380).  Saving model ...
Epoch: 8 cost time: 0.5825822353363037
Epoch: 8, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.216 Vali Acc: 0.171 Test Loss: 3.216 Test Acc: 0.171
Validation loss decreased (-0.149380 --> -0.170556).  Saving model ...
Epoch: 9 cost time: 0.7438101768493652
Epoch: 9, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.281 Vali Acc: 0.187 Test Loss: 3.281 Test Acc: 0.187
Validation loss decreased (-0.170556 --> -0.187026).  Saving model ...
Epoch: 10 cost time: 0.7723569869995117
Epoch: 10, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.425 Vali Acc: 0.205 Test Loss: 3.425 Test Acc: 0.205
Validation loss decreased (-0.187026 --> -0.204672).  Saving model ...
Epoch: 11 cost time: 0.4989304542541504
Epoch: 11, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.505 Vali Acc: 0.218 Test Loss: 3.505 Test Acc: 0.218
Validation loss decreased (-0.204672 --> -0.217612).  Saving model ...
Epoch: 12 cost time: 0.6516158580780029
Epoch: 12, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.565 Vali Acc: 0.247 Test Loss: 3.565 Test Acc: 0.247
Validation loss decreased (-0.217612 --> -0.247023).  Saving model ...
Epoch: 13 cost time: 0.6534709930419922
Epoch: 13, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.688 Vali Acc: 0.259 Test Loss: 3.688 Test Acc: 0.259
Validation loss decreased (-0.247023 --> -0.258787).  Saving model ...
Epoch: 14 cost time: 0.6882867813110352
Epoch: 14, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.802 Vali Acc: 0.267 Test Loss: 3.802 Test Acc: 0.267
Validation loss decreased (-0.258787 --> -0.267021).  Saving model ...
Epoch: 15 cost time: 0.7023379802703857
Epoch: 15, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.874 Vali Acc: 0.274 Test Loss: 3.874 Test Acc: 0.274
Validation loss decreased (-0.267021 --> -0.274079).  Saving model ...
Epoch: 16 cost time: 0.676800012588501
Epoch: 16, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.107 Vali Acc: 0.278 Test Loss: 4.107 Test Acc: 0.278
Validation loss decreased (-0.274079 --> -0.277606).  Saving model ...
Epoch: 17 cost time: 0.6648705005645752
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.148 Vali Acc: 0.278 Test Loss: 4.148 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8169887065887451
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.141 Vali Acc: 0.288 Test Loss: 4.141 Test Acc: 0.288
Validation loss decreased (-0.277606 --> -0.288194).  Saving model ...
Epoch: 19 cost time: 0.7398653030395508
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.283 Vali Acc: 0.281 Test Loss: 4.283 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6893711090087891
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.338 Vali Acc: 0.291 Test Loss: 4.338 Test Acc: 0.291
Validation loss decreased (-0.288194 --> -0.290545).  Saving model ...
Epoch: 21 cost time: 0.6922638416290283
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.334 Vali Acc: 0.288 Test Loss: 4.334 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6504011154174805
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.375 Vali Acc: 0.294 Test Loss: 4.375 Test Acc: 0.294
Validation loss decreased (-0.290545 --> -0.294074).  Saving model ...
Epoch: 23 cost time: 0.5681881904602051
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.445 Vali Acc: 0.299 Test Loss: 4.445 Test Acc: 0.299
Validation loss decreased (-0.294074 --> -0.298779).  Saving model ...
Epoch: 24 cost time: 0.6174795627593994
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.442 Vali Acc: 0.295 Test Loss: 4.442 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6867680549621582
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.482 Vali Acc: 0.302 Test Loss: 4.482 Test Acc: 0.302
Validation loss decreased (-0.298779 --> -0.302308).  Saving model ...
Epoch: 26 cost time: 0.867142915725708
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.518 Vali Acc: 0.299 Test Loss: 4.518 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.669471025466919
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.503 Vali Acc: 0.296 Test Loss: 4.503 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6912944316864014
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.531 Vali Acc: 0.298 Test Loss: 4.531 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7729599475860596
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.559 Vali Acc: 0.299 Test Loss: 4.559 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8053081035614014
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.560 Vali Acc: 0.296 Test Loss: 4.560 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7261128425598145
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.567 Vali Acc: 0.295 Test Loss: 4.567 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9208874702453613
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.566 Vali Acc: 0.298 Test Loss: 4.566 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7100083827972412
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.576 Vali Acc: 0.296 Test Loss: 4.576 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.724017858505249
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.601 Vali Acc: 0.298 Test Loss: 4.601 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7536346912384033
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.642 Vali Acc: 0.302 Test Loss: 4.642 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 36693530
model size : 154.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.29736590385437
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.338 Vali Acc: 0.054 Test Loss: 3.338 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 0.5634260177612305
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.315 Vali Acc: 0.052 Test Loss: 3.315 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6375792026519775
Epoch: 3, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.308 Vali Acc: 0.051 Test Loss: 3.308 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5908944606781006
Epoch: 4, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.298 Vali Acc: 0.061 Test Loss: 3.298 Test Acc: 0.061
Validation loss decreased (-0.054084 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 0.5840489864349365
Epoch: 5, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.288 Vali Acc: 0.072 Test Loss: 3.288 Test Acc: 0.072
Validation loss decreased (-0.061143 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.6171801090240479
Epoch: 6, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.281 Vali Acc: 0.082 Test Loss: 3.281 Test Acc: 0.082
Validation loss decreased (-0.071732 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 0.6431083679199219
Epoch: 7, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.264 Vali Acc: 0.104 Test Loss: 3.264 Test Acc: 0.104
Validation loss decreased (-0.082320 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.6948642730712891
Epoch: 8, Steps: 10 | Train Loss: 2.543 Vali Loss: 3.258 Vali Acc: 0.113 Test Loss: 3.258 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 0.5364384651184082
Epoch: 9, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.256 Vali Acc: 0.146 Test Loss: 3.256 Test Acc: 0.146
Validation loss decreased (-0.112909 --> -0.145850).  Saving model ...
Epoch: 10 cost time: 0.7667999267578125
Epoch: 10, Steps: 10 | Train Loss: 1.897 Vali Loss: 3.275 Vali Acc: 0.162 Test Loss: 3.275 Test Acc: 0.162
Validation loss decreased (-0.145850 --> -0.162320).  Saving model ...
Epoch: 11 cost time: 0.662151575088501
Epoch: 11, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.298 Vali Acc: 0.193 Test Loss: 3.298 Test Acc: 0.193
Validation loss decreased (-0.162320 --> -0.192908).  Saving model ...
Epoch: 12 cost time: 0.6946675777435303
Epoch: 12, Steps: 10 | Train Loss: 1.277 Vali Loss: 3.417 Vali Acc: 0.194 Test Loss: 3.417 Test Acc: 0.194
Validation loss decreased (-0.192908 --> -0.194083).  Saving model ...
Epoch: 13 cost time: 0.6056365966796875
Epoch: 13, Steps: 10 | Train Loss: 0.999 Vali Loss: 3.359 Vali Acc: 0.227 Test Loss: 3.359 Test Acc: 0.227
Validation loss decreased (-0.194083 --> -0.227025).  Saving model ...
Epoch: 14 cost time: 0.683734655380249
Epoch: 14, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.434 Vali Acc: 0.233 Test Loss: 3.434 Test Acc: 0.233
Validation loss decreased (-0.227025 --> -0.232907).  Saving model ...
Epoch: 15 cost time: 0.6785552501678467
Epoch: 15, Steps: 10 | Train Loss: 0.579 Vali Loss: 3.512 Vali Acc: 0.234 Test Loss: 3.512 Test Acc: 0.234
Validation loss decreased (-0.232907 --> -0.234083).  Saving model ...
Epoch: 16 cost time: 0.6070883274078369
Epoch: 16, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.559 Vali Acc: 0.260 Test Loss: 3.559 Test Acc: 0.260
Validation loss decreased (-0.234083 --> -0.259964).  Saving model ...
Epoch: 17 cost time: 0.6575181484222412
Epoch: 17, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.711 Vali Acc: 0.249 Test Loss: 3.711 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6493880748748779
Epoch: 18, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.744 Vali Acc: 0.271 Test Loss: 3.744 Test Acc: 0.271
Validation loss decreased (-0.259964 --> -0.270551).  Saving model ...
Epoch: 19 cost time: 0.7062819004058838
Epoch: 19, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.856 Vali Acc: 0.265 Test Loss: 3.856 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6801207065582275
Epoch: 20, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.850 Vali Acc: 0.276 Test Loss: 3.850 Test Acc: 0.276
Validation loss decreased (-0.270551 --> -0.276432).  Saving model ...
Epoch: 21 cost time: 0.6723511219024658
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.987 Vali Acc: 0.280 Test Loss: 3.987 Test Acc: 0.280
Validation loss decreased (-0.276432 --> -0.279960).  Saving model ...
Epoch: 22 cost time: 0.5996031761169434
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.041 Vali Acc: 0.292 Test Loss: 4.041 Test Acc: 0.292
Validation loss decreased (-0.279960 --> -0.291724).  Saving model ...
Epoch: 23 cost time: 0.689453125
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.075 Vali Acc: 0.281 Test Loss: 4.075 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6466755867004395
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.077 Vali Acc: 0.286 Test Loss: 4.077 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6270596981048584
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.115 Vali Acc: 0.289 Test Loss: 4.115 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5750160217285156
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.155 Vali Acc: 0.292 Test Loss: 4.155 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5885088443756104
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.173 Vali Acc: 0.289 Test Loss: 4.173 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5920140743255615
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.202 Vali Acc: 0.287 Test Loss: 4.202 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5726134777069092
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.230 Vali Acc: 0.292 Test Loss: 4.230 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6247570514678955
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.269 Vali Acc: 0.295 Test Loss: 4.269 Test Acc: 0.295
Validation loss decreased (-0.291724 --> -0.295251).  Saving model ...
Epoch: 31 cost time: 0.9141707420349121
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.302 Vali Acc: 0.295 Test Loss: 4.302 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8488304615020752
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.307 Vali Acc: 0.294 Test Loss: 4.307 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6783020496368408
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.326 Vali Acc: 0.293 Test Loss: 4.326 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6131277084350586
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.356 Vali Acc: 0.289 Test Loss: 4.356 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.643298864364624
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.381 Vali Acc: 0.289 Test Loss: 4.381 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6187515258789062
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.389 Vali Acc: 0.295 Test Loss: 4.389 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.74666428565979
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.393 Vali Acc: 0.292 Test Loss: 4.393 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6475958824157715
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.418 Vali Acc: 0.292 Test Loss: 4.418 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7778112888336182
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.448 Vali Acc: 0.294 Test Loss: 4.448 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5433239936828613
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.482 Vali Acc: 0.294 Test Loss: 4.482 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el5_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2952941176470588
model parameter : 36607514
model size : 154.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.276615858078003
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.396 Vali Acc: 0.041 Test Loss: 3.396 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.0824625492095947
Epoch: 2, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.347 Vali Acc: 0.100 Test Loss: 3.347 Test Acc: 0.100
Validation loss decreased (-0.041143 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 1.278834342956543
Epoch: 3, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.261 Vali Acc: 0.113 Test Loss: 3.261 Test Acc: 0.113
Validation loss decreased (-0.099967 --> -0.112909).  Saving model ...
Epoch: 4 cost time: 0.9834210872650146
Epoch: 4, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.127 Vali Acc: 0.135 Test Loss: 3.127 Test Acc: 0.135
Validation loss decreased (-0.112909 --> -0.135263).  Saving model ...
Epoch: 5 cost time: 1.2207870483398438
Epoch: 5, Steps: 10 | Train Loss: 1.931 Vali Loss: 3.273 Vali Acc: 0.179 Test Loss: 3.273 Test Acc: 0.179
Validation loss decreased (-0.135263 --> -0.178791).  Saving model ...
Epoch: 6 cost time: 1.115962266921997
Epoch: 6, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.409 Vali Acc: 0.189 Test Loss: 3.409 Test Acc: 0.189
Validation loss decreased (-0.178791 --> -0.189378).  Saving model ...
Epoch: 7 cost time: 1.363734483718872
Epoch: 7, Steps: 10 | Train Loss: 0.944 Vali Loss: 4.007 Vali Acc: 0.224 Test Loss: 4.007 Test Acc: 0.224
Validation loss decreased (-0.189378 --> -0.223489).  Saving model ...
Epoch: 8 cost time: 1.6678338050842285
Epoch: 8, Steps: 10 | Train Loss: 0.531 Vali Loss: 4.366 Vali Acc: 0.246 Test Loss: 4.366 Test Acc: 0.246
Validation loss decreased (-0.223489 --> -0.245839).  Saving model ...
Epoch: 9 cost time: 1.6671020984649658
Epoch: 9, Steps: 10 | Train Loss: 0.224 Vali Loss: 5.203 Vali Acc: 0.256 Test Loss: 5.203 Test Acc: 0.256
Validation loss decreased (-0.245839 --> -0.256419).  Saving model ...
Epoch: 10 cost time: 0.8844425678253174
Epoch: 10, Steps: 10 | Train Loss: 0.119 Vali Loss: 6.175 Vali Acc: 0.241 Test Loss: 6.175 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9608304500579834
Epoch: 11, Steps: 10 | Train Loss: 0.099 Vali Loss: 6.980 Vali Acc: 0.245 Test Loss: 6.980 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0133845806121826
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 7.751 Vali Acc: 0.219 Test Loss: 7.751 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.38368821144104
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 8.476 Vali Acc: 0.236 Test Loss: 8.476 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4250948429107666
Epoch: 14, Steps: 10 | Train Loss: 0.201 Vali Loss: 8.562 Vali Acc: 0.233 Test Loss: 8.562 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1147851943969727
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 9.734 Vali Acc: 0.238 Test Loss: 9.734 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0931117534637451
Epoch: 16, Steps: 10 | Train Loss: 0.258 Vali Loss: 11.271 Vali Acc: 0.201 Test Loss: 11.271 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8223590850830078
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 9.474 Vali Acc: 0.255 Test Loss: 9.474 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3821945190429688
Epoch: 18, Steps: 10 | Train Loss: 0.085 Vali Loss: 11.129 Vali Acc: 0.232 Test Loss: 11.129 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2139077186584473
Epoch: 19, Steps: 10 | Train Loss: 0.276 Vali Loss: 11.795 Vali Acc: 0.220 Test Loss: 11.795 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 30837530
model size : 132.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4166579246520996
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.318 Vali Acc: 0.045 Test Loss: 3.318 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.9223241806030273
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.386 Vali Acc: 0.069 Test Loss: 3.386 Test Acc: 0.069
Validation loss decreased (-0.044673 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.8713240623474121
Epoch: 3, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.253 Vali Acc: 0.105 Test Loss: 3.253 Test Acc: 0.105
Validation loss decreased (-0.069378 --> -0.104673).  Saving model ...
Epoch: 4 cost time: 0.9602518081665039
Epoch: 4, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.223 Vali Acc: 0.131 Test Loss: 3.223 Test Acc: 0.131
Validation loss decreased (-0.104673 --> -0.130556).  Saving model ...
Epoch: 5 cost time: 0.7093803882598877
Epoch: 5, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.230 Vali Acc: 0.142 Test Loss: 3.230 Test Acc: 0.142
Validation loss decreased (-0.130556 --> -0.142321).  Saving model ...
Epoch: 6 cost time: 0.8057961463928223
Epoch: 6, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.158 Vali Acc: 0.208 Test Loss: 3.158 Test Acc: 0.208
Validation loss decreased (-0.142321 --> -0.208204).  Saving model ...
Epoch: 7 cost time: 0.7146117687225342
Epoch: 7, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.640 Vali Acc: 0.193 Test Loss: 3.640 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7441110610961914
Epoch: 8, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.922 Vali Acc: 0.232 Test Loss: 3.922 Test Acc: 0.232
Validation loss decreased (-0.208204 --> -0.231725).  Saving model ...
Epoch: 9 cost time: 0.5565750598907471
Epoch: 9, Steps: 10 | Train Loss: 0.596 Vali Loss: 4.265 Vali Acc: 0.268 Test Loss: 4.265 Test Acc: 0.268
Validation loss decreased (-0.231725 --> -0.268193).  Saving model ...
Epoch: 10 cost time: 0.6677370071411133
Epoch: 10, Steps: 10 | Train Loss: 0.341 Vali Loss: 4.669 Vali Acc: 0.246 Test Loss: 4.669 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6524593830108643
Epoch: 11, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.992 Vali Acc: 0.267 Test Loss: 4.992 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7395923137664795
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 5.672 Vali Acc: 0.242 Test Loss: 5.672 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.760512113571167
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.746 Vali Acc: 0.258 Test Loss: 5.746 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7386527061462402
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.847 Vali Acc: 0.255 Test Loss: 5.847 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.792762041091919
Epoch: 15, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.067 Vali Acc: 0.281 Test Loss: 6.067 Test Acc: 0.281
Validation loss decreased (-0.268193 --> -0.281116).  Saving model ...
Epoch: 16 cost time: 0.7737691402435303
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 6.226 Vali Acc: 0.247 Test Loss: 6.226 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7284767627716064
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 6.315 Vali Acc: 0.278 Test Loss: 6.315 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.566720724105835
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.140 Vali Acc: 0.280 Test Loss: 6.140 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5774843692779541
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.563 Vali Acc: 0.287 Test Loss: 6.563 Test Acc: 0.287
Validation loss decreased (-0.281116 --> -0.286993).  Saving model ...
Epoch: 20 cost time: 1.1463594436645508
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.242 Vali Acc: 0.284 Test Loss: 6.242 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1267611980438232
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.213 Vali Acc: 0.295 Test Loss: 6.213 Test Acc: 0.295
Validation loss decreased (-0.286993 --> -0.295232).  Saving model ...
Epoch: 22 cost time: 0.9538962841033936
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.165 Vali Acc: 0.302 Test Loss: 6.165 Test Acc: 0.302
Validation loss decreased (-0.295232 --> -0.302291).  Saving model ...
Epoch: 23 cost time: 1.125990629196167
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.363 Vali Acc: 0.300 Test Loss: 6.363 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0752146244049072
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.227 Vali Acc: 0.307 Test Loss: 6.227 Test Acc: 0.307
Validation loss decreased (-0.302291 --> -0.306997).  Saving model ...
Epoch: 25 cost time: 1.0354230403900146
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.134 Vali Acc: 0.307 Test Loss: 6.134 Test Acc: 0.307
Validation loss decreased (-0.306997 --> -0.306997).  Saving model ...
Epoch: 26 cost time: 0.8654427528381348
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.164 Vali Acc: 0.305 Test Loss: 6.164 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7585620880126953
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.220 Vali Acc: 0.305 Test Loss: 6.220 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9581701755523682
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.254 Vali Acc: 0.305 Test Loss: 6.254 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8642542362213135
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.258 Vali Acc: 0.306 Test Loss: 6.258 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1851329803466797
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.280 Vali Acc: 0.307 Test Loss: 6.280 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9754750728607178
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.303 Vali Acc: 0.304 Test Loss: 6.303 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6128067970275879
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.319 Vali Acc: 0.302 Test Loss: 6.319 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6809811592102051
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.325 Vali Acc: 0.302 Test Loss: 6.325 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9039757251739502
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.336 Vali Acc: 0.304 Test Loss: 6.336 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7430887222290039
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.346 Vali Acc: 0.302 Test Loss: 6.346 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 30063386
model size : 129.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1514995098114014
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.302 Vali Acc: 0.051 Test Loss: 3.302 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.47707056999206543
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.342 Vali Acc: 0.066 Test Loss: 3.342 Test Acc: 0.066
Validation loss decreased (-0.050555 --> -0.065849).  Saving model ...
Epoch: 3 cost time: 0.6674654483795166
Epoch: 3, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.331 Vali Acc: 0.082 Test Loss: 3.331 Test Acc: 0.082
Validation loss decreased (-0.065849 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 1.3126235008239746
Epoch: 4, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.234 Vali Acc: 0.107 Test Loss: 3.234 Test Acc: 0.107
Validation loss decreased (-0.082320 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.6208484172821045
Epoch: 5, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.202 Vali Acc: 0.124 Test Loss: 3.202 Test Acc: 0.124
Validation loss decreased (-0.107026 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 1.0591018199920654
Epoch: 6, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.166 Vali Acc: 0.181 Test Loss: 3.166 Test Acc: 0.181
Validation loss decreased (-0.123497 --> -0.181145).  Saving model ...
Epoch: 7 cost time: 0.6145646572113037
Epoch: 7, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.226 Vali Acc: 0.191 Test Loss: 3.226 Test Acc: 0.191
Validation loss decreased (-0.181145 --> -0.190556).  Saving model ...
Epoch: 8 cost time: 0.9105832576751709
Epoch: 8, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.424 Vali Acc: 0.201 Test Loss: 3.424 Test Acc: 0.201
Validation loss decreased (-0.190556 --> -0.201142).  Saving model ...
Epoch: 9 cost time: 0.5751168727874756
Epoch: 9, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.654 Vali Acc: 0.236 Test Loss: 3.654 Test Acc: 0.236
Validation loss decreased (-0.201142 --> -0.236434).  Saving model ...
Epoch: 10 cost time: 0.568497896194458
Epoch: 10, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.895 Vali Acc: 0.229 Test Loss: 3.895 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5512380599975586
Epoch: 11, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.958 Vali Acc: 0.264 Test Loss: 3.958 Test Acc: 0.264
Validation loss decreased (-0.236434 --> -0.263490).  Saving model ...
Epoch: 12 cost time: 0.939424991607666
Epoch: 12, Steps: 10 | Train Loss: 0.211 Vali Loss: 4.402 Vali Acc: 0.232 Test Loss: 4.402 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5085494518280029
Epoch: 13, Steps: 10 | Train Loss: 0.220 Vali Loss: 4.479 Vali Acc: 0.265 Test Loss: 4.479 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264661).  Saving model ...
Epoch: 14 cost time: 0.7028324604034424
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.709 Vali Acc: 0.269 Test Loss: 4.709 Test Acc: 0.269
Validation loss decreased (-0.264661 --> -0.269365).  Saving model ...
Epoch: 15 cost time: 0.6214432716369629
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.890 Vali Acc: 0.269 Test Loss: 4.890 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5605888366699219
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.901 Vali Acc: 0.278 Test Loss: 4.901 Test Acc: 0.278
Validation loss decreased (-0.269365 --> -0.277598).  Saving model ...
Epoch: 17 cost time: 0.6574549674987793
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.941 Vali Acc: 0.295 Test Loss: 4.941 Test Acc: 0.295
Validation loss decreased (-0.277598 --> -0.295245).  Saving model ...
Epoch: 18 cost time: 0.6919851303100586
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.035 Vali Acc: 0.295 Test Loss: 5.035 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8035457134246826
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.102 Vali Acc: 0.305 Test Loss: 5.102 Test Acc: 0.305
Validation loss decreased (-0.295245 --> -0.304655).  Saving model ...
Epoch: 20 cost time: 0.6286802291870117
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.121 Vali Acc: 0.298 Test Loss: 5.121 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6769003868103027
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.110 Vali Acc: 0.304 Test Loss: 5.110 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7515888214111328
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.098 Vali Acc: 0.308 Test Loss: 5.098 Test Acc: 0.308
Validation loss decreased (-0.304655 --> -0.308184).  Saving model ...
Epoch: 23 cost time: 0.7599859237670898
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.074 Vali Acc: 0.314 Test Loss: 5.074 Test Acc: 0.314
Validation loss decreased (-0.308184 --> -0.314067).  Saving model ...
Epoch: 24 cost time: 0.5992891788482666
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.123 Vali Acc: 0.311 Test Loss: 5.123 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8108289241790771
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.174 Vali Acc: 0.318 Test Loss: 5.174 Test Acc: 0.318
Validation loss decreased (-0.314067 --> -0.317595).  Saving model ...
Epoch: 26 cost time: 0.8376526832580566
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.192 Vali Acc: 0.312 Test Loss: 5.192 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6433088779449463
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.232 Vali Acc: 0.308 Test Loss: 5.232 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6118831634521484
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.241 Vali Acc: 0.308 Test Loss: 5.241 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6518104076385498
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.253 Vali Acc: 0.315 Test Loss: 5.253 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5694594383239746
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.259 Vali Acc: 0.314 Test Loss: 5.259 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9530243873596191
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.263 Vali Acc: 0.313 Test Loss: 5.263 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6801726818084717
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.261 Vali Acc: 0.311 Test Loss: 5.261 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2629213333129883
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.264 Vali Acc: 0.308 Test Loss: 5.264 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6976490020751953
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.270 Vali Acc: 0.311 Test Loss: 5.270 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7072305679321289
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.264 Vali Acc: 0.312 Test Loss: 5.264 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 29719322
model size : 128.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.304866313934326
Epoch: 1, Steps: 10 | Train Loss: 3.508 Vali Loss: 3.354 Vali Acc: 0.058 Test Loss: 3.354 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.8527202606201172
Epoch: 2, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.364 Vali Acc: 0.072 Test Loss: 3.364 Test Acc: 0.072
Validation loss decreased (-0.057614 --> -0.071731).  Saving model ...
Epoch: 3 cost time: 1.2139172554016113
Epoch: 3, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.217 Vali Acc: 0.108 Test Loss: 3.217 Test Acc: 0.108
Validation loss decreased (-0.071731 --> -0.108203).  Saving model ...
Epoch: 4 cost time: 1.3323683738708496
Epoch: 4, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.267 Vali Acc: 0.153 Test Loss: 3.267 Test Acc: 0.153
Validation loss decreased (-0.108203 --> -0.152909).  Saving model ...
Epoch: 5 cost time: 0.9655954837799072
Epoch: 5, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.156 Vali Acc: 0.186 Test Loss: 3.156 Test Acc: 0.186
Validation loss decreased (-0.152909 --> -0.185851).  Saving model ...
Epoch: 6 cost time: 1.3972923755645752
Epoch: 6, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.395 Vali Acc: 0.215 Test Loss: 3.395 Test Acc: 0.215
Validation loss decreased (-0.185851 --> -0.215260).  Saving model ...
Epoch: 7 cost time: 1.2453765869140625
Epoch: 7, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.882 Vali Acc: 0.227 Test Loss: 3.882 Test Acc: 0.227
Validation loss decreased (-0.215260 --> -0.227020).  Saving model ...
Epoch: 8 cost time: 0.9987761974334717
Epoch: 8, Steps: 10 | Train Loss: 0.471 Vali Loss: 4.788 Vali Acc: 0.244 Test Loss: 4.788 Test Acc: 0.244
Validation loss decreased (-0.227020 --> -0.243482).  Saving model ...
Epoch: 9 cost time: 1.171050786972046
Epoch: 9, Steps: 10 | Train Loss: 0.298 Vali Loss: 5.606 Vali Acc: 0.232 Test Loss: 5.606 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9234340190887451
Epoch: 10, Steps: 10 | Train Loss: 0.275 Vali Loss: 5.984 Vali Acc: 0.276 Test Loss: 5.984 Test Acc: 0.276
Validation loss decreased (-0.243482 --> -0.276411).  Saving model ...
Epoch: 11 cost time: 0.9384975433349609
Epoch: 11, Steps: 10 | Train Loss: 0.240 Vali Loss: 7.649 Vali Acc: 0.195 Test Loss: 7.649 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8450403213500977
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 6.870 Vali Acc: 0.264 Test Loss: 6.870 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.934969425201416
Epoch: 13, Steps: 10 | Train Loss: 0.128 Vali Loss: 8.362 Vali Acc: 0.233 Test Loss: 8.362 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0502829551696777
Epoch: 14, Steps: 10 | Train Loss: 0.336 Vali Loss: 8.632 Vali Acc: 0.255 Test Loss: 8.632 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9353435039520264
Epoch: 15, Steps: 10 | Train Loss: 0.384 Vali Loss: 8.884 Vali Acc: 0.252 Test Loss: 8.884 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.117478370666504
Epoch: 16, Steps: 10 | Train Loss: 0.220 Vali Loss: 9.710 Vali Acc: 0.239 Test Loss: 9.710 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8196463584899902
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 9.121 Vali Acc: 0.240 Test Loss: 9.121 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.075779676437378
Epoch: 18, Steps: 10 | Train Loss: 0.080 Vali Loss: 9.949 Vali Acc: 0.234 Test Loss: 9.949 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0543603897094727
Epoch: 19, Steps: 10 | Train Loss: 0.190 Vali Loss: 10.142 Vali Acc: 0.231 Test Loss: 10.142 Test Acc: 0.231
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3363518714904785
Epoch: 20, Steps: 10 | Train Loss: 0.225 Vali Loss: 9.599 Vali Acc: 0.231 Test Loss: 9.599 Test Acc: 0.231
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 30844442
model size : 132.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.008922576904297
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.350 Vali Acc: 0.040 Test Loss: 3.350 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.7304482460021973
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.380 Vali Acc: 0.075 Test Loss: 3.380 Test Acc: 0.075
Validation loss decreased (-0.039966 --> -0.075260).  Saving model ...
Epoch: 3 cost time: 0.9696917533874512
Epoch: 3, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.265 Vali Acc: 0.099 Test Loss: 3.265 Test Acc: 0.099
Validation loss decreased (-0.075260 --> -0.098791).  Saving model ...
Epoch: 4 cost time: 0.802703857421875
Epoch: 4, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.285 Vali Acc: 0.122 Test Loss: 3.285 Test Acc: 0.122
Validation loss decreased (-0.098791 --> -0.122320).  Saving model ...
Epoch: 5 cost time: 0.6806707382202148
Epoch: 5, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.141 Vali Acc: 0.140 Test Loss: 3.141 Test Acc: 0.140
Validation loss decreased (-0.122320 --> -0.139969).  Saving model ...
Epoch: 6 cost time: 0.7731916904449463
Epoch: 6, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.256 Vali Acc: 0.179 Test Loss: 3.256 Test Acc: 0.179
Validation loss decreased (-0.139969 --> -0.178791).  Saving model ...
Epoch: 7 cost time: 0.9227509498596191
Epoch: 7, Steps: 10 | Train Loss: 1.383 Vali Loss: 3.400 Vali Acc: 0.212 Test Loss: 3.400 Test Acc: 0.212
Validation loss decreased (-0.178791 --> -0.211731).  Saving model ...
Epoch: 8 cost time: 0.7051794528961182
Epoch: 8, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.899 Vali Acc: 0.234 Test Loss: 3.899 Test Acc: 0.234
Validation loss decreased (-0.211731 --> -0.234079).  Saving model ...
Epoch: 9 cost time: 0.7333724498748779
Epoch: 9, Steps: 10 | Train Loss: 0.519 Vali Loss: 4.358 Vali Acc: 0.247 Test Loss: 4.358 Test Acc: 0.247
Validation loss decreased (-0.234079 --> -0.247015).  Saving model ...
Epoch: 10 cost time: 1.2514102458953857
Epoch: 10, Steps: 10 | Train Loss: 0.357 Vali Loss: 4.661 Vali Acc: 0.282 Test Loss: 4.661 Test Acc: 0.282
Validation loss decreased (-0.247015 --> -0.282306).  Saving model ...
Epoch: 11 cost time: 1.1701817512512207
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.947 Vali Acc: 0.259 Test Loss: 4.947 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.930171012878418
Epoch: 12, Steps: 10 | Train Loss: 0.121 Vali Loss: 5.060 Vali Acc: 0.287 Test Loss: 5.060 Test Acc: 0.287
Validation loss decreased (-0.282306 --> -0.287008).  Saving model ...
Epoch: 13 cost time: 1.3459324836730957
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 5.357 Vali Acc: 0.282 Test Loss: 5.357 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8228104114532471
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 5.428 Vali Acc: 0.259 Test Loss: 5.428 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8732120990753174
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 5.706 Vali Acc: 0.291 Test Loss: 5.706 Test Acc: 0.291
Validation loss decreased (-0.287008 --> -0.290531).  Saving model ...
Epoch: 16 cost time: 0.7344632148742676
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.921 Vali Acc: 0.286 Test Loss: 5.921 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8839695453643799
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.999 Vali Acc: 0.280 Test Loss: 5.999 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6593937873840332
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.941 Vali Acc: 0.276 Test Loss: 5.941 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5303115844726562
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 6.024 Vali Acc: 0.295 Test Loss: 6.024 Test Acc: 0.295
Validation loss decreased (-0.290531 --> -0.295234).  Saving model ...
Epoch: 20 cost time: 0.5862023830413818
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.396 Vali Acc: 0.292 Test Loss: 6.396 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5544328689575195
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.617 Vali Acc: 0.293 Test Loss: 6.617 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6104917526245117
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.536 Vali Acc: 0.304 Test Loss: 6.536 Test Acc: 0.304
Validation loss decreased (-0.295234 --> -0.303464).  Saving model ...
Epoch: 23 cost time: 0.7376859188079834
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.405 Vali Acc: 0.308 Test Loss: 6.405 Test Acc: 0.308
Validation loss decreased (-0.303464 --> -0.308171).  Saving model ...
Epoch: 24 cost time: 0.7680354118347168
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.379 Vali Acc: 0.308 Test Loss: 6.379 Test Acc: 0.308
Validation loss decreased (-0.308171 --> -0.308172).  Saving model ...
Epoch: 25 cost time: 1.0435400009155273
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.317 Vali Acc: 0.306 Test Loss: 6.317 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6957471370697021
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.332 Vali Acc: 0.306 Test Loss: 6.332 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9729311466217041
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.334 Vali Acc: 0.309 Test Loss: 6.334 Test Acc: 0.309
Validation loss decreased (-0.308172 --> -0.309348).  Saving model ...
Epoch: 28 cost time: 0.6643772125244141
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.347 Vali Acc: 0.318 Test Loss: 6.347 Test Acc: 0.318
Validation loss decreased (-0.309348 --> -0.317584).  Saving model ...
Epoch: 29 cost time: 0.7377200126647949
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.372 Vali Acc: 0.313 Test Loss: 6.372 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8286731243133545
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.363 Vali Acc: 0.312 Test Loss: 6.363 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8250861167907715
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.334 Vali Acc: 0.314 Test Loss: 6.334 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6059277057647705
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.323 Vali Acc: 0.311 Test Loss: 6.323 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5753300189971924
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.309 Vali Acc: 0.314 Test Loss: 6.309 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5615897178649902
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.302 Vali Acc: 0.315 Test Loss: 6.302 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6494276523590088
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.307 Vali Acc: 0.318 Test Loss: 6.307 Test Acc: 0.318
Validation loss decreased (-0.317584 --> -0.317584).  Saving model ...
Epoch: 36 cost time: 0.682234525680542
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.327 Vali Acc: 0.318 Test Loss: 6.327 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7521846294403076
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.341 Vali Acc: 0.315 Test Loss: 6.341 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7877452373504639
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.343 Vali Acc: 0.315 Test Loss: 6.343 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8462185859680176
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.350 Vali Acc: 0.316 Test Loss: 6.350 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6727235317230225
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.366 Vali Acc: 0.319 Test Loss: 6.366 Test Acc: 0.319
Validation loss decreased (-0.317584 --> -0.318760).  Saving model ...
Epoch: 41 cost time: 0.7599480152130127
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.371 Vali Acc: 0.318 Test Loss: 6.371 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6548428535461426
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.376 Vali Acc: 0.319 Test Loss: 6.376 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0275025367736816
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.375 Vali Acc: 0.319 Test Loss: 6.375 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.79911208152771
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.373 Vali Acc: 0.318 Test Loss: 6.373 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7223355770111084
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.372 Vali Acc: 0.318 Test Loss: 6.372 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9587674140930176
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.372 Vali Acc: 0.316 Test Loss: 6.372 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9264042377471924
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.360 Vali Acc: 0.316 Test Loss: 6.360 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7242276668548584
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.360 Vali Acc: 0.322 Test Loss: 6.360 Test Acc: 0.322
Validation loss decreased (-0.318760 --> -0.322289).  Saving model ...
Epoch: 49 cost time: 0.6461551189422607
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.363 Vali Acc: 0.321 Test Loss: 6.363 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6189043521881104
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.360 Vali Acc: 0.319 Test Loss: 6.360 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 30070298
model size : 129.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6944921016693115
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.292 Vali Acc: 0.046 Test Loss: 3.292 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.5609550476074219
Epoch: 2, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.379 Vali Acc: 0.068 Test Loss: 3.379 Test Acc: 0.068
Validation loss decreased (-0.045849 --> -0.068201).  Saving model ...
Epoch: 3 cost time: 0.5368473529815674
Epoch: 3, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.348 Vali Acc: 0.075 Test Loss: 3.348 Test Acc: 0.075
Validation loss decreased (-0.068201 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.5402772426605225
Epoch: 4, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.250 Vali Acc: 0.114 Test Loss: 3.250 Test Acc: 0.114
Validation loss decreased (-0.075261 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.5668883323669434
Epoch: 5, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.209 Vali Acc: 0.116 Test Loss: 3.209 Test Acc: 0.116
Validation loss decreased (-0.114085 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 0.7316052913665771
Epoch: 6, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.122 Vali Acc: 0.140 Test Loss: 3.122 Test Acc: 0.140
Validation loss decreased (-0.116438 --> -0.139969).  Saving model ...
Epoch: 7 cost time: 0.5002703666687012
Epoch: 7, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.131 Vali Acc: 0.181 Test Loss: 3.131 Test Acc: 0.181
Validation loss decreased (-0.139969 --> -0.181145).  Saving model ...
Epoch: 8 cost time: 0.7578537464141846
Epoch: 8, Steps: 10 | Train Loss: 1.613 Vali Loss: 3.189 Vali Acc: 0.215 Test Loss: 3.189 Test Acc: 0.215
Validation loss decreased (-0.181145 --> -0.215262).  Saving model ...
Epoch: 9 cost time: 0.8532962799072266
Epoch: 9, Steps: 10 | Train Loss: 1.171 Vali Loss: 3.362 Vali Acc: 0.244 Test Loss: 3.362 Test Acc: 0.244
Validation loss decreased (-0.215262 --> -0.243496).  Saving model ...
Epoch: 10 cost time: 0.6059408187866211
Epoch: 10, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.657 Vali Acc: 0.259 Test Loss: 3.657 Test Acc: 0.259
Validation loss decreased (-0.243496 --> -0.258787).  Saving model ...
Epoch: 11 cost time: 0.5174965858459473
Epoch: 11, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.708 Vali Acc: 0.281 Test Loss: 3.708 Test Acc: 0.281
Validation loss decreased (-0.258787 --> -0.281139).  Saving model ...
Epoch: 12 cost time: 0.535240888595581
Epoch: 12, Steps: 10 | Train Loss: 0.306 Vali Loss: 4.035 Vali Acc: 0.267 Test Loss: 4.035 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7663435935974121
Epoch: 13, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.119 Vali Acc: 0.291 Test Loss: 4.119 Test Acc: 0.291
Validation loss decreased (-0.281139 --> -0.290547).  Saving model ...
Epoch: 14 cost time: 0.6664376258850098
Epoch: 14, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.340 Vali Acc: 0.287 Test Loss: 4.340 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5542123317718506
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.351 Vali Acc: 0.301 Test Loss: 4.351 Test Acc: 0.301
Validation loss decreased (-0.290547 --> -0.301133).  Saving model ...
Epoch: 16 cost time: 0.8422787189483643
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.538 Vali Acc: 0.313 Test Loss: 4.538 Test Acc: 0.313
Validation loss decreased (-0.301133 --> -0.312896).  Saving model ...
Epoch: 17 cost time: 0.6313714981079102
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.827 Vali Acc: 0.280 Test Loss: 4.827 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6421136856079102
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.816 Vali Acc: 0.302 Test Loss: 4.816 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6885581016540527
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.958 Vali Acc: 0.309 Test Loss: 4.958 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6139669418334961
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.931 Vali Acc: 0.307 Test Loss: 4.931 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7667467594146729
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.962 Vali Acc: 0.304 Test Loss: 4.962 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5860247611999512
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.998 Vali Acc: 0.307 Test Loss: 4.998 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5541877746582031
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.977 Vali Acc: 0.321 Test Loss: 4.977 Test Acc: 0.321
Validation loss decreased (-0.312896 --> -0.321127).  Saving model ...
Epoch: 24 cost time: 0.6779012680053711
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.027 Vali Acc: 0.319 Test Loss: 5.027 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.514533281326294
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.055 Vali Acc: 0.315 Test Loss: 5.055 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6084480285644531
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.024 Vali Acc: 0.322 Test Loss: 5.024 Test Acc: 0.322
Validation loss decreased (-0.321127 --> -0.322303).  Saving model ...
Epoch: 27 cost time: 0.6268336772918701
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.029 Vali Acc: 0.325 Test Loss: 5.029 Test Acc: 0.325
Validation loss decreased (-0.322303 --> -0.324656).  Saving model ...
Epoch: 28 cost time: 0.6032252311706543
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.094 Vali Acc: 0.326 Test Loss: 5.094 Test Acc: 0.326
Validation loss decreased (-0.324656 --> -0.325831).  Saving model ...
Epoch: 29 cost time: 0.625340461730957
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.125 Vali Acc: 0.327 Test Loss: 5.125 Test Acc: 0.327
Validation loss decreased (-0.325831 --> -0.327008).  Saving model ...
Epoch: 30 cost time: 0.5047221183776855
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.124 Vali Acc: 0.322 Test Loss: 5.124 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7893266677856445
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.089 Vali Acc: 0.325 Test Loss: 5.089 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.555959939956665
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.060 Vali Acc: 0.331 Test Loss: 5.060 Test Acc: 0.331
Validation loss decreased (-0.327008 --> -0.330538).  Saving model ...
Epoch: 33 cost time: 0.6374735832214355
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.077 Vali Acc: 0.329 Test Loss: 5.077 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5564563274383545
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.101 Vali Acc: 0.324 Test Loss: 5.101 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.796863317489624
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.100 Vali Acc: 0.327 Test Loss: 5.100 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.46968913078308105
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.120 Vali Acc: 0.331 Test Loss: 5.120 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5367536544799805
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.147 Vali Acc: 0.328 Test Loss: 5.147 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4949374198913574
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.162 Vali Acc: 0.332 Test Loss: 5.162 Test Acc: 0.332
Validation loss decreased (-0.330538 --> -0.331713).  Saving model ...
Epoch: 39 cost time: 0.5311963558197021
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.182 Vali Acc: 0.331 Test Loss: 5.182 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5048444271087646
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.207 Vali Acc: 0.332 Test Loss: 5.207 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.46472692489624023
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.198 Vali Acc: 0.332 Test Loss: 5.198 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4770026206970215
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.191 Vali Acc: 0.336 Test Loss: 5.191 Test Acc: 0.336
Validation loss decreased (-0.331713 --> -0.336419).  Saving model ...
Epoch: 43 cost time: 0.9281613826751709
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.201 Vali Acc: 0.335 Test Loss: 5.201 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4590308666229248
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.222 Vali Acc: 0.336 Test Loss: 5.222 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6053147315979004
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.235 Vali Acc: 0.335 Test Loss: 5.235 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6393823623657227
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.248 Vali Acc: 0.334 Test Loss: 5.248 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6448562145233154
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.262 Vali Acc: 0.333 Test Loss: 5.262 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9141058921813965
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.287 Vali Acc: 0.328 Test Loss: 5.287 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.755155086517334
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.319 Vali Acc: 0.327 Test Loss: 5.319 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.952448844909668
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.354 Vali Acc: 0.322 Test Loss: 5.354 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 29683226
model size : 127.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8645906448364258
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.362 Vali Acc: 0.064 Test Loss: 3.362 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 0.7743122577667236
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.385 Vali Acc: 0.091 Test Loss: 3.385 Test Acc: 0.091
Validation loss decreased (-0.063496 --> -0.090554).  Saving model ...
Epoch: 3 cost time: 0.9248294830322266
Epoch: 3, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.284 Vali Acc: 0.101 Test Loss: 3.284 Test Acc: 0.101
Validation loss decreased (-0.090554 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 0.6157608032226562
Epoch: 4, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.210 Vali Acc: 0.142 Test Loss: 3.210 Test Acc: 0.142
Validation loss decreased (-0.101144 --> -0.142321).  Saving model ...
Epoch: 5 cost time: 0.927729606628418
Epoch: 5, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.185 Vali Acc: 0.153 Test Loss: 3.185 Test Acc: 0.153
Validation loss decreased (-0.142321 --> -0.152909).  Saving model ...
Epoch: 6 cost time: 0.8302125930786133
Epoch: 6, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.330 Vali Acc: 0.189 Test Loss: 3.330 Test Acc: 0.189
Validation loss decreased (-0.152909 --> -0.189378).  Saving model ...
Epoch: 7 cost time: 1.0920486450195312
Epoch: 7, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.766 Vali Acc: 0.205 Test Loss: 3.766 Test Acc: 0.205
Validation loss decreased (-0.189378 --> -0.204668).  Saving model ...
Epoch: 8 cost time: 0.8516271114349365
Epoch: 8, Steps: 10 | Train Loss: 0.701 Vali Loss: 4.167 Vali Acc: 0.235 Test Loss: 4.167 Test Acc: 0.235
Validation loss decreased (-0.204668 --> -0.235252).  Saving model ...
Epoch: 9 cost time: 0.9819564819335938
Epoch: 9, Steps: 10 | Train Loss: 0.342 Vali Loss: 4.567 Vali Acc: 0.264 Test Loss: 4.567 Test Acc: 0.264
Validation loss decreased (-0.235252 --> -0.263484).  Saving model ...
Epoch: 10 cost time: 1.0264136791229248
Epoch: 10, Steps: 10 | Train Loss: 0.176 Vali Loss: 5.626 Vali Acc: 0.232 Test Loss: 5.626 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8961708545684814
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 5.482 Vali Acc: 0.269 Test Loss: 5.482 Test Acc: 0.269
Validation loss decreased (-0.263484 --> -0.269357).  Saving model ...
Epoch: 12 cost time: 0.5669407844543457
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 6.124 Vali Acc: 0.249 Test Loss: 6.124 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8373606204986572
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 6.225 Vali Acc: 0.268 Test Loss: 6.225 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.780609130859375
Epoch: 14, Steps: 10 | Train Loss: 0.141 Vali Loss: 6.486 Vali Acc: 0.254 Test Loss: 6.486 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.829425573348999
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 6.607 Vali Acc: 0.264 Test Loss: 6.607 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8241229057312012
Epoch: 16, Steps: 10 | Train Loss: 0.173 Vali Loss: 6.844 Vali Acc: 0.262 Test Loss: 6.844 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5993766784667969
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.599 Vali Acc: 0.255 Test Loss: 7.599 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8110110759735107
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 7.726 Vali Acc: 0.251 Test Loss: 7.726 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7830905914306641
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 7.959 Vali Acc: 0.265 Test Loss: 7.959 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8490965366363525
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.637 Vali Acc: 0.280 Test Loss: 7.637 Test Acc: 0.280
Validation loss decreased (-0.269357 --> -0.279924).  Saving model ...
Epoch: 21 cost time: 0.8031435012817383
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.861 Vali Acc: 0.278 Test Loss: 7.861 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8205559253692627
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.387 Vali Acc: 0.285 Test Loss: 8.387 Test Acc: 0.285
Validation loss decreased (-0.279924 --> -0.284622).  Saving model ...
Epoch: 23 cost time: 0.9699246883392334
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 8.426 Vali Acc: 0.285 Test Loss: 8.426 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.83237624168396
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 8.287 Vali Acc: 0.275 Test Loss: 8.287 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8450112342834473
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.843 Vali Acc: 0.242 Test Loss: 8.843 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2530922889709473
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 9.077 Vali Acc: 0.260 Test Loss: 9.077 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7635514736175537
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.982 Vali Acc: 0.281 Test Loss: 8.982 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.048743724822998
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.758 Vali Acc: 0.289 Test Loss: 8.758 Test Acc: 0.289
Validation loss decreased (-0.284622 --> -0.289324).  Saving model ...
Epoch: 29 cost time: 0.932621955871582
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.873 Vali Acc: 0.279 Test Loss: 8.873 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7889070510864258
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.892 Vali Acc: 0.278 Test Loss: 8.892 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9879515171051025
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.824 Vali Acc: 0.281 Test Loss: 8.824 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7532684803009033
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.764 Vali Acc: 0.285 Test Loss: 8.764 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9031064510345459
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.721 Vali Acc: 0.285 Test Loss: 8.721 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7985935211181641
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.686 Vali Acc: 0.284 Test Loss: 8.686 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5839278697967529
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.669 Vali Acc: 0.287 Test Loss: 8.669 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6254518032073975
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.645 Vali Acc: 0.289 Test Loss: 8.645 Test Acc: 0.289
Validation loss decreased (-0.289324 --> -0.289325).  Saving model ...
Epoch: 37 cost time: 1.1667211055755615
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.632 Vali Acc: 0.291 Test Loss: 8.632 Test Acc: 0.291
Validation loss decreased (-0.289325 --> -0.290502).  Saving model ...
Epoch: 38 cost time: 1.2132818698883057
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.627 Vali Acc: 0.293 Test Loss: 8.627 Test Acc: 0.293
Validation loss decreased (-0.290502 --> -0.292855).  Saving model ...
Epoch: 39 cost time: 1.043907880783081
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.621 Vali Acc: 0.294 Test Loss: 8.621 Test Acc: 0.294
Validation loss decreased (-0.292855 --> -0.294031).  Saving model ...
Epoch: 40 cost time: 1.013563632965088
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.619 Vali Acc: 0.295 Test Loss: 8.619 Test Acc: 0.295
Validation loss decreased (-0.294031 --> -0.295208).  Saving model ...
Epoch: 41 cost time: 0.9636111259460449
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.615 Vali Acc: 0.296 Test Loss: 8.615 Test Acc: 0.296
Validation loss decreased (-0.295208 --> -0.296384).  Saving model ...
Epoch: 42 cost time: 0.9142727851867676
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.619 Vali Acc: 0.296 Test Loss: 8.619 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7633519172668457
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.623 Vali Acc: 0.296 Test Loss: 8.623 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5660250186920166
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.601 Vali Acc: 0.296 Test Loss: 8.601 Test Acc: 0.296
Validation loss decreased (-0.296384 --> -0.296385).  Saving model ...
Epoch: 45 cost time: 0.8649675846099854
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.610 Vali Acc: 0.295 Test Loss: 8.610 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7832763195037842
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.613 Vali Acc: 0.293 Test Loss: 8.613 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8258469104766846
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.609 Vali Acc: 0.294 Test Loss: 8.609 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1126048564910889
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.606 Vali Acc: 0.294 Test Loss: 8.606 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9709999561309814
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.605 Vali Acc: 0.294 Test Loss: 8.605 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7411346435546875
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 8.600 Vali Acc: 0.294 Test Loss: 8.600 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 30313754
model size : 130.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1138575077056885
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.325 Vali Acc: 0.051 Test Loss: 3.325 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.744940996170044
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.394 Vali Acc: 0.078 Test Loss: 3.394 Test Acc: 0.078
Validation loss decreased (-0.050555 --> -0.077613).  Saving model ...
Epoch: 3 cost time: 0.8612093925476074
Epoch: 3, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.298 Vali Acc: 0.098 Test Loss: 3.298 Test Acc: 0.098
Validation loss decreased (-0.077613 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 0.8426907062530518
Epoch: 4, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.248 Vali Acc: 0.118 Test Loss: 3.248 Test Acc: 0.118
Validation loss decreased (-0.097614 --> -0.117615).  Saving model ...
Epoch: 5 cost time: 0.8614637851715088
Epoch: 5, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.209 Vali Acc: 0.136 Test Loss: 3.209 Test Acc: 0.136
Validation loss decreased (-0.117615 --> -0.136438).  Saving model ...
Epoch: 6 cost time: 0.7148804664611816
Epoch: 6, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.209 Vali Acc: 0.166 Test Loss: 3.209 Test Acc: 0.166
Validation loss decreased (-0.136438 --> -0.165850).  Saving model ...
Epoch: 7 cost time: 0.792170524597168
Epoch: 7, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.252 Vali Acc: 0.199 Test Loss: 3.252 Test Acc: 0.199
Validation loss decreased (-0.165850 --> -0.198791).  Saving model ...
Epoch: 8 cost time: 0.6241974830627441
Epoch: 8, Steps: 10 | Train Loss: 1.150 Vali Loss: 3.594 Vali Acc: 0.211 Test Loss: 3.594 Test Acc: 0.211
Validation loss decreased (-0.198791 --> -0.210552).  Saving model ...
Epoch: 9 cost time: 0.752129077911377
Epoch: 9, Steps: 10 | Train Loss: 0.593 Vali Loss: 4.060 Vali Acc: 0.209 Test Loss: 4.060 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6870529651641846
Epoch: 10, Steps: 10 | Train Loss: 0.458 Vali Loss: 4.143 Vali Acc: 0.258 Test Loss: 4.143 Test Acc: 0.258
Validation loss decreased (-0.210552 --> -0.257606).  Saving model ...
Epoch: 11 cost time: 0.7509820461273193
Epoch: 11, Steps: 10 | Train Loss: 0.236 Vali Loss: 4.653 Vali Acc: 0.258 Test Loss: 4.653 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1194932460784912
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.765 Vali Acc: 0.274 Test Loss: 4.765 Test Acc: 0.274
Validation loss decreased (-0.257606 --> -0.274070).  Saving model ...
Epoch: 13 cost time: 0.6977896690368652
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 5.313 Vali Acc: 0.251 Test Loss: 5.313 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9716858863830566
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 5.441 Vali Acc: 0.280 Test Loss: 5.441 Test Acc: 0.280
Validation loss decreased (-0.274070 --> -0.279946).  Saving model ...
Epoch: 15 cost time: 0.6840949058532715
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.419 Vali Acc: 0.275 Test Loss: 5.419 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6896240711212158
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.461 Vali Acc: 0.289 Test Loss: 5.461 Test Acc: 0.289
Validation loss decreased (-0.279946 --> -0.289357).  Saving model ...
Epoch: 17 cost time: 0.8078324794769287
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.631 Vali Acc: 0.288 Test Loss: 5.631 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.747974157333374
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.610 Vali Acc: 0.293 Test Loss: 5.610 Test Acc: 0.293
Validation loss decreased (-0.289357 --> -0.292885).  Saving model ...
Epoch: 19 cost time: 0.9267568588256836
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.909 Vali Acc: 0.291 Test Loss: 5.909 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8800408840179443
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.778 Vali Acc: 0.311 Test Loss: 5.778 Test Acc: 0.311
Validation loss decreased (-0.292885 --> -0.310530).  Saving model ...
Epoch: 21 cost time: 1.3339564800262451
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.670 Vali Acc: 0.307 Test Loss: 5.670 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6663992404937744
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.740 Vali Acc: 0.298 Test Loss: 5.740 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2610132694244385
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.890 Vali Acc: 0.296 Test Loss: 5.890 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7900886535644531
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.103 Vali Acc: 0.276 Test Loss: 6.103 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1304316520690918
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.467 Vali Acc: 0.284 Test Loss: 6.467 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9832069873809814
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.925 Vali Acc: 0.302 Test Loss: 5.925 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7730014324188232
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.281 Vali Acc: 0.274 Test Loss: 6.281 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5038058757781982
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 6.329 Vali Acc: 0.269 Test Loss: 6.329 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.033386468887329
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.015 Vali Acc: 0.295 Test Loss: 6.015 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.720416784286499
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.163 Vali Acc: 0.287 Test Loss: 6.163 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 29905178
model size : 128.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9720110893249512
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.329 Vali Acc: 0.058 Test Loss: 3.329 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.5802388191223145
Epoch: 2, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.334 Vali Acc: 0.062 Test Loss: 3.334 Test Acc: 0.062
Validation loss decreased (-0.057614 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.7140183448791504
Epoch: 3, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.337 Vali Acc: 0.071 Test Loss: 3.337 Test Acc: 0.071
Validation loss decreased (-0.062320 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.6437954902648926
Epoch: 4, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.278 Vali Acc: 0.086 Test Loss: 3.278 Test Acc: 0.086
Validation loss decreased (-0.070555 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.9987506866455078
Epoch: 5, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.233 Vali Acc: 0.093 Test Loss: 3.233 Test Acc: 0.093
Validation loss decreased (-0.085850 --> -0.092909).  Saving model ...
Epoch: 6 cost time: 1.097550392150879
Epoch: 6, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.192 Vali Acc: 0.131 Test Loss: 3.192 Test Acc: 0.131
Validation loss decreased (-0.092909 --> -0.130556).  Saving model ...
Epoch: 7 cost time: 0.6326265335083008
Epoch: 7, Steps: 10 | Train Loss: 2.209 Vali Loss: 3.170 Vali Acc: 0.141 Test Loss: 3.170 Test Acc: 0.141
Validation loss decreased (-0.130556 --> -0.141145).  Saving model ...
Epoch: 8 cost time: 0.6424601078033447
Epoch: 8, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.257 Vali Acc: 0.189 Test Loss: 3.257 Test Acc: 0.189
Validation loss decreased (-0.141145 --> -0.189379).  Saving model ...
Epoch: 9 cost time: 1.1178398132324219
Epoch: 9, Steps: 10 | Train Loss: 1.403 Vali Loss: 3.346 Vali Acc: 0.215 Test Loss: 3.346 Test Acc: 0.215
Validation loss decreased (-0.189379 --> -0.215261).  Saving model ...
Epoch: 10 cost time: 0.7293267250061035
Epoch: 10, Steps: 10 | Train Loss: 0.927 Vali Loss: 3.588 Vali Acc: 0.224 Test Loss: 3.588 Test Acc: 0.224
Validation loss decreased (-0.215261 --> -0.223494).  Saving model ...
Epoch: 11 cost time: 1.1897788047790527
Epoch: 11, Steps: 10 | Train Loss: 0.710 Vali Loss: 3.718 Vali Acc: 0.235 Test Loss: 3.718 Test Acc: 0.235
Validation loss decreased (-0.223494 --> -0.235257).  Saving model ...
Epoch: 12 cost time: 0.9235506057739258
Epoch: 12, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.889 Vali Acc: 0.267 Test Loss: 3.889 Test Acc: 0.267
Validation loss decreased (-0.235257 --> -0.267020).  Saving model ...
Epoch: 13 cost time: 0.5138208866119385
Epoch: 13, Steps: 10 | Train Loss: 0.243 Vali Loss: 4.153 Vali Acc: 0.267 Test Loss: 4.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6969664096832275
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 4.376 Vali Acc: 0.265 Test Loss: 4.376 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6142277717590332
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.520 Vali Acc: 0.278 Test Loss: 4.520 Test Acc: 0.278
Validation loss decreased (-0.267020 --> -0.277602).  Saving model ...
Epoch: 16 cost time: 0.6298599243164062
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.558 Vali Acc: 0.289 Test Loss: 4.558 Test Acc: 0.289
Validation loss decreased (-0.277602 --> -0.289366).  Saving model ...
Epoch: 17 cost time: 0.6332101821899414
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.729 Vali Acc: 0.269 Test Loss: 4.729 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5698680877685547
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.777 Vali Acc: 0.288 Test Loss: 4.777 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4943263530731201
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.819 Vali Acc: 0.288 Test Loss: 4.819 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7125115394592285
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.897 Vali Acc: 0.292 Test Loss: 4.897 Test Acc: 0.292
Validation loss decreased (-0.289366 --> -0.291716).  Saving model ...
Epoch: 21 cost time: 0.6399726867675781
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.965 Vali Acc: 0.280 Test Loss: 4.965 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5926165580749512
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.855 Vali Acc: 0.295 Test Loss: 4.855 Test Acc: 0.295
Validation loss decreased (-0.291716 --> -0.295246).  Saving model ...
Epoch: 23 cost time: 0.6833279132843018
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.897 Vali Acc: 0.292 Test Loss: 4.897 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5840263366699219
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.931 Vali Acc: 0.295 Test Loss: 4.931 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5886845588684082
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.945 Vali Acc: 0.295 Test Loss: 4.945 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6455135345458984
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.964 Vali Acc: 0.296 Test Loss: 4.964 Test Acc: 0.296
Validation loss decreased (-0.295246 --> -0.296421).  Saving model ...
Epoch: 27 cost time: 1.055187702178955
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.012 Vali Acc: 0.293 Test Loss: 5.012 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6197478771209717
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.005 Vali Acc: 0.300 Test Loss: 5.005 Test Acc: 0.300
Validation loss decreased (-0.296421 --> -0.299950).  Saving model ...
Epoch: 29 cost time: 0.7231836318969727
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.002 Vali Acc: 0.296 Test Loss: 5.002 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1343402862548828
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.030 Vali Acc: 0.300 Test Loss: 5.030 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7236027717590332
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.041 Vali Acc: 0.301 Test Loss: 5.041 Test Acc: 0.301
Validation loss decreased (-0.299950 --> -0.301126).  Saving model ...
Epoch: 32 cost time: 1.0263392925262451
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.068 Vali Acc: 0.298 Test Loss: 5.068 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9156646728515625
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.067 Vali Acc: 0.298 Test Loss: 5.067 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9309084415435791
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.058 Vali Acc: 0.296 Test Loss: 5.058 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.758500337600708
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.067 Vali Acc: 0.302 Test Loss: 5.067 Test Acc: 0.302
Validation loss decreased (-0.301126 --> -0.302302).  Saving model ...
Epoch: 36 cost time: 0.699146032333374
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.084 Vali Acc: 0.300 Test Loss: 5.084 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7241387367248535
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.086 Vali Acc: 0.302 Test Loss: 5.086 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6528604030609131
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.082 Vali Acc: 0.302 Test Loss: 5.082 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5910444259643555
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.076 Vali Acc: 0.299 Test Loss: 5.076 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2004978656768799
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.101 Vali Acc: 0.302 Test Loss: 5.101 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8849160671234131
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.119 Vali Acc: 0.304 Test Loss: 5.119 Test Acc: 0.304
Validation loss decreased (-0.302302 --> -0.303478).  Saving model ...
Epoch: 42 cost time: 0.48474597930908203
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.131 Vali Acc: 0.302 Test Loss: 5.131 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8904807567596436
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.138 Vali Acc: 0.298 Test Loss: 5.138 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8381955623626709
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.141 Vali Acc: 0.296 Test Loss: 5.141 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8037295341491699
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.158 Vali Acc: 0.302 Test Loss: 5.158 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7554476261138916
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.170 Vali Acc: 0.301 Test Loss: 5.170 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5632731914520264
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.182 Vali Acc: 0.304 Test Loss: 5.182 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9868383407592773
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.186 Vali Acc: 0.302 Test Loss: 5.186 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9492912292480469
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.185 Vali Acc: 0.305 Test Loss: 5.185 Test Acc: 0.305
Validation loss decreased (-0.303478 --> -0.304654).  Saving model ...
Epoch: 50 cost time: 0.5917255878448486
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.200 Vali Acc: 0.305 Test Loss: 5.200 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 29625626
model size : 127.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.432450771331787
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.359 Vali Acc: 0.055 Test Loss: 3.359 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.8450305461883545
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.371 Vali Acc: 0.076 Test Loss: 3.371 Test Acc: 0.076
Validation loss decreased (-0.055261 --> -0.076437).  Saving model ...
Epoch: 3 cost time: 0.8172023296356201
Epoch: 3, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.268 Vali Acc: 0.089 Test Loss: 3.268 Test Acc: 0.089
Validation loss decreased (-0.076437 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.9950432777404785
Epoch: 4, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.176 Vali Acc: 0.140 Test Loss: 3.176 Test Acc: 0.140
Validation loss decreased (-0.089379 --> -0.139968).  Saving model ...
Epoch: 5 cost time: 0.8147284984588623
Epoch: 5, Steps: 10 | Train Loss: 2.195 Vali Loss: 3.149 Vali Acc: 0.161 Test Loss: 3.149 Test Acc: 0.161
Validation loss decreased (-0.139968 --> -0.161145).  Saving model ...
Epoch: 6 cost time: 0.8707435131072998
Epoch: 6, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.185 Vali Acc: 0.194 Test Loss: 3.185 Test Acc: 0.194
Validation loss decreased (-0.161145 --> -0.194086).  Saving model ...
Epoch: 7 cost time: 0.7823760509490967
Epoch: 7, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.545 Vali Acc: 0.231 Test Loss: 3.545 Test Acc: 0.231
Validation loss decreased (-0.194086 --> -0.230553).  Saving model ...
Epoch: 8 cost time: 1.5526189804077148
Epoch: 8, Steps: 10 | Train Loss: 0.658 Vali Loss: 4.316 Vali Acc: 0.221 Test Loss: 4.316 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7256107330322266
Epoch: 9, Steps: 10 | Train Loss: 0.416 Vali Loss: 4.767 Vali Acc: 0.251 Test Loss: 4.767 Test Acc: 0.251
Validation loss decreased (-0.230553 --> -0.250541).  Saving model ...
Epoch: 10 cost time: 1.79947829246521
Epoch: 10, Steps: 10 | Train Loss: 0.240 Vali Loss: 5.335 Vali Acc: 0.238 Test Loss: 5.335 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5906903743743896
Epoch: 11, Steps: 10 | Train Loss: 0.118 Vali Loss: 5.345 Vali Acc: 0.281 Test Loss: 5.345 Test Acc: 0.281
Validation loss decreased (-0.250541 --> -0.281123).  Saving model ...
Epoch: 12 cost time: 0.8047327995300293
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 6.198 Vali Acc: 0.276 Test Loss: 6.198 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2025549411773682
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 6.196 Vali Acc: 0.273 Test Loss: 6.196 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7497122287750244
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 6.470 Vali Acc: 0.280 Test Loss: 6.470 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9672219753265381
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.368 Vali Acc: 0.279 Test Loss: 6.368 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.780651330947876
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.790 Vali Acc: 0.284 Test Loss: 6.790 Test Acc: 0.284
Validation loss decreased (-0.281123 --> -0.283462).  Saving model ...
Epoch: 17 cost time: 1.1115362644195557
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.925 Vali Acc: 0.298 Test Loss: 6.925 Test Acc: 0.298
Validation loss decreased (-0.283462 --> -0.297578).  Saving model ...
Epoch: 18 cost time: 1.0552289485931396
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.025 Vali Acc: 0.289 Test Loss: 7.025 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9660782814025879
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.204 Vali Acc: 0.287 Test Loss: 7.204 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3372423648834229
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.443 Vali Acc: 0.274 Test Loss: 7.443 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7827599048614502
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.291 Vali Acc: 0.285 Test Loss: 7.291 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0896596908569336
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 7.747 Vali Acc: 0.284 Test Loss: 7.747 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0689258575439453
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.514 Vali Acc: 0.285 Test Loss: 7.514 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7884488105773926
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.383 Vali Acc: 0.284 Test Loss: 7.383 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2613675594329834
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.319 Vali Acc: 0.305 Test Loss: 7.319 Test Acc: 0.305
Validation loss decreased (-0.297578 --> -0.304633).  Saving model ...
Epoch: 26 cost time: 0.8394167423248291
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.398 Vali Acc: 0.304 Test Loss: 7.398 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8474266529083252
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.780 Vali Acc: 0.308 Test Loss: 7.780 Test Acc: 0.308
Validation loss decreased (-0.304633 --> -0.308157).  Saving model ...
Epoch: 28 cost time: 0.806002140045166
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.409 Vali Acc: 0.305 Test Loss: 7.409 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1456315517425537
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.459 Vali Acc: 0.289 Test Loss: 7.459 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2204556465148926
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.774 Vali Acc: 0.316 Test Loss: 7.774 Test Acc: 0.316
Validation loss decreased (-0.308157 --> -0.316393).  Saving model ...
Epoch: 31 cost time: 0.8694515228271484
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.096 Vali Acc: 0.304 Test Loss: 8.096 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1538362503051758
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 7.597 Vali Acc: 0.308 Test Loss: 7.597 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8037750720977783
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 8.457 Vali Acc: 0.292 Test Loss: 8.457 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8834035396575928
Epoch: 34, Steps: 10 | Train Loss: 0.069 Vali Loss: 8.225 Vali Acc: 0.312 Test Loss: 8.225 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8335258960723877
Epoch: 35, Steps: 10 | Train Loss: 0.138 Vali Loss: 8.913 Vali Acc: 0.281 Test Loss: 8.913 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8891322612762451
Epoch: 36, Steps: 10 | Train Loss: 0.091 Vali Loss: 10.721 Vali Acc: 0.247 Test Loss: 10.721 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9089319705963135
Epoch: 37, Steps: 10 | Train Loss: 0.171 Vali Loss: 10.393 Vali Acc: 0.267 Test Loss: 10.393 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8459386825561523
Epoch: 38, Steps: 10 | Train Loss: 0.138 Vali Loss: 10.287 Vali Acc: 0.264 Test Loss: 10.287 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.249408483505249
Epoch: 39, Steps: 10 | Train Loss: 0.039 Vali Loss: 10.566 Vali Acc: 0.278 Test Loss: 10.566 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1501500606536865
Epoch: 40, Steps: 10 | Train Loss: 0.075 Vali Loss: 10.777 Vali Acc: 0.273 Test Loss: 10.777 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 30320666
model size : 130.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0649056434631348
Epoch: 1, Steps: 10 | Train Loss: 3.423 Vali Loss: 3.315 Vali Acc: 0.038 Test Loss: 3.315 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.8584253787994385
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.394 Vali Acc: 0.066 Test Loss: 3.394 Test Acc: 0.066
Validation loss decreased (-0.037614 --> -0.065848).  Saving model ...
Epoch: 3 cost time: 0.6609246730804443
Epoch: 3, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.351 Vali Acc: 0.074 Test Loss: 3.351 Test Acc: 0.074
Validation loss decreased (-0.065848 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 0.6846249103546143
Epoch: 4, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.249 Vali Acc: 0.122 Test Loss: 3.249 Test Acc: 0.122
Validation loss decreased (-0.074084 --> -0.122320).  Saving model ...
Epoch: 5 cost time: 0.5634145736694336
Epoch: 5, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.220 Vali Acc: 0.138 Test Loss: 3.220 Test Acc: 0.138
Validation loss decreased (-0.122320 --> -0.137615).  Saving model ...
Epoch: 6 cost time: 0.8669426441192627
Epoch: 6, Steps: 10 | Train Loss: 2.064 Vali Loss: 3.171 Vali Acc: 0.175 Test Loss: 3.171 Test Acc: 0.175
Validation loss decreased (-0.137615 --> -0.175262).  Saving model ...
Epoch: 7 cost time: 0.851884126663208
Epoch: 7, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.387 Vali Acc: 0.182 Test Loss: 3.387 Test Acc: 0.182
Validation loss decreased (-0.175262 --> -0.182319).  Saving model ...
Epoch: 8 cost time: 0.5343818664550781
Epoch: 8, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.640 Vali Acc: 0.232 Test Loss: 3.640 Test Acc: 0.232
Validation loss decreased (-0.182319 --> -0.231728).  Saving model ...
Epoch: 9 cost time: 1.1844918727874756
Epoch: 9, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.883 Vali Acc: 0.240 Test Loss: 3.883 Test Acc: 0.240
Validation loss decreased (-0.231728 --> -0.239961).  Saving model ...
Epoch: 10 cost time: 0.7775373458862305
Epoch: 10, Steps: 10 | Train Loss: 0.426 Vali Loss: 4.266 Vali Acc: 0.276 Test Loss: 4.266 Test Acc: 0.276
Validation loss decreased (-0.239961 --> -0.276428).  Saving model ...
Epoch: 11 cost time: 0.6165938377380371
Epoch: 11, Steps: 10 | Train Loss: 0.233 Vali Loss: 4.729 Vali Acc: 0.241 Test Loss: 4.729 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5284647941589355
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.751 Vali Acc: 0.284 Test Loss: 4.751 Test Acc: 0.284
Validation loss decreased (-0.276428 --> -0.283482).  Saving model ...
Epoch: 13 cost time: 1.009251356124878
Epoch: 13, Steps: 10 | Train Loss: 0.127 Vali Loss: 5.137 Vali Acc: 0.265 Test Loss: 5.137 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.03830885887146
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 5.126 Vali Acc: 0.279 Test Loss: 5.126 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1240508556365967
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.400 Vali Acc: 0.282 Test Loss: 5.400 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6126577854156494
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.405 Vali Acc: 0.288 Test Loss: 5.405 Test Acc: 0.288
Validation loss decreased (-0.283482 --> -0.288181).  Saving model ...
Epoch: 17 cost time: 1.0711078643798828
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.364 Vali Acc: 0.305 Test Loss: 5.364 Test Acc: 0.305
Validation loss decreased (-0.288181 --> -0.304652).  Saving model ...
Epoch: 18 cost time: 0.7910027503967285
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.550 Vali Acc: 0.281 Test Loss: 5.550 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7524731159210205
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.837 Vali Acc: 0.288 Test Loss: 5.837 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7379679679870605
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.555 Vali Acc: 0.313 Test Loss: 5.555 Test Acc: 0.313
Validation loss decreased (-0.304652 --> -0.312886).  Saving model ...
Epoch: 21 cost time: 0.7993800640106201
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.640 Vali Acc: 0.312 Test Loss: 5.640 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5410842895507812
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.563 Vali Acc: 0.309 Test Loss: 5.563 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5500714778900146
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.629 Vali Acc: 0.307 Test Loss: 5.629 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6171019077301025
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.714 Vali Acc: 0.306 Test Loss: 5.714 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7056515216827393
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.680 Vali Acc: 0.309 Test Loss: 5.680 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6496798992156982
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.671 Vali Acc: 0.307 Test Loss: 5.671 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6846222877502441
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.682 Vali Acc: 0.309 Test Loss: 5.682 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7694690227508545
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.696 Vali Acc: 0.306 Test Loss: 5.696 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6175825595855713
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.703 Vali Acc: 0.307 Test Loss: 5.703 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.718498945236206
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.693 Vali Acc: 0.313 Test Loss: 5.693 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 29912090
model size : 128.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1527867317199707
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.313 Vali Acc: 0.044 Test Loss: 3.313 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.49256348609924316
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.353 Vali Acc: 0.056 Test Loss: 3.353 Test Acc: 0.056
Validation loss decreased (-0.043496 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.5639371871948242
Epoch: 3, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.328 Vali Acc: 0.072 Test Loss: 3.328 Test Acc: 0.072
Validation loss decreased (-0.056437 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 0.5727505683898926
Epoch: 4, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.283 Vali Acc: 0.078 Test Loss: 3.283 Test Acc: 0.078
Validation loss decreased (-0.071731 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 0.6210689544677734
Epoch: 5, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.229 Vali Acc: 0.115 Test Loss: 3.229 Test Acc: 0.115
Validation loss decreased (-0.077614 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 0.6989185810089111
Epoch: 6, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.183 Vali Acc: 0.126 Test Loss: 3.183 Test Acc: 0.126
Validation loss decreased (-0.115262 --> -0.125851).  Saving model ...
Epoch: 7 cost time: 0.49393320083618164
Epoch: 7, Steps: 10 | Train Loss: 2.243 Vali Loss: 3.196 Vali Acc: 0.153 Test Loss: 3.196 Test Acc: 0.153
Validation loss decreased (-0.125851 --> -0.152909).  Saving model ...
Epoch: 8 cost time: 0.5031726360321045
Epoch: 8, Steps: 10 | Train Loss: 1.832 Vali Loss: 3.220 Vali Acc: 0.171 Test Loss: 3.220 Test Acc: 0.171
Validation loss decreased (-0.152909 --> -0.170556).  Saving model ...
Epoch: 9 cost time: 0.7827439308166504
Epoch: 9, Steps: 10 | Train Loss: 1.584 Vali Loss: 3.455 Vali Acc: 0.211 Test Loss: 3.455 Test Acc: 0.211
Validation loss decreased (-0.170556 --> -0.210554).  Saving model ...
Epoch: 10 cost time: 0.671137809753418
Epoch: 10, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.649 Vali Acc: 0.219 Test Loss: 3.649 Test Acc: 0.219
Validation loss decreased (-0.210554 --> -0.218787).  Saving model ...
Epoch: 11 cost time: 0.814185380935669
Epoch: 11, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.740 Vali Acc: 0.245 Test Loss: 3.740 Test Acc: 0.245
Validation loss decreased (-0.218787 --> -0.244668).  Saving model ...
Epoch: 12 cost time: 0.602858304977417
Epoch: 12, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.916 Vali Acc: 0.249 Test Loss: 3.916 Test Acc: 0.249
Validation loss decreased (-0.244668 --> -0.249373).  Saving model ...
Epoch: 13 cost time: 0.545844316482544
Epoch: 13, Steps: 10 | Train Loss: 0.282 Vali Loss: 4.180 Vali Acc: 0.249 Test Loss: 4.180 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8422031402587891
Epoch: 14, Steps: 10 | Train Loss: 0.248 Vali Loss: 4.248 Vali Acc: 0.267 Test Loss: 4.248 Test Acc: 0.267
Validation loss decreased (-0.249373 --> -0.267016).  Saving model ...
Epoch: 15 cost time: 0.5839014053344727
Epoch: 15, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.359 Vali Acc: 0.282 Test Loss: 4.359 Test Acc: 0.282
Validation loss decreased (-0.267016 --> -0.282309).  Saving model ...
Epoch: 16 cost time: 0.6127009391784668
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.566 Vali Acc: 0.287 Test Loss: 4.566 Test Acc: 0.287
Validation loss decreased (-0.282309 --> -0.287013).  Saving model ...
Epoch: 17 cost time: 0.5906791687011719
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.539 Vali Acc: 0.276 Test Loss: 4.539 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5988800525665283
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.697 Vali Acc: 0.276 Test Loss: 4.697 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5966322422027588
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.813 Vali Acc: 0.278 Test Loss: 4.813 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5443682670593262
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.752 Vali Acc: 0.278 Test Loss: 4.752 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6083436012268066
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.911 Vali Acc: 0.275 Test Loss: 4.911 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5632143020629883
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.994 Vali Acc: 0.272 Test Loss: 4.994 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5518066883087158
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.039 Vali Acc: 0.288 Test Loss: 5.039 Test Acc: 0.288
Validation loss decreased (-0.287013 --> -0.288185).  Saving model ...
Epoch: 24 cost time: 0.5411312580108643
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.035 Vali Acc: 0.288 Test Loss: 5.035 Test Acc: 0.288
Validation loss decreased (-0.288185 --> -0.288185).  Saving model ...
Epoch: 25 cost time: 0.7685346603393555
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.002 Vali Acc: 0.298 Test Loss: 5.002 Test Acc: 0.298
Validation loss decreased (-0.288185 --> -0.297597).  Saving model ...
Epoch: 26 cost time: 0.5816988945007324
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.003 Vali Acc: 0.294 Test Loss: 5.003 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4770522117614746
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.961 Vali Acc: 0.299 Test Loss: 4.961 Test Acc: 0.299
Validation loss decreased (-0.297597 --> -0.298774).  Saving model ...
Epoch: 28 cost time: 0.5303082466125488
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.982 Vali Acc: 0.295 Test Loss: 4.982 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5248110294342041
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.125 Vali Acc: 0.287 Test Loss: 5.125 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.569504976272583
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.045 Vali Acc: 0.295 Test Loss: 5.045 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5845775604248047
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.035 Vali Acc: 0.298 Test Loss: 5.035 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.571495771408081
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.045 Vali Acc: 0.298 Test Loss: 5.045 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5648365020751953
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.075 Vali Acc: 0.296 Test Loss: 5.075 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6779680252075195
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.106 Vali Acc: 0.296 Test Loss: 5.106 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5626838207244873
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.107 Vali Acc: 0.295 Test Loss: 5.107 Test Acc: 0.295
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8021740913391113
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.116 Vali Acc: 0.299 Test Loss: 5.116 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0128509998321533
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.125 Vali Acc: 0.301 Test Loss: 5.125 Test Acc: 0.301
Validation loss decreased (-0.298774 --> -0.301125).  Saving model ...
Epoch: 38 cost time: 0.8396942615509033
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.137 Vali Acc: 0.302 Test Loss: 5.137 Test Acc: 0.302
Validation loss decreased (-0.301125 --> -0.302302).  Saving model ...
Epoch: 39 cost time: 1.0386648178100586
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.132 Vali Acc: 0.302 Test Loss: 5.132 Test Acc: 0.302
Validation loss decreased (-0.302302 --> -0.302302).  Saving model ...
Epoch: 40 cost time: 0.7936100959777832
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.146 Vali Acc: 0.307 Test Loss: 5.146 Test Acc: 0.307
Validation loss decreased (-0.302302 --> -0.307007).  Saving model ...
Epoch: 41 cost time: 0.9935317039489746
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.192 Vali Acc: 0.301 Test Loss: 5.192 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8115930557250977
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.212 Vali Acc: 0.307 Test Loss: 5.212 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7785117626190186
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.226 Vali Acc: 0.306 Test Loss: 5.226 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5981175899505615
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.211 Vali Acc: 0.305 Test Loss: 5.211 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6912388801574707
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.213 Vali Acc: 0.305 Test Loss: 5.213 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5215673446655273
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.234 Vali Acc: 0.304 Test Loss: 5.234 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5393829345703125
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.230 Vali Acc: 0.305 Test Loss: 5.230 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6725277900695801
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.226 Vali Acc: 0.302 Test Loss: 5.226 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6059212684631348
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.243 Vali Acc: 0.306 Test Loss: 5.243 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7416374683380127
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.310 Vali Acc: 0.305 Test Loss: 5.310 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 29611034
model size : 127.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.855210304260254
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.361 Vali Acc: 0.045 Test Loss: 3.361 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.5489435195922852
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.392 Vali Acc: 0.040 Test Loss: 3.392 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4816818237304688
Epoch: 3, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.289 Vali Acc: 0.109 Test Loss: 3.289 Test Acc: 0.109
Validation loss decreased (-0.044672 --> -0.109379).  Saving model ...
Epoch: 4 cost time: 1.1224608421325684
Epoch: 4, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.221 Vali Acc: 0.109 Test Loss: 3.221 Test Acc: 0.109
Validation loss decreased (-0.109379 --> -0.109380).  Saving model ...
Epoch: 5 cost time: 0.7574756145477295
Epoch: 5, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.223 Vali Acc: 0.160 Test Loss: 3.223 Test Acc: 0.160
Validation loss decreased (-0.109380 --> -0.159968).  Saving model ...
Epoch: 6 cost time: 0.7442772388458252
Epoch: 6, Steps: 10 | Train Loss: 1.729 Vali Loss: 3.220 Vali Acc: 0.198 Test Loss: 3.220 Test Acc: 0.198
Validation loss decreased (-0.159968 --> -0.197615).  Saving model ...
Epoch: 7 cost time: 0.7760336399078369
Epoch: 7, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.724 Vali Acc: 0.204 Test Loss: 3.724 Test Acc: 0.204
Validation loss decreased (-0.197615 --> -0.203492).  Saving model ...
Epoch: 8 cost time: 0.9528543949127197
Epoch: 8, Steps: 10 | Train Loss: 0.671 Vali Loss: 4.054 Vali Acc: 0.258 Test Loss: 4.054 Test Acc: 0.258
Validation loss decreased (-0.203492 --> -0.257607).  Saving model ...
Epoch: 9 cost time: 1.2213029861450195
Epoch: 9, Steps: 10 | Train Loss: 0.335 Vali Loss: 4.750 Vali Acc: 0.255 Test Loss: 4.750 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5962224006652832
Epoch: 10, Steps: 10 | Train Loss: 0.227 Vali Loss: 5.093 Vali Acc: 0.244 Test Loss: 5.093 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6631717681884766
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 5.654 Vali Acc: 0.247 Test Loss: 5.654 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.77974534034729
Epoch: 12, Steps: 10 | Train Loss: 0.114 Vali Loss: 6.299 Vali Acc: 0.248 Test Loss: 6.299 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8102459907531738
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 6.220 Vali Acc: 0.276 Test Loss: 6.220 Test Acc: 0.276
Validation loss decreased (-0.257607 --> -0.276408).  Saving model ...
Epoch: 14 cost time: 0.7843289375305176
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 6.366 Vali Acc: 0.272 Test Loss: 6.366 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.785797119140625
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 7.007 Vali Acc: 0.258 Test Loss: 7.007 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0475823879241943
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 6.824 Vali Acc: 0.275 Test Loss: 6.824 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8418436050415039
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 7.134 Vali Acc: 0.265 Test Loss: 7.134 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6013593673706055
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 7.006 Vali Acc: 0.273 Test Loss: 7.006 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6009361743927002
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 7.103 Vali Acc: 0.262 Test Loss: 7.103 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5644419193267822
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.171 Vali Acc: 0.267 Test Loss: 7.171 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6273832321166992
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.089 Vali Acc: 0.276 Test Loss: 7.089 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6710069179534912
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.069 Vali Acc: 0.285 Test Loss: 7.069 Test Acc: 0.285
Validation loss decreased (-0.276408 --> -0.284635).  Saving model ...
Epoch: 23 cost time: 1.4801826477050781
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.943 Vali Acc: 0.265 Test Loss: 7.943 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7383902072906494
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 7.558 Vali Acc: 0.275 Test Loss: 7.558 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6927857398986816
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 7.605 Vali Acc: 0.280 Test Loss: 7.605 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0897612571716309
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.399 Vali Acc: 0.273 Test Loss: 7.399 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4402093887329102
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.626 Vali Acc: 0.281 Test Loss: 7.626 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2813122272491455
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 8.259 Vali Acc: 0.267 Test Loss: 8.259 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.03989577293396
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.405 Vali Acc: 0.259 Test Loss: 8.405 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2352406978607178
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.027 Vali Acc: 0.280 Test Loss: 8.027 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3544998168945312
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.046 Vali Acc: 0.279 Test Loss: 8.046 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9044454097747803
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.064 Vali Acc: 0.276 Test Loss: 8.064 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2847058823529412
model parameter : 30327578
model size : 130.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0816283226013184
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.332 Vali Acc: 0.046 Test Loss: 3.332 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.681119441986084
Epoch: 2, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.339 Vali Acc: 0.062 Test Loss: 3.339 Test Acc: 0.062
Validation loss decreased (-0.045849 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.563330888748169
Epoch: 3, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.298 Vali Acc: 0.067 Test Loss: 3.298 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 0.7365231513977051
Epoch: 4, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.259 Vali Acc: 0.092 Test Loss: 3.259 Test Acc: 0.092
Validation loss decreased (-0.067026 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 0.6782772541046143
Epoch: 5, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.200 Vali Acc: 0.120 Test Loss: 3.200 Test Acc: 0.120
Validation loss decreased (-0.091732 --> -0.119968).  Saving model ...
Epoch: 6 cost time: 0.653313159942627
Epoch: 6, Steps: 10 | Train Loss: 2.188 Vali Loss: 3.209 Vali Acc: 0.146 Test Loss: 3.209 Test Acc: 0.146
Validation loss decreased (-0.119968 --> -0.145850).  Saving model ...
Epoch: 7 cost time: 0.7000837326049805
Epoch: 7, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.258 Vali Acc: 0.180 Test Loss: 3.258 Test Acc: 0.180
Validation loss decreased (-0.145850 --> -0.179967).  Saving model ...
Epoch: 8 cost time: 0.6037931442260742
Epoch: 8, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.483 Vali Acc: 0.216 Test Loss: 3.483 Test Acc: 0.216
Validation loss decreased (-0.179967 --> -0.216436).  Saving model ...
Epoch: 9 cost time: 0.5332558155059814
Epoch: 9, Steps: 10 | Train Loss: 0.927 Vali Loss: 3.882 Vali Acc: 0.214 Test Loss: 3.882 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1750125885009766
Epoch: 10, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.994 Vali Acc: 0.254 Test Loss: 3.994 Test Acc: 0.254
Validation loss decreased (-0.216436 --> -0.254078).  Saving model ...
Epoch: 11 cost time: 0.4980812072753906
Epoch: 11, Steps: 10 | Train Loss: 0.337 Vali Loss: 4.300 Vali Acc: 0.246 Test Loss: 4.300 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6466724872589111
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 4.427 Vali Acc: 0.285 Test Loss: 4.427 Test Acc: 0.285
Validation loss decreased (-0.254078 --> -0.284662).  Saving model ...
Epoch: 13 cost time: 0.82149338722229
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.773 Vali Acc: 0.275 Test Loss: 4.773 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8338778018951416
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.893 Vali Acc: 0.288 Test Loss: 4.893 Test Acc: 0.288
Validation loss decreased (-0.284662 --> -0.288186).  Saving model ...
Epoch: 15 cost time: 0.751701831817627
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.890 Vali Acc: 0.307 Test Loss: 4.890 Test Acc: 0.307
Validation loss decreased (-0.288186 --> -0.307010).  Saving model ...
Epoch: 16 cost time: 0.557750940322876
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.161 Vali Acc: 0.281 Test Loss: 5.161 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5157365798950195
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.229 Vali Acc: 0.282 Test Loss: 5.229 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6508545875549316
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.439 Vali Acc: 0.286 Test Loss: 5.439 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7874355316162109
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.411 Vali Acc: 0.296 Test Loss: 5.411 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9511847496032715
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.353 Vali Acc: 0.299 Test Loss: 5.353 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2139999866485596
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.326 Vali Acc: 0.300 Test Loss: 5.326 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4776322841644287
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.330 Vali Acc: 0.301 Test Loss: 5.330 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7381432056427002
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.317 Vali Acc: 0.306 Test Loss: 5.317 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2035470008850098
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.335 Vali Acc: 0.301 Test Loss: 5.335 Test Acc: 0.301
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2807271480560303
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.311 Vali Acc: 0.307 Test Loss: 5.311 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 29811482
model size : 128.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8612349033355713
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.331 Vali Acc: 0.036 Test Loss: 3.331 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.7360200881958008
Epoch: 2, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.338 Vali Acc: 0.062 Test Loss: 3.338 Test Acc: 0.062
Validation loss decreased (-0.036437 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.7418255805969238
Epoch: 3, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.337 Vali Acc: 0.068 Test Loss: 3.337 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.7752454280853271
Epoch: 4, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.297 Vali Acc: 0.079 Test Loss: 3.297 Test Acc: 0.079
Validation loss decreased (-0.068202 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 1.0746440887451172
Epoch: 5, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.268 Vali Acc: 0.104 Test Loss: 3.268 Test Acc: 0.104
Validation loss decreased (-0.078791 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.6453108787536621
Epoch: 6, Steps: 10 | Train Loss: 2.649 Vali Loss: 3.224 Vali Acc: 0.112 Test Loss: 3.224 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111732).  Saving model ...
Epoch: 7 cost time: 0.6281206607818604
Epoch: 7, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.177 Vali Acc: 0.127 Test Loss: 3.177 Test Acc: 0.127
Validation loss decreased (-0.111732 --> -0.127027).  Saving model ...
Epoch: 8 cost time: 0.6348531246185303
Epoch: 8, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.217 Vali Acc: 0.185 Test Loss: 3.217 Test Acc: 0.185
Validation loss decreased (-0.127027 --> -0.184674).  Saving model ...
Epoch: 9 cost time: 0.5886499881744385
Epoch: 9, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.297 Vali Acc: 0.208 Test Loss: 3.297 Test Acc: 0.208
Validation loss decreased (-0.184674 --> -0.208202).  Saving model ...
Epoch: 10 cost time: 0.6442537307739258
Epoch: 10, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.405 Vali Acc: 0.218 Test Loss: 3.405 Test Acc: 0.218
Validation loss decreased (-0.208202 --> -0.217613).  Saving model ...
Epoch: 11 cost time: 0.6503336429595947
Epoch: 11, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.553 Vali Acc: 0.241 Test Loss: 3.553 Test Acc: 0.241
Validation loss decreased (-0.217613 --> -0.241141).  Saving model ...
Epoch: 12 cost time: 0.6289598941802979
Epoch: 12, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.878 Vali Acc: 0.245 Test Loss: 3.878 Test Acc: 0.245
Validation loss decreased (-0.241141 --> -0.244667).  Saving model ...
Epoch: 13 cost time: 0.8524601459503174
Epoch: 13, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.894 Vali Acc: 0.266 Test Loss: 3.894 Test Acc: 0.266
Validation loss decreased (-0.244667 --> -0.265843).  Saving model ...
Epoch: 14 cost time: 0.5743017196655273
Epoch: 14, Steps: 10 | Train Loss: 0.174 Vali Loss: 4.005 Vali Acc: 0.272 Test Loss: 4.005 Test Acc: 0.272
Validation loss decreased (-0.265843 --> -0.271725).  Saving model ...
Epoch: 15 cost time: 0.6113369464874268
Epoch: 15, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.155 Vali Acc: 0.285 Test Loss: 4.155 Test Acc: 0.285
Validation loss decreased (-0.271725 --> -0.284664).  Saving model ...
Epoch: 16 cost time: 0.6954607963562012
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.370 Vali Acc: 0.286 Test Loss: 4.370 Test Acc: 0.286
Validation loss decreased (-0.284664 --> -0.285839).  Saving model ...
Epoch: 17 cost time: 0.5348927974700928
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.438 Vali Acc: 0.284 Test Loss: 4.438 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7740781307220459
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.412 Vali Acc: 0.296 Test Loss: 4.412 Test Acc: 0.296
Validation loss decreased (-0.285839 --> -0.296426).  Saving model ...
Epoch: 19 cost time: 0.6127820014953613
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.499 Vali Acc: 0.299 Test Loss: 4.499 Test Acc: 0.299
Validation loss decreased (-0.296426 --> -0.298779).  Saving model ...
Epoch: 20 cost time: 0.9839909076690674
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.586 Vali Acc: 0.291 Test Loss: 4.586 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5969245433807373
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.629 Vali Acc: 0.308 Test Loss: 4.629 Test Acc: 0.308
Validation loss decreased (-0.298779 --> -0.308189).  Saving model ...
Epoch: 22 cost time: 0.6817166805267334
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.627 Vali Acc: 0.302 Test Loss: 4.627 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5636773109436035
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.673 Vali Acc: 0.301 Test Loss: 4.673 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6075878143310547
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.731 Vali Acc: 0.301 Test Loss: 4.731 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6951847076416016
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.818 Vali Acc: 0.296 Test Loss: 4.818 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9215257167816162
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.856 Vali Acc: 0.289 Test Loss: 4.856 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4681260585784912
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.841 Vali Acc: 0.296 Test Loss: 4.841 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6134035587310791
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.826 Vali Acc: 0.300 Test Loss: 4.826 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6304640769958496
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.861 Vali Acc: 0.300 Test Loss: 4.861 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5602858066558838
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.900 Vali Acc: 0.300 Test Loss: 4.900 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6651179790496826
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.874 Vali Acc: 0.301 Test Loss: 4.874 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 29574938
model size : 127.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6943917274475098
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.335 Vali Acc: 0.062 Test Loss: 3.335 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 0.9580965042114258
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.363 Vali Acc: 0.094 Test Loss: 3.363 Test Acc: 0.094
Validation loss decreased (-0.062320 --> -0.094084).  Saving model ...
Epoch: 3 cost time: 0.9593427181243896
Epoch: 3, Steps: 10 | Train Loss: 2.968 Vali Loss: 3.254 Vali Acc: 0.094 Test Loss: 3.254 Test Acc: 0.094
Validation loss decreased (-0.094084 --> -0.094085).  Saving model ...
Epoch: 4 cost time: 0.7510683536529541
Epoch: 4, Steps: 10 | Train Loss: 2.608 Vali Loss: 3.194 Vali Acc: 0.138 Test Loss: 3.194 Test Acc: 0.138
Validation loss decreased (-0.094085 --> -0.137615).  Saving model ...
Epoch: 5 cost time: 0.8589224815368652
Epoch: 5, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.197 Vali Acc: 0.148 Test Loss: 3.197 Test Acc: 0.148
Validation loss decreased (-0.137615 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 0.7041962146759033
Epoch: 6, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.330 Vali Acc: 0.213 Test Loss: 3.330 Test Acc: 0.213
Validation loss decreased (-0.148203 --> -0.212908).  Saving model ...
Epoch: 7 cost time: 0.8837432861328125
Epoch: 7, Steps: 10 | Train Loss: 1.250 Vali Loss: 3.727 Vali Acc: 0.198 Test Loss: 3.727 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6945748329162598
Epoch: 8, Steps: 10 | Train Loss: 0.730 Vali Loss: 4.191 Vali Acc: 0.249 Test Loss: 4.191 Test Acc: 0.249
Validation loss decreased (-0.212908 --> -0.249370).  Saving model ...
Epoch: 9 cost time: 0.7446913719177246
Epoch: 9, Steps: 10 | Train Loss: 0.384 Vali Loss: 4.713 Vali Acc: 0.241 Test Loss: 4.713 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.071063756942749
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 5.472 Vali Acc: 0.252 Test Loss: 5.472 Test Acc: 0.252
Validation loss decreased (-0.249370 --> -0.251710).  Saving model ...
Epoch: 11 cost time: 1.680145025253296
Epoch: 11, Steps: 10 | Train Loss: 0.172 Vali Loss: 5.557 Vali Acc: 0.253 Test Loss: 5.557 Test Acc: 0.253
Validation loss decreased (-0.251710 --> -0.252886).  Saving model ...
Epoch: 12 cost time: 0.9668614864349365
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 5.727 Vali Acc: 0.273 Test Loss: 5.727 Test Acc: 0.273
Validation loss decreased (-0.252886 --> -0.272884).  Saving model ...
Epoch: 13 cost time: 0.7678530216217041
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.987 Vali Acc: 0.273 Test Loss: 5.987 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0743052959442139
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 6.099 Vali Acc: 0.254 Test Loss: 6.099 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.27388334274292
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 7.417 Vali Acc: 0.231 Test Loss: 7.417 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0317661762237549
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.899 Vali Acc: 0.260 Test Loss: 6.899 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9464821815490723
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 7.243 Vali Acc: 0.255 Test Loss: 7.243 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3464093208312988
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.281 Vali Acc: 0.282 Test Loss: 7.281 Test Acc: 0.282
Validation loss decreased (-0.272884 --> -0.282280).  Saving model ...
Epoch: 19 cost time: 1.1208431720733643
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.942 Vali Acc: 0.276 Test Loss: 7.942 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9859371185302734
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 8.143 Vali Acc: 0.291 Test Loss: 8.143 Test Acc: 0.291
Validation loss decreased (-0.282280 --> -0.290507).  Saving model ...
Epoch: 21 cost time: 1.2134380340576172
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.150 Vali Acc: 0.271 Test Loss: 8.150 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0606787204742432
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.883 Vali Acc: 0.286 Test Loss: 7.883 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0126607418060303
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.696 Vali Acc: 0.288 Test Loss: 7.696 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1374285221099854
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.483 Vali Acc: 0.296 Test Loss: 7.483 Test Acc: 0.296
Validation loss decreased (-0.290507 --> -0.296396).  Saving model ...
Epoch: 25 cost time: 0.7909271717071533
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.499 Vali Acc: 0.286 Test Loss: 7.499 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5231244564056396
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.493 Vali Acc: 0.292 Test Loss: 7.493 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1003243923187256
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.495 Vali Acc: 0.292 Test Loss: 7.495 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7480230331420898
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.517 Vali Acc: 0.291 Test Loss: 7.517 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7101490497589111
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.535 Vali Acc: 0.294 Test Loss: 7.535 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7066497802734375
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.542 Vali Acc: 0.294 Test Loss: 7.542 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6583690643310547
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.536 Vali Acc: 0.294 Test Loss: 7.536 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6710681915283203
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.540 Vali Acc: 0.294 Test Loss: 7.540 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6972343921661377
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.537 Vali Acc: 0.293 Test Loss: 7.537 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0602412223815918
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.534 Vali Acc: 0.292 Test Loss: 7.534 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 30312986
model size : 130.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.919783592224121
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.311 Vali Acc: 0.034 Test Loss: 3.311 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.5319428443908691
Epoch: 2, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.378 Vali Acc: 0.054 Test Loss: 3.378 Test Acc: 0.054
Validation loss decreased (-0.034085 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.6316988468170166
Epoch: 3, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.356 Vali Acc: 0.094 Test Loss: 3.356 Test Acc: 0.094
Validation loss decreased (-0.054084 --> -0.094084).  Saving model ...
Epoch: 4 cost time: 0.5346391201019287
Epoch: 4, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.231 Vali Acc: 0.089 Test Loss: 3.231 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48912525177001953
Epoch: 5, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.191 Vali Acc: 0.128 Test Loss: 3.191 Test Acc: 0.128
Validation loss decreased (-0.094084 --> -0.128203).  Saving model ...
Epoch: 6 cost time: 0.6294524669647217
Epoch: 6, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.206 Vali Acc: 0.158 Test Loss: 3.206 Test Acc: 0.158
Validation loss decreased (-0.128203 --> -0.157615).  Saving model ...
Epoch: 7 cost time: 0.7826454639434814
Epoch: 7, Steps: 10 | Train Loss: 1.746 Vali Loss: 3.306 Vali Acc: 0.194 Test Loss: 3.306 Test Acc: 0.194
Validation loss decreased (-0.157615 --> -0.194085).  Saving model ...
Epoch: 8 cost time: 0.782721757888794
Epoch: 8, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.599 Vali Acc: 0.189 Test Loss: 3.599 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5366804599761963
Epoch: 9, Steps: 10 | Train Loss: 0.914 Vali Loss: 3.908 Vali Acc: 0.207 Test Loss: 3.908 Test Acc: 0.207
Validation loss decreased (-0.194085 --> -0.207020).  Saving model ...
Epoch: 10 cost time: 0.7754116058349609
Epoch: 10, Steps: 10 | Train Loss: 0.636 Vali Loss: 4.086 Vali Acc: 0.238 Test Loss: 4.086 Test Acc: 0.238
Validation loss decreased (-0.207020 --> -0.237606).  Saving model ...
Epoch: 11 cost time: 0.9755764007568359
Epoch: 11, Steps: 10 | Train Loss: 0.419 Vali Loss: 4.351 Vali Acc: 0.259 Test Loss: 4.351 Test Acc: 0.259
Validation loss decreased (-0.237606 --> -0.258780).  Saving model ...
Epoch: 12 cost time: 0.7447054386138916
Epoch: 12, Steps: 10 | Train Loss: 0.320 Vali Loss: 4.546 Vali Acc: 0.262 Test Loss: 4.546 Test Acc: 0.262
Validation loss decreased (-0.258780 --> -0.262307).  Saving model ...
Epoch: 13 cost time: 0.6821370124816895
Epoch: 13, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.538 Vali Acc: 0.265 Test Loss: 4.538 Test Acc: 0.265
Validation loss decreased (-0.262307 --> -0.264661).  Saving model ...
Epoch: 14 cost time: 0.9127674102783203
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.928 Vali Acc: 0.276 Test Loss: 4.928 Test Acc: 0.276
Validation loss decreased (-0.264661 --> -0.276421).  Saving model ...
Epoch: 15 cost time: 0.7092807292938232
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.124 Vali Acc: 0.291 Test Loss: 5.124 Test Acc: 0.291
Validation loss decreased (-0.276421 --> -0.290537).  Saving model ...
Epoch: 16 cost time: 0.7838358879089355
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.308 Vali Acc: 0.287 Test Loss: 5.308 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9326310157775879
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.209 Vali Acc: 0.295 Test Loss: 5.209 Test Acc: 0.295
Validation loss decreased (-0.290537 --> -0.295242).  Saving model ...
Epoch: 18 cost time: 0.6625919342041016
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.269 Vali Acc: 0.291 Test Loss: 5.269 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6531455516815186
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.316 Vali Acc: 0.305 Test Loss: 5.316 Test Acc: 0.305
Validation loss decreased (-0.295242 --> -0.304653).  Saving model ...
Epoch: 20 cost time: 0.5781052112579346
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.350 Vali Acc: 0.305 Test Loss: 5.350 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6378576755523682
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.350 Vali Acc: 0.298 Test Loss: 5.350 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.074256420135498
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.307 Vali Acc: 0.312 Test Loss: 5.307 Test Acc: 0.312
Validation loss decreased (-0.304653 --> -0.311712).  Saving model ...
Epoch: 23 cost time: 0.639000654220581
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.318 Vali Acc: 0.309 Test Loss: 5.318 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6169471740722656
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.374 Vali Acc: 0.306 Test Loss: 5.374 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5876712799072266
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.400 Vali Acc: 0.304 Test Loss: 5.400 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2621889114379883
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.410 Vali Acc: 0.302 Test Loss: 5.410 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6201767921447754
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.877 Vali Acc: 0.284 Test Loss: 5.877 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.001781702041626
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.644 Vali Acc: 0.300 Test Loss: 5.644 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.935753583908081
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.537 Vali Acc: 0.299 Test Loss: 5.537 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7581291198730469
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.522 Vali Acc: 0.300 Test Loss: 5.522 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2507996559143066
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.563 Vali Acc: 0.298 Test Loss: 5.563 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.236936092376709
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.579 Vali Acc: 0.306 Test Loss: 5.579 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 29818394
model size : 128.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.20446515083313
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.333 Vali Acc: 0.039 Test Loss: 3.333 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.7515788078308105
Epoch: 2, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.325 Vali Acc: 0.033 Test Loss: 3.325 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7883272171020508
Epoch: 3, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.318 Vali Acc: 0.056 Test Loss: 3.318 Test Acc: 0.056
Validation loss decreased (-0.038790 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 0.7116479873657227
Epoch: 4, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.298 Vali Acc: 0.058 Test Loss: 3.298 Test Acc: 0.058
Validation loss decreased (-0.056437 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.6038210391998291
Epoch: 5, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.249 Vali Acc: 0.087 Test Loss: 3.249 Test Acc: 0.087
Validation loss decreased (-0.057614 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 0.6218457221984863
Epoch: 6, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.222 Vali Acc: 0.107 Test Loss: 3.222 Test Acc: 0.107
Validation loss decreased (-0.087026 --> -0.107027).  Saving model ...
Epoch: 7 cost time: 0.5778098106384277
Epoch: 7, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.172 Vali Acc: 0.127 Test Loss: 3.172 Test Acc: 0.127
Validation loss decreased (-0.107027 --> -0.127027).  Saving model ...
Epoch: 8 cost time: 0.6203265190124512
Epoch: 8, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.230 Vali Acc: 0.159 Test Loss: 3.230 Test Acc: 0.159
Validation loss decreased (-0.127027 --> -0.158791).  Saving model ...
Epoch: 9 cost time: 0.6095166206359863
Epoch: 9, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.327 Vali Acc: 0.205 Test Loss: 3.327 Test Acc: 0.205
Validation loss decreased (-0.158791 --> -0.204673).  Saving model ...
Epoch: 10 cost time: 0.639864444732666
Epoch: 10, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.524 Vali Acc: 0.209 Test Loss: 3.524 Test Acc: 0.209
Validation loss decreased (-0.204673 --> -0.209377).  Saving model ...
Epoch: 11 cost time: 0.7616195678710938
Epoch: 11, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.622 Vali Acc: 0.238 Test Loss: 3.622 Test Acc: 0.238
Validation loss decreased (-0.209377 --> -0.237611).  Saving model ...
Epoch: 12 cost time: 0.6306211948394775
Epoch: 12, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.852 Vali Acc: 0.246 Test Loss: 3.852 Test Acc: 0.246
Validation loss decreased (-0.237611 --> -0.245844).  Saving model ...
Epoch: 13 cost time: 0.6104822158813477
Epoch: 13, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.927 Vali Acc: 0.253 Test Loss: 3.927 Test Acc: 0.253
Validation loss decreased (-0.245844 --> -0.252902).  Saving model ...
Epoch: 14 cost time: 0.7557153701782227
Epoch: 14, Steps: 10 | Train Loss: 0.265 Vali Loss: 4.342 Vali Acc: 0.249 Test Loss: 4.342 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6736254692077637
Epoch: 15, Steps: 10 | Train Loss: 0.176 Vali Loss: 4.148 Vali Acc: 0.278 Test Loss: 4.148 Test Acc: 0.278
Validation loss decreased (-0.252902 --> -0.277606).  Saving model ...
Epoch: 16 cost time: 0.5328075885772705
Epoch: 16, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.321 Vali Acc: 0.267 Test Loss: 4.321 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6196455955505371
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.493 Vali Acc: 0.275 Test Loss: 4.493 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7241733074188232
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.500 Vali Acc: 0.284 Test Loss: 4.500 Test Acc: 0.284
Validation loss decreased (-0.277606 --> -0.283484).  Saving model ...
Epoch: 19 cost time: 0.6364023685455322
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.676 Vali Acc: 0.262 Test Loss: 4.676 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6618847846984863
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.649 Vali Acc: 0.279 Test Loss: 4.649 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5612714290618896
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.686 Vali Acc: 0.301 Test Loss: 4.686 Test Acc: 0.301
Validation loss decreased (-0.283484 --> -0.301130).  Saving model ...
Epoch: 22 cost time: 0.6965019702911377
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.790 Vali Acc: 0.272 Test Loss: 4.790 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6952767372131348
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.763 Vali Acc: 0.282 Test Loss: 4.763 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7757422924041748
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.756 Vali Acc: 0.279 Test Loss: 4.756 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6564884185791016
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.749 Vali Acc: 0.293 Test Loss: 4.749 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5472261905670166
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.810 Vali Acc: 0.294 Test Loss: 4.810 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5367162227630615
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.859 Vali Acc: 0.292 Test Loss: 4.859 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5975327491760254
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.892 Vali Acc: 0.291 Test Loss: 4.892 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6467900276184082
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.892 Vali Acc: 0.291 Test Loss: 4.892 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5235850811004639
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.902 Vali Acc: 0.292 Test Loss: 4.902 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.553640604019165
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.930 Vali Acc: 0.293 Test Loss: 4.930 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 29560346
model size : 127.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.182971239089966
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.336 Vali Acc: 0.041 Test Loss: 3.336 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.7131996154785156
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.390 Vali Acc: 0.073 Test Loss: 3.390 Test Acc: 0.073
Validation loss decreased (-0.041143 --> -0.072907).  Saving model ...
Epoch: 3 cost time: 0.6768777370452881
Epoch: 3, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.269 Vali Acc: 0.072 Test Loss: 3.269 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0850567817687988
Epoch: 4, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.239 Vali Acc: 0.119 Test Loss: 3.239 Test Acc: 0.119
Validation loss decreased (-0.072907 --> -0.118791).  Saving model ...
Epoch: 5 cost time: 0.7902686595916748
Epoch: 5, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.156 Vali Acc: 0.156 Test Loss: 3.156 Test Acc: 0.156
Validation loss decreased (-0.118791 --> -0.156439).  Saving model ...
Epoch: 6 cost time: 0.7967250347137451
Epoch: 6, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.185 Vali Acc: 0.193 Test Loss: 3.185 Test Acc: 0.193
Validation loss decreased (-0.156439 --> -0.192909).  Saving model ...
Epoch: 7 cost time: 1.371750831604004
Epoch: 7, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.400 Vali Acc: 0.214 Test Loss: 3.400 Test Acc: 0.214
Validation loss decreased (-0.192909 --> -0.214084).  Saving model ...
Epoch: 8 cost time: 0.7142319679260254
Epoch: 8, Steps: 10 | Train Loss: 0.890 Vali Loss: 3.833 Vali Acc: 0.228 Test Loss: 3.833 Test Acc: 0.228
Validation loss decreased (-0.214084 --> -0.228197).  Saving model ...
Epoch: 9 cost time: 0.6218934059143066
Epoch: 9, Steps: 10 | Train Loss: 0.679 Vali Loss: 4.224 Vali Acc: 0.254 Test Loss: 4.224 Test Acc: 0.254
Validation loss decreased (-0.228197 --> -0.254075).  Saving model ...
Epoch: 10 cost time: 1.0144460201263428
Epoch: 10, Steps: 10 | Train Loss: 0.362 Vali Loss: 4.570 Vali Acc: 0.248 Test Loss: 4.570 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2680704593658447
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.998 Vali Acc: 0.261 Test Loss: 4.998 Test Acc: 0.261
Validation loss decreased (-0.254075 --> -0.261126).  Saving model ...
Epoch: 12 cost time: 0.8800289630889893
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 5.407 Vali Acc: 0.278 Test Loss: 5.407 Test Acc: 0.278
Validation loss decreased (-0.261126 --> -0.277593).  Saving model ...
Epoch: 13 cost time: 1.2575299739837646
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.499 Vali Acc: 0.269 Test Loss: 5.499 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.807772159576416
Epoch: 14, Steps: 10 | Train Loss: 0.099 Vali Loss: 6.035 Vali Acc: 0.273 Test Loss: 6.035 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9273331165313721
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.278 Vali Acc: 0.258 Test Loss: 6.278 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6865537166595459
Epoch: 16, Steps: 10 | Train Loss: 0.095 Vali Loss: 6.285 Vali Acc: 0.254 Test Loss: 6.285 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.706763744354248
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.524 Vali Acc: 0.260 Test Loss: 6.524 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.631629228591919
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.040 Vali Acc: 0.294 Test Loss: 6.040 Test Acc: 0.294
Validation loss decreased (-0.277593 --> -0.294057).  Saving model ...
Epoch: 19 cost time: 0.7468504905700684
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.247 Vali Acc: 0.293 Test Loss: 6.247 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7797369956970215
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.179 Vali Acc: 0.295 Test Loss: 6.179 Test Acc: 0.295
Validation loss decreased (-0.294057 --> -0.295232).  Saving model ...
Epoch: 21 cost time: 0.6442232131958008
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.270 Vali Acc: 0.309 Test Loss: 6.270 Test Acc: 0.309
Validation loss decreased (-0.295232 --> -0.309349).  Saving model ...
Epoch: 22 cost time: 1.1111221313476562
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.347 Vali Acc: 0.292 Test Loss: 6.347 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8765830993652344
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.454 Vali Acc: 0.284 Test Loss: 6.454 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7834768295288086
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.438 Vali Acc: 0.286 Test Loss: 6.438 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0282702445983887
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.513 Vali Acc: 0.293 Test Loss: 6.513 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7028393745422363
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.446 Vali Acc: 0.302 Test Loss: 6.446 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6952033042907715
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.369 Vali Acc: 0.305 Test Loss: 6.369 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.685295820236206
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.320 Vali Acc: 0.305 Test Loss: 6.320 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6699128150939941
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.307 Vali Acc: 0.302 Test Loss: 6.307 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7147464752197266
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.284 Vali Acc: 0.306 Test Loss: 6.284 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0606343746185303
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.280 Vali Acc: 0.302 Test Loss: 6.280 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 30061850
model size : 129.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.651129961013794
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.324 Vali Acc: 0.045 Test Loss: 3.324 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.153031349182129
Epoch: 2, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.336 Vali Acc: 0.072 Test Loss: 3.336 Test Acc: 0.072
Validation loss decreased (-0.044673 --> -0.071731).  Saving model ...
Epoch: 3 cost time: 0.5813977718353271
Epoch: 3, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.325 Vali Acc: 0.085 Test Loss: 3.325 Test Acc: 0.085
Validation loss decreased (-0.071731 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 0.8330545425415039
Epoch: 4, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.256 Vali Acc: 0.108 Test Loss: 3.256 Test Acc: 0.108
Validation loss decreased (-0.084673 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 0.7265231609344482
Epoch: 5, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.186 Vali Acc: 0.118 Test Loss: 3.186 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 0.7409458160400391
Epoch: 6, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.197 Vali Acc: 0.125 Test Loss: 3.197 Test Acc: 0.125
Validation loss decreased (-0.117615 --> -0.124674).  Saving model ...
Epoch: 7 cost time: 1.166565179824829
Epoch: 7, Steps: 10 | Train Loss: 2.019 Vali Loss: 3.147 Vali Acc: 0.173 Test Loss: 3.147 Test Acc: 0.173
Validation loss decreased (-0.124674 --> -0.172910).  Saving model ...
Epoch: 8 cost time: 1.0981645584106445
Epoch: 8, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.357 Vali Acc: 0.204 Test Loss: 3.357 Test Acc: 0.204
Validation loss decreased (-0.172910 --> -0.203496).  Saving model ...
Epoch: 9 cost time: 1.0655720233917236
Epoch: 9, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.564 Vali Acc: 0.253 Test Loss: 3.564 Test Acc: 0.253
Validation loss decreased (-0.203496 --> -0.252906).  Saving model ...
Epoch: 10 cost time: 1.0547804832458496
Epoch: 10, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.954 Vali Acc: 0.248 Test Loss: 3.954 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.633906364440918
Epoch: 11, Steps: 10 | Train Loss: 0.435 Vali Loss: 4.055 Vali Acc: 0.258 Test Loss: 4.055 Test Acc: 0.258
Validation loss decreased (-0.252906 --> -0.257607).  Saving model ...
Epoch: 12 cost time: 0.6125946044921875
Epoch: 12, Steps: 10 | Train Loss: 0.252 Vali Loss: 4.348 Vali Acc: 0.259 Test Loss: 4.348 Test Acc: 0.259
Validation loss decreased (-0.257607 --> -0.258780).  Saving model ...
Epoch: 13 cost time: 1.462993860244751
Epoch: 13, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.707 Vali Acc: 0.272 Test Loss: 4.707 Test Acc: 0.272
Validation loss decreased (-0.258780 --> -0.271718).  Saving model ...
Epoch: 14 cost time: 0.7560176849365234
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.697 Vali Acc: 0.267 Test Loss: 4.697 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9209108352661133
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.892 Vali Acc: 0.280 Test Loss: 4.892 Test Acc: 0.280
Validation loss decreased (-0.271718 --> -0.279951).  Saving model ...
Epoch: 16 cost time: 1.1457359790802002
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.916 Vali Acc: 0.269 Test Loss: 4.916 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8357899188995361
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.992 Vali Acc: 0.272 Test Loss: 4.992 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.49936366081237793
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.259 Vali Acc: 0.278 Test Loss: 5.259 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6100208759307861
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.153 Vali Acc: 0.292 Test Loss: 5.153 Test Acc: 0.292
Validation loss decreased (-0.279951 --> -0.291713).  Saving model ...
Epoch: 20 cost time: 0.8201193809509277
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.113 Vali Acc: 0.302 Test Loss: 5.113 Test Acc: 0.302
Validation loss decreased (-0.291713 --> -0.302302).  Saving model ...
Epoch: 21 cost time: 0.5246424674987793
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.236 Vali Acc: 0.294 Test Loss: 5.236 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6548142433166504
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.185 Vali Acc: 0.300 Test Loss: 5.185 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7321262359619141
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.189 Vali Acc: 0.306 Test Loss: 5.189 Test Acc: 0.306
Validation loss decreased (-0.302302 --> -0.305830).  Saving model ...
Epoch: 24 cost time: 1.17374849319458
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.241 Vali Acc: 0.294 Test Loss: 5.241 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6668407917022705
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.300 Vali Acc: 0.295 Test Loss: 5.300 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5866832733154297
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.288 Vali Acc: 0.305 Test Loss: 5.288 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5004196166992188
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.299 Vali Acc: 0.301 Test Loss: 5.299 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5139389038085938
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.318 Vali Acc: 0.305 Test Loss: 5.318 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4809567928314209
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.288 Vali Acc: 0.301 Test Loss: 5.288 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6706647872924805
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.284 Vali Acc: 0.304 Test Loss: 5.284 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5594346523284912
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.296 Vali Acc: 0.306 Test Loss: 5.296 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5663454532623291
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.306 Vali Acc: 0.308 Test Loss: 5.306 Test Acc: 0.308
Validation loss decreased (-0.305830 --> -0.308182).  Saving model ...
Epoch: 33 cost time: 1.1496405601501465
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.308 Vali Acc: 0.309 Test Loss: 5.308 Test Acc: 0.309
Validation loss decreased (-0.308182 --> -0.309359).  Saving model ...
Epoch: 34 cost time: 0.5281870365142822
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.322 Vali Acc: 0.309 Test Loss: 5.322 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7923181056976318
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.335 Vali Acc: 0.308 Test Loss: 5.335 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6509580612182617
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.347 Vali Acc: 0.307 Test Loss: 5.347 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5921661853790283
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.362 Vali Acc: 0.306 Test Loss: 5.362 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.594395637512207
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.371 Vali Acc: 0.311 Test Loss: 5.371 Test Acc: 0.311
Validation loss decreased (-0.309359 --> -0.310535).  Saving model ...
Epoch: 39 cost time: 0.5969605445861816
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.367 Vali Acc: 0.302 Test Loss: 5.367 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5424928665161133
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.388 Vali Acc: 0.306 Test Loss: 5.388 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6484863758087158
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.405 Vali Acc: 0.307 Test Loss: 5.405 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6965296268463135
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.419 Vali Acc: 0.309 Test Loss: 5.419 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.577979326248169
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.431 Vali Acc: 0.312 Test Loss: 5.431 Test Acc: 0.312
Validation loss decreased (-0.310535 --> -0.311710).  Saving model ...
Epoch: 44 cost time: 0.5922436714172363
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.428 Vali Acc: 0.311 Test Loss: 5.428 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2588872909545898
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.431 Vali Acc: 0.308 Test Loss: 5.431 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1715285778045654
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.439 Vali Acc: 0.307 Test Loss: 5.439 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1364593505859375
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.429 Vali Acc: 0.308 Test Loss: 5.429 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9087619781494141
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.423 Vali Acc: 0.311 Test Loss: 5.423 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9337921142578125
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.436 Vali Acc: 0.306 Test Loss: 5.436 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6977615356445312
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.430 Vali Acc: 0.311 Test Loss: 5.430 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 29739290
model size : 128.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8671989440917969
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.343 Vali Acc: 0.053 Test Loss: 3.343 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.6639225482940674
Epoch: 2, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.317 Vali Acc: 0.058 Test Loss: 3.317 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.6177463531494141
Epoch: 3, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.336 Vali Acc: 0.062 Test Loss: 3.336 Test Acc: 0.062
Validation loss decreased (-0.057614 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.8001503944396973
Epoch: 4, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.300 Vali Acc: 0.085 Test Loss: 3.300 Test Acc: 0.085
Validation loss decreased (-0.062320 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 0.591113805770874
Epoch: 5, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.247 Vali Acc: 0.104 Test Loss: 3.247 Test Acc: 0.104
Validation loss decreased (-0.084673 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.625917911529541
Epoch: 6, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.212 Vali Acc: 0.115 Test Loss: 3.212 Test Acc: 0.115
Validation loss decreased (-0.103497 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 0.6591763496398926
Epoch: 7, Steps: 10 | Train Loss: 2.374 Vali Loss: 3.180 Vali Acc: 0.131 Test Loss: 3.180 Test Acc: 0.131
Validation loss decreased (-0.115262 --> -0.130556).  Saving model ...
Epoch: 8 cost time: 0.6141769886016846
Epoch: 8, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.203 Vali Acc: 0.166 Test Loss: 3.203 Test Acc: 0.166
Validation loss decreased (-0.130556 --> -0.165850).  Saving model ...
Epoch: 9 cost time: 0.9208457469940186
Epoch: 9, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.303 Vali Acc: 0.188 Test Loss: 3.303 Test Acc: 0.188
Validation loss decreased (-0.165850 --> -0.188202).  Saving model ...
Epoch: 10 cost time: 0.5910069942474365
Epoch: 10, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.439 Vali Acc: 0.208 Test Loss: 3.439 Test Acc: 0.208
Validation loss decreased (-0.188202 --> -0.208201).  Saving model ...
Epoch: 11 cost time: 0.6924219131469727
Epoch: 11, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.497 Vali Acc: 0.258 Test Loss: 3.497 Test Acc: 0.258
Validation loss decreased (-0.208201 --> -0.257612).  Saving model ...
Epoch: 12 cost time: 0.5349845886230469
Epoch: 12, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.725 Vali Acc: 0.253 Test Loss: 3.725 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5160670280456543
Epoch: 13, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.781 Vali Acc: 0.272 Test Loss: 3.781 Test Acc: 0.272
Validation loss decreased (-0.257612 --> -0.271727).  Saving model ...
Epoch: 14 cost time: 0.6187987327575684
Epoch: 14, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.955 Vali Acc: 0.273 Test Loss: 3.955 Test Acc: 0.273
Validation loss decreased (-0.271727 --> -0.272902).  Saving model ...
Epoch: 15 cost time: 0.7189180850982666
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.192 Vali Acc: 0.261 Test Loss: 4.192 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6706650257110596
Epoch: 16, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.208 Vali Acc: 0.286 Test Loss: 4.208 Test Acc: 0.286
Validation loss decreased (-0.272902 --> -0.285840).  Saving model ...
Epoch: 17 cost time: 0.6428349018096924
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.285 Vali Acc: 0.287 Test Loss: 4.285 Test Acc: 0.287
Validation loss decreased (-0.285840 --> -0.287016).  Saving model ...
Epoch: 18 cost time: 0.6900718212127686
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.411 Vali Acc: 0.266 Test Loss: 4.411 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5651814937591553
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.522 Vali Acc: 0.286 Test Loss: 4.522 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5853302478790283
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.599 Vali Acc: 0.296 Test Loss: 4.599 Test Acc: 0.296
Validation loss decreased (-0.287016 --> -0.296425).  Saving model ...
Epoch: 21 cost time: 0.6372230052947998
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.556 Vali Acc: 0.296 Test Loss: 4.556 Test Acc: 0.296
Validation loss decreased (-0.296425 --> -0.296425).  Saving model ...
Epoch: 22 cost time: 0.5829176902770996
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.570 Vali Acc: 0.304 Test Loss: 4.570 Test Acc: 0.304
Validation loss decreased (-0.296425 --> -0.303484).  Saving model ...
Epoch: 23 cost time: 0.7660164833068848
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.635 Vali Acc: 0.299 Test Loss: 4.635 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5289402008056641
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.699 Vali Acc: 0.294 Test Loss: 4.699 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5101523399353027
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.726 Vali Acc: 0.292 Test Loss: 4.726 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5184876918792725
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.749 Vali Acc: 0.295 Test Loss: 4.749 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5802168846130371
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.708 Vali Acc: 0.299 Test Loss: 4.708 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5709896087646484
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.734 Vali Acc: 0.301 Test Loss: 4.734 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8633451461791992
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.813 Vali Acc: 0.296 Test Loss: 4.813 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.605086088180542
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.787 Vali Acc: 0.295 Test Loss: 4.787 Test Acc: 0.295
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5171778202056885
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.787 Vali Acc: 0.295 Test Loss: 4.787 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5711343288421631
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.846 Vali Acc: 0.294 Test Loss: 4.846 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 29545754
model size : 127.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.251776695251465
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.339 Vali Acc: 0.040 Test Loss: 3.339 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.5452871322631836
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.341 Vali Acc: 0.069 Test Loss: 3.341 Test Acc: 0.069
Validation loss decreased (-0.039967 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.6943850517272949
Epoch: 3, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.271 Vali Acc: 0.068 Test Loss: 3.271 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7308464050292969
Epoch: 4, Steps: 10 | Train Loss: 2.679 Vali Loss: 3.212 Vali Acc: 0.133 Test Loss: 3.212 Test Acc: 0.133
Validation loss decreased (-0.069378 --> -0.132909).  Saving model ...
Epoch: 5 cost time: 0.7991986274719238
Epoch: 5, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.197 Vali Acc: 0.172 Test Loss: 3.197 Test Acc: 0.172
Validation loss decreased (-0.132909 --> -0.171733).  Saving model ...
Epoch: 6 cost time: 0.6794652938842773
Epoch: 6, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.177 Vali Acc: 0.181 Test Loss: 3.177 Test Acc: 0.181
Validation loss decreased (-0.171733 --> -0.181145).  Saving model ...
Epoch: 7 cost time: 1.455012321472168
Epoch: 7, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.481 Vali Acc: 0.215 Test Loss: 3.481 Test Acc: 0.215
Validation loss decreased (-0.181145 --> -0.215259).  Saving model ...
Epoch: 8 cost time: 0.9948015213012695
Epoch: 8, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.987 Vali Acc: 0.220 Test Loss: 3.987 Test Acc: 0.220
Validation loss decreased (-0.215259 --> -0.219960).  Saving model ...
Epoch: 9 cost time: 1.2992339134216309
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 4.145 Vali Acc: 0.273 Test Loss: 4.145 Test Acc: 0.273
Validation loss decreased (-0.219960 --> -0.272900).  Saving model ...
Epoch: 10 cost time: 0.7336547374725342
Epoch: 10, Steps: 10 | Train Loss: 0.356 Vali Loss: 4.603 Vali Acc: 0.252 Test Loss: 4.603 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7175905704498291
Epoch: 11, Steps: 10 | Train Loss: 0.166 Vali Loss: 4.864 Vali Acc: 0.271 Test Loss: 4.864 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6864504814147949
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 5.678 Vali Acc: 0.255 Test Loss: 5.678 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6446757316589355
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 5.097 Vali Acc: 0.278 Test Loss: 5.097 Test Acc: 0.278
Validation loss decreased (-0.272900 --> -0.277596).  Saving model ...
Epoch: 14 cost time: 1.2911429405212402
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.406 Vali Acc: 0.288 Test Loss: 5.406 Test Acc: 0.288
Validation loss decreased (-0.277596 --> -0.288181).  Saving model ...
Epoch: 15 cost time: 0.5680544376373291
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.581 Vali Acc: 0.292 Test Loss: 5.581 Test Acc: 0.292
Validation loss decreased (-0.288181 --> -0.291709).  Saving model ...
Epoch: 16 cost time: 0.552992582321167
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.922 Vali Acc: 0.272 Test Loss: 5.922 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9485135078430176
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.838 Vali Acc: 0.279 Test Loss: 5.838 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.701657772064209
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.724 Vali Acc: 0.311 Test Loss: 5.724 Test Acc: 0.311
Validation loss decreased (-0.291709 --> -0.310531).  Saving model ...
Epoch: 19 cost time: 0.901669979095459
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.806 Vali Acc: 0.315 Test Loss: 5.806 Test Acc: 0.315
Validation loss decreased (-0.310531 --> -0.315236).  Saving model ...
Epoch: 20 cost time: 0.5718128681182861
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.698 Vali Acc: 0.324 Test Loss: 5.698 Test Acc: 0.324
Validation loss decreased (-0.315236 --> -0.323472).  Saving model ...
Epoch: 21 cost time: 1.1379339694976807
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.719 Vali Acc: 0.318 Test Loss: 5.719 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.164025068283081
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.703 Vali Acc: 0.314 Test Loss: 5.703 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1612272262573242
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.696 Vali Acc: 0.315 Test Loss: 5.696 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2498681545257568
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.692 Vali Acc: 0.318 Test Loss: 5.692 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2568449974060059
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.698 Vali Acc: 0.312 Test Loss: 5.698 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0074219703674316
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.702 Vali Acc: 0.318 Test Loss: 5.702 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9032511711120605
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.702 Vali Acc: 0.325 Test Loss: 5.702 Test Acc: 0.325
Validation loss decreased (-0.323472 --> -0.324649).  Saving model ...
Epoch: 28 cost time: 0.8945164680480957
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.721 Vali Acc: 0.328 Test Loss: 5.721 Test Acc: 0.328
Validation loss decreased (-0.324649 --> -0.328178).  Saving model ...
Epoch: 29 cost time: 0.8051660060882568
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.744 Vali Acc: 0.324 Test Loss: 5.744 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6387410163879395
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.813 Vali Acc: 0.324 Test Loss: 5.813 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0151355266571045
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.794 Vali Acc: 0.320 Test Loss: 5.794 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7792365550994873
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.775 Vali Acc: 0.322 Test Loss: 5.775 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8780181407928467
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.088 Vali Acc: 0.302 Test Loss: 6.088 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.174314260482788
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.814 Vali Acc: 0.325 Test Loss: 5.814 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1086630821228027
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.974 Vali Acc: 0.299 Test Loss: 5.974 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9238886833190918
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.401 Vali Acc: 0.286 Test Loss: 6.401 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0764803886413574
Epoch: 37, Steps: 10 | Train Loss: 0.025 Vali Loss: 6.486 Vali Acc: 0.274 Test Loss: 6.486 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.769575834274292
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.371 Vali Acc: 0.282 Test Loss: 6.371 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 30068762
model size : 129.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9699037075042725
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.352 Vali Acc: 0.040 Test Loss: 3.352 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.6822359561920166
Epoch: 2, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.331 Vali Acc: 0.041 Test Loss: 3.331 Test Acc: 0.041
Validation loss decreased (-0.039966 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.6879684925079346
Epoch: 3, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.331 Vali Acc: 0.076 Test Loss: 3.331 Test Acc: 0.076
Validation loss decreased (-0.041143 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 1.4066746234893799
Epoch: 4, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.268 Vali Acc: 0.086 Test Loss: 3.268 Test Acc: 0.086
Validation loss decreased (-0.076437 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.6736719608306885
Epoch: 5, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.193 Vali Acc: 0.112 Test Loss: 3.193 Test Acc: 0.112
Validation loss decreased (-0.085850 --> -0.111733).  Saving model ...
Epoch: 6 cost time: 0.6187183856964111
Epoch: 6, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.170 Vali Acc: 0.138 Test Loss: 3.170 Test Acc: 0.138
Validation loss decreased (-0.111733 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 0.7546055316925049
Epoch: 7, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.194 Vali Acc: 0.185 Test Loss: 3.194 Test Acc: 0.185
Validation loss decreased (-0.137615 --> -0.184674).  Saving model ...
Epoch: 8 cost time: 0.9996695518493652
Epoch: 8, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.339 Vali Acc: 0.211 Test Loss: 3.339 Test Acc: 0.211
Validation loss decreased (-0.184674 --> -0.210555).  Saving model ...
Epoch: 9 cost time: 1.2384848594665527
Epoch: 9, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.616 Vali Acc: 0.233 Test Loss: 3.616 Test Acc: 0.233
Validation loss decreased (-0.210555 --> -0.232905).  Saving model ...
Epoch: 10 cost time: 1.1201555728912354
Epoch: 10, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.789 Vali Acc: 0.264 Test Loss: 3.789 Test Acc: 0.264
Validation loss decreased (-0.232905 --> -0.263492).  Saving model ...
Epoch: 11 cost time: 0.853546142578125
Epoch: 11, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.986 Vali Acc: 0.255 Test Loss: 3.986 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6961202621459961
Epoch: 12, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.291 Vali Acc: 0.272 Test Loss: 4.291 Test Acc: 0.272
Validation loss decreased (-0.263492 --> -0.271722).  Saving model ...
Epoch: 13 cost time: 0.934180736541748
Epoch: 13, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.441 Vali Acc: 0.276 Test Loss: 4.441 Test Acc: 0.276
Validation loss decreased (-0.271722 --> -0.276426).  Saving model ...
Epoch: 14 cost time: 0.7018675804138184
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.750 Vali Acc: 0.273 Test Loss: 4.750 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7458641529083252
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.797 Vali Acc: 0.289 Test Loss: 4.797 Test Acc: 0.289
Validation loss decreased (-0.276426 --> -0.289364).  Saving model ...
Epoch: 16 cost time: 0.7740917205810547
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.798 Vali Acc: 0.288 Test Loss: 4.798 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6431829929351807
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.924 Vali Acc: 0.278 Test Loss: 4.924 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6882467269897461
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.902 Vali Acc: 0.295 Test Loss: 4.902 Test Acc: 0.295
Validation loss decreased (-0.289364 --> -0.295245).  Saving model ...
Epoch: 19 cost time: 0.6751916408538818
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.981 Vali Acc: 0.312 Test Loss: 4.981 Test Acc: 0.312
Validation loss decreased (-0.295245 --> -0.311715).  Saving model ...
Epoch: 20 cost time: 0.7355427742004395
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.982 Vali Acc: 0.309 Test Loss: 4.982 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6295228004455566
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.969 Vali Acc: 0.313 Test Loss: 4.969 Test Acc: 0.313
Validation loss decreased (-0.311715 --> -0.312891).  Saving model ...
Epoch: 22 cost time: 1.005019187927246
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.952 Vali Acc: 0.309 Test Loss: 4.952 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6469275951385498
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.977 Vali Acc: 0.302 Test Loss: 4.977 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6767463684082031
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.028 Vali Acc: 0.299 Test Loss: 5.028 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6347241401672363
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.037 Vali Acc: 0.301 Test Loss: 5.037 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6089210510253906
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.042 Vali Acc: 0.301 Test Loss: 5.042 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6676154136657715
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.046 Vali Acc: 0.308 Test Loss: 5.046 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.146277904510498
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.112 Vali Acc: 0.301 Test Loss: 5.112 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6939761638641357
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.130 Vali Acc: 0.304 Test Loss: 5.130 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7476108074188232
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.142 Vali Acc: 0.300 Test Loss: 5.142 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6377584934234619
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.176 Vali Acc: 0.307 Test Loss: 5.176 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 29746202
model size : 128.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9709060192108154
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.327 Vali Acc: 0.048 Test Loss: 3.327 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.5982499122619629
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.297 Vali Acc: 0.054 Test Loss: 3.297 Test Acc: 0.054
Validation loss decreased (-0.048202 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 1.0336260795593262
Epoch: 3, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.324 Vali Acc: 0.073 Test Loss: 3.324 Test Acc: 0.073
Validation loss decreased (-0.054085 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.877906322479248
Epoch: 4, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.304 Vali Acc: 0.075 Test Loss: 3.304 Test Acc: 0.075
Validation loss decreased (-0.072908 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.935504674911499
Epoch: 5, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.266 Vali Acc: 0.105 Test Loss: 3.266 Test Acc: 0.105
Validation loss decreased (-0.075261 --> -0.104673).  Saving model ...
Epoch: 6 cost time: 0.8456149101257324
Epoch: 6, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.224 Vali Acc: 0.111 Test Loss: 3.224 Test Acc: 0.111
Validation loss decreased (-0.104673 --> -0.110556).  Saving model ...
Epoch: 7 cost time: 1.1772820949554443
Epoch: 7, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.181 Vali Acc: 0.135 Test Loss: 3.181 Test Acc: 0.135
Validation loss decreased (-0.110556 --> -0.135262).  Saving model ...
Epoch: 8 cost time: 0.6628072261810303
Epoch: 8, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.203 Vali Acc: 0.158 Test Loss: 3.203 Test Acc: 0.158
Validation loss decreased (-0.135262 --> -0.157615).  Saving model ...
Epoch: 9 cost time: 0.7794833183288574
Epoch: 9, Steps: 10 | Train Loss: 1.569 Vali Loss: 3.313 Vali Acc: 0.185 Test Loss: 3.313 Test Acc: 0.185
Validation loss decreased (-0.157615 --> -0.184673).  Saving model ...
Epoch: 10 cost time: 0.6340329647064209
Epoch: 10, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.380 Vali Acc: 0.191 Test Loss: 3.380 Test Acc: 0.191
Validation loss decreased (-0.184673 --> -0.190554).  Saving model ...
Epoch: 11 cost time: 1.206432580947876
Epoch: 11, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.515 Vali Acc: 0.228 Test Loss: 3.515 Test Acc: 0.228
Validation loss decreased (-0.190554 --> -0.228200).  Saving model ...
Epoch: 12 cost time: 0.7498114109039307
Epoch: 12, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.573 Vali Acc: 0.239 Test Loss: 3.573 Test Acc: 0.239
Validation loss decreased (-0.228200 --> -0.238788).  Saving model ...
Epoch: 13 cost time: 0.8251762390136719
Epoch: 13, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.698 Vali Acc: 0.252 Test Loss: 3.698 Test Acc: 0.252
Validation loss decreased (-0.238788 --> -0.251728).  Saving model ...
Epoch: 14 cost time: 0.7127175331115723
Epoch: 14, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.928 Vali Acc: 0.259 Test Loss: 3.928 Test Acc: 0.259
Validation loss decreased (-0.251728 --> -0.258784).  Saving model ...
Epoch: 15 cost time: 0.9638426303863525
Epoch: 15, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.976 Vali Acc: 0.266 Test Loss: 3.976 Test Acc: 0.266
Validation loss decreased (-0.258784 --> -0.265843).  Saving model ...
Epoch: 16 cost time: 0.6790647506713867
Epoch: 16, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.139 Vali Acc: 0.255 Test Loss: 4.139 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8152847290039062
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.229 Vali Acc: 0.274 Test Loss: 4.229 Test Acc: 0.274
Validation loss decreased (-0.265843 --> -0.274075).  Saving model ...
Epoch: 18 cost time: 0.663935661315918
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.311 Vali Acc: 0.279 Test Loss: 4.311 Test Acc: 0.279
Validation loss decreased (-0.274075 --> -0.278780).  Saving model ...
Epoch: 19 cost time: 0.7194581031799316
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.365 Vali Acc: 0.291 Test Loss: 4.365 Test Acc: 0.291
Validation loss decreased (-0.278780 --> -0.290545).  Saving model ...
Epoch: 20 cost time: 0.6513919830322266
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.408 Vali Acc: 0.288 Test Loss: 4.408 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5864744186401367
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.387 Vali Acc: 0.287 Test Loss: 4.387 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5835254192352295
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.420 Vali Acc: 0.286 Test Loss: 4.420 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6007311344146729
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.529 Vali Acc: 0.289 Test Loss: 4.529 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6310274600982666
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.555 Vali Acc: 0.288 Test Loss: 4.555 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5915231704711914
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.483 Vali Acc: 0.294 Test Loss: 4.483 Test Acc: 0.294
Validation loss decreased (-0.290545 --> -0.294073).  Saving model ...
Epoch: 26 cost time: 0.675562858581543
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.453 Vali Acc: 0.293 Test Loss: 4.453 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5865011215209961
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.534 Vali Acc: 0.302 Test Loss: 4.534 Test Acc: 0.302
Validation loss decreased (-0.294073 --> -0.302308).  Saving model ...
Epoch: 28 cost time: 0.599534273147583
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.591 Vali Acc: 0.294 Test Loss: 4.591 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6093571186065674
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.619 Vali Acc: 0.295 Test Loss: 4.619 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5431356430053711
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.672 Vali Acc: 0.299 Test Loss: 4.672 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6630730628967285
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.663 Vali Acc: 0.301 Test Loss: 4.663 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0686120986938477
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.610 Vali Acc: 0.299 Test Loss: 4.610 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7230033874511719
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.638 Vali Acc: 0.300 Test Loss: 4.638 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.568809986114502
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.667 Vali Acc: 0.296 Test Loss: 4.667 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6426372528076172
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.710 Vali Acc: 0.293 Test Loss: 4.710 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7730629444122314
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.751 Vali Acc: 0.295 Test Loss: 4.751 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6165580749511719
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.778 Vali Acc: 0.288 Test Loss: 4.778 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 29531162
model size : 127.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.035261631011963
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.335 Vali Acc: 0.039 Test Loss: 3.335 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.647564172744751
Epoch: 2, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.382 Vali Acc: 0.098 Test Loss: 3.382 Test Acc: 0.098
Validation loss decreased (-0.038790 --> -0.097613).  Saving model ...
Epoch: 3 cost time: 0.7416610717773438
Epoch: 3, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.313 Vali Acc: 0.106 Test Loss: 3.313 Test Acc: 0.106
Validation loss decreased (-0.097613 --> -0.105849).  Saving model ...
Epoch: 4 cost time: 0.9871430397033691
Epoch: 4, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.177 Vali Acc: 0.155 Test Loss: 3.177 Test Acc: 0.155
Validation loss decreased (-0.105849 --> -0.155262).  Saving model ...
Epoch: 5 cost time: 0.553473711013794
Epoch: 5, Steps: 10 | Train Loss: 2.376 Vali Loss: 3.173 Vali Acc: 0.189 Test Loss: 3.173 Test Acc: 0.189
Validation loss decreased (-0.155262 --> -0.189380).  Saving model ...
Epoch: 6 cost time: 0.671818733215332
Epoch: 6, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.201 Vali Acc: 0.218 Test Loss: 3.201 Test Acc: 0.218
Validation loss decreased (-0.189380 --> -0.217615).  Saving model ...
Epoch: 7 cost time: 0.6775534152984619
Epoch: 7, Steps: 10 | Train Loss: 1.331 Vali Loss: 3.433 Vali Acc: 0.222 Test Loss: 3.433 Test Acc: 0.222
Validation loss decreased (-0.217615 --> -0.222319).  Saving model ...
Epoch: 8 cost time: 0.7823977470397949
Epoch: 8, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.764 Vali Acc: 0.240 Test Loss: 3.764 Test Acc: 0.240
Validation loss decreased (-0.222319 --> -0.239962).  Saving model ...
Epoch: 9 cost time: 0.6218357086181641
Epoch: 9, Steps: 10 | Train Loss: 0.447 Vali Loss: 4.206 Vali Acc: 0.229 Test Loss: 4.206 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6753945350646973
Epoch: 10, Steps: 10 | Train Loss: 0.332 Vali Loss: 4.395 Vali Acc: 0.258 Test Loss: 4.395 Test Acc: 0.258
Validation loss decreased (-0.239962 --> -0.257603).  Saving model ...
Epoch: 11 cost time: 0.5401341915130615
Epoch: 11, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.954 Vali Acc: 0.255 Test Loss: 4.954 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5083630084991455
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 5.344 Vali Acc: 0.251 Test Loss: 5.344 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5869920253753662
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 5.326 Vali Acc: 0.291 Test Loss: 5.326 Test Acc: 0.291
Validation loss decreased (-0.257603 --> -0.290535).  Saving model ...
Epoch: 14 cost time: 1.188582181930542
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.528 Vali Acc: 0.279 Test Loss: 5.528 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2305922508239746
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.660 Vali Acc: 0.279 Test Loss: 5.660 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6704838275909424
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.696 Vali Acc: 0.301 Test Loss: 5.696 Test Acc: 0.301
Validation loss decreased (-0.290535 --> -0.301120).  Saving model ...
Epoch: 17 cost time: 0.6677677631378174
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.755 Vali Acc: 0.302 Test Loss: 5.755 Test Acc: 0.302
Validation loss decreased (-0.301120 --> -0.302295).  Saving model ...
Epoch: 18 cost time: 0.9071037769317627
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.899 Vali Acc: 0.288 Test Loss: 5.899 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.692023754119873
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.911 Vali Acc: 0.295 Test Loss: 5.911 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7219851016998291
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.076 Vali Acc: 0.292 Test Loss: 6.076 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6502504348754883
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.922 Vali Acc: 0.306 Test Loss: 5.922 Test Acc: 0.306
Validation loss decreased (-0.302295 --> -0.305823).  Saving model ...
Epoch: 22 cost time: 0.6309380531311035
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.983 Vali Acc: 0.304 Test Loss: 5.983 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7452576160430908
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.844 Vali Acc: 0.316 Test Loss: 5.844 Test Acc: 0.316
Validation loss decreased (-0.305823 --> -0.316412).  Saving model ...
Epoch: 24 cost time: 0.6655688285827637
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.821 Vali Acc: 0.319 Test Loss: 5.821 Test Acc: 0.319
Validation loss decreased (-0.316412 --> -0.318765).  Saving model ...
Epoch: 25 cost time: 0.9844460487365723
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.807 Vali Acc: 0.321 Test Loss: 5.807 Test Acc: 0.321
Validation loss decreased (-0.318765 --> -0.321118).  Saving model ...
Epoch: 26 cost time: 1.3161253929138184
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.834 Vali Acc: 0.316 Test Loss: 5.834 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.352083444595337
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.848 Vali Acc: 0.312 Test Loss: 5.848 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1387860774993896
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.859 Vali Acc: 0.314 Test Loss: 5.859 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1751055717468262
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.874 Vali Acc: 0.315 Test Loss: 5.874 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1641535758972168
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.871 Vali Acc: 0.318 Test Loss: 5.871 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.247389316558838
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.856 Vali Acc: 0.321 Test Loss: 5.856 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1358366012573242
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.843 Vali Acc: 0.321 Test Loss: 5.843 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1897294521331787
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.850 Vali Acc: 0.321 Test Loss: 5.850 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6688365936279297
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.889 Vali Acc: 0.321 Test Loss: 5.889 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9565129280090332
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.899 Vali Acc: 0.325 Test Loss: 5.899 Test Acc: 0.325
Validation loss decreased (-0.321118 --> -0.324647).  Saving model ...
Epoch: 36 cost time: 0.6398322582244873
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.903 Vali Acc: 0.325 Test Loss: 5.903 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8389277458190918
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.908 Vali Acc: 0.321 Test Loss: 5.908 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1080422401428223
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.911 Vali Acc: 0.320 Test Loss: 5.911 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9105746746063232
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.944 Vali Acc: 0.316 Test Loss: 5.944 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6708693504333496
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.319 Test Loss: 5.956 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6745548248291016
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.952 Vali Acc: 0.322 Test Loss: 5.952 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5736002922058105
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.951 Vali Acc: 0.319 Test Loss: 5.951 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0799062252044678
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.959 Vali Acc: 0.319 Test Loss: 5.959 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7422828674316406
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.971 Vali Acc: 0.318 Test Loss: 5.971 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6649577617645264
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.099 Vali Acc: 0.314 Test Loss: 6.099 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 30082586
model size : 129.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8653464317321777
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.337 Vali Acc: 0.044 Test Loss: 3.337 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.6288750171661377
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.367 Vali Acc: 0.061 Test Loss: 3.367 Test Acc: 0.061
Validation loss decreased (-0.043496 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.4689311981201172
Epoch: 3, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.332 Vali Acc: 0.087 Test Loss: 3.332 Test Acc: 0.087
Validation loss decreased (-0.061143 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 1.0486030578613281
Epoch: 4, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.269 Vali Acc: 0.109 Test Loss: 3.269 Test Acc: 0.109
Validation loss decreased (-0.087026 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 0.5737106800079346
Epoch: 5, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.233 Vali Acc: 0.125 Test Loss: 3.233 Test Acc: 0.125
Validation loss decreased (-0.109379 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 0.7758340835571289
Epoch: 6, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.182 Vali Acc: 0.153 Test Loss: 3.182 Test Acc: 0.153
Validation loss decreased (-0.124674 --> -0.152909).  Saving model ...
Epoch: 7 cost time: 0.5182735919952393
Epoch: 7, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.168 Vali Acc: 0.171 Test Loss: 3.168 Test Acc: 0.171
Validation loss decreased (-0.152909 --> -0.170557).  Saving model ...
Epoch: 8 cost time: 0.95208740234375
Epoch: 8, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.317 Vali Acc: 0.214 Test Loss: 3.317 Test Acc: 0.214
Validation loss decreased (-0.170557 --> -0.214084).  Saving model ...
Epoch: 9 cost time: 0.6230194568634033
Epoch: 9, Steps: 10 | Train Loss: 1.211 Vali Loss: 3.477 Vali Acc: 0.246 Test Loss: 3.477 Test Acc: 0.246
Validation loss decreased (-0.214084 --> -0.245848).  Saving model ...
Epoch: 10 cost time: 0.8660743236541748
Epoch: 10, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.758 Vali Acc: 0.256 Test Loss: 3.758 Test Acc: 0.256
Validation loss decreased (-0.245848 --> -0.256433).  Saving model ...
Epoch: 11 cost time: 1.0658268928527832
Epoch: 11, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.882 Vali Acc: 0.262 Test Loss: 3.882 Test Acc: 0.262
Validation loss decreased (-0.256433 --> -0.262314).  Saving model ...
Epoch: 12 cost time: 1.1168568134307861
Epoch: 12, Steps: 10 | Train Loss: 0.303 Vali Loss: 4.263 Vali Acc: 0.273 Test Loss: 4.263 Test Acc: 0.273
Validation loss decreased (-0.262314 --> -0.272899).  Saving model ...
Epoch: 13 cost time: 0.5105795860290527
Epoch: 13, Steps: 10 | Train Loss: 0.179 Vali Loss: 4.204 Vali Acc: 0.299 Test Loss: 4.204 Test Acc: 0.299
Validation loss decreased (-0.272899 --> -0.298781).  Saving model ...
Epoch: 14 cost time: 0.6771278381347656
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.333 Vali Acc: 0.291 Test Loss: 4.333 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5695614814758301
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.544 Vali Acc: 0.278 Test Loss: 4.544 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5916438102722168
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.792 Vali Acc: 0.289 Test Loss: 4.792 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5490429401397705
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.846 Vali Acc: 0.294 Test Loss: 4.846 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8132567405700684
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.813 Vali Acc: 0.311 Test Loss: 4.813 Test Acc: 0.311
Validation loss decreased (-0.298781 --> -0.310540).  Saving model ...
Epoch: 19 cost time: 0.4679129123687744
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.843 Vali Acc: 0.316 Test Loss: 4.843 Test Acc: 0.316
Validation loss decreased (-0.310540 --> -0.316422).  Saving model ...
Epoch: 20 cost time: 0.9369666576385498
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.942 Vali Acc: 0.301 Test Loss: 4.942 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5554413795471191
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.877 Vali Acc: 0.309 Test Loss: 4.877 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5845625400543213
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.885 Vali Acc: 0.309 Test Loss: 4.885 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5433266162872314
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.938 Vali Acc: 0.302 Test Loss: 4.938 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.095177173614502
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.930 Vali Acc: 0.311 Test Loss: 4.930 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7024343013763428
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.950 Vali Acc: 0.309 Test Loss: 4.950 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8203940391540527
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.016 Vali Acc: 0.307 Test Loss: 5.016 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7345538139343262
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.045 Vali Acc: 0.313 Test Loss: 5.045 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7813303470611572
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.051 Vali Acc: 0.315 Test Loss: 5.051 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8434441089630127
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.049 Vali Acc: 0.311 Test Loss: 5.049 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 29717018
model size : 128.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.12455153465271
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.393 Vali Acc: 0.046 Test Loss: 3.393 Test Acc: 0.046
Validation loss decreased (inf --> -0.045848).  Saving model ...
Epoch: 2 cost time: 0.7227253913879395
Epoch: 2, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.332 Vali Acc: 0.044 Test Loss: 3.332 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5193853378295898
Epoch: 3, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.303 Vali Acc: 0.058 Test Loss: 3.303 Test Acc: 0.058
Validation loss decreased (-0.045848 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.5862350463867188
Epoch: 4, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.285 Vali Acc: 0.065 Test Loss: 3.285 Test Acc: 0.065
Validation loss decreased (-0.057614 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.5271809101104736
Epoch: 5, Steps: 10 | Train Loss: 2.872 Vali Loss: 3.271 Vali Acc: 0.091 Test Loss: 3.271 Test Acc: 0.091
Validation loss decreased (-0.064673 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 0.6076719760894775
Epoch: 6, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.251 Vali Acc: 0.121 Test Loss: 3.251 Test Acc: 0.121
Validation loss decreased (-0.090556 --> -0.121144).  Saving model ...
Epoch: 7 cost time: 0.5523388385772705
Epoch: 7, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.188 Vali Acc: 0.134 Test Loss: 3.188 Test Acc: 0.134
Validation loss decreased (-0.121144 --> -0.134086).  Saving model ...
Epoch: 8 cost time: 0.698758602142334
Epoch: 8, Steps: 10 | Train Loss: 2.188 Vali Loss: 3.172 Vali Acc: 0.166 Test Loss: 3.172 Test Acc: 0.166
Validation loss decreased (-0.134086 --> -0.165851).  Saving model ...
Epoch: 9 cost time: 0.5704214572906494
Epoch: 9, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.280 Vali Acc: 0.168 Test Loss: 3.280 Test Acc: 0.168
Validation loss decreased (-0.165851 --> -0.168202).  Saving model ...
Epoch: 10 cost time: 0.5747129917144775
Epoch: 10, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.376 Vali Acc: 0.185 Test Loss: 3.376 Test Acc: 0.185
Validation loss decreased (-0.168202 --> -0.184672).  Saving model ...
Epoch: 11 cost time: 0.5169923305511475
Epoch: 11, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.441 Vali Acc: 0.205 Test Loss: 3.441 Test Acc: 0.205
Validation loss decreased (-0.184672 --> -0.204671).  Saving model ...
Epoch: 12 cost time: 0.6254708766937256
Epoch: 12, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.562 Vali Acc: 0.225 Test Loss: 3.562 Test Acc: 0.225
Validation loss decreased (-0.204671 --> -0.224670).  Saving model ...
Epoch: 13 cost time: 0.6733393669128418
Epoch: 13, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.640 Vali Acc: 0.242 Test Loss: 3.640 Test Acc: 0.242
Validation loss decreased (-0.224670 --> -0.242317).  Saving model ...
Epoch: 14 cost time: 0.5797781944274902
Epoch: 14, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.745 Vali Acc: 0.260 Test Loss: 3.745 Test Acc: 0.260
Validation loss decreased (-0.242317 --> -0.259963).  Saving model ...
Epoch: 15 cost time: 0.5809004306793213
Epoch: 15, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.878 Vali Acc: 0.260 Test Loss: 3.878 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.516638994216919
Epoch: 16, Steps: 10 | Train Loss: 0.164 Vali Loss: 4.012 Vali Acc: 0.262 Test Loss: 4.012 Test Acc: 0.262
Validation loss decreased (-0.259963 --> -0.262313).  Saving model ...
Epoch: 17 cost time: 0.5503911972045898
Epoch: 17, Steps: 10 | Train Loss: 0.136 Vali Loss: 4.040 Vali Acc: 0.272 Test Loss: 4.040 Test Acc: 0.272
Validation loss decreased (-0.262313 --> -0.271724).  Saving model ...
Epoch: 18 cost time: 0.7041401863098145
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.258 Vali Acc: 0.267 Test Loss: 4.258 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5107250213623047
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.208 Vali Acc: 0.284 Test Loss: 4.208 Test Acc: 0.284
Validation loss decreased (-0.271724 --> -0.283487).  Saving model ...
Epoch: 20 cost time: 0.5899972915649414
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.295 Vali Acc: 0.276 Test Loss: 4.295 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5334193706512451
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.333 Vali Acc: 0.273 Test Loss: 4.333 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5066962242126465
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.399 Vali Acc: 0.273 Test Loss: 4.399 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7040896415710449
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.375 Vali Acc: 0.282 Test Loss: 4.375 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6752619743347168
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.426 Vali Acc: 0.286 Test Loss: 4.426 Test Acc: 0.286
Validation loss decreased (-0.283487 --> -0.285838).  Saving model ...
Epoch: 25 cost time: 0.5074329376220703
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.500 Vali Acc: 0.284 Test Loss: 4.500 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5415306091308594
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.534 Vali Acc: 0.284 Test Loss: 4.534 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5378162860870361
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.495 Vali Acc: 0.280 Test Loss: 4.495 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5572855472564697
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.519 Vali Acc: 0.289 Test Loss: 4.519 Test Acc: 0.289
Validation loss decreased (-0.285838 --> -0.289367).  Saving model ...
Epoch: 29 cost time: 0.9345738887786865
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.610 Vali Acc: 0.278 Test Loss: 4.610 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5440554618835449
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.611 Vali Acc: 0.274 Test Loss: 4.611 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5563399791717529
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.617 Vali Acc: 0.288 Test Loss: 4.617 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6025700569152832
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.640 Vali Acc: 0.285 Test Loss: 4.640 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5587892532348633
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.623 Vali Acc: 0.298 Test Loss: 4.623 Test Acc: 0.298
Validation loss decreased (-0.289367 --> -0.297601).  Saving model ...
Epoch: 34 cost time: 0.5319929122924805
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.609 Vali Acc: 0.295 Test Loss: 4.609 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4875197410583496
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.633 Vali Acc: 0.294 Test Loss: 4.633 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5670030117034912
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.654 Vali Acc: 0.293 Test Loss: 4.654 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7928886413574219
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.676 Vali Acc: 0.293 Test Loss: 4.676 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6620681285858154
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.682 Vali Acc: 0.292 Test Loss: 4.682 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8424508571624756
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.700 Vali Acc: 0.295 Test Loss: 4.700 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.611821174621582
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.723 Vali Acc: 0.293 Test Loss: 4.723 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.715949535369873
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.762 Vali Acc: 0.287 Test Loss: 4.762 Test Acc: 0.287
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7427358627319336
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.785 Vali Acc: 0.289 Test Loss: 4.785 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7353065013885498
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.784 Vali Acc: 0.291 Test Loss: 4.784 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 29523482
model size : 127.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3333988189697266
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.296 Vali Acc: 0.045 Test Loss: 3.296 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.636432409286499
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.402 Vali Acc: 0.078 Test Loss: 3.402 Test Acc: 0.078
Validation loss decreased (-0.044673 --> -0.077613).  Saving model ...
Epoch: 3 cost time: 0.5403714179992676
Epoch: 3, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.318 Vali Acc: 0.071 Test Loss: 3.318 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7021627426147461
Epoch: 4, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.233 Vali Acc: 0.114 Test Loss: 3.233 Test Acc: 0.114
Validation loss decreased (-0.077613 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.7982299327850342
Epoch: 5, Steps: 10 | Train Loss: 2.403 Vali Loss: 3.169 Vali Acc: 0.138 Test Loss: 3.169 Test Acc: 0.138
Validation loss decreased (-0.114085 --> -0.137615).  Saving model ...
Epoch: 6 cost time: 0.7187168598175049
Epoch: 6, Steps: 10 | Train Loss: 1.985 Vali Loss: 3.250 Vali Acc: 0.200 Test Loss: 3.250 Test Acc: 0.200
Validation loss decreased (-0.137615 --> -0.199968).  Saving model ...
Epoch: 7 cost time: 0.5345063209533691
Epoch: 7, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.514 Vali Acc: 0.191 Test Loss: 3.514 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5441880226135254
Epoch: 8, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.646 Vali Acc: 0.232 Test Loss: 3.646 Test Acc: 0.232
Validation loss decreased (-0.199968 --> -0.231728).  Saving model ...
Epoch: 9 cost time: 0.6259341239929199
Epoch: 9, Steps: 10 | Train Loss: 0.511 Vali Loss: 4.015 Vali Acc: 0.229 Test Loss: 4.015 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6051316261291504
Epoch: 10, Steps: 10 | Train Loss: 0.302 Vali Loss: 4.140 Vali Acc: 0.274 Test Loss: 4.140 Test Acc: 0.274
Validation loss decreased (-0.231728 --> -0.274076).  Saving model ...
Epoch: 11 cost time: 0.622614860534668
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.412 Vali Acc: 0.280 Test Loss: 4.412 Test Acc: 0.280
Validation loss decreased (-0.274076 --> -0.279956).  Saving model ...
Epoch: 12 cost time: 0.7375669479370117
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.597 Vali Acc: 0.281 Test Loss: 4.597 Test Acc: 0.281
Validation loss decreased (-0.279956 --> -0.281131).  Saving model ...
Epoch: 13 cost time: 0.6509096622467041
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.910 Vali Acc: 0.295 Test Loss: 4.910 Test Acc: 0.295
Validation loss decreased (-0.281131 --> -0.295245).  Saving model ...
Epoch: 14 cost time: 0.8117892742156982
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.966 Vali Acc: 0.291 Test Loss: 4.966 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8102924823760986
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.228 Vali Acc: 0.278 Test Loss: 5.228 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2974917888641357
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.093 Vali Acc: 0.295 Test Loss: 5.093 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4498708248138428
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.212 Vali Acc: 0.293 Test Loss: 5.212 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3882882595062256
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.187 Vali Acc: 0.291 Test Loss: 5.187 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0012505054473877
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.624 Vali Acc: 0.279 Test Loss: 5.624 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8898031711578369
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.059 Vali Acc: 0.318 Test Loss: 5.059 Test Acc: 0.318
Validation loss decreased (-0.295245 --> -0.317596).  Saving model ...
Epoch: 21 cost time: 0.7412295341491699
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.110 Vali Acc: 0.309 Test Loss: 5.110 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7037787437438965
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.335 Vali Acc: 0.295 Test Loss: 5.335 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8425743579864502
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.399 Vali Acc: 0.293 Test Loss: 5.399 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7798919677734375
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.531 Vali Acc: 0.289 Test Loss: 5.531 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6818962097167969
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.439 Vali Acc: 0.295 Test Loss: 5.439 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6304185390472412
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.357 Vali Acc: 0.282 Test Loss: 5.357 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2451632022857666
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.527 Vali Acc: 0.284 Test Loss: 5.527 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9045000076293945
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.733 Vali Acc: 0.271 Test Loss: 5.733 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.241098165512085
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.689 Vali Acc: 0.279 Test Loss: 5.689 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2480275630950928
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.615 Vali Acc: 0.294 Test Loss: 5.615 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 29938970
model size : 128.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.128784656524658
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.320 Vali Acc: 0.034 Test Loss: 3.320 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.5035884380340576
Epoch: 2, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.344 Vali Acc: 0.053 Test Loss: 3.344 Test Acc: 0.053
Validation loss decreased (-0.034084 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.5530858039855957
Epoch: 3, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.342 Vali Acc: 0.087 Test Loss: 3.342 Test Acc: 0.087
Validation loss decreased (-0.052908 --> -0.087025).  Saving model ...
Epoch: 4 cost time: 0.577601432800293
Epoch: 4, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.266 Vali Acc: 0.084 Test Loss: 3.266 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7225444316864014
Epoch: 5, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.251 Vali Acc: 0.112 Test Loss: 3.251 Test Acc: 0.112
Validation loss decreased (-0.087025 --> -0.111732).  Saving model ...
Epoch: 6 cost time: 0.5696446895599365
Epoch: 6, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.171 Vali Acc: 0.149 Test Loss: 3.171 Test Acc: 0.149
Validation loss decreased (-0.111732 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 0.7290709018707275
Epoch: 7, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.214 Vali Acc: 0.165 Test Loss: 3.214 Test Acc: 0.165
Validation loss decreased (-0.149380 --> -0.164674).  Saving model ...
Epoch: 8 cost time: 0.6264269351959229
Epoch: 8, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.235 Vali Acc: 0.209 Test Loss: 3.235 Test Acc: 0.209
Validation loss decreased (-0.164674 --> -0.209379).  Saving model ...
Epoch: 9 cost time: 0.6142435073852539
Epoch: 9, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.482 Vali Acc: 0.215 Test Loss: 3.482 Test Acc: 0.215
Validation loss decreased (-0.209379 --> -0.215259).  Saving model ...
Epoch: 10 cost time: 0.6171877384185791
Epoch: 10, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.637 Vali Acc: 0.245 Test Loss: 3.637 Test Acc: 0.245
Validation loss decreased (-0.215259 --> -0.244670).  Saving model ...
Epoch: 11 cost time: 0.5766394138336182
Epoch: 11, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.820 Vali Acc: 0.244 Test Loss: 3.820 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47205400466918945
Epoch: 12, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.998 Vali Acc: 0.259 Test Loss: 3.998 Test Acc: 0.259
Validation loss decreased (-0.244670 --> -0.258784).  Saving model ...
Epoch: 13 cost time: 1.467653512954712
Epoch: 13, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.216 Vali Acc: 0.266 Test Loss: 4.216 Test Acc: 0.266
Validation loss decreased (-0.258784 --> -0.265840).  Saving model ...
Epoch: 14 cost time: 0.6560924053192139
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.354 Vali Acc: 0.267 Test Loss: 4.354 Test Acc: 0.267
Validation loss decreased (-0.265840 --> -0.267015).  Saving model ...
Epoch: 15 cost time: 0.5106010437011719
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.370 Vali Acc: 0.275 Test Loss: 4.370 Test Acc: 0.275
Validation loss decreased (-0.267015 --> -0.275250).  Saving model ...
Epoch: 16 cost time: 0.484727144241333
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.697 Vali Acc: 0.267 Test Loss: 4.697 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5786821842193604
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.668 Vali Acc: 0.284 Test Loss: 4.668 Test Acc: 0.284
Validation loss decreased (-0.275250 --> -0.283483).  Saving model ...
Epoch: 18 cost time: 0.7002182006835938
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.706 Vali Acc: 0.295 Test Loss: 4.706 Test Acc: 0.295
Validation loss decreased (-0.283483 --> -0.295247).  Saving model ...
Epoch: 19 cost time: 0.9323134422302246
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.780 Vali Acc: 0.284 Test Loss: 4.780 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6450843811035156
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.818 Vali Acc: 0.292 Test Loss: 4.818 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.262040615081787
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.793 Vali Acc: 0.295 Test Loss: 4.793 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6971688270568848
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.797 Vali Acc: 0.296 Test Loss: 4.797 Test Acc: 0.296
Validation loss decreased (-0.295247 --> -0.296423).  Saving model ...
Epoch: 23 cost time: 1.4668946266174316
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.818 Vali Acc: 0.299 Test Loss: 4.818 Test Acc: 0.299
Validation loss decreased (-0.296423 --> -0.298775).  Saving model ...
Epoch: 24 cost time: 0.6215829849243164
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.811 Vali Acc: 0.296 Test Loss: 4.811 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5870420932769775
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.816 Vali Acc: 0.304 Test Loss: 4.816 Test Acc: 0.304
Validation loss decreased (-0.298775 --> -0.303481).  Saving model ...
Epoch: 26 cost time: 0.7313582897186279
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.854 Vali Acc: 0.307 Test Loss: 4.854 Test Acc: 0.307
Validation loss decreased (-0.303481 --> -0.307010).  Saving model ...
Epoch: 27 cost time: 0.6203329563140869
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.916 Vali Acc: 0.305 Test Loss: 4.916 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5900166034698486
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.869 Vali Acc: 0.302 Test Loss: 4.869 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.45075273513793945
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.909 Vali Acc: 0.296 Test Loss: 4.909 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6457784175872803
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.956 Vali Acc: 0.296 Test Loss: 4.956 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.280442714691162
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.949 Vali Acc: 0.301 Test Loss: 4.949 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9206023216247559
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.939 Vali Acc: 0.302 Test Loss: 4.939 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8530259132385254
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.930 Vali Acc: 0.305 Test Loss: 4.930 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7461607456207275
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.939 Vali Acc: 0.307 Test Loss: 4.939 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6016144752502441
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.969 Vali Acc: 0.306 Test Loss: 4.969 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9497480392456055
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.981 Vali Acc: 0.302 Test Loss: 4.981 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 29680922
model size : 127.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0477137565612793
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.375 Vali Acc: 0.028 Test Loss: 3.375 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.8044075965881348
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.353 Vali Acc: 0.042 Test Loss: 3.353 Test Acc: 0.042
Validation loss decreased (-0.028202 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 0.7157294750213623
Epoch: 3, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.371 Vali Acc: 0.059 Test Loss: 3.371 Test Acc: 0.059
Validation loss decreased (-0.042319 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 0.5882887840270996
Epoch: 4, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.331 Vali Acc: 0.072 Test Loss: 3.331 Test Acc: 0.072
Validation loss decreased (-0.058790 --> -0.071731).  Saving model ...
Epoch: 5 cost time: 0.5591893196105957
Epoch: 5, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.283 Vali Acc: 0.084 Test Loss: 3.283 Test Acc: 0.084
Validation loss decreased (-0.071731 --> -0.083497).  Saving model ...
Epoch: 6 cost time: 0.5777864456176758
Epoch: 6, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.269 Vali Acc: 0.106 Test Loss: 3.269 Test Acc: 0.106
Validation loss decreased (-0.083497 --> -0.105850).  Saving model ...
Epoch: 7 cost time: 0.669234037399292
Epoch: 7, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.229 Vali Acc: 0.112 Test Loss: 3.229 Test Acc: 0.112
Validation loss decreased (-0.105850 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.7234954833984375
Epoch: 8, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.243 Vali Acc: 0.131 Test Loss: 3.243 Test Acc: 0.131
Validation loss decreased (-0.111732 --> -0.130556).  Saving model ...
Epoch: 9 cost time: 0.7743403911590576
Epoch: 9, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.240 Vali Acc: 0.158 Test Loss: 3.240 Test Acc: 0.158
Validation loss decreased (-0.130556 --> -0.157615).  Saving model ...
Epoch: 10 cost time: 0.8618714809417725
Epoch: 10, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.353 Vali Acc: 0.188 Test Loss: 3.353 Test Acc: 0.188
Validation loss decreased (-0.157615 --> -0.188202).  Saving model ...
Epoch: 11 cost time: 0.7506380081176758
Epoch: 11, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.436 Vali Acc: 0.213 Test Loss: 3.436 Test Acc: 0.213
Validation loss decreased (-0.188202 --> -0.212907).  Saving model ...
Epoch: 12 cost time: 0.5825116634368896
Epoch: 12, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.585 Vali Acc: 0.239 Test Loss: 3.585 Test Acc: 0.239
Validation loss decreased (-0.212907 --> -0.238788).  Saving model ...
Epoch: 13 cost time: 0.5384745597839355
Epoch: 13, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.699 Vali Acc: 0.232 Test Loss: 3.699 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6261165142059326
Epoch: 14, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.796 Vali Acc: 0.241 Test Loss: 3.796 Test Acc: 0.241
Validation loss decreased (-0.238788 --> -0.241139).  Saving model ...
Epoch: 15 cost time: 0.6693706512451172
Epoch: 15, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.850 Vali Acc: 0.260 Test Loss: 3.850 Test Acc: 0.260
Validation loss decreased (-0.241139 --> -0.259961).  Saving model ...
Epoch: 16 cost time: 0.6149556636810303
Epoch: 16, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.999 Vali Acc: 0.265 Test Loss: 3.999 Test Acc: 0.265
Validation loss decreased (-0.259961 --> -0.264666).  Saving model ...
Epoch: 17 cost time: 0.6829962730407715
Epoch: 17, Steps: 10 | Train Loss: 0.170 Vali Loss: 4.156 Vali Acc: 0.268 Test Loss: 4.156 Test Acc: 0.268
Validation loss decreased (-0.264666 --> -0.268194).  Saving model ...
Epoch: 18 cost time: 0.5641674995422363
Epoch: 18, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.122 Vali Acc: 0.280 Test Loss: 4.122 Test Acc: 0.280
Validation loss decreased (-0.268194 --> -0.279959).  Saving model ...
Epoch: 19 cost time: 0.6739814281463623
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.205 Vali Acc: 0.285 Test Loss: 4.205 Test Acc: 0.285
Validation loss decreased (-0.279959 --> -0.284664).  Saving model ...
Epoch: 20 cost time: 0.5953381061553955
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.361 Vali Acc: 0.279 Test Loss: 4.361 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7183365821838379
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.346 Vali Acc: 0.276 Test Loss: 4.346 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5416936874389648
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.413 Vali Acc: 0.267 Test Loss: 4.413 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5881845951080322
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.476 Vali Acc: 0.276 Test Loss: 4.476 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6108121871948242
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.501 Vali Acc: 0.280 Test Loss: 4.501 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7447504997253418
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.511 Vali Acc: 0.292 Test Loss: 4.511 Test Acc: 0.292
Validation loss decreased (-0.284664 --> -0.291720).  Saving model ...
Epoch: 26 cost time: 0.62557053565979
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.565 Vali Acc: 0.288 Test Loss: 4.565 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6125118732452393
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.578 Vali Acc: 0.288 Test Loss: 4.578 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6584289073944092
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.603 Vali Acc: 0.282 Test Loss: 4.603 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6172060966491699
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.676 Vali Acc: 0.289 Test Loss: 4.676 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6610431671142578
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.597 Vali Acc: 0.292 Test Loss: 4.597 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7989962100982666
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.611 Vali Acc: 0.289 Test Loss: 4.611 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6529316902160645
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.661 Vali Acc: 0.288 Test Loss: 4.661 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.720083475112915
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.708 Vali Acc: 0.284 Test Loss: 4.708 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8579056262969971
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.758 Vali Acc: 0.285 Test Loss: 4.758 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6447489261627197
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.765 Vali Acc: 0.285 Test Loss: 4.765 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2917647058823529
model parameter : 29508890
model size : 127.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1748054027557373
Epoch: 1, Steps: 10 | Train Loss: 3.438 Vali Loss: 3.340 Vali Acc: 0.046 Test Loss: 3.340 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.6354482173919678
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.340 Vali Acc: 0.065 Test Loss: 3.340 Test Acc: 0.065
Validation loss decreased (-0.045849 --> -0.064672).  Saving model ...
Epoch: 3 cost time: 0.9057760238647461
Epoch: 3, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.319 Vali Acc: 0.088 Test Loss: 3.319 Test Acc: 0.088
Validation loss decreased (-0.064672 --> -0.088202).  Saving model ...
Epoch: 4 cost time: 0.8373861312866211
Epoch: 4, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.238 Vali Acc: 0.108 Test Loss: 3.238 Test Acc: 0.108
Validation loss decreased (-0.088202 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 1.0909335613250732
Epoch: 5, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.149 Vali Acc: 0.145 Test Loss: 3.149 Test Acc: 0.145
Validation loss decreased (-0.108203 --> -0.144674).  Saving model ...
Epoch: 6 cost time: 0.66202712059021
Epoch: 6, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.203 Vali Acc: 0.166 Test Loss: 3.203 Test Acc: 0.166
Validation loss decreased (-0.144674 --> -0.165850).  Saving model ...
Epoch: 7 cost time: 0.846433162689209
Epoch: 7, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.279 Vali Acc: 0.212 Test Loss: 3.279 Test Acc: 0.212
Validation loss decreased (-0.165850 --> -0.211732).  Saving model ...
Epoch: 8 cost time: 0.7711658477783203
Epoch: 8, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.687 Vali Acc: 0.236 Test Loss: 3.687 Test Acc: 0.236
Validation loss decreased (-0.211732 --> -0.236434).  Saving model ...
Epoch: 9 cost time: 0.6878032684326172
Epoch: 9, Steps: 10 | Train Loss: 0.653 Vali Loss: 4.033 Vali Acc: 0.266 Test Loss: 4.033 Test Acc: 0.266
Validation loss decreased (-0.236434 --> -0.265842).  Saving model ...
Epoch: 10 cost time: 0.8960709571838379
Epoch: 10, Steps: 10 | Train Loss: 0.432 Vali Loss: 4.310 Vali Acc: 0.248 Test Loss: 4.310 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2378597259521484
Epoch: 11, Steps: 10 | Train Loss: 0.238 Vali Loss: 4.643 Vali Acc: 0.266 Test Loss: 4.643 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9311864376068115
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.911 Vali Acc: 0.251 Test Loss: 4.911 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8114700317382812
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 5.052 Vali Acc: 0.293 Test Loss: 5.052 Test Acc: 0.293
Validation loss decreased (-0.265842 --> -0.292891).  Saving model ...
Epoch: 14 cost time: 0.7052373886108398
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 5.407 Vali Acc: 0.271 Test Loss: 5.407 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1310086250305176
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.203 Vali Acc: 0.306 Test Loss: 5.203 Test Acc: 0.306
Validation loss decreased (-0.292891 --> -0.305830).  Saving model ...
Epoch: 16 cost time: 0.7032639980316162
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.323 Vali Acc: 0.292 Test Loss: 5.323 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6459803581237793
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.306 Vali Acc: 0.301 Test Loss: 5.306 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7431468963623047
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.438 Vali Acc: 0.294 Test Loss: 5.438 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6606018543243408
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.446 Vali Acc: 0.299 Test Loss: 5.446 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7034504413604736
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.421 Vali Acc: 0.308 Test Loss: 5.421 Test Acc: 0.308
Validation loss decreased (-0.305830 --> -0.308181).  Saving model ...
Epoch: 21 cost time: 0.6652052402496338
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.483 Vali Acc: 0.308 Test Loss: 5.483 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6522536277770996
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.480 Vali Acc: 0.315 Test Loss: 5.480 Test Acc: 0.315
Validation loss decreased (-0.308181 --> -0.315239).  Saving model ...
Epoch: 23 cost time: 0.6825120449066162
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.520 Vali Acc: 0.316 Test Loss: 5.520 Test Acc: 0.316
Validation loss decreased (-0.315239 --> -0.316415).  Saving model ...
Epoch: 24 cost time: 0.6612117290496826
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.552 Vali Acc: 0.320 Test Loss: 5.552 Test Acc: 0.320
Validation loss decreased (-0.316415 --> -0.319944).  Saving model ...
Epoch: 25 cost time: 0.9219343662261963
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.512 Vali Acc: 0.322 Test Loss: 5.512 Test Acc: 0.322
Validation loss decreased (-0.319944 --> -0.322298).  Saving model ...
Epoch: 26 cost time: 0.883455753326416
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.522 Vali Acc: 0.315 Test Loss: 5.522 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6889047622680664
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.543 Vali Acc: 0.308 Test Loss: 5.543 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6981542110443115
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.565 Vali Acc: 0.307 Test Loss: 5.565 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8379404544830322
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.555 Vali Acc: 0.313 Test Loss: 5.555 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5426137447357178
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.547 Vali Acc: 0.320 Test Loss: 5.547 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.749565601348877
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.552 Vali Acc: 0.316 Test Loss: 5.552 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7468020915985107
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.575 Vali Acc: 0.316 Test Loss: 5.575 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6954305171966553
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.602 Vali Acc: 0.314 Test Loss: 5.602 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7048249244689941
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.614 Vali Acc: 0.314 Test Loss: 5.614 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5434856414794922
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.615 Vali Acc: 0.315 Test Loss: 5.615 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 29931290
model size : 128.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.019869089126587
Epoch: 1, Steps: 10 | Train Loss: 3.425 Vali Loss: 3.321 Vali Acc: 0.039 Test Loss: 3.321 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5339858531951904
Epoch: 2, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.322 Vali Acc: 0.058 Test Loss: 3.322 Test Acc: 0.058
Validation loss decreased (-0.038790 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.4703090190887451
Epoch: 3, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.354 Vali Acc: 0.053 Test Loss: 3.354 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6207907199859619
Epoch: 4, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.320 Vali Acc: 0.092 Test Loss: 3.320 Test Acc: 0.092
Validation loss decreased (-0.057614 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 0.776191234588623
Epoch: 5, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.236 Vali Acc: 0.115 Test Loss: 3.236 Test Acc: 0.115
Validation loss decreased (-0.091732 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 0.5510518550872803
Epoch: 6, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.200 Vali Acc: 0.129 Test Loss: 3.200 Test Acc: 0.129
Validation loss decreased (-0.115262 --> -0.129380).  Saving model ...
Epoch: 7 cost time: 0.4906730651855469
Epoch: 7, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.203 Vali Acc: 0.152 Test Loss: 3.203 Test Acc: 0.152
Validation loss decreased (-0.129380 --> -0.151733).  Saving model ...
Epoch: 8 cost time: 0.7267987728118896
Epoch: 8, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.203 Vali Acc: 0.189 Test Loss: 3.203 Test Acc: 0.189
Validation loss decreased (-0.151733 --> -0.189380).  Saving model ...
Epoch: 9 cost time: 0.5065758228302002
Epoch: 9, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.446 Vali Acc: 0.211 Test Loss: 3.446 Test Acc: 0.211
Validation loss decreased (-0.189380 --> -0.210554).  Saving model ...
Epoch: 10 cost time: 0.5688762664794922
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.563 Vali Acc: 0.232 Test Loss: 3.563 Test Acc: 0.232
Validation loss decreased (-0.210554 --> -0.231729).  Saving model ...
Epoch: 11 cost time: 0.7123005390167236
Epoch: 11, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.875 Vali Acc: 0.233 Test Loss: 3.875 Test Acc: 0.233
Validation loss decreased (-0.231729 --> -0.232902).  Saving model ...
Epoch: 12 cost time: 0.6688897609710693
Epoch: 12, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.974 Vali Acc: 0.245 Test Loss: 3.974 Test Acc: 0.245
Validation loss decreased (-0.232902 --> -0.244666).  Saving model ...
Epoch: 13 cost time: 0.5981779098510742
Epoch: 13, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.016 Vali Acc: 0.274 Test Loss: 4.016 Test Acc: 0.274
Validation loss decreased (-0.244666 --> -0.274077).  Saving model ...
Epoch: 14 cost time: 0.5274343490600586
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.321 Vali Acc: 0.281 Test Loss: 4.321 Test Acc: 0.281
Validation loss decreased (-0.274077 --> -0.281133).  Saving model ...
Epoch: 15 cost time: 0.5219466686248779
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.317 Vali Acc: 0.278 Test Loss: 4.317 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5393457412719727
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.605 Vali Acc: 0.273 Test Loss: 4.605 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5758686065673828
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.527 Vali Acc: 0.284 Test Loss: 4.527 Test Acc: 0.284
Validation loss decreased (-0.281133 --> -0.283484).  Saving model ...
Epoch: 18 cost time: 0.5573091506958008
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.744 Vali Acc: 0.279 Test Loss: 4.744 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.49869418144226074
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.772 Vali Acc: 0.286 Test Loss: 4.772 Test Acc: 0.286
Validation loss decreased (-0.283484 --> -0.285835).  Saving model ...
Epoch: 20 cost time: 0.6836304664611816
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.646 Vali Acc: 0.301 Test Loss: 4.646 Test Acc: 0.301
Validation loss decreased (-0.285835 --> -0.301130).  Saving model ...
Epoch: 21 cost time: 0.48720407485961914
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.699 Vali Acc: 0.296 Test Loss: 4.699 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5001580715179443
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.769 Vali Acc: 0.295 Test Loss: 4.769 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5309927463531494
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.778 Vali Acc: 0.294 Test Loss: 4.778 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.591454029083252
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.805 Vali Acc: 0.305 Test Loss: 4.805 Test Acc: 0.305
Validation loss decreased (-0.301130 --> -0.304658).  Saving model ...
Epoch: 25 cost time: 0.6700305938720703
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.835 Vali Acc: 0.304 Test Loss: 4.835 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.54410719871521
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.810 Vali Acc: 0.305 Test Loss: 4.810 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6657423973083496
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.813 Vali Acc: 0.308 Test Loss: 4.813 Test Acc: 0.308
Validation loss decreased (-0.304658 --> -0.308187).  Saving model ...
Epoch: 28 cost time: 0.639927864074707
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.856 Vali Acc: 0.312 Test Loss: 4.856 Test Acc: 0.312
Validation loss decreased (-0.308187 --> -0.311716).  Saving model ...
Epoch: 29 cost time: 0.6669065952301025
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.879 Vali Acc: 0.314 Test Loss: 4.879 Test Acc: 0.314
Validation loss decreased (-0.311716 --> -0.314069).  Saving model ...
Epoch: 30 cost time: 0.585338830947876
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.892 Vali Acc: 0.315 Test Loss: 4.892 Test Acc: 0.315
Validation loss decreased (-0.314069 --> -0.315245).  Saving model ...
Epoch: 31 cost time: 0.7594418525695801
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.910 Vali Acc: 0.312 Test Loss: 4.910 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.550548791885376
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.932 Vali Acc: 0.311 Test Loss: 4.932 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7472786903381348
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.944 Vali Acc: 0.308 Test Loss: 4.944 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6000411510467529
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.948 Vali Acc: 0.307 Test Loss: 4.948 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.553685188293457
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.942 Vali Acc: 0.308 Test Loss: 4.942 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5356793403625488
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.960 Vali Acc: 0.302 Test Loss: 4.960 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6380867958068848
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.066 Vali Acc: 0.294 Test Loss: 5.066 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.4796161651611328
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.089 Vali Acc: 0.301 Test Loss: 5.089 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6316971778869629
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.189 Vali Acc: 0.295 Test Loss: 5.189 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5900933742523193
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.129 Vali Acc: 0.298 Test Loss: 5.129 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31529411764705884
model parameter : 29651738
model size : 127.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9991850852966309
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.364 Vali Acc: 0.033 Test Loss: 3.364 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.5221965312957764
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.334 Vali Acc: 0.042 Test Loss: 3.334 Test Acc: 0.042
Validation loss decreased (-0.032908 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.46352052688598633
Epoch: 3, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.324 Vali Acc: 0.053 Test Loss: 3.324 Test Acc: 0.053
Validation loss decreased (-0.042320 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.4960155487060547
Epoch: 4, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.312 Vali Acc: 0.068 Test Loss: 3.312 Test Acc: 0.068
Validation loss decreased (-0.052908 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 0.5590934753417969
Epoch: 5, Steps: 10 | Train Loss: 2.904 Vali Loss: 3.287 Vali Acc: 0.093 Test Loss: 3.287 Test Acc: 0.093
Validation loss decreased (-0.068202 --> -0.092908).  Saving model ...
Epoch: 6 cost time: 0.5639615058898926
Epoch: 6, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.251 Vali Acc: 0.124 Test Loss: 3.251 Test Acc: 0.124
Validation loss decreased (-0.092908 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 0.4859039783477783
Epoch: 7, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.237 Vali Acc: 0.138 Test Loss: 3.237 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137615).  Saving model ...
Epoch: 8 cost time: 0.5709352493286133
Epoch: 8, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.188 Vali Acc: 0.156 Test Loss: 3.188 Test Acc: 0.156
Validation loss decreased (-0.137615 --> -0.156439).  Saving model ...
Epoch: 9 cost time: 0.5852096080780029
Epoch: 9, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.247 Vali Acc: 0.178 Test Loss: 3.247 Test Acc: 0.178
Validation loss decreased (-0.156439 --> -0.177615).  Saving model ...
Epoch: 10 cost time: 0.6312837600708008
Epoch: 10, Steps: 10 | Train Loss: 1.597 Vali Loss: 3.296 Vali Acc: 0.205 Test Loss: 3.296 Test Acc: 0.205
Validation loss decreased (-0.177615 --> -0.204673).  Saving model ...
Epoch: 11 cost time: 0.5590982437133789
Epoch: 11, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.417 Vali Acc: 0.213 Test Loss: 3.417 Test Acc: 0.213
Validation loss decreased (-0.204673 --> -0.212907).  Saving model ...
Epoch: 12 cost time: 0.6931493282318115
Epoch: 12, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.550 Vali Acc: 0.232 Test Loss: 3.550 Test Acc: 0.232
Validation loss decreased (-0.212907 --> -0.231729).  Saving model ...
Epoch: 13 cost time: 0.6015379428863525
Epoch: 13, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.619 Vali Acc: 0.238 Test Loss: 3.619 Test Acc: 0.238
Validation loss decreased (-0.231729 --> -0.237611).  Saving model ...
Epoch: 14 cost time: 0.5775604248046875
Epoch: 14, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.799 Vali Acc: 0.236 Test Loss: 3.799 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5281009674072266
Epoch: 15, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.756 Vali Acc: 0.262 Test Loss: 3.756 Test Acc: 0.262
Validation loss decreased (-0.237611 --> -0.262315).  Saving model ...
Epoch: 16 cost time: 0.678809642791748
Epoch: 16, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.952 Vali Acc: 0.278 Test Loss: 3.952 Test Acc: 0.278
Validation loss decreased (-0.262315 --> -0.277608).  Saving model ...
Epoch: 17 cost time: 0.5103530883789062
Epoch: 17, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.038 Vali Acc: 0.279 Test Loss: 4.038 Test Acc: 0.279
Validation loss decreased (-0.277608 --> -0.278783).  Saving model ...
Epoch: 18 cost time: 0.5821161270141602
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.227 Vali Acc: 0.274 Test Loss: 4.227 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5352640151977539
Epoch: 19, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.226 Vali Acc: 0.285 Test Loss: 4.226 Test Acc: 0.285
Validation loss decreased (-0.278783 --> -0.284664).  Saving model ...
Epoch: 20 cost time: 0.6464276313781738
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.325 Vali Acc: 0.284 Test Loss: 4.325 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5038759708404541
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.432 Vali Acc: 0.284 Test Loss: 4.432 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5989589691162109
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.455 Vali Acc: 0.287 Test Loss: 4.455 Test Acc: 0.287
Validation loss decreased (-0.284664 --> -0.287014).  Saving model ...
Epoch: 23 cost time: 0.4916069507598877
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.420 Vali Acc: 0.299 Test Loss: 4.420 Test Acc: 0.299
Validation loss decreased (-0.287014 --> -0.298779).  Saving model ...
Epoch: 24 cost time: 0.5476605892181396
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.470 Vali Acc: 0.292 Test Loss: 4.470 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.503364086151123
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.566 Vali Acc: 0.285 Test Loss: 4.566 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5299680233001709
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.608 Vali Acc: 0.288 Test Loss: 4.608 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5525834560394287
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.643 Vali Acc: 0.295 Test Loss: 4.643 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.48521900177001953
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.634 Vali Acc: 0.305 Test Loss: 4.634 Test Acc: 0.305
Validation loss decreased (-0.298779 --> -0.304660).  Saving model ...
Epoch: 29 cost time: 0.5953762531280518
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.634 Vali Acc: 0.298 Test Loss: 4.634 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6594572067260742
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.659 Vali Acc: 0.294 Test Loss: 4.659 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5553638935089111
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.669 Vali Acc: 0.291 Test Loss: 4.669 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.51666259765625
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.673 Vali Acc: 0.294 Test Loss: 4.673 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.506016731262207
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.692 Vali Acc: 0.288 Test Loss: 4.692 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.47718071937561035
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.721 Vali Acc: 0.285 Test Loss: 4.721 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.49149179458618164
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.786 Vali Acc: 0.288 Test Loss: 4.786 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5637812614440918
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.792 Vali Acc: 0.292 Test Loss: 4.792 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6001558303833008
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.815 Vali Acc: 0.293 Test Loss: 4.815 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5523619651794434
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.852 Vali Acc: 0.286 Test Loss: 4.852 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 29522714
model size : 127.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9798529148101807
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.343 Vali Acc: 0.044 Test Loss: 3.343 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.6782479286193848
Epoch: 2, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.383 Vali Acc: 0.061 Test Loss: 3.383 Test Acc: 0.061
Validation loss decreased (-0.043496 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.7013540267944336
Epoch: 3, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.316 Vali Acc: 0.092 Test Loss: 3.316 Test Acc: 0.092
Validation loss decreased (-0.061143 --> -0.091732).  Saving model ...
Epoch: 4 cost time: 0.8080384731292725
Epoch: 4, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.263 Vali Acc: 0.095 Test Loss: 3.263 Test Acc: 0.095
Validation loss decreased (-0.091732 --> -0.095261).  Saving model ...
Epoch: 5 cost time: 0.8377413749694824
Epoch: 5, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.220 Vali Acc: 0.145 Test Loss: 3.220 Test Acc: 0.145
Validation loss decreased (-0.095261 --> -0.144674).  Saving model ...
Epoch: 6 cost time: 0.8677158355712891
Epoch: 6, Steps: 10 | Train Loss: 2.220 Vali Loss: 3.227 Vali Acc: 0.159 Test Loss: 3.227 Test Acc: 0.159
Validation loss decreased (-0.144674 --> -0.158791).  Saving model ...
Epoch: 7 cost time: 0.8179340362548828
Epoch: 7, Steps: 10 | Train Loss: 1.724 Vali Loss: 3.256 Vali Acc: 0.185 Test Loss: 3.256 Test Acc: 0.185
Validation loss decreased (-0.158791 --> -0.184673).  Saving model ...
Epoch: 8 cost time: 0.5481781959533691
Epoch: 8, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.672 Vali Acc: 0.228 Test Loss: 3.672 Test Acc: 0.228
Validation loss decreased (-0.184673 --> -0.228199).  Saving model ...
Epoch: 9 cost time: 0.6011021137237549
Epoch: 9, Steps: 10 | Train Loss: 0.726 Vali Loss: 3.815 Vali Acc: 0.244 Test Loss: 3.815 Test Acc: 0.244
Validation loss decreased (-0.228199 --> -0.243491).  Saving model ...
Epoch: 10 cost time: 0.7037861347198486
Epoch: 10, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.892 Vali Acc: 0.267 Test Loss: 3.892 Test Acc: 0.267
Validation loss decreased (-0.243491 --> -0.267020).  Saving model ...
Epoch: 11 cost time: 1.0328810214996338
Epoch: 11, Steps: 10 | Train Loss: 0.226 Vali Loss: 4.289 Vali Acc: 0.294 Test Loss: 4.289 Test Acc: 0.294
Validation loss decreased (-0.267020 --> -0.294075).  Saving model ...
Epoch: 12 cost time: 0.8843183517456055
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.376 Vali Acc: 0.288 Test Loss: 4.376 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7234926223754883
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.612 Vali Acc: 0.295 Test Loss: 4.612 Test Acc: 0.295
Validation loss decreased (-0.294075 --> -0.295248).  Saving model ...
Epoch: 14 cost time: 0.5323381423950195
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.937 Vali Acc: 0.284 Test Loss: 4.937 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6765556335449219
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.852 Vali Acc: 0.293 Test Loss: 4.852 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8018498420715332
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.026 Vali Acc: 0.298 Test Loss: 5.026 Test Acc: 0.298
Validation loss decreased (-0.295248 --> -0.297597).  Saving model ...
Epoch: 17 cost time: 0.9265162944793701
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.121 Vali Acc: 0.296 Test Loss: 5.121 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6378979682922363
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.113 Vali Acc: 0.294 Test Loss: 5.113 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7487521171569824
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.106 Vali Acc: 0.306 Test Loss: 5.106 Test Acc: 0.306
Validation loss decreased (-0.297597 --> -0.305831).  Saving model ...
Epoch: 20 cost time: 0.6298997402191162
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.180 Vali Acc: 0.305 Test Loss: 5.180 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7194335460662842
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.166 Vali Acc: 0.308 Test Loss: 5.166 Test Acc: 0.308
Validation loss decreased (-0.305831 --> -0.308184).  Saving model ...
Epoch: 22 cost time: 0.7189531326293945
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.131 Vali Acc: 0.315 Test Loss: 5.131 Test Acc: 0.315
Validation loss decreased (-0.308184 --> -0.315243).  Saving model ...
Epoch: 23 cost time: 0.6267075538635254
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.096 Vali Acc: 0.312 Test Loss: 5.096 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.978607177734375
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.099 Vali Acc: 0.313 Test Loss: 5.099 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5555016994476318
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.112 Vali Acc: 0.319 Test Loss: 5.112 Test Acc: 0.319
Validation loss decreased (-0.315243 --> -0.318772).  Saving model ...
Epoch: 26 cost time: 0.9106404781341553
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.124 Vali Acc: 0.312 Test Loss: 5.124 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5568423271179199
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.163 Vali Acc: 0.315 Test Loss: 5.163 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6753983497619629
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.238 Vali Acc: 0.309 Test Loss: 5.238 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6695494651794434
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.179 Vali Acc: 0.311 Test Loss: 5.179 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5840330123901367
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.308 Vali Acc: 0.302 Test Loss: 5.308 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5910248756408691
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.233 Vali Acc: 0.318 Test Loss: 5.233 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5613870620727539
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.271 Vali Acc: 0.318 Test Loss: 5.271 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6429331302642822
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.279 Vali Acc: 0.315 Test Loss: 5.279 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8914897441864014
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.267 Vali Acc: 0.316 Test Loss: 5.267 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7167797088623047
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.255 Vali Acc: 0.320 Test Loss: 5.255 Test Acc: 0.320
Validation loss decreased (-0.318772 --> -0.319947).  Saving model ...
Epoch: 36 cost time: 0.782036542892456
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.270 Vali Acc: 0.319 Test Loss: 5.270 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9186174869537354
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.281 Vali Acc: 0.318 Test Loss: 5.281 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5550796985626221
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.300 Vali Acc: 0.318 Test Loss: 5.300 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8376855850219727
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.316 Vali Acc: 0.318 Test Loss: 5.316 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6752138137817383
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.320 Vali Acc: 0.319 Test Loss: 5.320 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.832859992980957
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.319 Vali Acc: 0.321 Test Loss: 5.319 Test Acc: 0.321
Validation loss decreased (-0.319947 --> -0.321123).  Saving model ...
Epoch: 42 cost time: 0.7933602333068848
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.330 Vali Acc: 0.320 Test Loss: 5.330 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5178377628326416
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.343 Vali Acc: 0.319 Test Loss: 5.343 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5997705459594727
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.359 Vali Acc: 0.319 Test Loss: 5.359 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9575514793395996
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.377 Vali Acc: 0.320 Test Loss: 5.377 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.821793794631958
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.390 Vali Acc: 0.318 Test Loss: 5.390 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7465763092041016
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.406 Vali Acc: 0.319 Test Loss: 5.406 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6623430252075195
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.412 Vali Acc: 0.320 Test Loss: 5.412 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7592995166778564
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.420 Vali Acc: 0.320 Test Loss: 5.420 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.5116407871246338
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.445 Vali Acc: 0.319 Test Loss: 5.445 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 29844506
model size : 128.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8821372985839844
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.388 Vali Acc: 0.036 Test Loss: 3.388 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.5137269496917725
Epoch: 2, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.344 Vali Acc: 0.075 Test Loss: 3.344 Test Acc: 0.075
Validation loss decreased (-0.036437 --> -0.075261).  Saving model ...
Epoch: 3 cost time: 0.8861281871795654
Epoch: 3, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.338 Vali Acc: 0.087 Test Loss: 3.338 Test Acc: 0.087
Validation loss decreased (-0.075261 --> -0.087025).  Saving model ...
Epoch: 4 cost time: 0.5215597152709961
Epoch: 4, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.290 Vali Acc: 0.078 Test Loss: 3.290 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5387358665466309
Epoch: 5, Steps: 10 | Train Loss: 2.826 Vali Loss: 3.248 Vali Acc: 0.106 Test Loss: 3.248 Test Acc: 0.106
Validation loss decreased (-0.087025 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 0.6402273178100586
Epoch: 6, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.216 Vali Acc: 0.141 Test Loss: 3.216 Test Acc: 0.141
Validation loss decreased (-0.105850 --> -0.141144).  Saving model ...
Epoch: 7 cost time: 0.6177098751068115
Epoch: 7, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.219 Vali Acc: 0.154 Test Loss: 3.219 Test Acc: 0.154
Validation loss decreased (-0.141144 --> -0.154085).  Saving model ...
Epoch: 8 cost time: 0.6588106155395508
Epoch: 8, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.240 Vali Acc: 0.179 Test Loss: 3.240 Test Acc: 0.179
Validation loss decreased (-0.154085 --> -0.178791).  Saving model ...
Epoch: 9 cost time: 0.7132844924926758
Epoch: 9, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.393 Vali Acc: 0.207 Test Loss: 3.393 Test Acc: 0.207
Validation loss decreased (-0.178791 --> -0.207025).  Saving model ...
Epoch: 10 cost time: 0.6873877048492432
Epoch: 10, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.486 Vali Acc: 0.218 Test Loss: 3.486 Test Acc: 0.218
Validation loss decreased (-0.207025 --> -0.217612).  Saving model ...
Epoch: 11 cost time: 0.6517717838287354
Epoch: 11, Steps: 10 | Train Loss: 0.664 Vali Loss: 3.728 Vali Acc: 0.239 Test Loss: 3.728 Test Acc: 0.239
Validation loss decreased (-0.217612 --> -0.238786).  Saving model ...
Epoch: 12 cost time: 0.5941619873046875
Epoch: 12, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.781 Vali Acc: 0.265 Test Loss: 3.781 Test Acc: 0.265
Validation loss decreased (-0.238786 --> -0.264668).  Saving model ...
Epoch: 13 cost time: 0.6777973175048828
Epoch: 13, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.950 Vali Acc: 0.260 Test Loss: 3.950 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6499073505401611
Epoch: 14, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.951 Vali Acc: 0.282 Test Loss: 3.951 Test Acc: 0.282
Validation loss decreased (-0.264668 --> -0.282313).  Saving model ...
Epoch: 15 cost time: 0.6588413715362549
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.262 Vali Acc: 0.276 Test Loss: 4.262 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5077478885650635
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.230 Vali Acc: 0.293 Test Loss: 4.230 Test Acc: 0.293
Validation loss decreased (-0.282313 --> -0.292899).  Saving model ...
Epoch: 17 cost time: 0.5462427139282227
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.287 Vali Acc: 0.292 Test Loss: 4.287 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.610386848449707
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.519 Vali Acc: 0.282 Test Loss: 4.519 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6010799407958984
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.515 Vali Acc: 0.288 Test Loss: 4.515 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5913593769073486
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.562 Vali Acc: 0.296 Test Loss: 4.562 Test Acc: 0.296
Validation loss decreased (-0.292899 --> -0.296425).  Saving model ...
Epoch: 21 cost time: 0.5526587963104248
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.582 Vali Acc: 0.299 Test Loss: 4.582 Test Acc: 0.299
Validation loss decreased (-0.296425 --> -0.298778).  Saving model ...
Epoch: 22 cost time: 0.7204179763793945
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.785 Vali Acc: 0.274 Test Loss: 4.785 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6033568382263184
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.741 Vali Acc: 0.306 Test Loss: 4.741 Test Acc: 0.306
Validation loss decreased (-0.298778 --> -0.305835).  Saving model ...
Epoch: 24 cost time: 0.5989706516265869
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.707 Vali Acc: 0.307 Test Loss: 4.707 Test Acc: 0.307
Validation loss decreased (-0.305835 --> -0.307012).  Saving model ...
Epoch: 25 cost time: 0.715857744216919
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.710 Vali Acc: 0.301 Test Loss: 4.710 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5963799953460693
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.708 Vali Acc: 0.306 Test Loss: 4.708 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5197649002075195
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.700 Vali Acc: 0.302 Test Loss: 4.700 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5415418148040771
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.712 Vali Acc: 0.301 Test Loss: 4.712 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6327371597290039
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.779 Vali Acc: 0.302 Test Loss: 4.779 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.694488525390625
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.807 Vali Acc: 0.302 Test Loss: 4.807 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6898171901702881
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.777 Vali Acc: 0.305 Test Loss: 4.777 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7502646446228027
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.768 Vali Acc: 0.306 Test Loss: 4.768 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7138216495513916
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.768 Vali Acc: 0.305 Test Loss: 4.768 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6477470397949219
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.768 Vali Acc: 0.305 Test Loss: 4.768 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 29629466
model size : 127.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.219853162765503
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.351 Vali Acc: 0.041 Test Loss: 3.351 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.5852441787719727
Epoch: 2, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.304 Vali Acc: 0.055 Test Loss: 3.304 Test Acc: 0.055
Validation loss decreased (-0.041143 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.5633745193481445
Epoch: 3, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.305 Vali Acc: 0.060 Test Loss: 3.305 Test Acc: 0.060
Validation loss decreased (-0.055261 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.5761837959289551
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.328 Vali Acc: 0.068 Test Loss: 3.328 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 0.5363118648529053
Epoch: 5, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.305 Vali Acc: 0.080 Test Loss: 3.305 Test Acc: 0.080
Validation loss decreased (-0.068202 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.5535955429077148
Epoch: 6, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.262 Vali Acc: 0.094 Test Loss: 3.262 Test Acc: 0.094
Validation loss decreased (-0.079967 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 0.5176336765289307
Epoch: 7, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.220 Vali Acc: 0.100 Test Loss: 3.220 Test Acc: 0.100
Validation loss decreased (-0.094085 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 0.5842208862304688
Epoch: 8, Steps: 10 | Train Loss: 2.474 Vali Loss: 3.232 Vali Acc: 0.122 Test Loss: 3.232 Test Acc: 0.122
Validation loss decreased (-0.099968 --> -0.122321).  Saving model ...
Epoch: 9 cost time: 0.6394801139831543
Epoch: 9, Steps: 10 | Train Loss: 2.201 Vali Loss: 3.223 Vali Acc: 0.151 Test Loss: 3.223 Test Acc: 0.151
Validation loss decreased (-0.122321 --> -0.150556).  Saving model ...
Epoch: 10 cost time: 0.5473814010620117
Epoch: 10, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.319 Vali Acc: 0.158 Test Loss: 3.319 Test Acc: 0.158
Validation loss decreased (-0.150556 --> -0.157614).  Saving model ...
Epoch: 11 cost time: 0.6196479797363281
Epoch: 11, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.342 Vali Acc: 0.179 Test Loss: 3.342 Test Acc: 0.179
Validation loss decreased (-0.157614 --> -0.178790).  Saving model ...
Epoch: 12 cost time: 0.5624058246612549
Epoch: 12, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.387 Vali Acc: 0.208 Test Loss: 3.387 Test Acc: 0.208
Validation loss decreased (-0.178790 --> -0.208201).  Saving model ...
Epoch: 13 cost time: 0.6293926239013672
Epoch: 13, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.475 Vali Acc: 0.239 Test Loss: 3.475 Test Acc: 0.239
Validation loss decreased (-0.208201 --> -0.238789).  Saving model ...
Epoch: 14 cost time: 0.5410139560699463
Epoch: 14, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.599 Vali Acc: 0.238 Test Loss: 3.599 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5655937194824219
Epoch: 15, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.677 Vali Acc: 0.261 Test Loss: 3.677 Test Acc: 0.261
Validation loss decreased (-0.238789 --> -0.261140).  Saving model ...
Epoch: 16 cost time: 0.5075325965881348
Epoch: 16, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.750 Vali Acc: 0.259 Test Loss: 3.750 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6208646297454834
Epoch: 17, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.815 Vali Acc: 0.264 Test Loss: 3.815 Test Acc: 0.264
Validation loss decreased (-0.261140 --> -0.263491).  Saving model ...
Epoch: 18 cost time: 0.5572288036346436
Epoch: 18, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.962 Vali Acc: 0.271 Test Loss: 3.962 Test Acc: 0.271
Validation loss decreased (-0.263491 --> -0.270549).  Saving model ...
Epoch: 19 cost time: 0.6622111797332764
Epoch: 19, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.100 Vali Acc: 0.273 Test Loss: 4.100 Test Acc: 0.273
Validation loss decreased (-0.270549 --> -0.272900).  Saving model ...
Epoch: 20 cost time: 0.5318589210510254
Epoch: 20, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.118 Vali Acc: 0.281 Test Loss: 4.118 Test Acc: 0.281
Validation loss decreased (-0.272900 --> -0.281135).  Saving model ...
Epoch: 21 cost time: 0.6898725032806396
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.188 Vali Acc: 0.278 Test Loss: 4.188 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6410138607025146
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.228 Vali Acc: 0.284 Test Loss: 4.228 Test Acc: 0.284
Validation loss decreased (-0.281135 --> -0.283487).  Saving model ...
Epoch: 23 cost time: 0.8161237239837646
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.252 Vali Acc: 0.289 Test Loss: 4.252 Test Acc: 0.289
Validation loss decreased (-0.283487 --> -0.289369).  Saving model ...
Epoch: 24 cost time: 0.6129226684570312
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.280 Vali Acc: 0.289 Test Loss: 4.280 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6486711502075195
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.311 Vali Acc: 0.293 Test Loss: 4.311 Test Acc: 0.293
Validation loss decreased (-0.289369 --> -0.292898).  Saving model ...
Epoch: 26 cost time: 0.5969102382659912
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.383 Vali Acc: 0.291 Test Loss: 4.383 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6366467475891113
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.407 Vali Acc: 0.294 Test Loss: 4.407 Test Acc: 0.294
Validation loss decreased (-0.292898 --> -0.294074).  Saving model ...
Epoch: 28 cost time: 0.5697247982025146
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.408 Vali Acc: 0.289 Test Loss: 4.408 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.539616584777832
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.408 Vali Acc: 0.289 Test Loss: 4.408 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9014689922332764
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.421 Vali Acc: 0.295 Test Loss: 4.421 Test Acc: 0.295
Validation loss decreased (-0.294074 --> -0.295250).  Saving model ...
Epoch: 31 cost time: 0.6657493114471436
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.469 Vali Acc: 0.289 Test Loss: 4.469 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8980967998504639
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.492 Vali Acc: 0.296 Test Loss: 4.492 Test Acc: 0.296
Validation loss decreased (-0.295250 --> -0.296426).  Saving model ...
Epoch: 33 cost time: 0.6214709281921387
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.524 Vali Acc: 0.291 Test Loss: 4.524 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7484860420227051
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.561 Vali Acc: 0.292 Test Loss: 4.561 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6085383892059326
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.585 Vali Acc: 0.291 Test Loss: 4.585 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7635495662689209
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.591 Vali Acc: 0.291 Test Loss: 4.591 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5837035179138184
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.591 Vali Acc: 0.292 Test Loss: 4.591 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5920460224151611
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.601 Vali Acc: 0.295 Test Loss: 4.601 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6598265171051025
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.636 Vali Acc: 0.294 Test Loss: 4.636 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6591367721557617
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.652 Vali Acc: 0.294 Test Loss: 4.652 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6072866916656494
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.660 Vali Acc: 0.294 Test Loss: 4.660 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.553558349609375
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.670 Vali Acc: 0.294 Test Loss: 4.670 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 29500442
model size : 127.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8923640251159668
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.340 Vali Acc: 0.033 Test Loss: 3.340 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.5954320430755615
Epoch: 2, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.360 Vali Acc: 0.047 Test Loss: 3.360 Test Acc: 0.047
Validation loss decreased (-0.032908 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.6520538330078125
Epoch: 3, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.331 Vali Acc: 0.080 Test Loss: 3.331 Test Acc: 0.080
Validation loss decreased (-0.047025 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 0.7528011798858643
Epoch: 4, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.240 Vali Acc: 0.100 Test Loss: 3.240 Test Acc: 0.100
Validation loss decreased (-0.079967 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 0.5221652984619141
Epoch: 5, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.220 Vali Acc: 0.116 Test Loss: 3.220 Test Acc: 0.116
Validation loss decreased (-0.099968 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 0.5820417404174805
Epoch: 6, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.192 Vali Acc: 0.172 Test Loss: 3.192 Test Acc: 0.172
Validation loss decreased (-0.116438 --> -0.171733).  Saving model ...
Epoch: 7 cost time: 0.5942704677581787
Epoch: 7, Steps: 10 | Train Loss: 1.931 Vali Loss: 3.225 Vali Acc: 0.171 Test Loss: 3.225 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.585820198059082
Epoch: 8, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.395 Vali Acc: 0.221 Test Loss: 3.395 Test Acc: 0.221
Validation loss decreased (-0.171733 --> -0.221143).  Saving model ...
Epoch: 9 cost time: 1.1351959705352783
Epoch: 9, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.675 Vali Acc: 0.233 Test Loss: 3.675 Test Acc: 0.233
Validation loss decreased (-0.221143 --> -0.232904).  Saving model ...
Epoch: 10 cost time: 0.6055021286010742
Epoch: 10, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.745 Vali Acc: 0.266 Test Loss: 3.745 Test Acc: 0.266
Validation loss decreased (-0.232904 --> -0.265845).  Saving model ...
Epoch: 11 cost time: 1.0845320224761963
Epoch: 11, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.962 Vali Acc: 0.285 Test Loss: 3.962 Test Acc: 0.285
Validation loss decreased (-0.265845 --> -0.284666).  Saving model ...
Epoch: 12 cost time: 0.6161952018737793
Epoch: 12, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.241 Vali Acc: 0.264 Test Loss: 4.241 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6453368663787842
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.244 Vali Acc: 0.294 Test Loss: 4.244 Test Acc: 0.294
Validation loss decreased (-0.284666 --> -0.294075).  Saving model ...
Epoch: 14 cost time: 0.609135627746582
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.473 Vali Acc: 0.293 Test Loss: 4.473 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8320271968841553
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.660 Vali Acc: 0.293 Test Loss: 4.660 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.735828161239624
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.742 Vali Acc: 0.309 Test Loss: 4.742 Test Acc: 0.309
Validation loss decreased (-0.294075 --> -0.309364).  Saving model ...
Epoch: 17 cost time: 0.7142539024353027
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.871 Vali Acc: 0.318 Test Loss: 4.871 Test Acc: 0.318
Validation loss decreased (-0.309364 --> -0.317598).  Saving model ...
Epoch: 18 cost time: 0.9506270885467529
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.914 Vali Acc: 0.304 Test Loss: 4.914 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6227529048919678
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.860 Vali Acc: 0.306 Test Loss: 4.860 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.631213903427124
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.993 Vali Acc: 0.305 Test Loss: 4.993 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6856491565704346
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.752 Vali Acc: 0.322 Test Loss: 4.752 Test Acc: 0.322
Validation loss decreased (-0.317598 --> -0.322305).  Saving model ...
Epoch: 22 cost time: 0.6544239521026611
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.814 Vali Acc: 0.311 Test Loss: 4.814 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7301411628723145
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.914 Vali Acc: 0.311 Test Loss: 4.914 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7305397987365723
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.936 Vali Acc: 0.312 Test Loss: 4.936 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9635214805603027
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.921 Vali Acc: 0.315 Test Loss: 4.921 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6938502788543701
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.938 Vali Acc: 0.318 Test Loss: 4.938 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7360348701477051
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.017 Vali Acc: 0.316 Test Loss: 5.017 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6134927272796631
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.019 Vali Acc: 0.315 Test Loss: 5.019 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.689868688583374
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.046 Vali Acc: 0.326 Test Loss: 5.046 Test Acc: 0.326
Validation loss decreased (-0.322305 --> -0.325832).  Saving model ...
Epoch: 30 cost time: 0.5301964282989502
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.029 Vali Acc: 0.319 Test Loss: 5.029 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6202645301818848
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.084 Vali Acc: 0.321 Test Loss: 5.084 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6527547836303711
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.092 Vali Acc: 0.325 Test Loss: 5.092 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6119115352630615
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.082 Vali Acc: 0.327 Test Loss: 5.082 Test Acc: 0.327
Validation loss decreased (-0.325832 --> -0.327008).  Saving model ...
Epoch: 34 cost time: 0.676532506942749
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.054 Vali Acc: 0.332 Test Loss: 5.054 Test Acc: 0.332
Validation loss decreased (-0.327008 --> -0.331714).  Saving model ...
Epoch: 35 cost time: 0.633730411529541
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.067 Vali Acc: 0.333 Test Loss: 5.067 Test Acc: 0.333
Validation loss decreased (-0.331714 --> -0.332891).  Saving model ...
Epoch: 36 cost time: 0.8224208354949951
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.074 Vali Acc: 0.332 Test Loss: 5.074 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.609205961227417
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.082 Vali Acc: 0.327 Test Loss: 5.082 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6221179962158203
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.112 Vali Acc: 0.321 Test Loss: 5.112 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.905909538269043
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.130 Vali Acc: 0.322 Test Loss: 5.130 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6630139350891113
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.141 Vali Acc: 0.325 Test Loss: 5.141 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9428420066833496
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.131 Vali Acc: 0.329 Test Loss: 5.131 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6830794811248779
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.140 Vali Acc: 0.329 Test Loss: 5.140 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.01133394241333
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.148 Vali Acc: 0.328 Test Loss: 5.148 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6379430294036865
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.156 Vali Acc: 0.329 Test Loss: 5.156 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2116241455078125
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.168 Vali Acc: 0.329 Test Loss: 5.168 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 29807642
model size : 128.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.762242078781128
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.339 Vali Acc: 0.046 Test Loss: 3.339 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.63926100730896
Epoch: 2, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.306 Vali Acc: 0.069 Test Loss: 3.306 Test Acc: 0.069
Validation loss decreased (-0.045849 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.6156861782073975
Epoch: 3, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.309 Vali Acc: 0.078 Test Loss: 3.309 Test Acc: 0.078
Validation loss decreased (-0.069379 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.5154504776000977
Epoch: 4, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.266 Vali Acc: 0.086 Test Loss: 3.266 Test Acc: 0.086
Validation loss decreased (-0.077614 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.6575181484222412
Epoch: 5, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.245 Vali Acc: 0.094 Test Loss: 3.245 Test Acc: 0.094
Validation loss decreased (-0.085850 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.5407161712646484
Epoch: 6, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.224 Vali Acc: 0.120 Test Loss: 3.224 Test Acc: 0.120
Validation loss decreased (-0.094085 --> -0.119968).  Saving model ...
Epoch: 7 cost time: 0.6531362533569336
Epoch: 7, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.196 Vali Acc: 0.128 Test Loss: 3.196 Test Acc: 0.128
Validation loss decreased (-0.119968 --> -0.128203).  Saving model ...
Epoch: 8 cost time: 0.5398216247558594
Epoch: 8, Steps: 10 | Train Loss: 2.083 Vali Loss: 3.171 Vali Acc: 0.175 Test Loss: 3.171 Test Acc: 0.175
Validation loss decreased (-0.128203 --> -0.175262).  Saving model ...
Epoch: 9 cost time: 0.7122633457183838
Epoch: 9, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.319 Vali Acc: 0.192 Test Loss: 3.319 Test Acc: 0.192
Validation loss decreased (-0.175262 --> -0.191732).  Saving model ...
Epoch: 10 cost time: 0.5661227703094482
Epoch: 10, Steps: 10 | Train Loss: 1.254 Vali Loss: 3.410 Vali Acc: 0.219 Test Loss: 3.410 Test Acc: 0.219
Validation loss decreased (-0.191732 --> -0.218789).  Saving model ...
Epoch: 11 cost time: 0.5945305824279785
Epoch: 11, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.592 Vali Acc: 0.232 Test Loss: 3.592 Test Acc: 0.232
Validation loss decreased (-0.218789 --> -0.231729).  Saving model ...
Epoch: 12 cost time: 0.6666553020477295
Epoch: 12, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.685 Vali Acc: 0.238 Test Loss: 3.685 Test Acc: 0.238
Validation loss decreased (-0.231729 --> -0.237610).  Saving model ...
Epoch: 13 cost time: 0.5388944149017334
Epoch: 13, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.859 Vali Acc: 0.246 Test Loss: 3.859 Test Acc: 0.246
Validation loss decreased (-0.237610 --> -0.245844).  Saving model ...
Epoch: 14 cost time: 0.57987380027771
Epoch: 14, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.951 Vali Acc: 0.252 Test Loss: 3.951 Test Acc: 0.252
Validation loss decreased (-0.245844 --> -0.251725).  Saving model ...
Epoch: 15 cost time: 0.5485255718231201
Epoch: 15, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.975 Vali Acc: 0.260 Test Loss: 3.975 Test Acc: 0.260
Validation loss decreased (-0.251725 --> -0.259960).  Saving model ...
Epoch: 16 cost time: 0.679875373840332
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.198 Vali Acc: 0.254 Test Loss: 4.198 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5321125984191895
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.195 Vali Acc: 0.271 Test Loss: 4.195 Test Acc: 0.271
Validation loss decreased (-0.259960 --> -0.270546).  Saving model ...
Epoch: 18 cost time: 0.7638282775878906
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.326 Vali Acc: 0.280 Test Loss: 4.326 Test Acc: 0.280
Validation loss decreased (-0.270546 --> -0.279957).  Saving model ...
Epoch: 19 cost time: 0.6142823696136475
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.383 Vali Acc: 0.281 Test Loss: 4.383 Test Acc: 0.281
Validation loss decreased (-0.279957 --> -0.281133).  Saving model ...
Epoch: 20 cost time: 0.6096441745758057
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.380 Vali Acc: 0.276 Test Loss: 4.380 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6302394866943359
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.413 Vali Acc: 0.278 Test Loss: 4.413 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.527268648147583
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.454 Vali Acc: 0.280 Test Loss: 4.454 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.56980299949646
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.468 Vali Acc: 0.285 Test Loss: 4.468 Test Acc: 0.285
Validation loss decreased (-0.281133 --> -0.284661).  Saving model ...
Epoch: 24 cost time: 0.5708749294281006
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.500 Vali Acc: 0.286 Test Loss: 4.500 Test Acc: 0.286
Validation loss decreased (-0.284661 --> -0.285837).  Saving model ...
Epoch: 25 cost time: 0.7838032245635986
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.533 Vali Acc: 0.284 Test Loss: 4.533 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7843430042266846
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.591 Vali Acc: 0.282 Test Loss: 4.591 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6376581192016602
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.633 Vali Acc: 0.281 Test Loss: 4.633 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6974434852600098
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.656 Vali Acc: 0.280 Test Loss: 4.656 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6901607513427734
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.666 Vali Acc: 0.280 Test Loss: 4.666 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6300625801086426
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.671 Vali Acc: 0.286 Test Loss: 4.671 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6259021759033203
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.692 Vali Acc: 0.285 Test Loss: 4.692 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5610778331756592
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.713 Vali Acc: 0.288 Test Loss: 4.713 Test Acc: 0.288
Validation loss decreased (-0.285837 --> -0.288188).  Saving model ...
Epoch: 33 cost time: 0.6667304039001465
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.878 Vali Acc: 0.288 Test Loss: 4.878 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5635185241699219
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.739 Vali Acc: 0.293 Test Loss: 4.739 Test Acc: 0.293
Validation loss decreased (-0.288188 --> -0.292894).  Saving model ...
Epoch: 35 cost time: 0.7065904140472412
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.790 Vali Acc: 0.287 Test Loss: 4.790 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6351406574249268
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.831 Vali Acc: 0.286 Test Loss: 4.831 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8208751678466797
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.831 Vali Acc: 0.287 Test Loss: 4.831 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5502424240112305
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.826 Vali Acc: 0.289 Test Loss: 4.826 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5900206565856934
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.836 Vali Acc: 0.284 Test Loss: 4.836 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6173264980316162
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.829 Vali Acc: 0.289 Test Loss: 4.829 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5687234401702881
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.830 Vali Acc: 0.288 Test Loss: 4.830 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8082020282745361
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.840 Vali Acc: 0.289 Test Loss: 4.840 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6561708450317383
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.839 Vali Acc: 0.289 Test Loss: 4.839 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5363531112670898
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.867 Vali Acc: 0.291 Test Loss: 4.867 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 29614106
model size : 127.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.878072738647461
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.360 Vali Acc: 0.048 Test Loss: 3.360 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.4910740852355957
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.304 Vali Acc: 0.029 Test Loss: 3.304 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6287531852722168
Epoch: 3, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.291 Vali Acc: 0.056 Test Loss: 3.291 Test Acc: 0.056
Validation loss decreased (-0.048202 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 0.5652358531951904
Epoch: 4, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.306 Vali Acc: 0.061 Test Loss: 3.306 Test Acc: 0.061
Validation loss decreased (-0.056438 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 0.6520586013793945
Epoch: 5, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.306 Vali Acc: 0.066 Test Loss: 3.306 Test Acc: 0.066
Validation loss decreased (-0.061143 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 0.5722670555114746
Epoch: 6, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.266 Vali Acc: 0.098 Test Loss: 3.266 Test Acc: 0.098
Validation loss decreased (-0.065849 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 0.7081298828125
Epoch: 7, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.244 Vali Acc: 0.114 Test Loss: 3.244 Test Acc: 0.114
Validation loss decreased (-0.097614 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.5061564445495605
Epoch: 8, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.214 Vali Acc: 0.125 Test Loss: 3.214 Test Acc: 0.125
Validation loss decreased (-0.114085 --> -0.124674).  Saving model ...
Epoch: 9 cost time: 0.5531764030456543
Epoch: 9, Steps: 10 | Train Loss: 2.234 Vali Loss: 3.202 Vali Acc: 0.144 Test Loss: 3.202 Test Acc: 0.144
Validation loss decreased (-0.124674 --> -0.143497).  Saving model ...
Epoch: 10 cost time: 0.5332489013671875
Epoch: 10, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.202 Vali Acc: 0.171 Test Loss: 3.202 Test Acc: 0.171
Validation loss decreased (-0.143497 --> -0.170556).  Saving model ...
Epoch: 11 cost time: 0.49695301055908203
Epoch: 11, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.272 Vali Acc: 0.178 Test Loss: 3.272 Test Acc: 0.178
Validation loss decreased (-0.170556 --> -0.177614).  Saving model ...
Epoch: 12 cost time: 0.5259573459625244
Epoch: 12, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.367 Vali Acc: 0.191 Test Loss: 3.367 Test Acc: 0.191
Validation loss decreased (-0.177614 --> -0.190555).  Saving model ...
Epoch: 13 cost time: 0.6099035739898682
Epoch: 13, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.393 Vali Acc: 0.231 Test Loss: 3.393 Test Acc: 0.231
Validation loss decreased (-0.190555 --> -0.230554).  Saving model ...
Epoch: 14 cost time: 0.6807713508605957
Epoch: 14, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.459 Vali Acc: 0.242 Test Loss: 3.459 Test Acc: 0.242
Validation loss decreased (-0.230554 --> -0.242318).  Saving model ...
Epoch: 15 cost time: 0.562873363494873
Epoch: 15, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.577 Vali Acc: 0.240 Test Loss: 3.577 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.670220136642456
Epoch: 16, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.558 Vali Acc: 0.264 Test Loss: 3.558 Test Acc: 0.264
Validation loss decreased (-0.242318 --> -0.263494).  Saving model ...
Epoch: 17 cost time: 0.5826535224914551
Epoch: 17, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.625 Vali Acc: 0.269 Test Loss: 3.625 Test Acc: 0.269
Validation loss decreased (-0.263494 --> -0.269376).  Saving model ...
Epoch: 18 cost time: 0.7126893997192383
Epoch: 18, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.796 Vali Acc: 0.274 Test Loss: 3.796 Test Acc: 0.274
Validation loss decreased (-0.269376 --> -0.274080).  Saving model ...
Epoch: 19 cost time: 0.5427043437957764
Epoch: 19, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.857 Vali Acc: 0.274 Test Loss: 3.857 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5262801647186279
Epoch: 20, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.910 Vali Acc: 0.286 Test Loss: 3.910 Test Acc: 0.286
Validation loss decreased (-0.274080 --> -0.285843).  Saving model ...
Epoch: 21 cost time: 0.575035572052002
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.974 Vali Acc: 0.284 Test Loss: 3.974 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5514876842498779
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.988 Vali Acc: 0.282 Test Loss: 3.988 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5079905986785889
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.099 Vali Acc: 0.287 Test Loss: 4.099 Test Acc: 0.287
Validation loss decreased (-0.285843 --> -0.287018).  Saving model ...
Epoch: 24 cost time: 0.5941386222839355
Epoch: 24, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.110 Vali Acc: 0.295 Test Loss: 4.110 Test Acc: 0.295
Validation loss decreased (-0.287018 --> -0.295253).  Saving model ...
Epoch: 25 cost time: 0.5140988826751709
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.147 Vali Acc: 0.293 Test Loss: 4.147 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.48563528060913086
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.201 Vali Acc: 0.284 Test Loss: 4.201 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5367875099182129
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.224 Vali Acc: 0.294 Test Loss: 4.224 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6057755947113037
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.251 Vali Acc: 0.299 Test Loss: 4.251 Test Acc: 0.299
Validation loss decreased (-0.295253 --> -0.298781).  Saving model ...
Epoch: 29 cost time: 0.587876558303833
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.277 Vali Acc: 0.295 Test Loss: 4.277 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5330765247344971
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.294 Vali Acc: 0.296 Test Loss: 4.294 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.46397900581359863
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.326 Vali Acc: 0.295 Test Loss: 4.326 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4846503734588623
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.338 Vali Acc: 0.298 Test Loss: 4.338 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.511080265045166
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.349 Vali Acc: 0.292 Test Loss: 4.349 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5067169666290283
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.358 Vali Acc: 0.296 Test Loss: 4.358 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5937230587005615
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.377 Vali Acc: 0.298 Test Loss: 4.377 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5347695350646973
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.388 Vali Acc: 0.301 Test Loss: 4.388 Test Acc: 0.301
Validation loss decreased (-0.298781 --> -0.301133).  Saving model ...
Epoch: 37 cost time: 0.586463212966919
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.428 Vali Acc: 0.299 Test Loss: 4.428 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6044356822967529
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.438 Vali Acc: 0.300 Test Loss: 4.438 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5034737586975098
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.490 Vali Acc: 0.298 Test Loss: 4.490 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5351431369781494
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.521 Vali Acc: 0.298 Test Loss: 4.521 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5485222339630127
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.515 Vali Acc: 0.298 Test Loss: 4.515 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4902169704437256
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.535 Vali Acc: 0.296 Test Loss: 4.535 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5122470855712891
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.548 Vali Acc: 0.300 Test Loss: 4.548 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5355954170227051
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.566 Vali Acc: 0.301 Test Loss: 4.566 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5561378002166748
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.571 Vali Acc: 0.305 Test Loss: 4.571 Test Acc: 0.305
Validation loss decreased (-0.301133 --> -0.304660).  Saving model ...
Epoch: 46 cost time: 0.6257650852203369
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.571 Vali Acc: 0.305 Test Loss: 4.571 Test Acc: 0.305
Validation loss decreased (-0.304660 --> -0.304660).  Saving model ...
Epoch: 47 cost time: 0.7082688808441162
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.588 Vali Acc: 0.302 Test Loss: 4.588 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6612594127655029
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.612 Vali Acc: 0.305 Test Loss: 4.612 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5427744388580322
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.635 Vali Acc: 0.300 Test Loss: 4.635 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6249034404754639
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.664 Vali Acc: 0.300 Test Loss: 4.664 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 29506586
model size : 127.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.322614908218384
Epoch: 1, Steps: 10 | Train Loss: 3.430 Vali Loss: 3.338 Vali Acc: 0.044 Test Loss: 3.338 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4867880344390869
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.357 Vali Acc: 0.058 Test Loss: 3.357 Test Acc: 0.058
Validation loss decreased (-0.043496 --> -0.057613).  Saving model ...
Epoch: 3 cost time: 0.5441763401031494
Epoch: 3, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.360 Vali Acc: 0.059 Test Loss: 3.360 Test Acc: 0.059
Validation loss decreased (-0.057613 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 0.6671924591064453
Epoch: 4, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.275 Vali Acc: 0.084 Test Loss: 3.275 Test Acc: 0.084
Validation loss decreased (-0.058790 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 0.9853665828704834
Epoch: 5, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.204 Vali Acc: 0.116 Test Loss: 3.204 Test Acc: 0.116
Validation loss decreased (-0.083497 --> -0.116439).  Saving model ...
Epoch: 6 cost time: 0.6325607299804688
Epoch: 6, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.236 Vali Acc: 0.141 Test Loss: 3.236 Test Acc: 0.141
Validation loss decreased (-0.116439 --> -0.141144).  Saving model ...
Epoch: 7 cost time: 0.4407832622528076
Epoch: 7, Steps: 10 | Train Loss: 1.959 Vali Loss: 3.232 Vali Acc: 0.166 Test Loss: 3.232 Test Acc: 0.166
Validation loss decreased (-0.141144 --> -0.165850).  Saving model ...
Epoch: 8 cost time: 0.5138773918151855
Epoch: 8, Steps: 10 | Train Loss: 1.506 Vali Loss: 3.390 Vali Acc: 0.209 Test Loss: 3.390 Test Acc: 0.209
Validation loss decreased (-0.165850 --> -0.209378).  Saving model ...
Epoch: 9 cost time: 0.48637819290161133
Epoch: 9, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.601 Vali Acc: 0.220 Test Loss: 3.601 Test Acc: 0.220
Validation loss decreased (-0.209378 --> -0.219964).  Saving model ...
Epoch: 10 cost time: 0.5287725925445557
Epoch: 10, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.698 Vali Acc: 0.241 Test Loss: 3.698 Test Acc: 0.241
Validation loss decreased (-0.219964 --> -0.241139).  Saving model ...
Epoch: 11 cost time: 0.769953727722168
Epoch: 11, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.868 Vali Acc: 0.260 Test Loss: 3.868 Test Acc: 0.260
Validation loss decreased (-0.241139 --> -0.259961).  Saving model ...
Epoch: 12 cost time: 0.6369352340698242
Epoch: 12, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.006 Vali Acc: 0.289 Test Loss: 4.006 Test Acc: 0.289
Validation loss decreased (-0.259961 --> -0.289372).  Saving model ...
Epoch: 13 cost time: 0.6292293071746826
Epoch: 13, Steps: 10 | Train Loss: 0.173 Vali Loss: 4.262 Vali Acc: 0.280 Test Loss: 4.262 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5784718990325928
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.327 Vali Acc: 0.276 Test Loss: 4.327 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7151250839233398
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.322 Vali Acc: 0.294 Test Loss: 4.322 Test Acc: 0.294
Validation loss decreased (-0.289372 --> -0.294074).  Saving model ...
Epoch: 16 cost time: 1.1137449741363525
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.579 Vali Acc: 0.299 Test Loss: 4.579 Test Acc: 0.299
Validation loss decreased (-0.294074 --> -0.298778).  Saving model ...
Epoch: 17 cost time: 0.8571944236755371
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.742 Vali Acc: 0.285 Test Loss: 4.742 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6183896064758301
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.741 Vali Acc: 0.288 Test Loss: 4.741 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7278900146484375
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.779 Vali Acc: 0.300 Test Loss: 4.779 Test Acc: 0.300
Validation loss decreased (-0.298778 --> -0.299952).  Saving model ...
Epoch: 20 cost time: 0.6510434150695801
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.815 Vali Acc: 0.292 Test Loss: 4.815 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9910886287689209
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.838 Vali Acc: 0.291 Test Loss: 4.838 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.637479305267334
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.862 Vali Acc: 0.295 Test Loss: 4.862 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6765704154968262
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.789 Vali Acc: 0.301 Test Loss: 4.789 Test Acc: 0.301
Validation loss decreased (-0.299952 --> -0.301129).  Saving model ...
Epoch: 24 cost time: 0.6689002513885498
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.787 Vali Acc: 0.296 Test Loss: 4.787 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5497331619262695
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.782 Vali Acc: 0.302 Test Loss: 4.782 Test Acc: 0.302
Validation loss decreased (-0.301129 --> -0.302305).  Saving model ...
Epoch: 26 cost time: 0.7051005363464355
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.830 Vali Acc: 0.308 Test Loss: 4.830 Test Acc: 0.308
Validation loss decreased (-0.302305 --> -0.308187).  Saving model ...
Epoch: 27 cost time: 0.5746901035308838
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.863 Vali Acc: 0.301 Test Loss: 4.863 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5262742042541504
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.868 Vali Acc: 0.305 Test Loss: 4.868 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6462264060974121
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.870 Vali Acc: 0.306 Test Loss: 4.870 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5501790046691895
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.868 Vali Acc: 0.312 Test Loss: 4.868 Test Acc: 0.312
Validation loss decreased (-0.308187 --> -0.311716).  Saving model ...
Epoch: 31 cost time: 0.5778608322143555
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.882 Vali Acc: 0.315 Test Loss: 4.882 Test Acc: 0.315
Validation loss decreased (-0.311716 --> -0.315245).  Saving model ...
Epoch: 32 cost time: 0.4445202350616455
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.894 Vali Acc: 0.312 Test Loss: 4.894 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5100860595703125
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.884 Vali Acc: 0.307 Test Loss: 4.884 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6211192607879639
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.908 Vali Acc: 0.308 Test Loss: 4.908 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.676316499710083
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.931 Vali Acc: 0.309 Test Loss: 4.931 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6199183464050293
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.952 Vali Acc: 0.309 Test Loss: 4.952 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.738541841506958
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.965 Vali Acc: 0.313 Test Loss: 4.965 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8412356376647949
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.968 Vali Acc: 0.314 Test Loss: 4.968 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.989832878112793
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.974 Vali Acc: 0.314 Test Loss: 4.974 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7255580425262451
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.973 Vali Acc: 0.314 Test Loss: 4.973 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5161855220794678
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.980 Vali Acc: 0.316 Test Loss: 4.980 Test Acc: 0.316
Validation loss decreased (-0.315245 --> -0.316421).  Saving model ...
Epoch: 42 cost time: 0.6690099239349365
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.996 Vali Acc: 0.315 Test Loss: 4.996 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6803431510925293
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.014 Vali Acc: 0.314 Test Loss: 5.014 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5843069553375244
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.024 Vali Acc: 0.316 Test Loss: 5.024 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5402975082397461
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.031 Vali Acc: 0.314 Test Loss: 5.031 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6727633476257324
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.031 Vali Acc: 0.319 Test Loss: 5.031 Test Acc: 0.319
Validation loss decreased (-0.316421 --> -0.318773).  Saving model ...
Epoch: 47 cost time: 0.49588441848754883
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.037 Vali Acc: 0.316 Test Loss: 5.037 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.47249341011047363
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.048 Vali Acc: 0.316 Test Loss: 5.048 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5070843696594238
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.066 Vali Acc: 0.315 Test Loss: 5.066 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5011751651763916
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.093 Vali Acc: 0.319 Test Loss: 5.093 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 29777690
model size : 128.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8721511363983154
Epoch: 1, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.324 Vali Acc: 0.044 Test Loss: 3.324 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.7241642475128174
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.314 Vali Acc: 0.039 Test Loss: 3.314 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5411946773529053
Epoch: 3, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.324 Vali Acc: 0.052 Test Loss: 3.324 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 0.6274378299713135
Epoch: 4, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.337 Vali Acc: 0.071 Test Loss: 3.337 Test Acc: 0.071
Validation loss decreased (-0.051731 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 0.6800398826599121
Epoch: 5, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.283 Vali Acc: 0.085 Test Loss: 3.283 Test Acc: 0.085
Validation loss decreased (-0.070555 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.492264986038208
Epoch: 6, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.248 Vali Acc: 0.113 Test Loss: 3.248 Test Acc: 0.113
Validation loss decreased (-0.084673 --> -0.112909).  Saving model ...
Epoch: 7 cost time: 0.5166440010070801
Epoch: 7, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.215 Vali Acc: 0.146 Test Loss: 3.215 Test Acc: 0.146
Validation loss decreased (-0.112909 --> -0.145850).  Saving model ...
Epoch: 8 cost time: 0.5693426132202148
Epoch: 8, Steps: 10 | Train Loss: 2.152 Vali Loss: 3.200 Vali Acc: 0.172 Test Loss: 3.200 Test Acc: 0.172
Validation loss decreased (-0.145850 --> -0.171733).  Saving model ...
Epoch: 9 cost time: 0.6214118003845215
Epoch: 9, Steps: 10 | Train Loss: 1.719 Vali Loss: 3.265 Vali Acc: 0.196 Test Loss: 3.265 Test Acc: 0.196
Validation loss decreased (-0.171733 --> -0.196438).  Saving model ...
Epoch: 10 cost time: 0.6368074417114258
Epoch: 10, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.368 Vali Acc: 0.218 Test Loss: 3.368 Test Acc: 0.218
Validation loss decreased (-0.196438 --> -0.217613).  Saving model ...
Epoch: 11 cost time: 0.6244382858276367
Epoch: 11, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.410 Vali Acc: 0.229 Test Loss: 3.410 Test Acc: 0.229
Validation loss decreased (-0.217613 --> -0.229378).  Saving model ...
Epoch: 12 cost time: 0.6259214878082275
Epoch: 12, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.564 Vali Acc: 0.253 Test Loss: 3.564 Test Acc: 0.253
Validation loss decreased (-0.229378 --> -0.252906).  Saving model ...
Epoch: 13 cost time: 0.5836148262023926
Epoch: 13, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.617 Vali Acc: 0.271 Test Loss: 3.617 Test Acc: 0.271
Validation loss decreased (-0.252906 --> -0.270552).  Saving model ...
Epoch: 14 cost time: 0.531728982925415
Epoch: 14, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.809 Vali Acc: 0.249 Test Loss: 3.809 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5795855522155762
Epoch: 15, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.852 Vali Acc: 0.268 Test Loss: 3.852 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8116943836212158
Epoch: 16, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.015 Vali Acc: 0.265 Test Loss: 4.015 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6876089572906494
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.093 Vali Acc: 0.271 Test Loss: 4.093 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7382738590240479
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.167 Vali Acc: 0.272 Test Loss: 4.167 Test Acc: 0.272
Validation loss decreased (-0.270552 --> -0.271723).  Saving model ...
Epoch: 19 cost time: 0.6646900177001953
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.242 Vali Acc: 0.272 Test Loss: 4.242 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5863637924194336
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.310 Vali Acc: 0.278 Test Loss: 4.310 Test Acc: 0.278
Validation loss decreased (-0.271723 --> -0.277604).  Saving model ...
Epoch: 21 cost time: 0.5505304336547852
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.325 Vali Acc: 0.293 Test Loss: 4.325 Test Acc: 0.293
Validation loss decreased (-0.277604 --> -0.292898).  Saving model ...
Epoch: 22 cost time: 0.5894210338592529
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.360 Vali Acc: 0.298 Test Loss: 4.360 Test Acc: 0.298
Validation loss decreased (-0.292898 --> -0.297603).  Saving model ...
Epoch: 23 cost time: 0.7912039756774902
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.393 Vali Acc: 0.288 Test Loss: 4.393 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6107053756713867
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.447 Vali Acc: 0.288 Test Loss: 4.447 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5710036754608154
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.470 Vali Acc: 0.293 Test Loss: 4.470 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7467706203460693
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.483 Vali Acc: 0.288 Test Loss: 4.483 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6650927066802979
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.504 Vali Acc: 0.291 Test Loss: 4.504 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6279997825622559
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.521 Vali Acc: 0.292 Test Loss: 4.521 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.614060640335083
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.552 Vali Acc: 0.291 Test Loss: 4.552 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6099531650543213
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.551 Vali Acc: 0.295 Test Loss: 4.551 Test Acc: 0.295
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5781199932098389
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.568 Vali Acc: 0.293 Test Loss: 4.568 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5779953002929688
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.587 Vali Acc: 0.294 Test Loss: 4.587 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 29605658
model size : 127.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2415404319763184
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.337 Vali Acc: 0.054 Test Loss: 3.337 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 0.652414083480835
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.314 Vali Acc: 0.051 Test Loss: 3.314 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5545384883880615
Epoch: 3, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.309 Vali Acc: 0.052 Test Loss: 3.309 Test Acc: 0.052
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5517158508300781
Epoch: 4, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.299 Vali Acc: 0.062 Test Loss: 3.299 Test Acc: 0.062
Validation loss decreased (-0.054084 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.6333198547363281
Epoch: 5, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.288 Vali Acc: 0.072 Test Loss: 3.288 Test Acc: 0.072
Validation loss decreased (-0.062320 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.549492359161377
Epoch: 6, Steps: 10 | Train Loss: 2.897 Vali Loss: 3.279 Vali Acc: 0.079 Test Loss: 3.279 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.5634381771087646
Epoch: 7, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.255 Vali Acc: 0.102 Test Loss: 3.255 Test Acc: 0.102
Validation loss decreased (-0.078791 --> -0.102320).  Saving model ...
Epoch: 8 cost time: 0.6313929557800293
Epoch: 8, Steps: 10 | Train Loss: 2.622 Vali Loss: 3.235 Vali Acc: 0.111 Test Loss: 3.235 Test Acc: 0.111
Validation loss decreased (-0.102320 --> -0.110556).  Saving model ...
Epoch: 9 cost time: 0.4786512851715088
Epoch: 9, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.239 Vali Acc: 0.134 Test Loss: 3.239 Test Acc: 0.134
Validation loss decreased (-0.110556 --> -0.134085).  Saving model ...
Epoch: 10 cost time: 0.4985010623931885
Epoch: 10, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.242 Vali Acc: 0.160 Test Loss: 3.242 Test Acc: 0.160
Validation loss decreased (-0.134085 --> -0.159968).  Saving model ...
Epoch: 11 cost time: 0.5439369678497314
Epoch: 11, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.265 Vali Acc: 0.188 Test Loss: 3.265 Test Acc: 0.188
Validation loss decreased (-0.159968 --> -0.188203).  Saving model ...
Epoch: 12 cost time: 0.5123822689056396
Epoch: 12, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.377 Vali Acc: 0.202 Test Loss: 3.377 Test Acc: 0.202
Validation loss decreased (-0.188203 --> -0.202319).  Saving model ...
Epoch: 13 cost time: 0.5088093280792236
Epoch: 13, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.355 Vali Acc: 0.227 Test Loss: 3.355 Test Acc: 0.227
Validation loss decreased (-0.202319 --> -0.227025).  Saving model ...
Epoch: 14 cost time: 0.5667588710784912
Epoch: 14, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.425 Vali Acc: 0.232 Test Loss: 3.425 Test Acc: 0.232
Validation loss decreased (-0.227025 --> -0.231730).  Saving model ...
Epoch: 15 cost time: 0.5703418254852295
Epoch: 15, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.503 Vali Acc: 0.245 Test Loss: 3.503 Test Acc: 0.245
Validation loss decreased (-0.231730 --> -0.244671).  Saving model ...
Epoch: 16 cost time: 0.6069488525390625
Epoch: 16, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.590 Vali Acc: 0.247 Test Loss: 3.590 Test Acc: 0.247
Validation loss decreased (-0.244671 --> -0.247023).  Saving model ...
Epoch: 17 cost time: 0.5931253433227539
Epoch: 17, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.694 Vali Acc: 0.251 Test Loss: 3.694 Test Acc: 0.251
Validation loss decreased (-0.247023 --> -0.250551).  Saving model ...
Epoch: 18 cost time: 0.5770368576049805
Epoch: 18, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.794 Vali Acc: 0.260 Test Loss: 3.794 Test Acc: 0.260
Validation loss decreased (-0.250551 --> -0.259962).  Saving model ...
Epoch: 19 cost time: 0.5384798049926758
Epoch: 19, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.883 Vali Acc: 0.260 Test Loss: 3.883 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5964345932006836
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.871 Vali Acc: 0.276 Test Loss: 3.871 Test Acc: 0.276
Validation loss decreased (-0.259962 --> -0.276432).  Saving model ...
Epoch: 21 cost time: 0.5101909637451172
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.964 Vali Acc: 0.276 Test Loss: 3.964 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5428411960601807
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.057 Vali Acc: 0.280 Test Loss: 4.057 Test Acc: 0.280
Validation loss decreased (-0.276432 --> -0.279959).  Saving model ...
Epoch: 23 cost time: 0.5946774482727051
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.072 Vali Acc: 0.281 Test Loss: 4.072 Test Acc: 0.281
Validation loss decreased (-0.279959 --> -0.281136).  Saving model ...
Epoch: 24 cost time: 0.6453456878662109
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.096 Vali Acc: 0.289 Test Loss: 4.096 Test Acc: 0.289
Validation loss decreased (-0.281136 --> -0.289371).  Saving model ...
Epoch: 25 cost time: 0.5279672145843506
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.141 Vali Acc: 0.281 Test Loss: 4.141 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5446999073028564
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.199 Vali Acc: 0.282 Test Loss: 4.199 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.45899295806884766
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.215 Vali Acc: 0.282 Test Loss: 4.215 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.43489503860473633
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.224 Vali Acc: 0.294 Test Loss: 4.224 Test Acc: 0.294
Validation loss decreased (-0.289371 --> -0.294075).  Saving model ...
Epoch: 29 cost time: 0.5979490280151367
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.244 Vali Acc: 0.293 Test Loss: 4.244 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6899738311767578
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.286 Vali Acc: 0.294 Test Loss: 4.286 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5494825839996338
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.338 Vali Acc: 0.287 Test Loss: 4.338 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6176636219024658
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.368 Vali Acc: 0.291 Test Loss: 4.368 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.49823784828186035
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.377 Vali Acc: 0.295 Test Loss: 4.377 Test Acc: 0.295
Validation loss decreased (-0.294075 --> -0.295250).  Saving model ...
Epoch: 34 cost time: 0.5380940437316895
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.371 Vali Acc: 0.295 Test Loss: 4.371 Test Acc: 0.295
Validation loss decreased (-0.295250 --> -0.295250).  Saving model ...
Epoch: 35 cost time: 0.51143479347229
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.376 Vali Acc: 0.301 Test Loss: 4.376 Test Acc: 0.301
Validation loss decreased (-0.295250 --> -0.301133).  Saving model ...
Epoch: 36 cost time: 0.5735278129577637
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.394 Vali Acc: 0.296 Test Loss: 4.394 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7352967262268066
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.421 Vali Acc: 0.295 Test Loss: 4.421 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6864981651306152
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.456 Vali Acc: 0.292 Test Loss: 4.456 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5039982795715332
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.474 Vali Acc: 0.291 Test Loss: 4.474 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5077273845672607
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.481 Vali Acc: 0.291 Test Loss: 4.481 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.49547576904296875
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.497 Vali Acc: 0.295 Test Loss: 4.497 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5287661552429199
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.508 Vali Acc: 0.299 Test Loss: 4.508 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5324084758758545
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.512 Vali Acc: 0.299 Test Loss: 4.512 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.555309534072876
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.537 Vali Acc: 0.299 Test Loss: 4.537 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5199241638183594
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.548 Vali Acc: 0.298 Test Loss: 4.548 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el4_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 29519642
model size : 127.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2687604427337646
Epoch: 1, Steps: 10 | Train Loss: 3.425 Vali Loss: 3.389 Vali Acc: 0.033 Test Loss: 3.389 Test Acc: 0.033
Validation loss decreased (inf --> -0.032907).  Saving model ...
Epoch: 2 cost time: 0.833021879196167
Epoch: 2, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.359 Vali Acc: 0.095 Test Loss: 3.359 Test Acc: 0.095
Validation loss decreased (-0.032907 --> -0.095261).  Saving model ...
Epoch: 3 cost time: 1.101369857788086
Epoch: 3, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.288 Vali Acc: 0.106 Test Loss: 3.288 Test Acc: 0.106
Validation loss decreased (-0.095261 --> -0.105849).  Saving model ...
Epoch: 4 cost time: 0.9514646530151367
Epoch: 4, Steps: 10 | Train Loss: 2.429 Vali Loss: 3.168 Vali Acc: 0.108 Test Loss: 3.168 Test Acc: 0.108
Validation loss decreased (-0.105849 --> -0.108204).  Saving model ...
Epoch: 5 cost time: 0.7603213787078857
Epoch: 5, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.298 Vali Acc: 0.164 Test Loss: 3.298 Test Acc: 0.164
Validation loss decreased (-0.108204 --> -0.163496).  Saving model ...
Epoch: 6 cost time: 0.9653000831604004
Epoch: 6, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.364 Vali Acc: 0.182 Test Loss: 3.364 Test Acc: 0.182
Validation loss decreased (-0.163496 --> -0.182319).  Saving model ...
Epoch: 7 cost time: 0.7661254405975342
Epoch: 7, Steps: 10 | Train Loss: 1.137 Vali Loss: 3.762 Vali Acc: 0.220 Test Loss: 3.762 Test Acc: 0.220
Validation loss decreased (-0.182319 --> -0.219962).  Saving model ...
Epoch: 8 cost time: 0.7183034420013428
Epoch: 8, Steps: 10 | Train Loss: 0.732 Vali Loss: 4.164 Vali Acc: 0.251 Test Loss: 4.164 Test Acc: 0.251
Validation loss decreased (-0.219962 --> -0.250547).  Saving model ...
Epoch: 9 cost time: 0.9952700138092041
Epoch: 9, Steps: 10 | Train Loss: 0.378 Vali Loss: 5.239 Vali Acc: 0.249 Test Loss: 5.239 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9011726379394531
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 5.938 Vali Acc: 0.231 Test Loss: 5.938 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7992050647735596
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 7.079 Vali Acc: 0.238 Test Loss: 7.079 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9635627269744873
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 7.674 Vali Acc: 0.220 Test Loss: 7.674 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9379432201385498
Epoch: 13, Steps: 10 | Train Loss: 0.127 Vali Loss: 7.545 Vali Acc: 0.247 Test Loss: 7.545 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.814042329788208
Epoch: 14, Steps: 10 | Train Loss: 0.125 Vali Loss: 7.639 Vali Acc: 0.265 Test Loss: 7.639 Test Acc: 0.265
Validation loss decreased (-0.250547 --> -0.264629).  Saving model ...
Epoch: 15 cost time: 0.837146520614624
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 8.304 Vali Acc: 0.236 Test Loss: 8.304 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7227070331573486
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 8.811 Vali Acc: 0.255 Test Loss: 8.811 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7880656719207764
Epoch: 17, Steps: 10 | Train Loss: 0.119 Vali Loss: 8.971 Vali Acc: 0.260 Test Loss: 8.971 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8498404026031494
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 8.793 Vali Acc: 0.255 Test Loss: 8.793 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.590681791305542
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 9.327 Vali Acc: 0.266 Test Loss: 9.327 Test Acc: 0.266
Validation loss decreased (-0.264629 --> -0.265789).  Saving model ...
Epoch: 20 cost time: 0.880192756652832
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 9.539 Vali Acc: 0.235 Test Loss: 9.539 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.869987964630127
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 9.452 Vali Acc: 0.229 Test Loss: 9.452 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.692418098449707
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 10.259 Vali Acc: 0.235 Test Loss: 10.259 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9627852439880371
Epoch: 23, Steps: 10 | Train Loss: 0.144 Vali Loss: 10.686 Vali Acc: 0.218 Test Loss: 10.686 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7507455348968506
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 9.710 Vali Acc: 0.256 Test Loss: 9.710 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9652109146118164
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 10.145 Vali Acc: 0.240 Test Loss: 10.145 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.749852180480957
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 10.582 Vali Acc: 0.242 Test Loss: 10.582 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7903645038604736
Epoch: 27, Steps: 10 | Train Loss: 0.212 Vali Loss: 12.234 Vali Acc: 0.218 Test Loss: 12.234 Test Acc: 0.218
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8484745025634766
Epoch: 28, Steps: 10 | Train Loss: 0.071 Vali Loss: 11.915 Vali Acc: 0.229 Test Loss: 11.915 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2709600925445557
Epoch: 29, Steps: 10 | Train Loss: 0.081 Vali Loss: 10.605 Vali Acc: 0.272 Test Loss: 10.605 Test Acc: 0.272
Validation loss decreased (-0.265789 --> -0.271659).  Saving model ...
Epoch: 30 cost time: 1.0595812797546387
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 11.064 Vali Acc: 0.242 Test Loss: 11.064 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7849946022033691
Epoch: 31, Steps: 10 | Train Loss: 0.039 Vali Loss: 11.962 Vali Acc: 0.233 Test Loss: 11.962 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0267164707183838
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 12.026 Vali Acc: 0.228 Test Loss: 12.026 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8212876319885254
Epoch: 33, Steps: 10 | Train Loss: 0.043 Vali Loss: 11.906 Vali Acc: 0.224 Test Loss: 11.906 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1207048892974854
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 11.895 Vali Acc: 0.245 Test Loss: 11.895 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8111507892608643
Epoch: 35, Steps: 10 | Train Loss: 0.029 Vali Loss: 12.601 Vali Acc: 0.260 Test Loss: 12.601 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.910529613494873
Epoch: 36, Steps: 10 | Train Loss: 0.151 Vali Loss: 12.766 Vali Acc: 0.239 Test Loss: 12.766 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8454489707946777
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 13.584 Vali Acc: 0.248 Test Loss: 13.584 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6828222274780273
Epoch: 38, Steps: 10 | Train Loss: 0.065 Vali Loss: 13.989 Vali Acc: 0.258 Test Loss: 13.989 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7542557716369629
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 14.300 Vali Acc: 0.253 Test Loss: 14.300 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 23749658
model size : 105.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.264439105987549
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.330 Vali Acc: 0.045 Test Loss: 3.330 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.6042609214782715
Epoch: 2, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.381 Vali Acc: 0.072 Test Loss: 3.381 Test Acc: 0.072
Validation loss decreased (-0.044673 --> -0.071731).  Saving model ...
Epoch: 3 cost time: 0.744330883026123
Epoch: 3, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.268 Vali Acc: 0.098 Test Loss: 3.268 Test Acc: 0.098
Validation loss decreased (-0.071731 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 0.7675230503082275
Epoch: 4, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.235 Vali Acc: 0.111 Test Loss: 3.235 Test Acc: 0.111
Validation loss decreased (-0.097614 --> -0.110556).  Saving model ...
Epoch: 5 cost time: 0.6445848941802979
Epoch: 5, Steps: 10 | Train Loss: 2.382 Vali Loss: 3.242 Vali Acc: 0.136 Test Loss: 3.242 Test Acc: 0.136
Validation loss decreased (-0.110556 --> -0.136438).  Saving model ...
Epoch: 6 cost time: 0.6788396835327148
Epoch: 6, Steps: 10 | Train Loss: 1.997 Vali Loss: 3.135 Vali Acc: 0.193 Test Loss: 3.135 Test Acc: 0.193
Validation loss decreased (-0.136438 --> -0.192910).  Saving model ...
Epoch: 7 cost time: 0.5138132572174072
Epoch: 7, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.358 Vali Acc: 0.182 Test Loss: 3.358 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5120716094970703
Epoch: 8, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.654 Vali Acc: 0.219 Test Loss: 3.654 Test Acc: 0.219
Validation loss decreased (-0.192910 --> -0.218787).  Saving model ...
Epoch: 9 cost time: 0.9048707485198975
Epoch: 9, Steps: 10 | Train Loss: 0.858 Vali Loss: 4.061 Vali Acc: 0.239 Test Loss: 4.061 Test Acc: 0.239
Validation loss decreased (-0.218787 --> -0.238783).  Saving model ...
Epoch: 10 cost time: 0.6728544235229492
Epoch: 10, Steps: 10 | Train Loss: 0.424 Vali Loss: 4.550 Vali Acc: 0.236 Test Loss: 4.550 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7334177494049072
Epoch: 11, Steps: 10 | Train Loss: 0.337 Vali Loss: 4.874 Vali Acc: 0.231 Test Loss: 4.874 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5884716510772705
Epoch: 12, Steps: 10 | Train Loss: 0.188 Vali Loss: 5.478 Vali Acc: 0.254 Test Loss: 5.478 Test Acc: 0.254
Validation loss decreased (-0.238783 --> -0.254063).  Saving model ...
Epoch: 13 cost time: 0.6777923107147217
Epoch: 13, Steps: 10 | Train Loss: 0.190 Vali Loss: 5.336 Vali Acc: 0.265 Test Loss: 5.336 Test Acc: 0.265
Validation loss decreased (-0.254063 --> -0.264653).  Saving model ...
Epoch: 14 cost time: 0.8994944095611572
Epoch: 14, Steps: 10 | Train Loss: 0.126 Vali Loss: 5.337 Vali Acc: 0.272 Test Loss: 5.337 Test Acc: 0.272
Validation loss decreased (-0.264653 --> -0.271711).  Saving model ...
Epoch: 15 cost time: 0.7626757621765137
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.753 Vali Acc: 0.294 Test Loss: 5.753 Test Acc: 0.294
Validation loss decreased (-0.271711 --> -0.294060).  Saving model ...
Epoch: 16 cost time: 0.791290283203125
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 6.083 Vali Acc: 0.272 Test Loss: 6.083 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6795394420623779
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.949 Vali Acc: 0.294 Test Loss: 5.949 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8464226722717285
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.793 Vali Acc: 0.302 Test Loss: 5.793 Test Acc: 0.302
Validation loss decreased (-0.294060 --> -0.302295).  Saving model ...
Epoch: 19 cost time: 0.6297140121459961
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.179 Vali Acc: 0.278 Test Loss: 6.179 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6091115474700928
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.408 Vali Acc: 0.275 Test Loss: 6.408 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5351309776306152
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.264 Vali Acc: 0.301 Test Loss: 6.264 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6210753917694092
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.387 Vali Acc: 0.294 Test Loss: 6.387 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6684858798980713
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.400 Vali Acc: 0.295 Test Loss: 6.400 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5785095691680908
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.311 Vali Acc: 0.299 Test Loss: 6.311 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0244688987731934
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.334 Vali Acc: 0.301 Test Loss: 6.334 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6082501411437988
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.352 Vali Acc: 0.300 Test Loss: 6.352 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6098532676696777
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.360 Vali Acc: 0.299 Test Loss: 6.360 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6415615081787109
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.398 Vali Acc: 0.300 Test Loss: 6.398 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 22975514
model size : 102.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7355523109436035
Epoch: 1, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.308 Vali Acc: 0.047 Test Loss: 3.308 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.6738874912261963
Epoch: 2, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.341 Vali Acc: 0.073 Test Loss: 3.341 Test Acc: 0.073
Validation loss decreased (-0.047026 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 0.7008693218231201
Epoch: 3, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.322 Vali Acc: 0.089 Test Loss: 3.322 Test Acc: 0.089
Validation loss decreased (-0.072908 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.5768992900848389
Epoch: 4, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.235 Vali Acc: 0.099 Test Loss: 3.235 Test Acc: 0.099
Validation loss decreased (-0.089379 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 0.6199436187744141
Epoch: 5, Steps: 10 | Train Loss: 2.549 Vali Loss: 3.196 Vali Acc: 0.119 Test Loss: 3.196 Test Acc: 0.119
Validation loss decreased (-0.098791 --> -0.118792).  Saving model ...
Epoch: 6 cost time: 0.7802362442016602
Epoch: 6, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.162 Vali Acc: 0.160 Test Loss: 3.162 Test Acc: 0.160
Validation loss decreased (-0.118792 --> -0.159968).  Saving model ...
Epoch: 7 cost time: 1.0652351379394531
Epoch: 7, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.168 Vali Acc: 0.159 Test Loss: 3.168 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5665640830993652
Epoch: 8, Steps: 10 | Train Loss: 1.664 Vali Loss: 3.237 Vali Acc: 0.196 Test Loss: 3.237 Test Acc: 0.196
Validation loss decreased (-0.159968 --> -0.196438).  Saving model ...
Epoch: 9 cost time: 0.6183936595916748
Epoch: 9, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.474 Vali Acc: 0.232 Test Loss: 3.474 Test Acc: 0.232
Validation loss decreased (-0.196438 --> -0.231730).  Saving model ...
Epoch: 10 cost time: 0.7700598239898682
Epoch: 10, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.671 Vali Acc: 0.240 Test Loss: 3.671 Test Acc: 0.240
Validation loss decreased (-0.231730 --> -0.239963).  Saving model ...
Epoch: 11 cost time: 0.7683923244476318
Epoch: 11, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.750 Vali Acc: 0.262 Test Loss: 3.750 Test Acc: 0.262
Validation loss decreased (-0.239963 --> -0.262315).  Saving model ...
Epoch: 12 cost time: 0.5796723365783691
Epoch: 12, Steps: 10 | Train Loss: 0.368 Vali Loss: 4.186 Vali Acc: 0.235 Test Loss: 4.186 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5446426868438721
Epoch: 13, Steps: 10 | Train Loss: 0.244 Vali Loss: 4.282 Vali Acc: 0.255 Test Loss: 4.282 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5213823318481445
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.390 Vali Acc: 0.268 Test Loss: 4.390 Test Acc: 0.268
Validation loss decreased (-0.262315 --> -0.268191).  Saving model ...
Epoch: 15 cost time: 0.5331127643585205
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.659 Vali Acc: 0.278 Test Loss: 4.659 Test Acc: 0.278
Validation loss decreased (-0.268191 --> -0.277600).  Saving model ...
Epoch: 16 cost time: 0.7741432189941406
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.908 Vali Acc: 0.281 Test Loss: 4.908 Test Acc: 0.281
Validation loss decreased (-0.277600 --> -0.281127).  Saving model ...
Epoch: 17 cost time: 0.6543631553649902
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.981 Vali Acc: 0.276 Test Loss: 4.981 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5580713748931885
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.970 Vali Acc: 0.288 Test Loss: 4.970 Test Acc: 0.288
Validation loss decreased (-0.281127 --> -0.288186).  Saving model ...
Epoch: 19 cost time: 0.47685885429382324
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.071 Vali Acc: 0.282 Test Loss: 5.071 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5169622898101807
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.034 Vali Acc: 0.288 Test Loss: 5.034 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9499435424804688
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.001 Vali Acc: 0.304 Test Loss: 5.001 Test Acc: 0.304
Validation loss decreased (-0.288186 --> -0.303479).  Saving model ...
Epoch: 22 cost time: 0.5398049354553223
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.108 Vali Acc: 0.302 Test Loss: 5.108 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6861944198608398
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.145 Vali Acc: 0.304 Test Loss: 5.145 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7563490867614746
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.134 Vali Acc: 0.299 Test Loss: 5.134 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7775838375091553
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.110 Vali Acc: 0.307 Test Loss: 5.110 Test Acc: 0.307
Validation loss decreased (-0.303479 --> -0.307008).  Saving model ...
Epoch: 26 cost time: 0.8844449520111084
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.127 Vali Acc: 0.307 Test Loss: 5.127 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8061602115631104
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.153 Vali Acc: 0.308 Test Loss: 5.153 Test Acc: 0.308
Validation loss decreased (-0.307008 --> -0.308184).  Saving model ...
Epoch: 28 cost time: 0.7807214260101318
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.161 Vali Acc: 0.305 Test Loss: 5.161 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7911767959594727
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.198 Vali Acc: 0.306 Test Loss: 5.198 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.680553674697876
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.233 Vali Acc: 0.302 Test Loss: 5.233 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8510735034942627
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.297 Vali Acc: 0.304 Test Loss: 5.297 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7945098876953125
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.260 Vali Acc: 0.307 Test Loss: 5.260 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8489444255828857
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.222 Vali Acc: 0.309 Test Loss: 5.222 Test Acc: 0.309
Validation loss decreased (-0.308184 --> -0.309360).  Saving model ...
Epoch: 34 cost time: 0.6178872585296631
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.223 Vali Acc: 0.307 Test Loss: 5.223 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5953946113586426
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.230 Vali Acc: 0.308 Test Loss: 5.230 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5773782730102539
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.232 Vali Acc: 0.308 Test Loss: 5.232 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5580117702484131
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.267 Vali Acc: 0.307 Test Loss: 5.267 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6119024753570557
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.302 Vali Acc: 0.307 Test Loss: 5.302 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6084840297698975
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.341 Vali Acc: 0.311 Test Loss: 5.341 Test Acc: 0.311
Validation loss decreased (-0.309360 --> -0.310535).  Saving model ...
Epoch: 40 cost time: 0.5829339027404785
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.355 Vali Acc: 0.308 Test Loss: 5.355 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.532231330871582
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.351 Vali Acc: 0.308 Test Loss: 5.351 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.918494701385498
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.322 Vali Acc: 0.314 Test Loss: 5.322 Test Acc: 0.314
Validation loss decreased (-0.310535 --> -0.314064).  Saving model ...
Epoch: 43 cost time: 0.5606513023376465
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.342 Vali Acc: 0.309 Test Loss: 5.342 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8831579685211182
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.389 Vali Acc: 0.306 Test Loss: 5.389 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5987124443054199
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.396 Vali Acc: 0.307 Test Loss: 5.396 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5448451042175293
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.375 Vali Acc: 0.313 Test Loss: 5.375 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5777864456176758
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.359 Vali Acc: 0.313 Test Loss: 5.359 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5304479598999023
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.369 Vali Acc: 0.311 Test Loss: 5.369 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5375072956085205
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.410 Vali Acc: 0.311 Test Loss: 5.410 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6250560283660889
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.427 Vali Acc: 0.309 Test Loss: 5.427 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 22631450
model size : 101.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.096062183380127
Epoch: 1, Steps: 10 | Train Loss: 3.495 Vali Loss: 3.362 Vali Acc: 0.055 Test Loss: 3.362 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.9655158519744873
Epoch: 2, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.382 Vali Acc: 0.067 Test Loss: 3.382 Test Acc: 0.067
Validation loss decreased (-0.055261 --> -0.067025).  Saving model ...
Epoch: 3 cost time: 1.066133737564087
Epoch: 3, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.219 Vali Acc: 0.102 Test Loss: 3.219 Test Acc: 0.102
Validation loss decreased (-0.067025 --> -0.102321).  Saving model ...
Epoch: 4 cost time: 1.00587797164917
Epoch: 4, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.254 Vali Acc: 0.148 Test Loss: 3.254 Test Acc: 0.148
Validation loss decreased (-0.102321 --> -0.148203).  Saving model ...
Epoch: 5 cost time: 0.9548709392547607
Epoch: 5, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.147 Vali Acc: 0.181 Test Loss: 3.147 Test Acc: 0.181
Validation loss decreased (-0.148203 --> -0.181145).  Saving model ...
Epoch: 6 cost time: 0.8040714263916016
Epoch: 6, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.305 Vali Acc: 0.193 Test Loss: 3.305 Test Acc: 0.193
Validation loss decreased (-0.181145 --> -0.192908).  Saving model ...
Epoch: 7 cost time: 0.7640945911407471
Epoch: 7, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.651 Vali Acc: 0.207 Test Loss: 3.651 Test Acc: 0.207
Validation loss decreased (-0.192908 --> -0.207022).  Saving model ...
Epoch: 8 cost time: 0.7924587726593018
Epoch: 8, Steps: 10 | Train Loss: 0.730 Vali Loss: 4.313 Vali Acc: 0.240 Test Loss: 4.313 Test Acc: 0.240
Validation loss decreased (-0.207022 --> -0.239957).  Saving model ...
Epoch: 9 cost time: 0.9112613201141357
Epoch: 9, Steps: 10 | Train Loss: 0.395 Vali Loss: 5.188 Vali Acc: 0.241 Test Loss: 5.188 Test Acc: 0.241
Validation loss decreased (-0.239957 --> -0.241125).  Saving model ...
Epoch: 10 cost time: 1.072911262512207
Epoch: 10, Steps: 10 | Train Loss: 0.382 Vali Loss: 5.581 Vali Acc: 0.256 Test Loss: 5.581 Test Acc: 0.256
Validation loss decreased (-0.241125 --> -0.256415).  Saving model ...
Epoch: 11 cost time: 1.1210658550262451
Epoch: 11, Steps: 10 | Train Loss: 0.163 Vali Loss: 6.456 Vali Acc: 0.264 Test Loss: 6.456 Test Acc: 0.264
Validation loss decreased (-0.256415 --> -0.263465).  Saving model ...
Epoch: 12 cost time: 0.7506768703460693
Epoch: 12, Steps: 10 | Train Loss: 0.287 Vali Loss: 6.665 Vali Acc: 0.255 Test Loss: 6.665 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9531128406524658
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 6.810 Vali Acc: 0.260 Test Loss: 6.810 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6236922740936279
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 7.320 Vali Acc: 0.253 Test Loss: 7.320 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.680081844329834
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 7.479 Vali Acc: 0.265 Test Loss: 7.479 Test Acc: 0.265
Validation loss decreased (-0.263465 --> -0.264631).  Saving model ...
Epoch: 16 cost time: 0.7275433540344238
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 8.638 Vali Acc: 0.229 Test Loss: 8.638 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7353396415710449
Epoch: 17, Steps: 10 | Train Loss: 0.094 Vali Loss: 9.104 Vali Acc: 0.242 Test Loss: 9.104 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3301060199737549
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 8.839 Vali Acc: 0.268 Test Loss: 8.839 Test Acc: 0.268
Validation loss decreased (-0.264631 --> -0.268147).  Saving model ...
Epoch: 19 cost time: 0.9757797718048096
Epoch: 19, Steps: 10 | Train Loss: 0.077 Vali Loss: 8.736 Vali Acc: 0.284 Test Loss: 8.736 Test Acc: 0.284
Validation loss decreased (-0.268147 --> -0.283442).  Saving model ...
Epoch: 20 cost time: 0.8933303356170654
Epoch: 20, Steps: 10 | Train Loss: 0.127 Vali Loss: 9.118 Vali Acc: 0.259 Test Loss: 9.118 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9090726375579834
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 10.809 Vali Acc: 0.232 Test Loss: 10.809 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1846661567687988
Epoch: 22, Steps: 10 | Train Loss: 0.105 Vali Loss: 10.449 Vali Acc: 0.267 Test Loss: 10.449 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8219985961914062
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 10.390 Vali Acc: 0.249 Test Loss: 10.390 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7492256164550781
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 10.552 Vali Acc: 0.261 Test Loss: 10.552 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6089997291564941
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 10.864 Vali Acc: 0.296 Test Loss: 10.864 Test Acc: 0.296
Validation loss decreased (-0.283442 --> -0.296362).  Saving model ...
Epoch: 26 cost time: 0.8846731185913086
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 12.321 Vali Acc: 0.265 Test Loss: 12.321 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9403650760650635
Epoch: 27, Steps: 10 | Train Loss: 0.135 Vali Loss: 11.694 Vali Acc: 0.274 Test Loss: 11.694 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1942791938781738
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 11.662 Vali Acc: 0.282 Test Loss: 11.662 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9911763668060303
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 12.847 Vali Acc: 0.234 Test Loss: 12.847 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9437978267669678
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 11.338 Vali Acc: 0.296 Test Loss: 11.338 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7798454761505127
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 11.809 Vali Acc: 0.299 Test Loss: 11.809 Test Acc: 0.299
Validation loss decreased (-0.296362 --> -0.298705).  Saving model ...
Epoch: 32 cost time: 0.9155368804931641
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 12.122 Vali Acc: 0.278 Test Loss: 12.122 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9455938339233398
Epoch: 33, Steps: 10 | Train Loss: 0.055 Vali Loss: 12.419 Vali Acc: 0.262 Test Loss: 12.419 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8924102783203125
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 12.621 Vali Acc: 0.252 Test Loss: 12.621 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7147862911224365
Epoch: 35, Steps: 10 | Train Loss: 0.066 Vali Loss: 12.338 Vali Acc: 0.282 Test Loss: 12.338 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7300117015838623
Epoch: 36, Steps: 10 | Train Loss: 0.178 Vali Loss: 13.504 Vali Acc: 0.248 Test Loss: 13.504 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7688717842102051
Epoch: 37, Steps: 10 | Train Loss: 0.025 Vali Loss: 13.142 Vali Acc: 0.232 Test Loss: 13.142 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8382456302642822
Epoch: 38, Steps: 10 | Train Loss: 0.121 Vali Loss: 12.594 Vali Acc: 0.227 Test Loss: 12.594 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8590438365936279
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 12.979 Vali Acc: 0.244 Test Loss: 12.979 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8330657482147217
Epoch: 40, Steps: 10 | Train Loss: 0.063 Vali Loss: 13.115 Vali Acc: 0.242 Test Loss: 13.115 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.923475980758667
Epoch: 41, Steps: 10 | Train Loss: 0.014 Vali Loss: 13.899 Vali Acc: 0.235 Test Loss: 13.899 Test Acc: 0.235
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 23756570
model size : 105.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1905477046966553
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.365 Vali Acc: 0.039 Test Loss: 3.365 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5733489990234375
Epoch: 2, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.400 Vali Acc: 0.078 Test Loss: 3.400 Test Acc: 0.078
Validation loss decreased (-0.038790 --> -0.077613).  Saving model ...
Epoch: 3 cost time: 0.6509113311767578
Epoch: 3, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.263 Vali Acc: 0.095 Test Loss: 3.263 Test Acc: 0.095
Validation loss decreased (-0.077613 --> -0.095261).  Saving model ...
Epoch: 4 cost time: 0.6515903472900391
Epoch: 4, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.291 Vali Acc: 0.112 Test Loss: 3.291 Test Acc: 0.112
Validation loss decreased (-0.095261 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 0.5322742462158203
Epoch: 5, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.165 Vali Acc: 0.133 Test Loss: 3.165 Test Acc: 0.133
Validation loss decreased (-0.111732 --> -0.132910).  Saving model ...
Epoch: 6 cost time: 0.5534591674804688
Epoch: 6, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.220 Vali Acc: 0.159 Test Loss: 3.220 Test Acc: 0.159
Validation loss decreased (-0.132910 --> -0.158791).  Saving model ...
Epoch: 7 cost time: 0.5810370445251465
Epoch: 7, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.252 Vali Acc: 0.198 Test Loss: 3.252 Test Acc: 0.198
Validation loss decreased (-0.158791 --> -0.197615).  Saving model ...
Epoch: 8 cost time: 0.5448434352874756
Epoch: 8, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.543 Vali Acc: 0.220 Test Loss: 3.543 Test Acc: 0.220
Validation loss decreased (-0.197615 --> -0.219965).  Saving model ...
Epoch: 9 cost time: 0.5635592937469482
Epoch: 9, Steps: 10 | Train Loss: 0.756 Vali Loss: 4.015 Vali Acc: 0.236 Test Loss: 4.015 Test Acc: 0.236
Validation loss decreased (-0.219965 --> -0.236430).  Saving model ...
Epoch: 10 cost time: 0.628049373626709
Epoch: 10, Steps: 10 | Train Loss: 0.501 Vali Loss: 4.500 Vali Acc: 0.256 Test Loss: 4.500 Test Acc: 0.256
Validation loss decreased (-0.236430 --> -0.256426).  Saving model ...
Epoch: 11 cost time: 0.6254863739013672
Epoch: 11, Steps: 10 | Train Loss: 0.279 Vali Loss: 4.575 Vali Acc: 0.273 Test Loss: 4.575 Test Acc: 0.273
Validation loss decreased (-0.256426 --> -0.272895).  Saving model ...
Epoch: 12 cost time: 0.6675019264221191
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.913 Vali Acc: 0.275 Test Loss: 4.913 Test Acc: 0.275
Validation loss decreased (-0.272895 --> -0.275245).  Saving model ...
Epoch: 13 cost time: 0.5717554092407227
Epoch: 13, Steps: 10 | Train Loss: 0.135 Vali Loss: 5.325 Vali Acc: 0.278 Test Loss: 5.325 Test Acc: 0.278
Validation loss decreased (-0.275245 --> -0.277594).  Saving model ...
Epoch: 14 cost time: 0.7062482833862305
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 5.383 Vali Acc: 0.259 Test Loss: 5.383 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8890199661254883
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.501 Vali Acc: 0.304 Test Loss: 5.501 Test Acc: 0.304
Validation loss decreased (-0.277594 --> -0.303474).  Saving model ...
Epoch: 16 cost time: 0.718104362487793
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.601 Vali Acc: 0.292 Test Loss: 5.601 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6302433013916016
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.910 Vali Acc: 0.293 Test Loss: 5.910 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5786426067352295
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.116 Vali Acc: 0.281 Test Loss: 6.116 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7097697257995605
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 6.050 Vali Acc: 0.291 Test Loss: 6.050 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8630802631378174
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 6.137 Vali Acc: 0.293 Test Loss: 6.137 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.631267786026001
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.155 Vali Acc: 0.298 Test Loss: 6.155 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6215667724609375
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.949 Vali Acc: 0.308 Test Loss: 5.949 Test Acc: 0.308
Validation loss decreased (-0.303474 --> -0.308176).  Saving model ...
Epoch: 23 cost time: 0.7419319152832031
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 6.328 Vali Acc: 0.298 Test Loss: 6.328 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6644630432128906
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.560 Vali Acc: 0.295 Test Loss: 6.560 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8924210071563721
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.456 Vali Acc: 0.299 Test Loss: 6.456 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8347277641296387
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.217 Vali Acc: 0.306 Test Loss: 6.217 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8152768611907959
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.140 Vali Acc: 0.313 Test Loss: 6.140 Test Acc: 0.313
Validation loss decreased (-0.308176 --> -0.312880).  Saving model ...
Epoch: 28 cost time: 0.6752185821533203
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.079 Vali Acc: 0.312 Test Loss: 6.079 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9294228553771973
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.055 Vali Acc: 0.321 Test Loss: 6.055 Test Acc: 0.321
Validation loss decreased (-0.312880 --> -0.321116).  Saving model ...
Epoch: 30 cost time: 0.9668374061584473
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.042 Vali Acc: 0.319 Test Loss: 6.042 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7770481109619141
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.037 Vali Acc: 0.319 Test Loss: 6.037 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6445150375366211
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.033 Vali Acc: 0.322 Test Loss: 6.033 Test Acc: 0.322
Validation loss decreased (-0.321116 --> -0.322293).  Saving model ...
Epoch: 33 cost time: 0.6303744316101074
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.034 Vali Acc: 0.321 Test Loss: 6.034 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6732916831970215
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.038 Vali Acc: 0.325 Test Loss: 6.038 Test Acc: 0.325
Validation loss decreased (-0.322293 --> -0.324645).  Saving model ...
Epoch: 35 cost time: 0.551520824432373
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.054 Vali Acc: 0.322 Test Loss: 6.054 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8994765281677246
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.054 Vali Acc: 0.321 Test Loss: 6.054 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6295855045318604
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.053 Vali Acc: 0.320 Test Loss: 6.053 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5850098133087158
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.093 Vali Acc: 0.322 Test Loss: 6.093 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6012330055236816
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.115 Vali Acc: 0.321 Test Loss: 6.115 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5919475555419922
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.124 Vali Acc: 0.319 Test Loss: 6.124 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6723988056182861
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.121 Vali Acc: 0.319 Test Loss: 6.121 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6183991432189941
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.155 Vali Acc: 0.315 Test Loss: 6.155 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8543283939361572
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.250 Vali Acc: 0.307 Test Loss: 6.250 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6165595054626465
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.190 Vali Acc: 0.318 Test Loss: 6.190 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 22982426
model size : 102.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.796349048614502
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.293 Vali Acc: 0.040 Test Loss: 3.293 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.5264801979064941
Epoch: 2, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.368 Vali Acc: 0.069 Test Loss: 3.368 Test Acc: 0.069
Validation loss decreased (-0.039967 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.965033769607544
Epoch: 3, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.341 Vali Acc: 0.086 Test Loss: 3.341 Test Acc: 0.086
Validation loss decreased (-0.069378 --> -0.085849).  Saving model ...
Epoch: 4 cost time: 0.7947704792022705
Epoch: 4, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.248 Vali Acc: 0.104 Test Loss: 3.248 Test Acc: 0.104
Validation loss decreased (-0.085849 --> -0.103497).  Saving model ...
Epoch: 5 cost time: 0.5595247745513916
Epoch: 5, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.211 Vali Acc: 0.119 Test Loss: 3.211 Test Acc: 0.119
Validation loss decreased (-0.103497 --> -0.118791).  Saving model ...
Epoch: 6 cost time: 0.7644939422607422
Epoch: 6, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.143 Vali Acc: 0.135 Test Loss: 3.143 Test Acc: 0.135
Validation loss decreased (-0.118791 --> -0.135263).  Saving model ...
Epoch: 7 cost time: 0.5505092144012451
Epoch: 7, Steps: 10 | Train Loss: 2.279 Vali Loss: 3.129 Vali Acc: 0.158 Test Loss: 3.129 Test Acc: 0.158
Validation loss decreased (-0.135263 --> -0.157616).  Saving model ...
Epoch: 8 cost time: 0.5359716415405273
Epoch: 8, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.153 Vali Acc: 0.201 Test Loss: 3.153 Test Acc: 0.201
Validation loss decreased (-0.157616 --> -0.201145).  Saving model ...
Epoch: 9 cost time: 0.5555117130279541
Epoch: 9, Steps: 10 | Train Loss: 1.474 Vali Loss: 3.328 Vali Acc: 0.211 Test Loss: 3.328 Test Acc: 0.211
Validation loss decreased (-0.201145 --> -0.210555).  Saving model ...
Epoch: 10 cost time: 0.6324307918548584
Epoch: 10, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.514 Vali Acc: 0.239 Test Loss: 3.514 Test Acc: 0.239
Validation loss decreased (-0.210555 --> -0.238788).  Saving model ...
Epoch: 11 cost time: 0.6774952411651611
Epoch: 11, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.684 Vali Acc: 0.244 Test Loss: 3.684 Test Acc: 0.244
Validation loss decreased (-0.238788 --> -0.243493).  Saving model ...
Epoch: 12 cost time: 0.6422171592712402
Epoch: 12, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.790 Vali Acc: 0.261 Test Loss: 3.790 Test Acc: 0.261
Validation loss decreased (-0.243493 --> -0.261139).  Saving model ...
Epoch: 13 cost time: 0.8043632507324219
Epoch: 13, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.944 Vali Acc: 0.268 Test Loss: 3.944 Test Acc: 0.268
Validation loss decreased (-0.261139 --> -0.268196).  Saving model ...
Epoch: 14 cost time: 0.6016747951507568
Epoch: 14, Steps: 10 | Train Loss: 0.215 Vali Loss: 4.269 Vali Acc: 0.262 Test Loss: 4.269 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8280537128448486
Epoch: 15, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.445 Vali Acc: 0.267 Test Loss: 4.445 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5475761890411377
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.494 Vali Acc: 0.286 Test Loss: 4.494 Test Acc: 0.286
Validation loss decreased (-0.268196 --> -0.285837).  Saving model ...
Epoch: 17 cost time: 0.6360139846801758
Epoch: 17, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.690 Vali Acc: 0.281 Test Loss: 4.690 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.43021416664123535
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.604 Vali Acc: 0.319 Test Loss: 4.604 Test Acc: 0.319
Validation loss decreased (-0.285837 --> -0.318777).  Saving model ...
Epoch: 19 cost time: 0.586829662322998
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.893 Vali Acc: 0.286 Test Loss: 4.893 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5962944030761719
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.782 Vali Acc: 0.307 Test Loss: 4.782 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4926607608795166
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.913 Vali Acc: 0.302 Test Loss: 4.913 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5242335796356201
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.966 Vali Acc: 0.301 Test Loss: 4.966 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7058918476104736
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.910 Vali Acc: 0.309 Test Loss: 4.910 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.544154167175293
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.859 Vali Acc: 0.321 Test Loss: 4.859 Test Acc: 0.321
Validation loss decreased (-0.318777 --> -0.321128).  Saving model ...
Epoch: 25 cost time: 0.5653660297393799
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.867 Vali Acc: 0.318 Test Loss: 4.867 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7009859085083008
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.856 Vali Acc: 0.312 Test Loss: 4.856 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.813774585723877
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.860 Vali Acc: 0.322 Test Loss: 4.860 Test Acc: 0.322
Validation loss decreased (-0.321128 --> -0.322304).  Saving model ...
Epoch: 28 cost time: 0.6585123538970947
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.862 Vali Acc: 0.329 Test Loss: 4.862 Test Acc: 0.329
Validation loss decreased (-0.322304 --> -0.329363).  Saving model ...
Epoch: 29 cost time: 0.7396299839019775
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.879 Vali Acc: 0.327 Test Loss: 4.879 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6162409782409668
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.898 Vali Acc: 0.331 Test Loss: 4.898 Test Acc: 0.331
Validation loss decreased (-0.329363 --> -0.330539).  Saving model ...
Epoch: 31 cost time: 0.8513388633728027
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.919 Vali Acc: 0.328 Test Loss: 4.919 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8564620018005371
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.926 Vali Acc: 0.327 Test Loss: 4.926 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9373269081115723
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.979 Vali Acc: 0.326 Test Loss: 4.979 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7037160396575928
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.023 Vali Acc: 0.320 Test Loss: 5.023 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5486311912536621
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.025 Vali Acc: 0.328 Test Loss: 5.025 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5572319030761719
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.013 Vali Acc: 0.326 Test Loss: 5.013 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5843844413757324
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.025 Vali Acc: 0.327 Test Loss: 5.025 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.940760612487793
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.033 Vali Acc: 0.326 Test Loss: 5.033 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5308523178100586
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.031 Vali Acc: 0.322 Test Loss: 5.031 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5577962398529053
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.034 Vali Acc: 0.324 Test Loss: 5.034 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 22595354
model size : 100.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.988471508026123
Epoch: 1, Steps: 10 | Train Loss: 3.393 Vali Loss: 3.367 Vali Acc: 0.051 Test Loss: 3.367 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.8140532970428467
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.391 Vali Acc: 0.089 Test Loss: 3.391 Test Acc: 0.089
Validation loss decreased (-0.050555 --> -0.089378).  Saving model ...
Epoch: 3 cost time: 0.9453768730163574
Epoch: 3, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.290 Vali Acc: 0.094 Test Loss: 3.290 Test Acc: 0.094
Validation loss decreased (-0.089378 --> -0.094085).  Saving model ...
Epoch: 4 cost time: 0.9123806953430176
Epoch: 4, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.228 Vali Acc: 0.121 Test Loss: 3.228 Test Acc: 0.121
Validation loss decreased (-0.094085 --> -0.121144).  Saving model ...
Epoch: 5 cost time: 0.813256025314331
Epoch: 5, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.150 Vali Acc: 0.142 Test Loss: 3.150 Test Acc: 0.142
Validation loss decreased (-0.121144 --> -0.142321).  Saving model ...
Epoch: 6 cost time: 0.7732028961181641
Epoch: 6, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.264 Vali Acc: 0.185 Test Loss: 3.264 Test Acc: 0.185
Validation loss decreased (-0.142321 --> -0.184673).  Saving model ...
Epoch: 7 cost time: 0.9214789867401123
Epoch: 7, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.437 Vali Acc: 0.184 Test Loss: 3.437 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6488711833953857
Epoch: 8, Steps: 10 | Train Loss: 0.988 Vali Loss: 3.868 Vali Acc: 0.241 Test Loss: 3.868 Test Acc: 0.241
Validation loss decreased (-0.184673 --> -0.241138).  Saving model ...
Epoch: 9 cost time: 0.5259897708892822
Epoch: 9, Steps: 10 | Train Loss: 0.549 Vali Loss: 4.343 Vali Acc: 0.246 Test Loss: 4.343 Test Acc: 0.246
Validation loss decreased (-0.241138 --> -0.245839).  Saving model ...
Epoch: 10 cost time: 0.6589937210083008
Epoch: 10, Steps: 10 | Train Loss: 0.354 Vali Loss: 5.509 Vali Acc: 0.207 Test Loss: 5.509 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8336598873138428
Epoch: 11, Steps: 10 | Train Loss: 0.427 Vali Loss: 5.174 Vali Acc: 0.266 Test Loss: 5.174 Test Acc: 0.266
Validation loss decreased (-0.245839 --> -0.265831).  Saving model ...
Epoch: 12 cost time: 0.7706940174102783
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 5.675 Vali Acc: 0.256 Test Loss: 5.675 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5463762283325195
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 6.184 Vali Acc: 0.274 Test Loss: 6.184 Test Acc: 0.274
Validation loss decreased (-0.265831 --> -0.274056).  Saving model ...
Epoch: 14 cost time: 0.8049149513244629
Epoch: 14, Steps: 10 | Train Loss: 0.173 Vali Loss: 6.736 Vali Acc: 0.244 Test Loss: 6.736 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6513266563415527
Epoch: 15, Steps: 10 | Train Loss: 0.117 Vali Loss: 7.029 Vali Acc: 0.259 Test Loss: 7.029 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6598482131958008
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 6.791 Vali Acc: 0.271 Test Loss: 6.791 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7040994167327881
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 6.649 Vali Acc: 0.281 Test Loss: 6.649 Test Acc: 0.281
Validation loss decreased (-0.274056 --> -0.281110).  Saving model ...
Epoch: 18 cost time: 0.6826958656311035
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.745 Vali Acc: 0.286 Test Loss: 6.745 Test Acc: 0.286
Validation loss decreased (-0.281110 --> -0.285815).  Saving model ...
Epoch: 19 cost time: 0.7829105854034424
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.983 Vali Acc: 0.276 Test Loss: 6.983 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6217656135559082
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.992 Vali Acc: 0.294 Test Loss: 6.992 Test Acc: 0.294
Validation loss decreased (-0.285815 --> -0.294048).  Saving model ...
Epoch: 21 cost time: 0.5423400402069092
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.951 Vali Acc: 0.304 Test Loss: 6.951 Test Acc: 0.304
Validation loss decreased (-0.294048 --> -0.303460).  Saving model ...
Epoch: 22 cost time: 0.7272655963897705
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.902 Vali Acc: 0.309 Test Loss: 6.902 Test Acc: 0.309
Validation loss decreased (-0.303460 --> -0.309343).  Saving model ...
Epoch: 23 cost time: 0.8578357696533203
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.840 Vali Acc: 0.312 Test Loss: 6.840 Test Acc: 0.312
Validation loss decreased (-0.309343 --> -0.311696).  Saving model ...
Epoch: 24 cost time: 0.9826440811157227
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.851 Vali Acc: 0.313 Test Loss: 6.851 Test Acc: 0.313
Validation loss decreased (-0.311696 --> -0.312873).  Saving model ...
Epoch: 25 cost time: 1.1267318725585938
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.881 Vali Acc: 0.315 Test Loss: 6.881 Test Acc: 0.315
Validation loss decreased (-0.312873 --> -0.315225).  Saving model ...
Epoch: 26 cost time: 0.6643738746643066
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.894 Vali Acc: 0.319 Test Loss: 6.894 Test Acc: 0.319
Validation loss decreased (-0.315225 --> -0.318755).  Saving model ...
Epoch: 27 cost time: 0.7416114807128906
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.899 Vali Acc: 0.314 Test Loss: 6.899 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9934906959533691
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.914 Vali Acc: 0.313 Test Loss: 6.914 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7625775337219238
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.926 Vali Acc: 0.315 Test Loss: 6.926 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7845122814178467
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.923 Vali Acc: 0.315 Test Loss: 6.923 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.544543981552124
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.917 Vali Acc: 0.318 Test Loss: 6.917 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9338276386260986
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.910 Vali Acc: 0.320 Test Loss: 6.910 Test Acc: 0.320
Validation loss decreased (-0.318755 --> -0.319931).  Saving model ...
Epoch: 33 cost time: 0.8941984176635742
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.908 Vali Acc: 0.321 Test Loss: 6.908 Test Acc: 0.321
Validation loss decreased (-0.319931 --> -0.321107).  Saving model ...
Epoch: 34 cost time: 0.5821621417999268
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.901 Vali Acc: 0.324 Test Loss: 6.901 Test Acc: 0.324
Validation loss decreased (-0.321107 --> -0.323460).  Saving model ...
Epoch: 35 cost time: 1.088566541671753
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.902 Vali Acc: 0.325 Test Loss: 6.902 Test Acc: 0.325
Validation loss decreased (-0.323460 --> -0.324637).  Saving model ...
Epoch: 36 cost time: 0.7815306186676025
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.904 Vali Acc: 0.326 Test Loss: 6.904 Test Acc: 0.326
Validation loss decreased (-0.324637 --> -0.325813).  Saving model ...
Epoch: 37 cost time: 0.5470585823059082
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.901 Vali Acc: 0.325 Test Loss: 6.901 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7691233158111572
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.886 Vali Acc: 0.324 Test Loss: 6.886 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6969215869903564
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.876 Vali Acc: 0.324 Test Loss: 6.876 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6988580226898193
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.873 Vali Acc: 0.322 Test Loss: 6.873 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.658358097076416
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.873 Vali Acc: 0.324 Test Loss: 6.873 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0388050079345703
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.894 Vali Acc: 0.324 Test Loss: 6.894 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6424956321716309
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.919 Vali Acc: 0.324 Test Loss: 6.919 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7390584945678711
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.917 Vali Acc: 0.322 Test Loss: 6.917 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7361302375793457
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.922 Vali Acc: 0.321 Test Loss: 6.922 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.9305298328399658
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.928 Vali Acc: 0.320 Test Loss: 6.928 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 23225882
model size : 103.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.383384943008423
Epoch: 1, Steps: 10 | Train Loss: 3.440 Vali Loss: 3.334 Vali Acc: 0.046 Test Loss: 3.334 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.617171049118042
Epoch: 2, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.385 Vali Acc: 0.074 Test Loss: 3.385 Test Acc: 0.074
Validation loss decreased (-0.045849 --> -0.074084).  Saving model ...
Epoch: 3 cost time: 0.6378159523010254
Epoch: 3, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.299 Vali Acc: 0.106 Test Loss: 3.299 Test Acc: 0.106
Validation loss decreased (-0.074084 --> -0.105849).  Saving model ...
Epoch: 4 cost time: 0.5709042549133301
Epoch: 4, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.252 Vali Acc: 0.116 Test Loss: 3.252 Test Acc: 0.116
Validation loss decreased (-0.105849 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.7036058902740479
Epoch: 5, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.215 Vali Acc: 0.126 Test Loss: 3.215 Test Acc: 0.126
Validation loss decreased (-0.116438 --> -0.125850).  Saving model ...
Epoch: 6 cost time: 0.6588757038116455
Epoch: 6, Steps: 10 | Train Loss: 2.161 Vali Loss: 3.192 Vali Acc: 0.154 Test Loss: 3.192 Test Acc: 0.154
Validation loss decreased (-0.125850 --> -0.154086).  Saving model ...
Epoch: 7 cost time: 0.7841525077819824
Epoch: 7, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.173 Vali Acc: 0.196 Test Loss: 3.173 Test Acc: 0.196
Validation loss decreased (-0.154086 --> -0.196439).  Saving model ...
Epoch: 8 cost time: 0.5816938877105713
Epoch: 8, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.408 Vali Acc: 0.225 Test Loss: 3.408 Test Acc: 0.225
Validation loss decreased (-0.196439 --> -0.224672).  Saving model ...
Epoch: 9 cost time: 0.7091186046600342
Epoch: 9, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.848 Vali Acc: 0.221 Test Loss: 3.848 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5433855056762695
Epoch: 10, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.943 Vali Acc: 0.273 Test Loss: 3.943 Test Acc: 0.273
Validation loss decreased (-0.224672 --> -0.272902).  Saving model ...
Epoch: 11 cost time: 1.0251927375793457
Epoch: 11, Steps: 10 | Train Loss: 0.355 Vali Loss: 4.574 Vali Acc: 0.244 Test Loss: 4.574 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.561617374420166
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 4.494 Vali Acc: 0.274 Test Loss: 4.494 Test Acc: 0.274
Validation loss decreased (-0.272902 --> -0.274073).  Saving model ...
Epoch: 13 cost time: 0.886488676071167
Epoch: 13, Steps: 10 | Train Loss: 0.186 Vali Loss: 4.934 Vali Acc: 0.271 Test Loss: 4.934 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5562481880187988
Epoch: 14, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.927 Vali Acc: 0.287 Test Loss: 4.927 Test Acc: 0.287
Validation loss decreased (-0.274073 --> -0.287010).  Saving model ...
Epoch: 15 cost time: 0.5586676597595215
Epoch: 15, Steps: 10 | Train Loss: 0.108 Vali Loss: 5.199 Vali Acc: 0.286 Test Loss: 5.199 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5425536632537842
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.511 Vali Acc: 0.271 Test Loss: 5.511 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8510398864746094
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.553 Vali Acc: 0.272 Test Loss: 5.553 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5933575630187988
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.495 Vali Acc: 0.304 Test Loss: 5.495 Test Acc: 0.304
Validation loss decreased (-0.287010 --> -0.303474).  Saving model ...
Epoch: 19 cost time: 0.6774692535400391
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.606 Vali Acc: 0.305 Test Loss: 5.606 Test Acc: 0.305
Validation loss decreased (-0.303474 --> -0.304650).  Saving model ...
Epoch: 20 cost time: 0.6478960514068604
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.611 Vali Acc: 0.308 Test Loss: 5.611 Test Acc: 0.308
Validation loss decreased (-0.304650 --> -0.308179).  Saving model ...
Epoch: 21 cost time: 0.5920369625091553
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.461 Vali Acc: 0.313 Test Loss: 5.461 Test Acc: 0.313
Validation loss decreased (-0.308179 --> -0.312887).  Saving model ...
Epoch: 22 cost time: 0.5665452480316162
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.483 Vali Acc: 0.307 Test Loss: 5.483 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5275814533233643
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.579 Vali Acc: 0.305 Test Loss: 5.579 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6502342224121094
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.575 Vali Acc: 0.302 Test Loss: 5.575 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6204867362976074
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.553 Vali Acc: 0.309 Test Loss: 5.553 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5575413703918457
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.525 Vali Acc: 0.314 Test Loss: 5.525 Test Acc: 0.314
Validation loss decreased (-0.312887 --> -0.314062).  Saving model ...
Epoch: 27 cost time: 0.6228747367858887
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.527 Vali Acc: 0.311 Test Loss: 5.527 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6663498878479004
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.547 Vali Acc: 0.313 Test Loss: 5.547 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8098316192626953
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.555 Vali Acc: 0.309 Test Loss: 5.555 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.833336353302002
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.565 Vali Acc: 0.309 Test Loss: 5.565 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8098456859588623
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.599 Vali Acc: 0.311 Test Loss: 5.599 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5987496376037598
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.629 Vali Acc: 0.313 Test Loss: 5.629 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5814366340637207
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.627 Vali Acc: 0.309 Test Loss: 5.627 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5926461219787598
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.624 Vali Acc: 0.312 Test Loss: 5.624 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5825271606445312
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.629 Vali Acc: 0.312 Test Loss: 5.629 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7408878803253174
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.628 Vali Acc: 0.315 Test Loss: 5.628 Test Acc: 0.315
Validation loss decreased (-0.314062 --> -0.315238).  Saving model ...
Epoch: 37 cost time: 0.5262069702148438
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.633 Vali Acc: 0.316 Test Loss: 5.633 Test Acc: 0.316
Validation loss decreased (-0.315238 --> -0.316414).  Saving model ...
Epoch: 38 cost time: 0.5494289398193359
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.637 Vali Acc: 0.318 Test Loss: 5.637 Test Acc: 0.318
Validation loss decreased (-0.316414 --> -0.317591).  Saving model ...
Epoch: 39 cost time: 0.617556095123291
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.653 Vali Acc: 0.318 Test Loss: 5.653 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8845250606536865
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.687 Vali Acc: 0.320 Test Loss: 5.687 Test Acc: 0.320
Validation loss decreased (-0.317591 --> -0.319943).  Saving model ...
Epoch: 41 cost time: 0.8463497161865234
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.706 Vali Acc: 0.319 Test Loss: 5.706 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8727595806121826
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.708 Vali Acc: 0.321 Test Loss: 5.708 Test Acc: 0.321
Validation loss decreased (-0.319943 --> -0.321119).  Saving model ...
Epoch: 43 cost time: 0.764427661895752
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.702 Vali Acc: 0.318 Test Loss: 5.702 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5725204944610596
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.732 Vali Acc: 0.314 Test Loss: 5.732 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5492019653320312
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.741 Vali Acc: 0.315 Test Loss: 5.741 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5750598907470703
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.752 Vali Acc: 0.312 Test Loss: 5.752 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5922212600708008
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.759 Vali Acc: 0.316 Test Loss: 5.759 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6784548759460449
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.761 Vali Acc: 0.316 Test Loss: 5.761 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.572587251663208
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.750 Vali Acc: 0.315 Test Loss: 5.750 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6883447170257568
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.756 Vali Acc: 0.315 Test Loss: 5.756 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 22817306
model size : 101.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6962132453918457
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.338 Vali Acc: 0.055 Test Loss: 3.338 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.7457921504974365
Epoch: 2, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.345 Vali Acc: 0.056 Test Loss: 3.345 Test Acc: 0.056
Validation loss decreased (-0.055261 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 1.090381383895874
Epoch: 3, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.334 Vali Acc: 0.066 Test Loss: 3.334 Test Acc: 0.066
Validation loss decreased (-0.056437 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.6087934970855713
Epoch: 4, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.281 Vali Acc: 0.082 Test Loss: 3.281 Test Acc: 0.082
Validation loss decreased (-0.065849 --> -0.082320).  Saving model ...
Epoch: 5 cost time: 0.6399645805358887
Epoch: 5, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.237 Vali Acc: 0.091 Test Loss: 3.237 Test Acc: 0.091
Validation loss decreased (-0.082320 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 0.5584173202514648
Epoch: 6, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.206 Vali Acc: 0.122 Test Loss: 3.206 Test Acc: 0.122
Validation loss decreased (-0.090556 --> -0.122321).  Saving model ...
Epoch: 7 cost time: 0.5726349353790283
Epoch: 7, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.160 Vali Acc: 0.134 Test Loss: 3.160 Test Acc: 0.134
Validation loss decreased (-0.122321 --> -0.134086).  Saving model ...
Epoch: 8 cost time: 0.5571913719177246
Epoch: 8, Steps: 10 | Train Loss: 2.017 Vali Loss: 3.190 Vali Acc: 0.173 Test Loss: 3.190 Test Acc: 0.173
Validation loss decreased (-0.134086 --> -0.172909).  Saving model ...
Epoch: 9 cost time: 0.6134448051452637
Epoch: 9, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.243 Vali Acc: 0.206 Test Loss: 3.243 Test Acc: 0.206
Validation loss decreased (-0.172909 --> -0.205850).  Saving model ...
Epoch: 10 cost time: 0.8632256984710693
Epoch: 10, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.454 Vali Acc: 0.218 Test Loss: 3.454 Test Acc: 0.218
Validation loss decreased (-0.205850 --> -0.217613).  Saving model ...
Epoch: 11 cost time: 0.48535609245300293
Epoch: 11, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.593 Vali Acc: 0.235 Test Loss: 3.593 Test Acc: 0.235
Validation loss decreased (-0.217613 --> -0.235258).  Saving model ...
Epoch: 12 cost time: 0.7929873466491699
Epoch: 12, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.802 Vali Acc: 0.266 Test Loss: 3.802 Test Acc: 0.266
Validation loss decreased (-0.235258 --> -0.265844).  Saving model ...
Epoch: 13 cost time: 0.4734654426574707
Epoch: 13, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.851 Vali Acc: 0.256 Test Loss: 3.851 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.500816822052002
Epoch: 14, Steps: 10 | Train Loss: 0.223 Vali Loss: 4.214 Vali Acc: 0.275 Test Loss: 4.214 Test Acc: 0.275
Validation loss decreased (-0.265844 --> -0.275252).  Saving model ...
Epoch: 15 cost time: 0.7838950157165527
Epoch: 15, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.331 Vali Acc: 0.269 Test Loss: 4.331 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6038708686828613
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.349 Vali Acc: 0.299 Test Loss: 4.349 Test Acc: 0.299
Validation loss decreased (-0.275252 --> -0.298780).  Saving model ...
Epoch: 17 cost time: 0.5344114303588867
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.532 Vali Acc: 0.289 Test Loss: 4.532 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5818500518798828
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.573 Vali Acc: 0.288 Test Loss: 4.573 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8906805515289307
Epoch: 19, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.717 Vali Acc: 0.298 Test Loss: 4.717 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5214085578918457
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.960 Vali Acc: 0.272 Test Loss: 4.960 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5515210628509521
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.945 Vali Acc: 0.282 Test Loss: 4.945 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5554788112640381
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.891 Vali Acc: 0.284 Test Loss: 4.891 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5848679542541504
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.940 Vali Acc: 0.281 Test Loss: 4.940 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.841416597366333
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.947 Vali Acc: 0.292 Test Loss: 4.947 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8399443626403809
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.874 Vali Acc: 0.287 Test Loss: 4.874 Test Acc: 0.287
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0708537101745605
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.895 Vali Acc: 0.295 Test Loss: 4.895 Test Acc: 0.295
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 22537754
model size : 100.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.060231924057007
Epoch: 1, Steps: 10 | Train Loss: 3.443 Vali Loss: 3.368 Vali Acc: 0.056 Test Loss: 3.368 Test Acc: 0.056
Validation loss decreased (inf --> -0.056437).  Saving model ...
Epoch: 2 cost time: 0.7599341869354248
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.375 Vali Acc: 0.079 Test Loss: 3.375 Test Acc: 0.079
Validation loss decreased (-0.056437 --> -0.078790).  Saving model ...
Epoch: 3 cost time: 1.0538034439086914
Epoch: 3, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.275 Vali Acc: 0.080 Test Loss: 3.275 Test Acc: 0.080
Validation loss decreased (-0.078790 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 0.7071182727813721
Epoch: 4, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.198 Vali Acc: 0.135 Test Loss: 3.198 Test Acc: 0.135
Validation loss decreased (-0.079967 --> -0.135262).  Saving model ...
Epoch: 5 cost time: 0.7066707611083984
Epoch: 5, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.169 Vali Acc: 0.155 Test Loss: 3.169 Test Acc: 0.155
Validation loss decreased (-0.135262 --> -0.155262).  Saving model ...
Epoch: 6 cost time: 0.8787841796875
Epoch: 6, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.144 Vali Acc: 0.193 Test Loss: 3.144 Test Acc: 0.193
Validation loss decreased (-0.155262 --> -0.192910).  Saving model ...
Epoch: 7 cost time: 0.6394045352935791
Epoch: 7, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.352 Vali Acc: 0.211 Test Loss: 3.352 Test Acc: 0.211
Validation loss decreased (-0.192910 --> -0.210555).  Saving model ...
Epoch: 8 cost time: 0.7763800621032715
Epoch: 8, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.940 Vali Acc: 0.212 Test Loss: 3.940 Test Acc: 0.212
Validation loss decreased (-0.210555 --> -0.211725).  Saving model ...
Epoch: 9 cost time: 0.6881887912750244
Epoch: 9, Steps: 10 | Train Loss: 0.666 Vali Loss: 4.449 Vali Acc: 0.232 Test Loss: 4.449 Test Acc: 0.232
Validation loss decreased (-0.211725 --> -0.231720).  Saving model ...
Epoch: 10 cost time: 0.867760181427002
Epoch: 10, Steps: 10 | Train Loss: 0.284 Vali Loss: 5.350 Vali Acc: 0.227 Test Loss: 5.350 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6433656215667725
Epoch: 11, Steps: 10 | Train Loss: 0.236 Vali Loss: 5.216 Vali Acc: 0.266 Test Loss: 5.216 Test Acc: 0.266
Validation loss decreased (-0.231720 --> -0.265830).  Saving model ...
Epoch: 12 cost time: 0.9067566394805908
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 5.721 Vali Acc: 0.239 Test Loss: 5.721 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.079538345336914
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 6.265 Vali Acc: 0.236 Test Loss: 6.265 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6835863590240479
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.015 Vali Acc: 0.282 Test Loss: 6.015 Test Acc: 0.282
Validation loss decreased (-0.265830 --> -0.282293).  Saving model ...
Epoch: 15 cost time: 0.6714839935302734
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.811 Vali Acc: 0.266 Test Loss: 6.811 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8196597099304199
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.813 Vali Acc: 0.274 Test Loss: 6.813 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8066003322601318
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 6.898 Vali Acc: 0.298 Test Loss: 6.898 Test Acc: 0.298
Validation loss decreased (-0.282293 --> -0.297578).  Saving model ...
Epoch: 18 cost time: 0.6836555004119873
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.916 Vali Acc: 0.311 Test Loss: 6.916 Test Acc: 0.311
Validation loss decreased (-0.297578 --> -0.310519).  Saving model ...
Epoch: 19 cost time: 0.8002703189849854
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 6.967 Vali Acc: 0.308 Test Loss: 6.967 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6960017681121826
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.508 Vali Acc: 0.296 Test Loss: 7.508 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7307889461517334
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.712 Vali Acc: 0.295 Test Loss: 7.712 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7941005229949951
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 7.839 Vali Acc: 0.312 Test Loss: 7.839 Test Acc: 0.312
Validation loss decreased (-0.310519 --> -0.311686).  Saving model ...
Epoch: 23 cost time: 1.0886499881744385
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.044 Vali Acc: 0.298 Test Loss: 8.044 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6944105625152588
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 7.594 Vali Acc: 0.314 Test Loss: 7.594 Test Acc: 0.314
Validation loss decreased (-0.311686 --> -0.314042).  Saving model ...
Epoch: 25 cost time: 0.8263280391693115
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.419 Vali Acc: 0.319 Test Loss: 7.419 Test Acc: 0.319
Validation loss decreased (-0.314042 --> -0.318749).  Saving model ...
Epoch: 26 cost time: 0.7143917083740234
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.414 Vali Acc: 0.315 Test Loss: 7.414 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7091720104217529
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.424 Vali Acc: 0.314 Test Loss: 7.424 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6816563606262207
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.423 Vali Acc: 0.320 Test Loss: 7.423 Test Acc: 0.320
Validation loss decreased (-0.318749 --> -0.319926).  Saving model ...
Epoch: 29 cost time: 0.8809716701507568
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.430 Vali Acc: 0.315 Test Loss: 7.430 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8228363990783691
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.435 Vali Acc: 0.319 Test Loss: 7.435 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7595269680023193
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.439 Vali Acc: 0.319 Test Loss: 7.439 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8531839847564697
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.442 Vali Acc: 0.319 Test Loss: 7.442 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.192976474761963
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.442 Vali Acc: 0.319 Test Loss: 7.442 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8967704772949219
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.451 Vali Acc: 0.318 Test Loss: 7.451 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6006252765655518
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.461 Vali Acc: 0.318 Test Loss: 7.461 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9865882396697998
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.469 Vali Acc: 0.319 Test Loss: 7.469 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.206993818283081
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.491 Vali Acc: 0.314 Test Loss: 7.491 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9196724891662598
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.441 Vali Acc: 0.320 Test Loss: 7.441 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 23232794
model size : 103.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6088244915008545
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.325 Vali Acc: 0.035 Test Loss: 3.325 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.7532684803009033
Epoch: 2, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.384 Vali Acc: 0.061 Test Loss: 3.384 Test Acc: 0.061
Validation loss decreased (-0.035261 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.992133617401123
Epoch: 3, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.344 Vali Acc: 0.073 Test Loss: 3.344 Test Acc: 0.073
Validation loss decreased (-0.061143 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.7874267101287842
Epoch: 4, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.244 Vali Acc: 0.129 Test Loss: 3.244 Test Acc: 0.129
Validation loss decreased (-0.072908 --> -0.129379).  Saving model ...
Epoch: 5 cost time: 0.6933066844940186
Epoch: 5, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.211 Vali Acc: 0.126 Test Loss: 3.211 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6536285877227783
Epoch: 6, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.168 Vali Acc: 0.158 Test Loss: 3.168 Test Acc: 0.158
Validation loss decreased (-0.129379 --> -0.157615).  Saving model ...
Epoch: 7 cost time: 0.7703711986541748
Epoch: 7, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.251 Vali Acc: 0.191 Test Loss: 3.251 Test Acc: 0.191
Validation loss decreased (-0.157615 --> -0.190556).  Saving model ...
Epoch: 8 cost time: 0.8678591251373291
Epoch: 8, Steps: 10 | Train Loss: 1.300 Vali Loss: 3.482 Vali Acc: 0.218 Test Loss: 3.482 Test Acc: 0.218
Validation loss decreased (-0.190556 --> -0.217612).  Saving model ...
Epoch: 9 cost time: 0.7506341934204102
Epoch: 9, Steps: 10 | Train Loss: 1.034 Vali Loss: 3.586 Vali Acc: 0.239 Test Loss: 3.586 Test Acc: 0.239
Validation loss decreased (-0.217612 --> -0.238788).  Saving model ...
Epoch: 10 cost time: 0.6867859363555908
Epoch: 10, Steps: 10 | Train Loss: 0.581 Vali Loss: 4.158 Vali Acc: 0.266 Test Loss: 4.158 Test Acc: 0.266
Validation loss decreased (-0.238788 --> -0.265841).  Saving model ...
Epoch: 11 cost time: 0.7203242778778076
Epoch: 11, Steps: 10 | Train Loss: 0.326 Vali Loss: 4.526 Vali Acc: 0.226 Test Loss: 4.526 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5257055759429932
Epoch: 12, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.409 Vali Acc: 0.298 Test Loss: 4.409 Test Acc: 0.298
Validation loss decreased (-0.265841 --> -0.297603).  Saving model ...
Epoch: 13 cost time: 0.6608710289001465
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 5.093 Vali Acc: 0.271 Test Loss: 5.093 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6409366130828857
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.978 Vali Acc: 0.285 Test Loss: 4.978 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6730926036834717
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.098 Vali Acc: 0.298 Test Loss: 5.098 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2583503723144531
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.458 Vali Acc: 0.276 Test Loss: 5.458 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6875178813934326
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.412 Vali Acc: 0.292 Test Loss: 5.412 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8865852355957031
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.879 Vali Acc: 0.291 Test Loss: 5.879 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.47913408279418945
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.691 Vali Acc: 0.300 Test Loss: 5.691 Test Acc: 0.300
Validation loss decreased (-0.297603 --> -0.299943).  Saving model ...
Epoch: 20 cost time: 0.836449146270752
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.570 Vali Acc: 0.298 Test Loss: 5.570 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.905602216720581
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.939 Vali Acc: 0.279 Test Loss: 5.939 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7282443046569824
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.896 Vali Acc: 0.292 Test Loss: 5.896 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8641338348388672
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.770 Vali Acc: 0.293 Test Loss: 5.770 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8558554649353027
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.784 Vali Acc: 0.294 Test Loss: 5.784 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0359745025634766
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.748 Vali Acc: 0.301 Test Loss: 5.748 Test Acc: 0.301
Validation loss decreased (-0.299943 --> -0.301119).  Saving model ...
Epoch: 26 cost time: 0.8647308349609375
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.727 Vali Acc: 0.302 Test Loss: 5.727 Test Acc: 0.302
Validation loss decreased (-0.301119 --> -0.302296).  Saving model ...
Epoch: 27 cost time: 1.116473913192749
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.734 Vali Acc: 0.301 Test Loss: 5.734 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.272674798965454
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.756 Vali Acc: 0.306 Test Loss: 5.756 Test Acc: 0.306
Validation loss decreased (-0.302296 --> -0.305825).  Saving model ...
Epoch: 29 cost time: 1.2141103744506836
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.788 Vali Acc: 0.307 Test Loss: 5.788 Test Acc: 0.307
Validation loss decreased (-0.305825 --> -0.307001).  Saving model ...
Epoch: 30 cost time: 0.8015120029449463
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.801 Vali Acc: 0.307 Test Loss: 5.801 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8555083274841309
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.797 Vali Acc: 0.307 Test Loss: 5.797 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7677607536315918
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.872 Vali Acc: 0.307 Test Loss: 5.872 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9671614170074463
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.898 Vali Acc: 0.304 Test Loss: 5.898 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.789825439453125
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.891 Vali Acc: 0.305 Test Loss: 5.891 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8196537494659424
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.876 Vali Acc: 0.304 Test Loss: 5.876 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8083019256591797
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.849 Vali Acc: 0.313 Test Loss: 5.849 Test Acc: 0.313
Validation loss decreased (-0.307001 --> -0.312883).  Saving model ...
Epoch: 37 cost time: 0.9312844276428223
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.828 Vali Acc: 0.314 Test Loss: 5.828 Test Acc: 0.314
Validation loss decreased (-0.312883 --> -0.314059).  Saving model ...
Epoch: 38 cost time: 0.7886366844177246
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.850 Vali Acc: 0.311 Test Loss: 5.850 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7098147869110107
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.876 Vali Acc: 0.306 Test Loss: 5.876 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7271404266357422
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.893 Vali Acc: 0.305 Test Loss: 5.893 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0046474933624268
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.907 Vali Acc: 0.301 Test Loss: 5.907 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7033777236938477
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.925 Vali Acc: 0.304 Test Loss: 5.925 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7595036029815674
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.938 Vali Acc: 0.307 Test Loss: 5.938 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8854293823242188
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.965 Vali Acc: 0.308 Test Loss: 5.965 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.770982027053833
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.978 Vali Acc: 0.309 Test Loss: 5.978 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6898708343505859
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.983 Vali Acc: 0.307 Test Loss: 5.983 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7322838306427002
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.977 Vali Acc: 0.308 Test Loss: 5.977 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 22824218
model size : 101.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.336358070373535
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.318 Vali Acc: 0.048 Test Loss: 3.318 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.5968332290649414
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.360 Vali Acc: 0.052 Test Loss: 3.360 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.5974295139312744
Epoch: 3, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.336 Vali Acc: 0.059 Test Loss: 3.336 Test Acc: 0.059
Validation loss decreased (-0.051731 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 0.6327681541442871
Epoch: 4, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.294 Vali Acc: 0.065 Test Loss: 3.294 Test Acc: 0.065
Validation loss decreased (-0.058790 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.622398853302002
Epoch: 5, Steps: 10 | Train Loss: 2.815 Vali Loss: 3.239 Vali Acc: 0.111 Test Loss: 3.239 Test Acc: 0.111
Validation loss decreased (-0.064673 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 0.6236984729766846
Epoch: 6, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.208 Vali Acc: 0.108 Test Loss: 3.208 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8227429389953613
Epoch: 7, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.210 Vali Acc: 0.139 Test Loss: 3.210 Test Acc: 0.139
Validation loss decreased (-0.110556 --> -0.138791).  Saving model ...
Epoch: 8 cost time: 0.6164765357971191
Epoch: 8, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.207 Vali Acc: 0.158 Test Loss: 3.207 Test Acc: 0.158
Validation loss decreased (-0.138791 --> -0.157615).  Saving model ...
Epoch: 9 cost time: 0.57828688621521
Epoch: 9, Steps: 10 | Train Loss: 1.757 Vali Loss: 3.380 Vali Acc: 0.195 Test Loss: 3.380 Test Acc: 0.195
Validation loss decreased (-0.157615 --> -0.195260).  Saving model ...
Epoch: 10 cost time: 0.44362545013427734
Epoch: 10, Steps: 10 | Train Loss: 1.349 Vali Loss: 3.549 Vali Acc: 0.188 Test Loss: 3.549 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6918132305145264
Epoch: 11, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.680 Vali Acc: 0.238 Test Loss: 3.680 Test Acc: 0.238
Validation loss decreased (-0.195260 --> -0.237610).  Saving model ...
Epoch: 12 cost time: 0.5855956077575684
Epoch: 12, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.787 Vali Acc: 0.241 Test Loss: 3.787 Test Acc: 0.241
Validation loss decreased (-0.237610 --> -0.241139).  Saving model ...
Epoch: 13 cost time: 0.8315110206604004
Epoch: 13, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.915 Vali Acc: 0.254 Test Loss: 3.915 Test Acc: 0.254
Validation loss decreased (-0.241139 --> -0.254079).  Saving model ...
Epoch: 14 cost time: 0.658789873123169
Epoch: 14, Steps: 10 | Train Loss: 0.243 Vali Loss: 4.274 Vali Acc: 0.242 Test Loss: 4.274 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5751674175262451
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.330 Vali Acc: 0.279 Test Loss: 4.330 Test Acc: 0.279
Validation loss decreased (-0.254079 --> -0.278780).  Saving model ...
Epoch: 16 cost time: 1.02134370803833
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.437 Vali Acc: 0.276 Test Loss: 4.437 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6487312316894531
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.514 Vali Acc: 0.276 Test Loss: 4.514 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6834418773651123
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.776 Vali Acc: 0.272 Test Loss: 4.776 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5835220813751221
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.639 Vali Acc: 0.293 Test Loss: 4.639 Test Acc: 0.293
Validation loss decreased (-0.278780 --> -0.292895).  Saving model ...
Epoch: 20 cost time: 0.5876076221466064
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.704 Vali Acc: 0.291 Test Loss: 4.704 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5463240146636963
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.868 Vali Acc: 0.280 Test Loss: 4.868 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5993993282318115
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.862 Vali Acc: 0.288 Test Loss: 4.862 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7052745819091797
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.837 Vali Acc: 0.293 Test Loss: 4.837 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6251041889190674
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.841 Vali Acc: 0.299 Test Loss: 4.841 Test Acc: 0.299
Validation loss decreased (-0.292895 --> -0.298775).  Saving model ...
Epoch: 25 cost time: 0.7745826244354248
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.969 Vali Acc: 0.287 Test Loss: 4.969 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.546393871307373
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.916 Vali Acc: 0.300 Test Loss: 4.916 Test Acc: 0.300
Validation loss decreased (-0.298775 --> -0.299951).  Saving model ...
Epoch: 27 cost time: 0.7611579895019531
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.911 Vali Acc: 0.305 Test Loss: 4.911 Test Acc: 0.305
Validation loss decreased (-0.299951 --> -0.304657).  Saving model ...
Epoch: 28 cost time: 0.6347699165344238
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.962 Vali Acc: 0.301 Test Loss: 4.962 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5600643157958984
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.011 Vali Acc: 0.298 Test Loss: 5.011 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6128242015838623
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.016 Vali Acc: 0.292 Test Loss: 5.016 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7245998382568359
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.040 Vali Acc: 0.296 Test Loss: 5.040 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6394453048706055
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.022 Vali Acc: 0.298 Test Loss: 5.022 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6319286823272705
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.044 Vali Acc: 0.295 Test Loss: 5.044 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6880717277526855
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.109 Vali Acc: 0.289 Test Loss: 5.109 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5292160511016846
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.131 Vali Acc: 0.289 Test Loss: 5.131 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6466906070709229
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.121 Vali Acc: 0.292 Test Loss: 5.121 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5412681102752686
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.116 Vali Acc: 0.295 Test Loss: 5.116 Test Acc: 0.295
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 22523162
model size : 100.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.583311080932617
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.369 Vali Acc: 0.045 Test Loss: 3.369 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.2735536098480225
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.393 Vali Acc: 0.046 Test Loss: 3.393 Test Acc: 0.046
Validation loss decreased (-0.044672 --> -0.045848).  Saving model ...
Epoch: 3 cost time: 1.2355499267578125
Epoch: 3, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.301 Vali Acc: 0.107 Test Loss: 3.301 Test Acc: 0.107
Validation loss decreased (-0.045848 --> -0.107026).  Saving model ...
Epoch: 4 cost time: 0.8735876083374023
Epoch: 4, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.107026 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 1.160043478012085
Epoch: 5, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.210 Vali Acc: 0.164 Test Loss: 3.210 Test Acc: 0.164
Validation loss decreased (-0.107026 --> -0.163497).  Saving model ...
Epoch: 6 cost time: 0.8095505237579346
Epoch: 6, Steps: 10 | Train Loss: 1.834 Vali Loss: 3.180 Vali Acc: 0.196 Test Loss: 3.180 Test Acc: 0.196
Validation loss decreased (-0.163497 --> -0.196439).  Saving model ...
Epoch: 7 cost time: 0.7836606502532959
Epoch: 7, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.402 Vali Acc: 0.222 Test Loss: 3.402 Test Acc: 0.222
Validation loss decreased (-0.196439 --> -0.222319).  Saving model ...
Epoch: 8 cost time: 1.0907866954803467
Epoch: 8, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.879 Vali Acc: 0.213 Test Loss: 3.879 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9077584743499756
Epoch: 9, Steps: 10 | Train Loss: 0.613 Vali Loss: 4.511 Vali Acc: 0.232 Test Loss: 4.511 Test Acc: 0.232
Validation loss decreased (-0.222319 --> -0.231720).  Saving model ...
Epoch: 10 cost time: 1.1041531562805176
Epoch: 10, Steps: 10 | Train Loss: 0.385 Vali Loss: 5.048 Vali Acc: 0.251 Test Loss: 5.048 Test Acc: 0.251
Validation loss decreased (-0.231720 --> -0.250538).  Saving model ...
Epoch: 11 cost time: 1.434037208557129
Epoch: 11, Steps: 10 | Train Loss: 0.319 Vali Loss: 5.251 Vali Acc: 0.272 Test Loss: 5.251 Test Acc: 0.272
Validation loss decreased (-0.250538 --> -0.271712).  Saving model ...
Epoch: 12 cost time: 1.3720178604125977
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 6.023 Vali Acc: 0.234 Test Loss: 6.023 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9978556632995605
Epoch: 13, Steps: 10 | Train Loss: 0.150 Vali Loss: 5.693 Vali Acc: 0.274 Test Loss: 5.693 Test Acc: 0.274
Validation loss decreased (-0.271712 --> -0.274061).  Saving model ...
Epoch: 14 cost time: 1.1502037048339844
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 6.294 Vali Acc: 0.268 Test Loss: 6.294 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7628662586212158
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 6.435 Vali Acc: 0.266 Test Loss: 6.435 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7927825450897217
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 6.832 Vali Acc: 0.276 Test Loss: 6.832 Test Acc: 0.276
Validation loss decreased (-0.274061 --> -0.276402).  Saving model ...
Epoch: 17 cost time: 1.081099033355713
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 7.154 Vali Acc: 0.278 Test Loss: 7.154 Test Acc: 0.278
Validation loss decreased (-0.276402 --> -0.277576).  Saving model ...
Epoch: 18 cost time: 0.9975028038024902
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 7.110 Vali Acc: 0.273 Test Loss: 7.110 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1863319873809814
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 7.704 Vali Acc: 0.278 Test Loss: 7.704 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1587679386138916
Epoch: 20, Steps: 10 | Train Loss: 0.154 Vali Loss: 7.532 Vali Acc: 0.278 Test Loss: 7.532 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.207261085510254
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 7.196 Vali Acc: 0.280 Test Loss: 7.196 Test Acc: 0.280
Validation loss decreased (-0.277576 --> -0.279928).  Saving model ...
Epoch: 22 cost time: 0.7078635692596436
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.222 Vali Acc: 0.300 Test Loss: 7.222 Test Acc: 0.300
Validation loss decreased (-0.279928 --> -0.299928).  Saving model ...
Epoch: 23 cost time: 0.8195464611053467
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.553 Vali Acc: 0.288 Test Loss: 7.553 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6628587245941162
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.646 Vali Acc: 0.288 Test Loss: 7.646 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8211183547973633
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.614 Vali Acc: 0.292 Test Loss: 7.614 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0460853576660156
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.505 Vali Acc: 0.296 Test Loss: 7.505 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8015787601470947
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.400 Vali Acc: 0.300 Test Loss: 7.400 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7775461673736572
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.368 Vali Acc: 0.300 Test Loss: 7.368 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6932730674743652
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.347 Vali Acc: 0.302 Test Loss: 7.347 Test Acc: 0.302
Validation loss decreased (-0.299928 --> -0.302279).  Saving model ...
Epoch: 30 cost time: 0.9161834716796875
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.344 Vali Acc: 0.305 Test Loss: 7.344 Test Acc: 0.305
Validation loss decreased (-0.302279 --> -0.304632).  Saving model ...
Epoch: 31 cost time: 0.8275690078735352
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.349 Vali Acc: 0.307 Test Loss: 7.349 Test Acc: 0.307
Validation loss decreased (-0.304632 --> -0.306985).  Saving model ...
Epoch: 32 cost time: 0.8383369445800781
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.366 Vali Acc: 0.305 Test Loss: 7.366 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0829694271087646
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.381 Vali Acc: 0.301 Test Loss: 7.381 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3002979755401611
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.387 Vali Acc: 0.300 Test Loss: 7.387 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8860511779785156
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.393 Vali Acc: 0.300 Test Loss: 7.393 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8727567195892334
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.408 Vali Acc: 0.301 Test Loss: 7.408 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8186490535736084
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.415 Vali Acc: 0.304 Test Loss: 7.415 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7703707218170166
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.418 Vali Acc: 0.305 Test Loss: 7.418 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5703191757202148
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.422 Vali Acc: 0.305 Test Loss: 7.422 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8304307460784912
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.421 Vali Acc: 0.304 Test Loss: 7.421 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5338077545166016
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 7.418 Vali Acc: 0.301 Test Loss: 7.418 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 23239706
model size : 103.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1045000553131104
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.342 Vali Acc: 0.041 Test Loss: 3.342 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.6665716171264648
Epoch: 2, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.343 Vali Acc: 0.073 Test Loss: 3.343 Test Acc: 0.073
Validation loss decreased (-0.041143 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 0.8874061107635498
Epoch: 3, Steps: 10 | Train Loss: 2.961 Vali Loss: 3.313 Vali Acc: 0.065 Test Loss: 3.313 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7416551113128662
Epoch: 4, Steps: 10 | Train Loss: 2.827 Vali Loss: 3.261 Vali Acc: 0.088 Test Loss: 3.261 Test Acc: 0.088
Validation loss decreased (-0.072908 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 0.8567957878112793
Epoch: 5, Steps: 10 | Train Loss: 2.673 Vali Loss: 3.213 Vali Acc: 0.104 Test Loss: 3.213 Test Acc: 0.104
Validation loss decreased (-0.088203 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.7088532447814941
Epoch: 6, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.194 Vali Acc: 0.135 Test Loss: 3.194 Test Acc: 0.135
Validation loss decreased (-0.103497 --> -0.135262).  Saving model ...
Epoch: 7 cost time: 0.8298275470733643
Epoch: 7, Steps: 10 | Train Loss: 1.898 Vali Loss: 3.205 Vali Acc: 0.171 Test Loss: 3.205 Test Acc: 0.171
Validation loss decreased (-0.135262 --> -0.170556).  Saving model ...
Epoch: 8 cost time: 0.8706505298614502
Epoch: 8, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.286 Vali Acc: 0.213 Test Loss: 3.286 Test Acc: 0.213
Validation loss decreased (-0.170556 --> -0.212908).  Saving model ...
Epoch: 9 cost time: 0.729802131652832
Epoch: 9, Steps: 10 | Train Loss: 1.185 Vali Loss: 3.696 Vali Acc: 0.195 Test Loss: 3.696 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.825610876083374
Epoch: 10, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.797 Vali Acc: 0.244 Test Loss: 3.797 Test Acc: 0.244
Validation loss decreased (-0.212908 --> -0.243491).  Saving model ...
Epoch: 11 cost time: 0.7626583576202393
Epoch: 11, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.974 Vali Acc: 0.255 Test Loss: 3.974 Test Acc: 0.255
Validation loss decreased (-0.243491 --> -0.255254).  Saving model ...
Epoch: 12 cost time: 0.9470064640045166
Epoch: 12, Steps: 10 | Train Loss: 0.276 Vali Loss: 4.446 Vali Acc: 0.249 Test Loss: 4.446 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6475820541381836
Epoch: 13, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.321 Vali Acc: 0.304 Test Loss: 4.321 Test Acc: 0.304
Validation loss decreased (-0.255254 --> -0.303486).  Saving model ...
Epoch: 14 cost time: 0.7747988700866699
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.624 Vali Acc: 0.273 Test Loss: 4.624 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7137088775634766
Epoch: 15, Steps: 10 | Train Loss: 0.078 Vali Loss: 5.007 Vali Acc: 0.254 Test Loss: 5.007 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6561393737792969
Epoch: 16, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.024 Vali Acc: 0.274 Test Loss: 5.024 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7041869163513184
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.127 Vali Acc: 0.285 Test Loss: 5.127 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7530782222747803
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.250 Vali Acc: 0.294 Test Loss: 5.250 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5911998748779297
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.406 Vali Acc: 0.288 Test Loss: 5.406 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.638927698135376
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.448 Vali Acc: 0.296 Test Loss: 5.448 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5126886367797852
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.354 Vali Acc: 0.291 Test Loss: 5.354 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8179352283477783
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.269 Vali Acc: 0.306 Test Loss: 5.269 Test Acc: 0.306
Validation loss decreased (-0.303486 --> -0.305830).  Saving model ...
Epoch: 23 cost time: 0.8598260879516602
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.264 Vali Acc: 0.314 Test Loss: 5.264 Test Acc: 0.314
Validation loss decreased (-0.305830 --> -0.314065).  Saving model ...
Epoch: 24 cost time: 0.7492325305938721
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.310 Vali Acc: 0.312 Test Loss: 5.310 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9360556602478027
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.488 Vali Acc: 0.289 Test Loss: 5.488 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6567623615264893
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.542 Vali Acc: 0.293 Test Loss: 5.542 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6406245231628418
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.530 Vali Acc: 0.293 Test Loss: 5.530 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7879703044891357
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.426 Vali Acc: 0.301 Test Loss: 5.426 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6696901321411133
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.444 Vali Acc: 0.304 Test Loss: 5.444 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.479353666305542
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.430 Vali Acc: 0.312 Test Loss: 5.430 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4704277515411377
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.420 Vali Acc: 0.315 Test Loss: 5.420 Test Acc: 0.315
Validation loss decreased (-0.314065 --> -0.315240).  Saving model ...
Epoch: 32 cost time: 0.6829862594604492
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.416 Vali Acc: 0.314 Test Loss: 5.416 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8013937473297119
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.431 Vali Acc: 0.308 Test Loss: 5.431 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.691204309463501
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.446 Vali Acc: 0.312 Test Loss: 5.446 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.017958164215088
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.466 Vali Acc: 0.309 Test Loss: 5.466 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8243248462677002
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.473 Vali Acc: 0.313 Test Loss: 5.473 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7693181037902832
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.482 Vali Acc: 0.315 Test Loss: 5.482 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7901852130889893
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.491 Vali Acc: 0.315 Test Loss: 5.491 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7610938549041748
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.517 Vali Acc: 0.316 Test Loss: 5.517 Test Acc: 0.316
Validation loss decreased (-0.315240 --> -0.316415).  Saving model ...
Epoch: 40 cost time: 0.7684271335601807
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.516 Vali Acc: 0.312 Test Loss: 5.516 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7491483688354492
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.510 Vali Acc: 0.312 Test Loss: 5.510 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.050034523010254
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.516 Vali Acc: 0.312 Test Loss: 5.516 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6722197532653809
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.528 Vali Acc: 0.308 Test Loss: 5.528 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7259485721588135
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.540 Vali Acc: 0.309 Test Loss: 5.540 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9635002613067627
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.309 Test Loss: 5.546 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7831425666809082
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.572 Vali Acc: 0.311 Test Loss: 5.572 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.681002140045166
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.592 Vali Acc: 0.309 Test Loss: 5.592 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9499332904815674
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.583 Vali Acc: 0.309 Test Loss: 5.583 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9337847232818604
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.576 Vali Acc: 0.314 Test Loss: 5.576 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 22723610
model size : 101.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.143244743347168
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.338 Vali Acc: 0.035 Test Loss: 3.338 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.741814136505127
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.343 Vali Acc: 0.064 Test Loss: 3.343 Test Acc: 0.064
Validation loss decreased (-0.035261 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.681812047958374
Epoch: 3, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.337 Vali Acc: 0.064 Test Loss: 3.337 Test Acc: 0.064
Validation loss decreased (-0.063496 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 0.8202672004699707
Epoch: 4, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.299 Vali Acc: 0.079 Test Loss: 3.299 Test Acc: 0.079
Validation loss decreased (-0.063496 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.7047712802886963
Epoch: 5, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.268 Vali Acc: 0.105 Test Loss: 3.268 Test Acc: 0.105
Validation loss decreased (-0.078791 --> -0.104673).  Saving model ...
Epoch: 6 cost time: 0.7066659927368164
Epoch: 6, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.235 Vali Acc: 0.111 Test Loss: 3.235 Test Acc: 0.111
Validation loss decreased (-0.104673 --> -0.110556).  Saving model ...
Epoch: 7 cost time: 0.6101977825164795
Epoch: 7, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.200 Vali Acc: 0.126 Test Loss: 3.200 Test Acc: 0.126
Validation loss decreased (-0.110556 --> -0.125850).  Saving model ...
Epoch: 8 cost time: 0.760561466217041
Epoch: 8, Steps: 10 | Train Loss: 2.166 Vali Loss: 3.220 Vali Acc: 0.161 Test Loss: 3.220 Test Acc: 0.161
Validation loss decreased (-0.125850 --> -0.161144).  Saving model ...
Epoch: 9 cost time: 0.5849230289459229
Epoch: 9, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.284 Vali Acc: 0.176 Test Loss: 3.284 Test Acc: 0.176
Validation loss decreased (-0.161144 --> -0.176438).  Saving model ...
Epoch: 10 cost time: 0.6259477138519287
Epoch: 10, Steps: 10 | Train Loss: 1.468 Vali Loss: 3.356 Vali Acc: 0.191 Test Loss: 3.356 Test Acc: 0.191
Validation loss decreased (-0.176438 --> -0.190555).  Saving model ...
Epoch: 11 cost time: 0.5967228412628174
Epoch: 11, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.439 Vali Acc: 0.226 Test Loss: 3.439 Test Acc: 0.226
Validation loss decreased (-0.190555 --> -0.225848).  Saving model ...
Epoch: 12 cost time: 0.666884183883667
Epoch: 12, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.588 Vali Acc: 0.234 Test Loss: 3.588 Test Acc: 0.234
Validation loss decreased (-0.225848 --> -0.234082).  Saving model ...
Epoch: 13 cost time: 0.6899988651275635
Epoch: 13, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.745 Vali Acc: 0.242 Test Loss: 3.745 Test Acc: 0.242
Validation loss decreased (-0.234082 --> -0.242315).  Saving model ...
Epoch: 14 cost time: 0.6023898124694824
Epoch: 14, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.860 Vali Acc: 0.272 Test Loss: 3.860 Test Acc: 0.272
Validation loss decreased (-0.242315 --> -0.271726).  Saving model ...
Epoch: 15 cost time: 0.6159610748291016
Epoch: 15, Steps: 10 | Train Loss: 0.207 Vali Loss: 4.064 Vali Acc: 0.266 Test Loss: 4.064 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6821284294128418
Epoch: 16, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.242 Vali Acc: 0.273 Test Loss: 4.242 Test Acc: 0.273
Validation loss decreased (-0.271726 --> -0.272899).  Saving model ...
Epoch: 17 cost time: 0.7142086029052734
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.258 Vali Acc: 0.284 Test Loss: 4.258 Test Acc: 0.284
Validation loss decreased (-0.272899 --> -0.283487).  Saving model ...
Epoch: 18 cost time: 0.7649703025817871
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.381 Vali Acc: 0.278 Test Loss: 4.381 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.67887282371521
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.526 Vali Acc: 0.287 Test Loss: 4.526 Test Acc: 0.287
Validation loss decreased (-0.283487 --> -0.287014).  Saving model ...
Epoch: 20 cost time: 0.7515249252319336
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.586 Vali Acc: 0.291 Test Loss: 4.586 Test Acc: 0.291
Validation loss decreased (-0.287014 --> -0.290542).  Saving model ...
Epoch: 21 cost time: 0.6851298809051514
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.566 Vali Acc: 0.298 Test Loss: 4.566 Test Acc: 0.298
Validation loss decreased (-0.290542 --> -0.297601).  Saving model ...
Epoch: 22 cost time: 0.7730433940887451
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.661 Vali Acc: 0.285 Test Loss: 4.661 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6933689117431641
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.676 Vali Acc: 0.295 Test Loss: 4.676 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6840646266937256
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.658 Vali Acc: 0.296 Test Loss: 4.658 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7345137596130371
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.699 Vali Acc: 0.300 Test Loss: 4.699 Test Acc: 0.300
Validation loss decreased (-0.297601 --> -0.299953).  Saving model ...
Epoch: 26 cost time: 0.6331453323364258
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.726 Vali Acc: 0.301 Test Loss: 4.726 Test Acc: 0.301
Validation loss decreased (-0.299953 --> -0.301129).  Saving model ...
Epoch: 27 cost time: 0.6136400699615479
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.723 Vali Acc: 0.299 Test Loss: 4.723 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5963835716247559
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.778 Vali Acc: 0.292 Test Loss: 4.778 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6704790592193604
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.812 Vali Acc: 0.291 Test Loss: 4.812 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5803945064544678
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.816 Vali Acc: 0.295 Test Loss: 4.816 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5924668312072754
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.834 Vali Acc: 0.293 Test Loss: 4.834 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6373748779296875
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.836 Vali Acc: 0.298 Test Loss: 4.836 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5693862438201904
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.847 Vali Acc: 0.300 Test Loss: 4.847 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7889578342437744
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.882 Vali Acc: 0.294 Test Loss: 4.882 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5379452705383301
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.904 Vali Acc: 0.292 Test Loss: 4.904 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5706391334533691
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.902 Vali Acc: 0.301 Test Loss: 4.902 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 22487066
model size : 100.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7308807373046875
Epoch: 1, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.342 Vali Acc: 0.061 Test Loss: 3.342 Test Acc: 0.061
Validation loss decreased (inf --> -0.061143).  Saving model ...
Epoch: 2 cost time: 0.5777103900909424
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.368 Vali Acc: 0.092 Test Loss: 3.368 Test Acc: 0.092
Validation loss decreased (-0.061143 --> -0.091731).  Saving model ...
Epoch: 3 cost time: 0.8776552677154541
Epoch: 3, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.259 Vali Acc: 0.100 Test Loss: 3.259 Test Acc: 0.100
Validation loss decreased (-0.091731 --> -0.099967).  Saving model ...
Epoch: 4 cost time: 0.720144510269165
Epoch: 4, Steps: 10 | Train Loss: 2.663 Vali Loss: 3.235 Vali Acc: 0.122 Test Loss: 3.235 Test Acc: 0.122
Validation loss decreased (-0.099967 --> -0.122321).  Saving model ...
Epoch: 5 cost time: 0.9911437034606934
Epoch: 5, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.211 Vali Acc: 0.149 Test Loss: 3.211 Test Acc: 0.149
Validation loss decreased (-0.122321 --> -0.149380).  Saving model ...
Epoch: 6 cost time: 0.9529998302459717
Epoch: 6, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.229 Vali Acc: 0.194 Test Loss: 3.229 Test Acc: 0.194
Validation loss decreased (-0.149380 --> -0.194085).  Saving model ...
Epoch: 7 cost time: 0.9402010440826416
Epoch: 7, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.444 Vali Acc: 0.182 Test Loss: 3.444 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8502819538116455
Epoch: 8, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.834 Vali Acc: 0.239 Test Loss: 3.834 Test Acc: 0.239
Validation loss decreased (-0.194085 --> -0.238785).  Saving model ...
Epoch: 9 cost time: 0.568023681640625
Epoch: 9, Steps: 10 | Train Loss: 0.600 Vali Loss: 4.331 Vali Acc: 0.246 Test Loss: 4.331 Test Acc: 0.246
Validation loss decreased (-0.238785 --> -0.245839).  Saving model ...
Epoch: 10 cost time: 0.8159611225128174
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 4.741 Vali Acc: 0.278 Test Loss: 4.741 Test Acc: 0.278
Validation loss decreased (-0.245839 --> -0.277600).  Saving model ...
Epoch: 11 cost time: 0.8186876773834229
Epoch: 11, Steps: 10 | Train Loss: 0.248 Vali Loss: 5.228 Vali Acc: 0.276 Test Loss: 5.228 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2705168724060059
Epoch: 12, Steps: 10 | Train Loss: 0.172 Vali Loss: 5.374 Vali Acc: 0.288 Test Loss: 5.374 Test Acc: 0.288
Validation loss decreased (-0.277600 --> -0.288182).  Saving model ...
Epoch: 13 cost time: 0.738745927810669
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 5.903 Vali Acc: 0.287 Test Loss: 5.903 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5617187023162842
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.170 Vali Acc: 0.274 Test Loss: 6.170 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0038511753082275
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.308 Vali Acc: 0.269 Test Loss: 6.308 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8885281085968018
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.772 Vali Acc: 0.264 Test Loss: 6.772 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7062666416168213
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 7.016 Vali Acc: 0.262 Test Loss: 7.016 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9668612480163574
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 7.186 Vali Acc: 0.260 Test Loss: 7.186 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8366298675537109
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 8.237 Vali Acc: 0.261 Test Loss: 8.237 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9586634635925293
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 8.014 Vali Acc: 0.268 Test Loss: 8.014 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5899579524993896
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 7.817 Vali Acc: 0.291 Test Loss: 7.817 Test Acc: 0.291
Validation loss decreased (-0.288182 --> -0.290510).  Saving model ...
Epoch: 22 cost time: 1.1062612533569336
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.815 Vali Acc: 0.289 Test Loss: 7.815 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7508063316345215
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.284 Vali Acc: 0.249 Test Loss: 8.284 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.006495475769043
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 7.831 Vali Acc: 0.280 Test Loss: 7.831 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1081807613372803
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 8.334 Vali Acc: 0.288 Test Loss: 8.334 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1410772800445557
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.889 Vali Acc: 0.298 Test Loss: 7.889 Test Acc: 0.298
Validation loss decreased (-0.290510 --> -0.297568).  Saving model ...
Epoch: 27 cost time: 0.8519325256347656
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.928 Vali Acc: 0.293 Test Loss: 7.928 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1217637062072754
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 9.176 Vali Acc: 0.269 Test Loss: 9.176 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7035946846008301
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.903 Vali Acc: 0.279 Test Loss: 8.903 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9242188930511475
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.658 Vali Acc: 0.279 Test Loss: 8.658 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7856786251068115
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.278 Vali Acc: 0.284 Test Loss: 8.278 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5792813301086426
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.443 Vali Acc: 0.287 Test Loss: 8.443 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.830897331237793
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 9.026 Vali Acc: 0.247 Test Loss: 9.026 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1346790790557861
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.623 Vali Acc: 0.272 Test Loss: 8.623 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7498495578765869
Epoch: 35, Steps: 10 | Train Loss: 0.067 Vali Loss: 8.126 Vali Acc: 0.285 Test Loss: 8.126 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9486000537872314
Epoch: 36, Steps: 10 | Train Loss: 0.028 Vali Loss: 8.591 Vali Acc: 0.266 Test Loss: 8.591 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 23225114
model size : 103.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1189000606536865
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.318 Vali Acc: 0.039 Test Loss: 3.318 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5339341163635254
Epoch: 2, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.378 Vali Acc: 0.049 Test Loss: 3.378 Test Acc: 0.049
Validation loss decreased (-0.038790 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.5732951164245605
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.349 Vali Acc: 0.082 Test Loss: 3.349 Test Acc: 0.082
Validation loss decreased (-0.049378 --> -0.082319).  Saving model ...
Epoch: 4 cost time: 0.6531322002410889
Epoch: 4, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.234 Vali Acc: 0.082 Test Loss: 3.234 Test Acc: 0.082
Validation loss decreased (-0.082319 --> -0.082321).  Saving model ...
Epoch: 5 cost time: 0.7258281707763672
Epoch: 5, Steps: 10 | Train Loss: 2.554 Vali Loss: 3.192 Vali Acc: 0.113 Test Loss: 3.192 Test Acc: 0.113
Validation loss decreased (-0.082321 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 1.0461483001708984
Epoch: 6, Steps: 10 | Train Loss: 2.401 Vali Loss: 3.187 Vali Acc: 0.146 Test Loss: 3.187 Test Acc: 0.146
Validation loss decreased (-0.112909 --> -0.145850).  Saving model ...
Epoch: 7 cost time: 0.8053555488586426
Epoch: 7, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.216 Vali Acc: 0.174 Test Loss: 3.216 Test Acc: 0.174
Validation loss decreased (-0.145850 --> -0.174085).  Saving model ...
Epoch: 8 cost time: 0.6658682823181152
Epoch: 8, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.280 Vali Acc: 0.171 Test Loss: 3.280 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6899924278259277
Epoch: 9, Steps: 10 | Train Loss: 1.138 Vali Loss: 3.670 Vali Acc: 0.201 Test Loss: 3.670 Test Acc: 0.201
Validation loss decreased (-0.174085 --> -0.201140).  Saving model ...
Epoch: 10 cost time: 1.1438934803009033
Epoch: 10, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.882 Vali Acc: 0.241 Test Loss: 3.882 Test Acc: 0.241
Validation loss decreased (-0.201140 --> -0.241138).  Saving model ...
Epoch: 11 cost time: 0.6430726051330566
Epoch: 11, Steps: 10 | Train Loss: 0.598 Vali Loss: 4.022 Vali Acc: 0.253 Test Loss: 4.022 Test Acc: 0.253
Validation loss decreased (-0.241138 --> -0.252901).  Saving model ...
Epoch: 12 cost time: 0.6896369457244873
Epoch: 12, Steps: 10 | Train Loss: 0.456 Vali Loss: 4.413 Vali Acc: 0.265 Test Loss: 4.413 Test Acc: 0.265
Validation loss decreased (-0.252901 --> -0.264662).  Saving model ...
Epoch: 13 cost time: 0.6852943897247314
Epoch: 13, Steps: 10 | Train Loss: 0.291 Vali Loss: 4.502 Vali Acc: 0.258 Test Loss: 4.502 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7391040325164795
Epoch: 14, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.993 Vali Acc: 0.245 Test Loss: 4.993 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.517174243927002
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.930 Vali Acc: 0.278 Test Loss: 4.930 Test Acc: 0.278
Validation loss decreased (-0.264662 --> -0.277598).  Saving model ...
Epoch: 16 cost time: 0.9380922317504883
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 5.077 Vali Acc: 0.275 Test Loss: 5.077 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1422104835510254
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.041 Vali Acc: 0.295 Test Loss: 5.041 Test Acc: 0.295
Validation loss decreased (-0.277598 --> -0.295244).  Saving model ...
Epoch: 18 cost time: 0.7174527645111084
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.248 Vali Acc: 0.308 Test Loss: 5.248 Test Acc: 0.308
Validation loss decreased (-0.295244 --> -0.308183).  Saving model ...
Epoch: 19 cost time: 0.7636137008666992
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.291 Vali Acc: 0.305 Test Loss: 5.291 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5647449493408203
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.362 Vali Acc: 0.309 Test Loss: 5.362 Test Acc: 0.309
Validation loss decreased (-0.308183 --> -0.309358).  Saving model ...
Epoch: 21 cost time: 0.6084818840026855
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.303 Vali Acc: 0.305 Test Loss: 5.303 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6562879085540771
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.280 Vali Acc: 0.324 Test Loss: 5.280 Test Acc: 0.324
Validation loss decreased (-0.309358 --> -0.323477).  Saving model ...
Epoch: 23 cost time: 0.6394164562225342
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.308 Vali Acc: 0.319 Test Loss: 5.308 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6206493377685547
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.296 Vali Acc: 0.327 Test Loss: 5.296 Test Acc: 0.327
Validation loss decreased (-0.323477 --> -0.327006).  Saving model ...
Epoch: 25 cost time: 0.8376955986022949
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.335 Vali Acc: 0.321 Test Loss: 5.335 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6706116199493408
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.378 Vali Acc: 0.313 Test Loss: 5.378 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.44263315200805664
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.407 Vali Acc: 0.311 Test Loss: 5.407 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4637336730957031
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.393 Vali Acc: 0.309 Test Loss: 5.393 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5093157291412354
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.400 Vali Acc: 0.319 Test Loss: 5.400 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.577655553817749
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.423 Vali Acc: 0.319 Test Loss: 5.423 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8141837120056152
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.449 Vali Acc: 0.320 Test Loss: 5.449 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5646095275878906
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.479 Vali Acc: 0.318 Test Loss: 5.479 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7013328075408936
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.488 Vali Acc: 0.316 Test Loss: 5.488 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.64304518699646
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.497 Vali Acc: 0.315 Test Loss: 5.497 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 22730522
model size : 101.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1162097454071045
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.339 Vali Acc: 0.040 Test Loss: 3.339 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.7259311676025391
Epoch: 2, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.332 Vali Acc: 0.042 Test Loss: 3.332 Test Acc: 0.042
Validation loss decreased (-0.039967 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.5807826519012451
Epoch: 3, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.319 Vali Acc: 0.058 Test Loss: 3.319 Test Acc: 0.058
Validation loss decreased (-0.042320 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.6941277980804443
Epoch: 4, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.304 Vali Acc: 0.055 Test Loss: 3.304 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6273620128631592
Epoch: 5, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.258 Vali Acc: 0.080 Test Loss: 3.258 Test Acc: 0.080
Validation loss decreased (-0.057614 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.8607292175292969
Epoch: 6, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.233 Vali Acc: 0.091 Test Loss: 3.233 Test Acc: 0.091
Validation loss decreased (-0.079967 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 0.7736153602600098
Epoch: 7, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.185 Vali Acc: 0.129 Test Loss: 3.185 Test Acc: 0.129
Validation loss decreased (-0.090556 --> -0.129380).  Saving model ...
Epoch: 8 cost time: 0.8084309101104736
Epoch: 8, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.226 Vali Acc: 0.134 Test Loss: 3.226 Test Acc: 0.134
Validation loss decreased (-0.129380 --> -0.134085).  Saving model ...
Epoch: 9 cost time: 0.6504392623901367
Epoch: 9, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.227 Vali Acc: 0.169 Test Loss: 3.227 Test Acc: 0.169
Validation loss decreased (-0.134085 --> -0.169379).  Saving model ...
Epoch: 10 cost time: 0.6163039207458496
Epoch: 10, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.391 Vali Acc: 0.193 Test Loss: 3.391 Test Acc: 0.193
Validation loss decreased (-0.169379 --> -0.192907).  Saving model ...
Epoch: 11 cost time: 0.7430081367492676
Epoch: 11, Steps: 10 | Train Loss: 1.146 Vali Loss: 3.477 Vali Acc: 0.225 Test Loss: 3.477 Test Acc: 0.225
Validation loss decreased (-0.192907 --> -0.224671).  Saving model ...
Epoch: 12 cost time: 0.5715072154998779
Epoch: 12, Steps: 10 | Train Loss: 0.855 Vali Loss: 3.702 Vali Acc: 0.239 Test Loss: 3.702 Test Acc: 0.239
Validation loss decreased (-0.224671 --> -0.238787).  Saving model ...
Epoch: 13 cost time: 0.5526847839355469
Epoch: 13, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.764 Vali Acc: 0.245 Test Loss: 3.764 Test Acc: 0.245
Validation loss decreased (-0.238787 --> -0.244668).  Saving model ...
Epoch: 14 cost time: 0.5950899124145508
Epoch: 14, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.989 Vali Acc: 0.260 Test Loss: 3.989 Test Acc: 0.260
Validation loss decreased (-0.244668 --> -0.259960).  Saving model ...
Epoch: 15 cost time: 0.5544865131378174
Epoch: 15, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.042 Vali Acc: 0.273 Test Loss: 4.042 Test Acc: 0.273
Validation loss decreased (-0.259960 --> -0.272901).  Saving model ...
Epoch: 16 cost time: 0.8557636737823486
Epoch: 16, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.186 Vali Acc: 0.269 Test Loss: 4.186 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5663456916809082
Epoch: 17, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.409 Vali Acc: 0.272 Test Loss: 4.409 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6576368808746338
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.429 Vali Acc: 0.286 Test Loss: 4.429 Test Acc: 0.286
Validation loss decreased (-0.272901 --> -0.285838).  Saving model ...
Epoch: 19 cost time: 0.6185448169708252
Epoch: 19, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.481 Vali Acc: 0.292 Test Loss: 4.481 Test Acc: 0.292
Validation loss decreased (-0.285838 --> -0.291720).  Saving model ...
Epoch: 20 cost time: 0.6199386119842529
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.706 Vali Acc: 0.289 Test Loss: 4.706 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6152501106262207
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.710 Vali Acc: 0.286 Test Loss: 4.710 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5612189769744873
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.692 Vali Acc: 0.281 Test Loss: 4.692 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6880760192871094
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.708 Vali Acc: 0.288 Test Loss: 4.708 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7932028770446777
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.752 Vali Acc: 0.286 Test Loss: 4.752 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7878894805908203
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.767 Vali Acc: 0.288 Test Loss: 4.767 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.847743034362793
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.805 Vali Acc: 0.286 Test Loss: 4.805 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9147872924804688
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.842 Vali Acc: 0.287 Test Loss: 4.842 Test Acc: 0.287
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7614846229553223
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.849 Vali Acc: 0.289 Test Loss: 4.849 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8869924545288086
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.836 Vali Acc: 0.293 Test Loss: 4.836 Test Acc: 0.293
Validation loss decreased (-0.291720 --> -0.292893).  Saving model ...
Epoch: 30 cost time: 0.6552889347076416
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.848 Vali Acc: 0.293 Test Loss: 4.848 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5519962310791016
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.907 Vali Acc: 0.287 Test Loss: 4.907 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.795727014541626
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.927 Vali Acc: 0.285 Test Loss: 4.927 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6710867881774902
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.921 Vali Acc: 0.293 Test Loss: 4.921 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5604088306427002
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.941 Vali Acc: 0.292 Test Loss: 4.941 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5400307178497314
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.967 Vali Acc: 0.293 Test Loss: 4.967 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6865546703338623
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.002 Vali Acc: 0.285 Test Loss: 5.002 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.62184739112854
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.998 Vali Acc: 0.291 Test Loss: 4.998 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5355467796325684
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.001 Vali Acc: 0.298 Test Loss: 5.001 Test Acc: 0.298
Validation loss decreased (-0.292893 --> -0.297597).  Saving model ...
Epoch: 39 cost time: 0.5755279064178467
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.010 Vali Acc: 0.301 Test Loss: 5.010 Test Acc: 0.301
Validation loss decreased (-0.297597 --> -0.301126).  Saving model ...
Epoch: 40 cost time: 0.5518224239349365
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.015 Vali Acc: 0.301 Test Loss: 5.015 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5062103271484375
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.034 Vali Acc: 0.301 Test Loss: 5.034 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5192933082580566
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.045 Vali Acc: 0.302 Test Loss: 5.045 Test Acc: 0.302
Validation loss decreased (-0.301126 --> -0.302302).  Saving model ...
Epoch: 43 cost time: 0.5621199607849121
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.078 Vali Acc: 0.299 Test Loss: 5.078 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4872710704803467
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.104 Vali Acc: 0.299 Test Loss: 5.104 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6479463577270508
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.118 Vali Acc: 0.296 Test Loss: 5.118 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6367802619934082
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.143 Vali Acc: 0.296 Test Loss: 5.143 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7085509300231934
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.169 Vali Acc: 0.293 Test Loss: 5.169 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5481445789337158
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.163 Vali Acc: 0.289 Test Loss: 5.163 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6090874671936035
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.179 Vali Acc: 0.293 Test Loss: 5.179 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7330005168914795
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.187 Vali Acc: 0.296 Test Loss: 5.187 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 22472474
model size : 100.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5229454040527344
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.346 Vali Acc: 0.041 Test Loss: 3.346 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.4691586494445801
Epoch: 2, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.389 Vali Acc: 0.071 Test Loss: 3.389 Test Acc: 0.071
Validation loss decreased (-0.041143 --> -0.070554).  Saving model ...
Epoch: 3 cost time: 0.6463906764984131
Epoch: 3, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.282 Vali Acc: 0.069 Test Loss: 3.282 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8063356876373291
Epoch: 4, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.243 Vali Acc: 0.118 Test Loss: 3.243 Test Acc: 0.118
Validation loss decreased (-0.070554 --> -0.117615).  Saving model ...
Epoch: 5 cost time: 0.653893232345581
Epoch: 5, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.149 Vali Acc: 0.160 Test Loss: 3.149 Test Acc: 0.160
Validation loss decreased (-0.117615 --> -0.159969).  Saving model ...
Epoch: 6 cost time: 0.6759545803070068
Epoch: 6, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.160 Vali Acc: 0.179 Test Loss: 3.160 Test Acc: 0.179
Validation loss decreased (-0.159969 --> -0.178792).  Saving model ...
Epoch: 7 cost time: 0.6100285053253174
Epoch: 7, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.190 Vali Acc: 0.207 Test Loss: 3.190 Test Acc: 0.207
Validation loss decreased (-0.178792 --> -0.207027).  Saving model ...
Epoch: 8 cost time: 0.6152224540710449
Epoch: 8, Steps: 10 | Train Loss: 1.132 Vali Loss: 3.520 Vali Acc: 0.228 Test Loss: 3.520 Test Acc: 0.228
Validation loss decreased (-0.207027 --> -0.228200).  Saving model ...
Epoch: 9 cost time: 1.005300760269165
Epoch: 9, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.962 Vali Acc: 0.259 Test Loss: 3.962 Test Acc: 0.259
Validation loss decreased (-0.228200 --> -0.258784).  Saving model ...
Epoch: 10 cost time: 0.6320092678070068
Epoch: 10, Steps: 10 | Train Loss: 0.501 Vali Loss: 4.305 Vali Acc: 0.244 Test Loss: 4.305 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.59454345703125
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 4.792 Vali Acc: 0.261 Test Loss: 4.792 Test Acc: 0.261
Validation loss decreased (-0.258784 --> -0.261129).  Saving model ...
Epoch: 12 cost time: 0.9997665882110596
Epoch: 12, Steps: 10 | Train Loss: 0.114 Vali Loss: 5.052 Vali Acc: 0.278 Test Loss: 5.052 Test Acc: 0.278
Validation loss decreased (-0.261129 --> -0.277597).  Saving model ...
Epoch: 13 cost time: 0.7538840770721436
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 5.294 Vali Acc: 0.262 Test Loss: 5.294 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5970613956451416
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.404 Vali Acc: 0.280 Test Loss: 5.404 Test Acc: 0.280
Validation loss decreased (-0.277597 --> -0.279946).  Saving model ...
Epoch: 15 cost time: 0.6363468170166016
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.947 Vali Acc: 0.280 Test Loss: 5.947 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48993563652038574
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.797 Vali Acc: 0.279 Test Loss: 5.797 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5886433124542236
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.721 Vali Acc: 0.296 Test Loss: 5.721 Test Acc: 0.296
Validation loss decreased (-0.279946 --> -0.296413).  Saving model ...
Epoch: 18 cost time: 0.6704196929931641
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 6.482 Vali Acc: 0.276 Test Loss: 6.482 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1071996688842773
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.280 Vali Acc: 0.281 Test Loss: 6.280 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.626823902130127
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.277 Vali Acc: 0.288 Test Loss: 6.277 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5815224647521973
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 6.483 Vali Acc: 0.272 Test Loss: 6.483 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6543853282928467
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.327 Vali Acc: 0.287 Test Loss: 6.327 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6866335868835449
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.174 Vali Acc: 0.316 Test Loss: 6.174 Test Acc: 0.316
Validation loss decreased (-0.296413 --> -0.316409).  Saving model ...
Epoch: 24 cost time: 0.7692742347717285
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.363 Vali Acc: 0.307 Test Loss: 6.363 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6687524318695068
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.606 Vali Acc: 0.300 Test Loss: 6.606 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6135532855987549
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.570 Vali Acc: 0.300 Test Loss: 6.570 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6545886993408203
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.650 Vali Acc: 0.301 Test Loss: 6.650 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6810529232025146
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.596 Vali Acc: 0.313 Test Loss: 6.596 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6694788932800293
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.554 Vali Acc: 0.324 Test Loss: 6.554 Test Acc: 0.324
Validation loss decreased (-0.316409 --> -0.323464).  Saving model ...
Epoch: 30 cost time: 0.978374719619751
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.530 Vali Acc: 0.318 Test Loss: 6.530 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4566385746002197
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.517 Vali Acc: 0.321 Test Loss: 6.517 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.50797438621521
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.505 Vali Acc: 0.325 Test Loss: 6.505 Test Acc: 0.325
Validation loss decreased (-0.323464 --> -0.324641).  Saving model ...
Epoch: 33 cost time: 0.9131267070770264
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.502 Vali Acc: 0.325 Test Loss: 6.502 Test Acc: 0.325
Validation loss decreased (-0.324641 --> -0.324641).  Saving model ...
Epoch: 34 cost time: 0.5456647872924805
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.502 Vali Acc: 0.324 Test Loss: 6.502 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6840312480926514
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.514 Vali Acc: 0.320 Test Loss: 6.514 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5997788906097412
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.534 Vali Acc: 0.316 Test Loss: 6.534 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5356674194335938
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.562 Vali Acc: 0.309 Test Loss: 6.562 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6531481742858887
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.569 Vali Acc: 0.319 Test Loss: 6.569 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9188065528869629
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.567 Vali Acc: 0.321 Test Loss: 6.567 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6231515407562256
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.557 Vali Acc: 0.324 Test Loss: 6.557 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8775792121887207
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.545 Vali Acc: 0.324 Test Loss: 6.545 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8977797031402588
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.527 Vali Acc: 0.322 Test Loss: 6.527 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5741052627563477
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.518 Vali Acc: 0.321 Test Loss: 6.518 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 22973978
model size : 102.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.496361017227173
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.334 Vali Acc: 0.045 Test Loss: 3.334 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.5421011447906494
Epoch: 2, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.338 Vali Acc: 0.069 Test Loss: 3.338 Test Acc: 0.069
Validation loss decreased (-0.044673 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.6541202068328857
Epoch: 3, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.331 Vali Acc: 0.076 Test Loss: 3.331 Test Acc: 0.076
Validation loss decreased (-0.069378 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.6086735725402832
Epoch: 4, Steps: 10 | Train Loss: 2.897 Vali Loss: 3.275 Vali Acc: 0.073 Test Loss: 3.275 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5871028900146484
Epoch: 5, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.194 Vali Acc: 0.105 Test Loss: 3.194 Test Acc: 0.105
Validation loss decreased (-0.076437 --> -0.104674).  Saving model ...
Epoch: 6 cost time: 0.5920834541320801
Epoch: 6, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.207 Vali Acc: 0.116 Test Loss: 3.207 Test Acc: 0.116
Validation loss decreased (-0.104674 --> -0.116439).  Saving model ...
Epoch: 7 cost time: 0.5529658794403076
Epoch: 7, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.159 Vali Acc: 0.152 Test Loss: 3.159 Test Acc: 0.152
Validation loss decreased (-0.116439 --> -0.151733).  Saving model ...
Epoch: 8 cost time: 1.0650115013122559
Epoch: 8, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.245 Vali Acc: 0.181 Test Loss: 3.245 Test Acc: 0.181
Validation loss decreased (-0.151733 --> -0.181144).  Saving model ...
Epoch: 9 cost time: 0.5367038249969482
Epoch: 9, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.408 Vali Acc: 0.226 Test Loss: 3.408 Test Acc: 0.226
Validation loss decreased (-0.181144 --> -0.225848).  Saving model ...
Epoch: 10 cost time: 0.6512413024902344
Epoch: 10, Steps: 10 | Train Loss: 0.811 Vali Loss: 3.761 Vali Acc: 0.229 Test Loss: 3.761 Test Acc: 0.229
Validation loss decreased (-0.225848 --> -0.229374).  Saving model ...
Epoch: 11 cost time: 0.8004369735717773
Epoch: 11, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.901 Vali Acc: 0.247 Test Loss: 3.901 Test Acc: 0.247
Validation loss decreased (-0.229374 --> -0.247020).  Saving model ...
Epoch: 12 cost time: 1.006009578704834
Epoch: 12, Steps: 10 | Train Loss: 0.336 Vali Loss: 4.220 Vali Acc: 0.258 Test Loss: 4.220 Test Acc: 0.258
Validation loss decreased (-0.247020 --> -0.257605).  Saving model ...
Epoch: 13 cost time: 0.9871160984039307
Epoch: 13, Steps: 10 | Train Loss: 0.198 Vali Loss: 4.552 Vali Acc: 0.260 Test Loss: 4.552 Test Acc: 0.260
Validation loss decreased (-0.257605 --> -0.259954).  Saving model ...
Epoch: 14 cost time: 0.8452844619750977
Epoch: 14, Steps: 10 | Train Loss: 0.158 Vali Loss: 4.618 Vali Acc: 0.248 Test Loss: 4.618 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6132428646087646
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.833 Vali Acc: 0.271 Test Loss: 4.833 Test Acc: 0.271
Validation loss decreased (-0.259954 --> -0.270540).  Saving model ...
Epoch: 16 cost time: 0.5964086055755615
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.849 Vali Acc: 0.287 Test Loss: 4.849 Test Acc: 0.287
Validation loss decreased (-0.270540 --> -0.287010).  Saving model ...
Epoch: 17 cost time: 0.6749215126037598
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.887 Vali Acc: 0.302 Test Loss: 4.887 Test Acc: 0.302
Validation loss decreased (-0.287010 --> -0.302304).  Saving model ...
Epoch: 18 cost time: 0.5244824886322021
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.135 Vali Acc: 0.286 Test Loss: 5.135 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5416593551635742
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 5.148 Vali Acc: 0.291 Test Loss: 5.148 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.792680025100708
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.190 Vali Acc: 0.286 Test Loss: 5.190 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5862421989440918
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.298 Vali Acc: 0.282 Test Loss: 5.298 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.646073579788208
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.288 Vali Acc: 0.295 Test Loss: 5.288 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6014926433563232
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.294 Vali Acc: 0.294 Test Loss: 5.294 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6004476547241211
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.254 Vali Acc: 0.298 Test Loss: 5.254 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6471967697143555
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.258 Vali Acc: 0.291 Test Loss: 5.258 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.670703649520874
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.246 Vali Acc: 0.293 Test Loss: 5.246 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7780213356018066
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.248 Vali Acc: 0.296 Test Loss: 5.248 Test Acc: 0.296
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 22651418
model size : 101.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9996016025543213
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.356 Vali Acc: 0.054 Test Loss: 3.356 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 0.6781089305877686
Epoch: 2, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.326 Vali Acc: 0.061 Test Loss: 3.326 Test Acc: 0.061
Validation loss decreased (-0.054084 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.6910278797149658
Epoch: 3, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.339 Vali Acc: 0.064 Test Loss: 3.339 Test Acc: 0.064
Validation loss decreased (-0.061143 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 0.5619428157806396
Epoch: 4, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.298 Vali Acc: 0.075 Test Loss: 3.298 Test Acc: 0.075
Validation loss decreased (-0.063496 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.73138427734375
Epoch: 5, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.261 Vali Acc: 0.098 Test Loss: 3.261 Test Acc: 0.098
Validation loss decreased (-0.075261 --> -0.097614).  Saving model ...
Epoch: 6 cost time: 0.5424540042877197
Epoch: 6, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.234 Vali Acc: 0.100 Test Loss: 3.234 Test Acc: 0.100
Validation loss decreased (-0.097614 --> -0.099968).  Saving model ...
Epoch: 7 cost time: 0.6215164661407471
Epoch: 7, Steps: 10 | Train Loss: 2.505 Vali Loss: 3.196 Vali Acc: 0.125 Test Loss: 3.196 Test Acc: 0.125
Validation loss decreased (-0.099968 --> -0.124674).  Saving model ...
Epoch: 8 cost time: 0.7845642566680908
Epoch: 8, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.218 Vali Acc: 0.144 Test Loss: 3.218 Test Acc: 0.144
Validation loss decreased (-0.124674 --> -0.143497).  Saving model ...
Epoch: 9 cost time: 0.5439765453338623
Epoch: 9, Steps: 10 | Train Loss: 1.900 Vali Loss: 3.257 Vali Acc: 0.174 Test Loss: 3.257 Test Acc: 0.174
Validation loss decreased (-0.143497 --> -0.174085).  Saving model ...
Epoch: 10 cost time: 0.7784669399261475
Epoch: 10, Steps: 10 | Train Loss: 1.503 Vali Loss: 3.327 Vali Acc: 0.208 Test Loss: 3.327 Test Acc: 0.208
Validation loss decreased (-0.174085 --> -0.208202).  Saving model ...
Epoch: 11 cost time: 0.4946470260620117
Epoch: 11, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.397 Vali Acc: 0.244 Test Loss: 3.397 Test Acc: 0.244
Validation loss decreased (-0.208202 --> -0.243495).  Saving model ...
Epoch: 12 cost time: 0.6720750331878662
Epoch: 12, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.508 Vali Acc: 0.247 Test Loss: 3.508 Test Acc: 0.247
Validation loss decreased (-0.243495 --> -0.247024).  Saving model ...
Epoch: 13 cost time: 0.6629621982574463
Epoch: 13, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.605 Vali Acc: 0.269 Test Loss: 3.605 Test Acc: 0.269
Validation loss decreased (-0.247024 --> -0.269376).  Saving model ...
Epoch: 14 cost time: 0.6366214752197266
Epoch: 14, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.860 Vali Acc: 0.251 Test Loss: 3.860 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6320714950561523
Epoch: 15, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.953 Vali Acc: 0.274 Test Loss: 3.953 Test Acc: 0.274
Validation loss decreased (-0.269376 --> -0.274078).  Saving model ...
Epoch: 16 cost time: 0.6222994327545166
Epoch: 16, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.139 Vali Acc: 0.269 Test Loss: 4.139 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5954902172088623
Epoch: 17, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.134 Vali Acc: 0.293 Test Loss: 4.134 Test Acc: 0.293
Validation loss decreased (-0.274078 --> -0.292900).  Saving model ...
Epoch: 18 cost time: 0.6164147853851318
Epoch: 18, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.321 Vali Acc: 0.273 Test Loss: 4.321 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6682052612304688
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.467 Vali Acc: 0.278 Test Loss: 4.467 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5936722755432129
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.464 Vali Acc: 0.281 Test Loss: 4.464 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6079375743865967
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.516 Vali Acc: 0.286 Test Loss: 4.516 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5900869369506836
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.533 Vali Acc: 0.292 Test Loss: 4.533 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7272746562957764
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.622 Vali Acc: 0.289 Test Loss: 4.622 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7346651554107666
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.666 Vali Acc: 0.291 Test Loss: 4.666 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6161403656005859
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.675 Vali Acc: 0.293 Test Loss: 4.675 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6645276546478271
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.679 Vali Acc: 0.295 Test Loss: 4.679 Test Acc: 0.295
Validation loss decreased (-0.292900 --> -0.295247).  Saving model ...
Epoch: 27 cost time: 0.6387314796447754
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.647 Vali Acc: 0.295 Test Loss: 4.647 Test Acc: 0.295
Validation loss decreased (-0.295247 --> -0.295248).  Saving model ...
Epoch: 28 cost time: 0.6990137100219727
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.671 Vali Acc: 0.302 Test Loss: 4.671 Test Acc: 0.302
Validation loss decreased (-0.295248 --> -0.302306).  Saving model ...
Epoch: 29 cost time: 0.7416133880615234
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.740 Vali Acc: 0.291 Test Loss: 4.740 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6896898746490479
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.775 Vali Acc: 0.298 Test Loss: 4.775 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6883699893951416
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.775 Vali Acc: 0.296 Test Loss: 4.775 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.528480052947998
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.811 Vali Acc: 0.293 Test Loss: 4.811 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6326143741607666
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.815 Vali Acc: 0.294 Test Loss: 4.815 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6364190578460693
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.810 Vali Acc: 0.293 Test Loss: 4.810 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7893047332763672
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.792 Vali Acc: 0.301 Test Loss: 4.792 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7226231098175049
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.845 Vali Acc: 0.304 Test Loss: 4.845 Test Acc: 0.304
Validation loss decreased (-0.302306 --> -0.303481).  Saving model ...
Epoch: 37 cost time: 0.6590616703033447
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.886 Vali Acc: 0.304 Test Loss: 4.886 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.594550609588623
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.888 Vali Acc: 0.300 Test Loss: 4.888 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5636589527130127
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.929 Vali Acc: 0.300 Test Loss: 4.929 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5749218463897705
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.956 Vali Acc: 0.298 Test Loss: 4.956 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5864055156707764
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.967 Vali Acc: 0.293 Test Loss: 4.967 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6456162929534912
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.939 Vali Acc: 0.294 Test Loss: 4.939 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.534686803817749
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.942 Vali Acc: 0.296 Test Loss: 4.942 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7204635143280029
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.956 Vali Acc: 0.295 Test Loss: 4.956 Test Acc: 0.295
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6913626194000244
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.982 Vali Acc: 0.292 Test Loss: 4.982 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5468320846557617
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.034 Vali Acc: 0.292 Test Loss: 5.034 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 22457882
model size : 100.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4143614768981934
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.344 Vali Acc: 0.044 Test Loss: 3.344 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.8720211982727051
Epoch: 2, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.341 Vali Acc: 0.085 Test Loss: 3.341 Test Acc: 0.085
Validation loss decreased (-0.043496 --> -0.084672).  Saving model ...
Epoch: 3 cost time: 0.8245484828948975
Epoch: 3, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.284 Vali Acc: 0.068 Test Loss: 3.284 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6593935489654541
Epoch: 4, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.208 Vali Acc: 0.133 Test Loss: 3.208 Test Acc: 0.133
Validation loss decreased (-0.084672 --> -0.132909).  Saving model ...
Epoch: 5 cost time: 0.686173677444458
Epoch: 5, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.196 Vali Acc: 0.168 Test Loss: 3.196 Test Acc: 0.168
Validation loss decreased (-0.132909 --> -0.168203).  Saving model ...
Epoch: 6 cost time: 0.7028484344482422
Epoch: 6, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.162 Vali Acc: 0.187 Test Loss: 3.162 Test Acc: 0.187
Validation loss decreased (-0.168203 --> -0.187027).  Saving model ...
Epoch: 7 cost time: 0.8771884441375732
Epoch: 7, Steps: 10 | Train Loss: 1.543 Vali Loss: 3.305 Vali Acc: 0.209 Test Loss: 3.305 Test Acc: 0.209
Validation loss decreased (-0.187027 --> -0.209379).  Saving model ...
Epoch: 8 cost time: 0.9599859714508057
Epoch: 8, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.760 Vali Acc: 0.214 Test Loss: 3.760 Test Acc: 0.214
Validation loss decreased (-0.209379 --> -0.214080).  Saving model ...
Epoch: 9 cost time: 0.8561007976531982
Epoch: 9, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.960 Vali Acc: 0.261 Test Loss: 3.960 Test Acc: 0.261
Validation loss decreased (-0.214080 --> -0.261137).  Saving model ...
Epoch: 10 cost time: 1.0935657024383545
Epoch: 10, Steps: 10 | Train Loss: 0.413 Vali Loss: 4.470 Vali Acc: 0.281 Test Loss: 4.470 Test Acc: 0.281
Validation loss decreased (-0.261137 --> -0.281132).  Saving model ...
Epoch: 11 cost time: 0.8072142601013184
Epoch: 11, Steps: 10 | Train Loss: 0.298 Vali Loss: 4.744 Vali Acc: 0.274 Test Loss: 4.744 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5676393508911133
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 5.434 Vali Acc: 0.233 Test Loss: 5.434 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7217493057250977
Epoch: 13, Steps: 10 | Train Loss: 0.135 Vali Loss: 5.172 Vali Acc: 0.262 Test Loss: 5.172 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7683241367340088
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.455 Vali Acc: 0.286 Test Loss: 5.455 Test Acc: 0.286
Validation loss decreased (-0.281132 --> -0.285828).  Saving model ...
Epoch: 15 cost time: 0.651052713394165
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.382 Vali Acc: 0.288 Test Loss: 5.382 Test Acc: 0.288
Validation loss decreased (-0.285828 --> -0.288181).  Saving model ...
Epoch: 16 cost time: 0.8864960670471191
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.561 Vali Acc: 0.287 Test Loss: 5.561 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.377610206604004
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.595 Vali Acc: 0.296 Test Loss: 5.595 Test Acc: 0.296
Validation loss decreased (-0.288181 --> -0.296415).  Saving model ...
Epoch: 18 cost time: 0.6664392948150635
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.820 Vali Acc: 0.281 Test Loss: 5.820 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5915873050689697
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.053 Vali Acc: 0.267 Test Loss: 6.053 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5869712829589844
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.576 Vali Acc: 0.289 Test Loss: 5.576 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6941757202148438
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.864 Vali Acc: 0.292 Test Loss: 5.864 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5933771133422852
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.020 Vali Acc: 0.282 Test Loss: 6.020 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6469588279724121
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.885 Vali Acc: 0.291 Test Loss: 5.885 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7988603115081787
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.890 Vali Acc: 0.296 Test Loss: 5.890 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5063290596008301
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.884 Vali Acc: 0.296 Test Loss: 5.884 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4742012023925781
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.879 Vali Acc: 0.300 Test Loss: 5.879 Test Acc: 0.300
Validation loss decreased (-0.296415 --> -0.299941).  Saving model ...
Epoch: 27 cost time: 0.7518875598907471
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.868 Vali Acc: 0.301 Test Loss: 5.868 Test Acc: 0.301
Validation loss decreased (-0.299941 --> -0.301118).  Saving model ...
Epoch: 28 cost time: 1.3950605392456055
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.876 Vali Acc: 0.300 Test Loss: 5.876 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.186161994934082
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.879 Vali Acc: 0.301 Test Loss: 5.879 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.129455804824829
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.872 Vali Acc: 0.306 Test Loss: 5.872 Test Acc: 0.306
Validation loss decreased (-0.301118 --> -0.305824).  Saving model ...
Epoch: 31 cost time: 0.9630537033081055
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.872 Vali Acc: 0.305 Test Loss: 5.872 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3526124954223633
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.876 Vali Acc: 0.308 Test Loss: 5.876 Test Acc: 0.308
Validation loss decreased (-0.305824 --> -0.308177).  Saving model ...
Epoch: 33 cost time: 0.9535598754882812
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.872 Vali Acc: 0.305 Test Loss: 5.872 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9226057529449463
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.861 Vali Acc: 0.307 Test Loss: 5.861 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0178143978118896
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.867 Vali Acc: 0.306 Test Loss: 5.867 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5129666328430176
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.881 Vali Acc: 0.305 Test Loss: 5.881 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5964593887329102
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.890 Vali Acc: 0.306 Test Loss: 5.890 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8296806812286377
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.887 Vali Acc: 0.306 Test Loss: 5.887 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9122433662414551
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.882 Vali Acc: 0.307 Test Loss: 5.882 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1074538230895996
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.886 Vali Acc: 0.309 Test Loss: 5.886 Test Acc: 0.309
Validation loss decreased (-0.308177 --> -0.309353).  Saving model ...
Epoch: 41 cost time: 0.7945530414581299
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.886 Vali Acc: 0.308 Test Loss: 5.886 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8566064834594727
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.879 Vali Acc: 0.304 Test Loss: 5.879 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7991640567779541
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.877 Vali Acc: 0.306 Test Loss: 5.877 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5782270431518555
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.883 Vali Acc: 0.308 Test Loss: 5.883 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8918781280517578
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.892 Vali Acc: 0.306 Test Loss: 5.892 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6691350936889648
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.890 Vali Acc: 0.313 Test Loss: 5.890 Test Acc: 0.313
Validation loss decreased (-0.309353 --> -0.312882).  Saving model ...
Epoch: 47 cost time: 0.6989035606384277
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.925 Vali Acc: 0.315 Test Loss: 5.925 Test Acc: 0.315
Validation loss decreased (-0.312882 --> -0.315235).  Saving model ...
Epoch: 48 cost time: 0.6939554214477539
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.920 Vali Acc: 0.312 Test Loss: 5.920 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7380235195159912
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.921 Vali Acc: 0.309 Test Loss: 5.921 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8406381607055664
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.935 Vali Acc: 0.306 Test Loss: 5.935 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31529411764705884
model parameter : 22980890
model size : 102.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2890825271606445
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.361 Vali Acc: 0.039 Test Loss: 3.361 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.6533162593841553
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.338 Vali Acc: 0.047 Test Loss: 3.338 Test Acc: 0.047
Validation loss decreased (-0.038790 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 1.0116045475006104
Epoch: 3, Steps: 10 | Train Loss: 3.036 Vali Loss: 3.344 Vali Acc: 0.066 Test Loss: 3.344 Test Acc: 0.066
Validation loss decreased (-0.047025 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.6968085765838623
Epoch: 4, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.288 Vali Acc: 0.076 Test Loss: 3.288 Test Acc: 0.076
Validation loss decreased (-0.065849 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 0.5456066131591797
Epoch: 5, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.199 Vali Acc: 0.106 Test Loss: 3.199 Test Acc: 0.106
Validation loss decreased (-0.076438 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 0.6945888996124268
Epoch: 6, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.178 Vali Acc: 0.125 Test Loss: 3.178 Test Acc: 0.125
Validation loss decreased (-0.105850 --> -0.124674).  Saving model ...
Epoch: 7 cost time: 0.7201657295227051
Epoch: 7, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.163 Vali Acc: 0.168 Test Loss: 3.163 Test Acc: 0.168
Validation loss decreased (-0.124674 --> -0.168204).  Saving model ...
Epoch: 8 cost time: 0.6373879909515381
Epoch: 8, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.268 Vali Acc: 0.182 Test Loss: 3.268 Test Acc: 0.182
Validation loss decreased (-0.168204 --> -0.182320).  Saving model ...
Epoch: 9 cost time: 0.6626732349395752
Epoch: 9, Steps: 10 | Train Loss: 1.288 Vali Loss: 3.522 Vali Acc: 0.206 Test Loss: 3.522 Test Acc: 0.206
Validation loss decreased (-0.182320 --> -0.205847).  Saving model ...
Epoch: 10 cost time: 1.1360998153686523
Epoch: 10, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.785 Vali Acc: 0.233 Test Loss: 3.785 Test Acc: 0.233
Validation loss decreased (-0.205847 --> -0.232903).  Saving model ...
Epoch: 11 cost time: 1.0545921325683594
Epoch: 11, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.891 Vali Acc: 0.248 Test Loss: 3.891 Test Acc: 0.248
Validation loss decreased (-0.232903 --> -0.248196).  Saving model ...
Epoch: 12 cost time: 0.9464192390441895
Epoch: 12, Steps: 10 | Train Loss: 0.322 Vali Loss: 4.169 Vali Acc: 0.265 Test Loss: 4.169 Test Acc: 0.265
Validation loss decreased (-0.248196 --> -0.264664).  Saving model ...
Epoch: 13 cost time: 0.6775052547454834
Epoch: 13, Steps: 10 | Train Loss: 0.184 Vali Loss: 4.377 Vali Acc: 0.249 Test Loss: 4.377 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7615311145782471
Epoch: 14, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.415 Vali Acc: 0.269 Test Loss: 4.415 Test Acc: 0.269
Validation loss decreased (-0.264664 --> -0.269368).  Saving model ...
Epoch: 15 cost time: 0.5360944271087646
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.623 Vali Acc: 0.281 Test Loss: 4.623 Test Acc: 0.281
Validation loss decreased (-0.269368 --> -0.281130).  Saving model ...
Epoch: 16 cost time: 0.9882268905639648
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.855 Vali Acc: 0.255 Test Loss: 4.855 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8676998615264893
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.960 Vali Acc: 0.249 Test Loss: 4.960 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6361455917358398
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.862 Vali Acc: 0.286 Test Loss: 4.862 Test Acc: 0.286
Validation loss decreased (-0.281130 --> -0.285834).  Saving model ...
Epoch: 19 cost time: 1.2034711837768555
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.975 Vali Acc: 0.279 Test Loss: 4.975 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0057826042175293
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.099 Vali Acc: 0.272 Test Loss: 5.099 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9573314189910889
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.161 Vali Acc: 0.276 Test Loss: 5.161 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.849036693572998
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.083 Vali Acc: 0.296 Test Loss: 5.083 Test Acc: 0.296
Validation loss decreased (-0.285834 --> -0.296420).  Saving model ...
Epoch: 23 cost time: 1.283623218536377
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.038 Vali Acc: 0.311 Test Loss: 5.038 Test Acc: 0.311
Validation loss decreased (-0.296420 --> -0.310538).  Saving model ...
Epoch: 24 cost time: 0.73828125
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.118 Vali Acc: 0.300 Test Loss: 5.118 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9530594348907471
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.092 Vali Acc: 0.306 Test Loss: 5.092 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7218482494354248
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.090 Vali Acc: 0.308 Test Loss: 5.090 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7138855457305908
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.105 Vali Acc: 0.306 Test Loss: 5.105 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8196568489074707
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.115 Vali Acc: 0.306 Test Loss: 5.115 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2323830127716064
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.128 Vali Acc: 0.307 Test Loss: 5.128 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6833040714263916
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.131 Vali Acc: 0.306 Test Loss: 5.131 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7861664295196533
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.142 Vali Acc: 0.312 Test Loss: 5.142 Test Acc: 0.312
Validation loss decreased (-0.310538 --> -0.311713).  Saving model ...
Epoch: 32 cost time: 1.0372076034545898
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.173 Vali Acc: 0.311 Test Loss: 5.173 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0175156593322754
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.194 Vali Acc: 0.307 Test Loss: 5.194 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7754933834075928
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.219 Vali Acc: 0.305 Test Loss: 5.219 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6743323802947998
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.230 Vali Acc: 0.305 Test Loss: 5.230 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7011270523071289
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.198 Vali Acc: 0.308 Test Loss: 5.198 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8646678924560547
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.201 Vali Acc: 0.307 Test Loss: 5.201 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6287004947662354
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.212 Vali Acc: 0.309 Test Loss: 5.212 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7582416534423828
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.246 Vali Acc: 0.308 Test Loss: 5.246 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6513669490814209
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.267 Vali Acc: 0.304 Test Loss: 5.267 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0128931999206543
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.277 Vali Acc: 0.306 Test Loss: 5.277 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 22658330
model size : 101.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2095484733581543
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.332 Vali Acc: 0.060 Test Loss: 3.332 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 0.6413133144378662
Epoch: 2, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.298 Vali Acc: 0.069 Test Loss: 3.298 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.9034411907196045
Epoch: 3, Steps: 10 | Train Loss: 3.069 Vali Loss: 3.319 Vali Acc: 0.079 Test Loss: 3.319 Test Acc: 0.079
Validation loss decreased (-0.069379 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 0.5833454132080078
Epoch: 4, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.297 Vali Acc: 0.073 Test Loss: 3.297 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.547022819519043
Epoch: 5, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.265 Vali Acc: 0.099 Test Loss: 3.265 Test Acc: 0.099
Validation loss decreased (-0.078790 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 0.591881513595581
Epoch: 6, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.233 Vali Acc: 0.100 Test Loss: 3.233 Test Acc: 0.100
Validation loss decreased (-0.098791 --> -0.099968).  Saving model ...
Epoch: 7 cost time: 0.5514249801635742
Epoch: 7, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.192 Vali Acc: 0.126 Test Loss: 3.192 Test Acc: 0.126
Validation loss decreased (-0.099968 --> -0.125850).  Saving model ...
Epoch: 8 cost time: 0.6047027111053467
Epoch: 8, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.147 Vali Acc: 0.166 Test Loss: 3.147 Test Acc: 0.166
Validation loss decreased (-0.125850 --> -0.165851).  Saving model ...
Epoch: 9 cost time: 0.5840575695037842
Epoch: 9, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.193 Vali Acc: 0.173 Test Loss: 3.193 Test Acc: 0.173
Validation loss decreased (-0.165851 --> -0.172909).  Saving model ...
Epoch: 10 cost time: 0.822819709777832
Epoch: 10, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.329 Vali Acc: 0.171 Test Loss: 3.329 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7231748104095459
Epoch: 11, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.476 Vali Acc: 0.218 Test Loss: 3.476 Test Acc: 0.218
Validation loss decreased (-0.172909 --> -0.217612).  Saving model ...
Epoch: 12 cost time: 0.6270129680633545
Epoch: 12, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.583 Vali Acc: 0.192 Test Loss: 3.583 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.617584228515625
Epoch: 13, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.739 Vali Acc: 0.231 Test Loss: 3.739 Test Acc: 0.231
Validation loss decreased (-0.217612 --> -0.230551).  Saving model ...
Epoch: 14 cost time: 0.7259330749511719
Epoch: 14, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.789 Vali Acc: 0.242 Test Loss: 3.789 Test Acc: 0.242
Validation loss decreased (-0.230551 --> -0.242315).  Saving model ...
Epoch: 15 cost time: 0.8354966640472412
Epoch: 15, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.860 Vali Acc: 0.260 Test Loss: 3.860 Test Acc: 0.260
Validation loss decreased (-0.242315 --> -0.259961).  Saving model ...
Epoch: 16 cost time: 0.8227455615997314
Epoch: 16, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.960 Vali Acc: 0.265 Test Loss: 3.960 Test Acc: 0.265
Validation loss decreased (-0.259961 --> -0.264666).  Saving model ...
Epoch: 17 cost time: 0.8629443645477295
Epoch: 17, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.192 Vali Acc: 0.276 Test Loss: 4.192 Test Acc: 0.276
Validation loss decreased (-0.264666 --> -0.276429).  Saving model ...
Epoch: 18 cost time: 0.8011245727539062
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.223 Vali Acc: 0.269 Test Loss: 4.223 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5408108234405518
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.226 Vali Acc: 0.281 Test Loss: 4.226 Test Acc: 0.281
Validation loss decreased (-0.276429 --> -0.281134).  Saving model ...
Epoch: 20 cost time: 0.6544709205627441
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.391 Vali Acc: 0.285 Test Loss: 4.391 Test Acc: 0.285
Validation loss decreased (-0.281134 --> -0.284662).  Saving model ...
Epoch: 21 cost time: 0.6362638473510742
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.398 Vali Acc: 0.294 Test Loss: 4.398 Test Acc: 0.294
Validation loss decreased (-0.284662 --> -0.294074).  Saving model ...
Epoch: 22 cost time: 0.5947027206420898
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.400 Vali Acc: 0.289 Test Loss: 4.400 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6137466430664062
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.549 Vali Acc: 0.281 Test Loss: 4.549 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6090521812438965
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.546 Vali Acc: 0.295 Test Loss: 4.546 Test Acc: 0.295
Validation loss decreased (-0.294074 --> -0.295249).  Saving model ...
Epoch: 25 cost time: 0.7144520282745361
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.516 Vali Acc: 0.299 Test Loss: 4.516 Test Acc: 0.299
Validation loss decreased (-0.295249 --> -0.298778).  Saving model ...
Epoch: 26 cost time: 0.7377290725708008
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.515 Vali Acc: 0.299 Test Loss: 4.515 Test Acc: 0.299
Validation loss decreased (-0.298778 --> -0.298778).  Saving model ...
Epoch: 27 cost time: 0.7787220478057861
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.570 Vali Acc: 0.291 Test Loss: 4.570 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7568337917327881
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.602 Vali Acc: 0.293 Test Loss: 4.602 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6489803791046143
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.606 Vali Acc: 0.295 Test Loss: 4.606 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6774594783782959
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.660 Vali Acc: 0.286 Test Loss: 4.660 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8539512157440186
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.681 Vali Acc: 0.293 Test Loss: 4.681 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.49684929847717285
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.709 Vali Acc: 0.286 Test Loss: 4.709 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5129742622375488
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.751 Vali Acc: 0.296 Test Loss: 4.751 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6175532341003418
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.732 Vali Acc: 0.294 Test Loss: 4.732 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5590410232543945
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.742 Vali Acc: 0.296 Test Loss: 4.742 Test Acc: 0.296
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5385160446166992
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.745 Vali Acc: 0.305 Test Loss: 4.745 Test Acc: 0.305
Validation loss decreased (-0.298778 --> -0.304658).  Saving model ...
Epoch: 37 cost time: 0.5689001083374023
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.760 Vali Acc: 0.302 Test Loss: 4.760 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.576744556427002
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.792 Vali Acc: 0.298 Test Loss: 4.792 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7818684577941895
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.829 Vali Acc: 0.306 Test Loss: 4.829 Test Acc: 0.306
Validation loss decreased (-0.304658 --> -0.305834).  Saving model ...
Epoch: 40 cost time: 0.7191557884216309
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.831 Vali Acc: 0.302 Test Loss: 4.831 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6091046333312988
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.857 Vali Acc: 0.306 Test Loss: 4.857 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5612092018127441
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.870 Vali Acc: 0.307 Test Loss: 4.870 Test Acc: 0.307
Validation loss decreased (-0.305834 --> -0.307010).  Saving model ...
Epoch: 43 cost time: 0.6267416477203369
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.882 Vali Acc: 0.308 Test Loss: 4.882 Test Acc: 0.308
Validation loss decreased (-0.307010 --> -0.308186).  Saving model ...
Epoch: 44 cost time: 0.5994749069213867
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.907 Vali Acc: 0.299 Test Loss: 4.907 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5518126487731934
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.918 Vali Acc: 0.302 Test Loss: 4.918 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5325446128845215
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.918 Vali Acc: 0.306 Test Loss: 4.918 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8538765907287598
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.921 Vali Acc: 0.306 Test Loss: 4.921 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6379172801971436
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.935 Vali Acc: 0.307 Test Loss: 4.935 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5605909824371338
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.943 Vali Acc: 0.306 Test Loss: 4.943 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5382571220397949
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.974 Vali Acc: 0.305 Test Loss: 4.974 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 22443290
model size : 100.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2879931926727295
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.346 Vali Acc: 0.044 Test Loss: 3.346 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.5409572124481201
Epoch: 2, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.376 Vali Acc: 0.080 Test Loss: 3.376 Test Acc: 0.080
Validation loss decreased (-0.043496 --> -0.079966).  Saving model ...
Epoch: 3 cost time: 0.5759804248809814
Epoch: 3, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.305 Vali Acc: 0.099 Test Loss: 3.305 Test Acc: 0.099
Validation loss decreased (-0.079966 --> -0.098790).  Saving model ...
Epoch: 4 cost time: 0.9291176795959473
Epoch: 4, Steps: 10 | Train Loss: 2.723 Vali Loss: 3.179 Vali Acc: 0.134 Test Loss: 3.179 Test Acc: 0.134
Validation loss decreased (-0.098790 --> -0.134086).  Saving model ...
Epoch: 5 cost time: 0.8934316635131836
Epoch: 5, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.172 Vali Acc: 0.159 Test Loss: 3.172 Test Acc: 0.159
Validation loss decreased (-0.134086 --> -0.158792).  Saving model ...
Epoch: 6 cost time: 0.5687768459320068
Epoch: 6, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.177 Vali Acc: 0.195 Test Loss: 3.177 Test Acc: 0.195
Validation loss decreased (-0.158792 --> -0.195262).  Saving model ...
Epoch: 7 cost time: 0.743523359298706
Epoch: 7, Steps: 10 | Train Loss: 1.663 Vali Loss: 3.251 Vali Acc: 0.207 Test Loss: 3.251 Test Acc: 0.207
Validation loss decreased (-0.195262 --> -0.207026).  Saving model ...
Epoch: 8 cost time: 0.9757370948791504
Epoch: 8, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.558 Vali Acc: 0.220 Test Loss: 3.558 Test Acc: 0.220
Validation loss decreased (-0.207026 --> -0.219964).  Saving model ...
Epoch: 9 cost time: 0.7337403297424316
Epoch: 9, Steps: 10 | Train Loss: 0.640 Vali Loss: 4.073 Vali Acc: 0.236 Test Loss: 4.073 Test Acc: 0.236
Validation loss decreased (-0.219964 --> -0.236430).  Saving model ...
Epoch: 10 cost time: 0.788191556930542
Epoch: 10, Steps: 10 | Train Loss: 0.375 Vali Loss: 4.245 Vali Acc: 0.254 Test Loss: 4.245 Test Acc: 0.254
Validation loss decreased (-0.236430 --> -0.254075).  Saving model ...
Epoch: 11 cost time: 0.8169424533843994
Epoch: 11, Steps: 10 | Train Loss: 0.256 Vali Loss: 4.706 Vali Acc: 0.271 Test Loss: 4.706 Test Acc: 0.271
Validation loss decreased (-0.254075 --> -0.270541).  Saving model ...
Epoch: 12 cost time: 0.6941561698913574
Epoch: 12, Steps: 10 | Train Loss: 0.174 Vali Loss: 5.194 Vali Acc: 0.252 Test Loss: 5.194 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8027863502502441
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 5.180 Vali Acc: 0.273 Test Loss: 5.180 Test Acc: 0.273
Validation loss decreased (-0.270541 --> -0.272889).  Saving model ...
Epoch: 14 cost time: 0.9955425262451172
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 5.352 Vali Acc: 0.266 Test Loss: 5.352 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.015507698059082
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.995 Vali Acc: 0.265 Test Loss: 5.995 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9514625072479248
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 5.792 Vali Acc: 0.286 Test Loss: 5.792 Test Acc: 0.286
Validation loss decreased (-0.272889 --> -0.285824).  Saving model ...
Epoch: 17 cost time: 0.8131623268127441
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 5.899 Vali Acc: 0.286 Test Loss: 5.899 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6127607822418213
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.217 Vali Acc: 0.264 Test Loss: 6.217 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6883354187011719
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.231 Vali Acc: 0.279 Test Loss: 6.231 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5105195045471191
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.094 Vali Acc: 0.289 Test Loss: 6.094 Test Acc: 0.289
Validation loss decreased (-0.285824 --> -0.289351).  Saving model ...
Epoch: 21 cost time: 0.6965606212615967
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.071 Vali Acc: 0.294 Test Loss: 6.071 Test Acc: 0.294
Validation loss decreased (-0.289351 --> -0.294057).  Saving model ...
Epoch: 22 cost time: 0.9497103691101074
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.980 Vali Acc: 0.305 Test Loss: 5.980 Test Acc: 0.305
Validation loss decreased (-0.294057 --> -0.304646).  Saving model ...
Epoch: 23 cost time: 0.688554048538208
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.318 Vali Acc: 0.273 Test Loss: 6.318 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.325136661529541
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.589 Vali Acc: 0.281 Test Loss: 6.589 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.006695032119751
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.068 Vali Acc: 0.307 Test Loss: 6.068 Test Acc: 0.307
Validation loss decreased (-0.304646 --> -0.306998).  Saving model ...
Epoch: 26 cost time: 1.2445621490478516
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.099 Vali Acc: 0.294 Test Loss: 6.099 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.927701473236084
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.089 Vali Acc: 0.293 Test Loss: 6.089 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9930627346038818
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.146 Vali Acc: 0.299 Test Loss: 6.146 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3122539520263672
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.117 Vali Acc: 0.305 Test Loss: 6.117 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.069657325744629
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.203 Vali Acc: 0.304 Test Loss: 6.203 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7823319435119629
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.262 Vali Acc: 0.309 Test Loss: 6.262 Test Acc: 0.309
Validation loss decreased (-0.306998 --> -0.309349).  Saving model ...
Epoch: 32 cost time: 0.7496271133422852
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.294 Vali Acc: 0.306 Test Loss: 6.294 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6245851516723633
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.146 Vali Acc: 0.313 Test Loss: 6.146 Test Acc: 0.313
Validation loss decreased (-0.309349 --> -0.312880).  Saving model ...
Epoch: 34 cost time: 0.7108266353607178
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.202 Vali Acc: 0.301 Test Loss: 6.202 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7618060111999512
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.230 Vali Acc: 0.299 Test Loss: 6.230 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7564804553985596
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.231 Vali Acc: 0.299 Test Loss: 6.231 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7348663806915283
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.223 Vali Acc: 0.302 Test Loss: 6.223 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.677025556564331
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.219 Vali Acc: 0.304 Test Loss: 6.219 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5920515060424805
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.223 Vali Acc: 0.308 Test Loss: 6.223 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7001829147338867
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.228 Vali Acc: 0.308 Test Loss: 6.228 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.743499755859375
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.232 Vali Acc: 0.309 Test Loss: 6.232 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8248662948608398
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.233 Vali Acc: 0.306 Test Loss: 6.233 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.482724666595459
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.238 Vali Acc: 0.306 Test Loss: 6.238 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 22994714
model size : 102.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.129974842071533
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.345 Vali Acc: 0.042 Test Loss: 3.345 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.7089381217956543
Epoch: 2, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.373 Vali Acc: 0.054 Test Loss: 3.373 Test Acc: 0.054
Validation loss decreased (-0.042319 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.5880546569824219
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.340 Vali Acc: 0.067 Test Loss: 3.340 Test Acc: 0.067
Validation loss decreased (-0.054084 --> -0.067025).  Saving model ...
Epoch: 4 cost time: 0.4960317611694336
Epoch: 4, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.284 Vali Acc: 0.095 Test Loss: 3.284 Test Acc: 0.095
Validation loss decreased (-0.067025 --> -0.095261).  Saving model ...
Epoch: 5 cost time: 0.6310286521911621
Epoch: 5, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.253 Vali Acc: 0.100 Test Loss: 3.253 Test Acc: 0.100
Validation loss decreased (-0.095261 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 1.0351715087890625
Epoch: 6, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.216 Vali Acc: 0.140 Test Loss: 3.216 Test Acc: 0.140
Validation loss decreased (-0.099967 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 0.70707106590271
Epoch: 7, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.176 Vali Acc: 0.144 Test Loss: 3.176 Test Acc: 0.144
Validation loss decreased (-0.139968 --> -0.143498).  Saving model ...
Epoch: 8 cost time: 0.6496148109436035
Epoch: 8, Steps: 10 | Train Loss: 1.858 Vali Loss: 3.230 Vali Acc: 0.176 Test Loss: 3.230 Test Acc: 0.176
Validation loss decreased (-0.143498 --> -0.176438).  Saving model ...
Epoch: 9 cost time: 0.8738095760345459
Epoch: 9, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.388 Vali Acc: 0.204 Test Loss: 3.388 Test Acc: 0.204
Validation loss decreased (-0.176438 --> -0.203496).  Saving model ...
Epoch: 10 cost time: 1.1010046005249023
Epoch: 10, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.635 Vali Acc: 0.240 Test Loss: 3.635 Test Acc: 0.240
Validation loss decreased (-0.203496 --> -0.239964).  Saving model ...
Epoch: 11 cost time: 0.8817727565765381
Epoch: 11, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.822 Vali Acc: 0.251 Test Loss: 3.822 Test Acc: 0.251
Validation loss decreased (-0.239964 --> -0.250550).  Saving model ...
Epoch: 12 cost time: 0.9706563949584961
Epoch: 12, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.960 Vali Acc: 0.267 Test Loss: 3.960 Test Acc: 0.267
Validation loss decreased (-0.250550 --> -0.267019).  Saving model ...
Epoch: 13 cost time: 0.6036858558654785
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.089 Vali Acc: 0.281 Test Loss: 4.089 Test Acc: 0.281
Validation loss decreased (-0.267019 --> -0.281136).  Saving model ...
Epoch: 14 cost time: 0.8803689479827881
Epoch: 14, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.241 Vali Acc: 0.296 Test Loss: 4.241 Test Acc: 0.296
Validation loss decreased (-0.281136 --> -0.296428).  Saving model ...
Epoch: 15 cost time: 0.6784191131591797
Epoch: 15, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.493 Vali Acc: 0.268 Test Loss: 4.493 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9035320281982422
Epoch: 16, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.530 Vali Acc: 0.296 Test Loss: 4.530 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.715228796005249
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.848 Vali Acc: 0.308 Test Loss: 4.848 Test Acc: 0.308
Validation loss decreased (-0.296428 --> -0.308187).  Saving model ...
Epoch: 18 cost time: 1.0286860466003418
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.839 Vali Acc: 0.307 Test Loss: 4.839 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7350802421569824
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.909 Vali Acc: 0.287 Test Loss: 4.909 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7342751026153564
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.802 Vali Acc: 0.312 Test Loss: 4.802 Test Acc: 0.312
Validation loss decreased (-0.308187 --> -0.311717).  Saving model ...
Epoch: 21 cost time: 0.6750001907348633
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.907 Vali Acc: 0.311 Test Loss: 4.907 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6665050983428955
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.936 Vali Acc: 0.305 Test Loss: 4.936 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6680154800415039
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.903 Vali Acc: 0.315 Test Loss: 4.903 Test Acc: 0.315
Validation loss decreased (-0.311717 --> -0.315245).  Saving model ...
Epoch: 24 cost time: 0.6310834884643555
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.929 Vali Acc: 0.315 Test Loss: 4.929 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8817687034606934
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.953 Vali Acc: 0.313 Test Loss: 4.953 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7966353893280029
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.940 Vali Acc: 0.308 Test Loss: 4.940 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8583698272705078
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.916 Vali Acc: 0.316 Test Loss: 4.916 Test Acc: 0.316
Validation loss decreased (-0.315245 --> -0.316421).  Saving model ...
Epoch: 28 cost time: 0.9700725078582764
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.945 Vali Acc: 0.313 Test Loss: 4.945 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.086275339126587
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.011 Vali Acc: 0.308 Test Loss: 5.011 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6570003032684326
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.019 Vali Acc: 0.308 Test Loss: 5.019 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5911626815795898
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.006 Vali Acc: 0.312 Test Loss: 5.006 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9552161693572998
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.018 Vali Acc: 0.315 Test Loss: 5.018 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.006866216659546
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.022 Vali Acc: 0.320 Test Loss: 5.022 Test Acc: 0.320
Validation loss decreased (-0.316421 --> -0.319950).  Saving model ...
Epoch: 34 cost time: 1.1567366123199463
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.030 Vali Acc: 0.314 Test Loss: 5.030 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1365718841552734
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.093 Vali Acc: 0.313 Test Loss: 5.093 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9450404644012451
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.093 Vali Acc: 0.313 Test Loss: 5.093 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8376903533935547
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.074 Vali Acc: 0.312 Test Loss: 5.074 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6550750732421875
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.081 Vali Acc: 0.313 Test Loss: 5.081 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8460109233856201
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.094 Vali Acc: 0.318 Test Loss: 5.094 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6468174457550049
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.119 Vali Acc: 0.316 Test Loss: 5.119 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6582188606262207
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.124 Vali Acc: 0.313 Test Loss: 5.124 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.48918890953063965
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.139 Vali Acc: 0.313 Test Loss: 5.139 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6438164710998535
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.161 Vali Acc: 0.306 Test Loss: 5.161 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 22629146
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7044878005981445
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.403 Vali Acc: 0.052 Test Loss: 3.403 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 0.5519890785217285
Epoch: 2, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.348 Vali Acc: 0.049 Test Loss: 3.348 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6677711009979248
Epoch: 3, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.317 Vali Acc: 0.062 Test Loss: 3.317 Test Acc: 0.062
Validation loss decreased (-0.051731 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.6277813911437988
Epoch: 4, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.300 Vali Acc: 0.054 Test Loss: 3.300 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5548722743988037
Epoch: 5, Steps: 10 | Train Loss: 2.929 Vali Loss: 3.287 Vali Acc: 0.089 Test Loss: 3.287 Test Acc: 0.089
Validation loss decreased (-0.062320 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 0.5872104167938232
Epoch: 6, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.262 Vali Acc: 0.113 Test Loss: 3.262 Test Acc: 0.113
Validation loss decreased (-0.089379 --> -0.112909).  Saving model ...
Epoch: 7 cost time: 0.6560461521148682
Epoch: 7, Steps: 10 | Train Loss: 2.590 Vali Loss: 3.200 Vali Acc: 0.133 Test Loss: 3.200 Test Acc: 0.133
Validation loss decreased (-0.112909 --> -0.132909).  Saving model ...
Epoch: 8 cost time: 0.639509916305542
Epoch: 8, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.163 Vali Acc: 0.162 Test Loss: 3.163 Test Acc: 0.162
Validation loss decreased (-0.132909 --> -0.162321).  Saving model ...
Epoch: 9 cost time: 0.5999963283538818
Epoch: 9, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.229 Vali Acc: 0.165 Test Loss: 3.229 Test Acc: 0.165
Validation loss decreased (-0.162321 --> -0.164674).  Saving model ...
Epoch: 10 cost time: 0.6172463893890381
Epoch: 10, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.308 Vali Acc: 0.168 Test Loss: 3.308 Test Acc: 0.168
Validation loss decreased (-0.164674 --> -0.168202).  Saving model ...
Epoch: 11 cost time: 0.7342896461486816
Epoch: 11, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.297 Vali Acc: 0.207 Test Loss: 3.297 Test Acc: 0.207
Validation loss decreased (-0.168202 --> -0.207026).  Saving model ...
Epoch: 12 cost time: 0.5295102596282959
Epoch: 12, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.429 Vali Acc: 0.220 Test Loss: 3.429 Test Acc: 0.220
Validation loss decreased (-0.207026 --> -0.219966).  Saving model ...
Epoch: 13 cost time: 0.5871424674987793
Epoch: 13, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.511 Vali Acc: 0.239 Test Loss: 3.511 Test Acc: 0.239
Validation loss decreased (-0.219966 --> -0.238788).  Saving model ...
Epoch: 14 cost time: 0.6971361637115479
Epoch: 14, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.575 Vali Acc: 0.254 Test Loss: 3.575 Test Acc: 0.254
Validation loss decreased (-0.238788 --> -0.254082).  Saving model ...
Epoch: 15 cost time: 0.5467092990875244
Epoch: 15, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.671 Vali Acc: 0.264 Test Loss: 3.671 Test Acc: 0.264
Validation loss decreased (-0.254082 --> -0.263493).  Saving model ...
Epoch: 16 cost time: 0.6263785362243652
Epoch: 16, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.856 Vali Acc: 0.267 Test Loss: 3.856 Test Acc: 0.267
Validation loss decreased (-0.263493 --> -0.267020).  Saving model ...
Epoch: 17 cost time: 0.46214747428894043
Epoch: 17, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.939 Vali Acc: 0.282 Test Loss: 3.939 Test Acc: 0.282
Validation loss decreased (-0.267020 --> -0.282314).  Saving model ...
Epoch: 18 cost time: 0.5171482563018799
Epoch: 18, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.055 Vali Acc: 0.286 Test Loss: 4.055 Test Acc: 0.286
Validation loss decreased (-0.282314 --> -0.285842).  Saving model ...
Epoch: 19 cost time: 0.5236198902130127
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.037 Vali Acc: 0.295 Test Loss: 4.037 Test Acc: 0.295
Validation loss decreased (-0.285842 --> -0.295254).  Saving model ...
Epoch: 20 cost time: 0.5931706428527832
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.250 Vali Acc: 0.272 Test Loss: 4.250 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7007803916931152
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.262 Vali Acc: 0.282 Test Loss: 4.262 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6280438899993896
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.297 Vali Acc: 0.280 Test Loss: 4.297 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6461412906646729
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.314 Vali Acc: 0.279 Test Loss: 4.314 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5938234329223633
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.362 Vali Acc: 0.286 Test Loss: 4.362 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5568792819976807
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.397 Vali Acc: 0.286 Test Loss: 4.397 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5734808444976807
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.412 Vali Acc: 0.288 Test Loss: 4.412 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6310138702392578
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.415 Vali Acc: 0.291 Test Loss: 4.415 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8252418041229248
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.441 Vali Acc: 0.296 Test Loss: 4.441 Test Acc: 0.296
Validation loss decreased (-0.295254 --> -0.296426).  Saving model ...
Epoch: 29 cost time: 0.5494129657745361
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.482 Vali Acc: 0.295 Test Loss: 4.482 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6903157234191895
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.503 Vali Acc: 0.296 Test Loss: 4.503 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7870767116546631
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.499 Vali Acc: 0.296 Test Loss: 4.499 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6039540767669678
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.546 Vali Acc: 0.286 Test Loss: 4.546 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6946136951446533
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.564 Vali Acc: 0.291 Test Loss: 4.564 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6293830871582031
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.583 Vali Acc: 0.296 Test Loss: 4.583 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5185742378234863
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.628 Vali Acc: 0.295 Test Loss: 4.628 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5230376720428467
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.617 Vali Acc: 0.298 Test Loss: 4.617 Test Acc: 0.298
Validation loss decreased (-0.296426 --> -0.297601).  Saving model ...
Epoch: 37 cost time: 0.5318968296051025
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.625 Vali Acc: 0.302 Test Loss: 4.625 Test Acc: 0.302
Validation loss decreased (-0.297601 --> -0.302307).  Saving model ...
Epoch: 38 cost time: 0.5600879192352295
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.648 Vali Acc: 0.298 Test Loss: 4.648 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6328463554382324
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.644 Vali Acc: 0.301 Test Loss: 4.644 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5354654788970947
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.648 Vali Acc: 0.300 Test Loss: 4.648 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6423254013061523
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.681 Vali Acc: 0.299 Test Loss: 4.681 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5238039493560791
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.716 Vali Acc: 0.299 Test Loss: 4.716 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5032451152801514
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.717 Vali Acc: 0.300 Test Loss: 4.717 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5585136413574219
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.714 Vali Acc: 0.302 Test Loss: 4.714 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6585655212402344
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.736 Vali Acc: 0.300 Test Loss: 4.736 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6491169929504395
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.762 Vali Acc: 0.300 Test Loss: 4.762 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.613070011138916
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.767 Vali Acc: 0.300 Test Loss: 4.767 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 22435610
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3352737426757812
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.304 Vali Acc: 0.045 Test Loss: 3.304 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.8598895072937012
Epoch: 2, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.403 Vali Acc: 0.075 Test Loss: 3.403 Test Acc: 0.075
Validation loss decreased (-0.044673 --> -0.075260).  Saving model ...
Epoch: 3 cost time: 0.8116357326507568
Epoch: 3, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.316 Vali Acc: 0.071 Test Loss: 3.316 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5962774753570557
Epoch: 4, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.227 Vali Acc: 0.107 Test Loss: 3.227 Test Acc: 0.107
Validation loss decreased (-0.075260 --> -0.107027).  Saving model ...
Epoch: 5 cost time: 0.5033936500549316
Epoch: 5, Steps: 10 | Train Loss: 2.503 Vali Loss: 3.165 Vali Acc: 0.135 Test Loss: 3.165 Test Acc: 0.135
Validation loss decreased (-0.107027 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 0.5072178840637207
Epoch: 6, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.203 Vali Acc: 0.184 Test Loss: 3.203 Test Acc: 0.184
Validation loss decreased (-0.135262 --> -0.183497).  Saving model ...
Epoch: 7 cost time: 0.585352897644043
Epoch: 7, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.363 Vali Acc: 0.195 Test Loss: 3.363 Test Acc: 0.195
Validation loss decreased (-0.183497 --> -0.195260).  Saving model ...
Epoch: 8 cost time: 0.5778927803039551
Epoch: 8, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.490 Vali Acc: 0.235 Test Loss: 3.490 Test Acc: 0.235
Validation loss decreased (-0.195260 --> -0.235259).  Saving model ...
Epoch: 9 cost time: 0.6076700687408447
Epoch: 9, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.826 Vali Acc: 0.222 Test Loss: 3.826 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5293374061584473
Epoch: 10, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.995 Vali Acc: 0.274 Test Loss: 3.995 Test Acc: 0.274
Validation loss decreased (-0.235259 --> -0.274078).  Saving model ...
Epoch: 11 cost time: 0.6088275909423828
Epoch: 11, Steps: 10 | Train Loss: 0.234 Vali Loss: 4.211 Vali Acc: 0.269 Test Loss: 4.211 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5407977104187012
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 4.573 Vali Acc: 0.264 Test Loss: 4.573 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5765118598937988
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.822 Vali Acc: 0.281 Test Loss: 4.822 Test Acc: 0.281
Validation loss decreased (-0.274078 --> -0.281128).  Saving model ...
Epoch: 14 cost time: 0.6129453182220459
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.920 Vali Acc: 0.280 Test Loss: 4.920 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7002139091491699
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.129 Vali Acc: 0.279 Test Loss: 5.129 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7636532783508301
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.006 Vali Acc: 0.291 Test Loss: 5.006 Test Acc: 0.291
Validation loss decreased (-0.281128 --> -0.290538).  Saving model ...
Epoch: 17 cost time: 0.6391439437866211
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.153 Vali Acc: 0.282 Test Loss: 5.153 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8628921508789062
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.253 Vali Acc: 0.284 Test Loss: 5.253 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0232045650482178
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.329 Vali Acc: 0.280 Test Loss: 5.329 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5437161922454834
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.350 Vali Acc: 0.294 Test Loss: 5.350 Test Acc: 0.294
Validation loss decreased (-0.290538 --> -0.294064).  Saving model ...
Epoch: 21 cost time: 0.6121954917907715
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.467 Vali Acc: 0.279 Test Loss: 5.467 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4705657958984375
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.350 Vali Acc: 0.292 Test Loss: 5.350 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4836292266845703
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.356 Vali Acc: 0.292 Test Loss: 5.356 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5690197944641113
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.286 Vali Acc: 0.291 Test Loss: 5.286 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7213115692138672
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.261 Vali Acc: 0.296 Test Loss: 5.261 Test Acc: 0.296
Validation loss decreased (-0.294064 --> -0.296418).  Saving model ...
Epoch: 26 cost time: 0.6552209854125977
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.264 Vali Acc: 0.306 Test Loss: 5.264 Test Acc: 0.306
Validation loss decreased (-0.296418 --> -0.305830).  Saving model ...
Epoch: 27 cost time: 0.62479567527771
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.269 Vali Acc: 0.306 Test Loss: 5.269 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5953211784362793
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.321 Vali Acc: 0.304 Test Loss: 5.321 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5570638179779053
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.356 Vali Acc: 0.299 Test Loss: 5.356 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6341118812561035
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.336 Vali Acc: 0.304 Test Loss: 5.336 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6807661056518555
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.333 Vali Acc: 0.304 Test Loss: 5.333 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6157302856445312
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.344 Vali Acc: 0.301 Test Loss: 5.344 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9343471527099609
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.353 Vali Acc: 0.305 Test Loss: 5.353 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5627527236938477
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.352 Vali Acc: 0.307 Test Loss: 5.352 Test Acc: 0.307
Validation loss decreased (-0.305830 --> -0.307005).  Saving model ...
Epoch: 35 cost time: 0.7753210067749023
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.348 Vali Acc: 0.307 Test Loss: 5.348 Test Acc: 0.307
Validation loss decreased (-0.307005 --> -0.307005).  Saving model ...
Epoch: 36 cost time: 0.7125787734985352
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.365 Vali Acc: 0.305 Test Loss: 5.365 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6659121513366699
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.376 Vali Acc: 0.306 Test Loss: 5.376 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7475306987762451
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.386 Vali Acc: 0.305 Test Loss: 5.386 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6199960708618164
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.400 Vali Acc: 0.305 Test Loss: 5.400 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8267121315002441
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.431 Vali Acc: 0.301 Test Loss: 5.431 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6790494918823242
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.421 Vali Acc: 0.304 Test Loss: 5.421 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9255635738372803
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.424 Vali Acc: 0.306 Test Loss: 5.424 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9334163665771484
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.430 Vali Acc: 0.306 Test Loss: 5.430 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1126797199249268
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.444 Vali Acc: 0.305 Test Loss: 5.444 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0815677642822266
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.466 Vali Acc: 0.302 Test Loss: 5.466 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 22851098
model size : 101.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0082826614379883
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.328 Vali Acc: 0.039 Test Loss: 3.328 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.589210033416748
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.343 Vali Acc: 0.046 Test Loss: 3.343 Test Acc: 0.046
Validation loss decreased (-0.038790 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.5520150661468506
Epoch: 3, Steps: 10 | Train Loss: 3.069 Vali Loss: 3.345 Vali Acc: 0.078 Test Loss: 3.345 Test Acc: 0.078
Validation loss decreased (-0.045849 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.5608065128326416
Epoch: 4, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.278 Vali Acc: 0.071 Test Loss: 3.278 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5647444725036621
Epoch: 5, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.267 Vali Acc: 0.098 Test Loss: 3.267 Test Acc: 0.098
Validation loss decreased (-0.077614 --> -0.097614).  Saving model ...
Epoch: 6 cost time: 0.6788527965545654
Epoch: 6, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.189 Vali Acc: 0.138 Test Loss: 3.189 Test Acc: 0.138
Validation loss decreased (-0.097614 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 0.7586386203765869
Epoch: 7, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.224 Vali Acc: 0.141 Test Loss: 3.224 Test Acc: 0.141
Validation loss decreased (-0.137615 --> -0.141144).  Saving model ...
Epoch: 8 cost time: 0.5954446792602539
Epoch: 8, Steps: 10 | Train Loss: 1.915 Vali Loss: 3.220 Vali Acc: 0.181 Test Loss: 3.220 Test Acc: 0.181
Validation loss decreased (-0.141144 --> -0.181144).  Saving model ...
Epoch: 9 cost time: 0.8868122100830078
Epoch: 9, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.395 Vali Acc: 0.192 Test Loss: 3.395 Test Acc: 0.192
Validation loss decreased (-0.181144 --> -0.191731).  Saving model ...
Epoch: 10 cost time: 0.7359511852264404
Epoch: 10, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.602 Vali Acc: 0.228 Test Loss: 3.602 Test Acc: 0.228
Validation loss decreased (-0.191731 --> -0.228199).  Saving model ...
Epoch: 11 cost time: 0.5549395084381104
Epoch: 11, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.716 Vali Acc: 0.226 Test Loss: 3.716 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6410660743713379
Epoch: 12, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.831 Vali Acc: 0.252 Test Loss: 3.831 Test Acc: 0.252
Validation loss decreased (-0.228199 --> -0.251726).  Saving model ...
Epoch: 13 cost time: 0.6485826969146729
Epoch: 13, Steps: 10 | Train Loss: 0.276 Vali Loss: 4.022 Vali Acc: 0.266 Test Loss: 4.022 Test Acc: 0.266
Validation loss decreased (-0.251726 --> -0.265842).  Saving model ...
Epoch: 14 cost time: 0.8029434680938721
Epoch: 14, Steps: 10 | Train Loss: 0.174 Vali Loss: 4.214 Vali Acc: 0.259 Test Loss: 4.214 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.636613130569458
Epoch: 15, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.333 Vali Acc: 0.281 Test Loss: 4.333 Test Acc: 0.281
Validation loss decreased (-0.265842 --> -0.281133).  Saving model ...
Epoch: 16 cost time: 0.7120201587677002
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.480 Vali Acc: 0.284 Test Loss: 4.480 Test Acc: 0.284
Validation loss decreased (-0.281133 --> -0.283485).  Saving model ...
Epoch: 17 cost time: 0.5945043563842773
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.581 Vali Acc: 0.294 Test Loss: 4.581 Test Acc: 0.294
Validation loss decreased (-0.283485 --> -0.294072).  Saving model ...
Epoch: 18 cost time: 0.6302483081817627
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.698 Vali Acc: 0.286 Test Loss: 4.698 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8458113670349121
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.709 Vali Acc: 0.291 Test Loss: 4.709 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7248375415802002
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.754 Vali Acc: 0.295 Test Loss: 4.754 Test Acc: 0.295
Validation loss decreased (-0.294072 --> -0.295247).  Saving model ...
Epoch: 21 cost time: 0.8633203506469727
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.755 Vali Acc: 0.296 Test Loss: 4.755 Test Acc: 0.296
Validation loss decreased (-0.295247 --> -0.296423).  Saving model ...
Epoch: 22 cost time: 0.6024961471557617
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.757 Vali Acc: 0.294 Test Loss: 4.757 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9925539493560791
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.837 Vali Acc: 0.298 Test Loss: 4.837 Test Acc: 0.298
Validation loss decreased (-0.296423 --> -0.297599).  Saving model ...
Epoch: 24 cost time: 0.6243493556976318
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.857 Vali Acc: 0.299 Test Loss: 4.857 Test Acc: 0.299
Validation loss decreased (-0.297599 --> -0.298775).  Saving model ...
Epoch: 25 cost time: 0.6099503040313721
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.803 Vali Acc: 0.304 Test Loss: 4.803 Test Acc: 0.304
Validation loss decreased (-0.298775 --> -0.303481).  Saving model ...
Epoch: 26 cost time: 0.7927582263946533
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.802 Vali Acc: 0.304 Test Loss: 4.802 Test Acc: 0.304
Validation loss decreased (-0.303481 --> -0.303481).  Saving model ...
Epoch: 27 cost time: 0.6764111518859863
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.853 Vali Acc: 0.304 Test Loss: 4.853 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6609706878662109
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.889 Vali Acc: 0.307 Test Loss: 4.889 Test Acc: 0.307
Validation loss decreased (-0.303481 --> -0.307010).  Saving model ...
Epoch: 29 cost time: 0.5644919872283936
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.909 Vali Acc: 0.312 Test Loss: 4.909 Test Acc: 0.312
Validation loss decreased (-0.307010 --> -0.311716).  Saving model ...
Epoch: 30 cost time: 0.6033051013946533
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.945 Vali Acc: 0.308 Test Loss: 4.945 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5447194576263428
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.954 Vali Acc: 0.304 Test Loss: 4.954 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5443589687347412
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.962 Vali Acc: 0.307 Test Loss: 4.962 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7733654975891113
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.982 Vali Acc: 0.312 Test Loss: 4.982 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5387744903564453
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.997 Vali Acc: 0.309 Test Loss: 4.997 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7674000263214111
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.000 Vali Acc: 0.312 Test Loss: 5.000 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6424038410186768
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.004 Vali Acc: 0.308 Test Loss: 5.004 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7507123947143555
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.020 Vali Acc: 0.308 Test Loss: 5.020 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6901917457580566
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.118 Vali Acc: 0.302 Test Loss: 5.118 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6516628265380859
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.144 Vali Acc: 0.301 Test Loss: 5.144 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 22593050
model size : 100.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0455212593078613
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.385 Vali Acc: 0.029 Test Loss: 3.385 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.517266035079956
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.365 Vali Acc: 0.040 Test Loss: 3.365 Test Acc: 0.040
Validation loss decreased (-0.029378 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.44490814208984375
Epoch: 3, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.381 Vali Acc: 0.052 Test Loss: 3.381 Test Acc: 0.052
Validation loss decreased (-0.039966 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 0.4603238105773926
Epoch: 4, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.343 Vali Acc: 0.065 Test Loss: 3.343 Test Acc: 0.065
Validation loss decreased (-0.051731 --> -0.064672).  Saving model ...
Epoch: 5 cost time: 0.5440595149993896
Epoch: 5, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.296 Vali Acc: 0.084 Test Loss: 3.296 Test Acc: 0.084
Validation loss decreased (-0.064672 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 0.6655278205871582
Epoch: 6, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.282 Vali Acc: 0.099 Test Loss: 3.282 Test Acc: 0.099
Validation loss decreased (-0.083496 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 0.5324974060058594
Epoch: 7, Steps: 10 | Train Loss: 2.671 Vali Loss: 3.245 Vali Acc: 0.100 Test Loss: 3.245 Test Acc: 0.100
Validation loss decreased (-0.098791 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 0.5375142097473145
Epoch: 8, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.253 Vali Acc: 0.115 Test Loss: 3.253 Test Acc: 0.115
Validation loss decreased (-0.099968 --> -0.115262).  Saving model ...
Epoch: 9 cost time: 0.5806818008422852
Epoch: 9, Steps: 10 | Train Loss: 2.207 Vali Loss: 3.240 Vali Acc: 0.133 Test Loss: 3.240 Test Acc: 0.133
Validation loss decreased (-0.115262 --> -0.132909).  Saving model ...
Epoch: 10 cost time: 0.5378081798553467
Epoch: 10, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.291 Vali Acc: 0.174 Test Loss: 3.291 Test Acc: 0.174
Validation loss decreased (-0.132909 --> -0.174085).  Saving model ...
Epoch: 11 cost time: 0.5707271099090576
Epoch: 11, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.369 Vali Acc: 0.189 Test Loss: 3.369 Test Acc: 0.189
Validation loss decreased (-0.174085 --> -0.189378).  Saving model ...
Epoch: 12 cost time: 0.4293057918548584
Epoch: 12, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.469 Vali Acc: 0.213 Test Loss: 3.469 Test Acc: 0.213
Validation loss decreased (-0.189378 --> -0.212906).  Saving model ...
Epoch: 13 cost time: 0.580470085144043
Epoch: 13, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.574 Vali Acc: 0.225 Test Loss: 3.574 Test Acc: 0.225
Validation loss decreased (-0.212906 --> -0.224670).  Saving model ...
Epoch: 14 cost time: 0.6795070171356201
Epoch: 14, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.637 Vali Acc: 0.241 Test Loss: 3.637 Test Acc: 0.241
Validation loss decreased (-0.224670 --> -0.241140).  Saving model ...
Epoch: 15 cost time: 0.5363235473632812
Epoch: 15, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.742 Vali Acc: 0.248 Test Loss: 3.742 Test Acc: 0.248
Validation loss decreased (-0.241140 --> -0.248198).  Saving model ...
Epoch: 16 cost time: 0.6305525302886963
Epoch: 16, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.814 Vali Acc: 0.269 Test Loss: 3.814 Test Acc: 0.269
Validation loss decreased (-0.248198 --> -0.269374).  Saving model ...
Epoch: 17 cost time: 0.5756216049194336
Epoch: 17, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.939 Vali Acc: 0.278 Test Loss: 3.939 Test Acc: 0.278
Validation loss decreased (-0.269374 --> -0.277608).  Saving model ...
Epoch: 18 cost time: 0.5833351612091064
Epoch: 18, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.012 Vali Acc: 0.271 Test Loss: 4.012 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4897925853729248
Epoch: 19, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.236 Vali Acc: 0.271 Test Loss: 4.236 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6033368110656738
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.159 Vali Acc: 0.286 Test Loss: 4.159 Test Acc: 0.286
Validation loss decreased (-0.277608 --> -0.285841).  Saving model ...
Epoch: 21 cost time: 0.5591843128204346
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.261 Vali Acc: 0.276 Test Loss: 4.261 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6400392055511475
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.348 Vali Acc: 0.272 Test Loss: 4.348 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5036356449127197
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.351 Vali Acc: 0.281 Test Loss: 4.351 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5793282985687256
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.363 Vali Acc: 0.289 Test Loss: 4.363 Test Acc: 0.289
Validation loss decreased (-0.285841 --> -0.289368).  Saving model ...
Epoch: 25 cost time: 0.5864701271057129
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.463 Vali Acc: 0.279 Test Loss: 4.463 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6095056533813477
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.526 Vali Acc: 0.282 Test Loss: 4.526 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5703155994415283
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.471 Vali Acc: 0.291 Test Loss: 4.471 Test Acc: 0.291
Validation loss decreased (-0.289368 --> -0.290544).  Saving model ...
Epoch: 28 cost time: 0.5272738933563232
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.467 Vali Acc: 0.289 Test Loss: 4.467 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.62674880027771
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.519 Vali Acc: 0.294 Test Loss: 4.519 Test Acc: 0.294
Validation loss decreased (-0.290544 --> -0.294072).  Saving model ...
Epoch: 30 cost time: 0.5845811367034912
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.603 Vali Acc: 0.288 Test Loss: 4.603 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.48974037170410156
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.635 Vali Acc: 0.288 Test Loss: 4.635 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4912598133087158
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.587 Vali Acc: 0.287 Test Loss: 4.587 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5041940212249756
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.563 Vali Acc: 0.292 Test Loss: 4.563 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5435714721679688
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.603 Vali Acc: 0.296 Test Loss: 4.603 Test Acc: 0.296
Validation loss decreased (-0.294072 --> -0.296425).  Saving model ...
Epoch: 35 cost time: 0.5723831653594971
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.649 Vali Acc: 0.291 Test Loss: 4.649 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5015676021575928
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.670 Vali Acc: 0.296 Test Loss: 4.670 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5260980129241943
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.673 Vali Acc: 0.295 Test Loss: 4.673 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4812283515930176
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.697 Vali Acc: 0.292 Test Loss: 4.697 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.572523832321167
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.722 Vali Acc: 0.289 Test Loss: 4.722 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6707007884979248
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.718 Vali Acc: 0.291 Test Loss: 4.718 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5051865577697754
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.722 Vali Acc: 0.294 Test Loss: 4.722 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5335991382598877
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.745 Vali Acc: 0.296 Test Loss: 4.745 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5598053932189941
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.769 Vali Acc: 0.294 Test Loss: 4.769 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6796939373016357
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.767 Vali Acc: 0.294 Test Loss: 4.767 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 22421018
model size : 100.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.835416316986084
Epoch: 1, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.347 Vali Acc: 0.044 Test Loss: 3.347 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.923121452331543
Epoch: 2, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.341 Vali Acc: 0.059 Test Loss: 3.341 Test Acc: 0.059
Validation loss decreased (-0.043496 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.6366903781890869
Epoch: 3, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.328 Vali Acc: 0.093 Test Loss: 3.328 Test Acc: 0.093
Validation loss decreased (-0.058790 --> -0.092908).  Saving model ...
Epoch: 4 cost time: 0.6279106140136719
Epoch: 4, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.239 Vali Acc: 0.104 Test Loss: 3.239 Test Acc: 0.104
Validation loss decreased (-0.092908 --> -0.103497).  Saving model ...
Epoch: 5 cost time: 0.8841140270233154
Epoch: 5, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.169 Vali Acc: 0.138 Test Loss: 3.169 Test Acc: 0.138
Validation loss decreased (-0.103497 --> -0.137615).  Saving model ...
Epoch: 6 cost time: 0.943551778793335
Epoch: 6, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.196 Vali Acc: 0.155 Test Loss: 3.196 Test Acc: 0.155
Validation loss decreased (-0.137615 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 1.0317904949188232
Epoch: 7, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.178 Vali Acc: 0.191 Test Loss: 3.178 Test Acc: 0.191
Validation loss decreased (-0.155262 --> -0.190556).  Saving model ...
Epoch: 8 cost time: 0.6753246784210205
Epoch: 8, Steps: 10 | Train Loss: 1.391 Vali Loss: 3.388 Vali Acc: 0.219 Test Loss: 3.388 Test Acc: 0.219
Validation loss decreased (-0.190556 --> -0.218790).  Saving model ...
Epoch: 9 cost time: 0.6587414741516113
Epoch: 9, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.815 Vali Acc: 0.220 Test Loss: 3.815 Test Acc: 0.220
Validation loss decreased (-0.218790 --> -0.219962).  Saving model ...
Epoch: 10 cost time: 0.6972458362579346
Epoch: 10, Steps: 10 | Train Loss: 0.568 Vali Loss: 4.122 Vali Acc: 0.236 Test Loss: 4.122 Test Acc: 0.236
Validation loss decreased (-0.219962 --> -0.236429).  Saving model ...
Epoch: 11 cost time: 0.9070570468902588
Epoch: 11, Steps: 10 | Train Loss: 0.414 Vali Loss: 4.288 Vali Acc: 0.264 Test Loss: 4.288 Test Acc: 0.264
Validation loss decreased (-0.236429 --> -0.263487).  Saving model ...
Epoch: 12 cost time: 0.6504020690917969
Epoch: 12, Steps: 10 | Train Loss: 0.236 Vali Loss: 4.519 Vali Acc: 0.273 Test Loss: 4.519 Test Acc: 0.273
Validation loss decreased (-0.263487 --> -0.272896).  Saving model ...
Epoch: 13 cost time: 0.8007485866546631
Epoch: 13, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.974 Vali Acc: 0.252 Test Loss: 4.974 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8177225589752197
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 5.123 Vali Acc: 0.273 Test Loss: 5.123 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6471805572509766
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 5.126 Vali Acc: 0.272 Test Loss: 5.126 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9477534294128418
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.243 Vali Acc: 0.295 Test Loss: 5.243 Test Acc: 0.295
Validation loss decreased (-0.272896 --> -0.295242).  Saving model ...
Epoch: 17 cost time: 0.9896645545959473
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.203 Vali Acc: 0.293 Test Loss: 5.203 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8253405094146729
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.468 Vali Acc: 0.288 Test Loss: 5.468 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0110445022583008
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.470 Vali Acc: 0.306 Test Loss: 5.470 Test Acc: 0.306
Validation loss decreased (-0.295242 --> -0.305828).  Saving model ...
Epoch: 20 cost time: 0.9103543758392334
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.423 Vali Acc: 0.309 Test Loss: 5.423 Test Acc: 0.309
Validation loss decreased (-0.305828 --> -0.309358).  Saving model ...
Epoch: 21 cost time: 0.664705753326416
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.623 Vali Acc: 0.305 Test Loss: 5.623 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5573821067810059
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.542 Vali Acc: 0.307 Test Loss: 5.542 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6621415615081787
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.458 Vali Acc: 0.313 Test Loss: 5.458 Test Acc: 0.313
Validation loss decreased (-0.309358 --> -0.312887).  Saving model ...
Epoch: 24 cost time: 0.8225367069244385
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.482 Vali Acc: 0.320 Test Loss: 5.482 Test Acc: 0.320
Validation loss decreased (-0.312887 --> -0.319945).  Saving model ...
Epoch: 25 cost time: 0.753150224685669
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.463 Vali Acc: 0.314 Test Loss: 5.463 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8171463012695312
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.438 Vali Acc: 0.314 Test Loss: 5.438 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9436135292053223
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.456 Vali Acc: 0.322 Test Loss: 5.456 Test Acc: 0.322
Validation loss decreased (-0.319945 --> -0.322298).  Saving model ...
Epoch: 28 cost time: 0.8319787979125977
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.486 Vali Acc: 0.316 Test Loss: 5.486 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9250228404998779
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.501 Vali Acc: 0.320 Test Loss: 5.501 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7338473796844482
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.498 Vali Acc: 0.325 Test Loss: 5.498 Test Acc: 0.325
Validation loss decreased (-0.322298 --> -0.324651).  Saving model ...
Epoch: 31 cost time: 0.8114867210388184
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.505 Vali Acc: 0.322 Test Loss: 5.505 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.940101146697998
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.515 Vali Acc: 0.322 Test Loss: 5.515 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7082281112670898
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.518 Vali Acc: 0.322 Test Loss: 5.518 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7274599075317383
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.516 Vali Acc: 0.324 Test Loss: 5.516 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6129345893859863
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.519 Vali Acc: 0.322 Test Loss: 5.519 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6439399719238281
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.524 Vali Acc: 0.322 Test Loss: 5.524 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8805527687072754
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.536 Vali Acc: 0.322 Test Loss: 5.536 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7606868743896484
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.543 Vali Acc: 0.325 Test Loss: 5.543 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7706427574157715
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.558 Vali Acc: 0.325 Test Loss: 5.558 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8512234687805176
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.586 Vali Acc: 0.324 Test Loss: 5.586 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 22843418
model size : 101.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.184319257736206
Epoch: 1, Steps: 10 | Train Loss: 3.430 Vali Loss: 3.331 Vali Acc: 0.042 Test Loss: 3.331 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.5959088802337646
Epoch: 2, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.325 Vali Acc: 0.054 Test Loss: 3.325 Test Acc: 0.054
Validation loss decreased (-0.042320 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.667313814163208
Epoch: 3, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.352 Vali Acc: 0.052 Test Loss: 3.352 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5256612300872803
Epoch: 4, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.317 Vali Acc: 0.076 Test Loss: 3.317 Test Acc: 0.076
Validation loss decreased (-0.054084 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 0.6886684894561768
Epoch: 5, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.239 Vali Acc: 0.100 Test Loss: 3.239 Test Acc: 0.100
Validation loss decreased (-0.076437 --> -0.099968).  Saving model ...
Epoch: 6 cost time: 0.5910766124725342
Epoch: 6, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.216 Vali Acc: 0.113 Test Loss: 3.216 Test Acc: 0.113
Validation loss decreased (-0.099968 --> -0.112909).  Saving model ...
Epoch: 7 cost time: 0.6667935848236084
Epoch: 7, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.198 Vali Acc: 0.139 Test Loss: 3.198 Test Acc: 0.139
Validation loss decreased (-0.112909 --> -0.138792).  Saving model ...
Epoch: 8 cost time: 0.5752060413360596
Epoch: 8, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.162 Vali Acc: 0.167 Test Loss: 3.162 Test Acc: 0.167
Validation loss decreased (-0.138792 --> -0.167027).  Saving model ...
Epoch: 9 cost time: 0.5555050373077393
Epoch: 9, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.318 Vali Acc: 0.189 Test Loss: 3.318 Test Acc: 0.189
Validation loss decreased (-0.167027 --> -0.189379).  Saving model ...
Epoch: 10 cost time: 0.6377894878387451
Epoch: 10, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.459 Vali Acc: 0.224 Test Loss: 3.459 Test Acc: 0.224
Validation loss decreased (-0.189379 --> -0.223495).  Saving model ...
Epoch: 11 cost time: 0.589946985244751
Epoch: 11, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.595 Vali Acc: 0.235 Test Loss: 3.595 Test Acc: 0.235
Validation loss decreased (-0.223495 --> -0.235258).  Saving model ...
Epoch: 12 cost time: 0.6002061367034912
Epoch: 12, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.794 Vali Acc: 0.245 Test Loss: 3.794 Test Acc: 0.245
Validation loss decreased (-0.235258 --> -0.244668).  Saving model ...
Epoch: 13 cost time: 0.49877214431762695
Epoch: 13, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.879 Vali Acc: 0.256 Test Loss: 3.879 Test Acc: 0.256
Validation loss decreased (-0.244668 --> -0.256432).  Saving model ...
Epoch: 14 cost time: 0.5248978137969971
Epoch: 14, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.133 Vali Acc: 0.271 Test Loss: 4.133 Test Acc: 0.271
Validation loss decreased (-0.256432 --> -0.270547).  Saving model ...
Epoch: 15 cost time: 0.5348701477050781
Epoch: 15, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.160 Vali Acc: 0.275 Test Loss: 4.160 Test Acc: 0.275
Validation loss decreased (-0.270547 --> -0.275253).  Saving model ...
Epoch: 16 cost time: 0.6225616931915283
Epoch: 16, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.390 Vali Acc: 0.285 Test Loss: 4.390 Test Acc: 0.285
Validation loss decreased (-0.275253 --> -0.284662).  Saving model ...
Epoch: 17 cost time: 0.6046385765075684
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.464 Vali Acc: 0.286 Test Loss: 4.464 Test Acc: 0.286
Validation loss decreased (-0.284662 --> -0.285838).  Saving model ...
Epoch: 18 cost time: 0.773247480392456
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.558 Vali Acc: 0.295 Test Loss: 4.558 Test Acc: 0.295
Validation loss decreased (-0.285838 --> -0.295249).  Saving model ...
Epoch: 19 cost time: 0.698591947555542
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.694 Vali Acc: 0.288 Test Loss: 4.694 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6143970489501953
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.738 Vali Acc: 0.291 Test Loss: 4.738 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6529078483581543
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.811 Vali Acc: 0.302 Test Loss: 4.811 Test Acc: 0.302
Validation loss decreased (-0.295249 --> -0.302305).  Saving model ...
Epoch: 22 cost time: 0.7232890129089355
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.858 Vali Acc: 0.301 Test Loss: 4.858 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7805569171905518
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.844 Vali Acc: 0.300 Test Loss: 4.844 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5875141620635986
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.820 Vali Acc: 0.306 Test Loss: 4.820 Test Acc: 0.306
Validation loss decreased (-0.302305 --> -0.305834).  Saving model ...
Epoch: 25 cost time: 0.590843915939331
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.825 Vali Acc: 0.305 Test Loss: 4.825 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5420255661010742
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.837 Vali Acc: 0.299 Test Loss: 4.837 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5523405075073242
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.860 Vali Acc: 0.306 Test Loss: 4.860 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5626957416534424
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.914 Vali Acc: 0.301 Test Loss: 4.914 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6190207004547119
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.920 Vali Acc: 0.300 Test Loss: 4.920 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5593655109405518
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.940 Vali Acc: 0.299 Test Loss: 4.940 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5641825199127197
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.964 Vali Acc: 0.301 Test Loss: 4.964 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6847453117370605
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.977 Vali Acc: 0.306 Test Loss: 4.977 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.58461594581604
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.046 Vali Acc: 0.296 Test Loss: 5.046 Test Acc: 0.296
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5599219799041748
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.059 Vali Acc: 0.296 Test Loss: 5.059 Test Acc: 0.296
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 22563866
model size : 100.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.025209903717041
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.370 Vali Acc: 0.029 Test Loss: 3.370 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.574439287185669
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.343 Vali Acc: 0.040 Test Loss: 3.343 Test Acc: 0.040
Validation loss decreased (-0.029378 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.5835835933685303
Epoch: 3, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.336 Vali Acc: 0.058 Test Loss: 3.336 Test Acc: 0.058
Validation loss decreased (-0.039967 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.683114767074585
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.324 Vali Acc: 0.068 Test Loss: 3.324 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 0.5788309574127197
Epoch: 5, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.298 Vali Acc: 0.079 Test Loss: 3.298 Test Acc: 0.079
Validation loss decreased (-0.068202 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.5320785045623779
Epoch: 6, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.262 Vali Acc: 0.120 Test Loss: 3.262 Test Acc: 0.120
Validation loss decreased (-0.078791 --> -0.119967).  Saving model ...
Epoch: 7 cost time: 0.5286359786987305
Epoch: 7, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.246 Vali Acc: 0.131 Test Loss: 3.246 Test Acc: 0.131
Validation loss decreased (-0.119967 --> -0.130556).  Saving model ...
Epoch: 8 cost time: 0.636821985244751
Epoch: 8, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.200 Vali Acc: 0.145 Test Loss: 3.200 Test Acc: 0.145
Validation loss decreased (-0.130556 --> -0.144674).  Saving model ...
Epoch: 9 cost time: 0.6128156185150146
Epoch: 9, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.189 Vali Acc: 0.166 Test Loss: 3.189 Test Acc: 0.166
Validation loss decreased (-0.144674 --> -0.165850).  Saving model ...
Epoch: 10 cost time: 0.7272119522094727
Epoch: 10, Steps: 10 | Train Loss: 1.932 Vali Loss: 3.234 Vali Acc: 0.175 Test Loss: 3.234 Test Acc: 0.175
Validation loss decreased (-0.165850 --> -0.175262).  Saving model ...
Epoch: 11 cost time: 0.598578929901123
Epoch: 11, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.316 Vali Acc: 0.194 Test Loss: 3.316 Test Acc: 0.194
Validation loss decreased (-0.175262 --> -0.194084).  Saving model ...
Epoch: 12 cost time: 0.5759155750274658
Epoch: 12, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.429 Vali Acc: 0.227 Test Loss: 3.429 Test Acc: 0.227
Validation loss decreased (-0.194084 --> -0.227025).  Saving model ...
Epoch: 13 cost time: 0.5663704872131348
Epoch: 13, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.504 Vali Acc: 0.233 Test Loss: 3.504 Test Acc: 0.233
Validation loss decreased (-0.227025 --> -0.232906).  Saving model ...
Epoch: 14 cost time: 0.627331018447876
Epoch: 14, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.694 Vali Acc: 0.239 Test Loss: 3.694 Test Acc: 0.239
Validation loss decreased (-0.232906 --> -0.238787).  Saving model ...
Epoch: 15 cost time: 0.603529691696167
Epoch: 15, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.677 Vali Acc: 0.265 Test Loss: 3.677 Test Acc: 0.265
Validation loss decreased (-0.238787 --> -0.264669).  Saving model ...
Epoch: 16 cost time: 0.5541043281555176
Epoch: 16, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.951 Vali Acc: 0.264 Test Loss: 3.951 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.49767279624938965
Epoch: 17, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.944 Vali Acc: 0.289 Test Loss: 3.944 Test Acc: 0.289
Validation loss decreased (-0.264669 --> -0.289372).  Saving model ...
Epoch: 18 cost time: 0.5096659660339355
Epoch: 18, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.993 Vali Acc: 0.276 Test Loss: 3.993 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5853550434112549
Epoch: 19, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.188 Vali Acc: 0.279 Test Loss: 4.188 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.605353832244873
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.240 Vali Acc: 0.286 Test Loss: 4.240 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5543520450592041
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.361 Vali Acc: 0.280 Test Loss: 4.361 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6372051239013672
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.467 Vali Acc: 0.286 Test Loss: 4.467 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7430694103240967
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.515 Vali Acc: 0.276 Test Loss: 4.515 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5488710403442383
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.501 Vali Acc: 0.279 Test Loss: 4.501 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5877890586853027
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.531 Vali Acc: 0.291 Test Loss: 4.531 Test Acc: 0.291
Validation loss decreased (-0.289372 --> -0.290543).  Saving model ...
Epoch: 26 cost time: 0.5797393321990967
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.564 Vali Acc: 0.292 Test Loss: 4.564 Test Acc: 0.292
Validation loss decreased (-0.290543 --> -0.291719).  Saving model ...
Epoch: 27 cost time: 0.7646760940551758
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.570 Vali Acc: 0.292 Test Loss: 4.570 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5599484443664551
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.598 Vali Acc: 0.292 Test Loss: 4.598 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5712165832519531
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.621 Vali Acc: 0.292 Test Loss: 4.621 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6187024116516113
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.652 Vali Acc: 0.291 Test Loss: 4.652 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4981832504272461
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.659 Vali Acc: 0.291 Test Loss: 4.659 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5896511077880859
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.710 Vali Acc: 0.296 Test Loss: 4.710 Test Acc: 0.296
Validation loss decreased (-0.291719 --> -0.296423).  Saving model ...
Epoch: 33 cost time: 0.6603803634643555
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.738 Vali Acc: 0.294 Test Loss: 4.738 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.610821008682251
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.741 Vali Acc: 0.295 Test Loss: 4.741 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5613930225372314
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.744 Vali Acc: 0.294 Test Loss: 4.744 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5906143188476562
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.742 Vali Acc: 0.293 Test Loss: 4.742 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5674881935119629
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.737 Vali Acc: 0.300 Test Loss: 4.737 Test Acc: 0.300
Validation loss decreased (-0.296423 --> -0.299953).  Saving model ...
Epoch: 38 cost time: 0.6111769676208496
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.779 Vali Acc: 0.298 Test Loss: 4.779 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5864520072937012
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.797 Vali Acc: 0.300 Test Loss: 4.797 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.604285717010498
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.811 Vali Acc: 0.300 Test Loss: 4.811 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6450140476226807
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.839 Vali Acc: 0.300 Test Loss: 4.839 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.484952449798584
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.859 Vali Acc: 0.301 Test Loss: 4.859 Test Acc: 0.301
Validation loss decreased (-0.299953 --> -0.301128).  Saving model ...
Epoch: 43 cost time: 0.5088706016540527
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.868 Vali Acc: 0.304 Test Loss: 4.868 Test Acc: 0.304
Validation loss decreased (-0.301128 --> -0.303481).  Saving model ...
Epoch: 44 cost time: 0.606719970703125
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.867 Vali Acc: 0.305 Test Loss: 4.867 Test Acc: 0.305
Validation loss decreased (-0.303481 --> -0.304657).  Saving model ...
Epoch: 45 cost time: 0.6310789585113525
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.893 Vali Acc: 0.301 Test Loss: 4.893 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5783388614654541
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.893 Vali Acc: 0.300 Test Loss: 4.893 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5614497661590576
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.921 Vali Acc: 0.296 Test Loss: 4.921 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5825119018554688
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.930 Vali Acc: 0.298 Test Loss: 4.930 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5215253829956055
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.947 Vali Acc: 0.298 Test Loss: 4.947 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5269203186035156
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.956 Vali Acc: 0.298 Test Loss: 4.956 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 22434842
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9803147315979004
Epoch: 1, Steps: 10 | Train Loss: 3.421 Vali Loss: 3.352 Vali Acc: 0.041 Test Loss: 3.352 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.6830251216888428
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.387 Vali Acc: 0.059 Test Loss: 3.387 Test Acc: 0.059
Validation loss decreased (-0.041143 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.7746148109436035
Epoch: 3, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.324 Vali Acc: 0.084 Test Loss: 3.324 Test Acc: 0.084
Validation loss decreased (-0.058790 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.535228967666626
Epoch: 4, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.273 Vali Acc: 0.082 Test Loss: 3.273 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9689433574676514
Epoch: 5, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.225 Vali Acc: 0.142 Test Loss: 3.225 Test Acc: 0.142
Validation loss decreased (-0.083496 --> -0.142321).  Saving model ...
Epoch: 6 cost time: 0.5131914615631104
Epoch: 6, Steps: 10 | Train Loss: 2.259 Vali Loss: 3.238 Vali Acc: 0.151 Test Loss: 3.238 Test Acc: 0.151
Validation loss decreased (-0.142321 --> -0.150556).  Saving model ...
Epoch: 7 cost time: 0.6182031631469727
Epoch: 7, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.176 Vali Acc: 0.174 Test Loss: 3.176 Test Acc: 0.174
Validation loss decreased (-0.150556 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 0.7905054092407227
Epoch: 8, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.376 Vali Acc: 0.215 Test Loss: 3.376 Test Acc: 0.215
Validation loss decreased (-0.174086 --> -0.215260).  Saving model ...
Epoch: 9 cost time: 0.6590180397033691
Epoch: 9, Steps: 10 | Train Loss: 0.988 Vali Loss: 3.647 Vali Acc: 0.232 Test Loss: 3.647 Test Acc: 0.232
Validation loss decreased (-0.215260 --> -0.231728).  Saving model ...
Epoch: 10 cost time: 0.7796719074249268
Epoch: 10, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.781 Vali Acc: 0.265 Test Loss: 3.781 Test Acc: 0.265
Validation loss decreased (-0.231728 --> -0.264668).  Saving model ...
Epoch: 11 cost time: 0.5045466423034668
Epoch: 11, Steps: 10 | Train Loss: 0.407 Vali Loss: 4.099 Vali Acc: 0.259 Test Loss: 4.099 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47543859481811523
Epoch: 12, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.279 Vali Acc: 0.287 Test Loss: 4.279 Test Acc: 0.287
Validation loss decreased (-0.264668 --> -0.287016).  Saving model ...
Epoch: 13 cost time: 0.6584000587463379
Epoch: 13, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.417 Vali Acc: 0.279 Test Loss: 4.417 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5960524082183838
Epoch: 14, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.436 Vali Acc: 0.301 Test Loss: 4.436 Test Acc: 0.301
Validation loss decreased (-0.287016 --> -0.301132).  Saving model ...
Epoch: 15 cost time: 0.7464509010314941
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.792 Vali Acc: 0.276 Test Loss: 4.792 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.49984216690063477
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.915 Vali Acc: 0.286 Test Loss: 4.915 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9299254417419434
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.938 Vali Acc: 0.275 Test Loss: 4.938 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6231772899627686
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.918 Vali Acc: 0.292 Test Loss: 4.918 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7852451801300049
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.999 Vali Acc: 0.298 Test Loss: 4.999 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6787688732147217
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.975 Vali Acc: 0.300 Test Loss: 4.975 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6629269123077393
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.980 Vali Acc: 0.309 Test Loss: 4.980 Test Acc: 0.309
Validation loss decreased (-0.301132 --> -0.309362).  Saving model ...
Epoch: 22 cost time: 0.6248397827148438
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.996 Vali Acc: 0.307 Test Loss: 4.996 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6571047306060791
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.026 Vali Acc: 0.309 Test Loss: 5.026 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7388284206390381
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.054 Vali Acc: 0.308 Test Loss: 5.054 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.608234167098999
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.062 Vali Acc: 0.306 Test Loss: 5.062 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8699250221252441
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.075 Vali Acc: 0.305 Test Loss: 5.075 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6381983757019043
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.087 Vali Acc: 0.309 Test Loss: 5.087 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6323530673980713
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.098 Vali Acc: 0.311 Test Loss: 5.098 Test Acc: 0.311
Validation loss decreased (-0.309362 --> -0.310537).  Saving model ...
Epoch: 29 cost time: 0.8222622871398926
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.097 Vali Acc: 0.306 Test Loss: 5.097 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.505734920501709
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.090 Vali Acc: 0.308 Test Loss: 5.090 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5663638114929199
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.105 Vali Acc: 0.306 Test Loss: 5.105 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6237845420837402
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.107 Vali Acc: 0.307 Test Loss: 5.107 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5960216522216797
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.141 Vali Acc: 0.304 Test Loss: 5.141 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7847819328308105
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.144 Vali Acc: 0.304 Test Loss: 5.144 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7180421352386475
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.128 Vali Acc: 0.307 Test Loss: 5.128 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8323836326599121
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.131 Vali Acc: 0.309 Test Loss: 5.131 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0574760437011719
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.134 Vali Acc: 0.312 Test Loss: 5.134 Test Acc: 0.312
Validation loss decreased (-0.310537 --> -0.311713).  Saving model ...
Epoch: 38 cost time: 0.587134599685669
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.141 Vali Acc: 0.313 Test Loss: 5.141 Test Acc: 0.313
Validation loss decreased (-0.311713 --> -0.312890).  Saving model ...
Epoch: 39 cost time: 0.7689192295074463
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.147 Vali Acc: 0.309 Test Loss: 5.147 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.944108247756958
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.160 Vali Acc: 0.307 Test Loss: 5.160 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8251972198486328
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.168 Vali Acc: 0.306 Test Loss: 5.168 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6260538101196289
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.181 Vali Acc: 0.305 Test Loss: 5.181 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5836851596832275
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.181 Vali Acc: 0.307 Test Loss: 5.181 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8277139663696289
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.200 Vali Acc: 0.304 Test Loss: 5.200 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8895225524902344
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.215 Vali Acc: 0.305 Test Loss: 5.215 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7970190048217773
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.214 Vali Acc: 0.306 Test Loss: 5.214 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8329036235809326
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.222 Vali Acc: 0.305 Test Loss: 5.222 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.622107744216919
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.234 Vali Acc: 0.306 Test Loss: 5.234 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 22756634
model size : 101.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9127929210662842
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.399 Vali Acc: 0.038 Test Loss: 3.399 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.547346830368042
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.359 Vali Acc: 0.069 Test Loss: 3.359 Test Acc: 0.069
Validation loss decreased (-0.037613 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.5720882415771484
Epoch: 3, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.350 Vali Acc: 0.086 Test Loss: 3.350 Test Acc: 0.086
Validation loss decreased (-0.069378 --> -0.085849).  Saving model ...
Epoch: 4 cost time: 0.5950508117675781
Epoch: 4, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.313 Vali Acc: 0.054 Test Loss: 3.313 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6299927234649658
Epoch: 5, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.254 Vali Acc: 0.101 Test Loss: 3.254 Test Acc: 0.101
Validation loss decreased (-0.085849 --> -0.101144).  Saving model ...
Epoch: 6 cost time: 0.6072125434875488
Epoch: 6, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.227 Vali Acc: 0.118 Test Loss: 3.227 Test Acc: 0.118
Validation loss decreased (-0.101144 --> -0.117615).  Saving model ...
Epoch: 7 cost time: 0.5617225170135498
Epoch: 7, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.230 Vali Acc: 0.116 Test Loss: 3.230 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6763734817504883
Epoch: 8, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.215 Vali Acc: 0.147 Test Loss: 3.215 Test Acc: 0.147
Validation loss decreased (-0.117615 --> -0.147027).  Saving model ...
Epoch: 9 cost time: 0.7076678276062012
Epoch: 9, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.296 Vali Acc: 0.174 Test Loss: 3.296 Test Acc: 0.174
Validation loss decreased (-0.147027 --> -0.174085).  Saving model ...
Epoch: 10 cost time: 0.5120084285736084
Epoch: 10, Steps: 10 | Train Loss: 1.395 Vali Loss: 3.396 Vali Acc: 0.200 Test Loss: 3.396 Test Acc: 0.200
Validation loss decreased (-0.174085 --> -0.199966).  Saving model ...
Epoch: 11 cost time: 0.5790467262268066
Epoch: 11, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.593 Vali Acc: 0.228 Test Loss: 3.593 Test Acc: 0.228
Validation loss decreased (-0.199966 --> -0.228199).  Saving model ...
Epoch: 12 cost time: 0.5806941986083984
Epoch: 12, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.640 Vali Acc: 0.259 Test Loss: 3.640 Test Acc: 0.259
Validation loss decreased (-0.228199 --> -0.258787).  Saving model ...
Epoch: 13 cost time: 0.5811870098114014
Epoch: 13, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.829 Vali Acc: 0.264 Test Loss: 3.829 Test Acc: 0.264
Validation loss decreased (-0.258787 --> -0.263491).  Saving model ...
Epoch: 14 cost time: 0.7662851810455322
Epoch: 14, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.790 Vali Acc: 0.274 Test Loss: 3.790 Test Acc: 0.274
Validation loss decreased (-0.263491 --> -0.274080).  Saving model ...
Epoch: 15 cost time: 0.6026232242584229
Epoch: 15, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.108 Vali Acc: 0.280 Test Loss: 4.108 Test Acc: 0.280
Validation loss decreased (-0.274080 --> -0.279959).  Saving model ...
Epoch: 16 cost time: 0.5761654376983643
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.160 Vali Acc: 0.288 Test Loss: 4.160 Test Acc: 0.288
Validation loss decreased (-0.279959 --> -0.288194).  Saving model ...
Epoch: 17 cost time: 0.60349440574646
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.128 Vali Acc: 0.305 Test Loss: 4.128 Test Acc: 0.305
Validation loss decreased (-0.288194 --> -0.304665).  Saving model ...
Epoch: 18 cost time: 0.5725040435791016
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.289 Vali Acc: 0.307 Test Loss: 4.289 Test Acc: 0.307
Validation loss decreased (-0.304665 --> -0.307016).  Saving model ...
Epoch: 19 cost time: 0.8098480701446533
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.594 Vali Acc: 0.291 Test Loss: 4.594 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5173060894012451
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.457 Vali Acc: 0.295 Test Loss: 4.457 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5298950672149658
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.366 Vali Acc: 0.312 Test Loss: 4.366 Test Acc: 0.312
Validation loss decreased (-0.307016 --> -0.311721).  Saving model ...
Epoch: 22 cost time: 0.592010498046875
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.497 Vali Acc: 0.305 Test Loss: 4.497 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5545518398284912
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.583 Vali Acc: 0.300 Test Loss: 4.583 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5613555908203125
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.587 Vali Acc: 0.305 Test Loss: 4.587 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5917959213256836
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.563 Vali Acc: 0.311 Test Loss: 4.563 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.60361647605896
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.560 Vali Acc: 0.314 Test Loss: 4.560 Test Acc: 0.314
Validation loss decreased (-0.311721 --> -0.314072).  Saving model ...
Epoch: 27 cost time: 0.5347557067871094
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.585 Vali Acc: 0.315 Test Loss: 4.585 Test Acc: 0.315
Validation loss decreased (-0.314072 --> -0.315248).  Saving model ...
Epoch: 28 cost time: 0.531843900680542
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.609 Vali Acc: 0.315 Test Loss: 4.609 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5769803524017334
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.668 Vali Acc: 0.308 Test Loss: 4.668 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5573327541351318
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.680 Vali Acc: 0.306 Test Loss: 4.680 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5312614440917969
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.657 Vali Acc: 0.313 Test Loss: 4.657 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6118404865264893
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.670 Vali Acc: 0.316 Test Loss: 4.670 Test Acc: 0.316
Validation loss decreased (-0.315248 --> -0.316424).  Saving model ...
Epoch: 33 cost time: 0.6927475929260254
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.688 Vali Acc: 0.314 Test Loss: 4.688 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5365595817565918
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.691 Vali Acc: 0.315 Test Loss: 4.691 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5370311737060547
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.696 Vali Acc: 0.313 Test Loss: 4.696 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6715919971466064
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.734 Vali Acc: 0.314 Test Loss: 4.734 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.654430627822876
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.781 Vali Acc: 0.316 Test Loss: 4.781 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5533192157745361
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.778 Vali Acc: 0.316 Test Loss: 4.778 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5670099258422852
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.813 Vali Acc: 0.311 Test Loss: 4.813 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8089303970336914
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.811 Vali Acc: 0.312 Test Loss: 4.811 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7429847717285156
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.789 Vali Acc: 0.312 Test Loss: 4.789 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.559018611907959
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.800 Vali Acc: 0.311 Test Loss: 4.800 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 22541594
model size : 100.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.110370635986328
Epoch: 1, Steps: 10 | Train Loss: 3.449 Vali Loss: 3.356 Vali Acc: 0.040 Test Loss: 3.356 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.5703291893005371
Epoch: 2, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.314 Vali Acc: 0.051 Test Loss: 3.314 Test Acc: 0.051
Validation loss decreased (-0.039966 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.6429443359375
Epoch: 3, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.311 Vali Acc: 0.054 Test Loss: 3.311 Test Acc: 0.054
Validation loss decreased (-0.050555 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 0.5685710906982422
Epoch: 4, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.325 Vali Acc: 0.068 Test Loss: 3.325 Test Acc: 0.068
Validation loss decreased (-0.054085 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 0.5754706859588623
Epoch: 5, Steps: 10 | Train Loss: 2.968 Vali Loss: 3.304 Vali Acc: 0.076 Test Loss: 3.304 Test Acc: 0.076
Validation loss decreased (-0.068202 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.6723670959472656
Epoch: 6, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.266 Vali Acc: 0.096 Test Loss: 3.266 Test Acc: 0.096
Validation loss decreased (-0.076438 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 0.5638372898101807
Epoch: 7, Steps: 10 | Train Loss: 2.713 Vali Loss: 3.223 Vali Acc: 0.107 Test Loss: 3.223 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107027).  Saving model ...
Epoch: 8 cost time: 0.5531570911407471
Epoch: 8, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.227 Vali Acc: 0.125 Test Loss: 3.227 Test Acc: 0.125
Validation loss decreased (-0.107027 --> -0.124674).  Saving model ...
Epoch: 9 cost time: 0.5140664577484131
Epoch: 9, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.206 Vali Acc: 0.154 Test Loss: 3.206 Test Acc: 0.154
Validation loss decreased (-0.124674 --> -0.154086).  Saving model ...
Epoch: 10 cost time: 0.6143710613250732
Epoch: 10, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.294 Vali Acc: 0.146 Test Loss: 3.294 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5611057281494141
Epoch: 11, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.304 Vali Acc: 0.174 Test Loss: 3.304 Test Acc: 0.174
Validation loss decreased (-0.154086 --> -0.174085).  Saving model ...
Epoch: 12 cost time: 0.5215716361999512
Epoch: 12, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.331 Vali Acc: 0.188 Test Loss: 3.331 Test Acc: 0.188
Validation loss decreased (-0.174085 --> -0.188202).  Saving model ...
Epoch: 13 cost time: 0.5375959873199463
Epoch: 13, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.414 Vali Acc: 0.225 Test Loss: 3.414 Test Acc: 0.225
Validation loss decreased (-0.188202 --> -0.224672).  Saving model ...
Epoch: 14 cost time: 0.6483461856842041
Epoch: 14, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.472 Vali Acc: 0.232 Test Loss: 3.472 Test Acc: 0.232
Validation loss decreased (-0.224672 --> -0.231730).  Saving model ...
Epoch: 15 cost time: 0.49532437324523926
Epoch: 15, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.566 Vali Acc: 0.254 Test Loss: 3.566 Test Acc: 0.254
Validation loss decreased (-0.231730 --> -0.254082).  Saving model ...
Epoch: 16 cost time: 0.4841115474700928
Epoch: 16, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.663 Vali Acc: 0.258 Test Loss: 3.663 Test Acc: 0.258
Validation loss decreased (-0.254082 --> -0.257610).  Saving model ...
Epoch: 17 cost time: 0.5560593605041504
Epoch: 17, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.661 Vali Acc: 0.285 Test Loss: 3.661 Test Acc: 0.285
Validation loss decreased (-0.257610 --> -0.284669).  Saving model ...
Epoch: 18 cost time: 0.5756738185882568
Epoch: 18, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.846 Vali Acc: 0.275 Test Loss: 3.846 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5277173519134521
Epoch: 19, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.949 Vali Acc: 0.276 Test Loss: 3.949 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5343606472015381
Epoch: 20, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.049 Vali Acc: 0.286 Test Loss: 4.049 Test Acc: 0.286
Validation loss decreased (-0.284669 --> -0.285842).  Saving model ...
Epoch: 21 cost time: 0.537844181060791
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.047 Vali Acc: 0.293 Test Loss: 4.047 Test Acc: 0.293
Validation loss decreased (-0.285842 --> -0.292901).  Saving model ...
Epoch: 22 cost time: 0.5544266700744629
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.072 Vali Acc: 0.298 Test Loss: 4.072 Test Acc: 0.298
Validation loss decreased (-0.292901 --> -0.297606).  Saving model ...
Epoch: 23 cost time: 0.5283606052398682
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.128 Vali Acc: 0.298 Test Loss: 4.128 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6189801692962646
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.227 Vali Acc: 0.292 Test Loss: 4.227 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4779179096221924
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.240 Vali Acc: 0.296 Test Loss: 4.240 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6405093669891357
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.310 Vali Acc: 0.288 Test Loss: 4.310 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5536346435546875
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.346 Vali Acc: 0.300 Test Loss: 4.346 Test Acc: 0.300
Validation loss decreased (-0.297606 --> -0.299957).  Saving model ...
Epoch: 28 cost time: 0.5163605213165283
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.341 Vali Acc: 0.298 Test Loss: 4.341 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5018110275268555
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.364 Vali Acc: 0.299 Test Loss: 4.364 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5574119091033936
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.382 Vali Acc: 0.299 Test Loss: 4.382 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5829353332519531
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.411 Vali Acc: 0.298 Test Loss: 4.411 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6011903285980225
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.433 Vali Acc: 0.304 Test Loss: 4.433 Test Acc: 0.304
Validation loss decreased (-0.299957 --> -0.303485).  Saving model ...
Epoch: 33 cost time: 0.503425121307373
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.451 Vali Acc: 0.302 Test Loss: 4.451 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6049594879150391
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.469 Vali Acc: 0.302 Test Loss: 4.469 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6822147369384766
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.486 Vali Acc: 0.300 Test Loss: 4.486 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4879908561706543
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.507 Vali Acc: 0.298 Test Loss: 4.507 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6146352291107178
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.538 Vali Acc: 0.300 Test Loss: 4.538 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6060471534729004
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.588 Vali Acc: 0.294 Test Loss: 4.588 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6099936962127686
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.557 Vali Acc: 0.296 Test Loss: 4.557 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5023000240325928
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.566 Vali Acc: 0.299 Test Loss: 4.566 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6353781223297119
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.575 Vali Acc: 0.299 Test Loss: 4.575 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5867578983306885
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.613 Vali Acc: 0.298 Test Loss: 4.613 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 22412570
model size : 100.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5488622188568115
Epoch: 1, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.355 Vali Acc: 0.036 Test Loss: 3.355 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.7984707355499268
Epoch: 2, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.365 Vali Acc: 0.047 Test Loss: 3.365 Test Acc: 0.047
Validation loss decreased (-0.036437 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.5869252681732178
Epoch: 3, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.330 Vali Acc: 0.078 Test Loss: 3.330 Test Acc: 0.078
Validation loss decreased (-0.047025 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.5900063514709473
Epoch: 4, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.245 Vali Acc: 0.095 Test Loss: 3.245 Test Acc: 0.095
Validation loss decreased (-0.077614 --> -0.095262).  Saving model ...
Epoch: 5 cost time: 0.6353611946105957
Epoch: 5, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.224 Vali Acc: 0.106 Test Loss: 3.224 Test Acc: 0.106
Validation loss decreased (-0.095262 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 0.579369068145752
Epoch: 6, Steps: 10 | Train Loss: 2.398 Vali Loss: 3.183 Vali Acc: 0.153 Test Loss: 3.183 Test Acc: 0.153
Validation loss decreased (-0.105850 --> -0.152909).  Saving model ...
Epoch: 7 cost time: 0.77071213722229
Epoch: 7, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.180 Vali Acc: 0.154 Test Loss: 3.180 Test Acc: 0.154
Validation loss decreased (-0.152909 --> -0.154086).  Saving model ...
Epoch: 8 cost time: 0.5686466693878174
Epoch: 8, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.258 Vali Acc: 0.208 Test Loss: 3.258 Test Acc: 0.208
Validation loss decreased (-0.154086 --> -0.208203).  Saving model ...
Epoch: 9 cost time: 0.5455200672149658
Epoch: 9, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.518 Vali Acc: 0.232 Test Loss: 3.518 Test Acc: 0.232
Validation loss decreased (-0.208203 --> -0.231730).  Saving model ...
Epoch: 10 cost time: 0.4948697090148926
Epoch: 10, Steps: 10 | Train Loss: 0.880 Vali Loss: 3.654 Vali Acc: 0.265 Test Loss: 3.654 Test Acc: 0.265
Validation loss decreased (-0.231730 --> -0.264669).  Saving model ...
Epoch: 11 cost time: 0.481964111328125
Epoch: 11, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.809 Vali Acc: 0.271 Test Loss: 3.809 Test Acc: 0.271
Validation loss decreased (-0.264669 --> -0.270550).  Saving model ...
Epoch: 12 cost time: 0.6451056003570557
Epoch: 12, Steps: 10 | Train Loss: 0.287 Vali Loss: 4.100 Vali Acc: 0.271 Test Loss: 4.100 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6820087432861328
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.106 Vali Acc: 0.282 Test Loss: 4.106 Test Acc: 0.282
Validation loss decreased (-0.270550 --> -0.282312).  Saving model ...
Epoch: 14 cost time: 0.6168408393859863
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.285 Vali Acc: 0.300 Test Loss: 4.285 Test Acc: 0.300
Validation loss decreased (-0.282312 --> -0.299957).  Saving model ...
Epoch: 15 cost time: 0.6254379749298096
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.653 Vali Acc: 0.287 Test Loss: 4.653 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5008902549743652
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.517 Vali Acc: 0.309 Test Loss: 4.517 Test Acc: 0.309
Validation loss decreased (-0.299957 --> -0.309367).  Saving model ...
Epoch: 17 cost time: 0.6036496162414551
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.757 Vali Acc: 0.306 Test Loss: 4.757 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6051301956176758
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.804 Vali Acc: 0.301 Test Loss: 4.804 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5211541652679443
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.795 Vali Acc: 0.301 Test Loss: 4.795 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.468639612197876
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.847 Vali Acc: 0.302 Test Loss: 4.847 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5285093784332275
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.848 Vali Acc: 0.302 Test Loss: 4.848 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7166762351989746
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.943 Vali Acc: 0.308 Test Loss: 4.943 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4630401134490967
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.946 Vali Acc: 0.314 Test Loss: 4.946 Test Acc: 0.314
Validation loss decreased (-0.309367 --> -0.314068).  Saving model ...
Epoch: 24 cost time: 0.538825273513794
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.904 Vali Acc: 0.321 Test Loss: 4.904 Test Acc: 0.321
Validation loss decreased (-0.314068 --> -0.321127).  Saving model ...
Epoch: 25 cost time: 0.6279404163360596
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.958 Vali Acc: 0.315 Test Loss: 4.958 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5555422306060791
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.041 Vali Acc: 0.316 Test Loss: 5.041 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6824891567230225
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.051 Vali Acc: 0.314 Test Loss: 5.051 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6598737239837646
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.032 Vali Acc: 0.312 Test Loss: 5.032 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5325005054473877
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.021 Vali Acc: 0.315 Test Loss: 5.021 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6143002510070801
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.038 Vali Acc: 0.316 Test Loss: 5.038 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.549100399017334
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.063 Vali Acc: 0.318 Test Loss: 5.063 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5422275066375732
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.077 Vali Acc: 0.315 Test Loss: 5.077 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5268411636352539
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.073 Vali Acc: 0.316 Test Loss: 5.073 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5889499187469482
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.068 Vali Acc: 0.318 Test Loss: 5.068 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 22719770
model size : 101.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0572690963745117
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.345 Vali Acc: 0.042 Test Loss: 3.345 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.5443172454833984
Epoch: 2, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.313 Vali Acc: 0.065 Test Loss: 3.313 Test Acc: 0.065
Validation loss decreased (-0.042319 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.5490424633026123
Epoch: 3, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.318 Vali Acc: 0.078 Test Loss: 3.318 Test Acc: 0.078
Validation loss decreased (-0.064673 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.6617939472198486
Epoch: 4, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.284 Vali Acc: 0.081 Test Loss: 3.284 Test Acc: 0.081
Validation loss decreased (-0.077614 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 0.5703485012054443
Epoch: 5, Steps: 10 | Train Loss: 2.850 Vali Loss: 3.261 Vali Acc: 0.091 Test Loss: 3.261 Test Acc: 0.091
Validation loss decreased (-0.081144 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 0.5167081356048584
Epoch: 6, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.244 Vali Acc: 0.107 Test Loss: 3.244 Test Acc: 0.107
Validation loss decreased (-0.090556 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 0.6645781993865967
Epoch: 7, Steps: 10 | Train Loss: 2.451 Vali Loss: 3.212 Vali Acc: 0.119 Test Loss: 3.212 Test Acc: 0.119
Validation loss decreased (-0.107026 --> -0.118791).  Saving model ...
Epoch: 8 cost time: 0.6774101257324219
Epoch: 8, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.174 Vali Acc: 0.159 Test Loss: 3.174 Test Acc: 0.159
Validation loss decreased (-0.118791 --> -0.158792).  Saving model ...
Epoch: 9 cost time: 0.6639769077301025
Epoch: 9, Steps: 10 | Train Loss: 1.847 Vali Loss: 3.238 Vali Acc: 0.178 Test Loss: 3.238 Test Acc: 0.178
Validation loss decreased (-0.158792 --> -0.177615).  Saving model ...
Epoch: 10 cost time: 0.5617194175720215
Epoch: 10, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.396 Vali Acc: 0.181 Test Loss: 3.396 Test Acc: 0.181
Validation loss decreased (-0.177615 --> -0.181143).  Saving model ...
Epoch: 11 cost time: 0.5905845165252686
Epoch: 11, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.453 Vali Acc: 0.219 Test Loss: 3.453 Test Acc: 0.219
Validation loss decreased (-0.181143 --> -0.218789).  Saving model ...
Epoch: 12 cost time: 0.5386848449707031
Epoch: 12, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.506 Vali Acc: 0.240 Test Loss: 3.506 Test Acc: 0.240
Validation loss decreased (-0.218789 --> -0.239965).  Saving model ...
Epoch: 13 cost time: 0.7368326187133789
Epoch: 13, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.777 Vali Acc: 0.238 Test Loss: 3.777 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6211221218109131
Epoch: 14, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.768 Vali Acc: 0.260 Test Loss: 3.768 Test Acc: 0.260
Validation loss decreased (-0.239965 --> -0.259962).  Saving model ...
Epoch: 15 cost time: 0.5975689888000488
Epoch: 15, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.927 Vali Acc: 0.264 Test Loss: 3.927 Test Acc: 0.264
Validation loss decreased (-0.259962 --> -0.263490).  Saving model ...
Epoch: 16 cost time: 0.5734117031097412
Epoch: 16, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.084 Vali Acc: 0.265 Test Loss: 4.084 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264665).  Saving model ...
Epoch: 17 cost time: 0.546250581741333
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.068 Vali Acc: 0.280 Test Loss: 4.068 Test Acc: 0.280
Validation loss decreased (-0.264665 --> -0.279959).  Saving model ...
Epoch: 18 cost time: 0.6815779209136963
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.194 Vali Acc: 0.279 Test Loss: 4.194 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5692243576049805
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.262 Vali Acc: 0.276 Test Loss: 4.262 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6197121143341064
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.255 Vali Acc: 0.282 Test Loss: 4.255 Test Acc: 0.282
Validation loss decreased (-0.279959 --> -0.282310).  Saving model ...
Epoch: 21 cost time: 0.5419487953186035
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.327 Vali Acc: 0.281 Test Loss: 4.327 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6055233478546143
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.405 Vali Acc: 0.271 Test Loss: 4.405 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6800658702850342
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.405 Vali Acc: 0.288 Test Loss: 4.405 Test Acc: 0.288
Validation loss decreased (-0.282310 --> -0.288191).  Saving model ...
Epoch: 24 cost time: 0.5738451480865479
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.450 Vali Acc: 0.287 Test Loss: 4.450 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6756110191345215
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.470 Vali Acc: 0.289 Test Loss: 4.470 Test Acc: 0.289
Validation loss decreased (-0.288191 --> -0.289367).  Saving model ...
Epoch: 26 cost time: 0.7168846130371094
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.505 Vali Acc: 0.285 Test Loss: 4.505 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7100963592529297
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.506 Vali Acc: 0.287 Test Loss: 4.506 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9241950511932373
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.486 Vali Acc: 0.289 Test Loss: 4.486 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7644927501678467
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.524 Vali Acc: 0.296 Test Loss: 4.524 Test Acc: 0.296
Validation loss decreased (-0.289367 --> -0.296425).  Saving model ...
Epoch: 30 cost time: 0.6901311874389648
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.552 Vali Acc: 0.299 Test Loss: 4.552 Test Acc: 0.299
Validation loss decreased (-0.296425 --> -0.298778).  Saving model ...
Epoch: 31 cost time: 0.8209404945373535
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.571 Vali Acc: 0.296 Test Loss: 4.571 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6696829795837402
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.567 Vali Acc: 0.299 Test Loss: 4.567 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6970512866973877
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.589 Vali Acc: 0.295 Test Loss: 4.589 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6145782470703125
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.612 Vali Acc: 0.298 Test Loss: 4.612 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.669823169708252
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.629 Vali Acc: 0.298 Test Loss: 4.629 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5518112182617188
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.644 Vali Acc: 0.298 Test Loss: 4.644 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6760914325714111
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.661 Vali Acc: 0.296 Test Loss: 4.661 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.625887393951416
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.676 Vali Acc: 0.298 Test Loss: 4.676 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.531092643737793
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.685 Vali Acc: 0.298 Test Loss: 4.685 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5984587669372559
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.697 Vali Acc: 0.298 Test Loss: 4.697 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 22526234
model size : 100.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.885685682296753
Epoch: 1, Steps: 10 | Train Loss: 3.434 Vali Loss: 3.367 Vali Acc: 0.049 Test Loss: 3.367 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.4803140163421631
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.308 Vali Acc: 0.038 Test Loss: 3.308 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5771999359130859
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.293 Vali Acc: 0.052 Test Loss: 3.293 Test Acc: 0.052
Validation loss decreased (-0.049378 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.6844236850738525
Epoch: 4, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.306 Vali Acc: 0.060 Test Loss: 3.306 Test Acc: 0.060
Validation loss decreased (-0.051732 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.5101163387298584
Epoch: 5, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.306 Vali Acc: 0.061 Test Loss: 3.306 Test Acc: 0.061
Validation loss decreased (-0.059967 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 0.5817043781280518
Epoch: 6, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.267 Vali Acc: 0.082 Test Loss: 3.267 Test Acc: 0.082
Validation loss decreased (-0.061143 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 0.5159115791320801
Epoch: 7, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.250 Vali Acc: 0.108 Test Loss: 3.250 Test Acc: 0.108
Validation loss decreased (-0.082320 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.5184354782104492
Epoch: 8, Steps: 10 | Train Loss: 2.546 Vali Loss: 3.226 Vali Acc: 0.115 Test Loss: 3.226 Test Acc: 0.115
Validation loss decreased (-0.108203 --> -0.115262).  Saving model ...
Epoch: 9 cost time: 0.5551168918609619
Epoch: 9, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.203 Vali Acc: 0.122 Test Loss: 3.203 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122321).  Saving model ...
Epoch: 10 cost time: 0.5351486206054688
Epoch: 10, Steps: 10 | Train Loss: 2.119 Vali Loss: 3.202 Vali Acc: 0.159 Test Loss: 3.202 Test Acc: 0.159
Validation loss decreased (-0.122321 --> -0.158792).  Saving model ...
Epoch: 11 cost time: 0.5743281841278076
Epoch: 11, Steps: 10 | Train Loss: 1.807 Vali Loss: 3.242 Vali Acc: 0.174 Test Loss: 3.242 Test Acc: 0.174
Validation loss decreased (-0.158792 --> -0.174085).  Saving model ...
Epoch: 12 cost time: 0.5156192779541016
Epoch: 12, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.285 Vali Acc: 0.200 Test Loss: 3.285 Test Acc: 0.200
Validation loss decreased (-0.174085 --> -0.199967).  Saving model ...
Epoch: 13 cost time: 0.707352876663208
Epoch: 13, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.340 Vali Acc: 0.220 Test Loss: 3.340 Test Acc: 0.220
Validation loss decreased (-0.199967 --> -0.219967).  Saving model ...
Epoch: 14 cost time: 0.5429985523223877
Epoch: 14, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.407 Vali Acc: 0.213 Test Loss: 3.407 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5436916351318359
Epoch: 15, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.484 Vali Acc: 0.240 Test Loss: 3.484 Test Acc: 0.240
Validation loss decreased (-0.219967 --> -0.239965).  Saving model ...
Epoch: 16 cost time: 0.7159974575042725
Epoch: 16, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.511 Vali Acc: 0.262 Test Loss: 3.511 Test Acc: 0.262
Validation loss decreased (-0.239965 --> -0.262318).  Saving model ...
Epoch: 17 cost time: 0.5236096382141113
Epoch: 17, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.644 Vali Acc: 0.262 Test Loss: 3.644 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6145484447479248
Epoch: 18, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.679 Vali Acc: 0.260 Test Loss: 3.679 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6091594696044922
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.753 Vali Acc: 0.269 Test Loss: 3.753 Test Acc: 0.269
Validation loss decreased (-0.262318 --> -0.269374).  Saving model ...
Epoch: 20 cost time: 0.5855221748352051
Epoch: 20, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.897 Vali Acc: 0.280 Test Loss: 3.897 Test Acc: 0.280
Validation loss decreased (-0.269374 --> -0.279961).  Saving model ...
Epoch: 21 cost time: 0.5487000942230225
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.996 Vali Acc: 0.269 Test Loss: 3.996 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.578289270401001
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.956 Vali Acc: 0.282 Test Loss: 3.956 Test Acc: 0.282
Validation loss decreased (-0.279961 --> -0.282313).  Saving model ...
Epoch: 23 cost time: 0.6190764904022217
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.991 Vali Acc: 0.281 Test Loss: 3.991 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.56162428855896
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.015 Vali Acc: 0.281 Test Loss: 4.015 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.550743818283081
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.085 Vali Acc: 0.275 Test Loss: 4.085 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5142183303833008
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.161 Vali Acc: 0.282 Test Loss: 4.161 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5494740009307861
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.140 Vali Acc: 0.287 Test Loss: 4.140 Test Acc: 0.287
Validation loss decreased (-0.282313 --> -0.287017).  Saving model ...
Epoch: 28 cost time: 0.548431396484375
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.149 Vali Acc: 0.286 Test Loss: 4.149 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5057706832885742
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.188 Vali Acc: 0.287 Test Loss: 4.188 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5121173858642578
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.232 Vali Acc: 0.286 Test Loss: 4.232 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.49895167350769043
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.252 Vali Acc: 0.285 Test Loss: 4.252 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5483160018920898
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.259 Vali Acc: 0.284 Test Loss: 4.259 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4668083190917969
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.265 Vali Acc: 0.287 Test Loss: 4.265 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5737278461456299
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.281 Vali Acc: 0.293 Test Loss: 4.281 Test Acc: 0.293
Validation loss decreased (-0.287017 --> -0.292898).  Saving model ...
Epoch: 35 cost time: 0.5429263114929199
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.320 Vali Acc: 0.293 Test Loss: 4.320 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4693300724029541
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.346 Vali Acc: 0.288 Test Loss: 4.346 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4527597427368164
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.358 Vali Acc: 0.287 Test Loss: 4.358 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5689725875854492
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.355 Vali Acc: 0.296 Test Loss: 4.355 Test Acc: 0.296
Validation loss decreased (-0.292898 --> -0.296427).  Saving model ...
Epoch: 39 cost time: 0.5320515632629395
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.377 Vali Acc: 0.289 Test Loss: 4.377 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5511064529418945
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.394 Vali Acc: 0.289 Test Loss: 4.394 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4688417911529541
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.400 Vali Acc: 0.294 Test Loss: 4.400 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.47603678703308105
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.416 Vali Acc: 0.295 Test Loss: 4.416 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5926625728607178
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.449 Vali Acc: 0.295 Test Loss: 4.449 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4890410900115967
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.474 Vali Acc: 0.294 Test Loss: 4.474 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.46056413650512695
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.483 Vali Acc: 0.296 Test Loss: 4.483 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.43395233154296875
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.479 Vali Acc: 0.296 Test Loss: 4.479 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5093426704406738
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.494 Vali Acc: 0.298 Test Loss: 4.494 Test Acc: 0.298
Validation loss decreased (-0.296427 --> -0.297602).  Saving model ...
Epoch: 48 cost time: 0.5345938205718994
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.496 Vali Acc: 0.294 Test Loss: 4.496 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.61063551902771
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.507 Vali Acc: 0.294 Test Loss: 4.507 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.48385071754455566
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.529 Vali Acc: 0.292 Test Loss: 4.529 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 22418714
model size : 100.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2694497108459473
Epoch: 1, Steps: 10 | Train Loss: 3.390 Vali Loss: 3.344 Vali Acc: 0.047 Test Loss: 3.344 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.7687439918518066
Epoch: 2, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.356 Vali Acc: 0.049 Test Loss: 3.356 Test Acc: 0.049
Validation loss decreased (-0.047025 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.6737978458404541
Epoch: 3, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.358 Vali Acc: 0.073 Test Loss: 3.358 Test Acc: 0.073
Validation loss decreased (-0.049378 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.5685005187988281
Epoch: 4, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.284 Vali Acc: 0.074 Test Loss: 3.284 Test Acc: 0.074
Validation loss decreased (-0.072908 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 0.6755566596984863
Epoch: 5, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.215 Vali Acc: 0.106 Test Loss: 3.215 Test Acc: 0.106
Validation loss decreased (-0.074085 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 0.706489086151123
Epoch: 6, Steps: 10 | Train Loss: 2.525 Vali Loss: 3.231 Vali Acc: 0.138 Test Loss: 3.231 Test Acc: 0.138
Validation loss decreased (-0.105850 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 0.894296407699585
Epoch: 7, Steps: 10 | Train Loss: 2.173 Vali Loss: 3.194 Vali Acc: 0.149 Test Loss: 3.194 Test Acc: 0.149
Validation loss decreased (-0.137615 --> -0.149380).  Saving model ...
Epoch: 8 cost time: 0.858971357345581
Epoch: 8, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.218 Vali Acc: 0.181 Test Loss: 3.218 Test Acc: 0.181
Validation loss decreased (-0.149380 --> -0.181144).  Saving model ...
Epoch: 9 cost time: 0.7535178661346436
Epoch: 9, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.401 Vali Acc: 0.215 Test Loss: 3.401 Test Acc: 0.215
Validation loss decreased (-0.181144 --> -0.215260).  Saving model ...
Epoch: 10 cost time: 0.9574615955352783
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.693 Vali Acc: 0.211 Test Loss: 3.693 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6609103679656982
Epoch: 11, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.685 Vali Acc: 0.242 Test Loss: 3.685 Test Acc: 0.242
Validation loss decreased (-0.215260 --> -0.242316).  Saving model ...
Epoch: 12 cost time: 0.6560192108154297
Epoch: 12, Steps: 10 | Train Loss: 0.380 Vali Loss: 4.012 Vali Acc: 0.242 Test Loss: 4.012 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6119740009307861
Epoch: 13, Steps: 10 | Train Loss: 0.270 Vali Loss: 4.067 Vali Acc: 0.268 Test Loss: 4.067 Test Acc: 0.268
Validation loss decreased (-0.242316 --> -0.268195).  Saving model ...
Epoch: 14 cost time: 0.6912927627563477
Epoch: 14, Steps: 10 | Train Loss: 0.140 Vali Loss: 4.329 Vali Acc: 0.248 Test Loss: 4.329 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6755568981170654
Epoch: 15, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.460 Vali Acc: 0.267 Test Loss: 4.460 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.627763032913208
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.557 Vali Acc: 0.273 Test Loss: 4.557 Test Acc: 0.273
Validation loss decreased (-0.268195 --> -0.272896).  Saving model ...
Epoch: 17 cost time: 0.7884588241577148
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.769 Vali Acc: 0.272 Test Loss: 4.769 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.48643970489501953
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.674 Vali Acc: 0.293 Test Loss: 4.674 Test Acc: 0.293
Validation loss decreased (-0.272896 --> -0.292894).  Saving model ...
Epoch: 19 cost time: 0.6043283939361572
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.626 Vali Acc: 0.306 Test Loss: 4.626 Test Acc: 0.306
Validation loss decreased (-0.292894 --> -0.305836).  Saving model ...
Epoch: 20 cost time: 0.6639463901519775
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.690 Vali Acc: 0.299 Test Loss: 4.690 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7276642322540283
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.776 Vali Acc: 0.292 Test Loss: 4.776 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6543607711791992
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.811 Vali Acc: 0.287 Test Loss: 4.811 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8525445461273193
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.773 Vali Acc: 0.293 Test Loss: 4.773 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6669096946716309
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.792 Vali Acc: 0.306 Test Loss: 4.792 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7935030460357666
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.808 Vali Acc: 0.311 Test Loss: 4.808 Test Acc: 0.311
Validation loss decreased (-0.305836 --> -0.310540).  Saving model ...
Epoch: 26 cost time: 0.7072005271911621
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.817 Vali Acc: 0.301 Test Loss: 4.817 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8912062644958496
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.841 Vali Acc: 0.298 Test Loss: 4.841 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9184350967407227
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.840 Vali Acc: 0.296 Test Loss: 4.840 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7039179801940918
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.855 Vali Acc: 0.299 Test Loss: 4.855 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8883647918701172
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.875 Vali Acc: 0.300 Test Loss: 4.875 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2292060852050781
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.889 Vali Acc: 0.301 Test Loss: 4.889 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9024255275726318
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.907 Vali Acc: 0.306 Test Loss: 4.907 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7577290534973145
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.903 Vali Acc: 0.305 Test Loss: 4.903 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.554370641708374
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.903 Vali Acc: 0.306 Test Loss: 4.903 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9588668346405029
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.901 Vali Acc: 0.304 Test Loss: 4.901 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 22689818
model size : 101.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.193333864212036
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.331 Vali Acc: 0.042 Test Loss: 3.331 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.5428404808044434
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.319 Vali Acc: 0.046 Test Loss: 3.319 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.5634737014770508
Epoch: 3, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.331 Vali Acc: 0.047 Test Loss: 3.331 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.5724940299987793
Epoch: 4, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.342 Vali Acc: 0.062 Test Loss: 3.342 Test Acc: 0.062
Validation loss decreased (-0.047026 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.5110232830047607
Epoch: 5, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.293 Vali Acc: 0.081 Test Loss: 3.293 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 0.5348780155181885
Epoch: 6, Steps: 10 | Train Loss: 2.736 Vali Loss: 3.261 Vali Acc: 0.102 Test Loss: 3.261 Test Acc: 0.102
Validation loss decreased (-0.081144 --> -0.102320).  Saving model ...
Epoch: 7 cost time: 0.6332147121429443
Epoch: 7, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.233 Vali Acc: 0.116 Test Loss: 3.233 Test Acc: 0.116
Validation loss decreased (-0.102320 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 0.5825788974761963
Epoch: 8, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.189 Vali Acc: 0.146 Test Loss: 3.189 Test Acc: 0.146
Validation loss decreased (-0.116438 --> -0.145850).  Saving model ...
Epoch: 9 cost time: 0.5282721519470215
Epoch: 9, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.214 Vali Acc: 0.166 Test Loss: 3.214 Test Acc: 0.166
Validation loss decreased (-0.145850 --> -0.165850).  Saving model ...
Epoch: 10 cost time: 0.6837892532348633
Epoch: 10, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.308 Vali Acc: 0.188 Test Loss: 3.308 Test Acc: 0.188
Validation loss decreased (-0.165850 --> -0.188202).  Saving model ...
Epoch: 11 cost time: 0.5524210929870605
Epoch: 11, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.336 Vali Acc: 0.224 Test Loss: 3.336 Test Acc: 0.224
Validation loss decreased (-0.188202 --> -0.223496).  Saving model ...
Epoch: 12 cost time: 0.6203632354736328
Epoch: 12, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.454 Vali Acc: 0.233 Test Loss: 3.454 Test Acc: 0.233
Validation loss decreased (-0.223496 --> -0.232907).  Saving model ...
Epoch: 13 cost time: 0.5480384826660156
Epoch: 13, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.520 Vali Acc: 0.261 Test Loss: 3.520 Test Acc: 0.261
Validation loss decreased (-0.232907 --> -0.261141).  Saving model ...
Epoch: 14 cost time: 0.49274492263793945
Epoch: 14, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.683 Vali Acc: 0.262 Test Loss: 3.683 Test Acc: 0.262
Validation loss decreased (-0.261141 --> -0.262316).  Saving model ...
Epoch: 15 cost time: 0.5335040092468262
Epoch: 15, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.660 Vali Acc: 0.273 Test Loss: 3.660 Test Acc: 0.273
Validation loss decreased (-0.262316 --> -0.272905).  Saving model ...
Epoch: 16 cost time: 0.6500668525695801
Epoch: 16, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.977 Vali Acc: 0.278 Test Loss: 3.977 Test Acc: 0.278
Validation loss decreased (-0.272905 --> -0.277607).  Saving model ...
Epoch: 17 cost time: 0.4845771789550781
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.951 Vali Acc: 0.292 Test Loss: 3.951 Test Acc: 0.292
Validation loss decreased (-0.277607 --> -0.291725).  Saving model ...
Epoch: 18 cost time: 0.5283877849578857
Epoch: 18, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.062 Vali Acc: 0.296 Test Loss: 4.062 Test Acc: 0.296
Validation loss decreased (-0.291725 --> -0.296430).  Saving model ...
Epoch: 19 cost time: 0.5604772567749023
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.185 Vali Acc: 0.300 Test Loss: 4.185 Test Acc: 0.300
Validation loss decreased (-0.296430 --> -0.299958).  Saving model ...
Epoch: 20 cost time: 0.6351373195648193
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.233 Vali Acc: 0.288 Test Loss: 4.233 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7563865184783936
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.281 Vali Acc: 0.294 Test Loss: 4.281 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6773231029510498
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.306 Vali Acc: 0.293 Test Loss: 4.306 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4419233798980713
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.363 Vali Acc: 0.293 Test Loss: 4.363 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.49794816970825195
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.417 Vali Acc: 0.298 Test Loss: 4.417 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.49353837966918945
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.451 Vali Acc: 0.302 Test Loss: 4.451 Test Acc: 0.302
Validation loss decreased (-0.299958 --> -0.302308).  Saving model ...
Epoch: 26 cost time: 0.5494771003723145
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.432 Vali Acc: 0.309 Test Loss: 4.432 Test Acc: 0.309
Validation loss decreased (-0.302308 --> -0.309367).  Saving model ...
Epoch: 27 cost time: 0.6073925495147705
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.403 Vali Acc: 0.301 Test Loss: 4.403 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5491800308227539
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.448 Vali Acc: 0.296 Test Loss: 4.448 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6686153411865234
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.486 Vali Acc: 0.301 Test Loss: 4.486 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5412907600402832
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.520 Vali Acc: 0.299 Test Loss: 4.520 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5673279762268066
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.539 Vali Acc: 0.301 Test Loss: 4.539 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.765505313873291
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.543 Vali Acc: 0.305 Test Loss: 4.543 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.681800127029419
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.557 Vali Acc: 0.308 Test Loss: 4.557 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.698021411895752
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.596 Vali Acc: 0.304 Test Loss: 4.596 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7281627655029297
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.639 Vali Acc: 0.305 Test Loss: 4.639 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6861863136291504
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.661 Vali Acc: 0.305 Test Loss: 4.661 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 22517786
model size : 100.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.698317289352417
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.341 Vali Acc: 0.058 Test Loss: 3.341 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.5773599147796631
Epoch: 2, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.322 Vali Acc: 0.049 Test Loss: 3.322 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6136486530303955
Epoch: 3, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.318 Vali Acc: 0.052 Test Loss: 3.318 Test Acc: 0.052
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49402856826782227
Epoch: 4, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.309 Vali Acc: 0.059 Test Loss: 3.309 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 0.5817012786865234
Epoch: 5, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.301 Vali Acc: 0.067 Test Loss: 3.301 Test Acc: 0.067
Validation loss decreased (-0.058790 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.5214328765869141
Epoch: 6, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.289 Vali Acc: 0.068 Test Loss: 3.289 Test Acc: 0.068
Validation loss decreased (-0.067026 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 0.5365335941314697
Epoch: 7, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.264 Vali Acc: 0.096 Test Loss: 3.264 Test Acc: 0.096
Validation loss decreased (-0.068202 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 0.6007077693939209
Epoch: 8, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.244 Vali Acc: 0.104 Test Loss: 3.244 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 0.5589168071746826
Epoch: 9, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.231 Vali Acc: 0.125 Test Loss: 3.231 Test Acc: 0.125
Validation loss decreased (-0.103497 --> -0.124674).  Saving model ...
Epoch: 10 cost time: 0.6410784721374512
Epoch: 10, Steps: 10 | Train Loss: 2.137 Vali Loss: 3.255 Vali Acc: 0.128 Test Loss: 3.255 Test Acc: 0.128
Validation loss decreased (-0.124674 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 0.6096560955047607
Epoch: 11, Steps: 10 | Train Loss: 1.734 Vali Loss: 3.253 Vali Acc: 0.166 Test Loss: 3.253 Test Acc: 0.166
Validation loss decreased (-0.128203 --> -0.165850).  Saving model ...
Epoch: 12 cost time: 0.7795596122741699
Epoch: 12, Steps: 10 | Train Loss: 1.508 Vali Loss: 3.315 Vali Acc: 0.187 Test Loss: 3.315 Test Acc: 0.187
Validation loss decreased (-0.165850 --> -0.187026).  Saving model ...
Epoch: 13 cost time: 0.6160383224487305
Epoch: 13, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.275 Vali Acc: 0.227 Test Loss: 3.275 Test Acc: 0.227
Validation loss decreased (-0.187026 --> -0.227026).  Saving model ...
Epoch: 14 cost time: 0.622706413269043
Epoch: 14, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.396 Vali Acc: 0.207 Test Loss: 3.396 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5945451259613037
Epoch: 15, Steps: 10 | Train Loss: 0.684 Vali Loss: 3.462 Vali Acc: 0.232 Test Loss: 3.462 Test Acc: 0.232
Validation loss decreased (-0.227026 --> -0.231730).  Saving model ...
Epoch: 16 cost time: 0.5842299461364746
Epoch: 16, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.513 Vali Acc: 0.254 Test Loss: 3.513 Test Acc: 0.254
Validation loss decreased (-0.231730 --> -0.254083).  Saving model ...
Epoch: 17 cost time: 0.6006557941436768
Epoch: 17, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.612 Vali Acc: 0.265 Test Loss: 3.612 Test Acc: 0.265
Validation loss decreased (-0.254083 --> -0.264670).  Saving model ...
Epoch: 18 cost time: 0.7135467529296875
Epoch: 18, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.707 Vali Acc: 0.249 Test Loss: 3.707 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6693449020385742
Epoch: 19, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.782 Vali Acc: 0.253 Test Loss: 3.782 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6410939693450928
Epoch: 20, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.760 Vali Acc: 0.275 Test Loss: 3.760 Test Acc: 0.275
Validation loss decreased (-0.264670 --> -0.275257).  Saving model ...
Epoch: 21 cost time: 0.7570130825042725
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.874 Vali Acc: 0.268 Test Loss: 3.874 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7524266242980957
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.948 Vali Acc: 0.272 Test Loss: 3.948 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6019365787506104
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.955 Vali Acc: 0.273 Test Loss: 3.955 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6264703273773193
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.977 Vali Acc: 0.288 Test Loss: 3.977 Test Acc: 0.288
Validation loss decreased (-0.275257 --> -0.288196).  Saving model ...
Epoch: 25 cost time: 0.7178246974945068
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.031 Vali Acc: 0.298 Test Loss: 4.031 Test Acc: 0.298
Validation loss decreased (-0.288196 --> -0.297607).  Saving model ...
Epoch: 26 cost time: 0.6330981254577637
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.104 Vali Acc: 0.288 Test Loss: 4.104 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6537191867828369
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.139 Vali Acc: 0.280 Test Loss: 4.139 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6047859191894531
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.176 Vali Acc: 0.281 Test Loss: 4.176 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5883891582489014
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.203 Vali Acc: 0.288 Test Loss: 4.203 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7026965618133545
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.221 Vali Acc: 0.287 Test Loss: 4.221 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.626795768737793
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.236 Vali Acc: 0.286 Test Loss: 4.236 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6548111438751221
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.254 Vali Acc: 0.288 Test Loss: 4.254 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6805722713470459
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.284 Vali Acc: 0.285 Test Loss: 4.284 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.626380443572998
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.307 Vali Acc: 0.288 Test Loss: 4.307 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7576150894165039
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.329 Vali Acc: 0.288 Test Loss: 4.329 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_GPT4TS_UEA_ftM_sl152_ll0_pl0_el3_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 22431770
model size : 100.24MB
