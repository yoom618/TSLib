Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.049382925033569
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.570 Vali Acc: 0.712 Test Loss: 0.570 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.5812864303588867
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.643 Vali Acc: 0.673 Test Loss: 0.643 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5019350051879883
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.590 Vali Acc: 0.707 Test Loss: 0.590 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4284799098968506
Epoch: 4, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.547 Vali Acc: 0.722 Test Loss: 0.547 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.90057110786438
Epoch: 5, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4317522048950195
Epoch: 6, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.536381721496582
Epoch: 7, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.829 Vali Acc: 0.707 Test Loss: 0.829 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.785083293914795
Epoch: 8, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.112 Vali Acc: 0.629 Test Loss: 1.112 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.238959789276123
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.177 Vali Acc: 0.698 Test Loss: 1.177 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.053955316543579
Epoch: 10, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.862 Vali Acc: 0.727 Test Loss: 1.862 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726811).  Saving model ...
Epoch: 11 cost time: 2.936581611633301
Epoch: 11, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.621 Vali Acc: 0.629 Test Loss: 1.621 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.603031873703003
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.797 Vali Acc: 0.624 Test Loss: 1.797 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9305946826934814
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.807 Vali Acc: 0.624 Test Loss: 1.807 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3727986812591553
Epoch: 14, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.792 Vali Acc: 0.659 Test Loss: 1.792 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.31396222114563
Epoch: 15, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.235 Vali Acc: 0.620 Test Loss: 2.235 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.316861867904663
Epoch: 16, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.255 Vali Acc: 0.659 Test Loss: 2.255 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.779524564743042
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.905 Vali Acc: 0.688 Test Loss: 1.905 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.194223642349243
Epoch: 18, Steps: 13 | Train Loss: 0.140 Vali Loss: 2.037 Vali Acc: 0.698 Test Loss: 2.037 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.3309543132781982
Epoch: 19, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.574 Vali Acc: 0.693 Test Loss: 2.574 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.9502382278442383
Epoch: 20, Steps: 13 | Train Loss: 0.096 Vali Loss: 2.457 Vali Acc: 0.654 Test Loss: 2.457 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 46005506
model size : 190.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.297347784042358
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.4681875705718994
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.656 Vali Acc: 0.722 Test Loss: 0.656 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.011260747909546
Epoch: 3, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 3.3849029541015625
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.614678382873535
Epoch: 5, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.530 Vali Acc: 0.717 Test Loss: 0.530 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4754602909088135
Epoch: 6, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.593 Vali Acc: 0.693 Test Loss: 0.593 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4041388034820557
Epoch: 7, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.692 Vali Acc: 0.746 Test Loss: 0.692 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.201125383377075
Epoch: 8, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.721 Vali Acc: 0.698 Test Loss: 0.721 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.043459415435791
Epoch: 9, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.977 Vali Acc: 0.712 Test Loss: 0.977 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.008504629135132
Epoch: 10, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.995 Vali Acc: 0.702 Test Loss: 0.995 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.005178689956665
Epoch: 11, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.140 Vali Acc: 0.693 Test Loss: 1.140 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.71140718460083
Epoch: 12, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.452 Vali Acc: 0.717 Test Loss: 1.452 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4798953533172607
Epoch: 13, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.213 Vali Acc: 0.678 Test Loss: 1.213 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 45901058
model size : 189.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1252260208129883
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7587766647338867
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.9152090549468994
Epoch: 3, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.149989366531372
Epoch: 4, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.508 Vali Acc: 0.771 Test Loss: 0.508 Test Acc: 0.771
Validation loss decreased (-0.736580 --> -0.770727).  Saving model ...
Epoch: 5 cost time: 2.4603464603424072
Epoch: 5, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.509 Vali Acc: 0.746 Test Loss: 0.509 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4399166107177734
Epoch: 6, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.550 Vali Acc: 0.761 Test Loss: 0.550 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7484676837921143
Epoch: 7, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.755 Vali Acc: 0.746 Test Loss: 0.755 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0477964878082275
Epoch: 8, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.099 Vali Acc: 0.761 Test Loss: 1.099 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3505704402923584
Epoch: 9, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.588 Vali Acc: 0.756 Test Loss: 0.588 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.676600456237793
Epoch: 10, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7856650352478027
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3558177947998047
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.789 Vali Acc: 0.737 Test Loss: 0.789 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8924567699432373
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.991 Vali Acc: 0.751 Test Loss: 0.991 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7377114295959473
Epoch: 14, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.919 Vali Acc: 0.727 Test Loss: 0.919 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 45836546
model size : 189.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.4535205364227295
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.7597174644470215
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.787797212600708
Epoch: 3, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.871391534805298
Epoch: 4, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.683460235595703
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.683 Vali Acc: 0.766 Test Loss: 0.683 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765847).  Saving model ...
Epoch: 6 cost time: 2.7558109760284424
Epoch: 6, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.701 Vali Acc: 0.737 Test Loss: 0.701 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9503014087677
Epoch: 7, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.816 Vali Acc: 0.639 Test Loss: 0.816 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2338078022003174
Epoch: 8, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.061 Vali Acc: 0.698 Test Loss: 1.061 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2656378746032715
Epoch: 9, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.403 Vali Acc: 0.663 Test Loss: 1.403 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1666722297668457
Epoch: 10, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.095 Vali Acc: 0.712 Test Loss: 1.095 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.721517562866211
Epoch: 11, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.465 Vali Acc: 0.737 Test Loss: 1.465 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.335353374481201
Epoch: 12, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.362 Vali Acc: 0.707 Test Loss: 1.362 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.015542984008789
Epoch: 13, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.519 Vali Acc: 0.644 Test Loss: 1.519 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.103363275527954
Epoch: 14, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.979 Vali Acc: 0.722 Test Loss: 1.979 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0167503356933594
Epoch: 15, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.672 Vali Acc: 0.722 Test Loss: 1.672 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 46146050
model size : 190.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9912381172180176
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.7229673862457275
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.645780324935913
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 2.7487125396728516
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.381807327270508
Epoch: 5, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.625 Vali Acc: 0.741 Test Loss: 0.625 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.976760149002075
Epoch: 6, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9296317100524902
Epoch: 7, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8346643447875977
Epoch: 8, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.118 Vali Acc: 0.737 Test Loss: 1.118 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.65396785736084
Epoch: 9, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.714 Vali Acc: 0.732 Test Loss: 0.714 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9384384155273438
Epoch: 10, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.007 Vali Acc: 0.737 Test Loss: 1.007 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4949727058410645
Epoch: 11, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.958 Vali Acc: 0.702 Test Loss: 0.958 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2103729248046875
Epoch: 12, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.162 Vali Acc: 0.624 Test Loss: 1.162 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3637592792510986
Epoch: 13, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.011 Vali Acc: 0.737 Test Loss: 1.011 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 46041602
model size : 190.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.901254177093506
Epoch: 1, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.7193562984466553
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.982175350189209
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.599290132522583
Epoch: 4, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.511 Vali Acc: 0.727 Test Loss: 0.511 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 1.8519351482391357
Epoch: 5, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.644 Vali Acc: 0.771 Test Loss: 0.644 Test Acc: 0.771
Validation loss decreased (-0.726824 --> -0.770725).  Saving model ...
Epoch: 6 cost time: 2.053006887435913
Epoch: 6, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5577669143676758
Epoch: 7, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.609 Vali Acc: 0.727 Test Loss: 0.609 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6697847843170166
Epoch: 8, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.283294439315796
Epoch: 9, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.764 Vali Acc: 0.668 Test Loss: 0.764 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9405858516693115
Epoch: 10, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.227 Vali Acc: 0.590 Test Loss: 1.227 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2639288902282715
Epoch: 11, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.737 Vali Acc: 0.702 Test Loss: 0.737 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5292766094207764
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.961 Vali Acc: 0.732 Test Loss: 0.961 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4724152088165283
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.867 Vali Acc: 0.751 Test Loss: 0.867 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.196106433868408
Epoch: 14, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.885 Vali Acc: 0.737 Test Loss: 0.885 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.175022840499878
Epoch: 15, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.266 Vali Acc: 0.732 Test Loss: 1.266 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 45974018
model size : 190.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.479199409484863
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.118971347808838
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.522 Vali Acc: 0.751 Test Loss: 0.522 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.2454593181610107
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6848690509796143
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.540 Vali Acc: 0.693 Test Loss: 0.540 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5275440216064453
Epoch: 5, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.763 Vali Acc: 0.659 Test Loss: 0.763 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.980210542678833
Epoch: 6, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.348 Vali Acc: 0.556 Test Loss: 1.348 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4165639877319336
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.862220287322998
Epoch: 8, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.962 Vali Acc: 0.688 Test Loss: 0.962 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4147350788116455
Epoch: 9, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.195 Vali Acc: 0.707 Test Loss: 1.195 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.962970495223999
Epoch: 10, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.257 Vali Acc: 0.693 Test Loss: 1.257 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7539470195770264
Epoch: 11, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.380 Vali Acc: 0.663 Test Loss: 1.380 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8588318824768066
Epoch: 12, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.368 Vali Acc: 0.698 Test Loss: 1.368 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 46286594
model size : 191.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.268310070037842
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 2.618421792984009
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.233900547027588
Epoch: 3, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.494 Vali Acc: 0.737 Test Loss: 0.494 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1349661350250244
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.611 Vali Acc: 0.771 Test Loss: 0.611 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 5 cost time: 2.2888848781585693
Epoch: 5, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775603).  Saving model ...
Epoch: 6 cost time: 2.510289430618286
Epoch: 6, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.905 Vali Acc: 0.634 Test Loss: 0.905 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2732489109039307
Epoch: 7, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.629 Vali Acc: 0.771 Test Loss: 0.629 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5471737384796143
Epoch: 8, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.275561809539795
Epoch: 9, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.885 Vali Acc: 0.756 Test Loss: 0.885 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.639803647994995
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.868 Vali Acc: 0.712 Test Loss: 0.868 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.431422472000122
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.342 Vali Acc: 0.741 Test Loss: 1.342 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.67850661277771
Epoch: 12, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.257 Vali Acc: 0.751 Test Loss: 1.257 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8069472312927246
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.165 Vali Acc: 0.741 Test Loss: 1.165 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6485154628753662
Epoch: 14, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.268 Vali Acc: 0.634 Test Loss: 1.268 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9501442909240723
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.266 Vali Acc: 0.702 Test Loss: 1.266 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 46166786
model size : 190.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1852712631225586
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2429306507110596
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.9818596839904785
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.554 Vali Acc: 0.746 Test Loss: 0.554 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.268294334411621
Epoch: 4, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.512 Vali Acc: 0.761 Test Loss: 0.512 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.7464268207550049
Epoch: 5, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.564 Vali Acc: 0.771 Test Loss: 0.564 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 6 cost time: 1.9765126705169678
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3025171756744385
Epoch: 7, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.649 Vali Acc: 0.751 Test Loss: 0.649 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.302171468734741
Epoch: 8, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.770 Vali Acc: 0.741 Test Loss: 0.770 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6633288860321045
Epoch: 9, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.749 Vali Acc: 0.698 Test Loss: 0.749 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8744606971740723
Epoch: 10, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.729 Vali Acc: 0.688 Test Loss: 0.729 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.172914505004883
Epoch: 11, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.988 Vali Acc: 0.737 Test Loss: 0.988 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.325199842453003
Epoch: 12, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.222 Vali Acc: 0.756 Test Loss: 1.222 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9958069324493408
Epoch: 13, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.009 Vali Acc: 0.707 Test Loss: 1.009 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4927372932434082
Epoch: 14, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.988 Vali Acc: 0.707 Test Loss: 0.988 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4813976287841797
Epoch: 15, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.118 Vali Acc: 0.663 Test Loss: 1.118 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 46111490
model size : 190.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.149561643600464
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.3553757667541504
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.4418697357177734
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.6207032203674316
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.629 Vali Acc: 0.766 Test Loss: 0.629 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 5 cost time: 2.7488698959350586
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.516 Vali Acc: 0.746 Test Loss: 0.516 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3646552562713623
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9897286891937256
Epoch: 7, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.614 Vali Acc: 0.751 Test Loss: 0.614 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.990372896194458
Epoch: 8, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.740 Vali Acc: 0.727 Test Loss: 0.740 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9995954036712646
Epoch: 9, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.965 Vali Acc: 0.712 Test Loss: 0.965 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8552629947662354
Epoch: 10, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.055 Vali Acc: 0.737 Test Loss: 1.055 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.815052032470703
Epoch: 11, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.303 Vali Acc: 0.727 Test Loss: 1.303 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7946627140045166
Epoch: 12, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.201 Vali Acc: 0.693 Test Loss: 1.201 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.2215023040771484
Epoch: 13, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.142 Vali Acc: 0.683 Test Loss: 1.142 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1972014904022217
Epoch: 14, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.445 Vali Acc: 0.698 Test Loss: 1.445 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 46427138
model size : 191.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8294460773468018
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 2.2382616996765137
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.219853401184082
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.550 Vali Acc: 0.702 Test Loss: 0.550 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.349475622177124
Epoch: 4, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.560 Vali Acc: 0.698 Test Loss: 0.560 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.348954439163208
Epoch: 5, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1757755279541016
Epoch: 6, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.890 Vali Acc: 0.751 Test Loss: 0.890 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751211).  Saving model ...
Epoch: 7 cost time: 2.251450300216675
Epoch: 7, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1355175971984863
Epoch: 8, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.714 Vali Acc: 0.722 Test Loss: 0.714 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3003456592559814
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.784 Vali Acc: 0.702 Test Loss: 0.784 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5575010776519775
Epoch: 10, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.747084617614746
Epoch: 11, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.947 Vali Acc: 0.717 Test Loss: 0.947 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7435803413391113
Epoch: 12, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.863 Vali Acc: 0.722 Test Loss: 0.863 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4955997467041016
Epoch: 13, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.690 Vali Acc: 0.556 Test Loss: 1.690 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.518373489379883
Epoch: 14, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.087 Vali Acc: 0.727 Test Loss: 1.087 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.749286651611328
Epoch: 15, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.209 Vali Acc: 0.698 Test Loss: 1.209 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5984411239624023
Epoch: 16, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.071 Vali Acc: 0.746 Test Loss: 1.071 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 46307330
model size : 191.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.023800849914551
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.374633312225342
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.536 Vali Acc: 0.751 Test Loss: 0.536 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.412627696990967
Epoch: 3, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.453917980194092
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.637 Vali Acc: 0.741 Test Loss: 0.637 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1953587532043457
Epoch: 5, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.611 Vali Acc: 0.698 Test Loss: 0.611 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.090240001678467
Epoch: 6, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8325796127319336
Epoch: 7, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.868 Vali Acc: 0.722 Test Loss: 0.868 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.964867115020752
Epoch: 8, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.628 Vali Acc: 0.702 Test Loss: 0.628 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8786535263061523
Epoch: 9, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.28309965133667
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.249889373779297
Epoch: 11, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.755 Vali Acc: 0.649 Test Loss: 0.755 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3989014625549316
Epoch: 12, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.746 Vali Acc: 0.698 Test Loss: 0.746 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 46248962
model size : 191.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.2751710414886475
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.754 Vali Acc: 0.293 Test Loss: 0.754 Test Acc: 0.293
Validation loss decreased (inf --> -0.292675).  Saving model ...
Epoch: 2 cost time: 2.846522569656372
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.292675 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 3.9178264141082764
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.551 Vali Acc: 0.688 Test Loss: 0.551 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.158313035964966
Epoch: 4, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.627 Vali Acc: 0.771 Test Loss: 0.627 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770725).  Saving model ...
Epoch: 5 cost time: 3.557576894760132
Epoch: 5, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.185673952102661
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.605 Vali Acc: 0.727 Test Loss: 0.605 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7094719409942627
Epoch: 7, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.850 Vali Acc: 0.732 Test Loss: 0.850 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0667378902435303
Epoch: 8, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.982 Vali Acc: 0.751 Test Loss: 0.982 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.753591299057007
Epoch: 9, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.848 Vali Acc: 0.727 Test Loss: 0.848 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.599228858947754
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.895 Vali Acc: 0.693 Test Loss: 0.895 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.522125005722046
Epoch: 11, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.356 Vali Acc: 0.722 Test Loss: 1.356 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6393351554870605
Epoch: 12, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.770 Vali Acc: 0.727 Test Loss: 1.770 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.718111991882324
Epoch: 13, Steps: 13 | Train Loss: 0.543 Vali Loss: 1.177 Vali Acc: 0.649 Test Loss: 1.177 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1697914600372314
Epoch: 14, Steps: 13 | Train Loss: 0.223 Vali Loss: 2.303 Vali Acc: 0.595 Test Loss: 2.303 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 46527746
model size : 192.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.154651165008545
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.474944829940796
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.598297119140625
Epoch: 3, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.666 Vali Acc: 0.746 Test Loss: 0.666 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 2.1503818035125732
Epoch: 4, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0801689624786377
Epoch: 5, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.582 Vali Acc: 0.746 Test Loss: 0.582 Test Acc: 0.746
Validation loss decreased (-0.746335 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.099564790725708
Epoch: 6, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 7 cost time: 2.529003620147705
Epoch: 7, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.629 Vali Acc: 0.654 Test Loss: 0.629 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.635220527648926
Epoch: 8, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.687 Vali Acc: 0.712 Test Loss: 0.687 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.599379062652588
Epoch: 9, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.787 Vali Acc: 0.698 Test Loss: 0.787 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9714879989624023
Epoch: 10, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.983 Vali Acc: 0.707 Test Loss: 0.983 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9094603061676025
Epoch: 11, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4961435794830322
Epoch: 12, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.013 Vali Acc: 0.732 Test Loss: 1.013 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.703237533569336
Epoch: 13, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.084 Vali Acc: 0.737 Test Loss: 1.084 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7942051887512207
Epoch: 14, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.956 Vali Acc: 0.707 Test Loss: 0.956 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8853418827056885
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.447 Vali Acc: 0.727 Test Loss: 1.447 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9531023502349854
Epoch: 16, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.417 Vali Acc: 0.707 Test Loss: 1.417 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 46435586
model size : 191.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.280029296875
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.9143962860107422
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.014667510986328
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.512 Vali Acc: 0.766 Test Loss: 0.512 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 1.9507966041564941
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.500 Vali Acc: 0.741 Test Loss: 0.500 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1524877548217773
Epoch: 5, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.644 Vali Acc: 0.659 Test Loss: 0.644 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.193300724029541
Epoch: 6, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.657 Vali Acc: 0.741 Test Loss: 0.657 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.409081220626831
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8506650924682617
Epoch: 8, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.697 Vali Acc: 0.751 Test Loss: 0.697 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9662902355194092
Epoch: 9, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.755 Vali Acc: 0.771 Test Loss: 0.755 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770724).  Saving model ...
Epoch: 10 cost time: 2.182710647583008
Epoch: 10, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.753 Vali Acc: 0.751 Test Loss: 0.753 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.651841878890991
Epoch: 11, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.828 Vali Acc: 0.678 Test Loss: 0.828 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.63449764251709
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.802 Vali Acc: 0.702 Test Loss: 0.802 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.279356002807617
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.052 Vali Acc: 0.761 Test Loss: 1.052 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5141098499298096
Epoch: 14, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.942 Vali Acc: 0.732 Test Loss: 0.942 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3493459224700928
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.085 Vali Acc: 0.732 Test Loss: 1.085 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7026679515838623
Epoch: 16, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.167 Vali Acc: 0.756 Test Loss: 1.167 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.677778959274292
Epoch: 17, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.978 Vali Acc: 0.712 Test Loss: 0.978 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4424006938934326
Epoch: 18, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.296 Vali Acc: 0.766 Test Loss: 1.296 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3052432537078857
Epoch: 19, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.302 Vali Acc: 0.741 Test Loss: 1.302 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 46386434
model size : 191.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.617729663848877
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.568976879119873
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.539 Vali Acc: 0.771 Test Loss: 0.539 Test Acc: 0.771
Validation loss decreased (-0.721945 --> -0.770726).  Saving model ...
Epoch: 3 cost time: 2.4190616607666016
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.542 Vali Acc: 0.766 Test Loss: 0.542 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5183842182159424
Epoch: 4, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.696 Vali Acc: 0.732 Test Loss: 0.696 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0621185302734375
Epoch: 5, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1182382106781006
Epoch: 6, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.903 Vali Acc: 0.741 Test Loss: 0.903 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5566558837890625
Epoch: 7, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.048 Vali Acc: 0.737 Test Loss: 1.048 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3570103645324707
Epoch: 8, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.846 Vali Acc: 0.722 Test Loss: 0.846 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8459012508392334
Epoch: 9, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.725 Vali Acc: 0.707 Test Loss: 0.725 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7095937728881836
Epoch: 10, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.469 Vali Acc: 0.517 Test Loss: 1.469 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5501065254211426
Epoch: 11, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.013 Vali Acc: 0.624 Test Loss: 1.013 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1346964836120605
Epoch: 12, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.940 Vali Acc: 0.712 Test Loss: 0.940 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 46665218
model size : 192.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4204022884368896
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.449979543685913
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.555039644241333
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.547 Vali Acc: 0.771 Test Loss: 0.547 Test Acc: 0.771
Validation loss decreased (-0.741458 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 2.394719123840332
Epoch: 4, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.531 Vali Acc: 0.707 Test Loss: 0.531 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5749425888061523
Epoch: 5, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.033 Vali Acc: 0.512 Test Loss: 1.033 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3281421661376953
Epoch: 6, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.638 Vali Acc: 0.751 Test Loss: 0.638 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0401864051818848
Epoch: 7, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.654 Vali Acc: 0.761 Test Loss: 0.654 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4718799591064453
Epoch: 8, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.694 Vali Acc: 0.746 Test Loss: 0.694 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9482331275939941
Epoch: 9, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.777 Vali Acc: 0.698 Test Loss: 0.777 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.14201283454895
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.013 Vali Acc: 0.707 Test Loss: 1.013 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9635753631591797
Epoch: 11, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.825 Vali Acc: 0.702 Test Loss: 0.825 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2472362518310547
Epoch: 12, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.140 Vali Acc: 0.698 Test Loss: 1.140 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4426133632659912
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.203 Vali Acc: 0.727 Test Loss: 1.203 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 46576130
model size : 192.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2789292335510254
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.2392795085906982
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.5496602058410645
Epoch: 3, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 2.0769615173339844
Epoch: 4, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.561 Vali Acc: 0.771 Test Loss: 0.561 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 5 cost time: 2.220323324203491
Epoch: 5, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.541 Vali Acc: 0.707 Test Loss: 0.541 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.194530963897705
Epoch: 6, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.606 Vali Acc: 0.746 Test Loss: 0.606 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.241866111755371
Epoch: 7, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.799 Vali Acc: 0.610 Test Loss: 0.799 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8315575122833252
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.696 Vali Acc: 0.659 Test Loss: 0.696 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1820831298828125
Epoch: 9, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.706 Vali Acc: 0.663 Test Loss: 0.706 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2681984901428223
Epoch: 10, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.688 Vali Acc: 0.707 Test Loss: 0.688 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0767369270324707
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.816 Vali Acc: 0.688 Test Loss: 0.816 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0114455223083496
Epoch: 12, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.841 Vali Acc: 0.712 Test Loss: 0.841 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.217479705810547
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.108 Vali Acc: 0.756 Test Loss: 1.108 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.221252679824829
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.062 Vali Acc: 0.707 Test Loss: 1.062 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 46523906
model size : 192.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7434465885162354
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.574 Vali Acc: 0.712 Test Loss: 0.574 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.5545203685760498
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 3.2171926498413086
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.622 Vali Acc: 0.683 Test Loss: 0.622 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.225243330001831
Epoch: 4, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.690 Vali Acc: 0.649 Test Loss: 0.690 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.491375684738159
Epoch: 5, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.526 Vali Acc: 0.737 Test Loss: 0.526 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0141963958740234
Epoch: 6, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.756 Vali Acc: 0.751 Test Loss: 0.756 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 2.7155215740203857
Epoch: 7, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.116 Vali Acc: 0.746 Test Loss: 1.116 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.209991455078125
Epoch: 8, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.781 Vali Acc: 0.746 Test Loss: 0.781 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0774049758911133
Epoch: 9, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.105 Vali Acc: 0.732 Test Loss: 1.105 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.885096311569214
Epoch: 10, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.231 Vali Acc: 0.688 Test Loss: 1.231 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9227075576782227
Epoch: 11, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.082 Vali Acc: 0.746 Test Loss: 1.082 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0808000564575195
Epoch: 12, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.117 Vali Acc: 0.751 Test Loss: 1.117 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.570230007171631
Epoch: 13, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.196 Vali Acc: 0.761 Test Loss: 1.196 Test Acc: 0.761
Validation loss decreased (-0.751212 --> -0.760964).  Saving model ...
Epoch: 14 cost time: 2.605896472930908
Epoch: 14, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.276 Vali Acc: 0.688 Test Loss: 1.276 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3999526500701904
Epoch: 15, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.176 Vali Acc: 0.702 Test Loss: 1.176 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.586082935333252
Epoch: 16, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.216 Vali Acc: 0.688 Test Loss: 1.216 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3241915702819824
Epoch: 17, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.580 Vali Acc: 0.620 Test Loss: 1.580 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.575986385345459
Epoch: 18, Steps: 13 | Train Loss: 0.061 Vali Loss: 2.934 Vali Acc: 0.537 Test Loss: 2.934 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4296765327453613
Epoch: 19, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.336 Vali Acc: 0.693 Test Loss: 1.336 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7109546661376953
Epoch: 20, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.745 Vali Acc: 0.756 Test Loss: 1.745 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5927176475524902
Epoch: 21, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.623 Vali Acc: 0.678 Test Loss: 1.623 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.372941017150879
Epoch: 22, Steps: 13 | Train Loss: 0.029 Vali Loss: 2.010 Vali Acc: 0.751 Test Loss: 2.010 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0934231281280518
Epoch: 23, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.767 Vali Acc: 0.766 Test Loss: 1.767 Test Acc: 0.766
Validation loss decreased (-0.760964 --> -0.765836).  Saving model ...
Epoch: 24 cost time: 3.318620443344116
Epoch: 24, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.425 Vali Acc: 0.712 Test Loss: 1.425 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.335770845413208
Epoch: 25, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.221 Vali Acc: 0.702 Test Loss: 1.221 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3456838130950928
Epoch: 26, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.439 Vali Acc: 0.727 Test Loss: 1.439 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.8969616889953613
Epoch: 27, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.988 Vali Acc: 0.737 Test Loss: 1.988 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6579959392547607
Epoch: 28, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.901 Vali Acc: 0.585 Test Loss: 2.901 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.068742036819458
Epoch: 29, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.737 Vali Acc: 0.668 Test Loss: 1.737 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.067121744155884
Epoch: 30, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.974 Vali Acc: 0.644 Test Loss: 1.974 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.719721794128418
Epoch: 31, Steps: 13 | Train Loss: 0.082 Vali Loss: 2.297 Vali Acc: 0.688 Test Loss: 2.297 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.481184959411621
Epoch: 32, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.960 Vali Acc: 0.659 Test Loss: 1.960 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.677711248397827
Epoch: 33, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.761 Vali Acc: 0.673 Test Loss: 1.761 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 46805762
model size : 193.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.181057929992676
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7637922763824463
Epoch: 2, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.559 Vali Acc: 0.741 Test Loss: 0.559 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.017958402633667
Epoch: 3, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.150219202041626
Epoch: 4, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.986849069595337
Epoch: 5, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1668572425842285
Epoch: 6, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.649 Vali Acc: 0.722 Test Loss: 0.649 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.354060411453247
Epoch: 7, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.714 Vali Acc: 0.741 Test Loss: 0.714 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.464282274246216
Epoch: 8, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.766 Vali Acc: 0.751 Test Loss: 0.766 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751212).  Saving model ...
Epoch: 9 cost time: 2.3795154094696045
Epoch: 9, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.812 Vali Acc: 0.761 Test Loss: 0.812 Test Acc: 0.761
Validation loss decreased (-0.751212 --> -0.760967).  Saving model ...
Epoch: 10 cost time: 2.3519086837768555
Epoch: 10, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.960 Vali Acc: 0.741 Test Loss: 0.960 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.298356294631958
Epoch: 11, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.849 Vali Acc: 0.751 Test Loss: 0.849 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5390708446502686
Epoch: 12, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.794 Vali Acc: 0.678 Test Loss: 0.794 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7932770252227783
Epoch: 13, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.107 Vali Acc: 0.654 Test Loss: 1.107 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4817006587982178
Epoch: 14, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.266 Vali Acc: 0.727 Test Loss: 1.266 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1262848377227783
Epoch: 15, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.124 Vali Acc: 0.737 Test Loss: 1.124 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0897767543792725
Epoch: 16, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.013 Vali Acc: 0.663 Test Loss: 1.013 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.023580551147461
Epoch: 17, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.244 Vali Acc: 0.649 Test Loss: 1.244 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.604468822479248
Epoch: 18, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.309 Vali Acc: 0.693 Test Loss: 1.309 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8818130493164062
Epoch: 19, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.074 Vali Acc: 0.683 Test Loss: 1.074 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 46707458
model size : 192.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1513993740081787
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6753044128417969
Epoch: 2, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8270671367645264
Epoch: 3, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.574 Vali Acc: 0.766 Test Loss: 0.574 Test Acc: 0.766
Validation loss decreased (-0.721945 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 2.1709656715393066
Epoch: 4, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6906640529632568
Epoch: 5, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.126033306121826
Epoch: 6, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.603 Vali Acc: 0.761 Test Loss: 0.603 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0242197513580322
Epoch: 7, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.681 Vali Acc: 0.702 Test Loss: 0.681 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.122159004211426
Epoch: 8, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.869 Vali Acc: 0.780 Test Loss: 0.869 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780479).  Saving model ...
Epoch: 9 cost time: 1.7022616863250732
Epoch: 9, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.732 Vali Acc: 0.756 Test Loss: 0.732 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.22158145904541
Epoch: 10, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.874 Vali Acc: 0.756 Test Loss: 0.874 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0670530796051025
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.782 Vali Acc: 0.732 Test Loss: 0.782 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8540887832641602
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.927 Vali Acc: 0.707 Test Loss: 0.927 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1599807739257812
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.015 Vali Acc: 0.683 Test Loss: 1.015 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7937259674072266
Epoch: 14, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.820 Vali Acc: 0.712 Test Loss: 0.820 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6123778820037842
Epoch: 15, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.137 Vali Acc: 0.712 Test Loss: 1.137 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5045361518859863
Epoch: 16, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.855 Vali Acc: 0.727 Test Loss: 0.855 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6948187351226807
Epoch: 17, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5802664756774902
Epoch: 18, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.274 Vali Acc: 0.741 Test Loss: 1.274 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 46661378
model size : 192.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.098101377487183
Epoch: 1, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 2.1202051639556885
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.627 Vali Acc: 0.698 Test Loss: 0.627 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.751452684402466
Epoch: 3, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.6729745864868164
Epoch: 4, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.660 Vali Acc: 0.756 Test Loss: 0.660 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756091).  Saving model ...
Epoch: 5 cost time: 2.568366050720215
Epoch: 5, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9301483631134033
Epoch: 6, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.596 Vali Acc: 0.751 Test Loss: 0.596 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.896939992904663
Epoch: 7, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4125404357910156
Epoch: 8, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.762 Vali Acc: 0.668 Test Loss: 0.762 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6119227409362793
Epoch: 9, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.192 Vali Acc: 0.654 Test Loss: 1.192 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3910231590270996
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.974 Vali Acc: 0.727 Test Loss: 0.974 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3668506145477295
Epoch: 11, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.530 Vali Acc: 0.732 Test Loss: 1.530 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2111921310424805
Epoch: 12, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.043 Vali Acc: 0.717 Test Loss: 1.043 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.44926118850708
Epoch: 13, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.262 Vali Acc: 0.702 Test Loss: 1.262 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2411577701568604
Epoch: 14, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.836 Vali Acc: 0.639 Test Loss: 1.836 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 46946306
model size : 193.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8608577251434326
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 1.778676986694336
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8176140785217285
Epoch: 3, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.525 Vali Acc: 0.751 Test Loss: 0.525 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 2.058502674102783
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.623 Vali Acc: 0.732 Test Loss: 0.623 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8235266208648682
Epoch: 5, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.9094891548156738
Epoch: 6, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.701 Vali Acc: 0.678 Test Loss: 0.701 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.452798843383789
Epoch: 7, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.634 Vali Acc: 0.702 Test Loss: 0.634 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9256927967071533
Epoch: 8, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.875 Vali Acc: 0.751 Test Loss: 0.875 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7154326438903809
Epoch: 9, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.785 Vali Acc: 0.683 Test Loss: 0.785 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8058664798736572
Epoch: 10, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.110 Vali Acc: 0.649 Test Loss: 1.110 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8984920978546143
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.913 Vali Acc: 0.654 Test Loss: 0.913 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9018208980560303
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.846 Vali Acc: 0.683 Test Loss: 0.846 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8405301570892334
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.233 Vali Acc: 0.698 Test Loss: 1.233 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6271252632141113
Epoch: 14, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.101 Vali Acc: 0.693 Test Loss: 1.101 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.939544439315796
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.100 Vali Acc: 0.707 Test Loss: 1.100 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 46848002
model size : 193.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.063239336013794
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6550168991088867
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.543 Vali Acc: 0.751 Test Loss: 0.543 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.5336694717407227
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.6897907257080078
Epoch: 4, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.5166707038879395
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.536 Vali Acc: 0.761 Test Loss: 0.536 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.6192302703857422
Epoch: 6, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.571 Vali Acc: 0.702 Test Loss: 0.571 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8454351425170898
Epoch: 7, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.607 Vali Acc: 0.688 Test Loss: 0.607 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7476232051849365
Epoch: 8, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.679 Vali Acc: 0.766 Test Loss: 0.679 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 9 cost time: 1.7586557865142822
Epoch: 9, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6305279731750488
Epoch: 10, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.946 Vali Acc: 0.741 Test Loss: 0.946 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3285133838653564
Epoch: 11, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.845 Vali Acc: 0.741 Test Loss: 0.845 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6675879955291748
Epoch: 12, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.929 Vali Acc: 0.746 Test Loss: 0.929 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.556887149810791
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.767 Vali Acc: 0.702 Test Loss: 0.767 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.193178415298462
Epoch: 14, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.862 Vali Acc: 0.673 Test Loss: 0.862 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6399505138397217
Epoch: 15, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.950 Vali Acc: 0.673 Test Loss: 0.950 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5850272178649902
Epoch: 16, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.976 Vali Acc: 0.673 Test Loss: 0.976 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4914100170135498
Epoch: 17, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.956 Vali Acc: 0.649 Test Loss: 0.956 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.148176670074463
Epoch: 18, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.262 Vali Acc: 0.698 Test Loss: 1.262 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 46798850
model size : 193.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6618728637695312
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.1099400520324707
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1666746139526367
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.530 Vali Acc: 0.737 Test Loss: 0.530 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.229811668395996
Epoch: 4, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.751 Vali Acc: 0.722 Test Loss: 0.751 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1667158603668213
Epoch: 5, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.665 Vali Acc: 0.722 Test Loss: 0.665 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8829057216644287
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.644 Vali Acc: 0.688 Test Loss: 0.644 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9038631916046143
Epoch: 7, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.695 Vali Acc: 0.722 Test Loss: 0.695 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5821175575256348
Epoch: 8, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.918 Vali Acc: 0.688 Test Loss: 0.918 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8196570873260498
Epoch: 9, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.901 Vali Acc: 0.707 Test Loss: 0.901 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1938211917877197
Epoch: 10, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.268 Vali Acc: 0.722 Test Loss: 1.268 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4599955081939697
Epoch: 11, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.012 Vali Acc: 0.707 Test Loss: 1.012 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8456366062164307
Epoch: 12, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.297 Vali Acc: 0.707 Test Loss: 1.297 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.575993537902832
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.194 Vali Acc: 0.712 Test Loss: 1.194 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 47199746
model size : 194.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0265567302703857
Epoch: 1, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.760596513748169
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.543 Vali Acc: 0.751 Test Loss: 0.543 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.5357441902160645
Epoch: 3, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5590131282806396
Epoch: 4, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.607 Vali Acc: 0.751 Test Loss: 0.607 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9157299995422363
Epoch: 5, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.241011142730713
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.729 Vali Acc: 0.746 Test Loss: 0.729 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.012171745300293
Epoch: 7, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.617426872253418
Epoch: 8, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.058 Vali Acc: 0.732 Test Loss: 1.058 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6756258010864258
Epoch: 9, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.200 Vali Acc: 0.722 Test Loss: 1.200 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5081069469451904
Epoch: 10, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.975 Vali Acc: 0.727 Test Loss: 0.975 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9747405052185059
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.822 Vali Acc: 0.688 Test Loss: 0.822 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7910072803497314
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.049 Vali Acc: 0.727 Test Loss: 1.049 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 47122946
model size : 194.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.697537899017334
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0508639812469482
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.3416368961334229
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.512 Vali Acc: 0.766 Test Loss: 0.512 Test Acc: 0.766
Validation loss decreased (-0.736580 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 1.4613778591156006
Epoch: 4, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.525 Vali Acc: 0.761 Test Loss: 0.525 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0601801872253418
Epoch: 5, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.738 Vali Acc: 0.605 Test Loss: 0.738 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.407557487487793
Epoch: 6, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.549 Vali Acc: 0.761 Test Loss: 0.549 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3718280792236328
Epoch: 7, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2416961193084717
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3823671340942383
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8356635570526123
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.776 Vali Acc: 0.688 Test Loss: 0.776 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0895614624023438
Epoch: 11, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.836 Vali Acc: 0.761 Test Loss: 0.836 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.333630084991455
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.903 Vali Acc: 0.727 Test Loss: 0.903 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3810837268829346
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.023 Vali Acc: 0.727 Test Loss: 1.023 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 47076866
model size : 194.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.030184984207153
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.003092050552368
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.541 Vali Acc: 0.746 Test Loss: 0.541 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.9928011894226074
Epoch: 3, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.717 Vali Acc: 0.732 Test Loss: 0.717 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8535501956939697
Epoch: 4, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 2.3183977603912354
Epoch: 5, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.539 Vali Acc: 0.722 Test Loss: 0.539 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.144806385040283
Epoch: 6, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.725 Vali Acc: 0.727 Test Loss: 0.725 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.218940258026123
Epoch: 7, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.716 Vali Acc: 0.732 Test Loss: 0.716 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8679988384246826
Epoch: 8, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.742 Vali Acc: 0.712 Test Loss: 0.742 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.005685567855835
Epoch: 9, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.020 Vali Acc: 0.668 Test Loss: 1.020 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0115604400634766
Epoch: 10, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.298 Vali Acc: 0.727 Test Loss: 1.298 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.196131467819214
Epoch: 11, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.972 Vali Acc: 0.659 Test Loss: 0.972 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3615312576293945
Epoch: 12, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.057 Vali Acc: 0.678 Test Loss: 1.057 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0031774044036865
Epoch: 13, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.178 Vali Acc: 0.688 Test Loss: 1.178 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1335620880126953
Epoch: 14, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.280 Vali Acc: 0.683 Test Loss: 1.280 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 47340290
model size : 195.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.106207847595215
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.4702887535095215
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.9507007598876953
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.512 Vali Acc: 0.780 Test Loss: 0.512 Test Acc: 0.780
Validation loss decreased (-0.721945 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 0.9356293678283691
Epoch: 4, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8940620422363281
Epoch: 5, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0760858058929443
Epoch: 6, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.627 Vali Acc: 0.756 Test Loss: 0.627 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8269491195678711
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7655761241912842
Epoch: 8, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.832 Vali Acc: 0.751 Test Loss: 0.832 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3032608032226562
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.794 Vali Acc: 0.678 Test Loss: 0.794 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9509997367858887
Epoch: 10, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.230 Vali Acc: 0.727 Test Loss: 1.230 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9070889949798584
Epoch: 11, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.988 Vali Acc: 0.688 Test Loss: 0.988 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2128009796142578
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.292 Vali Acc: 0.741 Test Loss: 1.292 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4199259281158447
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.219 Vali Acc: 0.732 Test Loss: 1.219 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 47257346
model size : 194.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.9581141471862793
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0287423133850098
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.543 Vali Acc: 0.746 Test Loss: 0.543 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.4429199695587158
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.519 Vali Acc: 0.732 Test Loss: 0.519 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1324312686920166
Epoch: 4, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.680 Vali Acc: 0.741 Test Loss: 0.680 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.34242582321167
Epoch: 5, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 0.7439858913421631
Epoch: 6, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.914 Vali Acc: 0.605 Test Loss: 0.914 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.120976448059082
Epoch: 7, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.901 Vali Acc: 0.737 Test Loss: 0.901 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3036181926727295
Epoch: 8, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.704 Vali Acc: 0.712 Test Loss: 0.704 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3516902923583984
Epoch: 9, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.752 Vali Acc: 0.712 Test Loss: 0.752 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2228922843933105
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.761 Vali Acc: 0.712 Test Loss: 0.761 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9113357067108154
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.902 Vali Acc: 0.654 Test Loss: 0.902 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1692233085632324
Epoch: 12, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.865 Vali Acc: 0.639 Test Loss: 0.865 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1891024112701416
Epoch: 13, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.814 Vali Acc: 0.737 Test Loss: 0.814 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9498436450958252
Epoch: 14, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.886 Vali Acc: 0.732 Test Loss: 0.886 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1006159782409668
Epoch: 15, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 47217410
model size : 194.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.988806962966919
Epoch: 1, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 1.8196911811828613
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.507 Vali Acc: 0.761 Test Loss: 0.507 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760971).  Saving model ...
Epoch: 3 cost time: 1.6491482257843018
Epoch: 3, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.551 Vali Acc: 0.761 Test Loss: 0.551 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.583641767501831
Epoch: 4, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9942672252655029
Epoch: 5, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.671 Vali Acc: 0.746 Test Loss: 0.671 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.295236349105835
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.768 Vali Acc: 0.727 Test Loss: 0.768 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5267093181610107
Epoch: 7, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.749 Vali Acc: 0.732 Test Loss: 0.749 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6888842582702637
Epoch: 8, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.909 Vali Acc: 0.732 Test Loss: 0.909 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7704124450683594
Epoch: 9, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.964 Vali Acc: 0.639 Test Loss: 0.964 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8987517356872559
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.535778522491455
Epoch: 11, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.223 Vali Acc: 0.605 Test Loss: 1.223 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7541062831878662
Epoch: 12, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.211 Vali Acc: 0.659 Test Loss: 1.211 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 47599874
model size : 196.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9206182956695557
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.578420639038086
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.536 Vali Acc: 0.756 Test Loss: 0.536 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.600022792816162
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.512 Vali Acc: 0.727 Test Loss: 0.512 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4825549125671387
Epoch: 4, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.549 Vali Acc: 0.712 Test Loss: 0.549 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.154165267944336
Epoch: 5, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.604 Vali Acc: 0.727 Test Loss: 0.604 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1334240436553955
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.971513032913208
Epoch: 7, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.687 Vali Acc: 0.727 Test Loss: 0.687 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3585031032562256
Epoch: 8, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.816 Vali Acc: 0.634 Test Loss: 0.816 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4751973152160645
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.884 Vali Acc: 0.683 Test Loss: 0.884 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2245075702667236
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.586 Vali Acc: 0.551 Test Loss: 1.586 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3438279628753662
Epoch: 11, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.851 Vali Acc: 0.688 Test Loss: 0.851 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3078110218048096
Epoch: 12, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.120 Vali Acc: 0.678 Test Loss: 1.120 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 47532290
model size : 196.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.428684949874878
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.000800371170044
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.037743091583252
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 0.8966588973999023
Epoch: 4, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.1705126762390137
Epoch: 5, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1277647018432617
Epoch: 6, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.1261570453643799
Epoch: 7, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.623 Vali Acc: 0.702 Test Loss: 0.623 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.017944574356079
Epoch: 8, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0502798557281494
Epoch: 9, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.706 Vali Acc: 0.751 Test Loss: 0.706 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0705335140228271
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.769 Vali Acc: 0.732 Test Loss: 0.769 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8971319198608398
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.830 Vali Acc: 0.737 Test Loss: 0.830 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.16843581199646
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.859 Vali Acc: 0.741 Test Loss: 0.859 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8020751476287842
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.049 Vali Acc: 0.756 Test Loss: 1.049 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2235052585601807
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.971 Vali Acc: 0.751 Test Loss: 0.971 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9606196880340576
Epoch: 15, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.964 Vali Acc: 0.727 Test Loss: 0.964 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9039506912231445
Epoch: 16, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.141 Vali Acc: 0.649 Test Loss: 1.141 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 47492354
model size : 195.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.714571475982666
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.600 Vali Acc: 0.732 Test Loss: 0.600 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.8199613094329834
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
Validation loss decreased (-0.731701 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 2.041119337081909
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4630637168884277
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9682886600494385
Epoch: 5, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.607 Vali Acc: 0.693 Test Loss: 0.607 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0466015338897705
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.593 Vali Acc: 0.741 Test Loss: 0.593 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6630632877349854
Epoch: 7, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.848 Vali Acc: 0.673 Test Loss: 0.848 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9736230373382568
Epoch: 8, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.843 Vali Acc: 0.712 Test Loss: 0.843 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3299775123596191
Epoch: 9, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.199 Vali Acc: 0.766 Test Loss: 1.199 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765842).  Saving model ...
Epoch: 10 cost time: 1.870678186416626
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.032 Vali Acc: 0.688 Test Loss: 1.032 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6002085208892822
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.309 Vali Acc: 0.707 Test Loss: 1.309 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0210421085357666
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.547 Vali Acc: 0.702 Test Loss: 1.547 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1174850463867188
Epoch: 13, Steps: 13 | Train Loss: 0.100 Vali Loss: 2.242 Vali Acc: 0.746 Test Loss: 2.242 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4153878688812256
Epoch: 14, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.288 Vali Acc: 0.673 Test Loss: 1.288 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.674720048904419
Epoch: 15, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.626 Vali Acc: 0.620 Test Loss: 1.626 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6523823738098145
Epoch: 16, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.474 Vali Acc: 0.693 Test Loss: 1.474 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.861025333404541
Epoch: 17, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.868 Vali Acc: 0.702 Test Loss: 1.868 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9527361392974854
Epoch: 18, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.558 Vali Acc: 0.678 Test Loss: 1.558 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6262168884277344
Epoch: 19, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.494 Vali Acc: 0.649 Test Loss: 1.494 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 48018434
model size : 197.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.902259349822998
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.424565315246582
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.1970112323760986
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.497 Vali Acc: 0.751 Test Loss: 0.497 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751215).  Saving model ...
Epoch: 4 cost time: 1.7130448818206787
Epoch: 4, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.548 Vali Acc: 0.717 Test Loss: 0.548 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5309851169586182
Epoch: 5, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.562 Vali Acc: 0.693 Test Loss: 0.562 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9802629947662354
Epoch: 6, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.716 Vali Acc: 0.654 Test Loss: 0.716 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4592247009277344
Epoch: 7, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.684 Vali Acc: 0.722 Test Loss: 0.684 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.408003568649292
Epoch: 8, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.779 Vali Acc: 0.717 Test Loss: 0.779 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5917389392852783
Epoch: 9, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.774 Vali Acc: 0.732 Test Loss: 0.774 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7045652866363525
Epoch: 10, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.823 Vali Acc: 0.751 Test Loss: 0.823 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6900973320007324
Epoch: 11, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.746 Vali Acc: 0.727 Test Loss: 0.746 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6980092525482178
Epoch: 12, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.810 Vali Acc: 0.771 Test Loss: 0.810 Test Acc: 0.771
Validation loss decreased (-0.751215 --> -0.770724).  Saving model ...
Epoch: 13 cost time: 1.5229806900024414
Epoch: 13, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.999 Vali Acc: 0.707 Test Loss: 0.999 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3063044548034668
Epoch: 14, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2671587467193604
Epoch: 15, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.172 Vali Acc: 0.702 Test Loss: 1.172 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5279104709625244
Epoch: 16, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.046 Vali Acc: 0.673 Test Loss: 1.046 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2396018505096436
Epoch: 17, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.118 Vali Acc: 0.707 Test Loss: 1.118 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.699234962463379
Epoch: 18, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.280 Vali Acc: 0.751 Test Loss: 1.280 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4798574447631836
Epoch: 19, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.385 Vali Acc: 0.737 Test Loss: 1.385 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1636159420013428
Epoch: 20, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.207 Vali Acc: 0.732 Test Loss: 1.207 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2498760223388672
Epoch: 21, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.052 Vali Acc: 0.717 Test Loss: 1.052 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4235544204711914
Epoch: 22, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.803 Vali Acc: 0.712 Test Loss: 1.803 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 47947778
model size : 197.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7012484073638916
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.3311817646026611
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.2829883098602295
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.246474266052246
Epoch: 4, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3615107536315918
Epoch: 5, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3139991760253906
Epoch: 6, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.669 Vali Acc: 0.751 Test Loss: 0.669 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1146526336669922
Epoch: 7, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.119661569595337
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.811 Vali Acc: 0.663 Test Loss: 0.811 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7553954124450684
Epoch: 9, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.879 Vali Acc: 0.737 Test Loss: 0.879 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0552644729614258
Epoch: 10, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.938 Vali Acc: 0.741 Test Loss: 0.938 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0780119895935059
Epoch: 11, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.000 Vali Acc: 0.732 Test Loss: 1.000 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1778080463409424
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.891 Vali Acc: 0.737 Test Loss: 0.891 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1766958236694336
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.951 Vali Acc: 0.737 Test Loss: 0.951 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 47910914
model size : 197.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.586703300476074
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.9833171367645264
Epoch: 2, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5779697895050049
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.823 Vali Acc: 0.737 Test Loss: 0.823 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736577).  Saving model ...
Epoch: 4 cost time: 1.5517442226409912
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5213959217071533
Epoch: 5, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.704 Vali Acc: 0.741 Test Loss: 0.704 Test Acc: 0.741
Validation loss decreased (-0.736577 --> -0.741456).  Saving model ...
Epoch: 6 cost time: 1.979252815246582
Epoch: 6, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.190748929977417
Epoch: 7, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.769 Vali Acc: 0.741 Test Loss: 0.769 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.235525369644165
Epoch: 8, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.977 Vali Acc: 0.751 Test Loss: 0.977 Test Acc: 0.751
Validation loss decreased (-0.741456 --> -0.751210).  Saving model ...
Epoch: 9 cost time: 0.8953053951263428
Epoch: 9, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.019 Vali Acc: 0.746 Test Loss: 1.019 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9376153945922852
Epoch: 10, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.929 Vali Acc: 0.737 Test Loss: 0.929 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8874008655548096
Epoch: 11, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.043 Vali Acc: 0.673 Test Loss: 1.043 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.644608974456787
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.012 Vali Acc: 0.712 Test Loss: 1.012 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3430118560791016
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.335 Vali Acc: 0.698 Test Loss: 1.335 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9330987930297852
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.252 Vali Acc: 0.654 Test Loss: 1.252 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.93471360206604
Epoch: 15, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.569 Vali Acc: 0.600 Test Loss: 1.569 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.985785961151123
Epoch: 16, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.569 Vali Acc: 0.732 Test Loss: 1.569 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8993046283721924
Epoch: 17, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.799 Vali Acc: 0.712 Test Loss: 1.799 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7498767375946045
Epoch: 18, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.829 Vali Acc: 0.590 Test Loss: 1.829 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 48284162
model size : 198.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6371333599090576
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.0947916507720947
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2513985633850098
Epoch: 3, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.542 Vali Acc: 0.766 Test Loss: 0.542 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.3301820755004883
Epoch: 4, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.536 Vali Acc: 0.727 Test Loss: 0.536 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9627790451049805
Epoch: 5, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.663 Vali Acc: 0.746 Test Loss: 0.663 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7189621925354004
Epoch: 6, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.716 Vali Acc: 0.766 Test Loss: 0.716 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4162712097167969
Epoch: 7, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.760 Vali Acc: 0.746 Test Loss: 0.760 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2192039489746094
Epoch: 8, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.735 Vali Acc: 0.629 Test Loss: 0.735 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5600664615631104
Epoch: 9, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.688 Vali Acc: 0.668 Test Loss: 0.688 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4240477085113525
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.067 Vali Acc: 0.732 Test Loss: 1.067 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1663265228271484
Epoch: 11, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.818 Vali Acc: 0.746 Test Loss: 0.818 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0608587265014648
Epoch: 12, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.097 Vali Acc: 0.722 Test Loss: 1.097 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.597870111465454
Epoch: 13, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.829 Vali Acc: 0.683 Test Loss: 0.829 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 48222722
model size : 198.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4769835472106934
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.635 Vali Acc: 0.722 Test Loss: 0.635 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3174309730529785
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.9523499011993408
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.552 Vali Acc: 0.766 Test Loss: 0.552 Test Acc: 0.766
Validation loss decreased (-0.736580 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.0127661228179932
Epoch: 4, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.526 Vali Acc: 0.756 Test Loss: 0.526 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9311587810516357
Epoch: 5, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0784597396850586
Epoch: 6, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.157853603363037
Epoch: 7, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.719 Vali Acc: 0.756 Test Loss: 0.719 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8877427577972412
Epoch: 8, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.688 Vali Acc: 0.712 Test Loss: 0.688 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0007705688476562
Epoch: 9, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.787 Vali Acc: 0.639 Test Loss: 0.787 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1727993488311768
Epoch: 10, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.751 Vali Acc: 0.707 Test Loss: 0.751 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9477601051330566
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.656 Vali Acc: 0.683 Test Loss: 0.656 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.012160301208496
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.770 Vali Acc: 0.678 Test Loss: 0.770 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.112466812133789
Epoch: 13, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.752 Vali Acc: 0.737 Test Loss: 0.752 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 48188930
model size : 198.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5157957077026367
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.7833888530731201
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 1.8488130569458008
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.70711088180542
Epoch: 4, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.799 Vali Acc: 0.551 Test Loss: 0.799 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3966257572174072
Epoch: 5, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.637 Vali Acc: 0.688 Test Loss: 0.637 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7651066780090332
Epoch: 6, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 7 cost time: 1.6853229999542236
Epoch: 7, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.747 Vali Acc: 0.693 Test Loss: 0.747 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0281410217285156
Epoch: 8, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.931 Vali Acc: 0.488 Test Loss: 1.931 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6390020847320557
Epoch: 9, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.710 Vali Acc: 0.698 Test Loss: 0.710 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3868603706359863
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.124 Vali Acc: 0.737 Test Loss: 1.124 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3012092113494873
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.268 Vali Acc: 0.741 Test Loss: 1.268 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0300064086914062
Epoch: 12, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.941 Vali Acc: 0.546 Test Loss: 1.941 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3609235286712646
Epoch: 13, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.515 Vali Acc: 0.576 Test Loss: 1.515 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2817044258117676
Epoch: 14, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.364 Vali Acc: 0.732 Test Loss: 1.364 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.369771957397461
Epoch: 15, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.171 Vali Acc: 0.712 Test Loss: 1.171 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0164496898651123
Epoch: 16, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.357 Vali Acc: 0.756 Test Loss: 1.357 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756084).  Saving model ...
Epoch: 17 cost time: 1.8040986061096191
Epoch: 17, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.193 Vali Acc: 0.756 Test Loss: 1.193 Test Acc: 0.756
Validation loss decreased (-0.756084 --> -0.756086).  Saving model ...
Epoch: 18 cost time: 1.8254523277282715
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.346 Vali Acc: 0.659 Test Loss: 1.346 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.148319959640503
Epoch: 19, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.195 Vali Acc: 0.722 Test Loss: 1.195 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7656152248382568
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.194 Vali Acc: 0.722 Test Loss: 1.194 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.240103244781494
Epoch: 21, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.150 Vali Acc: 0.683 Test Loss: 1.150 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.813586711883545
Epoch: 22, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.131 Vali Acc: 0.702 Test Loss: 1.131 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.736579179763794
Epoch: 23, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.746 Test Loss: 1.291 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7486541271209717
Epoch: 24, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.210 Vali Acc: 0.678 Test Loss: 1.210 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7059040069580078
Epoch: 25, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.491 Vali Acc: 0.727 Test Loss: 1.491 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8465995788574219
Epoch: 26, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.737 Test Loss: 1.642 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.723038673400879
Epoch: 27, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.337 Vali Acc: 0.712 Test Loss: 1.337 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 48690434
model size : 200.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0540859699249268
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.3086302280426025
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.553 Vali Acc: 0.761 Test Loss: 0.553 Test Acc: 0.761
Validation loss decreased (-0.721946 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.6027488708496094
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.574 Vali Acc: 0.771 Test Loss: 0.574 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 1.0170140266418457
Epoch: 4, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8634169101715088
Epoch: 5, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2416136264801025
Epoch: 6, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7217450141906738
Epoch: 7, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.740 Vali Acc: 0.702 Test Loss: 0.740 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9092342853546143
Epoch: 8, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.746 Vali Acc: 0.702 Test Loss: 0.746 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3310370445251465
Epoch: 9, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.930 Vali Acc: 0.756 Test Loss: 0.930 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8335318565368652
Epoch: 10, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.913 Vali Acc: 0.746 Test Loss: 0.913 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9616098403930664
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.885 Vali Acc: 0.668 Test Loss: 0.885 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6973083019256592
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.889 Vali Acc: 0.751 Test Loss: 0.889 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6594667434692383
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.762 Vali Acc: 0.727 Test Loss: 0.762 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 48638210
model size : 200.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.105924129486084
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.371854543685913
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.0098791122436523
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1495342254638672
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.619 Vali Acc: 0.766 Test Loss: 0.619 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 5 cost time: 1.352980136871338
Epoch: 5, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2915074825286865
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.608 Vali Acc: 0.707 Test Loss: 0.608 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2661373615264893
Epoch: 7, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.786 Vali Acc: 0.639 Test Loss: 0.786 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.438171625137329
Epoch: 8, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.664 Vali Acc: 0.746 Test Loss: 0.664 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5898008346557617
Epoch: 9, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.791 Vali Acc: 0.722 Test Loss: 0.791 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.235996961593628
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.737 Vali Acc: 0.698 Test Loss: 0.737 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0923891067504883
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.010 Vali Acc: 0.585 Test Loss: 1.010 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4922592639923096
Epoch: 12, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.715 Vali Acc: 0.659 Test Loss: 0.715 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2989866733551025
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.855 Vali Acc: 0.727 Test Loss: 0.855 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.538947582244873
Epoch: 14, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.857 Vali Acc: 0.698 Test Loss: 0.857 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 48607490
model size : 200.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.272263526916504
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.4044408798217773
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.537 Vali Acc: 0.717 Test Loss: 0.537 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 1.828092336654663
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.607 Vali Acc: 0.741 Test Loss: 0.607 Test Acc: 0.741
Validation loss decreased (-0.717068 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 0.933696985244751
Epoch: 4, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5444128513336182
Epoch: 5, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 1.4586684703826904
Epoch: 6, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.810128927230835
Epoch: 7, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.928 Vali Acc: 0.746 Test Loss: 0.928 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5950603485107422
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.815 Vali Acc: 0.639 Test Loss: 0.815 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5538194179534912
Epoch: 9, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.890 Vali Acc: 0.698 Test Loss: 0.890 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4054033756256104
Epoch: 10, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.031 Vali Acc: 0.717 Test Loss: 1.031 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6941466331481934
Epoch: 11, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.973 Vali Acc: 0.707 Test Loss: 0.973 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.708785057067871
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.162 Vali Acc: 0.659 Test Loss: 1.162 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4762217998504639
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.022 Vali Acc: 0.668 Test Loss: 1.022 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.943131923675537
Epoch: 14, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.197 Vali Acc: 0.639 Test Loss: 1.197 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0509605407714844
Epoch: 15, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.384 Vali Acc: 0.727 Test Loss: 1.384 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 49243394
model size : 202.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7645747661590576
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3373901844024658
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.547 Vali Acc: 0.746 Test Loss: 0.547 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.5153136253356934
Epoch: 3, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.4449677467346191
Epoch: 4, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.553 Vali Acc: 0.707 Test Loss: 0.553 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3496432304382324
Epoch: 5, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.574 Vali Acc: 0.741 Test Loss: 0.574 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.905656099319458
Epoch: 6, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.628 Vali Acc: 0.766 Test Loss: 0.628 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 7 cost time: 1.34232759475708
Epoch: 7, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.876 Vali Acc: 0.741 Test Loss: 0.876 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5628690719604492
Epoch: 8, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.611 Vali Acc: 0.498 Test Loss: 1.611 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7403156757354736
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8182201385498047
Epoch: 10, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.740 Vali Acc: 0.732 Test Loss: 0.740 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6427030563354492
Epoch: 11, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.134 Vali Acc: 0.624 Test Loss: 1.134 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5476560592651367
Epoch: 12, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.839 Vali Acc: 0.644 Test Loss: 0.839 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5219485759735107
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.987 Vali Acc: 0.649 Test Loss: 0.987 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.445317029953003
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.129 Vali Acc: 0.693 Test Loss: 1.129 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2512080669403076
Epoch: 15, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.806 Vali Acc: 0.712 Test Loss: 0.806 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.424607276916504
Epoch: 16, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.086 Vali Acc: 0.756 Test Loss: 1.086 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 49194242
model size : 202.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.708702325820923
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1048810482025146
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.101696252822876
Epoch: 3, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.553 Vali Acc: 0.756 Test Loss: 0.553 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.1288669109344482
Epoch: 4, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.657 Vali Acc: 0.624 Test Loss: 0.657 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0617599487304688
Epoch: 5, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.541 Vali Acc: 0.707 Test Loss: 0.541 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.000657320022583
Epoch: 6, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0850298404693604
Epoch: 7, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.614 Vali Acc: 0.722 Test Loss: 0.614 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1802892684936523
Epoch: 8, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.722 Vali Acc: 0.732 Test Loss: 0.722 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0083720684051514
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.762 Vali Acc: 0.741 Test Loss: 0.762 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4541075229644775
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.033 Vali Acc: 0.766 Test Loss: 1.033 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765843).  Saving model ...
Epoch: 11 cost time: 1.2567870616912842
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.972 Vali Acc: 0.756 Test Loss: 0.972 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8085241317749023
Epoch: 12, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.828 Vali Acc: 0.712 Test Loss: 0.828 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7916383743286133
Epoch: 13, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.915 Vali Acc: 0.707 Test Loss: 0.915 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7774865627288818
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.926 Vali Acc: 0.707 Test Loss: 0.926 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8662760257720947
Epoch: 15, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.950 Vali Acc: 0.698 Test Loss: 0.950 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1921238899230957
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.220 Vali Acc: 0.722 Test Loss: 1.220 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3067264556884766
Epoch: 17, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.042 Vali Acc: 0.659 Test Loss: 1.042 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0193703174591064
Epoch: 18, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.058 Vali Acc: 0.678 Test Loss: 1.058 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9236810207366943
Epoch: 19, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.022 Vali Acc: 0.722 Test Loss: 1.022 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3341419696807861
Epoch: 20, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.009 Vali Acc: 0.683 Test Loss: 1.009 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 49166594
model size : 202.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5280601978302
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.185767650604248
Epoch: 2, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.529 Vali Acc: 0.756 Test Loss: 0.529 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.884918451309204
Epoch: 3, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.515 Vali Acc: 0.751 Test Loss: 0.515 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9255897998809814
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9642348289489746
Epoch: 5, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9340343475341797
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.080 Vali Acc: 0.580 Test Loss: 1.080 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7337357997894287
Epoch: 7, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.862 Vali Acc: 0.663 Test Loss: 0.862 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.023503065109253
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.817 Vali Acc: 0.732 Test Loss: 0.817 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0461435317993164
Epoch: 9, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.796 Vali Acc: 0.707 Test Loss: 0.796 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6083018779754639
Epoch: 10, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.947 Vali Acc: 0.751 Test Loss: 0.947 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0261716842651367
Epoch: 11, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.049 Vali Acc: 0.678 Test Loss: 1.049 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8516154289245605
Epoch: 12, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.096 Vali Acc: 0.707 Test Loss: 1.096 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 49796354
model size : 204.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6230955123901367
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.067734479904175
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.523 Vali Acc: 0.741 Test Loss: 0.523 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.42118239402771
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.520 Vali Acc: 0.727 Test Loss: 0.520 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6588788032531738
Epoch: 4, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.574 Vali Acc: 0.766 Test Loss: 0.574 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 1.7928156852722168
Epoch: 5, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.621 Vali Acc: 0.678 Test Loss: 0.621 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6403930187225342
Epoch: 6, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.775 Vali Acc: 0.649 Test Loss: 0.775 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7202043533325195
Epoch: 7, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5491745471954346
Epoch: 8, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.690 Vali Acc: 0.683 Test Loss: 0.690 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3660709857940674
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.829 Vali Acc: 0.761 Test Loss: 0.829 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5026664733886719
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.900 Vali Acc: 0.751 Test Loss: 0.900 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2773840427398682
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5661909580230713
Epoch: 12, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.040 Vali Acc: 0.756 Test Loss: 1.040 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7385647296905518
Epoch: 13, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.887 Vali Acc: 0.698 Test Loss: 0.887 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8909738063812256
Epoch: 14, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.060 Vali Acc: 0.707 Test Loss: 1.060 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 49750274
model size : 204.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2957587242126465
Epoch: 1, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2670609951019287
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.8970401287078857
Epoch: 3, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.615 Vali Acc: 0.663 Test Loss: 0.615 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9717767238616943
Epoch: 4, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.2255728244781494
Epoch: 5, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.674 Vali Acc: 0.683 Test Loss: 0.674 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4371790885925293
Epoch: 6, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.590 Vali Acc: 0.698 Test Loss: 0.590 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.195357322692871
Epoch: 7, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.723 Vali Acc: 0.678 Test Loss: 0.723 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2646749019622803
Epoch: 8, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.735 Vali Acc: 0.722 Test Loss: 0.735 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.084265947341919
Epoch: 9, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.887 Vali Acc: 0.649 Test Loss: 0.887 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2294213771820068
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.851 Vali Acc: 0.668 Test Loss: 0.851 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2876451015472412
Epoch: 11, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.866 Vali Acc: 0.678 Test Loss: 0.866 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3145756721496582
Epoch: 12, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.951 Vali Acc: 0.624 Test Loss: 0.951 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1120409965515137
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.148 Vali Acc: 0.717 Test Loss: 1.148 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.26090669631958
Epoch: 14, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.069 Vali Acc: 0.712 Test Loss: 1.069 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 49728770
model size : 204.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.323560953140259
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.1635615825653076
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.9398422241210938
Epoch: 3, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.987525224685669
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.536 Vali Acc: 0.707 Test Loss: 0.536 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7399423122406006
Epoch: 5, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4980309009552002
Epoch: 6, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5013267993927002
Epoch: 7, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.740 Vali Acc: 0.737 Test Loss: 0.740 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.146103620529175
Epoch: 8, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.809 Vali Acc: 0.727 Test Loss: 0.809 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0573172569274902
Epoch: 9, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.859 Vali Acc: 0.737 Test Loss: 0.859 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1693432331085205
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.861 Vali Acc: 0.663 Test Loss: 0.861 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3156769275665283
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.982 Vali Acc: 0.634 Test Loss: 0.982 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2551093101501465
Epoch: 12, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.163 Vali Acc: 0.727 Test Loss: 1.163 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.419215440750122
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.999 Vali Acc: 0.702 Test Loss: 0.999 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 50630402
model size : 207.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.959723949432373
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.818436622619629
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.6415870189666748
Epoch: 3, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.604130506515503
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.6949329376220703
Epoch: 5, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.623 Vali Acc: 0.722 Test Loss: 0.623 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8046367168426514
Epoch: 6, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.675 Vali Acc: 0.707 Test Loss: 0.675 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6387414932250977
Epoch: 7, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.861 Vali Acc: 0.717 Test Loss: 0.861 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6705963611602783
Epoch: 8, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.818 Vali Acc: 0.741 Test Loss: 0.818 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.734797477722168
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.786 Vali Acc: 0.702 Test Loss: 0.786 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7943143844604492
Epoch: 10, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.927 Vali Acc: 0.737 Test Loss: 0.927 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7975473403930664
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.980 Vali Acc: 0.678 Test Loss: 0.980 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8777410984039307
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.851 Vali Acc: 0.688 Test Loss: 0.851 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8108775615692139
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.037 Vali Acc: 0.717 Test Loss: 1.037 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5677464008331299
Epoch: 14, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.181 Vali Acc: 0.712 Test Loss: 1.181 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 50587394
model size : 207.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3927886486053467
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0835850238800049
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.2616877555847168
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.077214241027832
Epoch: 4, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.4019012451171875
Epoch: 5, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.209846019744873
Epoch: 6, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.309382438659668
Epoch: 7, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.138984203338623
Epoch: 8, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.666 Vali Acc: 0.741 Test Loss: 0.666 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1832916736602783
Epoch: 9, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.737 Vali Acc: 0.727 Test Loss: 0.737 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.397228479385376
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.750 Vali Acc: 0.693 Test Loss: 0.750 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4051532745361328
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.732 Vali Acc: 0.732 Test Loss: 0.732 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1785099506378174
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.758 Vali Acc: 0.663 Test Loss: 0.758 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4304580688476562
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.819 Vali Acc: 0.717 Test Loss: 0.819 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5062124729156494
Epoch: 14, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.828 Vali Acc: 0.693 Test Loss: 0.828 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 50565890
model size : 207.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.285818576812744
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.5239133834838867
Epoch: 2, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.533 Vali Acc: 0.785 Test Loss: 0.533 Test Acc: 0.785
Validation loss decreased (-0.717068 --> -0.785361).  Saving model ...
Epoch: 3 cost time: 2.2220101356506348
Epoch: 3, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8012309074401855
Epoch: 4, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.656 Vali Acc: 0.756 Test Loss: 0.656 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.231436014175415
Epoch: 5, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9219322204589844
Epoch: 6, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.861 Vali Acc: 0.741 Test Loss: 0.861 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7019658088684082
Epoch: 7, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.025 Vali Acc: 0.766 Test Loss: 1.025 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.054701805114746
Epoch: 8, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.877 Vali Acc: 0.702 Test Loss: 0.877 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0854671001434326
Epoch: 9, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.933 Vali Acc: 0.698 Test Loss: 0.933 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9215011596679688
Epoch: 10, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.973 Vali Acc: 0.732 Test Loss: 0.973 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7261016368865967
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.727 Vali Acc: 0.707 Test Loss: 0.727 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8162798881530762
Epoch: 12, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.837 Vali Acc: 0.678 Test Loss: 0.837 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 51601922
model size : 211.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.540229320526123
Epoch: 1, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.5952682495117188
Epoch: 2, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
Validation loss decreased (-0.717068 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.4977138042449951
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5240628719329834
Epoch: 4, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.508 Vali Acc: 0.702 Test Loss: 0.508 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.499523639678955
Epoch: 5, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.555 Vali Acc: 0.746 Test Loss: 0.555 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5156078338623047
Epoch: 6, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.610 Vali Acc: 0.707 Test Loss: 0.610 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6597635746002197
Epoch: 7, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.905 Vali Acc: 0.746 Test Loss: 0.905 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3367626667022705
Epoch: 8, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.831 Vali Acc: 0.751 Test Loss: 0.831 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5787854194641113
Epoch: 9, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6011207103729248
Epoch: 10, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.132 Vali Acc: 0.751 Test Loss: 1.132 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2242965698242188
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3242955207824707
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.078 Vali Acc: 0.717 Test Loss: 1.078 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 51565058
model size : 211.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4224703311920166
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.4567396640777588
Epoch: 2, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.8894937038421631
Epoch: 3, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9228787422180176
Epoch: 4, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.625 Vali Acc: 0.654 Test Loss: 0.625 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1626102924346924
Epoch: 5, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.088935136795044
Epoch: 6, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.682 Vali Acc: 0.741 Test Loss: 0.682 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9300820827484131
Epoch: 7, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.871 Vali Acc: 0.756 Test Loss: 0.871 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756089).  Saving model ...
Epoch: 8 cost time: 1.0559720993041992
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.978 Vali Acc: 0.751 Test Loss: 0.978 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1327643394470215
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.756 Vali Acc: 0.712 Test Loss: 0.756 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2034249305725098
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.841 Vali Acc: 0.698 Test Loss: 0.841 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2323358058929443
Epoch: 11, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.897 Vali Acc: 0.737 Test Loss: 0.897 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2270820140838623
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.919 Vali Acc: 0.727 Test Loss: 0.919 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2084720134735107
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2330975532531738
Epoch: 14, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.917 Vali Acc: 0.707 Test Loss: 0.917 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2099246978759766
Epoch: 15, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.125 Vali Acc: 0.727 Test Loss: 1.125 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2362926006317139
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.994 Vali Acc: 0.712 Test Loss: 0.994 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.259714126586914
Epoch: 17, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.915 Vali Acc: 0.737 Test Loss: 0.915 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 51546626
model size : 211.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.609008312225342
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.9800817966461182
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.8097805976867676
Epoch: 3, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.507 Vali Acc: 0.732 Test Loss: 0.507 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7419557571411133
Epoch: 4, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.564 Vali Acc: 0.766 Test Loss: 0.564 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 2.1653356552124023
Epoch: 5, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.722 Vali Acc: 0.771 Test Loss: 0.722 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770724).  Saving model ...
Epoch: 6 cost time: 2.0653584003448486
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.855 Vali Acc: 0.761 Test Loss: 0.855 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9775853157043457
Epoch: 7, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.644 Vali Acc: 0.693 Test Loss: 0.644 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7100143432617188
Epoch: 8, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.766 Vali Acc: 0.766 Test Loss: 0.766 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9371705055236816
Epoch: 9, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.843 Vali Acc: 0.771 Test Loss: 0.843 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2539913654327393
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.770 Vali Acc: 0.698 Test Loss: 0.770 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8265109062194824
Epoch: 11, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.822 Vali Acc: 0.698 Test Loss: 0.822 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2269809246063232
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.803 Vali Acc: 0.741 Test Loss: 0.803 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2457318305969238
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.804 Vali Acc: 0.751 Test Loss: 0.804 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1176245212554932
Epoch: 14, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.181 Vali Acc: 0.776 Test Loss: 1.181 Test Acc: 0.776
Validation loss decreased (-0.770724 --> -0.775598).  Saving model ...
Epoch: 15 cost time: 1.844491720199585
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.033 Vali Acc: 0.717 Test Loss: 1.033 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.970501184463501
Epoch: 16, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.955 Vali Acc: 0.756 Test Loss: 0.955 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8787431716918945
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.038 Vali Acc: 0.766 Test Loss: 1.038 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.790050745010376
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.045 Vali Acc: 0.761 Test Loss: 1.045 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7459843158721924
Epoch: 19, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.032 Vali Acc: 0.698 Test Loss: 1.032 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8558282852172852
Epoch: 20, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.185 Vali Acc: 0.771 Test Loss: 1.185 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.50746488571167
Epoch: 21, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.195 Vali Acc: 0.654 Test Loss: 1.195 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5988366603851318
Epoch: 22, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.026 Vali Acc: 0.751 Test Loss: 1.026 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6863198280334473
Epoch: 23, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.008 Vali Acc: 0.693 Test Loss: 1.008 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.773439884185791
Epoch: 24, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.185 Vali Acc: 0.678 Test Loss: 1.185 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 52995074
model size : 216.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.117419719696045
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9155404567718506
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.0761387348175049
Epoch: 3, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.309122085571289
Epoch: 4, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.560 Vali Acc: 0.761 Test Loss: 0.560 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1677827835083008
Epoch: 5, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.706 Vali Acc: 0.751 Test Loss: 0.706 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.394378662109375
Epoch: 6, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.830 Vali Acc: 0.751 Test Loss: 0.830 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3515794277191162
Epoch: 7, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.708 Vali Acc: 0.737 Test Loss: 0.708 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2197601795196533
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.785 Vali Acc: 0.732 Test Loss: 0.785 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3035624027252197
Epoch: 9, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.738 Vali Acc: 0.639 Test Loss: 0.738 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2260792255401611
Epoch: 10, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.728 Vali Acc: 0.698 Test Loss: 0.728 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.094423532485962
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.903 Vali Acc: 0.727 Test Loss: 0.903 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9029088020324707
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.909 Vali Acc: 0.688 Test Loss: 0.909 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.332885503768921
Epoch: 13, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.866 Vali Acc: 0.688 Test Loss: 0.866 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 52964354
model size : 216.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.839153528213501
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 1.1462061405181885
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.712190 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.2572176456451416
Epoch: 3, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.9532365798950195
Epoch: 4, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.086237907409668
Epoch: 5, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2536749839782715
Epoch: 6, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.664 Vali Acc: 0.737 Test Loss: 0.664 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2147984504699707
Epoch: 7, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.674 Vali Acc: 0.707 Test Loss: 0.674 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.273411750793457
Epoch: 8, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.756 Vali Acc: 0.712 Test Loss: 0.756 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.209151268005371
Epoch: 9, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.810 Vali Acc: 0.737 Test Loss: 0.810 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9744062423706055
Epoch: 10, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.867 Vali Acc: 0.761 Test Loss: 0.867 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.052757740020752
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2847769260406494
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3247995376586914
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.950 Vali Acc: 0.717 Test Loss: 0.950 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 52948994
model size : 216.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps81_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.677640914916992
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.622373342514038
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.4064126014709473
Epoch: 3, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1152403354644775
Epoch: 4, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4134092330932617
Epoch: 5, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.663 Vali Acc: 0.766 Test Loss: 0.663 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 6 cost time: 1.7115778923034668
Epoch: 6, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.830 Vali Acc: 0.722 Test Loss: 0.830 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7115662097930908
Epoch: 7, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.957 Vali Acc: 0.624 Test Loss: 0.957 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3919124603271484
Epoch: 8, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.886892318725586
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.976 Vali Acc: 0.761 Test Loss: 0.976 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0296216011047363
Epoch: 10, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.086 Vali Acc: 0.737 Test Loss: 1.086 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5719666481018066
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.330 Vali Acc: 0.751 Test Loss: 1.330 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.240041732788086
Epoch: 12, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.163 Vali Acc: 0.741 Test Loss: 1.163 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.141042709350586
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.058 Vali Acc: 0.727 Test Loss: 1.058 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.229440689086914
Epoch: 14, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.541 Vali Acc: 0.746 Test Loss: 1.541 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1200196743011475
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.942 Vali Acc: 0.751 Test Loss: 0.942 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps81_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 54809858
model size : 223.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1060311794281006
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.502601146697998
Epoch: 2, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.457737922668457
Epoch: 3, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.847 Vali Acc: 0.741 Test Loss: 0.847 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741455).  Saving model ...
Epoch: 4 cost time: 1.6251707077026367
Epoch: 4, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
Validation loss decreased (-0.741455 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.1939728260040283
Epoch: 5, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.657 Vali Acc: 0.668 Test Loss: 0.657 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.343768835067749
Epoch: 6, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.984 Vali Acc: 0.761 Test Loss: 0.984 Test Acc: 0.761
Validation loss decreased (-0.741457 --> -0.760966).  Saving model ...
Epoch: 7 cost time: 0.9360785484313965
Epoch: 7, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.746 Vali Acc: 0.746 Test Loss: 0.746 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9319453239440918
Epoch: 8, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.756 Vali Acc: 0.707 Test Loss: 0.756 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4929490089416504
Epoch: 9, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.814 Vali Acc: 0.698 Test Loss: 0.814 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6506342887878418
Epoch: 10, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.002 Vali Acc: 0.722 Test Loss: 1.002 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6800436973571777
Epoch: 11, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.043 Vali Acc: 0.732 Test Loss: 1.043 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.358304738998413
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.898 Vali Acc: 0.693 Test Loss: 0.898 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6235909461975098
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.903 Vali Acc: 0.707 Test Loss: 0.903 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.492846965789795
Epoch: 14, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.888 Vali Acc: 0.702 Test Loss: 0.888 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2984769344329834
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.997 Vali Acc: 0.693 Test Loss: 0.997 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6319093704223633
Epoch: 16, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.997 Vali Acc: 0.717 Test Loss: 0.997 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 54785282
model size : 223.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps81_str81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.125821590423584
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.5050134658813477
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.4932267665863037
Epoch: 3, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6262660026550293
Epoch: 4, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.697 Vali Acc: 0.756 Test Loss: 0.697 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 5 cost time: 1.6738910675048828
Epoch: 5, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.593 Vali Acc: 0.693 Test Loss: 0.593 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2734291553497314
Epoch: 6, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.694 Vali Acc: 0.698 Test Loss: 0.694 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2999401092529297
Epoch: 7, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.866 Vali Acc: 0.776 Test Loss: 0.866 Test Acc: 0.776
Validation loss decreased (-0.756091 --> -0.775601).  Saving model ...
Epoch: 8 cost time: 1.657923698425293
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.816 Vali Acc: 0.737 Test Loss: 0.816 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5203347206115723
Epoch: 9, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.878 Vali Acc: 0.678 Test Loss: 0.878 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5112090110778809
Epoch: 10, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.982 Vali Acc: 0.693 Test Loss: 0.982 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5778942108154297
Epoch: 11, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.962 Vali Acc: 0.688 Test Loss: 0.962 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.341101884841919
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.988 Vali Acc: 0.741 Test Loss: 0.988 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6263530254364014
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.236 Vali Acc: 0.732 Test Loss: 1.236 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.671172857284546
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.281 Vali Acc: 0.741 Test Loss: 1.281 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3059346675872803
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.901 Vali Acc: 0.668 Test Loss: 0.901 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5465319156646729
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.027 Vali Acc: 0.702 Test Loss: 1.027 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5644960403442383
Epoch: 17, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.286 Vali Acc: 0.732 Test Loss: 1.286 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el6_dm768_df768_ps81_str81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 54776066
model size : 223.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.473005533218384
Epoch: 1, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.570 Vali Acc: 0.712 Test Loss: 0.570 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.0927789211273193
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.721 Vali Acc: 0.546 Test Loss: 0.721 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.012845754623413
Epoch: 3, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
Validation loss decreased (-0.712189 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.1545512676239014
Epoch: 4, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.575 Vali Acc: 0.702 Test Loss: 0.575 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1036696434020996
Epoch: 5, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.633 Vali Acc: 0.698 Test Loss: 0.633 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1453261375427246
Epoch: 6, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.829 Vali Acc: 0.712 Test Loss: 0.829 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.055295705795288
Epoch: 7, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.908 Vali Acc: 0.717 Test Loss: 0.908 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7633240222930908
Epoch: 8, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.961 Vali Acc: 0.678 Test Loss: 0.961 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.782090425491333
Epoch: 9, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.147 Vali Acc: 0.698 Test Loss: 1.147 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7142667770385742
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.331 Vali Acc: 0.678 Test Loss: 1.331 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8601932525634766
Epoch: 11, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.444 Vali Acc: 0.693 Test Loss: 1.444 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.999819040298462
Epoch: 12, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.559 Vali Acc: 0.673 Test Loss: 1.559 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.13069486618042
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.975 Vali Acc: 0.678 Test Loss: 1.975 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 38917634
model size : 163.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5547914505004883
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.5623397827148438
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0762276649475098
Epoch: 3, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.2896387577056885
Epoch: 4, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5118932723999023
Epoch: 5, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3107109069824219
Epoch: 6, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.569 Vali Acc: 0.751 Test Loss: 0.569 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6096911430358887
Epoch: 7, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.800 Vali Acc: 0.756 Test Loss: 0.800 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.537121295928955
Epoch: 8, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4273135662078857
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.938 Vali Acc: 0.732 Test Loss: 0.938 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7847447395324707
Epoch: 10, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.014 Vali Acc: 0.727 Test Loss: 1.014 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5197691917419434
Epoch: 11, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.037 Vali Acc: 0.727 Test Loss: 1.037 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.570688009262085
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.068 Vali Acc: 0.707 Test Loss: 1.068 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0112195014953613
Epoch: 13, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.402 Vali Acc: 0.615 Test Loss: 1.402 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 38813186
model size : 162.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7484195232391357
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.3828003406524658
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.553 Vali Acc: 0.717 Test Loss: 0.553 Test Acc: 0.717
Validation loss decreased (-0.717068 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 1.3169500827789307
Epoch: 3, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.1332368850708008
Epoch: 4, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760971).  Saving model ...
Epoch: 5 cost time: 1.111008644104004
Epoch: 5, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.537 Vali Acc: 0.693 Test Loss: 0.537 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3517794609069824
Epoch: 6, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0962634086608887
Epoch: 7, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.683 Vali Acc: 0.683 Test Loss: 0.683 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.291050672531128
Epoch: 8, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.697 Vali Acc: 0.727 Test Loss: 0.697 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4686932563781738
Epoch: 9, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.743 Vali Acc: 0.712 Test Loss: 0.743 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4669663906097412
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9505491256713867
Epoch: 11, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.962 Vali Acc: 0.698 Test Loss: 0.962 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5065929889678955
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.802 Vali Acc: 0.712 Test Loss: 0.802 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.337432622909546
Epoch: 13, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.265 Vali Acc: 0.746 Test Loss: 1.265 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1994376182556152
Epoch: 14, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.235 Vali Acc: 0.751 Test Loss: 1.235 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 38748674
model size : 162.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.079380512237549
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5859146118164062
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.68160080909729
Epoch: 3, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.796494960784912
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.585 Vali Acc: 0.668 Test Loss: 0.585 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9702274799346924
Epoch: 5, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.688 Vali Acc: 0.659 Test Loss: 0.688 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0130906105041504
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.008 Vali Acc: 0.761 Test Loss: 1.008 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760966).  Saving model ...
Epoch: 7 cost time: 1.7560698986053467
Epoch: 7, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.763 Vali Acc: 0.737 Test Loss: 0.763 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6277756690979004
Epoch: 8, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.978 Vali Acc: 0.634 Test Loss: 0.978 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5171418190002441
Epoch: 9, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.312 Vali Acc: 0.639 Test Loss: 1.312 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5977892875671387
Epoch: 10, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.034 Vali Acc: 0.702 Test Loss: 1.034 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8743665218353271
Epoch: 11, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.970 Vali Acc: 0.722 Test Loss: 0.970 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6565978527069092
Epoch: 12, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.171 Vali Acc: 0.737 Test Loss: 1.171 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.807814359664917
Epoch: 13, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.196 Vali Acc: 0.712 Test Loss: 1.196 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5803678035736084
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.620 Vali Acc: 0.717 Test Loss: 1.620 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.986466884613037
Epoch: 15, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.782 Vali Acc: 0.761 Test Loss: 1.782 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5074291229248047
Epoch: 16, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.373 Vali Acc: 0.707 Test Loss: 1.373 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 39058178
model size : 163.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.893620491027832
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.3938939571380615
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.3661813735961914
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.517 Vali Acc: 0.741 Test Loss: 0.517 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 0.9901816844940186
Epoch: 4, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0903384685516357
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 0.979719877243042
Epoch: 6, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.761 Vali Acc: 0.751 Test Loss: 0.761 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 0.9595355987548828
Epoch: 7, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9760441780090332
Epoch: 8, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.866 Vali Acc: 0.707 Test Loss: 0.866 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0519092082977295
Epoch: 9, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0837976932525635
Epoch: 10, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.980 Vali Acc: 0.693 Test Loss: 0.980 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.257028579711914
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.094 Vali Acc: 0.693 Test Loss: 1.094 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.039973497390747
Epoch: 12, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.189 Vali Acc: 0.644 Test Loss: 1.189 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3539819717407227
Epoch: 13, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.432 Vali Acc: 0.722 Test Loss: 1.432 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3110079765319824
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.266 Vali Acc: 0.702 Test Loss: 1.266 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8738489151000977
Epoch: 15, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.477 Vali Acc: 0.688 Test Loss: 1.477 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8619992733001709
Epoch: 16, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.519 Vali Acc: 0.712 Test Loss: 1.519 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 38953730
model size : 163.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5531857013702393
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.7533035278320312
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.1935327053070068
Epoch: 3, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8868312835693359
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.532 Vali Acc: 0.702 Test Loss: 0.532 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.264352560043335
Epoch: 5, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.639 Vali Acc: 0.761 Test Loss: 0.639 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760969).  Saving model ...
Epoch: 6 cost time: 1.1144311428070068
Epoch: 6, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0793213844299316
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9730422496795654
Epoch: 8, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.727 Vali Acc: 0.639 Test Loss: 0.727 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0844807624816895
Epoch: 9, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.848 Vali Acc: 0.688 Test Loss: 0.848 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2351620197296143
Epoch: 10, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.765 Vali Acc: 0.693 Test Loss: 0.765 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0001301765441895
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9621429443359375
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.887 Vali Acc: 0.722 Test Loss: 0.887 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9511497020721436
Epoch: 13, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.844 Vali Acc: 0.717 Test Loss: 0.844 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8710227012634277
Epoch: 14, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.977 Vali Acc: 0.737 Test Loss: 0.977 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8823885917663574
Epoch: 15, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.987 Vali Acc: 0.707 Test Loss: 0.987 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 38886146
model size : 163.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5446887016296387
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.550870418548584
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.5996217727661133
Epoch: 3, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.545 Vali Acc: 0.732 Test Loss: 0.545 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3609619140625
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8143177032470703
Epoch: 5, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.649 Vali Acc: 0.688 Test Loss: 0.649 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8213598728179932
Epoch: 6, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.809 Vali Acc: 0.659 Test Loss: 0.809 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5605039596557617
Epoch: 7, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.918 Vali Acc: 0.741 Test Loss: 0.918 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7786529064178467
Epoch: 8, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.008 Vali Acc: 0.741 Test Loss: 1.008 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9343822002410889
Epoch: 9, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.034 Vali Acc: 0.717 Test Loss: 1.034 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.776777744293213
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.477 Vali Acc: 0.732 Test Loss: 1.477 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.947392463684082
Epoch: 11, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.346 Vali Acc: 0.727 Test Loss: 1.346 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9437968730926514
Epoch: 12, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.191 Vali Acc: 0.698 Test Loss: 1.191 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 39198722
model size : 164.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4393184185028076
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.3438901901245117
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.149749517440796
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.499 Vali Acc: 0.756 Test Loss: 0.499 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756093).  Saving model ...
Epoch: 4 cost time: 1.1384177207946777
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.670 Vali Acc: 0.771 Test Loss: 0.670 Test Acc: 0.771
Validation loss decreased (-0.756093 --> -0.770725).  Saving model ...
Epoch: 5 cost time: 1.313741683959961
Epoch: 5, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.911 Vali Acc: 0.741 Test Loss: 0.911 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.354583978652954
Epoch: 6, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.961 Vali Acc: 0.639 Test Loss: 0.961 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1434605121612549
Epoch: 7, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2406895160675049
Epoch: 8, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.708 Vali Acc: 0.741 Test Loss: 0.708 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9316275119781494
Epoch: 9, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.754 Vali Acc: 0.707 Test Loss: 0.754 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2526476383209229
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.866 Vali Acc: 0.727 Test Loss: 0.866 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2479376792907715
Epoch: 11, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.857 Vali Acc: 0.727 Test Loss: 0.857 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3618783950805664
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.046 Vali Acc: 0.722 Test Loss: 1.046 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3609156608581543
Epoch: 13, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.941 Vali Acc: 0.746 Test Loss: 0.941 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1450996398925781
Epoch: 14, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.303 Vali Acc: 0.663 Test Loss: 1.303 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 39078914
model size : 163.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.923438787460327
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0227925777435303
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.0228095054626465
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.0850591659545898
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.513 Vali Acc: 0.737 Test Loss: 0.513 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 0.9579391479492188
Epoch: 5, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.535 Vali Acc: 0.727 Test Loss: 0.535 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0541672706604004
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.2530605792999268
Epoch: 7, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.712 Vali Acc: 0.771 Test Loss: 0.712 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770725).  Saving model ...
Epoch: 8 cost time: 0.9439730644226074
Epoch: 8, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.861 Vali Acc: 0.717 Test Loss: 0.861 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4679131507873535
Epoch: 9, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.683 Vali Acc: 0.751 Test Loss: 0.683 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2641663551330566
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9328596591949463
Epoch: 11, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.853 Vali Acc: 0.722 Test Loss: 0.853 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1026086807250977
Epoch: 12, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.031 Vali Acc: 0.756 Test Loss: 1.031 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6185011863708496
Epoch: 13, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3917131423950195
Epoch: 14, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.069 Vali Acc: 0.707 Test Loss: 1.069 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9728496074676514
Epoch: 15, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.070 Vali Acc: 0.698 Test Loss: 1.070 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2681028842926025
Epoch: 16, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.103 Vali Acc: 0.722 Test Loss: 1.103 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0839793682098389
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.107 Vali Acc: 0.683 Test Loss: 1.107 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 39023618
model size : 163.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1875829696655273
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.970120906829834
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.8302454948425293
Epoch: 3, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.569 Vali Acc: 0.693 Test Loss: 0.569 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5574820041656494
Epoch: 4, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.672 Vali Acc: 0.766 Test Loss: 0.672 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765847).  Saving model ...
Epoch: 5 cost time: 1.7160611152648926
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.513 Vali Acc: 0.751 Test Loss: 0.513 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7038509845733643
Epoch: 6, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.589 Vali Acc: 0.702 Test Loss: 0.589 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.89906644821167
Epoch: 7, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.725 Vali Acc: 0.727 Test Loss: 0.725 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3713834285736084
Epoch: 8, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.764 Vali Acc: 0.712 Test Loss: 0.764 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8382227420806885
Epoch: 9, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.887 Vali Acc: 0.722 Test Loss: 0.887 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6420421600341797
Epoch: 10, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.863 Vali Acc: 0.727 Test Loss: 0.863 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.655785083770752
Epoch: 11, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.333 Vali Acc: 0.722 Test Loss: 1.333 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.003234624862671
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.417 Vali Acc: 0.746 Test Loss: 1.417 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9515109062194824
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.256 Vali Acc: 0.683 Test Loss: 1.256 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.025075912475586
Epoch: 14, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.729 Vali Acc: 0.732 Test Loss: 1.729 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 39339266
model size : 164.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2980895042419434
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.6226859092712402
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.6300208568572998
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.555 Vali Acc: 0.693 Test Loss: 0.555 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4178752899169922
Epoch: 4, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.594 Vali Acc: 0.693 Test Loss: 0.594 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3111600875854492
Epoch: 5, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.3843762874603271
Epoch: 6, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1216988563537598
Epoch: 7, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5203688144683838
Epoch: 8, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.719 Vali Acc: 0.693 Test Loss: 0.719 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4102904796600342
Epoch: 9, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.011 Vali Acc: 0.751 Test Loss: 1.011 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1226491928100586
Epoch: 10, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.492 Vali Acc: 0.512 Test Loss: 1.492 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4021358489990234
Epoch: 11, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.896 Vali Acc: 0.771 Test Loss: 0.896 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770723).  Saving model ...
Epoch: 12 cost time: 1.547969102859497
Epoch: 12, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.359 Vali Acc: 0.751 Test Loss: 1.359 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.449883222579956
Epoch: 13, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.183 Vali Acc: 0.644 Test Loss: 1.183 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3096122741699219
Epoch: 14, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.334 Vali Acc: 0.634 Test Loss: 1.334 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5848159790039062
Epoch: 15, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.215 Vali Acc: 0.659 Test Loss: 1.215 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2710552215576172
Epoch: 16, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.274 Vali Acc: 0.683 Test Loss: 1.274 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3701226711273193
Epoch: 17, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.365 Vali Acc: 0.678 Test Loss: 1.365 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3405776023864746
Epoch: 18, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.378 Vali Acc: 0.737 Test Loss: 1.378 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.451991319656372
Epoch: 19, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.426 Vali Acc: 0.688 Test Loss: 1.426 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3875408172607422
Epoch: 20, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.437 Vali Acc: 0.673 Test Loss: 1.437 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6378638744354248
Epoch: 21, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.285 Vali Acc: 0.668 Test Loss: 1.285 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 39219458
model size : 164.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4564812183380127
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.8313286304473877
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.0754382610321045
Epoch: 3, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0597522258758545
Epoch: 4, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8613882064819336
Epoch: 5, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.724 Vali Acc: 0.639 Test Loss: 0.724 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3786389827728271
Epoch: 6, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8729252815246582
Epoch: 7, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.930 Vali Acc: 0.722 Test Loss: 0.930 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.937300443649292
Epoch: 8, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.830 Vali Acc: 0.751 Test Loss: 0.830 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2096946239471436
Epoch: 9, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.740 Vali Acc: 0.688 Test Loss: 0.740 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0882718563079834
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.835 Vali Acc: 0.702 Test Loss: 0.835 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2358853816986084
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.788 Vali Acc: 0.659 Test Loss: 0.788 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.050246238708496
Epoch: 12, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.926 Vali Acc: 0.688 Test Loss: 0.926 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 39161090
model size : 164.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.387769937515259
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.688 Vali Acc: 0.566 Test Loss: 0.688 Test Acc: 0.566
Validation loss decreased (inf --> -0.565847).  Saving model ...
Epoch: 2 cost time: 1.529895544052124
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
Validation loss decreased (-0.565847 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.740607500076294
Epoch: 3, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.4070484638214111
Epoch: 4, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.554 Vali Acc: 0.756 Test Loss: 0.554 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.988440752029419
Epoch: 5, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.704 Vali Acc: 0.707 Test Loss: 0.704 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5289826393127441
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.688 Vali Acc: 0.663 Test Loss: 0.688 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6691858768463135
Epoch: 7, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6995694637298584
Epoch: 8, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.154 Vali Acc: 0.566 Test Loss: 1.154 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6881427764892578
Epoch: 9, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.964 Vali Acc: 0.580 Test Loss: 0.964 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2962067127227783
Epoch: 10, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.973 Vali Acc: 0.654 Test Loss: 0.973 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5978798866271973
Epoch: 11, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.062 Vali Acc: 0.659 Test Loss: 1.062 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4550023078918457
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.076 Vali Acc: 0.707 Test Loss: 1.076 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7375948429107666
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.720 Vali Acc: 0.732 Test Loss: 1.720 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6951100826263428
Epoch: 14, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.305 Vali Acc: 0.698 Test Loss: 1.305 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 39439874
model size : 165.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4348561763763428
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 0.7502343654632568
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.95524001121521
Epoch: 3, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.207305908203125
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.624809980392456
Epoch: 5, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.660 Vali Acc: 0.741 Test Loss: 0.660 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5802502632141113
Epoch: 6, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.730 Vali Acc: 0.727 Test Loss: 0.730 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.725027322769165
Epoch: 7, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.809 Vali Acc: 0.649 Test Loss: 0.809 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5102136135101318
Epoch: 8, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.772 Vali Acc: 0.712 Test Loss: 0.772 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6204001903533936
Epoch: 9, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.314 Vali Acc: 0.576 Test Loss: 1.314 Test Acc: 0.576
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.655186653137207
Epoch: 10, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.909 Vali Acc: 0.659 Test Loss: 0.909 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4872550964355469
Epoch: 11, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.012 Vali Acc: 0.663 Test Loss: 1.012 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5154707431793213
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.123 Vali Acc: 0.722 Test Loss: 1.123 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.690544605255127
Epoch: 13, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.118 Vali Acc: 0.624 Test Loss: 1.118 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3267791271209717
Epoch: 14, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.111 Vali Acc: 0.639 Test Loss: 1.111 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 39347714
model size : 164.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5653669834136963
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3226580619812012
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.20029878616333
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.1382167339324951
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.515 Vali Acc: 0.707 Test Loss: 0.515 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0837137699127197
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.548 Vali Acc: 0.698 Test Loss: 0.548 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.012831211090088
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.677 Vali Acc: 0.751 Test Loss: 0.677 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.654017448425293
Epoch: 7, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.733 Vali Acc: 0.751 Test Loss: 0.733 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7250721454620361
Epoch: 8, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.739 Vali Acc: 0.756 Test Loss: 0.739 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6569721698760986
Epoch: 9, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.689 Vali Acc: 0.712 Test Loss: 0.689 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7531888484954834
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.028 Vali Acc: 0.771 Test Loss: 1.028 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770721).  Saving model ...
Epoch: 11 cost time: 0.7876617908477783
Epoch: 11, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1578466892242432
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.811 Vali Acc: 0.683 Test Loss: 0.811 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1132712364196777
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.037 Vali Acc: 0.737 Test Loss: 1.037 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1185228824615479
Epoch: 14, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.094 Vali Acc: 0.737 Test Loss: 1.094 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2302420139312744
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.399 Vali Acc: 0.756 Test Loss: 1.399 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2903835773468018
Epoch: 16, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.184 Vali Acc: 0.746 Test Loss: 1.184 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1553795337677002
Epoch: 17, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.103 Vali Acc: 0.673 Test Loss: 1.103 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1701457500457764
Epoch: 18, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.146 Vali Acc: 0.746 Test Loss: 1.146 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1498496532440186
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.109 Vali Acc: 0.712 Test Loss: 1.109 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.11122727394104
Epoch: 20, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.071 Vali Acc: 0.722 Test Loss: 1.071 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 39298562
model size : 164.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.060678243637085
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8692033290863037
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.543 Vali Acc: 0.751 Test Loss: 0.543 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.8441100120544434
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.8206870555877686
Epoch: 4, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.683 Vali Acc: 0.741 Test Loss: 0.683 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.922217845916748
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.592 Vali Acc: 0.741 Test Loss: 0.592 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.607980728149414
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.850 Vali Acc: 0.712 Test Loss: 0.850 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9898033142089844
Epoch: 7, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.182 Vali Acc: 0.717 Test Loss: 1.182 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5142602920532227
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.433 Vali Acc: 0.576 Test Loss: 1.433 Test Acc: 0.576
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8015155792236328
Epoch: 9, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.959 Vali Acc: 0.673 Test Loss: 0.959 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6870648860931396
Epoch: 10, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.248 Vali Acc: 0.737 Test Loss: 1.248 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7452807426452637
Epoch: 11, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.135 Vali Acc: 0.712 Test Loss: 1.135 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.017857074737549
Epoch: 12, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.255 Vali Acc: 0.693 Test Loss: 1.255 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3404054641723633
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.807 Vali Acc: 0.727 Test Loss: 1.807 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 39577346
model size : 165.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.371885061264038
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2925293445587158
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.580395221710205
Epoch: 3, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.526 Vali Acc: 0.751 Test Loss: 0.526 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.5462560653686523
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.525 Vali Acc: 0.727 Test Loss: 0.525 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.292109727859497
Epoch: 5, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.027 Vali Acc: 0.522 Test Loss: 1.027 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3846726417541504
Epoch: 6, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.386397123336792
Epoch: 7, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.626 Vali Acc: 0.741 Test Loss: 0.626 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2237038612365723
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.789 Vali Acc: 0.746 Test Loss: 0.789 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.59342622756958
Epoch: 9, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.883 Vali Acc: 0.673 Test Loss: 0.883 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2795395851135254
Epoch: 10, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.880 Vali Acc: 0.478 Test Loss: 1.880 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1111981868743896
Epoch: 11, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.056 Vali Acc: 0.712 Test Loss: 1.056 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4127519130706787
Epoch: 12, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.886 Vali Acc: 0.693 Test Loss: 0.886 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4044716358184814
Epoch: 13, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.250 Vali Acc: 0.702 Test Loss: 1.250 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 39488258
model size : 165.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7802066802978516
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3336753845214844
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.8535094261169434
Epoch: 3, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.600 Vali Acc: 0.756 Test Loss: 0.600 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.3943629264831543
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
Validation loss decreased (-0.756092 --> -0.775603).  Saving model ...
Epoch: 5 cost time: 1.2358660697937012
Epoch: 5, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2633521556854248
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.354194164276123
Epoch: 7, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.344900131225586
Epoch: 8, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.770 Vali Acc: 0.707 Test Loss: 0.770 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7247960567474365
Epoch: 9, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.687 Vali Acc: 0.678 Test Loss: 0.687 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0686156749725342
Epoch: 10, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.791 Vali Acc: 0.702 Test Loss: 0.791 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4728069305419922
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.075 Vali Acc: 0.751 Test Loss: 1.075 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.555828332901001
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.189 Vali Acc: 0.722 Test Loss: 1.189 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0455446243286133
Epoch: 13, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.173 Vali Acc: 0.751 Test Loss: 1.173 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4625709056854248
Epoch: 14, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.869 Vali Acc: 0.698 Test Loss: 0.869 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 39436034
model size : 165.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4342026710510254
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3387186527252197
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.8350446224212646
Epoch: 3, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.125319480895996
Epoch: 4, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.611 Vali Acc: 0.663 Test Loss: 0.611 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2949535846710205
Epoch: 5, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.516 Vali Acc: 0.722 Test Loss: 0.516 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.700423240661621
Epoch: 6, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.552 Vali Acc: 0.766 Test Loss: 0.552 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 1.8596274852752686
Epoch: 7, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.596 Vali Acc: 0.761 Test Loss: 0.596 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7528712749481201
Epoch: 8, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.920 Vali Acc: 0.702 Test Loss: 0.920 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.169135332107544
Epoch: 9, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.829 Vali Acc: 0.732 Test Loss: 0.829 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1918160915374756
Epoch: 10, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.006 Vali Acc: 0.712 Test Loss: 1.006 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8639662265777588
Epoch: 11, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.129 Vali Acc: 0.668 Test Loss: 1.129 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8754515647888184
Epoch: 12, Steps: 13 | Train Loss: 0.205 Vali Loss: 2.199 Vali Acc: 0.522 Test Loss: 2.199 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5979695320129395
Epoch: 13, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.073 Vali Acc: 0.678 Test Loss: 1.073 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8900864124298096
Epoch: 14, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.455 Vali Acc: 0.639 Test Loss: 1.455 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.236774206161499
Epoch: 15, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.296 Vali Acc: 0.688 Test Loss: 1.296 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.776613473892212
Epoch: 16, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.566 Vali Acc: 0.693 Test Loss: 1.566 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 39717890
model size : 166.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2566418647766113
Epoch: 1, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.630113124847412
Epoch: 2, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.554 Vali Acc: 0.746 Test Loss: 0.554 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.73984956741333
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.513 Vali Acc: 0.737 Test Loss: 0.513 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.566002368927002
Epoch: 4, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2953112125396729
Epoch: 5, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.624290943145752
Epoch: 6, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.709 Vali Acc: 0.727 Test Loss: 0.709 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.376833438873291
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
Validation loss decreased (-0.746336 --> -0.775603).  Saving model ...
Epoch: 8 cost time: 1.6678578853607178
Epoch: 8, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.762 Vali Acc: 0.702 Test Loss: 0.762 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2021849155426025
Epoch: 9, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3959550857543945
Epoch: 10, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.810 Vali Acc: 0.746 Test Loss: 0.810 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6080856323242188
Epoch: 11, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.824 Vali Acc: 0.683 Test Loss: 0.824 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2631025314331055
Epoch: 12, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.788 Vali Acc: 0.688 Test Loss: 0.788 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6161894798278809
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.950 Vali Acc: 0.673 Test Loss: 0.950 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4309046268463135
Epoch: 14, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.003 Vali Acc: 0.693 Test Loss: 1.003 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6797997951507568
Epoch: 15, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5104246139526367
Epoch: 16, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.042 Vali Acc: 0.693 Test Loss: 1.042 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5338904857635498
Epoch: 17, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.069 Vali Acc: 0.654 Test Loss: 1.069 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 39619586
model size : 165.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7049026489257812
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5431768894195557
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5034794807434082
Epoch: 3, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.563 Vali Acc: 0.756 Test Loss: 0.563 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.5090229511260986
Epoch: 4, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3589262962341309
Epoch: 5, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.724 Vali Acc: 0.751 Test Loss: 0.724 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5094587802886963
Epoch: 6, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3908228874206543
Epoch: 7, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.719 Vali Acc: 0.624 Test Loss: 0.719 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4561638832092285
Epoch: 8, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.826 Vali Acc: 0.737 Test Loss: 0.826 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2272999286651611
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.971 Vali Acc: 0.727 Test Loss: 0.971 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3931095600128174
Epoch: 10, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.180 Vali Acc: 0.732 Test Loss: 1.180 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1485347747802734
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.918 Vali Acc: 0.746 Test Loss: 0.918 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4075522422790527
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.005 Vali Acc: 0.688 Test Loss: 1.005 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3440842628479004
Epoch: 13, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.230 Vali Acc: 0.639 Test Loss: 1.230 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 39573506
model size : 165.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2862956523895264
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 1.5800766944885254
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.9465076923370361
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.516 Vali Acc: 0.732 Test Loss: 0.516 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.712294101715088
Epoch: 4, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.5678186416625977
Epoch: 5, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.515 Vali Acc: 0.732 Test Loss: 0.515 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9344000816345215
Epoch: 6, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7375288009643555
Epoch: 7, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.892 Vali Acc: 0.673 Test Loss: 0.892 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9205093383789062
Epoch: 8, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.854 Vali Acc: 0.737 Test Loss: 0.854 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6767208576202393
Epoch: 9, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.069 Vali Acc: 0.678 Test Loss: 1.069 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.99824857711792
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.954 Vali Acc: 0.761 Test Loss: 0.954 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760966).  Saving model ...
Epoch: 11 cost time: 1.8380186557769775
Epoch: 11, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.406 Vali Acc: 0.737 Test Loss: 1.406 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9382779598236084
Epoch: 12, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.297 Vali Acc: 0.727 Test Loss: 1.297 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8148722648620605
Epoch: 13, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.310 Vali Acc: 0.702 Test Loss: 1.310 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.026761770248413
Epoch: 14, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.286 Vali Acc: 0.712 Test Loss: 1.286 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9515748023986816
Epoch: 15, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.356 Vali Acc: 0.698 Test Loss: 1.356 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.736487865447998
Epoch: 16, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.556 Vali Acc: 0.663 Test Loss: 1.556 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9249546527862549
Epoch: 17, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.344 Vali Acc: 0.707 Test Loss: 1.344 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6794931888580322
Epoch: 18, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.991 Vali Acc: 0.712 Test Loss: 1.991 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5778751373291016
Epoch: 19, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.983 Vali Acc: 0.698 Test Loss: 1.983 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.914196491241455
Epoch: 20, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.621 Vali Acc: 0.683 Test Loss: 1.621 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 39858434
model size : 166.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.815178155899048
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.630 Vali Acc: 0.756 Test Loss: 0.630 Test Acc: 0.756
Validation loss decreased (inf --> -0.756091).  Saving model ...
Epoch: 2 cost time: 1.044372797012329
Epoch: 2, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3628425598144531
Epoch: 3, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.588 Vali Acc: 0.756 Test Loss: 0.588 Test Acc: 0.756
Validation loss decreased (-0.756091 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.318342685699463
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.646 Vali Acc: 0.746 Test Loss: 0.646 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0975227355957031
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.1859087944030762
Epoch: 6, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.655 Vali Acc: 0.688 Test Loss: 0.655 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5518183708190918
Epoch: 7, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.624 Vali Acc: 0.693 Test Loss: 0.624 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4367949962615967
Epoch: 8, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.702 Vali Acc: 0.741 Test Loss: 0.702 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3112246990203857
Epoch: 9, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.237795114517212
Epoch: 10, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.938 Vali Acc: 0.693 Test Loss: 0.938 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.441004753112793
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.922 Vali Acc: 0.707 Test Loss: 0.922 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4026329517364502
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.020 Vali Acc: 0.678 Test Loss: 1.020 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4269204139709473
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.166 Vali Acc: 0.746 Test Loss: 1.166 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2997617721557617
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.055 Vali Acc: 0.659 Test Loss: 1.055 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4043428897857666
Epoch: 15, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.086 Vali Acc: 0.629 Test Loss: 1.086 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 39760130
model size : 166.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.620380163192749
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3381123542785645
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.543 Vali Acc: 0.751 Test Loss: 0.543 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.2808771133422852
Epoch: 3, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.543 Vali Acc: 0.766 Test Loss: 0.543 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 0.9986703395843506
Epoch: 4, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3001813888549805
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3064374923706055
Epoch: 6, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3809046745300293
Epoch: 7, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.719 Vali Acc: 0.673 Test Loss: 0.719 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4343106746673584
Epoch: 8, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3515229225158691
Epoch: 9, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2217671871185303
Epoch: 10, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.082 Vali Acc: 0.761 Test Loss: 1.082 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3692302703857422
Epoch: 11, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.731 Vali Acc: 0.732 Test Loss: 0.731 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4267563819885254
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.019 Vali Acc: 0.712 Test Loss: 1.019 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.055757999420166
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.850 Vali Acc: 0.707 Test Loss: 0.850 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 39710978
model size : 166.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1204018592834473
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.612 Vali Acc: 0.746 Test Loss: 0.612 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 1.7525835037231445
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.708794116973877
Epoch: 3, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.525 Vali Acc: 0.751 Test Loss: 0.525 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.584571361541748
Epoch: 4, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.760 Vali Acc: 0.732 Test Loss: 0.760 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.526271104812622
Epoch: 5, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760968).  Saving model ...
Epoch: 6 cost time: 1.575256586074829
Epoch: 6, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.627 Vali Acc: 0.732 Test Loss: 0.627 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7189383506774902
Epoch: 7, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.776 Vali Acc: 0.634 Test Loss: 0.776 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6337451934814453
Epoch: 8, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.927 Vali Acc: 0.615 Test Loss: 0.927 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6450364589691162
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.873 Vali Acc: 0.717 Test Loss: 0.873 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6984071731567383
Epoch: 10, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.072 Vali Acc: 0.727 Test Loss: 1.072 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6694817543029785
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.132 Vali Acc: 0.698 Test Loss: 1.132 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7598836421966553
Epoch: 12, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.306 Vali Acc: 0.727 Test Loss: 1.306 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8036794662475586
Epoch: 13, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.093 Vali Acc: 0.717 Test Loss: 1.093 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.74601149559021
Epoch: 14, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.409 Vali Acc: 0.707 Test Loss: 1.409 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6633203029632568
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.528 Vali Acc: 0.722 Test Loss: 1.528 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 40111874
model size : 167.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5012731552124023
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2096045017242432
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.543 Vali Acc: 0.761 Test Loss: 0.543 Test Acc: 0.761
Validation loss decreased (-0.717067 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.120865821838379
Epoch: 3, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0596089363098145
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1809883117675781
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1608684062957764
Epoch: 6, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.853 Vali Acc: 0.780 Test Loss: 0.853 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780479).  Saving model ...
Epoch: 7 cost time: 1.3577075004577637
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.734 Vali Acc: 0.776 Test Loss: 0.734 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2963857650756836
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.947 Vali Acc: 0.751 Test Loss: 0.947 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0339076519012451
Epoch: 9, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.168 Vali Acc: 0.756 Test Loss: 1.168 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.393686056137085
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.144 Vali Acc: 0.746 Test Loss: 1.144 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.396315336227417
Epoch: 11, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.825 Vali Acc: 0.737 Test Loss: 0.825 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4600350856781006
Epoch: 12, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.040 Vali Acc: 0.673 Test Loss: 1.040 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.192991018295288
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.015 Vali Acc: 0.712 Test Loss: 1.015 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3383166790008545
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.094 Vali Acc: 0.732 Test Loss: 1.094 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.435694694519043
Epoch: 15, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.212 Vali Acc: 0.741 Test Loss: 1.212 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0328443050384521
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.184 Vali Acc: 0.712 Test Loss: 1.184 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 40035074
model size : 167.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.545833110809326
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.1097886562347412
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.1174087524414062
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.524 Vali Acc: 0.751 Test Loss: 0.524 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.9707767963409424
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8150618076324463
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.706 Vali Acc: 0.624 Test Loss: 0.706 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0534532070159912
Epoch: 6, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.549 Vali Acc: 0.717 Test Loss: 0.549 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.118739128112793
Epoch: 7, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9557473659515381
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.781 Vali Acc: 0.732 Test Loss: 0.781 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9499411582946777
Epoch: 9, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.684 Vali Acc: 0.737 Test Loss: 0.684 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9093382358551025
Epoch: 10, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.703 Vali Acc: 0.702 Test Loss: 0.703 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1128711700439453
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.852 Vali Acc: 0.727 Test Loss: 0.852 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9017715454101562
Epoch: 12, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.174 Vali Acc: 0.761 Test Loss: 1.174 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760964).  Saving model ...
Epoch: 13 cost time: 0.9957249164581299
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.085 Vali Acc: 0.707 Test Loss: 1.085 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9974703788757324
Epoch: 14, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.907 Vali Acc: 0.741 Test Loss: 0.907 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8988347053527832
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.949 Vali Acc: 0.673 Test Loss: 0.949 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9447939395904541
Epoch: 16, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.070 Vali Acc: 0.688 Test Loss: 1.070 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0053002834320068
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.127 Vali Acc: 0.693 Test Loss: 1.127 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9854006767272949
Epoch: 18, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.262 Vali Acc: 0.737 Test Loss: 1.262 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.972745418548584
Epoch: 19, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.075 Vali Acc: 0.722 Test Loss: 1.075 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8945200443267822
Epoch: 20, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.067 Vali Acc: 0.712 Test Loss: 1.067 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.004047155380249
Epoch: 21, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.105 Vali Acc: 0.702 Test Loss: 1.105 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.998784065246582
Epoch: 22, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.177 Vali Acc: 0.707 Test Loss: 1.177 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 39988994
model size : 167.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.150280237197876
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.135690689086914
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.536 Vali Acc: 0.761 Test Loss: 0.536 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.5858254432678223
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6403241157531738
Epoch: 4, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.664 Vali Acc: 0.771 Test Loss: 0.664 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770725).  Saving model ...
Epoch: 5 cost time: 1.6263837814331055
Epoch: 5, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6056153774261475
Epoch: 6, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.793 Vali Acc: 0.751 Test Loss: 0.793 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6234767436981201
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.641 Vali Acc: 0.683 Test Loss: 0.641 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3875524997711182
Epoch: 8, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.833 Vali Acc: 0.727 Test Loss: 0.833 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5454742908477783
Epoch: 9, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.295 Vali Acc: 0.615 Test Loss: 1.295 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5224149227142334
Epoch: 10, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.170 Vali Acc: 0.615 Test Loss: 1.170 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6027300357818604
Epoch: 11, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.026 Vali Acc: 0.663 Test Loss: 1.026 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3958253860473633
Epoch: 12, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.199 Vali Acc: 0.717 Test Loss: 1.199 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.477189302444458
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.259 Vali Acc: 0.693 Test Loss: 1.259 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.499906063079834
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.153 Vali Acc: 0.668 Test Loss: 1.153 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 40252418
model size : 168.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7681784629821777
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.2890207767486572
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.475104808807373
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.4240305423736572
Epoch: 4, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.553 Vali Acc: 0.761 Test Loss: 0.553 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.1923105716705322
Epoch: 5, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.391672134399414
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5018134117126465
Epoch: 7, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.022404670715332
Epoch: 8, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.784 Vali Acc: 0.737 Test Loss: 0.784 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3165371417999268
Epoch: 9, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.797 Vali Acc: 0.732 Test Loss: 0.797 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2114028930664062
Epoch: 10, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.833 Vali Acc: 0.698 Test Loss: 0.833 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.352656364440918
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.893 Vali Acc: 0.683 Test Loss: 0.893 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4658386707305908
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.146 Vali Acc: 0.673 Test Loss: 1.146 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2879436016082764
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.173 Vali Acc: 0.746 Test Loss: 1.173 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7757446765899658
Epoch: 14, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.595 Vali Acc: 0.727 Test Loss: 1.595 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 40169474
model size : 167.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.531953811645508
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2241370677947998
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.550 Vali Acc: 0.761 Test Loss: 0.550 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.219606637954712
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.522 Vali Acc: 0.751 Test Loss: 0.522 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2450792789459229
Epoch: 4, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0966711044311523
Epoch: 5, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.635 Vali Acc: 0.751 Test Loss: 0.635 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1468541622161865
Epoch: 6, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.930 Vali Acc: 0.556 Test Loss: 0.930 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.156862735748291
Epoch: 7, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.915 Vali Acc: 0.741 Test Loss: 0.915 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.189805269241333
Epoch: 8, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.673 Vali Acc: 0.683 Test Loss: 0.673 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9513981342315674
Epoch: 9, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2401788234710693
Epoch: 10, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.708 Vali Acc: 0.717 Test Loss: 0.708 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2193667888641357
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.749 Vali Acc: 0.639 Test Loss: 0.749 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2061610221862793
Epoch: 12, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.716 Vali Acc: 0.659 Test Loss: 0.716 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 40129538
model size : 167.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.909224033355713
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.4019169807434082
Epoch: 2, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760971).  Saving model ...
Epoch: 3 cost time: 1.5000991821289062
Epoch: 3, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.614201545715332
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.630 Vali Acc: 0.766 Test Loss: 0.630 Test Acc: 0.766
Validation loss decreased (-0.760971 --> -0.765847).  Saving model ...
Epoch: 5 cost time: 1.5145246982574463
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.637 Vali Acc: 0.741 Test Loss: 0.637 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.670961856842041
Epoch: 6, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.765 Vali Acc: 0.663 Test Loss: 0.765 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7595341205596924
Epoch: 7, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.892 Vali Acc: 0.722 Test Loss: 0.892 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5939891338348389
Epoch: 8, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.814 Vali Acc: 0.707 Test Loss: 0.814 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7021996974945068
Epoch: 9, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.076 Vali Acc: 0.639 Test Loss: 1.076 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.742673397064209
Epoch: 10, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.893 Vali Acc: 0.663 Test Loss: 0.893 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4591400623321533
Epoch: 11, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.293 Vali Acc: 0.663 Test Loss: 1.293 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6629526615142822
Epoch: 12, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.704 Vali Acc: 0.707 Test Loss: 1.704 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6795871257781982
Epoch: 13, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.474 Vali Acc: 0.678 Test Loss: 1.474 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.734755277633667
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.167 Vali Acc: 0.702 Test Loss: 1.167 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 40512002
model size : 169.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9886674880981445
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.5154399871826172
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.551 Vali Acc: 0.756 Test Loss: 0.551 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.089350938796997
Epoch: 3, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4686543941497803
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.582 Vali Acc: 0.683 Test Loss: 0.582 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2491137981414795
Epoch: 5, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3869349956512451
Epoch: 6, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.763 Vali Acc: 0.746 Test Loss: 0.763 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3344364166259766
Epoch: 7, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.727 Vali Acc: 0.698 Test Loss: 0.727 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3433973789215088
Epoch: 8, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.816 Vali Acc: 0.644 Test Loss: 0.816 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.442516565322876
Epoch: 9, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.966 Vali Acc: 0.678 Test Loss: 0.966 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1617577075958252
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.839 Vali Acc: 0.502 Test Loss: 1.839 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.491286277770996
Epoch: 11, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.838 Vali Acc: 0.702 Test Loss: 0.838 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4168412685394287
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.215 Vali Acc: 0.717 Test Loss: 1.215 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 40444418
model size : 168.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5948357582092285
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.2406048774719238
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.2505910396575928
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.0975027084350586
Epoch: 4, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1518526077270508
Epoch: 5, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.602 Vali Acc: 0.707 Test Loss: 0.602 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1020820140838623
Epoch: 6, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1722164154052734
Epoch: 7, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.657 Vali Acc: 0.712 Test Loss: 0.657 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1043617725372314
Epoch: 8, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.743 Vali Acc: 0.737 Test Loss: 0.743 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0314698219299316
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.764 Vali Acc: 0.761 Test Loss: 0.764 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760968).  Saving model ...
Epoch: 10 cost time: 1.257408618927002
Epoch: 10, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.852 Vali Acc: 0.722 Test Loss: 0.852 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9589192867279053
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.799 Vali Acc: 0.688 Test Loss: 0.799 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1390719413757324
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.975 Vali Acc: 0.737 Test Loss: 0.975 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0527138710021973
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.879 Vali Acc: 0.702 Test Loss: 0.879 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0250699520111084
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.009 Vali Acc: 0.766 Test Loss: 1.009 Test Acc: 0.766
Validation loss decreased (-0.760968 --> -0.765844).  Saving model ...
Epoch: 15 cost time: 1.1334736347198486
Epoch: 15, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.997 Vali Acc: 0.717 Test Loss: 0.997 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.149402379989624
Epoch: 16, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.916 Vali Acc: 0.698 Test Loss: 0.916 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1116034984588623
Epoch: 17, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.031 Vali Acc: 0.673 Test Loss: 1.031 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0226364135742188
Epoch: 18, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.013 Vali Acc: 0.737 Test Loss: 1.013 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.051140546798706
Epoch: 19, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.110 Vali Acc: 0.741 Test Loss: 1.110 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1327388286590576
Epoch: 20, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.121 Vali Acc: 0.678 Test Loss: 1.121 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.906644344329834
Epoch: 21, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.107 Vali Acc: 0.737 Test Loss: 1.107 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0823006629943848
Epoch: 22, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.041 Vali Acc: 0.693 Test Loss: 1.041 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1873400211334229
Epoch: 23, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.181 Vali Acc: 0.746 Test Loss: 1.181 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1808698177337646
Epoch: 24, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.496 Vali Acc: 0.785 Test Loss: 1.496 Test Acc: 0.785
Validation loss decreased (-0.765844 --> -0.785351).  Saving model ...
Epoch: 25 cost time: 1.121614694595337
Epoch: 25, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.010 Vali Acc: 0.663 Test Loss: 1.010 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0672292709350586
Epoch: 26, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.232 Vali Acc: 0.688 Test Loss: 1.232 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1122775077819824
Epoch: 27, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.191 Vali Acc: 0.659 Test Loss: 1.191 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0217068195343018
Epoch: 28, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.258 Vali Acc: 0.688 Test Loss: 1.258 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9873092174530029
Epoch: 29, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.788 Vali Acc: 0.751 Test Loss: 1.788 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0408782958984375
Epoch: 30, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.112 Vali Acc: 0.678 Test Loss: 1.112 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8110606670379639
Epoch: 31, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.187 Vali Acc: 0.712 Test Loss: 1.187 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0748012065887451
Epoch: 32, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.199 Vali Acc: 0.693 Test Loss: 1.199 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.058943510055542
Epoch: 33, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.261 Vali Acc: 0.717 Test Loss: 1.261 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9802556037902832
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.727 Test Loss: 1.363 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 40404482
model size : 168.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0179007053375244
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.5059967041015625
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.511 Vali Acc: 0.756 Test Loss: 0.511 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.4572899341583252
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.355757713317871
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5646922588348389
Epoch: 5, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.553 Vali Acc: 0.766 Test Loss: 0.553 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 1.7164804935455322
Epoch: 6, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4229681491851807
Epoch: 7, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.739 Vali Acc: 0.751 Test Loss: 0.739 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.742797613143921
Epoch: 8, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.065 Vali Acc: 0.761 Test Loss: 1.065 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5840022563934326
Epoch: 9, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.818 Vali Acc: 0.732 Test Loss: 0.818 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5337514877319336
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.779 Vali Acc: 0.702 Test Loss: 0.779 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9008655548095703
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.115 Vali Acc: 0.707 Test Loss: 1.115 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0667672157287598
Epoch: 12, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.005 Vali Acc: 0.761 Test Loss: 1.005 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.969977855682373
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.301 Vali Acc: 0.761 Test Loss: 1.301 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1139557361602783
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.274 Vali Acc: 0.707 Test Loss: 1.274 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0804839134216309
Epoch: 15, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.242 Vali Acc: 0.668 Test Loss: 1.242 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 40930562
model size : 170.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.452801465988159
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 0.9479937553405762
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 0.7110762596130371
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.511 Vali Acc: 0.746 Test Loss: 0.511 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0389022827148438
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.928433895111084
Epoch: 5, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0784895420074463
Epoch: 6, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.823 Vali Acc: 0.663 Test Loss: 0.823 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.030806541442871
Epoch: 7, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.158 Vali Acc: 0.576 Test Loss: 1.158 Test Acc: 0.576
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.758448600769043
Epoch: 8, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.770958662033081
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.900 Vali Acc: 0.702 Test Loss: 0.900 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7254424095153809
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.083 Vali Acc: 0.702 Test Loss: 1.083 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0869193077087402
Epoch: 11, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.206 Vali Acc: 0.624 Test Loss: 1.206 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.245774507522583
Epoch: 12, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 40859906
model size : 170.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.553830862045288
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.052626132965088
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9253201484680176
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.539 Vali Acc: 0.761 Test Loss: 0.539 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.9963772296905518
Epoch: 4, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.548 Vali Acc: 0.761 Test Loss: 0.548 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9674973487854004
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0658273696899414
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.662 Vali Acc: 0.751 Test Loss: 0.662 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9158499240875244
Epoch: 7, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.638 Vali Acc: 0.737 Test Loss: 0.638 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1439507007598877
Epoch: 8, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.798 Vali Acc: 0.678 Test Loss: 0.798 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8939826488494873
Epoch: 9, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.742 Vali Acc: 0.727 Test Loss: 0.742 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9827134609222412
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.795 Vali Acc: 0.683 Test Loss: 0.795 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9106638431549072
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.938 Vali Acc: 0.722 Test Loss: 0.938 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0328209400177002
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.884 Vali Acc: 0.698 Test Loss: 0.884 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1161553859710693
Epoch: 13, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.155 Vali Acc: 0.746 Test Loss: 1.155 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 40823042
model size : 170.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.071742534637451
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.0666861534118652
Epoch: 2, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.657 Vali Acc: 0.722 Test Loss: 0.657 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4543657302856445
Epoch: 3, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 1.4734721183776855
Epoch: 4, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.556 Vali Acc: 0.756 Test Loss: 0.556 Test Acc: 0.756
Validation loss decreased (-0.731701 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.0323162078857422
Epoch: 5, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.548 Vali Acc: 0.756 Test Loss: 0.548 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.7875921726226807
Epoch: 6, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.738 Vali Acc: 0.702 Test Loss: 0.738 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4463183879852295
Epoch: 7, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.767 Vali Acc: 0.727 Test Loss: 0.767 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3636822700500488
Epoch: 8, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.885 Vali Acc: 0.737 Test Loss: 0.885 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2116003036499023
Epoch: 9, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.889 Vali Acc: 0.727 Test Loss: 0.889 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.677992820739746
Epoch: 10, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.126 Vali Acc: 0.727 Test Loss: 1.126 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6188335418701172
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.214 Vali Acc: 0.688 Test Loss: 1.214 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.519904613494873
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.241 Vali Acc: 0.722 Test Loss: 1.241 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6392450332641602
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.116 Vali Acc: 0.727 Test Loss: 1.116 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.567974328994751
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.245 Vali Acc: 0.654 Test Loss: 1.245 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7328245639801025
Epoch: 15, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.547 Vali Acc: 0.659 Test Loss: 1.547 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 41196290
model size : 171.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8244073390960693
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.1522998809814453
Epoch: 2, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2664909362792969
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7809739112854004
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7586719989776611
Epoch: 5, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3543133735656738
Epoch: 6, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.647 Vali Acc: 0.702 Test Loss: 0.647 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6292750835418701
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3407390117645264
Epoch: 8, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.729 Vali Acc: 0.712 Test Loss: 0.729 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4141480922698975
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.674 Vali Acc: 0.688 Test Loss: 0.674 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5489227771759033
Epoch: 10, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.953 Vali Acc: 0.756 Test Loss: 0.953 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1205990314483643
Epoch: 11, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.775 Vali Acc: 0.707 Test Loss: 0.775 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1266539096832275
Epoch: 12, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.292 Vali Acc: 0.717 Test Loss: 1.292 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 41134850
model size : 171.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5096652507781982
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.634 Vali Acc: 0.722 Test Loss: 0.634 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0976512432098389
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.8602757453918457
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.972602128982544
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.529 Vali Acc: 0.702 Test Loss: 0.529 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0797436237335205
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.657 Vali Acc: 0.746 Test Loss: 0.657 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.99332594871521
Epoch: 6, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8934996128082275
Epoch: 7, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1849360466003418
Epoch: 8, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.704 Vali Acc: 0.722 Test Loss: 0.704 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.121574878692627
Epoch: 9, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.668 Vali Acc: 0.707 Test Loss: 0.668 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0580458641052246
Epoch: 10, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.734 Vali Acc: 0.698 Test Loss: 0.734 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9411885738372803
Epoch: 11, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8828287124633789
Epoch: 12, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.893 Vali Acc: 0.654 Test Loss: 0.893 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8919479846954346
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.871 Vali Acc: 0.722 Test Loss: 0.871 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 41101058
model size : 171.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.534827470779419
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5028128623962402
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.540 Vali Acc: 0.756 Test Loss: 0.540 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.5560238361358643
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3419878482818604
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.589 Vali Acc: 0.698 Test Loss: 0.589 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6294269561767578
Epoch: 5, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.907 Vali Acc: 0.741 Test Loss: 0.907 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4345982074737549
Epoch: 6, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4265234470367432
Epoch: 7, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.836 Vali Acc: 0.741 Test Loss: 0.836 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.635143756866455
Epoch: 8, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.191 Vali Acc: 0.473 Test Loss: 2.191 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6520531177520752
Epoch: 9, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.816 Vali Acc: 0.668 Test Loss: 0.816 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.728029727935791
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.312 Vali Acc: 0.761 Test Loss: 1.312 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760962).  Saving model ...
Epoch: 11 cost time: 1.688450574874878
Epoch: 11, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.311 Vali Acc: 0.756 Test Loss: 1.311 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6237342357635498
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.188 Vali Acc: 0.712 Test Loss: 1.188 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7427828311920166
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.000 Vali Acc: 0.678 Test Loss: 1.000 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6860146522521973
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.118 Vali Acc: 0.727 Test Loss: 1.118 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2721996307373047
Epoch: 15, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.224 Vali Acc: 0.717 Test Loss: 1.224 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3659029006958008
Epoch: 16, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.315 Vali Acc: 0.722 Test Loss: 1.315 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4881153106689453
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.407 Vali Acc: 0.707 Test Loss: 1.407 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1752545833587646
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.337 Vali Acc: 0.678 Test Loss: 1.337 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9100062847137451
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.690 Vali Acc: 0.707 Test Loss: 1.690 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1134264469146729
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.698 Test Loss: 1.480 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 41602562
model size : 173.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5596394538879395
Epoch: 1, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.3956811428070068
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.1958599090576172
Epoch: 3, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.541 Vali Acc: 0.761 Test Loss: 0.541 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.2024972438812256
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.544 Vali Acc: 0.722 Test Loss: 0.544 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3470008373260498
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.734 Vali Acc: 0.741 Test Loss: 0.734 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2251965999603271
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.739 Vali Acc: 0.780 Test Loss: 0.739 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780480).  Saving model ...
Epoch: 7 cost time: 1.3524551391601562
Epoch: 7, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.660 Vali Acc: 0.712 Test Loss: 0.660 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3038148880004883
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.717 Vali Acc: 0.688 Test Loss: 0.717 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.911963939666748
Epoch: 9, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.917 Vali Acc: 0.746 Test Loss: 0.917 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1516950130462646
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.100 Vali Acc: 0.751 Test Loss: 1.100 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2873461246490479
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.075556993484497
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.927 Vali Acc: 0.766 Test Loss: 0.927 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2741990089416504
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.977 Vali Acc: 0.732 Test Loss: 0.977 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.242079496383667
Epoch: 14, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.025 Vali Acc: 0.756 Test Loss: 1.025 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1225619316101074
Epoch: 15, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.142 Vali Acc: 0.761 Test Loss: 1.142 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2090561389923096
Epoch: 16, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.180 Vali Acc: 0.761 Test Loss: 1.180 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 41550338
model size : 173.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6517622470855713
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9135527610778809
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.9188013076782227
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.0183422565460205
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.646 Vali Acc: 0.741 Test Loss: 0.646 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9874992370605469
Epoch: 5, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1063244342803955
Epoch: 6, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9220576286315918
Epoch: 7, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.697 Vali Acc: 0.698 Test Loss: 0.697 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.026625394821167
Epoch: 8, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.704 Vali Acc: 0.688 Test Loss: 0.704 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.031308650970459
Epoch: 9, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.739 Vali Acc: 0.683 Test Loss: 0.739 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1682965755462646
Epoch: 10, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.767 Vali Acc: 0.712 Test Loss: 0.767 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9888055324554443
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.853 Vali Acc: 0.654 Test Loss: 0.853 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0634801387786865
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.776 Vali Acc: 0.702 Test Loss: 0.776 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0044364929199219
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.877 Vali Acc: 0.693 Test Loss: 0.877 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 41519618
model size : 173.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6005301475524902
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.180922269821167
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.8355200290679932
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9247441291809082
Epoch: 4, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 0.9886200428009033
Epoch: 5, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2958738803863525
Epoch: 6, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.685 Vali Acc: 0.756 Test Loss: 0.685 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 1.2014524936676025
Epoch: 7, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.823 Vali Acc: 0.751 Test Loss: 0.823 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0138328075408936
Epoch: 8, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.774 Vali Acc: 0.712 Test Loss: 0.774 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0937721729278564
Epoch: 9, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.846 Vali Acc: 0.668 Test Loss: 0.846 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0333750247955322
Epoch: 10, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.414 Vali Acc: 0.732 Test Loss: 1.414 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1835713386535645
Epoch: 11, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.315 Vali Acc: 0.727 Test Loss: 1.315 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.897636890411377
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.120 Vali Acc: 0.693 Test Loss: 1.120 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1625008583068848
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.215 Vali Acc: 0.737 Test Loss: 1.215 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3170835971832275
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.190 Vali Acc: 0.688 Test Loss: 1.190 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0672707557678223
Epoch: 15, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.088 Vali Acc: 0.722 Test Loss: 1.088 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.147310733795166
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.963 Vali Acc: 0.702 Test Loss: 0.963 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 42155522
model size : 175.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.1764214038848877
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.7684712409973145
Epoch: 2, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 0.8552405834197998
Epoch: 3, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.585 Vali Acc: 0.712 Test Loss: 0.585 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0610918998718262
Epoch: 4, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.512 Vali Acc: 0.732 Test Loss: 0.512 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9879515171051025
Epoch: 5, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9312877655029297
Epoch: 6, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9137749671936035
Epoch: 7, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9695742130279541
Epoch: 8, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.741 Vali Acc: 0.732 Test Loss: 0.741 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.92795729637146
Epoch: 9, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.864 Vali Acc: 0.746 Test Loss: 0.864 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.904510498046875
Epoch: 10, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.690 Vali Acc: 0.688 Test Loss: 0.690 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9023728370666504
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.864 Vali Acc: 0.727 Test Loss: 0.864 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7220702171325684
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.876 Vali Acc: 0.712 Test Loss: 0.876 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 42106370
model size : 175.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.9664926528930664
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.7995765209197998
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.530 Vali Acc: 0.761 Test Loss: 0.530 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 0.8827011585235596
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8441107273101807
Epoch: 4, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.598 Vali Acc: 0.673 Test Loss: 0.598 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7274551391601562
Epoch: 5, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8292407989501953
Epoch: 6, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7520301342010498
Epoch: 7, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.633 Vali Acc: 0.683 Test Loss: 0.633 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6742446422576904
Epoch: 8, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.655 Vali Acc: 0.683 Test Loss: 0.655 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8269593715667725
Epoch: 9, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.781 Vali Acc: 0.751 Test Loss: 0.781 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8616385459899902
Epoch: 10, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.794 Vali Acc: 0.727 Test Loss: 0.794 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7831864356994629
Epoch: 11, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.980 Vali Acc: 0.722 Test Loss: 0.980 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8936407566070557
Epoch: 12, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.854 Vali Acc: 0.722 Test Loss: 0.854 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 42078722
model size : 175.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6366329193115234
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.551 Vali Acc: 0.722 Test Loss: 0.551 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.9223356246948242
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.555 Vali Acc: 0.756 Test Loss: 0.555 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2760772705078125
Epoch: 3, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.509 Vali Acc: 0.746 Test Loss: 0.509 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3158912658691406
Epoch: 4, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.666 Vali Acc: 0.678 Test Loss: 0.666 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1836481094360352
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2104294300079346
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.644 Vali Acc: 0.683 Test Loss: 0.644 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0152919292449951
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.862 Vali Acc: 0.668 Test Loss: 0.862 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.03340744972229
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.835 Vali Acc: 0.717 Test Loss: 0.835 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.24314284324646
Epoch: 9, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.921 Vali Acc: 0.663 Test Loss: 0.921 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9524891376495361
Epoch: 10, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.068 Vali Acc: 0.751 Test Loss: 1.068 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8746738433837891
Epoch: 11, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.981 Vali Acc: 0.683 Test Loss: 0.981 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2243270874023438
Epoch: 12, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.937 Vali Acc: 0.737 Test Loss: 0.937 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 42708482
model size : 177.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.50466251373291
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.0866978168487549
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.9988319873809814
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.507 Vali Acc: 0.732 Test Loss: 0.507 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1245408058166504
Epoch: 4, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.581 Vali Acc: 0.741 Test Loss: 0.581 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1180367469787598
Epoch: 5, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.579 Vali Acc: 0.707 Test Loss: 0.579 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1003139019012451
Epoch: 6, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.592 Vali Acc: 0.707 Test Loss: 0.592 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9401507377624512
Epoch: 7, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1840415000915527
Epoch: 8, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.919 Vali Acc: 0.576 Test Loss: 0.919 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9607164859771729
Epoch: 9, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.712 Vali Acc: 0.688 Test Loss: 0.712 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0503082275390625
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.179 Vali Acc: 0.771 Test Loss: 1.179 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770720).  Saving model ...
Epoch: 11 cost time: 0.7458593845367432
Epoch: 11, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.822 Vali Acc: 0.756 Test Loss: 0.822 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0793566703796387
Epoch: 12, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.961 Vali Acc: 0.741 Test Loss: 0.961 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8518075942993164
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.953 Vali Acc: 0.693 Test Loss: 0.953 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0845274925231934
Epoch: 14, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.304 Vali Acc: 0.639 Test Loss: 1.304 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0950188636779785
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.968 Vali Acc: 0.668 Test Loss: 0.968 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.326587200164795
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.870 Vali Acc: 0.688 Test Loss: 0.870 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1808366775512695
Epoch: 17, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.125 Vali Acc: 0.654 Test Loss: 1.125 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8881587982177734
Epoch: 18, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.207 Vali Acc: 0.663 Test Loss: 1.207 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1328518390655518
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.139 Vali Acc: 0.717 Test Loss: 1.139 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0488264560699463
Epoch: 20, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.159 Vali Acc: 0.629 Test Loss: 1.159 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 42662402
model size : 177.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2727222442626953
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.7362043857574463
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.9404616355895996
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8824224472045898
Epoch: 4, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.797450065612793
Epoch: 5, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.655 Vali Acc: 0.712 Test Loss: 0.655 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1701772212982178
Epoch: 6, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.616 Vali Acc: 0.702 Test Loss: 0.616 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8761284351348877
Epoch: 7, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.680 Vali Acc: 0.741 Test Loss: 0.680 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 8 cost time: 1.1171185970306396
Epoch: 8, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.846 Vali Acc: 0.751 Test Loss: 0.846 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751211).  Saving model ...
Epoch: 9 cost time: 0.9346344470977783
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.751 Vali Acc: 0.668 Test Loss: 0.751 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1190593242645264
Epoch: 10, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.857 Vali Acc: 0.688 Test Loss: 0.857 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8839709758758545
Epoch: 11, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.038 Vali Acc: 0.644 Test Loss: 1.038 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9624943733215332
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.909 Vali Acc: 0.659 Test Loss: 0.909 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0815067291259766
Epoch: 13, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.162 Vali Acc: 0.751 Test Loss: 1.162 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.137800693511963
Epoch: 14, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.241 Vali Acc: 0.727 Test Loss: 1.241 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9198663234710693
Epoch: 15, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.993 Vali Acc: 0.644 Test Loss: 0.993 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9793686866760254
Epoch: 16, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.073 Vali Acc: 0.624 Test Loss: 1.073 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2168076038360596
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.936 Vali Acc: 0.693 Test Loss: 0.936 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.062612771987915
Epoch: 18, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.034 Vali Acc: 0.683 Test Loss: 1.034 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 42640898
model size : 177.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.699117660522461
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.5188541412353516
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.669 Vali Acc: 0.751 Test Loss: 0.669 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 1.5485994815826416
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5025596618652344
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.525 Vali Acc: 0.717 Test Loss: 0.525 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.220386266708374
Epoch: 5, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.584 Vali Acc: 0.693 Test Loss: 0.584 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2223620414733887
Epoch: 6, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2567319869995117
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.620 Vali Acc: 0.756 Test Loss: 0.620 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 1.0826680660247803
Epoch: 8, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.798 Vali Acc: 0.659 Test Loss: 0.798 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0839242935180664
Epoch: 9, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.768 Vali Acc: 0.698 Test Loss: 0.768 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2499356269836426
Epoch: 10, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.006 Vali Acc: 0.644 Test Loss: 1.006 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.199697494506836
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.774 Vali Acc: 0.654 Test Loss: 0.774 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.183936357498169
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.759 Vali Acc: 0.698 Test Loss: 0.759 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3875222206115723
Epoch: 13, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.091 Vali Acc: 0.644 Test Loss: 1.091 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.41294264793396
Epoch: 14, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.800 Vali Acc: 0.727 Test Loss: 0.800 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.219019889831543
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.065 Vali Acc: 0.688 Test Loss: 1.065 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2951326370239258
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.187 Vali Acc: 0.737 Test Loss: 1.187 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3933687210083008
Epoch: 17, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.905 Vali Acc: 0.722 Test Loss: 0.905 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 43542530
model size : 180.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.609605073928833
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0420596599578857
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.1568069458007812
Epoch: 3, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 0.8873226642608643
Epoch: 4, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.1344313621520996
Epoch: 5, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1553122997283936
Epoch: 6, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.770 Vali Acc: 0.727 Test Loss: 0.770 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1016783714294434
Epoch: 7, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.635 Vali Acc: 0.712 Test Loss: 0.635 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.139014482498169
Epoch: 8, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.705 Vali Acc: 0.717 Test Loss: 0.705 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0732319355010986
Epoch: 9, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.640 Vali Acc: 0.712 Test Loss: 0.640 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.180821418762207
Epoch: 10, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.791 Vali Acc: 0.732 Test Loss: 0.791 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2350428104400635
Epoch: 11, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.871 Vali Acc: 0.727 Test Loss: 0.871 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1783146858215332
Epoch: 12, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.885 Vali Acc: 0.712 Test Loss: 0.885 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9767429828643799
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.973 Vali Acc: 0.707 Test Loss: 0.973 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1218960285186768
Epoch: 14, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.888 Vali Acc: 0.688 Test Loss: 0.888 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 43499522
model size : 180.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.541416883468628
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0135645866394043
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.9423096179962158
Epoch: 3, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.1633055210113525
Epoch: 4, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.561 Vali Acc: 0.756 Test Loss: 0.561 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.1674566268920898
Epoch: 5, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2886042594909668
Epoch: 6, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1025900840759277
Epoch: 7, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.744 Vali Acc: 0.780 Test Loss: 0.744 Test Acc: 0.780
Validation loss decreased (-0.756092 --> -0.780480).  Saving model ...
Epoch: 8 cost time: 1.2263927459716797
Epoch: 8, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2226035594940186
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.725 Vali Acc: 0.727 Test Loss: 0.725 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2847187519073486
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.709 Vali Acc: 0.746 Test Loss: 0.709 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.031677007675171
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.831 Vali Acc: 0.732 Test Loss: 0.831 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0979459285736084
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.787 Vali Acc: 0.746 Test Loss: 0.787 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1180791854858398
Epoch: 13, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.911 Vali Acc: 0.727 Test Loss: 0.911 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0186958312988281
Epoch: 14, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.972 Vali Acc: 0.673 Test Loss: 0.972 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.06718111038208
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8053300380706787
Epoch: 16, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.092 Vali Acc: 0.766 Test Loss: 1.092 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8015334606170654
Epoch: 17, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.906 Vali Acc: 0.702 Test Loss: 0.906 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 43478018
model size : 180.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9226229190826416
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.4136641025543213
Epoch: 2, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.566 Vali Acc: 0.756 Test Loss: 0.566 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.8509411811828613
Epoch: 3, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.600 Vali Acc: 0.673 Test Loss: 0.600 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8354587554931641
Epoch: 4, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5796492099761963
Epoch: 5, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6146113872528076
Epoch: 6, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.747 Vali Acc: 0.741 Test Loss: 0.747 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3975186347961426
Epoch: 7, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.069 Vali Acc: 0.727 Test Loss: 1.069 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5654041767120361
Epoch: 8, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5868151187896729
Epoch: 9, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.970 Vali Acc: 0.761 Test Loss: 0.970 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760966).  Saving model ...
Epoch: 10 cost time: 1.4988598823547363
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.419 Vali Acc: 0.751 Test Loss: 1.419 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.36419677734375
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.085 Vali Acc: 0.605 Test Loss: 1.085 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5361204147338867
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.186 Vali Acc: 0.702 Test Loss: 1.186 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5878887176513672
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.165 Vali Acc: 0.712 Test Loss: 1.165 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3982782363891602
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.348 Vali Acc: 0.751 Test Loss: 1.348 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6061158180236816
Epoch: 15, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.200 Vali Acc: 0.756 Test Loss: 1.200 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8398644924163818
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.466 Vali Acc: 0.751 Test Loss: 1.466 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8789374828338623
Epoch: 17, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.116 Vali Acc: 0.727 Test Loss: 1.116 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4830901622772217
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.539 Vali Acc: 0.741 Test Loss: 1.539 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4288551807403564
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.478 Vali Acc: 0.737 Test Loss: 1.478 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 44514050
model size : 184.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.0249691009521484
Epoch: 1, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.556 Vali Acc: 0.717 Test Loss: 0.556 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.1212794780731201
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.522 Vali Acc: 0.751 Test Loss: 0.522 Test Acc: 0.751
Validation loss decreased (-0.717068 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.2029695510864258
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2599856853485107
Epoch: 4, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.520 Vali Acc: 0.712 Test Loss: 0.520 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.291532039642334
Epoch: 5, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.223586082458496
Epoch: 6, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2050411701202393
Epoch: 7, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3072288036346436
Epoch: 8, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.025 Vali Acc: 0.746 Test Loss: 1.025 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2822377681732178
Epoch: 9, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.848 Vali Acc: 0.620 Test Loss: 0.848 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0687823295593262
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.815 Vali Acc: 0.727 Test Loss: 0.815 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0613696575164795
Epoch: 11, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.903 Vali Acc: 0.712 Test Loss: 0.903 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3837080001831055
Epoch: 12, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 44477186
model size : 184.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7750208377838135
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.101379632949829
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9976317882537842
Epoch: 3, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.542 Vali Acc: 0.756 Test Loss: 0.542 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.2793619632720947
Epoch: 4, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.186481237411499
Epoch: 5, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.628 Vali Acc: 0.707 Test Loss: 0.628 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2553019523620605
Epoch: 6, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.644 Vali Acc: 0.702 Test Loss: 0.644 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1996817588806152
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.637 Vali Acc: 0.732 Test Loss: 0.637 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1972742080688477
Epoch: 8, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.691 Vali Acc: 0.673 Test Loss: 0.691 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2592477798461914
Epoch: 9, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.863 Vali Acc: 0.746 Test Loss: 0.863 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2260279655456543
Epoch: 10, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.764 Vali Acc: 0.771 Test Loss: 0.764 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770724).  Saving model ...
Epoch: 11 cost time: 1.2076797485351562
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.856 Vali Acc: 0.771 Test Loss: 0.856 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1767911911010742
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.888 Vali Acc: 0.771 Test Loss: 0.888 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1495866775512695
Epoch: 13, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.933 Vali Acc: 0.771 Test Loss: 0.933 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1586802005767822
Epoch: 14, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.201 Vali Acc: 0.771 Test Loss: 1.201 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.180222511291504
Epoch: 15, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.846 Vali Acc: 0.712 Test Loss: 0.846 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.212432861328125
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.884 Vali Acc: 0.693 Test Loss: 0.884 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1573748588562012
Epoch: 17, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.909 Vali Acc: 0.717 Test Loss: 0.909 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.151237964630127
Epoch: 18, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.102 Vali Acc: 0.766 Test Loss: 1.102 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.155965805053711
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.020 Vali Acc: 0.732 Test Loss: 1.020 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1377575397491455
Epoch: 20, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.225 Vali Acc: 0.756 Test Loss: 1.225 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 44458754
model size : 184.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9218811988830566
Epoch: 1, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.6866238117218018
Epoch: 2, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.515 Vali Acc: 0.746 Test Loss: 0.515 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.5969853401184082
Epoch: 3, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760971).  Saving model ...
Epoch: 4 cost time: 1.5414705276489258
Epoch: 4, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5944085121154785
Epoch: 5, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.901 Vali Acc: 0.737 Test Loss: 0.901 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.614628791809082
Epoch: 6, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.757 Vali Acc: 0.737 Test Loss: 0.757 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5718348026275635
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.671 Vali Acc: 0.746 Test Loss: 0.671 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5616412162780762
Epoch: 8, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.909 Vali Acc: 0.722 Test Loss: 0.909 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5439929962158203
Epoch: 9, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.960 Vali Acc: 0.741 Test Loss: 0.960 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6328787803649902
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.850 Vali Acc: 0.639 Test Loss: 0.850 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2821662425994873
Epoch: 11, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.911 Vali Acc: 0.727 Test Loss: 0.911 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.529515266418457
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.911 Vali Acc: 0.663 Test Loss: 0.911 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.377211093902588
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.994 Vali Acc: 0.698 Test Loss: 0.994 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 45907202
model size : 189.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9466631412506104
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1910829544067383
Epoch: 2, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.1603748798370361
Epoch: 3, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.522 Vali Acc: 0.732 Test Loss: 0.522 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2821331024169922
Epoch: 4, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.318640947341919
Epoch: 5, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.861 Vali Acc: 0.771 Test Loss: 0.861 Test Acc: 0.771
Validation loss decreased (-0.741458 --> -0.770723).  Saving model ...
Epoch: 6 cost time: 1.2642736434936523
Epoch: 6, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.874 Vali Acc: 0.766 Test Loss: 0.874 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3254742622375488
Epoch: 7, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.976 Vali Acc: 0.751 Test Loss: 0.976 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0974349975585938
Epoch: 8, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2476742267608643
Epoch: 9, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.828 Vali Acc: 0.751 Test Loss: 0.828 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2199299335479736
Epoch: 10, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.774 Vali Acc: 0.663 Test Loss: 0.774 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1829984188079834
Epoch: 11, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.975 Vali Acc: 0.741 Test Loss: 0.975 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2492997646331787
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.988 Vali Acc: 0.688 Test Loss: 0.988 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2105343341827393
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.900 Vali Acc: 0.673 Test Loss: 0.900 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2422387599945068
Epoch: 14, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.284 Vali Acc: 0.746 Test Loss: 1.284 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2417428493499756
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.983 Vali Acc: 0.654 Test Loss: 0.983 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 45876482
model size : 189.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.645806312561035
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.8751592636108398
Epoch: 2, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
Validation loss decreased (-0.717068 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.1642322540283203
Epoch: 3, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.510 Vali Acc: 0.722 Test Loss: 0.510 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2275612354278564
Epoch: 4, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2469170093536377
Epoch: 5, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.597 Vali Acc: 0.673 Test Loss: 0.597 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0579445362091064
Epoch: 6, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.698 Vali Acc: 0.707 Test Loss: 0.698 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9416768550872803
Epoch: 7, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.731 Vali Acc: 0.712 Test Loss: 0.731 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8769862651824951
Epoch: 8, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.831 Vali Acc: 0.702 Test Loss: 0.831 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1148419380187988
Epoch: 9, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.934 Vali Acc: 0.702 Test Loss: 0.934 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2521886825561523
Epoch: 10, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.877 Vali Acc: 0.737 Test Loss: 0.877 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2530324459075928
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.871 Vali Acc: 0.717 Test Loss: 0.871 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.193718671798706
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.989 Vali Acc: 0.741 Test Loss: 0.989 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 45861122
model size : 189.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps81_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.922673463821411
Epoch: 1, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.5056955814361572
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.607 Vali Acc: 0.771 Test Loss: 0.607 Test Acc: 0.771
Validation loss decreased (-0.726824 --> -0.770726).  Saving model ...
Epoch: 3 cost time: 0.9402074813842773
Epoch: 3, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5204524993896484
Epoch: 4, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5334479808807373
Epoch: 5, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.626 Vali Acc: 0.717 Test Loss: 0.626 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.726433277130127
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.666 Vali Acc: 0.663 Test Loss: 0.666 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6872150897979736
Epoch: 7, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.686 Vali Acc: 0.693 Test Loss: 0.686 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.449568510055542
Epoch: 8, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.789 Vali Acc: 0.712 Test Loss: 0.789 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.723175287246704
Epoch: 9, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.746 Vali Acc: 0.727 Test Loss: 0.746 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3827705383300781
Epoch: 10, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.759 Vali Acc: 0.712 Test Loss: 0.759 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6277029514312744
Epoch: 11, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.902 Vali Acc: 0.746 Test Loss: 0.902 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4977364540100098
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.043 Vali Acc: 0.756 Test Loss: 1.043 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps81_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 47721986
model size : 196.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8981921672821045
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2898545265197754
Epoch: 2, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.206127405166626
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.630 Vali Acc: 0.732 Test Loss: 0.630 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4995055198669434
Epoch: 4, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.549 Vali Acc: 0.707 Test Loss: 0.549 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3694822788238525
Epoch: 5, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.599 Vali Acc: 0.688 Test Loss: 0.599 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3856098651885986
Epoch: 6, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.119 Vali Acc: 0.737 Test Loss: 1.119 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4963254928588867
Epoch: 7, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.646 Vali Acc: 0.693 Test Loss: 0.646 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4314815998077393
Epoch: 8, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.657 Vali Acc: 0.732 Test Loss: 0.657 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.396735429763794
Epoch: 9, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.368438720703125
Epoch: 10, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.885 Vali Acc: 0.761 Test Loss: 0.885 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760967).  Saving model ...
Epoch: 11 cost time: 1.4236817359924316
Epoch: 11, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.033 Vali Acc: 0.746 Test Loss: 1.033 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2710933685302734
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.861 Vali Acc: 0.688 Test Loss: 0.861 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4824862480163574
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.928 Vali Acc: 0.683 Test Loss: 0.928 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3639683723449707
Epoch: 14, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.213 Vali Acc: 0.741 Test Loss: 1.213 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4465854167938232
Epoch: 15, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.185 Vali Acc: 0.717 Test Loss: 1.185 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4258513450622559
Epoch: 16, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.054 Vali Acc: 0.702 Test Loss: 1.054 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9417953491210938
Epoch: 17, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.280 Vali Acc: 0.732 Test Loss: 1.280 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5417981147766113
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.161 Vali Acc: 0.698 Test Loss: 1.161 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3776073455810547
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.318 Vali Acc: 0.717 Test Loss: 1.318 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4478247165679932
Epoch: 20, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.108 Vali Acc: 0.668 Test Loss: 1.108 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 47697410
model size : 196.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps81_str81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.019256591796875
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.3967318534851074
Epoch: 2, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2076148986816406
Epoch: 3, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.601 Vali Acc: 0.756 Test Loss: 0.601 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3642702102661133
Epoch: 4, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.4121615886688232
Epoch: 5, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1589243412017822
Epoch: 6, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.717 Vali Acc: 0.746 Test Loss: 0.717 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3811824321746826
Epoch: 7, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.900 Vali Acc: 0.761 Test Loss: 0.900 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3241970539093018
Epoch: 8, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.914 Vali Acc: 0.746 Test Loss: 0.914 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4882304668426514
Epoch: 9, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.783 Vali Acc: 0.751 Test Loss: 0.783 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3379623889923096
Epoch: 10, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.899 Vali Acc: 0.761 Test Loss: 0.899 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3878777027130127
Epoch: 11, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.138 Vali Acc: 0.766 Test Loss: 1.138 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765842).  Saving model ...
Epoch: 12 cost time: 1.3222088813781738
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.982 Vali Acc: 0.766 Test Loss: 0.982 Test Acc: 0.766
Validation loss decreased (-0.765842 --> -0.765844).  Saving model ...
Epoch: 13 cost time: 1.4720797538757324
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.908 Vali Acc: 0.683 Test Loss: 0.908 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4454982280731201
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.079 Vali Acc: 0.737 Test Loss: 1.079 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4126744270324707
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.094 Vali Acc: 0.707 Test Loss: 1.094 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4068901538848877
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.205 Vali Acc: 0.751 Test Loss: 1.205 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4389419555664062
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.144 Vali Acc: 0.712 Test Loss: 1.144 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3342607021331787
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.195 Vali Acc: 0.707 Test Loss: 1.195 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3531866073608398
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.022 Vali Acc: 0.663 Test Loss: 1.022 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3798766136169434
Epoch: 20, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.234 Vali Acc: 0.751 Test Loss: 1.234 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4646875858306885
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.121 Vali Acc: 0.688 Test Loss: 1.121 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4267935752868652
Epoch: 22, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.175 Vali Acc: 0.659 Test Loss: 1.175 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el5_dm768_df768_ps81_str81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 47688194
model size : 196.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8941800594329834
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.5567045211791992
Epoch: 2, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.674 Vali Acc: 0.600 Test Loss: 0.674 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4689748287200928
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.583 Vali Acc: 0.707 Test Loss: 0.583 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.566547155380249
Epoch: 4, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.3960282802581787
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.692 Vali Acc: 0.751 Test Loss: 0.692 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3685040473937988
Epoch: 6, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.593291997909546
Epoch: 7, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.647141933441162
Epoch: 8, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.479 Vali Acc: 0.639 Test Loss: 1.479 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3255650997161865
Epoch: 9, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.047 Vali Acc: 0.688 Test Loss: 1.047 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5841271877288818
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.239 Vali Acc: 0.688 Test Loss: 1.239 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3892579078674316
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.532 Vali Acc: 0.649 Test Loss: 1.532 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4493000507354736
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.576 Vali Acc: 0.644 Test Loss: 1.576 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5721409320831299
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.727 Vali Acc: 0.683 Test Loss: 1.727 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5340876579284668
Epoch: 14, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.833 Vali Acc: 0.693 Test Loss: 1.833 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 31829762
model size : 136.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8260083198547363
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1834847927093506
Epoch: 2, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.371530532836914
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.1027581691741943
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.512 Vali Acc: 0.746 Test Loss: 0.512 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.347597599029541
Epoch: 5, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2763760089874268
Epoch: 6, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3440120220184326
Epoch: 7, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.801 Vali Acc: 0.722 Test Loss: 0.801 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1933746337890625
Epoch: 8, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.739 Vali Acc: 0.693 Test Loss: 0.739 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8005967140197754
Epoch: 9, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.935 Vali Acc: 0.683 Test Loss: 0.935 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4040122032165527
Epoch: 10, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.095 Vali Acc: 0.683 Test Loss: 1.095 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4175009727478027
Epoch: 11, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.137 Vali Acc: 0.683 Test Loss: 1.137 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1212706565856934
Epoch: 12, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.367 Vali Acc: 0.732 Test Loss: 1.367 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9619550704956055
Epoch: 13, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.603 Vali Acc: 0.605 Test Loss: 1.603 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 31725314
model size : 135.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3809690475463867
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0024325847625732
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.065659999847412
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 0.8938412666320801
Epoch: 4, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760971).  Saving model ...
Epoch: 5 cost time: 0.7774670124053955
Epoch: 5, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.616 Vali Acc: 0.654 Test Loss: 0.616 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7550697326660156
Epoch: 6, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6306331157684326
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9863018989562988
Epoch: 8, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.783 Vali Acc: 0.751 Test Loss: 0.783 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9343788623809814
Epoch: 9, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.635 Vali Acc: 0.756 Test Loss: 0.635 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0192925930023193
Epoch: 10, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.828 Vali Acc: 0.741 Test Loss: 0.828 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0421442985534668
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.835 Vali Acc: 0.673 Test Loss: 0.835 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7837679386138916
Epoch: 12, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.691 Vali Acc: 0.727 Test Loss: 0.691 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0285053253173828
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.889 Vali Acc: 0.746 Test Loss: 0.889 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9507491588592529
Epoch: 14, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.839 Vali Acc: 0.702 Test Loss: 0.839 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 31660802
model size : 135.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.714808225631714
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.4910633563995361
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.604 Vali Acc: 0.727 Test Loss: 0.604 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.5863189697265625
Epoch: 3, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
Validation loss decreased (-0.726823 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.1400971412658691
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760971).  Saving model ...
Epoch: 5 cost time: 1.3861708641052246
Epoch: 5, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3976061344146729
Epoch: 6, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.121 Vali Acc: 0.766 Test Loss: 1.121 Test Acc: 0.766
Validation loss decreased (-0.760971 --> -0.765842).  Saving model ...
Epoch: 7 cost time: 1.338428258895874
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.679 Vali Acc: 0.707 Test Loss: 0.679 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4325835704803467
Epoch: 8, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.804 Vali Acc: 0.693 Test Loss: 0.804 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3434960842132568
Epoch: 9, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.271 Vali Acc: 0.639 Test Loss: 1.271 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.48966383934021
Epoch: 10, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.971 Vali Acc: 0.751 Test Loss: 0.971 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3485784530639648
Epoch: 11, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.018 Vali Acc: 0.707 Test Loss: 1.018 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.565244436264038
Epoch: 12, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.187 Vali Acc: 0.727 Test Loss: 1.187 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.268157720565796
Epoch: 13, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.149 Vali Acc: 0.678 Test Loss: 1.149 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.455010175704956
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.358 Vali Acc: 0.717 Test Loss: 1.358 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3590664863586426
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.520 Vali Acc: 0.702 Test Loss: 1.520 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2694804668426514
Epoch: 16, Steps: 13 | Train Loss: 0.061 Vali Loss: 2.085 Vali Acc: 0.610 Test Loss: 2.085 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 31970306
model size : 136.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.0620975494384766
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2071046829223633
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.561 Vali Acc: 0.707 Test Loss: 0.561 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7517836093902588
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
Validation loss decreased (-0.717067 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.7140259742736816
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7174355983734131
Epoch: 5, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.622 Vali Acc: 0.741 Test Loss: 0.622 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7550516128540039
Epoch: 6, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6936063766479492
Epoch: 7, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.658 Vali Acc: 0.727 Test Loss: 0.658 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8245491981506348
Epoch: 8, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.024 Vali Acc: 0.722 Test Loss: 1.024 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.141007900238037
Epoch: 9, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.757 Vali Acc: 0.693 Test Loss: 0.757 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1232736110687256
Epoch: 10, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0240933895111084
Epoch: 11, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.125 Vali Acc: 0.629 Test Loss: 1.125 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2751433849334717
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.463 Vali Acc: 0.610 Test Loss: 1.463 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1127691268920898
Epoch: 13, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.132 Vali Acc: 0.737 Test Loss: 1.132 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 31865858
model size : 136.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2335236072540283
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9003522396087646
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.548 Vali Acc: 0.717 Test Loss: 0.548 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0730295181274414
Epoch: 3, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9955134391784668
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.509 Vali Acc: 0.712 Test Loss: 0.509 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1140265464782715
Epoch: 5, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.583 Vali Acc: 0.766 Test Loss: 0.583 Test Acc: 0.766
Validation loss decreased (-0.721945 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 0.9931728839874268
Epoch: 6, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.551 Vali Acc: 0.712 Test Loss: 0.551 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7741851806640625
Epoch: 7, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9199037551879883
Epoch: 8, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.871 Vali Acc: 0.576 Test Loss: 0.871 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.942227840423584
Epoch: 9, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.875 Vali Acc: 0.610 Test Loss: 0.875 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0823678970336914
Epoch: 10, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.727 Vali Acc: 0.732 Test Loss: 0.727 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0917470455169678
Epoch: 11, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.720 Vali Acc: 0.707 Test Loss: 0.720 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1078720092773438
Epoch: 12, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.944 Vali Acc: 0.737 Test Loss: 0.944 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1772305965423584
Epoch: 13, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.834 Vali Acc: 0.712 Test Loss: 0.834 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8726601600646973
Epoch: 14, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.929 Vali Acc: 0.732 Test Loss: 0.929 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9246175289154053
Epoch: 15, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.244 Vali Acc: 0.746 Test Loss: 1.244 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 31798274
model size : 135.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7477800846099854
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.4172861576080322
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.526 Vali Acc: 0.751 Test Loss: 0.526 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.5171473026275635
Epoch: 3, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.625 Vali Acc: 0.683 Test Loss: 0.625 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4307777881622314
Epoch: 4, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.607 Vali Acc: 0.683 Test Loss: 0.607 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4738173484802246
Epoch: 5, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.719 Vali Acc: 0.634 Test Loss: 0.719 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4672625064849854
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.647 Vali Acc: 0.683 Test Loss: 0.647 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.446767807006836
Epoch: 7, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.156 Vali Acc: 0.712 Test Loss: 1.156 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2855513095855713
Epoch: 8, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.978 Vali Acc: 0.698 Test Loss: 0.978 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2811634540557861
Epoch: 9, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.921 Vali Acc: 0.732 Test Loss: 0.921 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2345011234283447
Epoch: 10, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.969 Vali Acc: 0.663 Test Loss: 0.969 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5248517990112305
Epoch: 11, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.686 Vali Acc: 0.605 Test Loss: 1.686 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3480370044708252
Epoch: 12, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.118 Vali Acc: 0.668 Test Loss: 1.118 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 32110850
model size : 137.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5393612384796143
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.2528107166290283
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.553 Vali Acc: 0.751 Test Loss: 0.553 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.0348961353302002
Epoch: 3, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.506 Vali Acc: 0.771 Test Loss: 0.506 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770727).  Saving model ...
Epoch: 4 cost time: 1.125624179840088
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.589 Vali Acc: 0.771 Test Loss: 0.589 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1054563522338867
Epoch: 5, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3147265911102295
Epoch: 6, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.192 Vali Acc: 0.532 Test Loss: 1.192 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9130959510803223
Epoch: 7, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9788036346435547
Epoch: 8, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8645403385162354
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.688 Vali Acc: 0.678 Test Loss: 0.688 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0722839832305908
Epoch: 10, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.848 Vali Acc: 0.741 Test Loss: 0.848 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9964697360992432
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.919 Vali Acc: 0.707 Test Loss: 0.919 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.277247667312622
Epoch: 12, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.028 Vali Acc: 0.698 Test Loss: 1.028 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.036271572113037
Epoch: 13, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.161 Vali Acc: 0.751 Test Loss: 1.161 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 31991042
model size : 136.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.423640489578247
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8983101844787598
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.0977611541748047
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.9337975978851318
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.510 Vali Acc: 0.741 Test Loss: 0.510 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0926778316497803
Epoch: 5, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.525 Vali Acc: 0.727 Test Loss: 0.525 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0567083358764648
Epoch: 6, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 1.0219712257385254
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.777 Vali Acc: 0.751 Test Loss: 0.777 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0990650653839111
Epoch: 8, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.768 Vali Acc: 0.756 Test Loss: 0.768 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9536263942718506
Epoch: 9, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.786 Vali Acc: 0.668 Test Loss: 0.786 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1147677898406982
Epoch: 10, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.649 Vali Acc: 0.727 Test Loss: 0.649 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8950226306915283
Epoch: 11, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.762 Vali Acc: 0.707 Test Loss: 0.762 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.246563196182251
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.998 Vali Acc: 0.712 Test Loss: 0.998 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8752191066741943
Epoch: 13, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.882 Vali Acc: 0.746 Test Loss: 0.882 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.146087646484375
Epoch: 14, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.082 Vali Acc: 0.727 Test Loss: 1.082 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.250558853149414
Epoch: 15, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.033 Vali Acc: 0.707 Test Loss: 1.033 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.102156162261963
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.965 Vali Acc: 0.683 Test Loss: 0.965 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 31935746
model size : 136.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9451870918273926
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5730276107788086
Epoch: 2, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.5300030708312988
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.494 Vali Acc: 0.766 Test Loss: 0.494 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 1.6106376647949219
Epoch: 4, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.635 Vali Acc: 0.741 Test Loss: 0.635 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6272661685943604
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.623 Vali Acc: 0.761 Test Loss: 0.623 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4795432090759277
Epoch: 6, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.665 Vali Acc: 0.707 Test Loss: 0.665 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6477601528167725
Epoch: 7, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.916 Vali Acc: 0.771 Test Loss: 0.916 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770723).  Saving model ...
Epoch: 8 cost time: 1.5092625617980957
Epoch: 8, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.937 Vali Acc: 0.746 Test Loss: 0.937 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.688215970993042
Epoch: 9, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.333 Vali Acc: 0.444 Test Loss: 1.333 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7183797359466553
Epoch: 10, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.920 Vali Acc: 0.712 Test Loss: 0.920 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.588416576385498
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.076 Vali Acc: 0.751 Test Loss: 1.076 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.557770013809204
Epoch: 12, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.321 Vali Acc: 0.698 Test Loss: 1.321 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7233397960662842
Epoch: 13, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.127 Vali Acc: 0.673 Test Loss: 1.127 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4790706634521484
Epoch: 14, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.397 Vali Acc: 0.683 Test Loss: 1.397 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6240410804748535
Epoch: 15, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.396 Vali Acc: 0.678 Test Loss: 1.396 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5612690448760986
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.903 Vali Acc: 0.702 Test Loss: 1.903 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.638852834701538
Epoch: 17, Steps: 13 | Train Loss: 0.043 Vali Loss: 2.579 Vali Acc: 0.722 Test Loss: 2.579 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 32251394
model size : 137.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.698517084121704
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.562 Vali Acc: 0.741 Test Loss: 0.562 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 0.9075849056243896
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.531 Vali Acc: 0.737 Test Loss: 0.531 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2740495204925537
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.546 Vali Acc: 0.693 Test Loss: 0.546 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1997499465942383
Epoch: 4, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.145451545715332
Epoch: 5, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 1.0918586254119873
Epoch: 6, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1689550876617432
Epoch: 7, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.778 Vali Acc: 0.751 Test Loss: 0.778 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751212).  Saving model ...
Epoch: 8 cost time: 1.047034740447998
Epoch: 8, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0577828884124756
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.982 Vali Acc: 0.707 Test Loss: 0.982 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1575047969818115
Epoch: 10, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.017 Vali Acc: 0.698 Test Loss: 1.017 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9777750968933105
Epoch: 11, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.003 Vali Acc: 0.683 Test Loss: 1.003 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1533594131469727
Epoch: 12, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.750 Vali Acc: 0.751 Test Loss: 1.750 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9316596984863281
Epoch: 13, Steps: 13 | Train Loss: 0.170 Vali Loss: 2.554 Vali Acc: 0.420 Test Loss: 2.554 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0612361431121826
Epoch: 14, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.954 Vali Acc: 0.702 Test Loss: 0.954 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2219560146331787
Epoch: 15, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.083 Vali Acc: 0.639 Test Loss: 1.083 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1568818092346191
Epoch: 16, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.580 Vali Acc: 0.717 Test Loss: 1.580 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8211534023284912
Epoch: 17, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.381 Vali Acc: 0.707 Test Loss: 1.381 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 32131586
model size : 137.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3235459327697754
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.6908776760101318
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.8491542339324951
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7775752544403076
Epoch: 4, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.942 Vali Acc: 0.732 Test Loss: 0.942 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8004550933837891
Epoch: 5, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8184716701507568
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.530 Vali Acc: 0.746 Test Loss: 0.530 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.020155906677246
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.780 Vali Acc: 0.727 Test Loss: 0.780 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8658149242401123
Epoch: 8, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.662 Vali Acc: 0.722 Test Loss: 0.662 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6483349800109863
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.761 Vali Acc: 0.707 Test Loss: 0.761 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7880904674530029
Epoch: 10, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.116 Vali Acc: 0.741 Test Loss: 1.116 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8864717483520508
Epoch: 11, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.969 Vali Acc: 0.688 Test Loss: 0.969 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9860653877258301
Epoch: 12, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.944 Vali Acc: 0.698 Test Loss: 0.944 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.96343994140625
Epoch: 13, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.028 Vali Acc: 0.639 Test Loss: 1.028 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8491015434265137
Epoch: 14, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.952 Vali Acc: 0.693 Test Loss: 0.952 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8196287155151367
Epoch: 15, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.059 Vali Acc: 0.678 Test Loss: 1.059 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9254703521728516
Epoch: 16, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.979 Vali Acc: 0.707 Test Loss: 0.979 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 32073218
model size : 137.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6877715587615967
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.703 Vali Acc: 0.488 Test Loss: 0.703 Test Acc: 0.488
Validation loss decreased (inf --> -0.487798).  Saving model ...
Epoch: 2 cost time: 0.9558334350585938
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
Validation loss decreased (-0.487798 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.3435263633728027
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.536 Vali Acc: 0.732 Test Loss: 0.536 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.374910831451416
Epoch: 4, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.588 Vali Acc: 0.741 Test Loss: 0.588 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4725096225738525
Epoch: 5, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.882 Vali Acc: 0.737 Test Loss: 0.882 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4327826499938965
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.649 Vali Acc: 0.693 Test Loss: 0.649 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3057100772857666
Epoch: 7, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.832 Vali Acc: 0.737 Test Loss: 0.832 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1644353866577148
Epoch: 8, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.840 Vali Acc: 0.668 Test Loss: 0.840 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5026562213897705
Epoch: 9, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.322 Vali Acc: 0.571 Test Loss: 1.322 Test Acc: 0.571
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3599658012390137
Epoch: 10, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.047 Vali Acc: 0.698 Test Loss: 1.047 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4504904747009277
Epoch: 11, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.999 Vali Acc: 0.678 Test Loss: 0.999 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.382690191268921
Epoch: 12, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.324 Vali Acc: 0.707 Test Loss: 1.324 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 32352002
model size : 138.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.775277853012085
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 0.9771463871002197
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.9487082958221436
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.0031068325042725
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.581 Vali Acc: 0.741 Test Loss: 0.581 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9234347343444824
Epoch: 5, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.744 Vali Acc: 0.746 Test Loss: 0.744 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9213833808898926
Epoch: 6, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.136176586151123
Epoch: 7, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.743 Vali Acc: 0.712 Test Loss: 0.743 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.860741376876831
Epoch: 8, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.914 Vali Acc: 0.741 Test Loss: 0.914 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.12837553024292
Epoch: 9, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.954 Vali Acc: 0.698 Test Loss: 0.954 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0318517684936523
Epoch: 10, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.190 Vali Acc: 0.707 Test Loss: 1.190 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9494943618774414
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.148 Vali Acc: 0.678 Test Loss: 1.148 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8679897785186768
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.652 Vali Acc: 0.732 Test Loss: 1.652 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0560054779052734
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.232 Vali Acc: 0.663 Test Loss: 1.232 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 32259842
model size : 137.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.564127206802368
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.585 Vali Acc: 0.712 Test Loss: 0.585 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.7360317707061768
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.035107135772705
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.509 Vali Acc: 0.761 Test Loss: 0.509 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760971).  Saving model ...
Epoch: 4 cost time: 0.7436842918395996
Epoch: 4, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.508 Vali Acc: 0.727 Test Loss: 0.508 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8646974563598633
Epoch: 5, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.546 Vali Acc: 0.702 Test Loss: 0.546 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7990126609802246
Epoch: 6, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.714 Vali Acc: 0.756 Test Loss: 0.714 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9508225917816162
Epoch: 7, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7156119346618652
Epoch: 8, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.713 Vali Acc: 0.771 Test Loss: 0.713 Test Acc: 0.771
Validation loss decreased (-0.760971 --> -0.770725).  Saving model ...
Epoch: 9 cost time: 0.8478143215179443
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.680 Vali Acc: 0.737 Test Loss: 0.680 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8940441608428955
Epoch: 10, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.009 Vali Acc: 0.746 Test Loss: 1.009 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8097066879272461
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.812 Vali Acc: 0.751 Test Loss: 0.812 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8413901329040527
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.920 Vali Acc: 0.741 Test Loss: 0.920 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9341402053833008
Epoch: 13, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.251 Vali Acc: 0.751 Test Loss: 1.251 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8679335117340088
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.192 Vali Acc: 0.741 Test Loss: 1.192 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6960601806640625
Epoch: 15, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.194 Vali Acc: 0.741 Test Loss: 1.194 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7250733375549316
Epoch: 16, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.984 Vali Acc: 0.702 Test Loss: 0.984 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6044847965240479
Epoch: 17, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.131 Vali Acc: 0.673 Test Loss: 1.131 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6425342559814453
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.403 Vali Acc: 0.761 Test Loss: 1.403 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 32210690
model size : 137.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9366862773895264
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.265885353088379
Epoch: 2, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.252274990081787
Epoch: 3, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.552 Vali Acc: 0.751 Test Loss: 0.552 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4238193035125732
Epoch: 4, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.686 Vali Acc: 0.727 Test Loss: 0.686 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.295323133468628
Epoch: 5, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.801 Vali Acc: 0.756 Test Loss: 0.801 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756090).  Saving model ...
Epoch: 6 cost time: 1.2051846981048584
Epoch: 6, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.825 Vali Acc: 0.766 Test Loss: 0.825 Test Acc: 0.766
Validation loss decreased (-0.756090 --> -0.765845).  Saving model ...
Epoch: 7 cost time: 1.2444236278533936
Epoch: 7, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.687 Vali Acc: 0.702 Test Loss: 0.687 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3505501747131348
Epoch: 8, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.800 Vali Acc: 0.702 Test Loss: 0.800 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3202354907989502
Epoch: 9, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.024 Vali Acc: 0.717 Test Loss: 1.024 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4246454238891602
Epoch: 10, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.957 Vali Acc: 0.712 Test Loss: 0.957 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2142219543457031
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.196 Vali Acc: 0.717 Test Loss: 1.196 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.230802297592163
Epoch: 12, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.296 Vali Acc: 0.707 Test Loss: 1.296 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2474794387817383
Epoch: 13, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.265 Vali Acc: 0.668 Test Loss: 1.265 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3759448528289795
Epoch: 14, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.590 Vali Acc: 0.590 Test Loss: 1.590 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3316490650177002
Epoch: 15, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.221 Vali Acc: 0.668 Test Loss: 1.221 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2767813205718994
Epoch: 16, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.597 Vali Acc: 0.585 Test Loss: 1.597 Test Acc: 0.585
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 32489474
model size : 138.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.348886489868164
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8497495651245117
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.8575441837310791
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.617 Vali Acc: 0.771 Test Loss: 0.617 Test Acc: 0.771
Validation loss decreased (-0.741458 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 1.0253911018371582
Epoch: 4, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.512 Vali Acc: 0.756 Test Loss: 0.512 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0237276554107666
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.660 Vali Acc: 0.629 Test Loss: 0.660 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.901465654373169
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.594 Vali Acc: 0.683 Test Loss: 0.594 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0713884830474854
Epoch: 7, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.627 Vali Acc: 0.727 Test Loss: 0.627 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2033498287200928
Epoch: 8, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.757 Vali Acc: 0.737 Test Loss: 0.757 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.704214334487915
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.821 Vali Acc: 0.634 Test Loss: 0.821 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0487568378448486
Epoch: 10, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.014 Vali Acc: 0.707 Test Loss: 1.014 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0712687969207764
Epoch: 11, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.059 Vali Acc: 0.741 Test Loss: 1.059 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8867130279541016
Epoch: 12, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.065 Vali Acc: 0.717 Test Loss: 1.065 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0182294845581055
Epoch: 13, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.147 Vali Acc: 0.746 Test Loss: 1.147 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 32400386
model size : 138.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.1516096591949463
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8620903491973877
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.8927292823791504
Epoch: 3, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.938413143157959
Epoch: 4, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.555 Vali Acc: 0.766 Test Loss: 0.555 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 0.6536762714385986
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.520 Vali Acc: 0.751 Test Loss: 0.520 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6221623420715332
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.625 Vali Acc: 0.693 Test Loss: 0.625 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6283977031707764
Epoch: 7, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.70754075050354
Epoch: 8, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7375497817993164
Epoch: 9, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.707 Vali Acc: 0.693 Test Loss: 0.707 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6351900100708008
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7818055152893066
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.816 Vali Acc: 0.722 Test Loss: 0.816 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1307804584503174
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.828 Vali Acc: 0.732 Test Loss: 0.828 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0135643482208252
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.463 Vali Acc: 0.761 Test Loss: 1.463 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9799926280975342
Epoch: 14, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.903 Vali Acc: 0.727 Test Loss: 0.903 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 32348162
model size : 138.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1583755016326904
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.1303424835205078
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.523 Vali Acc: 0.766 Test Loss: 0.523 Test Acc: 0.766
Validation loss decreased (-0.731701 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 1.298579454421997
Epoch: 3, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6310174465179443
Epoch: 4, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5946838855743408
Epoch: 5, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5600721836090088
Epoch: 6, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.657 Vali Acc: 0.732 Test Loss: 0.657 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4764504432678223
Epoch: 7, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.967 Vali Acc: 0.741 Test Loss: 0.967 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3786163330078125
Epoch: 8, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.822 Vali Acc: 0.732 Test Loss: 0.822 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3880579471588135
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.948 Vali Acc: 0.693 Test Loss: 0.948 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3746113777160645
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.117 Vali Acc: 0.737 Test Loss: 1.117 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4411232471466064
Epoch: 11, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.180 Vali Acc: 0.741 Test Loss: 1.180 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4945480823516846
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.046 Vali Acc: 0.712 Test Loss: 1.046 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 32630018
model size : 139.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3053860664367676
Epoch: 1, Steps: 13 | Train Loss: 0.807 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.05206298828125
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.1763548851013184
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.519 Vali Acc: 0.737 Test Loss: 0.519 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1798713207244873
Epoch: 4, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2055516242980957
Epoch: 5, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.857036828994751
Epoch: 6, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.736 Vali Acc: 0.727 Test Loss: 0.736 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0187726020812988
Epoch: 7, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.695 Vali Acc: 0.732 Test Loss: 0.695 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3268566131591797
Epoch: 8, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.853 Vali Acc: 0.654 Test Loss: 0.853 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.42234206199646
Epoch: 9, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.791 Vali Acc: 0.649 Test Loss: 0.791 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3725237846374512
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.791 Vali Acc: 0.673 Test Loss: 0.791 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.286064624786377
Epoch: 11, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.914 Vali Acc: 0.771 Test Loss: 0.914 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770723).  Saving model ...
Epoch: 12 cost time: 1.2834067344665527
Epoch: 12, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.829 Vali Acc: 0.707 Test Loss: 0.829 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9433250427246094
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.785 Vali Acc: 0.702 Test Loss: 0.785 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3482346534729004
Epoch: 14, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.079 Vali Acc: 0.673 Test Loss: 1.079 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4034407138824463
Epoch: 15, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.054 Vali Acc: 0.727 Test Loss: 1.054 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.318854808807373
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.138 Vali Acc: 0.702 Test Loss: 1.138 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4194929599761963
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.172 Vali Acc: 0.688 Test Loss: 1.172 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.254119634628296
Epoch: 18, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.458 Vali Acc: 0.629 Test Loss: 1.458 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2075457572937012
Epoch: 19, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.954 Vali Acc: 0.683 Test Loss: 0.954 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2759990692138672
Epoch: 20, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.133 Vali Acc: 0.698 Test Loss: 1.133 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2817306518554688
Epoch: 21, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.563 Vali Acc: 0.732 Test Loss: 1.563 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 32531714
model size : 138.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.60406231880188
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1514005661010742
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 0.9871909618377686
Epoch: 3, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.1462242603302002
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.551 Vali Acc: 0.771 Test Loss: 0.551 Test Acc: 0.771
Validation loss decreased (-0.736580 --> -0.770726).  Saving model ...
Epoch: 5 cost time: 1.2159662246704102
Epoch: 5, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.683 Vali Acc: 0.771 Test Loss: 0.683 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.139615774154663
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.688 Vali Acc: 0.766 Test Loss: 0.688 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2111105918884277
Epoch: 7, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1977176666259766
Epoch: 8, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.876 Vali Acc: 0.751 Test Loss: 0.876 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.102539300918579
Epoch: 9, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.789 Vali Acc: 0.693 Test Loss: 0.789 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.128946304321289
Epoch: 10, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.777 Vali Acc: 0.746 Test Loss: 0.777 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0183160305023193
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.063053846359253
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.046 Vali Acc: 0.741 Test Loss: 1.046 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0868632793426514
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.935 Vali Acc: 0.624 Test Loss: 0.935 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0959904193878174
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.926 Vali Acc: 0.673 Test Loss: 0.926 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 32485634
model size : 138.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.810206174850464
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 1.4266955852508545
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4991321563720703
Epoch: 3, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.127135992050171
Epoch: 4, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760969).  Saving model ...
Epoch: 5 cost time: 1.5651719570159912
Epoch: 5, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.440948247909546
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.717 Vali Acc: 0.722 Test Loss: 0.717 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1954922676086426
Epoch: 7, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.860 Vali Acc: 0.746 Test Loss: 0.860 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.516068458557129
Epoch: 8, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.929 Vali Acc: 0.722 Test Loss: 0.929 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4145770072937012
Epoch: 9, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.923 Vali Acc: 0.737 Test Loss: 0.923 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3731513023376465
Epoch: 10, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.986 Vali Acc: 0.737 Test Loss: 0.986 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.501739740371704
Epoch: 11, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.084 Vali Acc: 0.629 Test Loss: 1.084 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4715781211853027
Epoch: 12, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.238 Vali Acc: 0.693 Test Loss: 1.238 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5435411930084229
Epoch: 13, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.555 Vali Acc: 0.673 Test Loss: 1.555 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5341475009918213
Epoch: 14, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.180 Vali Acc: 0.654 Test Loss: 1.180 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 32770562
model size : 139.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5092430114746094
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 0.888333797454834
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1746771335601807
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
Validation loss decreased (-0.746335 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.0213382244110107
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1504533290863037
Epoch: 5, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9797849655151367
Epoch: 6, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.603 Vali Acc: 0.707 Test Loss: 0.603 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1284606456756592
Epoch: 7, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.638 Vali Acc: 0.702 Test Loss: 0.638 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9830765724182129
Epoch: 8, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0207738876342773
Epoch: 9, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.744 Vali Acc: 0.698 Test Loss: 0.744 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0428636074066162
Epoch: 10, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.454 Vali Acc: 0.517 Test Loss: 1.454 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1766753196716309
Epoch: 11, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.037 Vali Acc: 0.624 Test Loss: 1.037 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2307474613189697
Epoch: 12, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.059 Vali Acc: 0.668 Test Loss: 1.059 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2256238460540771
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.263 Vali Acc: 0.712 Test Loss: 1.263 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 32672258
model size : 139.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6928799152374268
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.144430160522461
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.543 Vali Acc: 0.761 Test Loss: 0.543 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.0621893405914307
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1363639831542969
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.13126540184021
Epoch: 5, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.608 Vali Acc: 0.698 Test Loss: 0.608 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.12418532371521
Epoch: 6, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0096125602722168
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9543163776397705
Epoch: 8, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.667 Vali Acc: 0.751 Test Loss: 0.667 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0611655712127686
Epoch: 9, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7551462650299072
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.823 Vali Acc: 0.766 Test Loss: 0.823 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765845).  Saving model ...
Epoch: 11 cost time: 0.9898855686187744
Epoch: 11, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.043 Vali Acc: 0.746 Test Loss: 1.043 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.183182716369629
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.831 Vali Acc: 0.717 Test Loss: 0.831 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.953021764755249
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.766 Vali Acc: 0.702 Test Loss: 0.766 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9338126182556152
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.859 Vali Acc: 0.673 Test Loss: 0.859 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0292713642120361
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.833 Vali Acc: 0.698 Test Loss: 0.833 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9537026882171631
Epoch: 16, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.901 Vali Acc: 0.698 Test Loss: 0.901 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9749937057495117
Epoch: 17, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.788 Vali Acc: 0.698 Test Loss: 0.788 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0806190967559814
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.001 Vali Acc: 0.707 Test Loss: 1.001 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9466636180877686
Epoch: 19, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.866 Vali Acc: 0.702 Test Loss: 0.866 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.966665506362915
Epoch: 20, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.027 Vali Acc: 0.712 Test Loss: 1.027 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 32623106
model size : 139.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8806562423706055
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.585 Vali Acc: 0.712 Test Loss: 0.585 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1468276977539062
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.17484712600708
Epoch: 3, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.520 Vali Acc: 0.751 Test Loss: 0.520 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.3366754055023193
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3176743984222412
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.275418996810913
Epoch: 6, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.708 Vali Acc: 0.766 Test Loss: 0.708 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 7 cost time: 1.268540859222412
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.747 Vali Acc: 0.654 Test Loss: 0.747 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1648368835449219
Epoch: 8, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.865 Vali Acc: 0.634 Test Loss: 0.865 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3891210556030273
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2948877811431885
Epoch: 10, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.104 Vali Acc: 0.741 Test Loss: 1.104 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.512263536453247
Epoch: 11, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.321505069732666
Epoch: 12, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.082 Vali Acc: 0.659 Test Loss: 1.082 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.366265058517456
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.132 Vali Acc: 0.712 Test Loss: 1.132 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0484402179718018
Epoch: 14, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.443 Vali Acc: 0.688 Test Loss: 1.443 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3929922580718994
Epoch: 15, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.296 Vali Acc: 0.732 Test Loss: 1.296 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1063873767852783
Epoch: 16, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.841 Vali Acc: 0.756 Test Loss: 1.841 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 33024002
model size : 140.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6964094638824463
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.192258596420288
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.1168761253356934
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2267029285430908
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.616 Vali Acc: 0.766 Test Loss: 0.616 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 5 cost time: 1.1204931735992432
Epoch: 5, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0590901374816895
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.763 Vali Acc: 0.766 Test Loss: 0.763 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9580445289611816
Epoch: 7, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0071165561676025
Epoch: 8, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.925 Vali Acc: 0.771 Test Loss: 0.925 Test Acc: 0.771
Validation loss decreased (-0.765847 --> -0.770722).  Saving model ...
Epoch: 9 cost time: 1.0149497985839844
Epoch: 9, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.036 Vali Acc: 0.761 Test Loss: 1.036 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0045573711395264
Epoch: 10, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.210 Vali Acc: 0.771 Test Loss: 1.210 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.063598394393921
Epoch: 11, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.702 Vali Acc: 0.732 Test Loss: 0.702 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.069091558456421
Epoch: 12, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.863 Vali Acc: 0.678 Test Loss: 0.863 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0990092754364014
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.095 Vali Acc: 0.746 Test Loss: 1.095 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1557936668395996
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.927 Vali Acc: 0.717 Test Loss: 0.927 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0564100742340088
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.967 Vali Acc: 0.678 Test Loss: 0.967 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2108309268951416
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.066 Vali Acc: 0.717 Test Loss: 1.066 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0746386051177979
Epoch: 17, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.988 Vali Acc: 0.693 Test Loss: 0.988 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7109344005584717
Epoch: 18, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.027 Vali Acc: 0.707 Test Loss: 1.027 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 32947202
model size : 140.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2964870929718018
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.6998777389526367
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.6823418140411377
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.513 Vali Acc: 0.766 Test Loss: 0.513 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 0.7260327339172363
Epoch: 4, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6154699325561523
Epoch: 5, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.614 Vali Acc: 0.693 Test Loss: 0.614 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6654446125030518
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.527 Vali Acc: 0.737 Test Loss: 0.527 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6633493900299072
Epoch: 7, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.608 Vali Acc: 0.756 Test Loss: 0.608 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6922776699066162
Epoch: 8, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.631 Vali Acc: 0.756 Test Loss: 0.631 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6065139770507812
Epoch: 9, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5970988273620605
Epoch: 10, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7047979831695557
Epoch: 11, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.823 Vali Acc: 0.732 Test Loss: 0.823 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7150101661682129
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.930 Vali Acc: 0.741 Test Loss: 0.930 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7773725986480713
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.010 Vali Acc: 0.756 Test Loss: 1.010 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 32901122
model size : 140.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.206742286682129
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.1147208213806152
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
Validation loss decreased (-0.731701 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.043139934539795
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.736 Vali Acc: 0.746 Test Loss: 0.736 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3585572242736816
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.580 Vali Acc: 0.766 Test Loss: 0.580 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 1.6301207542419434
Epoch: 5, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.122624397277832
Epoch: 6, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.236093521118164
Epoch: 7, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.841 Vali Acc: 0.737 Test Loss: 0.841 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4526948928833008
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2004239559173584
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.736 Vali Acc: 0.488 Test Loss: 1.736 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1698625087738037
Epoch: 10, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7258355617523193
Epoch: 11, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.504 Vali Acc: 0.605 Test Loss: 1.504 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3470511436462402
Epoch: 12, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.026 Vali Acc: 0.683 Test Loss: 1.026 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5284397602081299
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.109 Vali Acc: 0.707 Test Loss: 1.109 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6404039859771729
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.323 Vali Acc: 0.707 Test Loss: 1.323 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 33164546
model size : 141.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3427939414978027
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.2614514827728271
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.1140453815460205
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.505 Vali Acc: 0.771 Test Loss: 0.505 Test Acc: 0.771
Validation loss decreased (-0.731701 --> -0.770727).  Saving model ...
Epoch: 4 cost time: 0.6345999240875244
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2225735187530518
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3888463973999023
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.629 Vali Acc: 0.766 Test Loss: 0.629 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4424550533294678
Epoch: 7, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.659 Vali Acc: 0.751 Test Loss: 0.659 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.233356237411499
Epoch: 8, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.713 Vali Acc: 0.727 Test Loss: 0.713 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2357985973358154
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.770 Vali Acc: 0.717 Test Loss: 0.770 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0069711208343506
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.916 Vali Acc: 0.722 Test Loss: 0.916 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4222466945648193
Epoch: 11, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.935 Vali Acc: 0.639 Test Loss: 0.935 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.440446376800537
Epoch: 12, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.014 Vali Acc: 0.717 Test Loss: 1.014 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4505586624145508
Epoch: 13, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.115 Vali Acc: 0.698 Test Loss: 1.115 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 33081602
model size : 140.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2722694873809814
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8069016933441162
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.550 Vali Acc: 0.741 Test Loss: 0.550 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.1793897151947021
Epoch: 3, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.150434970855713
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1183538436889648
Epoch: 5, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.720 Vali Acc: 0.761 Test Loss: 0.720 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760968).  Saving model ...
Epoch: 6 cost time: 1.2439193725585938
Epoch: 6, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.778 Vali Acc: 0.620 Test Loss: 0.778 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1537609100341797
Epoch: 7, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.790 Vali Acc: 0.746 Test Loss: 0.790 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.988135576248169
Epoch: 8, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.692 Vali Acc: 0.683 Test Loss: 0.692 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1900138854980469
Epoch: 9, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.842 Vali Acc: 0.732 Test Loss: 0.842 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2022559642791748
Epoch: 10, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.827 Vali Acc: 0.727 Test Loss: 0.827 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1964263916015625
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.793 Vali Acc: 0.688 Test Loss: 0.793 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9755795001983643
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.866 Vali Acc: 0.644 Test Loss: 0.866 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.086256742477417
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.004 Vali Acc: 0.732 Test Loss: 1.004 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0942859649658203
Epoch: 14, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.926 Vali Acc: 0.717 Test Loss: 0.926 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2535967826843262
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.994 Vali Acc: 0.737 Test Loss: 0.994 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 33041666
model size : 140.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0049376487731934
Epoch: 1, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 1.6448142528533936
Epoch: 2, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.513 Vali Acc: 0.761 Test Loss: 0.513 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.2603824138641357
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.563 Vali Acc: 0.761 Test Loss: 0.563 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1379151344299316
Epoch: 4, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2207252979278564
Epoch: 5, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.707 Vali Acc: 0.741 Test Loss: 0.707 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3690955638885498
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.683 Vali Acc: 0.668 Test Loss: 0.683 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4779942035675049
Epoch: 7, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.858 Vali Acc: 0.717 Test Loss: 0.858 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.14554762840271
Epoch: 8, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.797 Vali Acc: 0.688 Test Loss: 0.797 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4654207229614258
Epoch: 9, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.050 Vali Acc: 0.673 Test Loss: 1.050 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2155911922454834
Epoch: 10, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.089 Vali Acc: 0.698 Test Loss: 1.089 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2955782413482666
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.311 Vali Acc: 0.649 Test Loss: 1.311 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2526679039001465
Epoch: 12, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.173 Vali Acc: 0.683 Test Loss: 1.173 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 33424130
model size : 142.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.538281202316284
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.550 Vali Acc: 0.732 Test Loss: 0.550 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.2853672504425049
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9304485321044922
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.516 Vali Acc: 0.741 Test Loss: 0.516 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.985276460647583
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.569 Vali Acc: 0.683 Test Loss: 0.569 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1380443572998047
Epoch: 5, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.602 Vali Acc: 0.712 Test Loss: 0.602 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1733312606811523
Epoch: 6, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.795 Vali Acc: 0.746 Test Loss: 0.795 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0080430507659912
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.670 Vali Acc: 0.707 Test Loss: 0.670 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0152373313903809
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.788 Vali Acc: 0.712 Test Loss: 0.788 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0567634105682373
Epoch: 9, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.953 Vali Acc: 0.698 Test Loss: 0.953 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8567616939544678
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.861 Vali Acc: 0.683 Test Loss: 0.861 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1449894905090332
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.307 Vali Acc: 0.727 Test Loss: 1.307 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.215158462524414
Epoch: 12, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.084 Vali Acc: 0.722 Test Loss: 1.084 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 33356546
model size : 141.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3757758140563965
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.0161280632019043
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.558 Vali Acc: 0.727 Test Loss: 0.558 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.0481007099151611
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.048391342163086
Epoch: 4, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.548 Vali Acc: 0.707 Test Loss: 0.548 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8580026626586914
Epoch: 5, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.591 Vali Acc: 0.673 Test Loss: 0.591 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9984080791473389
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1040356159210205
Epoch: 7, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.658 Vali Acc: 0.698 Test Loss: 0.658 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0028955936431885
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.677 Vali Acc: 0.751 Test Loss: 0.677 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751213).  Saving model ...
Epoch: 9 cost time: 1.025501012802124
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.687 Vali Acc: 0.722 Test Loss: 0.687 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8874716758728027
Epoch: 10, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.740 Vali Acc: 0.693 Test Loss: 0.740 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0513958930969238
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.884 Vali Acc: 0.756 Test Loss: 0.884 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756089).  Saving model ...
Epoch: 12 cost time: 0.9510571956634521
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.829 Vali Acc: 0.712 Test Loss: 0.829 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.040839433670044
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.977 Vali Acc: 0.663 Test Loss: 0.977 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.787484884262085
Epoch: 14, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.041 Vali Acc: 0.741 Test Loss: 1.041 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8275551795959473
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.931 Vali Acc: 0.668 Test Loss: 0.931 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8661794662475586
Epoch: 16, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.972 Vali Acc: 0.722 Test Loss: 0.972 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.828606367111206
Epoch: 17, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.032 Vali Acc: 0.683 Test Loss: 1.032 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7843489646911621
Epoch: 18, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.880 Vali Acc: 0.727 Test Loss: 0.880 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7225279808044434
Epoch: 19, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.112 Vali Acc: 0.751 Test Loss: 1.112 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8262455463409424
Epoch: 20, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.094 Vali Acc: 0.741 Test Loss: 1.094 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8212871551513672
Epoch: 21, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.169 Vali Acc: 0.741 Test Loss: 1.169 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 33316610
model size : 141.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.576786756515503
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.026829481124878
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.3170957565307617
Epoch: 3, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8969261646270752
Epoch: 4, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9857828617095947
Epoch: 5, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3590683937072754
Epoch: 6, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 1.1485145092010498
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.711 Vali Acc: 0.702 Test Loss: 0.711 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2733488082885742
Epoch: 8, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.009 Vali Acc: 0.732 Test Loss: 1.009 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0476100444793701
Epoch: 9, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.127 Vali Acc: 0.722 Test Loss: 1.127 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.36869478225708
Epoch: 10, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.061 Vali Acc: 0.717 Test Loss: 1.061 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2281684875488281
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.221 Vali Acc: 0.702 Test Loss: 1.221 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.20639967918396
Epoch: 12, Steps: 13 | Train Loss: 0.276 Vali Loss: 2.350 Vali Acc: 0.712 Test Loss: 2.350 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2930636405944824
Epoch: 13, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.210 Vali Acc: 0.702 Test Loss: 1.210 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3672230243682861
Epoch: 14, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.285 Vali Acc: 0.615 Test Loss: 1.285 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.293665885925293
Epoch: 15, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.331 Vali Acc: 0.717 Test Loss: 1.331 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9143002033233643
Epoch: 16, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.301 Vali Acc: 0.702 Test Loss: 1.301 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 33842690
model size : 143.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.505790948867798
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.8442778587341309
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.521 Vali Acc: 0.756 Test Loss: 0.521 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.8761837482452393
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.505 Vali Acc: 0.751 Test Loss: 0.505 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6703927516937256
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.523 Vali Acc: 0.702 Test Loss: 0.523 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7508070468902588
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9896335601806641
Epoch: 6, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.639 Vali Acc: 0.678 Test Loss: 0.639 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2315800189971924
Epoch: 7, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.199 Vali Acc: 0.512 Test Loss: 1.199 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8541679382324219
Epoch: 8, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9013786315917969
Epoch: 9, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8214046955108643
Epoch: 10, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.020 Vali Acc: 0.727 Test Loss: 1.020 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8516743183135986
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.053 Vali Acc: 0.615 Test Loss: 1.053 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9067745208740234
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.098 Vali Acc: 0.659 Test Loss: 1.098 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 33772034
model size : 143.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4530463218688965
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.7935919761657715
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.538 Vali Acc: 0.751 Test Loss: 0.538 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.7862503528594971
Epoch: 3, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.523 Vali Acc: 0.741 Test Loss: 0.523 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7460110187530518
Epoch: 4, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 0.9185607433319092
Epoch: 5, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.537 Vali Acc: 0.707 Test Loss: 0.537 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7398712635040283
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.958 Vali Acc: 0.771 Test Loss: 0.958 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770722).  Saving model ...
Epoch: 7 cost time: 0.9180099964141846
Epoch: 7, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7444963455200195
Epoch: 8, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.696 Vali Acc: 0.707 Test Loss: 0.696 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9494104385375977
Epoch: 9, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.790 Vali Acc: 0.712 Test Loss: 0.790 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8632798194885254
Epoch: 10, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.867 Vali Acc: 0.673 Test Loss: 0.867 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.824028730392456
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.874 Vali Acc: 0.668 Test Loss: 0.874 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9254252910614014
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.981 Vali Acc: 0.693 Test Loss: 0.981 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8378255367279053
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.982 Vali Acc: 0.746 Test Loss: 0.982 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.895777702331543
Epoch: 14, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.031 Vali Acc: 0.673 Test Loss: 1.031 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9456536769866943
Epoch: 15, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.995 Vali Acc: 0.712 Test Loss: 0.995 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6446688175201416
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.959 Vali Acc: 0.712 Test Loss: 0.959 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 33735170
model size : 143.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6122920513153076
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.0108520984649658
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.685 Vali Acc: 0.722 Test Loss: 0.685 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.150606632232666
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.590 Vali Acc: 0.756 Test Loss: 0.590 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.223576545715332
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8945283889770508
Epoch: 5, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.589 Vali Acc: 0.702 Test Loss: 0.589 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.923652172088623
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1431214809417725
Epoch: 7, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.855 Vali Acc: 0.717 Test Loss: 0.855 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1827692985534668
Epoch: 8, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.625 Vali Acc: 0.722 Test Loss: 1.625 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.074652910232544
Epoch: 9, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.831 Vali Acc: 0.659 Test Loss: 0.831 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2041130065917969
Epoch: 10, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.151 Vali Acc: 0.663 Test Loss: 1.151 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8683602809906006
Epoch: 11, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.917 Vali Acc: 0.732 Test Loss: 0.917 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.146019458770752
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.103 Vali Acc: 0.688 Test Loss: 1.103 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.357719898223877
Epoch: 13, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.159 Vali Acc: 0.693 Test Loss: 1.159 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 34108418
model size : 144.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.9650614261627197
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.8778209686279297
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.569 Vali Acc: 0.751 Test Loss: 0.569 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.1259329319000244
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.548 Vali Acc: 0.766 Test Loss: 0.548 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.1039505004882812
Epoch: 4, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8821637630462646
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8719613552093506
Epoch: 6, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.717 Vali Acc: 0.746 Test Loss: 0.717 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8861668109893799
Epoch: 7, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.626 Vali Acc: 0.741 Test Loss: 0.626 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.953899621963501
Epoch: 8, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.727 Vali Acc: 0.751 Test Loss: 0.727 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8472940921783447
Epoch: 9, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.828 Vali Acc: 0.727 Test Loss: 0.828 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.806422233581543
Epoch: 10, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.998 Vali Acc: 0.727 Test Loss: 0.998 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8854207992553711
Epoch: 11, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.998 Vali Acc: 0.751 Test Loss: 0.998 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1868796348571777
Epoch: 12, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.956 Vali Acc: 0.737 Test Loss: 0.956 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1820924282073975
Epoch: 13, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.025 Vali Acc: 0.717 Test Loss: 1.025 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 34046978
model size : 144.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.544647693634033
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1315197944641113
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.079742431640625
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.8836383819580078
Epoch: 4, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.524 Vali Acc: 0.722 Test Loss: 0.524 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.834317684173584
Epoch: 5, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.82082200050354
Epoch: 6, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.645 Vali Acc: 0.751 Test Loss: 0.645 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9236695766448975
Epoch: 7, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.731 Vali Acc: 0.741 Test Loss: 0.731 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7259714603424072
Epoch: 8, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.785 Vali Acc: 0.712 Test Loss: 0.785 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0333082675933838
Epoch: 9, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.802 Vali Acc: 0.698 Test Loss: 0.802 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7790076732635498
Epoch: 10, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.800 Vali Acc: 0.693 Test Loss: 0.800 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6554207801818848
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.855 Vali Acc: 0.678 Test Loss: 0.855 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6794552803039551
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.746 Vali Acc: 0.727 Test Loss: 0.746 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.767446756362915
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.040 Vali Acc: 0.751 Test Loss: 1.040 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 34013186
model size : 144.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4554014205932617
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8698976039886475
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.1624433994293213
Epoch: 3, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.533 Vali Acc: 0.722 Test Loss: 0.533 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4171040058135986
Epoch: 4, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2252202033996582
Epoch: 5, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1468522548675537
Epoch: 6, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.830 Vali Acc: 0.737 Test Loss: 0.830 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4513134956359863
Epoch: 7, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.847 Vali Acc: 0.673 Test Loss: 0.847 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5254027843475342
Epoch: 8, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.723 Vali Acc: 0.561 Test Loss: 1.723 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5485141277313232
Epoch: 9, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.765 Vali Acc: 0.707 Test Loss: 0.765 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5193307399749756
Epoch: 10, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.325 Vali Acc: 0.727 Test Loss: 1.325 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5431163311004639
Epoch: 11, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.097 Vali Acc: 0.751 Test Loss: 1.097 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4902822971343994
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.192 Vali Acc: 0.624 Test Loss: 1.192 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 34514690
model size : 146.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0081946849823
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 0.9166402816772461
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.3220064640045166
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.531 Vali Acc: 0.737 Test Loss: 0.531 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2514655590057373
Epoch: 4, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8616244792938232
Epoch: 5, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.590 Vali Acc: 0.741 Test Loss: 0.590 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8810527324676514
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.618 Vali Acc: 0.707 Test Loss: 0.618 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2967944145202637
Epoch: 7, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.632 Vali Acc: 0.707 Test Loss: 0.632 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3631558418273926
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.680 Vali Acc: 0.702 Test Loss: 0.680 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2545790672302246
Epoch: 9, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.710 Vali Acc: 0.732 Test Loss: 0.710 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3504066467285156
Epoch: 10, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.792 Vali Acc: 0.668 Test Loss: 0.792 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3275625705718994
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.942 Vali Acc: 0.732 Test Loss: 0.942 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.141570806503296
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.009 Vali Acc: 0.741 Test Loss: 1.009 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 34462466
model size : 146.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.591148614883423
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0211658477783203
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.1043529510498047
Epoch: 3, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.9537928104400635
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.598 Vali Acc: 0.751 Test Loss: 0.598 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.1529479026794434
Epoch: 5, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7852659225463867
Epoch: 6, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7465715408325195
Epoch: 7, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.835 Vali Acc: 0.644 Test Loss: 0.835 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8574919700622559
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.636 Vali Acc: 0.727 Test Loss: 0.636 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8752386569976807
Epoch: 9, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.726 Vali Acc: 0.707 Test Loss: 0.726 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7918996810913086
Epoch: 10, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.820 Vali Acc: 0.678 Test Loss: 0.820 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7488832473754883
Epoch: 11, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.860 Vali Acc: 0.663 Test Loss: 0.860 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7878532409667969
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.815 Vali Acc: 0.683 Test Loss: 0.815 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7685174942016602
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.941 Vali Acc: 0.722 Test Loss: 0.941 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6578125953674316
Epoch: 14, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.884 Vali Acc: 0.717 Test Loss: 0.884 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 34431746
model size : 146.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.664843797683716
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.235649824142456
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.536 Vali Acc: 0.732 Test Loss: 0.536 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.8996038436889648
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.617 Vali Acc: 0.732 Test Loss: 0.617 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2461998462677002
Epoch: 4, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.724 Vali Acc: 0.741 Test Loss: 0.724 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741456).  Saving model ...
Epoch: 5 cost time: 1.1029324531555176
Epoch: 5, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.646 Vali Acc: 0.727 Test Loss: 0.646 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1431884765625
Epoch: 6, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.791 Vali Acc: 0.717 Test Loss: 0.791 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9737448692321777
Epoch: 7, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1481058597564697
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.816 Vali Acc: 0.668 Test Loss: 0.816 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1865897178649902
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.835 Vali Acc: 0.722 Test Loss: 0.835 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1525347232818604
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.907 Vali Acc: 0.683 Test Loss: 0.907 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.137352705001831
Epoch: 11, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.341 Vali Acc: 0.732 Test Loss: 1.341 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9761173725128174
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.091 Vali Acc: 0.698 Test Loss: 1.091 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2702972888946533
Epoch: 13, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.004 Vali Acc: 0.624 Test Loss: 1.004 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.294276475906372
Epoch: 14, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.443 Vali Acc: 0.654 Test Loss: 1.443 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 35067650
model size : 148.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.682429313659668
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8929150104522705
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.3611407279968262
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9080345630645752
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9317407608032227
Epoch: 5, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2266814708709717
Epoch: 6, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9583988189697266
Epoch: 7, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.012866735458374
Epoch: 8, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.563 Vali Acc: 0.761 Test Loss: 0.563 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.235609769821167
Epoch: 9, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.878 Vali Acc: 0.785 Test Loss: 0.878 Test Acc: 0.785
Validation loss decreased (-0.760970 --> -0.785357).  Saving model ...
Epoch: 10 cost time: 1.2550561428070068
Epoch: 10, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1514079570770264
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.975 Vali Acc: 0.683 Test Loss: 0.975 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1544373035430908
Epoch: 12, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.857 Vali Acc: 0.668 Test Loss: 0.857 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1897361278533936
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.885 Vali Acc: 0.688 Test Loss: 0.885 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2595815658569336
Epoch: 14, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.947 Vali Acc: 0.741 Test Loss: 0.947 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.233781099319458
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.373 Vali Acc: 0.737 Test Loss: 1.373 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1586370468139648
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.297 Vali Acc: 0.732 Test Loss: 1.297 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1759071350097656
Epoch: 17, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.727 Vali Acc: 0.766 Test Loss: 1.727 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2188382148742676
Epoch: 18, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.120 Vali Acc: 0.698 Test Loss: 1.120 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8937325477600098
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.301 Vali Acc: 0.737 Test Loss: 1.301 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 35018498
model size : 148.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3292977809906006
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.8107223510742188
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.529 Vali Acc: 0.756 Test Loss: 0.529 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.9133894443511963
Epoch: 3, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.545 Vali Acc: 0.756 Test Loss: 0.545 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9143133163452148
Epoch: 4, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.639 Vali Acc: 0.615 Test Loss: 0.639 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7674400806427002
Epoch: 5, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.557 Vali Acc: 0.756 Test Loss: 0.557 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9356997013092041
Epoch: 6, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8410289287567139
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.707 Vali Acc: 0.702 Test Loss: 0.707 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8262221813201904
Epoch: 8, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.685 Vali Acc: 0.741 Test Loss: 0.685 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8538691997528076
Epoch: 9, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.777 Vali Acc: 0.712 Test Loss: 0.777 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7758488655090332
Epoch: 10, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.832 Vali Acc: 0.727 Test Loss: 0.832 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7325212955474854
Epoch: 11, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760967).  Saving model ...
Epoch: 12 cost time: 0.7409267425537109
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.878 Vali Acc: 0.707 Test Loss: 0.878 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8585481643676758
Epoch: 13, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.778 Vali Acc: 0.717 Test Loss: 0.778 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.740363597869873
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.900 Vali Acc: 0.712 Test Loss: 0.900 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.738436222076416
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.877 Vali Acc: 0.668 Test Loss: 0.877 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.730111837387085
Epoch: 16, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.246 Vali Acc: 0.756 Test Loss: 1.246 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8134162425994873
Epoch: 17, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.906 Vali Acc: 0.712 Test Loss: 0.906 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8958451747894287
Epoch: 18, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.997 Vali Acc: 0.722 Test Loss: 0.997 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8173480033874512
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8821942806243896
Epoch: 20, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.324 Vali Acc: 0.615 Test Loss: 1.324 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9496467113494873
Epoch: 21, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.474 Vali Acc: 0.717 Test Loss: 1.474 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 34990850
model size : 148.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3941423892974854
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.552 Vali Acc: 0.717 Test Loss: 0.552 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.156057357788086
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
Validation loss decreased (-0.717068 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.163663625717163
Epoch: 3, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9481637477874756
Epoch: 4, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.2300758361816406
Epoch: 5, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0741655826568604
Epoch: 6, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1983451843261719
Epoch: 7, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.817 Vali Acc: 0.698 Test Loss: 0.817 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3750920295715332
Epoch: 8, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.852 Vali Acc: 0.722 Test Loss: 0.852 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.843712568283081
Epoch: 9, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.907 Vali Acc: 0.707 Test Loss: 0.907 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8154201507568359
Epoch: 10, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.136 Vali Acc: 0.766 Test Loss: 1.136 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765842).  Saving model ...
Epoch: 11 cost time: 1.297419548034668
Epoch: 11, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.114 Vali Acc: 0.683 Test Loss: 1.114 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2615127563476562
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.061 Vali Acc: 0.693 Test Loss: 1.061 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1125116348266602
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.113 Vali Acc: 0.663 Test Loss: 1.113 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2773189544677734
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.023 Vali Acc: 0.756 Test Loss: 1.023 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2432632446289062
Epoch: 15, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.920 Vali Acc: 0.712 Test Loss: 0.920 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.209406852722168
Epoch: 16, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.998 Vali Acc: 0.668 Test Loss: 0.998 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3453261852264404
Epoch: 17, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.167 Vali Acc: 0.741 Test Loss: 1.167 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1155858039855957
Epoch: 18, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.172 Vali Acc: 0.712 Test Loss: 1.172 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2197883129119873
Epoch: 19, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.269 Vali Acc: 0.673 Test Loss: 1.269 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.295212984085083
Epoch: 20, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.508 Vali Acc: 0.741 Test Loss: 1.508 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 35620610
model size : 150.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2546448707580566
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.0624253749847412
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.1959867477416992
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.510 Vali Acc: 0.712 Test Loss: 0.510 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1871848106384277
Epoch: 4, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.2444531917572021
Epoch: 5, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.598 Vali Acc: 0.702 Test Loss: 0.598 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9885053634643555
Epoch: 6, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.646 Vali Acc: 0.683 Test Loss: 0.646 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7800288200378418
Epoch: 7, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7415130138397217
Epoch: 8, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.708 Vali Acc: 0.756 Test Loss: 0.708 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756090).  Saving model ...
Epoch: 9 cost time: 1.1790482997894287
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2652146816253662
Epoch: 10, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.731 Vali Acc: 0.678 Test Loss: 0.731 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2149555683135986
Epoch: 11, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.767 Vali Acc: 0.693 Test Loss: 0.767 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2856371402740479
Epoch: 12, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.847 Vali Acc: 0.732 Test Loss: 0.847 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0263049602508545
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.966 Vali Acc: 0.717 Test Loss: 0.966 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0933043956756592
Epoch: 14, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.903 Vali Acc: 0.683 Test Loss: 0.903 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1566414833068848
Epoch: 15, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.880 Vali Acc: 0.732 Test Loss: 0.880 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.04362154006958
Epoch: 16, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.889 Vali Acc: 0.727 Test Loss: 0.889 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0972201824188232
Epoch: 17, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.916 Vali Acc: 0.683 Test Loss: 0.916 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0466501712799072
Epoch: 18, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.055 Vali Acc: 0.707 Test Loss: 1.055 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 35574530
model size : 150.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.67787766456604
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9330892562866211
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.7577531337738037
Epoch: 3, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7763495445251465
Epoch: 4, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 0.9884934425354004
Epoch: 5, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.685 Vali Acc: 0.678 Test Loss: 0.685 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8740949630737305
Epoch: 6, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.670 Vali Acc: 0.673 Test Loss: 0.670 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9539551734924316
Epoch: 7, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.753 Vali Acc: 0.659 Test Loss: 0.753 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.040846347808838
Epoch: 8, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.828 Vali Acc: 0.727 Test Loss: 0.828 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9115381240844727
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.979 Vali Acc: 0.605 Test Loss: 0.979 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7968597412109375
Epoch: 10, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.882 Vali Acc: 0.659 Test Loss: 0.882 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9478209018707275
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.911 Vali Acc: 0.663 Test Loss: 0.911 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.892918586730957
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0087323188781738
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.205 Vali Acc: 0.727 Test Loss: 1.205 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9123659133911133
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.032 Vali Acc: 0.732 Test Loss: 1.032 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 35553026
model size : 150.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.801483392715454
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3326389789581299
Epoch: 2, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.2691850662231445
Epoch: 3, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1998438835144043
Epoch: 4, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.530 Vali Acc: 0.727 Test Loss: 0.530 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1804583072662354
Epoch: 5, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1959168910980225
Epoch: 6, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1742582321166992
Epoch: 7, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.878 Vali Acc: 0.727 Test Loss: 0.878 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.213869333267212
Epoch: 8, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.793 Vali Acc: 0.712 Test Loss: 0.793 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1016643047332764
Epoch: 9, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.836 Vali Acc: 0.727 Test Loss: 0.836 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1772973537445068
Epoch: 10, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.871 Vali Acc: 0.693 Test Loss: 0.871 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1530025005340576
Epoch: 11, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.854 Vali Acc: 0.732 Test Loss: 0.854 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.151261329650879
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.146 Vali Acc: 0.722 Test Loss: 1.146 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 36454658
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5709447860717773
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1802022457122803
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.0981197357177734
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.0443966388702393
Epoch: 4, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.627 Vali Acc: 0.727 Test Loss: 0.627 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1406168937683105
Epoch: 5, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0125267505645752
Epoch: 6, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.737 Vali Acc: 0.727 Test Loss: 0.737 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.066110372543335
Epoch: 7, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.751 Vali Acc: 0.707 Test Loss: 0.751 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1277508735656738
Epoch: 8, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.836 Vali Acc: 0.732 Test Loss: 0.836 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1655433177947998
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.817 Vali Acc: 0.688 Test Loss: 0.817 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1238157749176025
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.783 Vali Acc: 0.698 Test Loss: 0.783 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2209410667419434
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.894 Vali Acc: 0.683 Test Loss: 0.894 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.221247673034668
Epoch: 12, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.040 Vali Acc: 0.639 Test Loss: 1.040 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0223593711853027
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.946 Vali Acc: 0.659 Test Loss: 0.946 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 36411650
model size : 153.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.436066150665283
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9839022159576416
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.1503174304962158
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.1333658695220947
Epoch: 4, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.559 Vali Acc: 0.751 Test Loss: 0.559 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1200387477874756
Epoch: 5, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.646 Vali Acc: 0.756 Test Loss: 0.646 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9794633388519287
Epoch: 6, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9961075782775879
Epoch: 7, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.737 Vali Acc: 0.756 Test Loss: 0.737 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9593997001647949
Epoch: 8, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0245604515075684
Epoch: 9, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.678 Vali Acc: 0.707 Test Loss: 0.678 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0135629177093506
Epoch: 10, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.712 Vali Acc: 0.698 Test Loss: 0.712 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1216785907745361
Epoch: 11, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.748 Vali Acc: 0.712 Test Loss: 0.748 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.965219259262085
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.905 Vali Acc: 0.654 Test Loss: 0.905 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.060739278793335
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.717 Vali Acc: 0.722 Test Loss: 0.717 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 36390146
model size : 153.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4691739082336426
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.3766059875488281
Epoch: 2, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.533 Vali Acc: 0.771 Test Loss: 0.533 Test Acc: 0.771
Validation loss decreased (-0.717068 --> -0.770726).  Saving model ...
Epoch: 3 cost time: 1.2165164947509766
Epoch: 3, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.567 Vali Acc: 0.766 Test Loss: 0.567 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3811233043670654
Epoch: 4, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.811 Vali Acc: 0.727 Test Loss: 0.811 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4175496101379395
Epoch: 5, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.694 Vali Acc: 0.766 Test Loss: 0.694 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8153965473175049
Epoch: 6, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.752 Vali Acc: 0.727 Test Loss: 0.752 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2867751121520996
Epoch: 7, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.016 Vali Acc: 0.766 Test Loss: 1.016 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.420485496520996
Epoch: 8, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.883 Vali Acc: 0.678 Test Loss: 0.883 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9148273468017578
Epoch: 9, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.857 Vali Acc: 0.702 Test Loss: 0.857 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1420361995697021
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4031264781951904
Epoch: 11, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.853 Vali Acc: 0.654 Test Loss: 0.853 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3463671207427979
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.991 Vali Acc: 0.717 Test Loss: 0.991 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 37426178
model size : 157.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7335216999053955
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.1259419918060303
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
Validation loss decreased (-0.717068 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.2228047847747803
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.582 Vali Acc: 0.766 Test Loss: 0.582 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.2720792293548584
Epoch: 4, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.573 Vali Acc: 0.663 Test Loss: 0.573 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9269618988037109
Epoch: 5, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.570 Vali Acc: 0.707 Test Loss: 0.570 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.153099775314331
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.613 Vali Acc: 0.698 Test Loss: 0.613 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2111835479736328
Epoch: 7, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.831 Vali Acc: 0.756 Test Loss: 0.831 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.013073444366455
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.933 Vali Acc: 0.746 Test Loss: 0.933 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9985764026641846
Epoch: 9, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.782 Vali Acc: 0.702 Test Loss: 0.782 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0637516975402832
Epoch: 10, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.819 Vali Acc: 0.722 Test Loss: 0.819 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8538322448730469
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.058 Vali Acc: 0.737 Test Loss: 1.058 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0122547149658203
Epoch: 12, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.847 Vali Acc: 0.746 Test Loss: 0.847 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1409502029418945
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.026 Vali Acc: 0.766 Test Loss: 1.026 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 37389314
model size : 157.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.376298427581787
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.1199440956115723
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.528 Vali Acc: 0.732 Test Loss: 0.528 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.0166661739349365
Epoch: 3, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8797571659088135
Epoch: 4, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.604 Vali Acc: 0.678 Test Loss: 0.604 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0007023811340332
Epoch: 5, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.659 Vali Acc: 0.727 Test Loss: 0.659 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0234489440917969
Epoch: 6, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.629 Vali Acc: 0.698 Test Loss: 0.629 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9244909286499023
Epoch: 7, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.693 Vali Acc: 0.751 Test Loss: 0.693 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751213).  Saving model ...
Epoch: 8 cost time: 1.071866512298584
Epoch: 8, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.664 Vali Acc: 0.683 Test Loss: 0.664 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9131021499633789
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756089).  Saving model ...
Epoch: 10 cost time: 0.8549413681030273
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.852 Vali Acc: 0.771 Test Loss: 0.852 Test Acc: 0.771
Validation loss decreased (-0.756089 --> -0.770723).  Saving model ...
Epoch: 11 cost time: 0.9156398773193359
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.927 Vali Acc: 0.756 Test Loss: 0.927 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0371809005737305
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.952 Vali Acc: 0.746 Test Loss: 0.952 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9940273761749268
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.911 Vali Acc: 0.737 Test Loss: 0.911 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8992400169372559
Epoch: 14, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.994 Vali Acc: 0.751 Test Loss: 0.994 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1050865650177002
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.063 Vali Acc: 0.717 Test Loss: 1.063 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0044097900390625
Epoch: 16, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.945 Vali Acc: 0.668 Test Loss: 0.945 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9632093906402588
Epoch: 17, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.994 Vali Acc: 0.707 Test Loss: 0.994 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9637031555175781
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.240 Vali Acc: 0.741 Test Loss: 1.240 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9285018444061279
Epoch: 19, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.182 Vali Acc: 0.707 Test Loss: 1.182 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8661472797393799
Epoch: 20, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.269 Vali Acc: 0.717 Test Loss: 1.269 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 37370882
model size : 157.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8491294384002686
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.992621898651123
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.302861213684082
Epoch: 3, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.142082929611206
Epoch: 4, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2183797359466553
Epoch: 5, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.831 Vali Acc: 0.771 Test Loss: 0.831 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770723).  Saving model ...
Epoch: 6 cost time: 1.1619768142700195
Epoch: 6, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.627 Vali Acc: 0.766 Test Loss: 0.627 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2132484912872314
Epoch: 7, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.777 Vali Acc: 0.707 Test Loss: 0.777 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2055938243865967
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.838 Vali Acc: 0.756 Test Loss: 0.838 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.416431188583374
Epoch: 9, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.164 Vali Acc: 0.761 Test Loss: 1.164 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2458608150482178
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.102 Vali Acc: 0.761 Test Loss: 1.102 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.297875165939331
Epoch: 11, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.129 Vali Acc: 0.756 Test Loss: 1.129 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1656458377838135
Epoch: 12, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.734 Vali Acc: 0.712 Test Loss: 0.734 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2814266681671143
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.918 Vali Acc: 0.698 Test Loss: 0.918 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2765309810638428
Epoch: 14, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.193 Vali Acc: 0.737 Test Loss: 1.193 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.216576099395752
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.169 Vali Acc: 0.751 Test Loss: 1.169 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 38819330
model size : 162.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.503994941711426
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0509490966796875
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.536 Vali Acc: 0.722 Test Loss: 0.536 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.1860315799713135
Epoch: 3, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.063962697982788
Epoch: 4, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2188096046447754
Epoch: 5, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.708 Vali Acc: 0.766 Test Loss: 0.708 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765847).  Saving model ...
Epoch: 6 cost time: 1.044877529144287
Epoch: 6, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.859 Vali Acc: 0.741 Test Loss: 0.859 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9621498584747314
Epoch: 7, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.799 Vali Acc: 0.751 Test Loss: 0.799 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1633400917053223
Epoch: 8, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.928 Vali Acc: 0.746 Test Loss: 0.928 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0289440155029297
Epoch: 9, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.806 Vali Acc: 0.678 Test Loss: 0.806 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9308083057403564
Epoch: 10, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.769 Vali Acc: 0.693 Test Loss: 0.769 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1082773208618164
Epoch: 11, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.027 Vali Acc: 0.746 Test Loss: 1.027 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.121539831161499
Epoch: 12, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.837 Vali Acc: 0.727 Test Loss: 0.837 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1773486137390137
Epoch: 13, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.940 Vali Acc: 0.678 Test Loss: 0.940 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1708226203918457
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.078 Vali Acc: 0.766 Test Loss: 1.078 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0909998416900635
Epoch: 15, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.871 Vali Acc: 0.673 Test Loss: 0.871 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 38788610
model size : 162.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5539143085479736
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1495006084442139
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.9288136959075928
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.596 Vali Acc: 0.732 Test Loss: 0.596 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9248924255371094
Epoch: 4, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0274453163146973
Epoch: 5, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.652 Vali Acc: 0.707 Test Loss: 0.652 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0132856369018555
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.630 Vali Acc: 0.741 Test Loss: 0.630 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9663400650024414
Epoch: 7, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.669 Vali Acc: 0.683 Test Loss: 0.669 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.059584379196167
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.754 Vali Acc: 0.746 Test Loss: 0.754 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9120533466339111
Epoch: 9, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.854 Vali Acc: 0.751 Test Loss: 0.854 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751211).  Saving model ...
Epoch: 10 cost time: 1.0801725387573242
Epoch: 10, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.849 Vali Acc: 0.746 Test Loss: 0.849 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0359537601470947
Epoch: 11, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0521013736724854
Epoch: 12, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.939 Vali Acc: 0.746 Test Loss: 0.939 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.021747350692749
Epoch: 13, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.038 Vali Acc: 0.756 Test Loss: 1.038 Test Acc: 0.756
Validation loss decreased (-0.751211 --> -0.756087).  Saving model ...
Epoch: 14 cost time: 1.0751681327819824
Epoch: 14, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.956 Vali Acc: 0.673 Test Loss: 0.956 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.012939214706421
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.945 Vali Acc: 0.717 Test Loss: 0.945 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9674198627471924
Epoch: 16, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.033 Vali Acc: 0.707 Test Loss: 1.033 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.033313274383545
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.100 Vali Acc: 0.732 Test Loss: 1.100 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.942838191986084
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.248 Vali Acc: 0.761 Test Loss: 1.248 Test Acc: 0.761
Validation loss decreased (-0.756087 --> -0.760963).  Saving model ...
Epoch: 19 cost time: 1.1199355125427246
Epoch: 19, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.047 Vali Acc: 0.698 Test Loss: 1.047 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0178444385528564
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.213 Vali Acc: 0.761 Test Loss: 1.213 Test Acc: 0.761
Validation loss decreased (-0.760963 --> -0.760963).  Saving model ...
Epoch: 21 cost time: 1.0880060195922852
Epoch: 21, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.180 Vali Acc: 0.727 Test Loss: 1.180 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1300172805786133
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.256 Vali Acc: 0.722 Test Loss: 1.256 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9766128063201904
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.732 Test Loss: 1.312 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0398736000061035
Epoch: 24, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.732 Test Loss: 1.339 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1093642711639404
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.727 Test Loss: 1.358 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9164466857910156
Epoch: 26, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.378 Vali Acc: 0.727 Test Loss: 1.378 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0711956024169922
Epoch: 27, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.717 Test Loss: 1.354 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9837222099304199
Epoch: 28, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.707 Test Loss: 1.320 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9714384078979492
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.737 Test Loss: 1.437 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0286591053009033
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.737 Test Loss: 1.453 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 38773250
model size : 162.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps81_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8674538135528564
Epoch: 1, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.370065689086914
Epoch: 2, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.1544206142425537
Epoch: 3, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.630 Vali Acc: 0.727 Test Loss: 0.630 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2684910297393799
Epoch: 4, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.740 Vali Acc: 0.741 Test Loss: 0.740 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3647243976593018
Epoch: 5, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.759 Vali Acc: 0.766 Test Loss: 0.759 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765846).  Saving model ...
Epoch: 6 cost time: 1.2197637557983398
Epoch: 6, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.722 Vali Acc: 0.766 Test Loss: 0.722 Test Acc: 0.766
Validation loss decreased (-0.765846 --> -0.765846).  Saving model ...
Epoch: 7 cost time: 1.23988938331604
Epoch: 7, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.093 Vali Acc: 0.610 Test Loss: 1.093 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3171370029449463
Epoch: 8, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.752 Vali Acc: 0.732 Test Loss: 0.752 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3385214805603027
Epoch: 9, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.872 Vali Acc: 0.771 Test Loss: 0.872 Test Acc: 0.771
Validation loss decreased (-0.765846 --> -0.770723).  Saving model ...
Epoch: 10 cost time: 1.414468765258789
Epoch: 10, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.983 Vali Acc: 0.761 Test Loss: 0.983 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3508918285369873
Epoch: 11, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.054 Vali Acc: 0.776 Test Loss: 1.054 Test Acc: 0.776
Validation loss decreased (-0.770723 --> -0.775599).  Saving model ...
Epoch: 12 cost time: 1.3865158557891846
Epoch: 12, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3668887615203857
Epoch: 13, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.004 Vali Acc: 0.678 Test Loss: 1.004 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2382252216339111
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.073 Vali Acc: 0.756 Test Loss: 1.073 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1233046054840088
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.187 Vali Acc: 0.776 Test Loss: 1.187 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.387531042098999
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.947 Vali Acc: 0.717 Test Loss: 0.947 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3399934768676758
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.971 Vali Acc: 0.732 Test Loss: 0.971 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4214608669281006
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.089 Vali Acc: 0.761 Test Loss: 1.089 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3074283599853516
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.227 Vali Acc: 0.766 Test Loss: 1.227 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.249392032623291
Epoch: 20, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.060 Vali Acc: 0.717 Test Loss: 1.060 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3772366046905518
Epoch: 21, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.187 Vali Acc: 0.771 Test Loss: 1.187 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps81_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 40634114
model size : 169.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.510235071182251
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1449239253997803
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.2443175315856934
Epoch: 3, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.676 Vali Acc: 0.741 Test Loss: 0.676 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1627264022827148
Epoch: 4, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.643 Vali Acc: 0.746 Test Loss: 0.643 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.1824672222137451
Epoch: 5, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.692 Vali Acc: 0.663 Test Loss: 0.692 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1756582260131836
Epoch: 6, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.826 Vali Acc: 0.727 Test Loss: 0.826 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1343955993652344
Epoch: 7, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.705 Vali Acc: 0.688 Test Loss: 0.705 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1033961772918701
Epoch: 8, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.047 Vali Acc: 0.722 Test Loss: 1.047 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9867935180664062
Epoch: 9, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.870 Vali Acc: 0.717 Test Loss: 0.870 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.068199872970581
Epoch: 10, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.038 Vali Acc: 0.741 Test Loss: 1.038 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2130613327026367
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.955 Vali Acc: 0.702 Test Loss: 0.955 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9990298748016357
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.922 Vali Acc: 0.693 Test Loss: 0.922 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1814682483673096
Epoch: 13, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.094 Vali Acc: 0.722 Test Loss: 1.094 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.188335657119751
Epoch: 14, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.010 Vali Acc: 0.722 Test Loss: 1.010 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 40609538
model size : 169.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps81_str81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.607992172241211
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.0506823062896729
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.8884882926940918
Epoch: 3, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.747 Vali Acc: 0.766 Test Loss: 0.747 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765846).  Saving model ...
Epoch: 4 cost time: 1.087705135345459
Epoch: 4, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1075973510742188
Epoch: 5, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1990532875061035
Epoch: 6, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.634 Vali Acc: 0.693 Test Loss: 0.634 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.284165382385254
Epoch: 7, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.831 Vali Acc: 0.766 Test Loss: 0.831 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0808327198028564
Epoch: 8, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.815 Vali Acc: 0.751 Test Loss: 0.815 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2072665691375732
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.774 Vali Acc: 0.712 Test Loss: 0.774 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2795991897583008
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.850 Vali Acc: 0.732 Test Loss: 0.850 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2459454536437988
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.867 Vali Acc: 0.712 Test Loss: 0.867 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9909005165100098
Epoch: 12, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.953 Vali Acc: 0.741 Test Loss: 0.953 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.281949758529663
Epoch: 13, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.990 Vali Acc: 0.756 Test Loss: 0.990 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el4_dm768_df768_ps81_str81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 40600322
model size : 169.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.0647425651550293
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.861250638961792
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.634 Vali Acc: 0.673 Test Loss: 0.634 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8980727195739746
Epoch: 3, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.613 Vali Acc: 0.698 Test Loss: 0.613 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9481306076049805
Epoch: 4, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
Validation loss decreased (-0.717067 --> -0.760971).  Saving model ...
Epoch: 5 cost time: 0.7999351024627686
Epoch: 5, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.098376989364624
Epoch: 6, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.726 Vali Acc: 0.751 Test Loss: 0.726 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2144880294799805
Epoch: 7, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.678 Vali Acc: 0.751 Test Loss: 0.678 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2486836910247803
Epoch: 8, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.058 Vali Acc: 0.624 Test Loss: 1.058 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9203164577484131
Epoch: 9, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.931 Vali Acc: 0.707 Test Loss: 0.931 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2062373161315918
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.100 Vali Acc: 0.693 Test Loss: 1.100 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2656235694885254
Epoch: 11, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.320 Vali Acc: 0.668 Test Loss: 1.320 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0318195819854736
Epoch: 12, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.193 Vali Acc: 0.712 Test Loss: 1.193 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0374345779418945
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.279 Vali Acc: 0.722 Test Loss: 1.279 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.237553596496582
Epoch: 14, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.379 Vali Acc: 0.741 Test Loss: 1.379 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 24741890
model size : 109.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4105544090270996
Epoch: 1, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.934006929397583
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.665 Vali Acc: 0.722 Test Loss: 0.665 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.9965591430664062
Epoch: 3, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 0.9893269538879395
Epoch: 4, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 0.9832613468170166
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8535788059234619
Epoch: 6, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.601 Vali Acc: 0.712 Test Loss: 0.601 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0905888080596924
Epoch: 7, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1226682662963867
Epoch: 8, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.696 Vali Acc: 0.727 Test Loss: 0.696 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0217878818511963
Epoch: 9, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9341838359832764
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.934 Vali Acc: 0.732 Test Loss: 0.934 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0789716243743896
Epoch: 11, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.011 Vali Acc: 0.683 Test Loss: 1.011 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8505740165710449
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.252 Vali Acc: 0.712 Test Loss: 1.252 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.000389575958252
Epoch: 13, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.283 Vali Acc: 0.620 Test Loss: 1.283 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.934776782989502
Epoch: 14, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.246 Vali Acc: 0.741 Test Loss: 1.246 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 24637442
model size : 108.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.8104376792907715
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.8416979312896729
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.809577226638794
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8460216522216797
Epoch: 4, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 0.6862523555755615
Epoch: 5, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 0.7024414539337158
Epoch: 6, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7247467041015625
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.572 Vali Acc: 0.766 Test Loss: 0.572 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 0.838353157043457
Epoch: 8, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.825 Vali Acc: 0.776 Test Loss: 0.825 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775602).  Saving model ...
Epoch: 9 cost time: 0.6159040927886963
Epoch: 9, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.695 Vali Acc: 0.790 Test Loss: 0.695 Test Acc: 0.790
Validation loss decreased (-0.775602 --> -0.790237).  Saving model ...
Epoch: 10 cost time: 0.6898553371429443
Epoch: 10, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.553 Vali Acc: 0.746 Test Loss: 0.553 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7067890167236328
Epoch: 11, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.193 Vali Acc: 0.605 Test Loss: 1.193 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.903773307800293
Epoch: 12, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9259247779846191
Epoch: 13, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.884 Vali Acc: 0.780 Test Loss: 0.884 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6456282138824463
Epoch: 14, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.867 Vali Acc: 0.678 Test Loss: 0.867 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9406092166900635
Epoch: 15, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.673 Vali Acc: 0.727 Test Loss: 0.673 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6944437026977539
Epoch: 16, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7041349411010742
Epoch: 17, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.176 Vali Acc: 0.761 Test Loss: 1.176 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7777016162872314
Epoch: 18, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.114 Vali Acc: 0.761 Test Loss: 1.114 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9353094100952148
Epoch: 19, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.035 Vali Acc: 0.702 Test Loss: 1.035 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 24572930
model size : 108.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.534742593765259
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0311625003814697
Epoch: 2, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.1344146728515625
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 1.2218866348266602
Epoch: 4, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
Validation loss decreased (-0.756091 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 0.8424074649810791
Epoch: 5, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2278938293457031
Epoch: 6, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.717 Vali Acc: 0.766 Test Loss: 0.717 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765846).  Saving model ...
Epoch: 7 cost time: 1.0402147769927979
Epoch: 7, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.657 Vali Acc: 0.727 Test Loss: 0.657 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0547599792480469
Epoch: 8, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1952383518218994
Epoch: 9, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.285 Vali Acc: 0.659 Test Loss: 1.285 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2166314125061035
Epoch: 10, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.087 Vali Acc: 0.717 Test Loss: 1.087 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0326054096221924
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.443 Vali Acc: 0.620 Test Loss: 1.443 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.003070592880249
Epoch: 12, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.356 Vali Acc: 0.668 Test Loss: 1.356 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1219017505645752
Epoch: 13, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.553 Vali Acc: 0.615 Test Loss: 1.553 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2265994548797607
Epoch: 14, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.522 Vali Acc: 0.693 Test Loss: 1.522 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0926623344421387
Epoch: 15, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.775 Vali Acc: 0.683 Test Loss: 1.775 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.00728178024292
Epoch: 16, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.560 Vali Acc: 0.668 Test Loss: 1.560 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 24882434
model size : 109.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.985783576965332
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.6957252025604248
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.897845983505249
Epoch: 3, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.522 Vali Acc: 0.732 Test Loss: 0.522 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.1354072093963623
Epoch: 4, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.617 Vali Acc: 0.732 Test Loss: 0.617 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9283983707427979
Epoch: 5, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 0.9594354629516602
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 0.6831693649291992
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.626 Vali Acc: 0.756 Test Loss: 0.626 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 0.9849300384521484
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.797 Vali Acc: 0.732 Test Loss: 0.797 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9895484447479248
Epoch: 9, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8371784687042236
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.886 Vali Acc: 0.751 Test Loss: 0.886 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8901042938232422
Epoch: 11, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.846 Vali Acc: 0.741 Test Loss: 0.846 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7901747226715088
Epoch: 12, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.080 Vali Acc: 0.737 Test Loss: 1.080 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0571093559265137
Epoch: 13, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.375 Vali Acc: 0.732 Test Loss: 1.375 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.921938419342041
Epoch: 14, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.362 Vali Acc: 0.610 Test Loss: 1.362 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9949891567230225
Epoch: 15, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.178 Vali Acc: 0.673 Test Loss: 1.178 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.041039228439331
Epoch: 16, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.352 Vali Acc: 0.712 Test Loss: 1.352 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0258393287658691
Epoch: 17, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.235 Vali Acc: 0.712 Test Loss: 1.235 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 24777986
model size : 109.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.198824882507324
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.7106437683105469
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 0.7765355110168457
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.950420618057251
Epoch: 4, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 0.993546724319458
Epoch: 5, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 0.9455063343048096
Epoch: 6, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7011425495147705
Epoch: 7, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 0.7499356269836426
Epoch: 8, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.671 Vali Acc: 0.649 Test Loss: 0.671 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0200748443603516
Epoch: 9, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.624 Vali Acc: 0.693 Test Loss: 0.624 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9370388984680176
Epoch: 10, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.904 Vali Acc: 0.634 Test Loss: 0.904 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.962655782699585
Epoch: 11, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.006 Vali Acc: 0.620 Test Loss: 1.006 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7312102317810059
Epoch: 12, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.786 Vali Acc: 0.717 Test Loss: 0.786 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6926040649414062
Epoch: 13, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.896 Vali Acc: 0.639 Test Loss: 0.896 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7558400630950928
Epoch: 14, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.967 Vali Acc: 0.644 Test Loss: 0.967 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6741368770599365
Epoch: 15, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.053 Vali Acc: 0.688 Test Loss: 1.053 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7217435836791992
Epoch: 16, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.118 Vali Acc: 0.737 Test Loss: 1.118 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8046917915344238
Epoch: 17, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.119 Vali Acc: 0.707 Test Loss: 1.119 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 24710402
model size : 108.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4937219619750977
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.558 Vali Acc: 0.722 Test Loss: 0.558 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.9617552757263184
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.554 Vali Acc: 0.751 Test Loss: 0.554 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.8407938480377197
Epoch: 3, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.520 Vali Acc: 0.732 Test Loss: 0.520 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0541646480560303
Epoch: 4, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.037329912185669
Epoch: 5, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.878 Vali Acc: 0.551 Test Loss: 0.878 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.183847427368164
Epoch: 6, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0035605430603027
Epoch: 7, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.645 Vali Acc: 0.702 Test Loss: 0.645 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0734167098999023
Epoch: 8, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.832 Vali Acc: 0.683 Test Loss: 0.832 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1007790565490723
Epoch: 9, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.841 Vali Acc: 0.707 Test Loss: 0.841 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8396670818328857
Epoch: 10, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.946 Vali Acc: 0.698 Test Loss: 0.946 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.961082935333252
Epoch: 11, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.054 Vali Acc: 0.663 Test Loss: 1.054 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9702351093292236
Epoch: 12, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.189 Vali Acc: 0.659 Test Loss: 1.189 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 25022978
model size : 110.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.9557433128356934
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.552 Vali Acc: 0.756 Test Loss: 0.552 Test Acc: 0.756
Validation loss decreased (inf --> -0.756092).  Saving model ...
Epoch: 2 cost time: 0.8645823001861572
Epoch: 2, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9349889755249023
Epoch: 3, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
Validation loss decreased (-0.756092 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 0.9419214725494385
Epoch: 4, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.568 Vali Acc: 0.766 Test Loss: 0.568 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8109800815582275
Epoch: 5, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.588 Vali Acc: 0.771 Test Loss: 0.588 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.028770923614502
Epoch: 6, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.911 Vali Acc: 0.580 Test Loss: 0.911 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6437582969665527
Epoch: 7, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.673 Vali Acc: 0.659 Test Loss: 0.673 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8882415294647217
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7673652172088623
Epoch: 9, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.864 Vali Acc: 0.663 Test Loss: 0.864 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9105722904205322
Epoch: 10, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.817 Vali Acc: 0.659 Test Loss: 0.817 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7855515480041504
Epoch: 11, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.973 Vali Acc: 0.712 Test Loss: 0.973 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7705249786376953
Epoch: 12, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.023 Vali Acc: 0.717 Test Loss: 1.023 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8944263458251953
Epoch: 13, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.149 Vali Acc: 0.698 Test Loss: 1.149 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 24903170
model size : 109.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3957340717315674
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.610 Vali Acc: 0.722 Test Loss: 0.610 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.7543833255767822
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.7710464000701904
Epoch: 3, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 0.8881518840789795
Epoch: 4, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 0.7684061527252197
Epoch: 5, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.532 Vali Acc: 0.766 Test Loss: 0.532 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 0.6996936798095703
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.557 Vali Acc: 0.756 Test Loss: 0.557 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7048239707946777
Epoch: 7, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.718 Vali Acc: 0.756 Test Loss: 0.718 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9550161361694336
Epoch: 8, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.640 Vali Acc: 0.741 Test Loss: 0.640 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7882349491119385
Epoch: 9, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.764 Vali Acc: 0.741 Test Loss: 0.764 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7904770374298096
Epoch: 10, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.838 Vali Acc: 0.732 Test Loss: 0.838 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7140204906463623
Epoch: 11, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.053 Vali Acc: 0.717 Test Loss: 1.053 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8064210414886475
Epoch: 12, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.268 Vali Acc: 0.712 Test Loss: 1.268 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8435306549072266
Epoch: 13, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.783 Vali Acc: 0.693 Test Loss: 0.783 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8876347541809082
Epoch: 14, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.852 Vali Acc: 0.678 Test Loss: 0.852 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9424030780792236
Epoch: 15, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.348 Vali Acc: 0.595 Test Loss: 1.348 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 24847874
model size : 109.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5820698738098145
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0255300998687744
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.1099045276641846
Epoch: 3, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.498 Vali Acc: 0.756 Test Loss: 0.498 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756093).  Saving model ...
Epoch: 4 cost time: 1.3322999477386475
Epoch: 4, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.524 Vali Acc: 0.761 Test Loss: 0.524 Test Acc: 0.761
Validation loss decreased (-0.756093 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.0905539989471436
Epoch: 5, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.483 Vali Acc: 0.780 Test Loss: 0.483 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780483).  Saving model ...
Epoch: 6 cost time: 1.2852342128753662
Epoch: 6, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.591 Vali Acc: 0.761 Test Loss: 0.591 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.015282154083252
Epoch: 7, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.744 Vali Acc: 0.654 Test Loss: 0.744 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2444853782653809
Epoch: 8, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.037 Vali Acc: 0.722 Test Loss: 1.037 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1355688571929932
Epoch: 9, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.807 Vali Acc: 0.717 Test Loss: 0.807 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9753234386444092
Epoch: 10, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.907 Vali Acc: 0.717 Test Loss: 0.907 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.073282241821289
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.043 Vali Acc: 0.693 Test Loss: 1.043 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.109128713607788
Epoch: 12, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.282 Vali Acc: 0.702 Test Loss: 1.282 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.050138235092163
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.143 Vali Acc: 0.722 Test Loss: 1.143 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.099153995513916
Epoch: 14, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.618 Vali Acc: 0.624 Test Loss: 1.618 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8617868423461914
Epoch: 15, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.655 Vali Acc: 0.649 Test Loss: 1.655 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 25163522
model size : 110.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.521822929382324
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 0.6888084411621094
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.0967566967010498
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0686254501342773
Epoch: 4, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.539 Vali Acc: 0.698 Test Loss: 0.539 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7247283458709717
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.180992603302002
Epoch: 6, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0129210948944092
Epoch: 7, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0418715476989746
Epoch: 8, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.867 Vali Acc: 0.595 Test Loss: 0.867 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9432187080383301
Epoch: 9, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9107153415679932
Epoch: 10, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.735 Vali Acc: 0.702 Test Loss: 0.735 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9141576290130615
Epoch: 11, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.897 Vali Acc: 0.624 Test Loss: 0.897 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1374318599700928
Epoch: 12, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.815 Vali Acc: 0.668 Test Loss: 0.815 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9177858829498291
Epoch: 13, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.234 Vali Acc: 0.590 Test Loss: 1.234 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6853370666503906
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.108 Vali Acc: 0.688 Test Loss: 1.108 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0218279361724854
Epoch: 15, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.176 Vali Acc: 0.712 Test Loss: 1.176 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 25043714
model size : 110.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.1788253784179688
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0580041408538818
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.920609712600708
Epoch: 3, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.8391704559326172
Epoch: 4, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.661 Vali Acc: 0.722 Test Loss: 0.661 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1525609493255615
Epoch: 5, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.546 Vali Acc: 0.722 Test Loss: 0.546 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6011252403259277
Epoch: 6, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 0.9943664073944092
Epoch: 7, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.698 Vali Acc: 0.741 Test Loss: 0.698 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0104153156280518
Epoch: 8, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.037412166595459
Epoch: 9, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.094792366027832
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0894367694854736
Epoch: 11, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.652 Vali Acc: 0.668 Test Loss: 0.652 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0313501358032227
Epoch: 12, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.216 Vali Acc: 0.756 Test Loss: 1.216 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0091760158538818
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.884 Vali Acc: 0.712 Test Loss: 0.884 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.93182373046875
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.976 Vali Acc: 0.727 Test Loss: 0.976 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8930346965789795
Epoch: 15, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.218 Vali Acc: 0.746 Test Loss: 1.218 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7815532684326172
Epoch: 16, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.213 Vali Acc: 0.756 Test Loss: 1.213 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 24985346
model size : 109.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6532742977142334
Epoch: 1, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.660 Vali Acc: 0.659 Test Loss: 0.660 Test Acc: 0.659
Validation loss decreased (inf --> -0.658530).  Saving model ...
Epoch: 2 cost time: 1.3395183086395264
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.536 Vali Acc: 0.756 Test Loss: 0.536 Test Acc: 0.756
Validation loss decreased (-0.658530 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.4734511375427246
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1195154190063477
Epoch: 4, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.549 Vali Acc: 0.766 Test Loss: 0.549 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 1.3640973567962646
Epoch: 5, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.726 Vali Acc: 0.741 Test Loss: 0.726 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.077481985092163
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.650 Vali Acc: 0.688 Test Loss: 0.650 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9568955898284912
Epoch: 7, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3520259857177734
Epoch: 8, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.758 Vali Acc: 0.673 Test Loss: 0.758 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3467254638671875
Epoch: 9, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.002 Vali Acc: 0.737 Test Loss: 1.002 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3254635334014893
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.875 Vali Acc: 0.688 Test Loss: 0.875 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4003028869628906
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.234 Vali Acc: 0.712 Test Loss: 1.234 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.279688835144043
Epoch: 12, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.327 Vali Acc: 0.707 Test Loss: 1.327 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8606123924255371
Epoch: 13, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.406 Vali Acc: 0.698 Test Loss: 1.406 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0899357795715332
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.480 Vali Acc: 0.615 Test Loss: 1.480 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 25264130
model size : 111.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.27790904045105
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.913438081741333
Epoch: 2, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 0.9288885593414307
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 0.7367773056030273
Epoch: 4, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.1381347179412842
Epoch: 5, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.710 Vali Acc: 0.746 Test Loss: 0.710 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8532218933105469
Epoch: 6, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8783881664276123
Epoch: 7, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.598 Vali Acc: 0.702 Test Loss: 0.598 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1242692470550537
Epoch: 8, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.803 Vali Acc: 0.707 Test Loss: 0.803 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0059051513671875
Epoch: 9, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.898 Vali Acc: 0.683 Test Loss: 0.898 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9013779163360596
Epoch: 10, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.919 Vali Acc: 0.707 Test Loss: 0.919 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9642653465270996
Epoch: 11, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.154 Vali Acc: 0.702 Test Loss: 1.154 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0166583061218262
Epoch: 12, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.134 Vali Acc: 0.663 Test Loss: 1.134 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9747533798217773
Epoch: 13, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.163 Vali Acc: 0.624 Test Loss: 1.163 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9988129138946533
Epoch: 14, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.138 Vali Acc: 0.668 Test Loss: 1.138 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 25171970
model size : 110.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2358126640319824
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.9234635829925537
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.9891812801361084
Epoch: 3, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.736580 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 0.8465795516967773
Epoch: 4, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.498 Vali Acc: 0.751 Test Loss: 0.498 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6880533695220947
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.539 Vali Acc: 0.722 Test Loss: 0.539 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0271141529083252
Epoch: 6, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0153939723968506
Epoch: 7, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.649 Vali Acc: 0.751 Test Loss: 0.649 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8470516204833984
Epoch: 8, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.734 Vali Acc: 0.776 Test Loss: 0.734 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775602).  Saving model ...
Epoch: 9 cost time: 0.9536683559417725
Epoch: 9, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8837473392486572
Epoch: 10, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.882 Vali Acc: 0.746 Test Loss: 0.882 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6574292182922363
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.754 Vali Acc: 0.702 Test Loss: 0.754 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8466260433197021
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.753 Vali Acc: 0.698 Test Loss: 0.753 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7919421195983887
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.872 Vali Acc: 0.746 Test Loss: 0.872 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6181232929229736
Epoch: 14, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.114 Vali Acc: 0.756 Test Loss: 1.114 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9476571083068848
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.953 Vali Acc: 0.756 Test Loss: 0.953 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.037086009979248
Epoch: 16, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.063 Vali Acc: 0.746 Test Loss: 1.063 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9751918315887451
Epoch: 17, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.327 Vali Acc: 0.737 Test Loss: 1.327 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9752359390258789
Epoch: 18, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.148 Vali Acc: 0.727 Test Loss: 1.148 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 25122818
model size : 110.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4744672775268555
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2953617572784424
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.3066601753234863
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.752 Vali Acc: 0.722 Test Loss: 0.752 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2548651695251465
Epoch: 4, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2633945941925049
Epoch: 5, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.680 Vali Acc: 0.751 Test Loss: 0.680 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2972829341888428
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2640528678894043
Epoch: 7, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3105876445770264
Epoch: 8, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.712 Vali Acc: 0.663 Test Loss: 0.712 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2917325496673584
Epoch: 9, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.777 Vali Acc: 0.741 Test Loss: 0.777 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3504347801208496
Epoch: 10, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.967 Vali Acc: 0.727 Test Loss: 0.967 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3491814136505127
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.950 Vali Acc: 0.717 Test Loss: 0.950 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3423690795898438
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.063 Vali Acc: 0.746 Test Loss: 1.063 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 25401602
model size : 111.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8011319637298584
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0271778106689453
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.1261353492736816
Epoch: 3, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.551 Vali Acc: 0.761 Test Loss: 0.551 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.9860100746154785
Epoch: 4, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.519 Vali Acc: 0.751 Test Loss: 0.519 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.055448293685913
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.657 Vali Acc: 0.629 Test Loss: 0.657 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9317712783813477
Epoch: 6, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.665 Vali Acc: 0.654 Test Loss: 0.665 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1000397205352783
Epoch: 7, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.615 Vali Acc: 0.702 Test Loss: 0.615 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0716145038604736
Epoch: 8, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.672 Vali Acc: 0.712 Test Loss: 0.672 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9782562255859375
Epoch: 9, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.377 Vali Acc: 0.576 Test Loss: 1.377 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.715080976486206
Epoch: 10, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.901 Vali Acc: 0.654 Test Loss: 0.901 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9181418418884277
Epoch: 11, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0999228954315186
Epoch: 12, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.154 Vali Acc: 0.702 Test Loss: 1.154 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0511574745178223
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.517 Vali Acc: 0.741 Test Loss: 1.517 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 25312514
model size : 111.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.032249689102173
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8270378112792969
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.8571813106536865
Epoch: 3, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8443255424499512
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.526 Vali Acc: 0.756 Test Loss: 0.526 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 0.8726370334625244
Epoch: 5, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.504 Vali Acc: 0.751 Test Loss: 0.504 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.793208122253418
Epoch: 6, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9483530521392822
Epoch: 7, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8443341255187988
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.665 Vali Acc: 0.688 Test Loss: 0.665 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9376914501190186
Epoch: 9, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.663 Vali Acc: 0.698 Test Loss: 0.663 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9257254600524902
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.709 Vali Acc: 0.712 Test Loss: 0.709 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7928910255432129
Epoch: 11, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.804 Vali Acc: 0.707 Test Loss: 0.804 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9743897914886475
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8688287734985352
Epoch: 13, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.115 Vali Acc: 0.766 Test Loss: 1.115 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765843).  Saving model ...
Epoch: 14 cost time: 0.9491512775421143
Epoch: 14, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.963 Vali Acc: 0.756 Test Loss: 0.963 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9632778167724609
Epoch: 15, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.944 Vali Acc: 0.707 Test Loss: 0.944 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8775551319122314
Epoch: 16, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.961 Vali Acc: 0.683 Test Loss: 0.961 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9263191223144531
Epoch: 17, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.264 Vali Acc: 0.634 Test Loss: 1.264 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9294486045837402
Epoch: 18, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.030 Vali Acc: 0.717 Test Loss: 1.030 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8138022422790527
Epoch: 19, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.966 Vali Acc: 0.737 Test Loss: 0.966 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8410978317260742
Epoch: 20, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.111 Vali Acc: 0.737 Test Loss: 1.111 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.919567346572876
Epoch: 21, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.201 Vali Acc: 0.673 Test Loss: 1.201 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8246932029724121
Epoch: 22, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.321 Vali Acc: 0.722 Test Loss: 1.321 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.926555871963501
Epoch: 23, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.201 Vali Acc: 0.693 Test Loss: 1.201 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 25260290
model size : 111.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.665085792541504
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.235884189605713
Epoch: 2, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.526 Vali Acc: 0.751 Test Loss: 0.526 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9486141204833984
Epoch: 3, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3669211864471436
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.585 Vali Acc: 0.693 Test Loss: 0.585 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2569005489349365
Epoch: 5, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1553442478179932
Epoch: 6, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.706 Vali Acc: 0.741 Test Loss: 0.706 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2097249031066895
Epoch: 7, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0726065635681152
Epoch: 8, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.910 Vali Acc: 0.776 Test Loss: 0.910 Test Acc: 0.776
Validation loss decreased (-0.751214 --> -0.775601).  Saving model ...
Epoch: 9 cost time: 1.215987205505371
Epoch: 9, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.818 Vali Acc: 0.722 Test Loss: 0.818 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.157501220703125
Epoch: 10, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.925 Vali Acc: 0.707 Test Loss: 0.925 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2731871604919434
Epoch: 11, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.162 Vali Acc: 0.717 Test Loss: 1.162 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2848913669586182
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.978 Vali Acc: 0.683 Test Loss: 0.978 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0988988876342773
Epoch: 13, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.357 Vali Acc: 0.746 Test Loss: 1.357 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2753660678863525
Epoch: 14, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.262 Vali Acc: 0.663 Test Loss: 1.262 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2508885860443115
Epoch: 15, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.513 Vali Acc: 0.639 Test Loss: 1.513 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.258491039276123
Epoch: 16, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.634 Vali Acc: 0.732 Test Loss: 1.634 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2405526638031006
Epoch: 17, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.420 Vali Acc: 0.702 Test Loss: 1.420 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.050462245941162
Epoch: 18, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.496 Vali Acc: 0.693 Test Loss: 1.496 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 25542146
model size : 112.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4804887771606445
Epoch: 1, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.676 Vali Acc: 0.722 Test Loss: 0.676 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.0883798599243164
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (-0.721944 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 0.9781508445739746
Epoch: 3, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.9447188377380371
Epoch: 4, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.544 Vali Acc: 0.751 Test Loss: 0.544 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.074202537536621
Epoch: 5, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8915584087371826
Epoch: 6, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.851 Vali Acc: 0.746 Test Loss: 0.851 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.964540958404541
Epoch: 7, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.971977949142456
Epoch: 8, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9738192558288574
Epoch: 9, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.884 Vali Acc: 0.761 Test Loss: 0.884 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760967).  Saving model ...
Epoch: 10 cost time: 0.9968047142028809
Epoch: 10, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.795 Vali Acc: 0.751 Test Loss: 0.795 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0513513088226318
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.812 Vali Acc: 0.746 Test Loss: 0.812 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0528547763824463
Epoch: 12, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.820 Vali Acc: 0.707 Test Loss: 0.820 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9012730121612549
Epoch: 13, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.132 Vali Acc: 0.678 Test Loss: 1.132 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9441044330596924
Epoch: 14, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.903 Vali Acc: 0.668 Test Loss: 0.903 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9805679321289062
Epoch: 15, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.376 Vali Acc: 0.702 Test Loss: 1.376 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0425260066986084
Epoch: 16, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.167 Vali Acc: 0.659 Test Loss: 1.167 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0075273513793945
Epoch: 17, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.290 Vali Acc: 0.693 Test Loss: 1.290 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9100663661956787
Epoch: 18, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.284 Vali Acc: 0.717 Test Loss: 1.284 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9440877437591553
Epoch: 19, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.161 Vali Acc: 0.707 Test Loss: 1.161 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 25443842
model size : 111.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3249480724334717
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.834740400314331
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 0.6892645359039307
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 0.951324462890625
Epoch: 4, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 0.7639029026031494
Epoch: 5, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.633 Vali Acc: 0.751 Test Loss: 0.633 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6714081764221191
Epoch: 6, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7379364967346191
Epoch: 7, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.624 Vali Acc: 0.698 Test Loss: 0.624 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7618927955627441
Epoch: 8, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6233735084533691
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.696 Vali Acc: 0.722 Test Loss: 0.696 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6704797744750977
Epoch: 10, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.906 Vali Acc: 0.741 Test Loss: 0.906 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7505242824554443
Epoch: 11, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.751 Vali Acc: 0.732 Test Loss: 0.751 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6905384063720703
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.777 Vali Acc: 0.698 Test Loss: 0.777 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.78240966796875
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.879 Vali Acc: 0.673 Test Loss: 0.879 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9200854301452637
Epoch: 14, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.916 Vali Acc: 0.707 Test Loss: 0.916 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 25397762
model size : 111.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2502524852752686
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.0233075618743896
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.560 Vali Acc: 0.751 Test Loss: 0.560 Test Acc: 0.751
Validation loss decreased (-0.717068 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9898374080657959
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.512 Vali Acc: 0.741 Test Loss: 0.512 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8022749423980713
Epoch: 4, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1236231327056885
Epoch: 5, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0281310081481934
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.680 Vali Acc: 0.751 Test Loss: 0.680 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7547523975372314
Epoch: 7, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1655573844909668
Epoch: 8, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1911942958831787
Epoch: 9, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.854 Vali Acc: 0.712 Test Loss: 0.854 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9942281246185303
Epoch: 10, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.969 Vali Acc: 0.746 Test Loss: 0.969 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2360565662384033
Epoch: 11, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.332 Vali Acc: 0.741 Test Loss: 1.332 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2268476486206055
Epoch: 12, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.405 Vali Acc: 0.727 Test Loss: 1.405 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 25682690
model size : 112.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5586490631103516
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.6845824718475342
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.8726339340209961
Epoch: 3, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 0.9945816993713379
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8846209049224854
Epoch: 5, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.518 Vali Acc: 0.766 Test Loss: 0.518 Test Acc: 0.766
Validation loss decreased (-0.736579 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 0.786745548248291
Epoch: 6, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.640 Vali Acc: 0.673 Test Loss: 0.640 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0564446449279785
Epoch: 7, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.542 Vali Acc: 0.717 Test Loss: 0.542 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8600914478302002
Epoch: 8, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.614 Vali Acc: 0.668 Test Loss: 0.614 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8662171363830566
Epoch: 9, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.007 Vali Acc: 0.580 Test Loss: 1.007 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0913059711456299
Epoch: 10, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.761 Vali Acc: 0.688 Test Loss: 0.761 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.822533130645752
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.796 Vali Acc: 0.683 Test Loss: 0.796 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1154859066009521
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.889 Vali Acc: 0.683 Test Loss: 0.889 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0256166458129883
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.019 Vali Acc: 0.717 Test Loss: 1.019 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7868971824645996
Epoch: 14, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.821 Vali Acc: 0.683 Test Loss: 0.821 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9426157474517822
Epoch: 15, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.040 Vali Acc: 0.663 Test Loss: 1.040 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 25584386
model size : 112.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.9706032276153564
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0034987926483154
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.020792007446289
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.8353703022003174
Epoch: 4, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.559 Vali Acc: 0.741 Test Loss: 0.559 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8210124969482422
Epoch: 5, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.530 Vali Acc: 0.737 Test Loss: 0.530 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9098360538482666
Epoch: 6, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0287394523620605
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.957500696182251
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.753 Vali Acc: 0.702 Test Loss: 0.753 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8854553699493408
Epoch: 9, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.798 Vali Acc: 0.707 Test Loss: 0.798 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9440257549285889
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.743 Vali Acc: 0.771 Test Loss: 0.743 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770724).  Saving model ...
Epoch: 11 cost time: 1.0899379253387451
Epoch: 11, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.957 Vali Acc: 0.673 Test Loss: 0.957 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9071781635284424
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.924 Vali Acc: 0.668 Test Loss: 0.924 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8732914924621582
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.033 Vali Acc: 0.746 Test Loss: 1.033 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9850709438323975
Epoch: 14, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.967 Vali Acc: 0.707 Test Loss: 0.967 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7667834758758545
Epoch: 15, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.038 Vali Acc: 0.702 Test Loss: 1.038 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7937173843383789
Epoch: 16, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.245 Vali Acc: 0.722 Test Loss: 1.245 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.011291742324829
Epoch: 17, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.855 Vali Acc: 0.712 Test Loss: 0.855 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.967252254486084
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.031 Vali Acc: 0.712 Test Loss: 1.031 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9583685398101807
Epoch: 19, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.310 Vali Acc: 0.659 Test Loss: 1.310 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7562923431396484
Epoch: 20, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.885 Vali Acc: 0.683 Test Loss: 0.885 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 25535234
model size : 112.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4916915893554688
Epoch: 1, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0963494777679443
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.254103422164917
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.2731482982635498
Epoch: 4, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1362321376800537
Epoch: 5, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.769 Vali Acc: 0.741 Test Loss: 0.769 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.224264144897461
Epoch: 6, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.753 Vali Acc: 0.746 Test Loss: 0.753 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1323564052581787
Epoch: 7, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2191147804260254
Epoch: 8, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0504074096679688
Epoch: 9, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.778 Vali Acc: 0.722 Test Loss: 0.778 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.233180284500122
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.424 Vali Acc: 0.761 Test Loss: 1.424 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760961).  Saving model ...
Epoch: 11 cost time: 1.2168302536010742
Epoch: 11, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.703 Vali Acc: 0.756 Test Loss: 1.703 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.089475154876709
Epoch: 12, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.996 Vali Acc: 0.727 Test Loss: 0.996 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1173138618469238
Epoch: 13, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.282 Vali Acc: 0.741 Test Loss: 1.282 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1163432598114014
Epoch: 14, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.300 Vali Acc: 0.746 Test Loss: 1.300 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.007899284362793
Epoch: 15, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.322 Vali Acc: 0.756 Test Loss: 1.322 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0254311561584473
Epoch: 16, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.089 Vali Acc: 0.707 Test Loss: 1.089 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9904770851135254
Epoch: 17, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.670 Vali Acc: 0.644 Test Loss: 1.670 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0010783672332764
Epoch: 18, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.179 Vali Acc: 0.673 Test Loss: 1.179 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9607062339782715
Epoch: 19, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.346 Vali Acc: 0.732 Test Loss: 1.346 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.991004467010498
Epoch: 20, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.404 Vali Acc: 0.741 Test Loss: 1.404 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 25936130
model size : 113.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.218179941177368
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9589531421661377
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.8211460113525391
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.9917528629302979
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 0.6577112674713135
Epoch: 5, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6337544918060303
Epoch: 6, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7566041946411133
Epoch: 7, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.659 Vali Acc: 0.751 Test Loss: 0.659 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8165967464447021
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.907 Vali Acc: 0.766 Test Loss: 0.907 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765845).  Saving model ...
Epoch: 9 cost time: 0.9205925464630127
Epoch: 9, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.939 Vali Acc: 0.756 Test Loss: 0.939 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8237359523773193
Epoch: 10, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.057 Vali Acc: 0.776 Test Loss: 1.057 Test Acc: 0.776
Validation loss decreased (-0.765845 --> -0.775599).  Saving model ...
Epoch: 11 cost time: 0.793367862701416
Epoch: 11, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.749 Vali Acc: 0.683 Test Loss: 0.749 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9261689186096191
Epoch: 12, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.888 Vali Acc: 0.683 Test Loss: 0.888 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9040522575378418
Epoch: 13, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.952 Vali Acc: 0.732 Test Loss: 0.952 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0708186626434326
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.922 Vali Acc: 0.737 Test Loss: 0.922 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9203741550445557
Epoch: 15, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.263 Vali Acc: 0.746 Test Loss: 1.263 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8788900375366211
Epoch: 16, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.987 Vali Acc: 0.741 Test Loss: 0.987 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.025134563446045
Epoch: 17, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.039 Vali Acc: 0.722 Test Loss: 1.039 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8525817394256592
Epoch: 18, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.036 Vali Acc: 0.737 Test Loss: 1.036 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9763760566711426
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.350 Vali Acc: 0.741 Test Loss: 1.350 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9315407276153564
Epoch: 20, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.170 Vali Acc: 0.732 Test Loss: 1.170 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 25859330
model size : 113.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.0764479637145996
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.720844030380249
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.532 Vali Acc: 0.717 Test Loss: 0.532 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 0.8110558986663818
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
Validation loss decreased (-0.717068 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.760096549987793
Epoch: 4, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7461502552032471
Epoch: 5, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.568 Vali Acc: 0.693 Test Loss: 0.568 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8438267707824707
Epoch: 6, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
Validation loss decreased (-0.756092 --> -0.775605).  Saving model ...
Epoch: 7 cost time: 0.7662074565887451
Epoch: 7, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7597091197967529
Epoch: 8, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.746 Vali Acc: 0.756 Test Loss: 0.746 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7629544734954834
Epoch: 9, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.735 Vali Acc: 0.761 Test Loss: 0.735 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7091314792633057
Epoch: 10, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.797 Vali Acc: 0.751 Test Loss: 0.797 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8253002166748047
Epoch: 11, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.053 Vali Acc: 0.727 Test Loss: 1.053 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8038389682769775
Epoch: 12, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.950 Vali Acc: 0.712 Test Loss: 0.950 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6743078231811523
Epoch: 13, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.168 Vali Acc: 0.741 Test Loss: 1.168 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8065829277038574
Epoch: 14, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.335 Vali Acc: 0.761 Test Loss: 1.335 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8401520252227783
Epoch: 15, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.005 Vali Acc: 0.751 Test Loss: 1.005 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7330570220947266
Epoch: 16, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.907 Vali Acc: 0.668 Test Loss: 0.907 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 25813250
model size : 113.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6108922958374023
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.025698184967041
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.0734906196594238
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0479271411895752
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1103849411010742
Epoch: 5, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 1.0749194622039795
Epoch: 6, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.667 Vali Acc: 0.712 Test Loss: 0.667 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.10532808303833
Epoch: 7, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.697 Vali Acc: 0.732 Test Loss: 0.697 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.184363842010498
Epoch: 8, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.799 Vali Acc: 0.746 Test Loss: 0.799 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1624915599822998
Epoch: 9, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.871 Vali Acc: 0.693 Test Loss: 0.871 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1048269271850586
Epoch: 10, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.812 Vali Acc: 0.693 Test Loss: 0.812 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.001467227935791
Epoch: 11, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.946 Vali Acc: 0.673 Test Loss: 0.946 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.228079080581665
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.991 Vali Acc: 0.688 Test Loss: 0.991 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0868847370147705
Epoch: 13, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.941 Vali Acc: 0.688 Test Loss: 0.941 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9506645202636719
Epoch: 14, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.990 Vali Acc: 0.683 Test Loss: 0.990 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9817545413970947
Epoch: 15, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.425 Vali Acc: 0.771 Test Loss: 1.425 Test Acc: 0.771
Validation loss decreased (-0.746335 --> -0.770717).  Saving model ...
Epoch: 16 cost time: 0.972266435623169
Epoch: 16, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.580 Vali Acc: 0.741 Test Loss: 1.580 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9778082370758057
Epoch: 17, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.068 Vali Acc: 0.717 Test Loss: 1.068 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.045454978942871
Epoch: 18, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.283 Vali Acc: 0.737 Test Loss: 1.283 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9381353855133057
Epoch: 19, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.524 Vali Acc: 0.624 Test Loss: 1.524 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0765182971954346
Epoch: 20, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.820 Vali Acc: 0.732 Test Loss: 1.820 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0241432189941406
Epoch: 21, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.593 Vali Acc: 0.654 Test Loss: 1.593 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.114323377609253
Epoch: 22, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.357 Vali Acc: 0.673 Test Loss: 1.357 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9312927722930908
Epoch: 23, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.416 Vali Acc: 0.683 Test Loss: 1.416 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1520276069641113
Epoch: 24, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.646 Vali Acc: 0.688 Test Loss: 1.646 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.960261344909668
Epoch: 25, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.943 Vali Acc: 0.654 Test Loss: 1.943 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 26076674
model size : 114.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.169924736022949
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.7420516014099121
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 0.7354707717895508
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.8153243064880371
Epoch: 4, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8738243579864502
Epoch: 5, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 0.7501540184020996
Epoch: 6, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.839282751083374
Epoch: 7, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 8 cost time: 0.8000786304473877
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.642 Vali Acc: 0.727 Test Loss: 0.642 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6376519203186035
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.893 Vali Acc: 0.727 Test Loss: 0.893 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8168108463287354
Epoch: 10, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.831 Vali Acc: 0.741 Test Loss: 0.831 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9341928958892822
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.021 Vali Acc: 0.678 Test Loss: 1.021 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7779746055603027
Epoch: 12, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.952 Vali Acc: 0.712 Test Loss: 0.952 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7613873481750488
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.060 Vali Acc: 0.698 Test Loss: 1.060 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7772083282470703
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.238 Vali Acc: 0.717 Test Loss: 1.238 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8876760005950928
Epoch: 15, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.264 Vali Acc: 0.717 Test Loss: 1.264 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.879631519317627
Epoch: 16, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.260 Vali Acc: 0.688 Test Loss: 1.260 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6736328601837158
Epoch: 17, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.292 Vali Acc: 0.683 Test Loss: 1.292 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 25993730
model size : 113.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.6968529224395752
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.7775053977966309
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.546 Vali Acc: 0.751 Test Loss: 0.546 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.7991969585418701
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.6368646621704102
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7595710754394531
Epoch: 5, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6521098613739014
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.769 Vali Acc: 0.639 Test Loss: 0.769 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5678412914276123
Epoch: 7, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.867 Vali Acc: 0.737 Test Loss: 0.867 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5569510459899902
Epoch: 8, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.610 Vali Acc: 0.702 Test Loss: 0.610 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6371023654937744
Epoch: 9, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.685 Vali Acc: 0.702 Test Loss: 0.685 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8487861156463623
Epoch: 10, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.739 Vali Acc: 0.693 Test Loss: 0.739 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6909060478210449
Epoch: 11, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6786940097808838
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.752 Vali Acc: 0.712 Test Loss: 0.752 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7937109470367432
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.852 Vali Acc: 0.746 Test Loss: 0.852 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 25953794
model size : 113.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5248196125030518
Epoch: 1, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.1055238246917725
Epoch: 2, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9301033020019531
Epoch: 3, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.661 Vali Acc: 0.766 Test Loss: 0.661 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765847).  Saving model ...
Epoch: 4 cost time: 0.9569978713989258
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.574 Vali Acc: 0.678 Test Loss: 0.574 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.828209400177002
Epoch: 5, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.530 Vali Acc: 0.727 Test Loss: 0.530 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0472376346588135
Epoch: 6, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.600 Vali Acc: 0.707 Test Loss: 0.600 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9550337791442871
Epoch: 7, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.627 Vali Acc: 0.727 Test Loss: 0.627 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8307304382324219
Epoch: 8, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.765 Vali Acc: 0.673 Test Loss: 0.765 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8738358020782471
Epoch: 9, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.239 Vali Acc: 0.659 Test Loss: 1.239 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9007053375244141
Epoch: 10, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.769 Vali Acc: 0.688 Test Loss: 0.769 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.90234375
Epoch: 11, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.808 Vali Acc: 0.688 Test Loss: 0.808 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7318341732025146
Epoch: 12, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.181 Vali Acc: 0.712 Test Loss: 1.181 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0859191417694092
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.102 Vali Acc: 0.683 Test Loss: 1.102 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 26336258
model size : 115.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.173769474029541
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.8694806098937988
Epoch: 2, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 0.7974765300750732
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.0533361434936523
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.534 Vali Acc: 0.732 Test Loss: 0.534 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9187839031219482
Epoch: 5, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.650 Vali Acc: 0.678 Test Loss: 0.650 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9804403781890869
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.646 Vali Acc: 0.707 Test Loss: 0.646 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7478575706481934
Epoch: 7, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.714 Vali Acc: 0.727 Test Loss: 0.714 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6697728633880615
Epoch: 8, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.718 Vali Acc: 0.673 Test Loss: 0.718 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8964841365814209
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.919 Vali Acc: 0.702 Test Loss: 0.919 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6440985202789307
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.326 Vali Acc: 0.576 Test Loss: 1.326 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0126850605010986
Epoch: 11, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.814 Vali Acc: 0.702 Test Loss: 0.814 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.870405912399292
Epoch: 12, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.075 Vali Acc: 0.727 Test Loss: 1.075 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8258225917816162
Epoch: 13, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.900 Vali Acc: 0.693 Test Loss: 0.900 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 26268674
model size : 114.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2053985595703125
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 0.8506433963775635
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 0.7618565559387207
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 0.7183983325958252
Epoch: 4, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 0.8776414394378662
Epoch: 5, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.534 Vali Acc: 0.722 Test Loss: 0.534 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7775416374206543
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.617 Vali Acc: 0.771 Test Loss: 0.617 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 0.5930430889129639
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.776 Vali Acc: 0.663 Test Loss: 0.776 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6990780830383301
Epoch: 8, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.664 Vali Acc: 0.693 Test Loss: 0.664 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7157363891601562
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.707 Vali Acc: 0.673 Test Loss: 0.707 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.692385196685791
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.772 Vali Acc: 0.727 Test Loss: 0.772 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8405611515045166
Epoch: 11, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.886 Vali Acc: 0.751 Test Loss: 0.886 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7382268905639648
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.903 Vali Acc: 0.751 Test Loss: 0.903 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7175884246826172
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.909 Vali Acc: 0.722 Test Loss: 0.909 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6388459205627441
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.069 Vali Acc: 0.751 Test Loss: 1.069 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7595746517181396
Epoch: 15, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.982 Vali Acc: 0.746 Test Loss: 0.982 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6856973171234131
Epoch: 16, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.044 Vali Acc: 0.741 Test Loss: 1.044 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 26228738
model size : 114.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7390153408050537
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.1498348712921143
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.516 Vali Acc: 0.756 Test Loss: 0.516 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.030135154724121
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.512 Vali Acc: 0.751 Test Loss: 0.512 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9492199420928955
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.058039665222168
Epoch: 5, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.533 Vali Acc: 0.732 Test Loss: 0.533 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1048755645751953
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.585 Vali Acc: 0.741 Test Loss: 0.585 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2459607124328613
Epoch: 7, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.630 Vali Acc: 0.702 Test Loss: 0.630 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1761667728424072
Epoch: 8, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.774 Vali Acc: 0.702 Test Loss: 0.774 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0523173809051514
Epoch: 9, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.935 Vali Acc: 0.717 Test Loss: 0.935 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9856607913970947
Epoch: 10, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.863 Vali Acc: 0.722 Test Loss: 0.863 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9756126403808594
Epoch: 11, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.198 Vali Acc: 0.629 Test Loss: 1.198 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.139486312866211
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.053 Vali Acc: 0.698 Test Loss: 1.053 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.032989263534546
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.247 Vali Acc: 0.737 Test Loss: 1.247 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1099777221679688
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.165 Vali Acc: 0.741 Test Loss: 1.165 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 26754818
model size : 116.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.8667247295379639
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.6975390911102295
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.8566739559173584
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.525 Vali Acc: 0.771 Test Loss: 0.525 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 0.919999361038208
Epoch: 4, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.873591423034668
Epoch: 5, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7102665901184082
Epoch: 6, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.651 Vali Acc: 0.688 Test Loss: 0.651 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8796522617340088
Epoch: 7, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.297 Vali Acc: 0.580 Test Loss: 1.297 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8238675594329834
Epoch: 8, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.606 Vali Acc: 0.659 Test Loss: 0.606 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7775914669036865
Epoch: 9, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.784 Vali Acc: 0.673 Test Loss: 0.784 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8775436878204346
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.833 Vali Acc: 0.668 Test Loss: 0.833 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9504380226135254
Epoch: 11, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.792 Vali Acc: 0.663 Test Loss: 0.792 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7154083251953125
Epoch: 12, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.096 Vali Acc: 0.741 Test Loss: 1.096 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8422238826751709
Epoch: 13, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.986 Vali Acc: 0.702 Test Loss: 0.986 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 26684162
model size : 116.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.153351068496704
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8254468441009521
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.6155910491943359
Epoch: 3, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.7530868053436279
Epoch: 4, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.515 Vali Acc: 0.737 Test Loss: 0.515 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7121195793151855
Epoch: 5, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.631417989730835
Epoch: 6, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.743 Vali Acc: 0.756 Test Loss: 0.743 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.770118236541748
Epoch: 7, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.728 Vali Acc: 0.751 Test Loss: 0.728 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7410764694213867
Epoch: 8, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.676 Vali Acc: 0.673 Test Loss: 0.676 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6484034061431885
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7991156578063965
Epoch: 10, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.684 Vali Acc: 0.732 Test Loss: 0.684 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7160589694976807
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.754 Vali Acc: 0.707 Test Loss: 0.754 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7275078296661377
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760966).  Saving model ...
Epoch: 13 cost time: 0.6119940280914307
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.081 Vali Acc: 0.766 Test Loss: 1.081 Test Acc: 0.766
Validation loss decreased (-0.760966 --> -0.765843).  Saving model ...
Epoch: 14 cost time: 0.6289887428283691
Epoch: 14, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.990 Vali Acc: 0.698 Test Loss: 0.990 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6731128692626953
Epoch: 15, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.920 Vali Acc: 0.737 Test Loss: 0.920 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.629321813583374
Epoch: 16, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.264 Vali Acc: 0.756 Test Loss: 1.264 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6413025856018066
Epoch: 17, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.215 Vali Acc: 0.756 Test Loss: 1.215 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6431424617767334
Epoch: 18, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.178 Vali Acc: 0.639 Test Loss: 1.178 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6427438259124756
Epoch: 19, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.199 Vali Acc: 0.678 Test Loss: 1.199 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6645190715789795
Epoch: 20, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.203 Vali Acc: 0.698 Test Loss: 1.203 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6546902656555176
Epoch: 21, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.265 Vali Acc: 0.727 Test Loss: 1.265 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6891899108886719
Epoch: 22, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.095 Vali Acc: 0.693 Test Loss: 1.095 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8565075397491455
Epoch: 23, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.105 Vali Acc: 0.683 Test Loss: 1.105 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 26647298
model size : 116.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.422321319580078
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.0493419170379639
Epoch: 2, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 1.0663199424743652
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 0.9923079013824463
Epoch: 4, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.500 Vali Acc: 0.751 Test Loss: 0.500 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751215).  Saving model ...
Epoch: 5 cost time: 1.1248676776885986
Epoch: 5, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.214599609375
Epoch: 6, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.779329776763916
Epoch: 7, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
Validation loss decreased (-0.751215 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 1.0750885009765625
Epoch: 8, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.704 Vali Acc: 0.766 Test Loss: 0.704 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 9 cost time: 1.235764503479004
Epoch: 9, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.685 Vali Acc: 0.693 Test Loss: 0.685 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2033116817474365
Epoch: 10, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.824 Vali Acc: 0.688 Test Loss: 0.824 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1614680290222168
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.753 Vali Acc: 0.702 Test Loss: 0.753 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.126549482345581
Epoch: 12, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.058 Vali Acc: 0.673 Test Loss: 1.058 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0622591972351074
Epoch: 13, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.819 Vali Acc: 0.693 Test Loss: 0.819 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1705362796783447
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.134 Vali Acc: 0.673 Test Loss: 1.134 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.174600601196289
Epoch: 15, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.205 Vali Acc: 0.668 Test Loss: 1.205 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9818909168243408
Epoch: 16, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.239 Vali Acc: 0.707 Test Loss: 1.239 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0808703899383545
Epoch: 17, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.320 Vali Acc: 0.649 Test Loss: 1.320 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1680917739868164
Epoch: 18, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.333 Vali Acc: 0.693 Test Loss: 1.333 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 27020546
model size : 117.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3219408988952637
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.040930986404419
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (-0.717068 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.9901828765869141
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.9575972557067871
Epoch: 4, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9053692817687988
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.560 Vali Acc: 0.746 Test Loss: 0.560 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9536607265472412
Epoch: 6, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.731 Vali Acc: 0.780 Test Loss: 0.731 Test Acc: 0.780
Validation loss decreased (-0.756092 --> -0.780480).  Saving model ...
Epoch: 7 cost time: 1.0092484951019287
Epoch: 7, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9314782619476318
Epoch: 8, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.941 Vali Acc: 0.732 Test Loss: 0.941 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.876049280166626
Epoch: 9, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.720 Vali Acc: 0.702 Test Loss: 0.720 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9815280437469482
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.877 Vali Acc: 0.741 Test Loss: 0.877 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.033064365386963
Epoch: 11, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.989 Vali Acc: 0.717 Test Loss: 0.989 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0053045749664307
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.051 Vali Acc: 0.737 Test Loss: 1.051 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9935810565948486
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.937 Vali Acc: 0.698 Test Loss: 0.937 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0001723766326904
Epoch: 14, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.834 Vali Acc: 0.702 Test Loss: 0.834 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9180073738098145
Epoch: 15, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.026 Vali Acc: 0.732 Test Loss: 1.026 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.838125467300415
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.294 Vali Acc: 0.751 Test Loss: 1.294 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 26959106
model size : 117.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.000372886657715
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.661 Vali Acc: 0.722 Test Loss: 0.661 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8269093036651611
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.7689743041992188
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.8446438312530518
Epoch: 4, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.518 Vali Acc: 0.717 Test Loss: 0.518 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7411811351776123
Epoch: 5, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.668 Vali Acc: 0.727 Test Loss: 0.668 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8505094051361084
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.619 Vali Acc: 0.746 Test Loss: 0.619 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8713412284851074
Epoch: 7, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.595 Vali Acc: 0.751 Test Loss: 0.595 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7677781581878662
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8818788528442383
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8955786228179932
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.752 Vali Acc: 0.722 Test Loss: 0.752 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7497434616088867
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.688 Vali Acc: 0.668 Test Loss: 0.688 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.892672061920166
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.859 Vali Acc: 0.634 Test Loss: 0.859 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8327138423919678
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.862 Vali Acc: 0.707 Test Loss: 0.862 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 26925314
model size : 117.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3365092277526855
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9552655220031738
Epoch: 2, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
Validation loss decreased (-0.721945 --> -0.775604).  Saving model ...
Epoch: 3 cost time: 1.0756986141204834
Epoch: 3, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.548 Vali Acc: 0.751 Test Loss: 0.548 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9208235740661621
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.599 Vali Acc: 0.693 Test Loss: 0.599 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0738165378570557
Epoch: 5, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0105674266815186
Epoch: 6, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.640998363494873
Epoch: 7, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.743 Vali Acc: 0.702 Test Loss: 0.743 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7016117572784424
Epoch: 8, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.103 Vali Acc: 0.610 Test Loss: 1.103 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0090539455413818
Epoch: 9, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.799 Vali Acc: 0.683 Test Loss: 0.799 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9803245067596436
Epoch: 10, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.963 Vali Acc: 0.727 Test Loss: 0.963 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0551271438598633
Epoch: 11, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.179 Vali Acc: 0.737 Test Loss: 1.179 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0836372375488281
Epoch: 12, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.091 Vali Acc: 0.702 Test Loss: 1.091 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 27426818
model size : 119.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5087289810180664
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.0697696208953857
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 0.9619102478027344
Epoch: 3, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9642972946166992
Epoch: 4, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.588 Vali Acc: 0.766 Test Loss: 0.588 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 1.0039198398590088
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.656 Vali Acc: 0.746 Test Loss: 0.656 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9778652191162109
Epoch: 6, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7792184352874756
Epoch: 7, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.600 Vali Acc: 0.732 Test Loss: 0.600 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8138763904571533
Epoch: 8, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.680 Vali Acc: 0.702 Test Loss: 0.680 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.929804801940918
Epoch: 9, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.722 Vali Acc: 0.737 Test Loss: 0.722 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0522611141204834
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.801 Vali Acc: 0.673 Test Loss: 0.801 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0929803848266602
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.839 Vali Acc: 0.668 Test Loss: 0.839 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.017760992050171
Epoch: 12, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.897 Vali Acc: 0.751 Test Loss: 0.897 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0175731182098389
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.890 Vali Acc: 0.746 Test Loss: 0.890 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8999855518341064
Epoch: 14, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.066 Vali Acc: 0.766 Test Loss: 1.066 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 27374594
model size : 119.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.273533344268799
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8653790950775146
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.8644933700561523
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.849719762802124
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8534388542175293
Epoch: 5, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9285516738891602
Epoch: 6, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8564863204956055
Epoch: 7, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.837730884552002
Epoch: 8, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.731 Vali Acc: 0.727 Test Loss: 0.731 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9309241771697998
Epoch: 9, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.778 Vali Acc: 0.746 Test Loss: 0.778 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746334).  Saving model ...
Epoch: 10 cost time: 0.8814139366149902
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.802 Vali Acc: 0.678 Test Loss: 0.802 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8984839916229248
Epoch: 11, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.687 Vali Acc: 0.712 Test Loss: 0.687 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.791022777557373
Epoch: 12, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.810 Vali Acc: 0.688 Test Loss: 0.810 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8907144069671631
Epoch: 13, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.012 Vali Acc: 0.732 Test Loss: 1.012 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7179129123687744
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.043 Vali Acc: 0.727 Test Loss: 1.043 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8542156219482422
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.887 Vali Acc: 0.649 Test Loss: 0.887 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7524840831756592
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8340094089508057
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.967 Vali Acc: 0.746 Test Loss: 0.967 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7939095497131348
Epoch: 18, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.962 Vali Acc: 0.678 Test Loss: 0.962 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8773989677429199
Epoch: 19, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.024 Vali Acc: 0.624 Test Loss: 1.024 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 27343874
model size : 118.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5720996856689453
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.0511207580566406
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.1016976833343506
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0703341960906982
Epoch: 4, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.0158805847167969
Epoch: 5, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.0475404262542725
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.757 Vali Acc: 0.751 Test Loss: 0.757 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 0.9738554954528809
Epoch: 7, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.743 Vali Acc: 0.741 Test Loss: 0.743 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.966620683670044
Epoch: 8, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.906 Vali Acc: 0.663 Test Loss: 0.906 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1638257503509521
Epoch: 9, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2063329219818115
Epoch: 10, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.206 Vali Acc: 0.727 Test Loss: 1.206 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9363117218017578
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.099 Vali Acc: 0.746 Test Loss: 1.099 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2371459007263184
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.114 Vali Acc: 0.712 Test Loss: 1.114 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0856142044067383
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.247 Vali Acc: 0.673 Test Loss: 1.247 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1653597354888916
Epoch: 14, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.144 Vali Acc: 0.693 Test Loss: 1.144 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1028783321380615
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.294 Vali Acc: 0.727 Test Loss: 1.294 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0243651866912842
Epoch: 16, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.381 Vali Acc: 0.659 Test Loss: 1.381 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 27979778
model size : 121.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.573249101638794
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1895725727081299
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.1004304885864258
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.514 Vali Acc: 0.766 Test Loss: 0.514 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 1.0884058475494385
Epoch: 4, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.510 Vali Acc: 0.766 Test Loss: 0.510 Test Acc: 0.766
Validation loss decreased (-0.765849 --> -0.765849).  Saving model ...
Epoch: 5 cost time: 0.9793102741241455
Epoch: 5, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8824026584625244
Epoch: 6, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0340912342071533
Epoch: 7, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.878 Vali Acc: 0.590 Test Loss: 0.878 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1324081420898438
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.674 Vali Acc: 0.727 Test Loss: 0.674 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9143757820129395
Epoch: 9, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1209843158721924
Epoch: 10, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.708 Vali Acc: 0.683 Test Loss: 0.708 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1915597915649414
Epoch: 11, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.786 Vali Acc: 0.741 Test Loss: 0.786 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9279298782348633
Epoch: 12, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.881 Vali Acc: 0.693 Test Loss: 0.881 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0113768577575684
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.936 Vali Acc: 0.722 Test Loss: 0.936 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0271272659301758
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.928 Vali Acc: 0.727 Test Loss: 0.928 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 27930626
model size : 121.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3923075199127197
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.7592554092407227
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.8286118507385254
Epoch: 3, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8934197425842285
Epoch: 4, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.528 Vali Acc: 0.702 Test Loss: 0.528 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9078202247619629
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.634 Vali Acc: 0.771 Test Loss: 0.634 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770725).  Saving model ...
Epoch: 6 cost time: 0.9321491718292236
Epoch: 6, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.585 Vali Acc: 0.707 Test Loss: 0.585 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7998082637786865
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8232588768005371
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8956577777862549
Epoch: 9, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.989189624786377
Epoch: 10, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.917 Vali Acc: 0.737 Test Loss: 0.917 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9213461875915527
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.026 Vali Acc: 0.751 Test Loss: 1.026 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9302177429199219
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.891 Vali Acc: 0.717 Test Loss: 0.891 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9095933437347412
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.899 Vali Acc: 0.727 Test Loss: 0.899 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9426648616790771
Epoch: 14, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9416275024414062
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.867 Vali Acc: 0.712 Test Loss: 0.867 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 27902978
model size : 121.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.392345905303955
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.2797250747680664
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 0.9913380146026611
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.21112060546875
Epoch: 4, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.0775196552276611
Epoch: 5, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.149918794631958
Epoch: 6, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1498396396636963
Epoch: 7, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.684 Vali Acc: 0.732 Test Loss: 0.684 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2471976280212402
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.954 Vali Acc: 0.751 Test Loss: 0.954 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2566032409667969
Epoch: 9, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.990 Vali Acc: 0.649 Test Loss: 0.990 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2721750736236572
Epoch: 10, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.844 Vali Acc: 0.746 Test Loss: 0.844 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9368846416473389
Epoch: 11, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.859 Vali Acc: 0.654 Test Loss: 0.859 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7878165245056152
Epoch: 12, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.847 Vali Acc: 0.688 Test Loss: 0.847 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8514804840087891
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.897 Vali Acc: 0.717 Test Loss: 0.897 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8318812847137451
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 28532738
model size : 123.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.325899124145508
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.9881024360656738
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.8528573513031006
Epoch: 3, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.500 Vali Acc: 0.756 Test Loss: 0.500 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756093).  Saving model ...
Epoch: 4 cost time: 0.706514835357666
Epoch: 4, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
Validation loss decreased (-0.756093 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 0.7917966842651367
Epoch: 5, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8382978439331055
Epoch: 6, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7270245552062988
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.785 Vali Acc: 0.644 Test Loss: 0.785 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.80234694480896
Epoch: 8, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.662 Vali Acc: 0.732 Test Loss: 0.662 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8231410980224609
Epoch: 9, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.696 Vali Acc: 0.746 Test Loss: 0.696 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8602821826934814
Epoch: 10, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.979 Vali Acc: 0.678 Test Loss: 0.979 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6873447895050049
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.639 Vali Acc: 0.707 Test Loss: 0.639 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7224559783935547
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.936 Vali Acc: 0.732 Test Loss: 0.936 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9224705696105957
Epoch: 13, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.008 Vali Acc: 0.746 Test Loss: 1.008 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9868190288543701
Epoch: 14, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.939 Vali Acc: 0.732 Test Loss: 0.939 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 28486658
model size : 123.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.296220302581787
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.8927245140075684
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.8211202621459961
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.8216192722320557
Epoch: 4, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.620 Vali Acc: 0.732 Test Loss: 0.620 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7952733039855957
Epoch: 5, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.724092960357666
Epoch: 6, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6484041213989258
Epoch: 7, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.684 Vali Acc: 0.683 Test Loss: 0.684 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6630988121032715
Epoch: 8, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.797 Vali Acc: 0.761 Test Loss: 0.797 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8191506862640381
Epoch: 9, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.734 Vali Acc: 0.639 Test Loss: 0.734 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8606529235839844
Epoch: 10, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.747 Vali Acc: 0.659 Test Loss: 0.747 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.790982723236084
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.742 Vali Acc: 0.678 Test Loss: 0.742 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8878364562988281
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.837 Vali Acc: 0.639 Test Loss: 0.837 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8327550888061523
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.871 Vali Acc: 0.678 Test Loss: 0.871 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 28465154
model size : 123.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3912911415100098
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0549554824829102
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.0113961696624756
Epoch: 3, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.8896279335021973
Epoch: 4, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.552 Vali Acc: 0.717 Test Loss: 0.552 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9281141757965088
Epoch: 5, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.999004602432251
Epoch: 6, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.145738124847412
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.643 Vali Acc: 0.737 Test Loss: 0.643 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0975947380065918
Epoch: 8, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9640183448791504
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.693 Vali Acc: 0.712 Test Loss: 0.693 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0470902919769287
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.798 Vali Acc: 0.659 Test Loss: 0.798 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9512035846710205
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.879 Vali Acc: 0.673 Test Loss: 0.879 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0190269947052002
Epoch: 12, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.904 Vali Acc: 0.702 Test Loss: 0.904 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.128788709640503
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.974 Vali Acc: 0.649 Test Loss: 0.974 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 29366786
model size : 126.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5559725761413574
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9931719303131104
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.550 Vali Acc: 0.717 Test Loss: 0.550 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9457459449768066
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.534 Vali Acc: 0.732 Test Loss: 0.534 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 0.98763108253479
Epoch: 4, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.656 Vali Acc: 0.732 Test Loss: 0.656 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.998694658279419
Epoch: 5, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9782915115356445
Epoch: 6, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.626 Vali Acc: 0.693 Test Loss: 0.626 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9406981468200684
Epoch: 7, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8771181106567383
Epoch: 8, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.743 Vali Acc: 0.698 Test Loss: 0.743 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7757048606872559
Epoch: 9, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7954893112182617
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.926 Vali Acc: 0.717 Test Loss: 0.926 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8506009578704834
Epoch: 11, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.847 Vali Acc: 0.732 Test Loss: 0.847 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8876616954803467
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.319 Vali Acc: 0.756 Test Loss: 1.319 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756084).  Saving model ...
Epoch: 13 cost time: 0.8896944522857666
Epoch: 13, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.009 Vali Acc: 0.771 Test Loss: 1.009 Test Acc: 0.771
Validation loss decreased (-0.756084 --> -0.770722).  Saving model ...
Epoch: 14 cost time: 0.9295530319213867
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.011 Vali Acc: 0.756 Test Loss: 1.011 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.868748664855957
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.884 Vali Acc: 0.693 Test Loss: 0.884 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8125081062316895
Epoch: 16, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.987 Vali Acc: 0.712 Test Loss: 0.987 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8524520397186279
Epoch: 17, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.950 Vali Acc: 0.761 Test Loss: 0.950 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8983256816864014
Epoch: 18, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.071 Vali Acc: 0.746 Test Loss: 1.071 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8318064212799072
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.921 Vali Acc: 0.712 Test Loss: 0.921 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8771708011627197
Epoch: 20, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.926 Vali Acc: 0.776 Test Loss: 0.926 Test Acc: 0.776
Validation loss decreased (-0.770722 --> -0.775600).  Saving model ...
Epoch: 21 cost time: 0.866443395614624
Epoch: 21, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.503 Vali Acc: 0.780 Test Loss: 1.503 Test Acc: 0.780
Validation loss decreased (-0.775600 --> -0.780473).  Saving model ...
Epoch: 22 cost time: 0.798473596572876
Epoch: 22, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.172 Vali Acc: 0.737 Test Loss: 1.172 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.693035364151001
Epoch: 23, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.089 Vali Acc: 0.712 Test Loss: 1.089 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.896892786026001
Epoch: 24, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.113 Vali Acc: 0.683 Test Loss: 1.113 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8986685276031494
Epoch: 25, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.536 Vali Acc: 0.756 Test Loss: 1.536 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8586673736572266
Epoch: 26, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.151 Vali Acc: 0.702 Test Loss: 1.151 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.872628927230835
Epoch: 27, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.325 Vali Acc: 0.727 Test Loss: 1.325 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8348145484924316
Epoch: 28, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.722 Test Loss: 1.371 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9142100811004639
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.702 Test Loss: 1.357 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.747791051864624
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.712 Test Loss: 1.407 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9712948799133301
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.712 Test Loss: 1.426 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 29323778
model size : 126.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.179194688796997
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9110836982727051
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.836376428604126
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8339231014251709
Epoch: 4, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 0.873237133026123
Epoch: 5, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760969).  Saving model ...
Epoch: 6 cost time: 0.8847901821136475
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.541 Vali Acc: 0.717 Test Loss: 0.541 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8968865871429443
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.931 Vali Acc: 0.756 Test Loss: 0.931 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7593090534210205
Epoch: 8, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8992919921875
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8250298500061035
Epoch: 10, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.675 Vali Acc: 0.766 Test Loss: 0.675 Test Acc: 0.766
Validation loss decreased (-0.760969 --> -0.765847).  Saving model ...
Epoch: 11 cost time: 0.8480148315429688
Epoch: 11, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.669 Vali Acc: 0.741 Test Loss: 0.669 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9197728633880615
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.721 Vali Acc: 0.771 Test Loss: 0.721 Test Acc: 0.771
Validation loss decreased (-0.765847 --> -0.770724).  Saving model ...
Epoch: 13 cost time: 0.8638019561767578
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9187796115875244
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.839 Vali Acc: 0.727 Test Loss: 0.839 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8698735237121582
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.798 Vali Acc: 0.707 Test Loss: 0.798 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9294795989990234
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.045 Vali Acc: 0.780 Test Loss: 1.045 Test Acc: 0.780
Validation loss decreased (-0.770724 --> -0.780477).  Saving model ...
Epoch: 17 cost time: 0.8943972587585449
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.899 Vali Acc: 0.702 Test Loss: 0.899 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7778449058532715
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.073 Vali Acc: 0.756 Test Loss: 1.073 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8816049098968506
Epoch: 19, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.988 Vali Acc: 0.737 Test Loss: 0.988 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.851797342300415
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.144 Vali Acc: 0.771 Test Loss: 1.144 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9231317043304443
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.002 Vali Acc: 0.732 Test Loss: 1.002 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9188728332519531
Epoch: 22, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.110 Vali Acc: 0.737 Test Loss: 1.110 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9339256286621094
Epoch: 23, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.157 Vali Acc: 0.741 Test Loss: 1.157 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.870448112487793
Epoch: 24, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.067 Vali Acc: 0.737 Test Loss: 1.067 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9238414764404297
Epoch: 25, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.173 Vali Acc: 0.756 Test Loss: 1.173 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.908257007598877
Epoch: 26, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.149 Vali Acc: 0.751 Test Loss: 1.149 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 29302274
model size : 126.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.401448965072632
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.9761183261871338
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.717068 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.8892645835876465
Epoch: 3, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9481189250946045
Epoch: 4, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9774770736694336
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.594 Vali Acc: 0.756 Test Loss: 0.594 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9301953315734863
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.608 Vali Acc: 0.756 Test Loss: 0.608 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9944508075714111
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.699 Vali Acc: 0.712 Test Loss: 0.699 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0047430992126465
Epoch: 8, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.771 Vali Acc: 0.673 Test Loss: 0.771 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9590542316436768
Epoch: 9, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.858 Vali Acc: 0.741 Test Loss: 0.858 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.83357834815979
Epoch: 10, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.703 Vali Acc: 0.722 Test Loss: 0.703 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9303922653198242
Epoch: 11, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.148 Vali Acc: 0.561 Test Loss: 1.148 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1163647174835205
Epoch: 12, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 30338306
model size : 130.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.564983606338501
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.0434141159057617
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.525 Vali Acc: 0.737 Test Loss: 0.525 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.9329800605773926
Epoch: 3, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.0178208351135254
Epoch: 4, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.524 Vali Acc: 0.707 Test Loss: 0.524 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9438843727111816
Epoch: 5, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.531 Vali Acc: 0.727 Test Loss: 0.531 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.170454978942871
Epoch: 6, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9097764492034912
Epoch: 7, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.740 Vali Acc: 0.751 Test Loss: 0.740 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751212).  Saving model ...
Epoch: 8 cost time: 0.7949941158294678
Epoch: 8, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.003 Vali Acc: 0.761 Test Loss: 1.003 Test Acc: 0.761
Validation loss decreased (-0.751212 --> -0.760966).  Saving model ...
Epoch: 9 cost time: 0.7319917678833008
Epoch: 9, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.631 Vali Acc: 0.693 Test Loss: 0.631 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8576488494873047
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.736 Vali Acc: 0.751 Test Loss: 0.736 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7541143894195557
Epoch: 11, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.708043098449707
Epoch: 12, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.744 Vali Acc: 0.741 Test Loss: 0.744 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.757526159286499
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.120 Vali Acc: 0.761 Test Loss: 1.120 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8370099067687988
Epoch: 14, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.798 Vali Acc: 0.649 Test Loss: 0.798 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7291994094848633
Epoch: 15, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.969 Vali Acc: 0.746 Test Loss: 0.969 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7820382118225098
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.973 Vali Acc: 0.756 Test Loss: 0.973 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7285773754119873
Epoch: 17, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.919 Vali Acc: 0.741 Test Loss: 0.919 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8587002754211426
Epoch: 18, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.055 Vali Acc: 0.737 Test Loss: 1.055 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 30301442
model size : 130.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3258097171783447
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 0.8628003597259521
Epoch: 2, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.8621652126312256
Epoch: 3, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9712848663330078
Epoch: 4, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9825198650360107
Epoch: 5, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7193484306335449
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.662 Vali Acc: 0.741 Test Loss: 0.662 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7231709957122803
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.676 Vali Acc: 0.707 Test Loss: 0.676 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9414479732513428
Epoch: 8, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.760 Vali Acc: 0.722 Test Loss: 0.760 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9207587242126465
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.109 Vali Acc: 0.771 Test Loss: 1.109 Test Acc: 0.771
Validation loss decreased (-0.741458 --> -0.770721).  Saving model ...
Epoch: 10 cost time: 0.9076626300811768
Epoch: 10, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.729 Vali Acc: 0.702 Test Loss: 0.729 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8775210380554199
Epoch: 11, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.813 Vali Acc: 0.741 Test Loss: 0.813 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.870764970779419
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.845 Vali Acc: 0.766 Test Loss: 0.845 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.030717372894287
Epoch: 13, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.837 Vali Acc: 0.707 Test Loss: 0.837 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.934382438659668
Epoch: 14, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.974 Vali Acc: 0.741 Test Loss: 0.974 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7900760173797607
Epoch: 15, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.109 Vali Acc: 0.761 Test Loss: 1.109 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9945938587188721
Epoch: 16, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.319 Vali Acc: 0.761 Test Loss: 1.319 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9995718002319336
Epoch: 17, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.806 Vali Acc: 0.663 Test Loss: 0.806 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8974390029907227
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.964 Vali Acc: 0.761 Test Loss: 0.964 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.947887659072876
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.867 Vali Acc: 0.663 Test Loss: 0.867 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 30283010
model size : 130.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.118194341659546
Epoch: 1, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.553 Vali Acc: 0.717 Test Loss: 0.553 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.9517593383789062
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.512 Vali Acc: 0.751 Test Loss: 0.512 Test Acc: 0.751
Validation loss decreased (-0.717068 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.1374051570892334
Epoch: 3, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
Validation loss decreased (-0.751214 --> -0.775604).  Saving model ...
Epoch: 4 cost time: 1.1896686553955078
Epoch: 4, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9495413303375244
Epoch: 5, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9818918704986572
Epoch: 6, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.662 Vali Acc: 0.712 Test Loss: 0.662 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.128829002380371
Epoch: 7, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.612 Vali Acc: 0.741 Test Loss: 0.612 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1025922298431396
Epoch: 8, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.758 Vali Acc: 0.785 Test Loss: 0.758 Test Acc: 0.785
Validation loss decreased (-0.775604 --> -0.785358).  Saving model ...
Epoch: 9 cost time: 1.2591443061828613
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.016 Vali Acc: 0.790 Test Loss: 1.016 Test Acc: 0.790
Validation loss decreased (-0.785358 --> -0.790234).  Saving model ...
Epoch: 10 cost time: 1.2214806079864502
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.939 Vali Acc: 0.766 Test Loss: 0.939 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9842925071716309
Epoch: 11, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.170 Vali Acc: 0.780 Test Loss: 1.170 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.073453426361084
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.899 Vali Acc: 0.741 Test Loss: 0.899 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0562078952789307
Epoch: 13, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.824 Vali Acc: 0.732 Test Loss: 0.824 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.122403621673584
Epoch: 14, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.063 Vali Acc: 0.766 Test Loss: 1.063 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8315393924713135
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.902 Vali Acc: 0.737 Test Loss: 0.902 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9481439590454102
Epoch: 16, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.246 Vali Acc: 0.766 Test Loss: 1.246 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9409689903259277
Epoch: 17, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.068 Vali Acc: 0.751 Test Loss: 1.068 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.90594482421875
Epoch: 18, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.069 Vali Acc: 0.746 Test Loss: 1.069 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9391558170318604
Epoch: 19, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.818 Vali Acc: 0.732 Test Loss: 0.818 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 31731458
model size : 135.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.362274408340454
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.9897687435150146
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.536 Vali Acc: 0.732 Test Loss: 0.536 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.8725295066833496
Epoch: 3, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 0.9651088714599609
Epoch: 4, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.553 Vali Acc: 0.698 Test Loss: 0.553 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8837578296661377
Epoch: 5, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.736 Vali Acc: 0.751 Test Loss: 0.736 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751212).  Saving model ...
Epoch: 6 cost time: 0.870974063873291
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.712 Vali Acc: 0.766 Test Loss: 0.712 Test Acc: 0.766
Validation loss decreased (-0.751212 --> -0.765847).  Saving model ...
Epoch: 7 cost time: 1.0342316627502441
Epoch: 7, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.962 Vali Acc: 0.756 Test Loss: 0.962 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8472089767456055
Epoch: 8, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7701213359832764
Epoch: 9, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.838 Vali Acc: 0.649 Test Loss: 0.838 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8111193180084229
Epoch: 10, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.693 Vali Acc: 0.693 Test Loss: 0.693 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8044757843017578
Epoch: 11, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.888 Vali Acc: 0.756 Test Loss: 0.888 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7139127254486084
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.812 Vali Acc: 0.712 Test Loss: 0.812 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6959326267242432
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8784828186035156
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.064 Vali Acc: 0.761 Test Loss: 1.064 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8810219764709473
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.817 Vali Acc: 0.707 Test Loss: 0.817 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8639607429504395
Epoch: 16, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.971 Vali Acc: 0.683 Test Loss: 0.971 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 31700738
model size : 135.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.451012134552002
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.9269614219665527
Epoch: 2, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
Validation loss decreased (-0.717068 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.0287067890167236
Epoch: 3, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1137893199920654
Epoch: 4, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.553 Vali Acc: 0.717 Test Loss: 0.553 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9646317958831787
Epoch: 5, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.614 Vali Acc: 0.693 Test Loss: 0.614 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0067825317382812
Epoch: 6, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.643 Vali Acc: 0.693 Test Loss: 0.643 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.036358118057251
Epoch: 7, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.732 Vali Acc: 0.620 Test Loss: 0.732 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9423022270202637
Epoch: 8, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.722 Vali Acc: 0.727 Test Loss: 0.722 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0456323623657227
Epoch: 9, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.820 Vali Acc: 0.663 Test Loss: 0.820 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9294211864471436
Epoch: 10, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.782 Vali Acc: 0.678 Test Loss: 0.782 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.066882848739624
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.838 Vali Acc: 0.732 Test Loss: 0.838 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0694501399993896
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.972 Vali Acc: 0.741 Test Loss: 0.972 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 31685378
model size : 135.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps81_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5017664432525635
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.0328927040100098
Epoch: 2, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2222437858581543
Epoch: 3, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1461923122406006
Epoch: 4, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.103191614151001
Epoch: 5, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0166242122650146
Epoch: 6, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.788 Vali Acc: 0.634 Test Loss: 0.788 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8356742858886719
Epoch: 7, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2385780811309814
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.830 Vali Acc: 0.766 Test Loss: 0.830 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765845).  Saving model ...
Epoch: 9 cost time: 1.1246259212493896
Epoch: 9, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.930 Vali Acc: 0.761 Test Loss: 0.930 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0966196060180664
Epoch: 10, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.865 Vali Acc: 0.741 Test Loss: 0.865 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1534943580627441
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.747 Vali Acc: 0.712 Test Loss: 0.747 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5191378593444824
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.901 Vali Acc: 0.727 Test Loss: 0.901 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.101947546005249
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.877 Vali Acc: 0.693 Test Loss: 0.877 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.755812168121338
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.905 Vali Acc: 0.737 Test Loss: 0.905 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2633180618286133
Epoch: 15, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.916 Vali Acc: 0.688 Test Loss: 0.916 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2334003448486328
Epoch: 16, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1299357414245605
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.946 Vali Acc: 0.678 Test Loss: 0.946 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2824101448059082
Epoch: 18, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.915 Vali Acc: 0.741 Test Loss: 0.915 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps81_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 33546242
model size : 142.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.708218574523926
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.2150688171386719
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.629030466079712
Epoch: 3, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756090).  Saving model ...
Epoch: 4 cost time: 1.259671926498413
Epoch: 4, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2103991508483887
Epoch: 5, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.693 Vali Acc: 0.663 Test Loss: 0.693 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.607654333114624
Epoch: 6, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.783 Vali Acc: 0.751 Test Loss: 0.783 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3365247249603271
Epoch: 7, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
Validation loss decreased (-0.756090 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 1.6986174583435059
Epoch: 8, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.735 Vali Acc: 0.741 Test Loss: 0.735 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4163742065429688
Epoch: 9, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.738 Vali Acc: 0.712 Test Loss: 0.738 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3554575443267822
Epoch: 10, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.884 Vali Acc: 0.732 Test Loss: 0.884 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4966721534729004
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.764 Vali Acc: 0.693 Test Loss: 0.764 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5197947025299072
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.838 Vali Acc: 0.693 Test Loss: 0.838 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5959737300872803
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.048 Vali Acc: 0.751 Test Loss: 1.048 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9271700382232666
Epoch: 14, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.406790018081665
Epoch: 15, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.972 Vali Acc: 0.712 Test Loss: 0.972 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.550936222076416
Epoch: 16, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.214 Vali Acc: 0.737 Test Loss: 1.214 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2040541172027588
Epoch: 17, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.968 Vali Acc: 0.727 Test Loss: 0.968 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 33521666
model size : 142.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps81_str81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6102633476257324
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.7627179622650146
Epoch: 2, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.548 Vali Acc: 0.756 Test Loss: 0.548 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.467254638671875
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5796217918395996
Epoch: 4, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.629 Vali Acc: 0.751 Test Loss: 0.629 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.655745506286621
Epoch: 5, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.659 Vali Acc: 0.654 Test Loss: 0.659 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3817083835601807
Epoch: 6, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.580 Vali Acc: 0.707 Test Loss: 0.580 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2271065711975098
Epoch: 7, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.783 Vali Acc: 0.751 Test Loss: 0.783 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1207385063171387
Epoch: 8, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.884 Vali Acc: 0.771 Test Loss: 0.884 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770723).  Saving model ...
Epoch: 9 cost time: 1.4015333652496338
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.768 Vali Acc: 0.683 Test Loss: 0.768 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3264458179473877
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.884 Vali Acc: 0.683 Test Loss: 0.884 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6373569965362549
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.965 Vali Acc: 0.766 Test Loss: 0.965 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1028201580047607
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.917 Vali Acc: 0.722 Test Loss: 0.917 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0872681140899658
Epoch: 13, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.955 Vali Acc: 0.644 Test Loss: 0.955 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9560031890869141
Epoch: 14, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.005 Vali Acc: 0.741 Test Loss: 1.005 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0911502838134766
Epoch: 15, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.993 Vali Acc: 0.644 Test Loss: 0.993 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.505826473236084
Epoch: 16, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.862 Vali Acc: 0.683 Test Loss: 0.862 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.389186143875122
Epoch: 17, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.003 Vali Acc: 0.693 Test Loss: 1.003 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5099260807037354
Epoch: 18, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.065 Vali Acc: 0.712 Test Loss: 1.065 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_GPT4TS_UEA_ftM_sl405_ll0_pl0_el3_dm768_df768_ps81_str81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 33512450
model size : 142.51MB
