Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.839061975479126
Epoch: 1, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8333661556243896
Epoch: 2, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.274986 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.7625267505645752
Epoch: 3, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.132 Vali Acc: 0.575 Test Loss: 1.132 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574989).  Saving model ...
Epoch: 4 cost time: 0.9292173385620117
Epoch: 4, Steps: 3 | Train Loss: 1.105 Vali Loss: 0.996 Vali Acc: 0.650 Test Loss: 0.996 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 0.7932567596435547
Epoch: 5, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.889 Vali Acc: 0.600 Test Loss: 0.889 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7144026756286621
Epoch: 6, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.649990 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.0583980083465576
Epoch: 7, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 0.75160813331604
Epoch: 8, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.565 Vali Acc: 0.875 Test Loss: 0.565 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 0.5435125827789307
Epoch: 9, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.9672937393188477
Epoch: 10, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.057257890701294
Epoch: 11, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1766223907470703
Epoch: 12, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9587888717651367
Epoch: 13, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9902050495147705
Epoch: 14, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9334104061126709
Epoch: 15, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0741784572601318
Epoch: 16, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0276234149932861
Epoch: 17, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9182896614074707
Epoch: 18, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9452018737792969
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43880452
model size : 182.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.088313341140747
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.332 Vali Acc: 0.175 Test Loss: 1.332 Test Acc: 0.175
Validation loss decreased (inf --> -0.174987).  Saving model ...
Epoch: 2 cost time: 0.7741899490356445
Epoch: 2, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.309 Vali Acc: 0.375 Test Loss: 1.309 Test Acc: 0.375
Validation loss decreased (-0.174987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.8240747451782227
Epoch: 3, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.234 Vali Acc: 0.725 Test Loss: 1.234 Test Acc: 0.725
Validation loss decreased (-0.374987 --> -0.724988).  Saving model ...
Epoch: 4 cost time: 0.7309751510620117
Epoch: 4, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.130 Vali Acc: 0.625 Test Loss: 1.130 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7609803676605225
Epoch: 5, Steps: 3 | Train Loss: 0.977 Vali Loss: 0.994 Vali Acc: 0.825 Test Loss: 0.994 Test Acc: 0.825
Validation loss decreased (-0.724988 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.7474136352539062
Epoch: 6, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.874 Vali Acc: 0.900 Test Loss: 0.874 Test Acc: 0.900
Validation loss decreased (-0.824990 --> -0.899991).  Saving model ...
Epoch: 7 cost time: 0.6661758422851562
Epoch: 7, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.819 Vali Acc: 0.725 Test Loss: 0.819 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8175694942474365
Epoch: 8, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.749 Vali Acc: 0.700 Test Loss: 0.749 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6466445922851562
Epoch: 9, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6664543151855469
Epoch: 10, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.749431848526001
Epoch: 11, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9249906539916992
Epoch: 12, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 0.6236555576324463
Epoch: 13, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.388 Vali Acc: 0.975 Test Loss: 0.388 Test Acc: 0.975
Validation loss decreased (-0.899995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.858062744140625
Epoch: 14, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7596752643585205
Epoch: 15, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8259778022766113
Epoch: 16, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9081978797912598
Epoch: 17, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6719691753387451
Epoch: 18, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8326342105865479
Epoch: 19, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8360755443572998
Epoch: 20, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.444 Vali Acc: 0.800 Test Loss: 0.444 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8441877365112305
Epoch: 21, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7833857536315918
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.699796199798584
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43659268
model size : 181.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9945690631866455
Epoch: 1, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.392 Vali Acc: 0.100 Test Loss: 1.392 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.6542294025421143
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.099986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.6175215244293213
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.270 Vali Acc: 0.525 Test Loss: 1.270 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.6467127799987793
Epoch: 4, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.199 Vali Acc: 0.600 Test Loss: 1.199 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.6777994632720947
Epoch: 5, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.5487897396087646
Epoch: 6, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.050 Vali Acc: 0.525 Test Loss: 1.050 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6903419494628906
Epoch: 7, Steps: 3 | Train Loss: 0.965 Vali Loss: 0.970 Vali Acc: 0.625 Test Loss: 0.970 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6832830905914307
Epoch: 8, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.878 Vali Acc: 0.825 Test Loss: 0.878 Test Acc: 0.825
Validation loss decreased (-0.649989 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.6269693374633789
Epoch: 9, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.811 Vali Acc: 0.875 Test Loss: 0.811 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.576446533203125
Epoch: 10, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6523492336273193
Epoch: 11, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.686 Vali Acc: 0.875 Test Loss: 0.686 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.6440279483795166
Epoch: 12, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.616 Vali Acc: 0.875 Test Loss: 0.616 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.6176719665527344
Epoch: 13, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.6756703853607178
Epoch: 14, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.6003966331481934
Epoch: 15, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.6606919765472412
Epoch: 16, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.565056562423706
Epoch: 17, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6761088371276855
Epoch: 18, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6785705089569092
Epoch: 19, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5944023132324219
Epoch: 20, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.7219874858856201
Epoch: 21, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.700897216796875
Epoch: 22, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6697535514831543
Epoch: 23, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7395117282867432
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6106724739074707
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6954388618469238
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5033953189849854
Epoch: 27, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6547529697418213
Epoch: 28, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.555178165435791
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5472104549407959
Epoch: 30, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5614814758300781
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43548676
model size : 180.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.20383358001709
Epoch: 1, Steps: 3 | Train Loss: 1.609 Vali Loss: 1.406 Vali Acc: 0.300 Test Loss: 1.406 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7416813373565674
Epoch: 2, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.370 Vali Acc: 0.100 Test Loss: 1.370 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7550384998321533
Epoch: 3, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.293 Vali Acc: 0.350 Test Loss: 1.293 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.700192928314209
Epoch: 4, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.177 Vali Acc: 0.575 Test Loss: 1.177 Test Acc: 0.575
Validation loss decreased (-0.349987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.7870705127716064
Epoch: 5, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.076 Vali Acc: 0.550 Test Loss: 1.076 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5734577178955078
Epoch: 6, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
Validation loss decreased (-0.574988 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.7657763957977295
Epoch: 7, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7553586959838867
Epoch: 8, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.761 Vali Acc: 0.850 Test Loss: 0.761 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.7396030426025391
Epoch: 9, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.550635576248169
Epoch: 10, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.6646151542663574
Epoch: 11, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.591 Vali Acc: 0.775 Test Loss: 0.591 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8147845268249512
Epoch: 12, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 0.7654299736022949
Epoch: 13, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.451 Vali Acc: 0.975 Test Loss: 0.451 Test Acc: 0.975
Validation loss decreased (-0.899995 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.7259304523468018
Epoch: 14, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.608889102935791
Epoch: 15, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8094310760498047
Epoch: 16, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6274192333221436
Epoch: 17, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7225997447967529
Epoch: 18, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7000329494476318
Epoch: 19, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5530543327331543
Epoch: 20, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6438119411468506
Epoch: 21, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7317252159118652
Epoch: 22, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6592490673065186
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43668484
model size : 181.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.925394058227539
Epoch: 1, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.5983231067657471
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.296 Vali Acc: 0.425 Test Loss: 1.296 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.43268394470214844
Epoch: 3, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.246 Vali Acc: 0.550 Test Loss: 1.246 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.5184566974639893
Epoch: 4, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.173 Vali Acc: 0.700 Test Loss: 1.173 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 0.5774204730987549
Epoch: 5, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.062 Vali Acc: 0.750 Test Loss: 1.062 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 0.6276035308837891
Epoch: 6, Steps: 3 | Train Loss: 1.040 Vali Loss: 0.973 Vali Acc: 0.825 Test Loss: 0.973 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824990).  Saving model ...
Epoch: 7 cost time: 0.4766871929168701
Epoch: 7, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 0.7053403854370117
Epoch: 8, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.812 Vali Acc: 0.850 Test Loss: 0.812 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.6460576057434082
Epoch: 9, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 10 cost time: 0.5617856979370117
Epoch: 10, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.658 Vali Acc: 0.950 Test Loss: 0.658 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.6370899677276611
Epoch: 11, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5811948776245117
Epoch: 12, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.46338582038879395
Epoch: 13, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.48679471015930176
Epoch: 14, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.6338810920715332
Epoch: 15, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.457 Vali Acc: 0.950 Test Loss: 0.457 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5458261966705322
Epoch: 16, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.5595278739929199
Epoch: 17, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.47013211250305176
Epoch: 18, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.461 Vali Acc: 0.825 Test Loss: 0.461 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4258236885070801
Epoch: 19, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.47065162658691406
Epoch: 20, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.53932785987854
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.6136765480041504
Epoch: 22, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.45379114151000977
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.42826080322265625
Epoch: 24, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.42951083183288574
Epoch: 25, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.47144484519958496
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.43100500106811523
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4599490165710449
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4971046447753906
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5461680889129639
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.925 Test Loss: 0.217 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5692794322967529
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43594756
model size : 180.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8410344123840332
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.406 Vali Acc: 0.325 Test Loss: 1.406 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5918540954589844
Epoch: 2, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.355 Vali Acc: 0.275 Test Loss: 1.355 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48262691497802734
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.311 Vali Acc: 0.275 Test Loss: 1.311 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4739112854003906
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.270 Vali Acc: 0.375 Test Loss: 1.270 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.39064836502075195
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.241 Vali Acc: 0.400 Test Loss: 1.241 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.5057737827301025
Epoch: 6, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.181 Vali Acc: 0.475 Test Loss: 1.181 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.48139142990112305
Epoch: 7, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.537975549697876
Epoch: 8, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
Validation loss decreased (-0.499989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.680823564529419
Epoch: 9, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.6026630401611328
Epoch: 10, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.48105335235595703
Epoch: 11, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.6368651390075684
Epoch: 12, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7077131271362305
Epoch: 13, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.664 Vali Acc: 0.775 Test Loss: 0.664 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.615269660949707
Epoch: 14, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.4182450771331787
Epoch: 15, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.651820182800293
Epoch: 16, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.7148566246032715
Epoch: 17, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.492037296295166
Epoch: 18, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.470 Vali Acc: 0.825 Test Loss: 0.470 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7094371318817139
Epoch: 19, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.427 Vali Acc: 0.825 Test Loss: 0.427 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5941128730773926
Epoch: 20, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.394 Vali Acc: 0.825 Test Loss: 0.394 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7169444561004639
Epoch: 21, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.6112098693847656
Epoch: 22, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.372 Vali Acc: 0.825 Test Loss: 0.372 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.47649431228637695
Epoch: 23, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.403 Vali Acc: 0.825 Test Loss: 0.403 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6470010280609131
Epoch: 24, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6551418304443359
Epoch: 25, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.395 Vali Acc: 0.825 Test Loss: 0.395 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6929605007171631
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6996917724609375
Epoch: 27, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.3837718963623047
Epoch: 28, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.45064711570739746
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.325 Vali Acc: 0.825 Test Loss: 0.325 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.45520758628845215
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5967118740081787
Epoch: 31, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5880024433135986
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.366 Vali Acc: 0.775 Test Loss: 0.366 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5044040679931641
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.378 Vali Acc: 0.775 Test Loss: 0.378 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5999069213867188
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.775 Test Loss: 0.381 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5892550945281982
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.349 Vali Acc: 0.800 Test Loss: 0.349 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4871084690093994
Epoch: 36, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.332 Vali Acc: 0.825 Test Loss: 0.332 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.43279194831848145
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 43539460
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8463010787963867
Epoch: 1, Steps: 3 | Train Loss: 1.549 Vali Loss: 1.359 Vali Acc: 0.475 Test Loss: 1.359 Test Acc: 0.475
Validation loss decreased (inf --> -0.474986).  Saving model ...
Epoch: 2 cost time: 0.7693295478820801
Epoch: 2, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5611021518707275
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.277 Vali Acc: 0.475 Test Loss: 1.277 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6713416576385498
Epoch: 4, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
Validation loss decreased (-0.474987 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.6147575378417969
Epoch: 5, Steps: 3 | Train Loss: 1.029 Vali Loss: 0.982 Vali Acc: 0.550 Test Loss: 0.982 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7283549308776855
Epoch: 6, Steps: 3 | Train Loss: 0.910 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.796856164932251
Epoch: 7, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.695636510848999
Epoch: 8, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7208425998687744
Epoch: 9, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.614 Vali Acc: 0.950 Test Loss: 0.614 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.6478445529937744
Epoch: 10, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.556 Vali Acc: 0.950 Test Loss: 0.556 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.6513252258300781
Epoch: 11, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6873672008514404
Epoch: 12, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.420 Vali Acc: 0.800 Test Loss: 0.420 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6958785057067871
Epoch: 13, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.7653830051422119
Epoch: 14, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.725269079208374
Epoch: 15, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7587308883666992
Epoch: 16, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5918169021606445
Epoch: 17, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.6287429332733154
Epoch: 18, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.7135851383209229
Epoch: 19, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.634425163269043
Epoch: 20, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6486632823944092
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6427712440490723
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6847541332244873
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7160580158233643
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5190138816833496
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6701507568359375
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6600849628448486
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6439197063446045
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43682308
model size : 181.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.014427661895752
Epoch: 1, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.386 Vali Acc: 0.375 Test Loss: 1.386 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.6367068290710449
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5741019248962402
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.5050761699676514
Epoch: 4, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.169 Vali Acc: 0.625 Test Loss: 1.169 Test Acc: 0.625
Validation loss decreased (-0.374987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.6807332038879395
Epoch: 5, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6511619091033936
Epoch: 6, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.014 Vali Acc: 0.575 Test Loss: 1.014 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5224156379699707
Epoch: 7, Steps: 3 | Train Loss: 0.871 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.624988 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 0.5463378429412842
Epoch: 8, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.874 Vali Acc: 0.850 Test Loss: 0.874 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.5887682437896729
Epoch: 9, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 0.6937613487243652
Epoch: 10, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.6095044612884521
Epoch: 11, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5901622772216797
Epoch: 12, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6913087368011475
Epoch: 13, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.5730113983154297
Epoch: 14, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 0.6454792022705078
Epoch: 15, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.582831859588623
Epoch: 16, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.6205613613128662
Epoch: 17, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.527503252029419
Epoch: 18, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6594185829162598
Epoch: 19, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5841410160064697
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.5284121036529541
Epoch: 21, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5208210945129395
Epoch: 22, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.37543153762817383
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4763367176055908
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.490222692489624
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5638959407806396
Epoch: 26, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5006053447723389
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5785555839538574
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5564041137695312
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5329854488372803
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4725353717803955
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43608580
model size : 181.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8590960502624512
Epoch: 1, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.313 Vali Acc: 0.250 Test Loss: 1.313 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.5366115570068359
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.325 Vali Acc: 0.425 Test Loss: 1.325 Test Acc: 0.425
Validation loss decreased (-0.249987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.4350857734680176
Epoch: 3, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.5976467132568359
Epoch: 4, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.47592830657958984
Epoch: 5, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.189 Vali Acc: 0.525 Test Loss: 1.189 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.5107276439666748
Epoch: 6, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.5475256443023682
Epoch: 7, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.5455868244171143
Epoch: 8, Steps: 3 | Train Loss: 0.965 Vali Loss: 0.974 Vali Acc: 0.800 Test Loss: 0.974 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.5347387790679932
Epoch: 9, Steps: 3 | Train Loss: 0.897 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.4607272148132324
Epoch: 10, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.5305349826812744
Epoch: 11, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6173434257507324
Epoch: 12, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.49846625328063965
Epoch: 13, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.639 Vali Acc: 0.825 Test Loss: 0.639 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.5275511741638184
Epoch: 14, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.5281453132629395
Epoch: 15, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.6177260875701904
Epoch: 16, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.4671173095703125
Epoch: 17, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.5337774753570557
Epoch: 18, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.5424196720123291
Epoch: 19, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7317736148834229
Epoch: 20, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5900540351867676
Epoch: 21, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.5199558734893799
Epoch: 22, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5612094402313232
Epoch: 23, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5572428703308105
Epoch: 24, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.272 Vali Acc: 0.875 Test Loss: 0.272 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4987821578979492
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.5750296115875244
Epoch: 26, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.5600948333740234
Epoch: 27, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.48931121826171875
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6048259735107422
Epoch: 29, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5067155361175537
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.6661515235900879
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.925 Test Loss: 0.178 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7006900310516357
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.925 Test Loss: 0.190 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5397226810455322
Epoch: 33, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6819894313812256
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.655153751373291
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.552821159362793
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5613734722137451
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.6095113754272461
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.664771318435669
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.47708654403686523
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.5186905860900879
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.4969761371612549
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.4412715435028076
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.48015856742858887
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.504866361618042
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5926351547241211
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.5293045043945312
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4756474494934082
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.48598670959472656
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5695505142211914
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43534852
model size : 180.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.914757251739502
Epoch: 1, Steps: 3 | Train Loss: 1.570 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.4946017265319824
Epoch: 2, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.388 Vali Acc: 0.300 Test Loss: 1.388 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7399518489837646
Epoch: 3, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.349986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.727675199508667
Epoch: 4, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.126 Vali Acc: 0.575 Test Loss: 1.126 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 0.6278080940246582
Epoch: 5, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.695824384689331
Epoch: 6, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.937 Vali Acc: 0.825 Test Loss: 0.937 Test Acc: 0.825
Validation loss decreased (-0.649990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.8103783130645752
Epoch: 7, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.862 Vali Acc: 0.725 Test Loss: 0.862 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.583096981048584
Epoch: 8, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 0.7369718551635742
Epoch: 9, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.663 Vali Acc: 0.775 Test Loss: 0.663 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6597626209259033
Epoch: 10, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.639 Vali Acc: 0.875 Test Loss: 0.639 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.6594569683074951
Epoch: 11, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.566 Vali Acc: 0.925 Test Loss: 0.566 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.591804027557373
Epoch: 12, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.6699714660644531
Epoch: 13, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6674308776855469
Epoch: 14, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.6358273029327393
Epoch: 15, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6917390823364258
Epoch: 16, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.609825849533081
Epoch: 17, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.7214851379394531
Epoch: 18, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7254312038421631
Epoch: 19, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6861143112182617
Epoch: 20, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6572878360748291
Epoch: 21, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6779615879058838
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6107022762298584
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6693270206451416
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5852792263031006
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6558008193969727
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7341244220733643
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.925 Test Loss: 0.477 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43691524
model size : 181.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2431983947753906
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6040410995483398
Epoch: 2, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6263000965118408
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.5413610935211182
Epoch: 4, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.233 Vali Acc: 0.475 Test Loss: 1.233 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.6007587909698486
Epoch: 5, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.6517701148986816
Epoch: 6, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.046 Vali Acc: 0.750 Test Loss: 1.046 Test Acc: 0.750
Validation loss decreased (-0.549989 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.6285257339477539
Epoch: 7, Steps: 3 | Train Loss: 0.983 Vali Loss: 0.967 Vali Acc: 0.775 Test Loss: 0.967 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.6041343212127686
Epoch: 8, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.6489262580871582
Epoch: 9, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.834 Vali Acc: 0.850 Test Loss: 0.834 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.583188533782959
Epoch: 10, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6177201271057129
Epoch: 11, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6501374244689941
Epoch: 12, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.627 Vali Acc: 0.925 Test Loss: 0.627 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.5995926856994629
Epoch: 13, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5159587860107422
Epoch: 14, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5429346561431885
Epoch: 15, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.5826530456542969
Epoch: 16, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5502917766571045
Epoch: 17, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.924996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.5637824535369873
Epoch: 18, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6259410381317139
Epoch: 19, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8413817882537842
Epoch: 20, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5954596996307373
Epoch: 21, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.825 Test Loss: 0.370 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4827849864959717
Epoch: 22, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6210534572601318
Epoch: 23, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.48560643196105957
Epoch: 24, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5694611072540283
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5529069900512695
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.509425163269043
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.374 Vali Acc: 0.825 Test Loss: 0.374 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43585540
model size : 180.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0842559337615967
Epoch: 1, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.369 Vali Acc: 0.225 Test Loss: 1.369 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.533381462097168
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.351 Vali Acc: 0.350 Test Loss: 1.351 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.5608446598052979
Epoch: 3, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.325 Vali Acc: 0.425 Test Loss: 1.325 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.48385095596313477
Epoch: 4, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.285 Vali Acc: 0.525 Test Loss: 1.285 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.4907982349395752
Epoch: 5, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.226 Vali Acc: 0.625 Test Loss: 1.226 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.4694390296936035
Epoch: 6, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.175 Vali Acc: 0.675 Test Loss: 1.175 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.4429600238800049
Epoch: 7, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.119 Vali Acc: 0.725 Test Loss: 1.119 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 8 cost time: 0.521033763885498
Epoch: 8, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.051 Vali Acc: 0.775 Test Loss: 1.051 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774989).  Saving model ...
Epoch: 9 cost time: 0.5744585990905762
Epoch: 9, Steps: 3 | Train Loss: 1.004 Vali Loss: 0.990 Vali Acc: 0.850 Test Loss: 0.990 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 10 cost time: 0.5727434158325195
Epoch: 10, Steps: 3 | Train Loss: 0.915 Vali Loss: 0.929 Vali Acc: 0.850 Test Loss: 0.929 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.520374059677124
Epoch: 11, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.865 Vali Acc: 0.875 Test Loss: 0.865 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.5091216564178467
Epoch: 12, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.4803757667541504
Epoch: 13, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.737 Vali Acc: 0.850 Test Loss: 0.737 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.42763495445251465
Epoch: 14, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.47296786308288574
Epoch: 15, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.4227900505065918
Epoch: 16, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.43869566917419434
Epoch: 17, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.453538179397583
Epoch: 18, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.44616103172302246
Epoch: 19, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.45511746406555176
Epoch: 20, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4944164752960205
Epoch: 21, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5037539005279541
Epoch: 22, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5707886219024658
Epoch: 23, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.49763965606689453
Epoch: 24, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4628481864929199
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.384 Vali Acc: 0.825 Test Loss: 0.384 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 43539460
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.721794843673706
Epoch: 1, Steps: 3 | Train Loss: 1.564 Vali Loss: 1.456 Vali Acc: 0.375 Test Loss: 1.456 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 0.6457533836364746
Epoch: 2, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.389 Vali Acc: 0.250 Test Loss: 1.389 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5603253841400146
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.374985 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6855306625366211
Epoch: 4, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.142 Vali Acc: 0.675 Test Loss: 1.142 Test Acc: 0.675
Validation loss decreased (-0.474987 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.689643144607544
Epoch: 5, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.075 Vali Acc: 0.575 Test Loss: 1.075 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6122524738311768
Epoch: 6, Steps: 3 | Train Loss: 0.936 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.6336963176727295
Epoch: 7, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.865 Vali Acc: 0.875 Test Loss: 0.865 Test Acc: 0.875
Validation loss decreased (-0.724990 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 0.6518955230712891
Epoch: 8, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.811 Vali Acc: 0.800 Test Loss: 0.811 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5797891616821289
Epoch: 9, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6750938892364502
Epoch: 10, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.591 Vali Acc: 0.925 Test Loss: 0.591 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.7802276611328125
Epoch: 11, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.5057704448699951
Epoch: 12, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.5353262424468994
Epoch: 13, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6317312717437744
Epoch: 14, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7472367286682129
Epoch: 15, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.7692689895629883
Epoch: 16, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6277623176574707
Epoch: 17, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5603573322296143
Epoch: 18, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.79022216796875
Epoch: 19, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7338769435882568
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5604045391082764
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4416005611419678
Epoch: 22, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6405289173126221
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.526442289352417
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6672484874725342
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6118879318237305
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.632697582244873
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43705348
model size : 181.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.212251663208008
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.427 Vali Acc: 0.400 Test Loss: 1.427 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5621533393859863
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6291706562042236
Epoch: 3, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.319 Vali Acc: 0.475 Test Loss: 1.319 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.6785919666290283
Epoch: 4, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5372254848480225
Epoch: 5, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.165 Vali Acc: 0.625 Test Loss: 1.165 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.560009241104126
Epoch: 6, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.6483595371246338
Epoch: 7, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.5951917171478271
Epoch: 8, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.938 Vali Acc: 0.650 Test Loss: 0.938 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6903214454650879
Epoch: 9, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.7343490123748779
Epoch: 10, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.793 Vali Acc: 0.850 Test Loss: 0.793 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.5787570476531982
Epoch: 11, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.729 Vali Acc: 0.825 Test Loss: 0.729 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5620100498199463
Epoch: 12, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.6089138984680176
Epoch: 13, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.6632053852081299
Epoch: 14, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.520 Vali Acc: 0.950 Test Loss: 0.520 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.651808500289917
Epoch: 15, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.490 Vali Acc: 0.950 Test Loss: 0.490 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5570063591003418
Epoch: 16, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.6798512935638428
Epoch: 17, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5885136127471924
Epoch: 18, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5969562530517578
Epoch: 19, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.45029497146606445
Epoch: 20, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6314311027526855
Epoch: 21, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6154806613922119
Epoch: 22, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6152017116546631
Epoch: 23, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6714997291564941
Epoch: 24, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6883137226104736
Epoch: 25, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6418123245239258
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43599364
model size : 181.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9992976188659668
Epoch: 1, Steps: 3 | Train Loss: 1.568 Vali Loss: 1.452 Vali Acc: 0.175 Test Loss: 1.452 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.5104339122772217
Epoch: 2, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.441 Vali Acc: 0.175 Test Loss: 1.441 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.5318408012390137
Epoch: 3, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.404 Vali Acc: 0.300 Test Loss: 1.404 Test Acc: 0.300
Validation loss decreased (-0.174986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5762786865234375
Epoch: 4, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.359 Vali Acc: 0.225 Test Loss: 1.359 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5225398540496826
Epoch: 5, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.301 Vali Acc: 0.375 Test Loss: 1.301 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.4904160499572754
Epoch: 6, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.249 Vali Acc: 0.450 Test Loss: 1.249 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.4555191993713379
Epoch: 7, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.200 Vali Acc: 0.575 Test Loss: 1.200 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.5270476341247559
Epoch: 8, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.5413312911987305
Epoch: 9, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.46932435035705566
Epoch: 10, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.5334639549255371
Epoch: 11, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.008 Vali Acc: 0.675 Test Loss: 1.008 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.6034858226776123
Epoch: 12, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.4986104965209961
Epoch: 13, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.930 Vali Acc: 0.675 Test Loss: 0.930 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5167093276977539
Epoch: 14, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.6099069118499756
Epoch: 15, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.771 Vali Acc: 0.725 Test Loss: 0.771 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.515444278717041
Epoch: 16, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.683 Vali Acc: 0.750 Test Loss: 0.683 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 0.4433877468109131
Epoch: 17, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.615 Vali Acc: 0.725 Test Loss: 0.615 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4566006660461426
Epoch: 18, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.584 Vali Acc: 0.800 Test Loss: 0.584 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 0.6082394123077393
Epoch: 19, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 0.5568082332611084
Epoch: 20, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 21 cost time: 0.4957163333892822
Epoch: 21, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.5916824340820312
Epoch: 22, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.5706591606140137
Epoch: 23, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.511 Vali Acc: 0.800 Test Loss: 0.511 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6167957782745361
Epoch: 24, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.513 Vali Acc: 0.800 Test Loss: 0.513 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.559581995010376
Epoch: 25, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.460 Vali Acc: 0.800 Test Loss: 0.460 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5211181640625
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 0.4877779483795166
Epoch: 27, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 0.5371122360229492
Epoch: 28, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5286526679992676
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.454 Vali Acc: 0.825 Test Loss: 0.454 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6466984748840332
Epoch: 30, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.440 Vali Acc: 0.825 Test Loss: 0.440 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5448529720306396
Epoch: 31, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.437 Vali Acc: 0.825 Test Loss: 0.437 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5889017581939697
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.445 Vali Acc: 0.825 Test Loss: 0.445 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4574747085571289
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.47014617919921875
Epoch: 34, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.47496747970581055
Epoch: 35, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4977688789367676
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5882809162139893
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.430 Vali Acc: 0.825 Test Loss: 0.430 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 43544068
model size : 180.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.875265121459961
Epoch: 1, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5440680980682373
Epoch: 2, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.360 Vali Acc: 0.350 Test Loss: 1.360 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.4623119831085205
Epoch: 3, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.6412816047668457
Epoch: 4, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.198 Vali Acc: 0.475 Test Loss: 1.198 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.5679717063903809
Epoch: 5, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.5516500473022461
Epoch: 6, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.499989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.537766695022583
Epoch: 7, Steps: 3 | Train Loss: 0.931 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 0.41875672340393066
Epoch: 8, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 9 cost time: 0.5033307075500488
Epoch: 9, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.5724461078643799
Epoch: 10, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 0.5533144474029541
Epoch: 11, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 0.5572595596313477
Epoch: 12, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.561 Vali Acc: 0.950 Test Loss: 0.561 Test Acc: 0.950
Validation loss decreased (-0.849993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.6258509159088135
Epoch: 13, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.5630390644073486
Epoch: 14, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6092774868011475
Epoch: 15, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6077921390533447
Epoch: 16, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6544339656829834
Epoch: 17, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5850791931152344
Epoch: 18, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.49065518379211426
Epoch: 19, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5517301559448242
Epoch: 20, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4749469757080078
Epoch: 21, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5796809196472168
Epoch: 22, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.5583922863006592
Epoch: 23, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5308785438537598
Epoch: 24, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5400135517120361
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5641272068023682
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7107787132263184
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5826196670532227
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6141312122344971
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5381455421447754
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4911973476409912
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.48981499671936035
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.49292993545532227
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.737041711807251
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43645444
model size : 181.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8946340084075928
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5660302639007568
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.295 Vali Acc: 0.375 Test Loss: 1.295 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.49335408210754395
Epoch: 3, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.228 Vali Acc: 0.450 Test Loss: 1.228 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.5754024982452393
Epoch: 4, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.5014111995697021
Epoch: 5, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.40974998474121094
Epoch: 6, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 0.47125816345214844
Epoch: 7, Steps: 3 | Train Loss: 0.944 Vali Loss: 0.987 Vali Acc: 0.700 Test Loss: 0.987 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.5594472885131836
Epoch: 8, Steps: 3 | Train Loss: 0.894 Vali Loss: 0.916 Vali Acc: 0.825 Test Loss: 0.916 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.48209643363952637
Epoch: 9, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.827 Vali Acc: 0.900 Test Loss: 0.827 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.4424765110015869
Epoch: 10, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.739 Vali Acc: 0.675 Test Loss: 0.739 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45434093475341797
Epoch: 11, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.670 Vali Acc: 0.900 Test Loss: 0.670 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.572359561920166
Epoch: 12, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.611 Vali Acc: 0.925 Test Loss: 0.611 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.4795196056365967
Epoch: 13, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.577 Vali Acc: 0.900 Test Loss: 0.577 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5414502620697021
Epoch: 14, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5322251319885254
Epoch: 15, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.48897886276245117
Epoch: 16, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.5667922496795654
Epoch: 17, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5884971618652344
Epoch: 18, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.48572540283203125
Epoch: 19, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5983667373657227
Epoch: 20, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.579092264175415
Epoch: 21, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5031564235687256
Epoch: 22, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5070245265960693
Epoch: 23, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4640345573425293
Epoch: 24, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.561790943145752
Epoch: 25, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.48753976821899414
Epoch: 26, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5999622344970703
Epoch: 27, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4801926612854004
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5438296794891357
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5601823329925537
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5421817302703857
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5288832187652588
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5367977619171143
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.48731446266174316
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5191316604614258
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43590148
model size : 180.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0102689266204834
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.4634084701538086
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.306 Vali Acc: 0.525 Test Loss: 1.306 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.5347492694854736
Epoch: 3, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.266 Vali Acc: 0.575 Test Loss: 1.266 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 4 cost time: 0.48073387145996094
Epoch: 4, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.220 Vali Acc: 0.675 Test Loss: 1.220 Test Acc: 0.675
Validation loss decreased (-0.574987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 0.558469295501709
Epoch: 5, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.180 Vali Acc: 0.575 Test Loss: 1.180 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5129899978637695
Epoch: 6, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.44114232063293457
Epoch: 7, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.092 Vali Acc: 0.675 Test Loss: 1.092 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.5261752605438232
Epoch: 8, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.036 Vali Acc: 0.725 Test Loss: 1.036 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.5371222496032715
Epoch: 9, Steps: 3 | Train Loss: 0.966 Vali Loss: 0.975 Vali Acc: 0.750 Test Loss: 0.975 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.5200173854827881
Epoch: 10, Steps: 3 | Train Loss: 0.916 Vali Loss: 0.920 Vali Acc: 0.800 Test Loss: 0.920 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.4992637634277344
Epoch: 11, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.867 Vali Acc: 0.825 Test Loss: 0.867 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.45201945304870605
Epoch: 12, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.819 Vali Acc: 0.850 Test Loss: 0.819 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.5613510608673096
Epoch: 13, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.4613778591156006
Epoch: 14, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.714 Vali Acc: 0.850 Test Loss: 0.714 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.41465139389038086
Epoch: 15, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.4401862621307373
Epoch: 16, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.849993 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.4643874168395996
Epoch: 17, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4270648956298828
Epoch: 18, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4978611469268799
Epoch: 19, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5231063365936279
Epoch: 20, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.47300291061401367
Epoch: 21, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.45639801025390625
Epoch: 22, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4342360496520996
Epoch: 23, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.41992998123168945
Epoch: 24, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.35542869567871094
Epoch: 25, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.3916189670562744
Epoch: 26, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4528660774230957
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4020354747772217
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.44089722633361816
Epoch: 29, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.235 Vali Acc: 0.875 Test Loss: 0.235 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4355459213256836
Epoch: 30, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.875 Test Loss: 0.236 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.42055344581604004
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.875 Test Loss: 0.239 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.37867069244384766
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.875 Test Loss: 0.234 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.47298669815063477
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.236 Vali Acc: 0.875 Test Loss: 0.236 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43553284
model size : 180.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9788665771484375
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.403 Vali Acc: 0.200 Test Loss: 1.403 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5839767456054688
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.396 Vali Acc: 0.225 Test Loss: 1.396 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.4967031478881836
Epoch: 3, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.224986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.4950075149536133
Epoch: 4, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5223801136016846
Epoch: 5, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.138 Vali Acc: 0.575 Test Loss: 1.138 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.4392733573913574
Epoch: 6, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.6239423751831055
Epoch: 7, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.983 Vali Acc: 0.750 Test Loss: 0.983 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.6124136447906494
Epoch: 8, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.872 Vali Acc: 0.700 Test Loss: 0.872 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5604996681213379
Epoch: 9, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.815 Vali Acc: 0.675 Test Loss: 0.815 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.604820966720581
Epoch: 10, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774993).  Saving model ...
Epoch: 11 cost time: 0.5661196708679199
Epoch: 11, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.5559124946594238
Epoch: 12, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
Validation loss decreased (-0.799993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.6028130054473877
Epoch: 13, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.532 Vali Acc: 0.925 Test Loss: 0.532 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.6006519794464111
Epoch: 14, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.549 Vali Acc: 0.775 Test Loss: 0.549 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6144225597381592
Epoch: 15, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.39724254608154297
Epoch: 16, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.5122766494750977
Epoch: 17, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.590956449508667
Epoch: 18, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5177888870239258
Epoch: 19, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.517409086227417
Epoch: 20, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4870750904083252
Epoch: 21, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5381805896759033
Epoch: 22, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5429885387420654
Epoch: 23, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6422250270843506
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6555304527282715
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5075399875640869
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5509982109069824
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6177232265472412
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43659268
model size : 181.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7383754253387451
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.435 Vali Acc: 0.150 Test Loss: 1.435 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.5740001201629639
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.149986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5103845596313477
Epoch: 3, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.4981503486633301
Epoch: 4, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.265 Vali Acc: 0.425 Test Loss: 1.265 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.5427427291870117
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.198 Vali Acc: 0.625 Test Loss: 1.198 Test Acc: 0.625
Validation loss decreased (-0.424987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.5376567840576172
Epoch: 6, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.141 Vali Acc: 0.725 Test Loss: 1.141 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.4271724224090576
Epoch: 7, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.101 Vali Acc: 0.775 Test Loss: 1.101 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 0.5316541194915771
Epoch: 8, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.037 Vali Acc: 0.775 Test Loss: 1.037 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 0.5628495216369629
Epoch: 9, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.961 Vali Acc: 0.800 Test Loss: 0.961 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.5184969902038574
Epoch: 10, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.881 Vali Acc: 0.800 Test Loss: 0.881 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.5104503631591797
Epoch: 11, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.794 Vali Acc: 0.850 Test Loss: 0.794 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.5081808567047119
Epoch: 12, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.4554266929626465
Epoch: 13, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4701817035675049
Epoch: 14, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.654 Vali Acc: 0.825 Test Loss: 0.654 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.49815797805786133
Epoch: 15, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.614 Vali Acc: 0.800 Test Loss: 0.614 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.49619436264038086
Epoch: 16, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5115787982940674
Epoch: 17, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5592432022094727
Epoch: 18, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5049746036529541
Epoch: 19, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5406577587127686
Epoch: 20, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.480 Vali Acc: 0.825 Test Loss: 0.480 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4619152545928955
Epoch: 21, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4624042510986328
Epoch: 22, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.412 Vali Acc: 0.825 Test Loss: 0.412 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 43603972
model size : 181.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6292486190795898
Epoch: 1, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.475 Vali Acc: 0.325 Test Loss: 1.475 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.4228334426879883
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.419 Vali Acc: 0.250 Test Loss: 1.419 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42497754096984863
Epoch: 3, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.381 Vali Acc: 0.375 Test Loss: 1.381 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.43568921089172363
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.337 Vali Acc: 0.375 Test Loss: 1.337 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4417154788970947
Epoch: 5, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.296 Vali Acc: 0.325 Test Loss: 1.296 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4342494010925293
Epoch: 6, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.258 Vali Acc: 0.450 Test Loss: 1.258 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.4568898677825928
Epoch: 7, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.226 Vali Acc: 0.450 Test Loss: 1.226 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.4324345588684082
Epoch: 8, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.192 Vali Acc: 0.450 Test Loss: 1.192 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.4241766929626465
Epoch: 9, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.144 Vali Acc: 0.475 Test Loss: 1.144 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474989).  Saving model ...
Epoch: 10 cost time: 0.40292835235595703
Epoch: 10, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
Validation loss decreased (-0.474989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.41805481910705566
Epoch: 11, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.039 Vali Acc: 0.550 Test Loss: 1.039 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.41915440559387207
Epoch: 12, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.446596622467041
Epoch: 13, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.44945573806762695
Epoch: 14, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.49276161193847656
Epoch: 15, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.826 Vali Acc: 0.650 Test Loss: 0.826 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4321587085723877
Epoch: 16, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.770 Vali Acc: 0.675 Test Loss: 0.770 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.42774415016174316
Epoch: 17, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.735 Vali Acc: 0.725 Test Loss: 0.735 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4628331661224365
Epoch: 18, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 0.48171114921569824
Epoch: 19, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 0.4816875457763672
Epoch: 20, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4689493179321289
Epoch: 21, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.47276854515075684
Epoch: 22, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 0.47674989700317383
Epoch: 23, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 24 cost time: 0.42049551010131836
Epoch: 24, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 25 cost time: 0.4252746105194092
Epoch: 25, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.382 Vali Acc: 0.825 Test Loss: 0.382 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.3844578266143799
Epoch: 26, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 0.4970247745513916
Epoch: 27, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.49814772605895996
Epoch: 28, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.47516798973083496
Epoch: 29, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4875974655151367
Epoch: 30, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 0.47753143310546875
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 0.42058634757995605
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.44921350479125977
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.41260337829589844
Epoch: 34, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.47559332847595215
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.42580223083496094
Epoch: 36, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.508216381072998
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.4389209747314453
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.46406030654907227
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.4527270793914795
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 0.4424595832824707
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.5206458568572998
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5494341850280762
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4781043529510498
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.47426867485046387
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.42778778076171875
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.49010205268859863
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.380739688873291
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.431260347366333
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.46360325813293457
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 43562500
model size : 180.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0162084102630615
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.339 Vali Acc: 0.375 Test Loss: 1.339 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.5457050800323486
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.320 Vali Acc: 0.250 Test Loss: 1.320 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5895426273345947
Epoch: 3, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.255 Vali Acc: 0.450 Test Loss: 1.255 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.529904842376709
Epoch: 4, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.6765501499176025
Epoch: 5, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.151 Vali Acc: 0.525 Test Loss: 1.151 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6182637214660645
Epoch: 6, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7098886966705322
Epoch: 7, Steps: 3 | Train Loss: 0.926 Vali Loss: 0.953 Vali Acc: 0.850 Test Loss: 0.953 Test Acc: 0.850
Validation loss decreased (-0.574988 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.627995491027832
Epoch: 8, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.607905387878418
Epoch: 9, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.781 Vali Acc: 0.850 Test Loss: 0.781 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.6408865451812744
Epoch: 10, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.5936269760131836
Epoch: 11, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.61649489402771
Epoch: 12, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.5148947238922119
Epoch: 13, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6586875915527344
Epoch: 14, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.49036169052124023
Epoch: 15, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5656023025512695
Epoch: 16, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.49748849868774414
Epoch: 17, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.642554759979248
Epoch: 18, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5418670177459717
Epoch: 19, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4896528720855713
Epoch: 20, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.47850918769836426
Epoch: 21, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.48299479484558105
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5267946720123291
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5755205154418945
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.45222949981689453
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5131485462188721
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5664803981781006
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.549811840057373
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.49948787689208984
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5193092823028564
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5328338146209717
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6251931190490723
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5933551788330078
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.6683940887451172
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5891058444976807
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6106162071228027
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.613384485244751
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5402405261993408
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5529322624206543
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5692887306213379
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5604598522186279
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.6227667331695557
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5504271984100342
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5817060470581055
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6406357288360596
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.606731653213501
Epoch: 46, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5445284843444824
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.49515628814697266
Epoch: 48, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5387570858001709
Epoch: 49, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6633777618408203
Epoch: 50, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43682308
model size : 181.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.003901720046997
Epoch: 1, Steps: 3 | Train Loss: 1.595 Vali Loss: 1.553 Vali Acc: 0.400 Test Loss: 1.553 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 0.5006954669952393
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.444 Vali Acc: 0.225 Test Loss: 1.444 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5176200866699219
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.389 Vali Acc: 0.275 Test Loss: 1.389 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5676889419555664
Epoch: 4, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.332 Vali Acc: 0.425 Test Loss: 1.332 Test Acc: 0.425
Validation loss decreased (-0.399984 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.5099296569824219
Epoch: 5, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.268 Vali Acc: 0.375 Test Loss: 1.268 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5118145942687988
Epoch: 6, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.219 Vali Acc: 0.700 Test Loss: 1.219 Test Acc: 0.700
Validation loss decreased (-0.424987 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.608630895614624
Epoch: 7, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.168 Vali Acc: 0.675 Test Loss: 1.168 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5714662075042725
Epoch: 8, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5046257972717285
Epoch: 9, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6057422161102295
Epoch: 10, Steps: 3 | Train Loss: 0.853 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 0.5514678955078125
Epoch: 11, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.45780038833618164
Epoch: 12, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.845 Vali Acc: 0.800 Test Loss: 0.845 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.5020334720611572
Epoch: 13, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.771 Vali Acc: 0.825 Test Loss: 0.771 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 0.58742356300354
Epoch: 14, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.5103631019592285
Epoch: 15, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4390401840209961
Epoch: 16, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.5008938312530518
Epoch: 17, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.5270736217498779
Epoch: 18, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.5747270584106445
Epoch: 19, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.42951464653015137
Epoch: 20, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.3775899410247803
Epoch: 21, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.514 Vali Acc: 0.800 Test Loss: 0.514 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.3945753574371338
Epoch: 22, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.40032219886779785
Epoch: 23, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.449 Vali Acc: 0.800 Test Loss: 0.449 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.38722825050354004
Epoch: 24, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.39266204833984375
Epoch: 25, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.39699435234069824
Epoch: 26, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4514188766479492
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.472 Vali Acc: 0.825 Test Loss: 0.472 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.3945004940032959
Epoch: 28, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.461 Vali Acc: 0.825 Test Loss: 0.461 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.40680670738220215
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 43613188
model size : 181.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.952026128768921
Epoch: 1, Steps: 3 | Train Loss: 1.518 Vali Loss: 1.428 Vali Acc: 0.325 Test Loss: 1.428 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.4358634948730469
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.418 Vali Acc: 0.225 Test Loss: 1.418 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3960859775543213
Epoch: 3, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.393 Vali Acc: 0.275 Test Loss: 1.393 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3664407730102539
Epoch: 4, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.363 Vali Acc: 0.275 Test Loss: 1.363 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3779120445251465
Epoch: 5, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.42138099670410156
Epoch: 6, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.281 Vali Acc: 0.475 Test Loss: 1.281 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.4685947895050049
Epoch: 7, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.241 Vali Acc: 0.525 Test Loss: 1.241 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.5368125438690186
Epoch: 8, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.5342800617218018
Epoch: 9, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.157 Vali Acc: 0.550 Test Loss: 1.157 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.5332856178283691
Epoch: 10, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.5053067207336426
Epoch: 11, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.064 Vali Acc: 0.850 Test Loss: 1.064 Test Acc: 0.850
Validation loss decreased (-0.699989 --> -0.849989).  Saving model ...
Epoch: 12 cost time: 0.4684114456176758
Epoch: 12, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.012 Vali Acc: 0.850 Test Loss: 1.012 Test Acc: 0.850
Validation loss decreased (-0.849989 --> -0.849990).  Saving model ...
Epoch: 13 cost time: 0.4748818874359131
Epoch: 13, Steps: 3 | Train Loss: 0.871 Vali Loss: 0.963 Vali Acc: 0.850 Test Loss: 0.963 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 14 cost time: 0.48517465591430664
Epoch: 14, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.918 Vali Acc: 0.850 Test Loss: 0.918 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 0.5074942111968994
Epoch: 15, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 0.4465761184692383
Epoch: 16, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.821 Vali Acc: 0.850 Test Loss: 0.821 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.4957153797149658
Epoch: 17, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.752 Vali Acc: 0.825 Test Loss: 0.752 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.44278502464294434
Epoch: 18, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.4858112335205078
Epoch: 19, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.5521154403686523
Epoch: 20, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.5081644058227539
Epoch: 21, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4977595806121826
Epoch: 22, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.47324275970458984
Epoch: 23, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.51145339012146
Epoch: 24, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.40518856048583984
Epoch: 25, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.536 Vali Acc: 0.800 Test Loss: 0.536 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4458444118499756
Epoch: 26, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.509 Vali Acc: 0.800 Test Loss: 0.509 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.42228007316589355
Epoch: 27, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.458 Vali Acc: 0.825 Test Loss: 0.458 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4561727046966553
Epoch: 28, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4848308563232422
Epoch: 29, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.44887423515319824
Epoch: 30, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.459155797958374
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.4639768600463867
Epoch: 32, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4153742790222168
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5071868896484375
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.44680285453796387
Epoch: 35, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.46311330795288086
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.47943735122680664
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.47808361053466797
Epoch: 38, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.4878268241882324
Epoch: 39, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.45299792289733887
Epoch: 40, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4701237678527832
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 43580932
model size : 180.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.085226535797119
Epoch: 1, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5315549373626709
Epoch: 2, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5254461765289307
Epoch: 3, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.299 Vali Acc: 0.450 Test Loss: 1.299 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.5871691703796387
Epoch: 4, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5094497203826904
Epoch: 5, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.149 Vali Acc: 0.675 Test Loss: 1.149 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.48424339294433594
Epoch: 6, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.065 Vali Acc: 0.800 Test Loss: 1.065 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799989).  Saving model ...
Epoch: 7 cost time: 0.6271007061004639
Epoch: 7, Steps: 3 | Train Loss: 1.025 Vali Loss: 0.977 Vali Acc: 0.850 Test Loss: 0.977 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.49022936820983887
Epoch: 8, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.898 Vali Acc: 0.800 Test Loss: 0.898 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5159497261047363
Epoch: 9, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.830 Vali Acc: 0.675 Test Loss: 0.830 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4406137466430664
Epoch: 10, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.760 Vali Acc: 0.675 Test Loss: 0.760 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4408073425292969
Epoch: 11, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.43033790588378906
Epoch: 12, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.4662320613861084
Epoch: 13, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.580 Vali Acc: 0.925 Test Loss: 0.580 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.6093440055847168
Epoch: 14, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.4757213592529297
Epoch: 15, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.48958897590637207
Epoch: 16, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5868673324584961
Epoch: 17, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5150799751281738
Epoch: 18, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.468994140625
Epoch: 19, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.43225765228271484
Epoch: 20, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5192480087280273
Epoch: 21, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5825698375701904
Epoch: 22, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6153638362884521
Epoch: 23, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.925 Test Loss: 0.236 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.429429292678833
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4082670211791992
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.5875370502471924
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6608524322509766
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5801596641540527
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.610626220703125
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.535834550857544
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5646860599517822
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5053305625915527
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5805022716522217
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.494952917098999
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5637750625610352
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6225087642669678
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5658512115478516
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.925 Test Loss: 0.172 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6035752296447754
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.925 Test Loss: 0.176 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5408935546875
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.925 Test Loss: 0.180 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6495559215545654
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.925 Test Loss: 0.184 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5527169704437256
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6250693798065186
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.546076774597168
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5927410125732422
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43659268
model size : 181.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9493470191955566
Epoch: 1, Steps: 3 | Train Loss: 1.546 Vali Loss: 1.419 Vali Acc: 0.300 Test Loss: 1.419 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.45143914222717285
Epoch: 2, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.430 Vali Acc: 0.325 Test Loss: 1.430 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5269732475280762
Epoch: 3, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4271688461303711
Epoch: 4, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.517892599105835
Epoch: 5, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.276 Vali Acc: 0.425 Test Loss: 1.276 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.5402896404266357
Epoch: 6, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.211 Vali Acc: 0.475 Test Loss: 1.211 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.5077242851257324
Epoch: 7, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.135 Vali Acc: 0.575 Test Loss: 1.135 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.4898099899291992
Epoch: 8, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.055 Vali Acc: 0.750 Test Loss: 1.055 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 0.49339842796325684
Epoch: 9, Steps: 3 | Train Loss: 0.953 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.5559482574462891
Epoch: 10, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.914 Vali Acc: 0.900 Test Loss: 0.914 Test Acc: 0.900
Validation loss decreased (-0.799990 --> -0.899991).  Saving model ...
Epoch: 11 cost time: 0.531442403793335
Epoch: 11, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.855 Vali Acc: 0.900 Test Loss: 0.855 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 12 cost time: 0.5205285549163818
Epoch: 12, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.802 Vali Acc: 0.875 Test Loss: 0.802 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.527301549911499
Epoch: 13, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.56307053565979
Epoch: 14, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.656 Vali Acc: 0.900 Test Loss: 0.656 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.4538614749908447
Epoch: 15, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3977220058441162
Epoch: 16, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.392336368560791
Epoch: 17, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.4788968563079834
Epoch: 18, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.46683597564697266
Epoch: 19, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.511533260345459
Epoch: 20, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.44788432121276855
Epoch: 21, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 0.5319163799285889
Epoch: 22, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5105857849121094
Epoch: 23, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.558305025100708
Epoch: 24, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5640957355499268
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.529144287109375
Epoch: 26, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5289037227630615
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5047025680541992
Epoch: 28, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5504076480865479
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.48722362518310547
Epoch: 30, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.49227142333984375
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 43617796
model size : 181.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9787800312042236
Epoch: 1, Steps: 3 | Train Loss: 1.651 Vali Loss: 1.441 Vali Acc: 0.325 Test Loss: 1.441 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.41251468658447266
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.402 Vali Acc: 0.275 Test Loss: 1.402 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4089231491088867
Epoch: 3, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4359879493713379
Epoch: 4, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.44412970542907715
Epoch: 5, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5439841747283936
Epoch: 6, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.286 Vali Acc: 0.450 Test Loss: 1.286 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.47077322006225586
Epoch: 7, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.48415350914001465
Epoch: 8, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.192 Vali Acc: 0.750 Test Loss: 1.192 Test Acc: 0.750
Validation loss decreased (-0.549988 --> -0.749988).  Saving model ...
Epoch: 9 cost time: 0.4818735122680664
Epoch: 9, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.133 Vali Acc: 0.725 Test Loss: 1.133 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47568798065185547
Epoch: 10, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.068 Vali Acc: 0.775 Test Loss: 1.068 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774989).  Saving model ...
Epoch: 11 cost time: 0.49136948585510254
Epoch: 11, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.006 Vali Acc: 0.775 Test Loss: 1.006 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.47022318840026855
Epoch: 12, Steps: 3 | Train Loss: 0.924 Vali Loss: 0.941 Vali Acc: 0.775 Test Loss: 0.941 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.49821949005126953
Epoch: 13, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.5097410678863525
Epoch: 14, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.784 Vali Acc: 0.800 Test Loss: 0.784 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.48473024368286133
Epoch: 15, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.5178091526031494
Epoch: 16, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.5372095108032227
Epoch: 17, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.5176355838775635
Epoch: 18, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 0.48479366302490234
Epoch: 19, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.4667947292327881
Epoch: 20, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5153148174285889
Epoch: 21, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.47718143463134766
Epoch: 22, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4426102638244629
Epoch: 23, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.46482372283935547
Epoch: 24, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.5077385902404785
Epoch: 25, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.4272453784942627
Epoch: 26, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.47895193099975586
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.5355861186981201
Epoch: 28, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.4623680114746094
Epoch: 29, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.523780345916748
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.4244225025177002
Epoch: 31, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.562446117401123
Epoch: 32, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4862220287322998
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4165654182434082
Epoch: 34, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4588463306427002
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.4574568271636963
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5130889415740967
Epoch: 37, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.4600801467895508
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.5158491134643555
Epoch: 39, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.5027377605438232
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.529348611831665
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.5239765644073486
Epoch: 42, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.5156452655792236
Epoch: 43, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.5510749816894531
Epoch: 44, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5210256576538086
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5282576084136963
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.43373870849609375
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4292869567871094
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.4988560676574707
Epoch: 49, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.45690488815307617
Epoch: 50, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43590148
model size : 180.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9286985397338867
Epoch: 1, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.423 Vali Acc: 0.375 Test Loss: 1.423 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.48859429359436035
Epoch: 2, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.460 Vali Acc: 0.250 Test Loss: 1.460 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47139930725097656
Epoch: 3, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.399 Vali Acc: 0.450 Test Loss: 1.399 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.46807289123535156
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.309 Vali Acc: 0.525 Test Loss: 1.309 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.6363565921783447
Epoch: 5, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.188 Vali Acc: 0.475 Test Loss: 1.188 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5254378318786621
Epoch: 6, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.5765426158905029
Epoch: 7, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.6248469352722168
Epoch: 8, Steps: 3 | Train Loss: 0.923 Vali Loss: 0.952 Vali Acc: 0.800 Test Loss: 0.952 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.5979392528533936
Epoch: 9, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6279909610748291
Epoch: 10, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.840 Vali Acc: 0.700 Test Loss: 0.840 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5566754341125488
Epoch: 11, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5215537548065186
Epoch: 12, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.732 Vali Acc: 0.775 Test Loss: 0.732 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6320385932922363
Epoch: 13, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799994).  Saving model ...
Epoch: 14 cost time: 0.5472795963287354
Epoch: 14, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.5870544910430908
Epoch: 15, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.470 Vali Acc: 0.825 Test Loss: 0.470 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5986840724945068
Epoch: 16, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.5702886581420898
Epoch: 17, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5013813972473145
Epoch: 18, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6597902774810791
Epoch: 19, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.525413990020752
Epoch: 20, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.5669126510620117
Epoch: 21, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 0.5202221870422363
Epoch: 22, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5225157737731934
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5260782241821289
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.413 Vali Acc: 0.825 Test Loss: 0.413 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5671122074127197
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6348297595977783
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.4680349826812744
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.6321020126342773
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.4705016613006592
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5490787029266357
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.6687808036804199
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.608931303024292
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.653876543045044
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5766677856445312
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.875 Test Loss: 0.271 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.49909543991088867
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.875 Test Loss: 0.264 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6236295700073242
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.875 Test Loss: 0.258 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5373251438140869
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6865673065185547
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5161764621734619
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.532940149307251
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 43686916
model size : 181.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.963402509689331
Epoch: 1, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.404 Vali Acc: 0.150 Test Loss: 1.404 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.4488205909729004
Epoch: 2, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.432 Vali Acc: 0.150 Test Loss: 1.432 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4054107666015625
Epoch: 3, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.406 Vali Acc: 0.175 Test Loss: 1.406 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.4859790802001953
Epoch: 4, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.357 Vali Acc: 0.325 Test Loss: 1.357 Test Acc: 0.325
Validation loss decreased (-0.174986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.41599130630493164
Epoch: 5, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.304 Vali Acc: 0.475 Test Loss: 1.304 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.43787074089050293
Epoch: 6, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.233 Vali Acc: 0.475 Test Loss: 1.233 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.4408261775970459
Epoch: 7, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.4219796657562256
Epoch: 8, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.48176074028015137
Epoch: 9, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.4943251609802246
Epoch: 10, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.4262418746948242
Epoch: 11, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.969 Vali Acc: 0.675 Test Loss: 0.969 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.4222259521484375
Epoch: 12, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.912 Vali Acc: 0.775 Test Loss: 0.912 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.47131800651550293
Epoch: 13, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.840 Vali Acc: 0.800 Test Loss: 0.840 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 0.42130541801452637
Epoch: 14, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 0.41495370864868164
Epoch: 15, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.686 Vali Acc: 0.875 Test Loss: 0.686 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.5360133647918701
Epoch: 16, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.442368745803833
Epoch: 17, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.501779317855835
Epoch: 18, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.46337389945983887
Epoch: 19, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.46181178092956543
Epoch: 20, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5017592906951904
Epoch: 21, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.4220006465911865
Epoch: 22, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.517707347869873
Epoch: 23, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5284337997436523
Epoch: 24, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.41256189346313477
Epoch: 25, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.41820645332336426
Epoch: 26, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4440877437591553
Epoch: 27, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.432722806930542
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4456675052642822
Epoch: 29, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.456392765045166
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.44925928115844727
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.45900917053222656
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.4354848861694336
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.49709200859069824
Epoch: 34, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.4604673385620117
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 0.5339131355285645
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 0.5151112079620361
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4099431037902832
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 39 cost time: 0.42208313941955566
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 0.5416646003723145
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.533466100692749
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4359571933746338
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.46776556968688965
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5000739097595215
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.47826123237609863
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4244575500488281
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 0.4650290012359619
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 48 cost time: 0.51070237159729
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 49 cost time: 0.45464372634887695
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 50 cost time: 0.5269949436187744
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 43636228
model size : 181.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7854790687561035
Epoch: 1, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.386 Vali Acc: 0.300 Test Loss: 1.386 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.3853638172149658
Epoch: 2, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.376 Vali Acc: 0.300 Test Loss: 1.376 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.4150233268737793
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.358 Vali Acc: 0.325 Test Loss: 1.358 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.5113868713378906
Epoch: 4, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.334 Vali Acc: 0.350 Test Loss: 1.334 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.49628758430480957
Epoch: 5, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.307 Vali Acc: 0.475 Test Loss: 1.307 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.4271566867828369
Epoch: 6, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.4345855712890625
Epoch: 7, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.4906172752380371
Epoch: 8, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.204 Vali Acc: 0.575 Test Loss: 1.204 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.500136137008667
Epoch: 9, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.156 Vali Acc: 0.650 Test Loss: 1.156 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.47148895263671875
Epoch: 10, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.116 Vali Acc: 0.700 Test Loss: 1.116 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.4767787456512451
Epoch: 11, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.066 Vali Acc: 0.750 Test Loss: 1.066 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 0.47377848625183105
Epoch: 12, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.013 Vali Acc: 0.675 Test Loss: 1.013 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.46750974655151367
Epoch: 13, Steps: 3 | Train Loss: 0.882 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.43386006355285645
Epoch: 14, Steps: 3 | Train Loss: 0.904 Vali Loss: 0.929 Vali Acc: 0.600 Test Loss: 0.929 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4677903652191162
Epoch: 15, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.876 Vali Acc: 0.625 Test Loss: 0.876 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4626781940460205
Epoch: 16, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.823 Vali Acc: 0.650 Test Loss: 0.823 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4813814163208008
Epoch: 17, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.754 Vali Acc: 0.875 Test Loss: 0.754 Test Acc: 0.875
Validation loss decreased (-0.749989 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.42065000534057617
Epoch: 18, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.4577488899230957
Epoch: 19, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 0.44217896461486816
Epoch: 20, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.44246363639831543
Epoch: 21, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.4180257320404053
Epoch: 22, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.5136768817901611
Epoch: 23, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4422461986541748
Epoch: 24, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.45937275886535645
Epoch: 25, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.423 Vali Acc: 0.800 Test Loss: 0.423 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.41570043563842773
Epoch: 26, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.433 Vali Acc: 0.825 Test Loss: 0.433 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4361608028411865
Epoch: 27, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.44174718856811523
Epoch: 28, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.430 Vali Acc: 0.800 Test Loss: 0.430 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.39818906784057617
Epoch: 29, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.415 Vali Acc: 0.825 Test Loss: 0.415 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.46351075172424316
Epoch: 30, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4604930877685547
Epoch: 31, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.41329121589660645
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.4383516311645508
Epoch: 33, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.523698091506958
Epoch: 34, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.47675037384033203
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.43651747703552246
Epoch: 36, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4128999710083008
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.399064302444458
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.42992305755615234
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.38464975357055664
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4005701541900635
Epoch: 41, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.38633298873901367
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4577643871307373
Epoch: 43, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.4082808494567871
Epoch: 44, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.40747761726379395
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 43613188
model size : 181.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1419081687927246
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.412 Vali Acc: 0.275 Test Loss: 1.412 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5700345039367676
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.351 Vali Acc: 0.450 Test Loss: 1.351 Test Acc: 0.450
Validation loss decreased (-0.274986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.6427559852600098
Epoch: 3, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.299 Vali Acc: 0.450 Test Loss: 1.299 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.48540782928466797
Epoch: 4, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.244 Vali Acc: 0.325 Test Loss: 1.244 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6371207237243652
Epoch: 5, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.184 Vali Acc: 0.600 Test Loss: 1.184 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.6118855476379395
Epoch: 6, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.129 Vali Acc: 0.775 Test Loss: 1.129 Test Acc: 0.775
Validation loss decreased (-0.599988 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.6307964324951172
Epoch: 7, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.074 Vali Acc: 0.850 Test Loss: 1.074 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849989).  Saving model ...
Epoch: 8 cost time: 0.6761410236358643
Epoch: 8, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.005 Vali Acc: 0.725 Test Loss: 1.005 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5681676864624023
Epoch: 9, Steps: 3 | Train Loss: 0.866 Vali Loss: 0.923 Vali Acc: 0.750 Test Loss: 0.923 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5473001003265381
Epoch: 10, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.848 Vali Acc: 0.725 Test Loss: 0.848 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5567822456359863
Epoch: 11, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5711557865142822
Epoch: 12, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5402481555938721
Epoch: 13, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.4655497074127197
Epoch: 14, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.534661054611206
Epoch: 15, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.6158924102783203
Epoch: 16, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.6236941814422607
Epoch: 17, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.45961880683898926
Epoch: 18, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.6598250865936279
Epoch: 19, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.5524845123291016
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5559945106506348
Epoch: 21, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.538646936416626
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.5212039947509766
Epoch: 23, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.6274220943450928
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.6564757823944092
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.4780464172363281
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.6126747131347656
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.5615689754486084
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.6315810680389404
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 0.6003103256225586
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 31 cost time: 0.5680749416351318
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 32 cost time: 0.5439462661743164
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5166585445404053
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5201241970062256
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.44640517234802246
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.5824623107910156
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.47783470153808594
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.5490355491638184
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.52467942237854
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5935826301574707
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.592893123626709
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.6207418441772461
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.563906192779541
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.5894980430603027
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 1.000 Test Loss: 0.087 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 43691524
model size : 181.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7808010578155518
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.509145975112915
Epoch: 2, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.349 Vali Acc: 0.450 Test Loss: 1.349 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.501291036605835
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.323 Vali Acc: 0.525 Test Loss: 1.323 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.5156645774841309
Epoch: 4, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.5564875602722168
Epoch: 5, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.240 Vali Acc: 0.650 Test Loss: 1.240 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.5027961730957031
Epoch: 6, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.199 Vali Acc: 0.650 Test Loss: 1.199 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 0.5028238296508789
Epoch: 7, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.151 Vali Acc: 0.700 Test Loss: 1.151 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.602764368057251
Epoch: 8, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.091 Vali Acc: 0.800 Test Loss: 1.091 Test Acc: 0.800
Validation loss decreased (-0.699988 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.5823123455047607
Epoch: 9, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.038 Vali Acc: 0.800 Test Loss: 1.038 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.5792145729064941
Epoch: 10, Steps: 3 | Train Loss: 0.964 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.4852573871612549
Epoch: 11, Steps: 3 | Train Loss: 0.916 Vali Loss: 0.923 Vali Acc: 0.850 Test Loss: 0.923 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.5573172569274902
Epoch: 12, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.5714643001556396
Epoch: 13, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.808 Vali Acc: 0.900 Test Loss: 0.808 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.5357539653778076
Epoch: 14, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.745 Vali Acc: 0.900 Test Loss: 0.745 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.5016255378723145
Epoch: 15, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.672 Vali Acc: 0.900 Test Loss: 0.672 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.5221936702728271
Epoch: 16, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.416517972946167
Epoch: 17, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.47618961334228516
Epoch: 18, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.498 Vali Acc: 0.825 Test Loss: 0.498 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4318404197692871
Epoch: 19, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.5573410987854004
Epoch: 20, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.899996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.5377745628356934
Epoch: 21, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5060298442840576
Epoch: 22, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.525475025177002
Epoch: 23, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.45600080490112305
Epoch: 24, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5367865562438965
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.46335291862487793
Epoch: 26, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4748263359069824
Epoch: 27, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4270601272583008
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5066812038421631
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4812321662902832
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5043716430664062
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4900076389312744
Epoch: 32, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.5763270854949951
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.522463321685791
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5486500263214111
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4929187297821045
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5500602722167969
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5053715705871582
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.598247766494751
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.46506667137145996
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.5471446514129639
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.502434492111206
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.5670602321624756
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.5891468524932861
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.47789764404296875
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.4815850257873535
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.5380876064300537
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.45142650604248047
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.5495789051055908
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.45998120307922363
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43659268
model size : 181.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9653863906860352
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.416 Vali Acc: 0.250 Test Loss: 1.416 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.511206865310669
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.4933621883392334
Epoch: 3, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.386 Vali Acc: 0.325 Test Loss: 1.386 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.4622819423675537
Epoch: 4, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.364 Vali Acc: 0.325 Test Loss: 1.364 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.45215272903442383
Epoch: 5, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.340 Vali Acc: 0.375 Test Loss: 1.340 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.4260547161102295
Epoch: 6, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.310 Vali Acc: 0.350 Test Loss: 1.310 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.40331506729125977
Epoch: 7, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.275 Vali Acc: 0.525 Test Loss: 1.275 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.4652748107910156
Epoch: 8, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.233 Vali Acc: 0.525 Test Loss: 1.233 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.4765000343322754
Epoch: 9, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.4558603763580322
Epoch: 10, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.47038817405700684
Epoch: 11, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.103 Vali Acc: 0.575 Test Loss: 1.103 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.4540293216705322
Epoch: 12, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.5201408863067627
Epoch: 13, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.005 Vali Acc: 0.725 Test Loss: 1.005 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.4918231964111328
Epoch: 14, Steps: 3 | Train Loss: 0.900 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.5253510475158691
Epoch: 15, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5621528625488281
Epoch: 16, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.835 Vali Acc: 0.725 Test Loss: 0.835 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5284619331359863
Epoch: 17, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.766 Vali Acc: 0.775 Test Loss: 0.766 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 0.5632350444793701
Epoch: 18, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5176658630371094
Epoch: 19, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 20 cost time: 0.47992753982543945
Epoch: 20, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799994).  Saving model ...
Epoch: 21 cost time: 0.5196149349212646
Epoch: 21, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.471346378326416
Epoch: 22, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.4295957088470459
Epoch: 23, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.544320821762085
Epoch: 24, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4776039123535156
Epoch: 25, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.434 Vali Acc: 0.825 Test Loss: 0.434 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.481647253036499
Epoch: 26, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.45004844665527344
Epoch: 27, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5042562484741211
Epoch: 28, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4895651340484619
Epoch: 29, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.48775315284729004
Epoch: 30, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4522223472595215
Epoch: 31, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.43720221519470215
Epoch: 32, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.4442110061645508
Epoch: 33, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 43636228
model size : 181.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.892366647720337
Epoch: 1, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.418 Vali Acc: 0.375 Test Loss: 1.418 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.49255895614624023
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.401 Vali Acc: 0.350 Test Loss: 1.401 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.484846830368042
Epoch: 3, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.5091354846954346
Epoch: 4, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.5841281414031982
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.192 Vali Acc: 0.625 Test Loss: 1.192 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.6063752174377441
Epoch: 6, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.115 Vali Acc: 0.700 Test Loss: 1.115 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.4662480354309082
Epoch: 7, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.039 Vali Acc: 0.800 Test Loss: 1.039 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.4830048084259033
Epoch: 8, Steps: 3 | Train Loss: 0.983 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4644930362701416
Epoch: 9, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.918 Vali Acc: 0.800 Test Loss: 0.918 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.5671353340148926
Epoch: 10, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.847 Vali Acc: 0.800 Test Loss: 0.847 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.443403959274292
Epoch: 11, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.45624232292175293
Epoch: 12, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5142695903778076
Epoch: 13, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5038375854492188
Epoch: 14, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.5623888969421387
Epoch: 15, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.4415764808654785
Epoch: 16, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.410 Vali Acc: 0.825 Test Loss: 0.410 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5042784214019775
Epoch: 17, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.438 Vali Acc: 0.825 Test Loss: 0.438 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5733327865600586
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5700416564941406
Epoch: 19, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.47243499755859375
Epoch: 20, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.899996 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.5206568241119385
Epoch: 21, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.5771207809448242
Epoch: 22, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 1.000 Test Loss: 0.179 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 43732996
model size : 181.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9617130756378174
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.423 Vali Acc: 0.275 Test Loss: 1.423 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.48940205574035645
Epoch: 2, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.402 Vali Acc: 0.275 Test Loss: 1.402 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5082869529724121
Epoch: 3, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.376 Vali Acc: 0.475 Test Loss: 1.376 Test Acc: 0.475
Validation loss decreased (-0.274986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.4905426502227783
Epoch: 4, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.337 Vali Acc: 0.450 Test Loss: 1.337 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.45986127853393555
Epoch: 5, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.287 Vali Acc: 0.575 Test Loss: 1.287 Test Acc: 0.575
Validation loss decreased (-0.474986 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.46262335777282715
Epoch: 6, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.226 Vali Acc: 0.575 Test Loss: 1.226 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.4016382694244385
Epoch: 7, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.162 Vali Acc: 0.575 Test Loss: 1.162 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.49799013137817383
Epoch: 8, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.4312925338745117
Epoch: 9, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.038 Vali Acc: 0.625 Test Loss: 1.038 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.460066556930542
Epoch: 10, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.5203804969787598
Epoch: 11, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.919 Vali Acc: 0.650 Test Loss: 0.919 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 0.5604503154754639
Epoch: 12, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.868 Vali Acc: 0.700 Test Loss: 0.868 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.4217250347137451
Epoch: 13, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.815 Vali Acc: 0.675 Test Loss: 0.815 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4218611717224121
Epoch: 14, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.759 Vali Acc: 0.750 Test Loss: 0.759 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.5224075317382812
Epoch: 15, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.5016624927520752
Epoch: 16, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.5353059768676758
Epoch: 17, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.4685845375061035
Epoch: 18, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4768550395965576
Epoch: 19, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.509 Vali Acc: 0.800 Test Loss: 0.509 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4726297855377197
Epoch: 20, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.483 Vali Acc: 0.775 Test Loss: 0.483 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4647812843322754
Epoch: 21, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 0.45326900482177734
Epoch: 22, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.849996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.5538923740386963
Epoch: 23, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4688096046447754
Epoch: 24, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.4888935089111328
Epoch: 25, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4712686538696289
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.4830310344696045
Epoch: 27, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.49607229232788086
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5057108402252197
Epoch: 29, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.49915409088134766
Epoch: 30, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.442065954208374
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5300502777099609
Epoch: 32, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5210659503936768
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5168554782867432
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4598963260650635
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4691128730773926
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43696132
model size : 181.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8034687042236328
Epoch: 1, Steps: 3 | Train Loss: 1.583 Vali Loss: 1.438 Vali Acc: 0.075 Test Loss: 1.438 Test Acc: 0.075
Validation loss decreased (inf --> -0.074986).  Saving model ...
Epoch: 2 cost time: 0.46820974349975586
Epoch: 2, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.421 Vali Acc: 0.100 Test Loss: 1.421 Test Acc: 0.100
Validation loss decreased (-0.074986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.4703702926635742
Epoch: 3, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.403 Vali Acc: 0.125 Test Loss: 1.403 Test Acc: 0.125
Validation loss decreased (-0.099986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 0.4486424922943115
Epoch: 4, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.380 Vali Acc: 0.200 Test Loss: 1.380 Test Acc: 0.200
Validation loss decreased (-0.124986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 0.4525330066680908
Epoch: 5, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.353 Vali Acc: 0.300 Test Loss: 1.353 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.48941826820373535
Epoch: 6, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.325 Vali Acc: 0.525 Test Loss: 1.325 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.4807717800140381
Epoch: 7, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.292 Vali Acc: 0.575 Test Loss: 1.292 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 0.46054863929748535
Epoch: 8, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.263 Vali Acc: 0.625 Test Loss: 1.263 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.41513586044311523
Epoch: 9, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 0.4398508071899414
Epoch: 10, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4946129322052002
Epoch: 11, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.135 Vali Acc: 0.625 Test Loss: 1.135 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.46604156494140625
Epoch: 12, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.44117021560668945
Epoch: 13, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.43730592727661133
Epoch: 14, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.4642157554626465
Epoch: 15, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.895 Vali Acc: 0.725 Test Loss: 0.895 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.4264211654663086
Epoch: 16, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 17 cost time: 0.5125102996826172
Epoch: 17, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 18 cost time: 0.47638726234436035
Epoch: 18, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.700 Vali Acc: 0.750 Test Loss: 0.700 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 0.47080278396606445
Epoch: 19, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 20 cost time: 0.4935793876647949
Epoch: 20, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
Validation loss decreased (-0.749994 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.4109780788421631
Epoch: 21, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.434375524520874
Epoch: 22, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.4718468189239502
Epoch: 23, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.44178152084350586
Epoch: 24, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.5259804725646973
Epoch: 25, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4794042110443115
Epoch: 26, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.44232177734375
Epoch: 27, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.5223922729492188
Epoch: 28, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4551835060119629
Epoch: 29, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.5261704921722412
Epoch: 30, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.4834287166595459
Epoch: 31, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.47231101989746094
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4451289176940918
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5128734111785889
Epoch: 34, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4350724220275879
Epoch: 35, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.41452646255493164
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.45320868492126465
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.439316987991333
Epoch: 38, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.43589305877685547
Epoch: 39, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.43857622146606445
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.472118616104126
Epoch: 41, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 43677700
model size : 181.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8307864665985107
Epoch: 1, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.383 Vali Acc: 0.300 Test Loss: 1.383 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6647920608520508
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.251 Vali Acc: 0.525 Test Loss: 1.251 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.713118314743042
Epoch: 3, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.110 Vali Acc: 0.625 Test Loss: 1.110 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 0.6677193641662598
Epoch: 4, Steps: 3 | Train Loss: 1.096 Vali Loss: 0.966 Vali Acc: 0.650 Test Loss: 0.966 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 0.7342791557312012
Epoch: 5, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.891 Vali Acc: 0.675 Test Loss: 0.891 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 6 cost time: 0.7192678451538086
Epoch: 6, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.763 Vali Acc: 0.900 Test Loss: 0.763 Test Acc: 0.900
Validation loss decreased (-0.674991 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 0.7407736778259277
Epoch: 7, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.760883092880249
Epoch: 8, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.76589035987854
Epoch: 9, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.7963299751281738
Epoch: 10, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6707367897033691
Epoch: 11, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5997200012207031
Epoch: 12, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8565540313720703
Epoch: 13, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7210335731506348
Epoch: 14, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.767305850982666
Epoch: 15, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6239328384399414
Epoch: 16, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7500720024108887
Epoch: 17, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6451201438903809
Epoch: 18, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6886894702911377
Epoch: 19, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36792580
model size : 155.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.907909631729126
Epoch: 1, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.330 Vali Acc: 0.175 Test Loss: 1.330 Test Acc: 0.175
Validation loss decreased (inf --> -0.174987).  Saving model ...
Epoch: 2 cost time: 0.5619006156921387
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.305 Vali Acc: 0.375 Test Loss: 1.305 Test Acc: 0.375
Validation loss decreased (-0.174987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.4580726623535156
Epoch: 3, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.227 Vali Acc: 0.675 Test Loss: 1.227 Test Acc: 0.675
Validation loss decreased (-0.374987 --> -0.674988).  Saving model ...
Epoch: 4 cost time: 0.6379983425140381
Epoch: 4, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.121 Vali Acc: 0.650 Test Loss: 1.121 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4935765266418457
Epoch: 5, Steps: 3 | Train Loss: 0.967 Vali Loss: 0.978 Vali Acc: 0.825 Test Loss: 0.978 Test Acc: 0.825
Validation loss decreased (-0.674988 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.5945751667022705
Epoch: 6, Steps: 3 | Train Loss: 0.862 Vali Loss: 0.857 Vali Acc: 0.875 Test Loss: 0.857 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.6049802303314209
Epoch: 7, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.802 Vali Acc: 0.675 Test Loss: 0.802 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5627322196960449
Epoch: 8, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.742 Vali Acc: 0.700 Test Loss: 0.742 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6129171848297119
Epoch: 9, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5489945411682129
Epoch: 10, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.585 Vali Acc: 0.925 Test Loss: 0.585 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.6190781593322754
Epoch: 11, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5750489234924316
Epoch: 12, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.458 Vali Acc: 0.950 Test Loss: 0.458 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.527097225189209
Epoch: 13, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.368 Vali Acc: 0.975 Test Loss: 0.368 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.5720317363739014
Epoch: 14, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5435268878936768
Epoch: 15, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5689578056335449
Epoch: 16, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5180611610412598
Epoch: 17, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5688717365264893
Epoch: 18, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5824973583221436
Epoch: 19, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6319267749786377
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5900602340698242
Epoch: 21, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.480 Vali Acc: 0.775 Test Loss: 0.480 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5176522731781006
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.647831916809082
Epoch: 23, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36571396
model size : 154.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1448330879211426
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5635409355163574
Epoch: 2, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5021312236785889
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.5223498344421387
Epoch: 4, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.183 Vali Acc: 0.625 Test Loss: 1.183 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.4862651824951172
Epoch: 5, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.5645899772644043
Epoch: 6, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.032 Vali Acc: 0.575 Test Loss: 1.032 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5634860992431641
Epoch: 7, Steps: 3 | Train Loss: 0.958 Vali Loss: 0.962 Vali Acc: 0.575 Test Loss: 0.962 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5366981029510498
Epoch: 8, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.878 Vali Acc: 0.825 Test Loss: 0.878 Test Acc: 0.825
Validation loss decreased (-0.649989 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.5129876136779785
Epoch: 9, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.810 Vali Acc: 0.800 Test Loss: 0.810 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5006992816925049
Epoch: 10, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.740 Vali Acc: 0.825 Test Loss: 0.740 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 11 cost time: 0.5380966663360596
Epoch: 11, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.677 Vali Acc: 0.875 Test Loss: 0.677 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.49750494956970215
Epoch: 12, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4837462902069092
Epoch: 13, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.5121617317199707
Epoch: 14, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5525376796722412
Epoch: 15, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5511689186096191
Epoch: 16, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5788187980651855
Epoch: 17, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.577200174331665
Epoch: 18, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5813171863555908
Epoch: 19, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5780634880065918
Epoch: 20, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5836765766143799
Epoch: 21, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.527407169342041
Epoch: 22, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5824482440948486
Epoch: 23, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4990396499633789
Epoch: 24, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4821312427520752
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5338716506958008
Epoch: 26, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5848410129547119
Epoch: 27, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5622243881225586
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5465493202209473
Epoch: 29, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5836400985717773
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.5832672119140625
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5811665058135986
Epoch: 32, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5465233325958252
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.458463191986084
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5227298736572266
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5265152454376221
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5947785377502441
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6644527912139893
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6160829067230225
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6445267200469971
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5739471912384033
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5386812686920166
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36460804
model size : 153.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.853769063949585
Epoch: 1, Steps: 3 | Train Loss: 1.580 Vali Loss: 1.409 Vali Acc: 0.275 Test Loss: 1.409 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5000143051147461
Epoch: 2, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.372 Vali Acc: 0.150 Test Loss: 1.372 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.521115779876709
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.286 Vali Acc: 0.300 Test Loss: 1.286 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.49304819107055664
Epoch: 4, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.167 Vali Acc: 0.625 Test Loss: 1.167 Test Acc: 0.625
Validation loss decreased (-0.299987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.5915002822875977
Epoch: 5, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.48665547370910645
Epoch: 6, Steps: 3 | Train Loss: 0.928 Vali Loss: 0.933 Vali Acc: 0.675 Test Loss: 0.933 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674991).  Saving model ...
Epoch: 7 cost time: 0.4844326972961426
Epoch: 7, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
Validation loss decreased (-0.674991 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 0.4505002498626709
Epoch: 8, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.5252466201782227
Epoch: 9, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5386993885040283
Epoch: 10, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.5566105842590332
Epoch: 11, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.675 Vali Acc: 0.600 Test Loss: 0.675 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5677790641784668
Epoch: 12, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5886566638946533
Epoch: 13, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.5977766513824463
Epoch: 14, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5761191844940186
Epoch: 15, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5174243450164795
Epoch: 16, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5531091690063477
Epoch: 17, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5505924224853516
Epoch: 18, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5131125450134277
Epoch: 19, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.44069647789001465
Epoch: 20, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5037767887115479
Epoch: 21, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4764688014984131
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6088247299194336
Epoch: 23, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6529033184051514
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6662914752960205
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5181126594543457
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.41530275344848633
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4756326675415039
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5193920135498047
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36580612
model size : 154.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7834086418151855
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.322 Vali Acc: 0.350 Test Loss: 1.322 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.5523116588592529
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.285 Vali Acc: 0.475 Test Loss: 1.285 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5383729934692383
Epoch: 3, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.5129749774932861
Epoch: 4, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.156 Vali Acc: 0.700 Test Loss: 1.156 Test Acc: 0.700
Validation loss decreased (-0.524988 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 0.4617650508880615
Epoch: 5, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.045 Vali Acc: 0.725 Test Loss: 1.045 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.5344595909118652
Epoch: 6, Steps: 3 | Train Loss: 0.962 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.5183925628662109
Epoch: 7, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.883 Vali Acc: 0.800 Test Loss: 0.883 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.5550966262817383
Epoch: 8, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 0.5991973876953125
Epoch: 9, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.55240797996521
Epoch: 10, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.636 Vali Acc: 0.925 Test Loss: 0.636 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.6024205684661865
Epoch: 11, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5874440670013428
Epoch: 12, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5824923515319824
Epoch: 13, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5655972957611084
Epoch: 14, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.5869529247283936
Epoch: 15, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5090901851654053
Epoch: 16, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5482664108276367
Epoch: 17, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5618162155151367
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6484136581420898
Epoch: 19, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5161435604095459
Epoch: 20, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5834503173828125
Epoch: 21, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5228772163391113
Epoch: 22, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5561606884002686
Epoch: 23, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.578850269317627
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5018594264984131
Epoch: 25, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6405093669891357
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5990910530090332
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6219773292541504
Epoch: 28, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5083591938018799
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36506884
model size : 153.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.983309030532837
Epoch: 1, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.406 Vali Acc: 0.350 Test Loss: 1.406 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5456080436706543
Epoch: 2, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.351 Vali Acc: 0.275 Test Loss: 1.351 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6588325500488281
Epoch: 3, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.303 Vali Acc: 0.275 Test Loss: 1.303 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5558028221130371
Epoch: 4, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.259 Vali Acc: 0.375 Test Loss: 1.259 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5064747333526611
Epoch: 5, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.228 Vali Acc: 0.375 Test Loss: 1.228 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.5911200046539307
Epoch: 6, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.168 Vali Acc: 0.475 Test Loss: 1.168 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.5409989356994629
Epoch: 7, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.096 Vali Acc: 0.550 Test Loss: 1.096 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.499326229095459
Epoch: 8, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.016 Vali Acc: 0.675 Test Loss: 1.016 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.566148042678833
Epoch: 9, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.927 Vali Acc: 0.725 Test Loss: 0.927 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 0.5427467823028564
Epoch: 10, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.48099708557128906
Epoch: 11, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.5296602249145508
Epoch: 12, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.704 Vali Acc: 0.825 Test Loss: 0.704 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 13 cost time: 0.4792335033416748
Epoch: 13, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.557103157043457
Epoch: 14, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5119342803955078
Epoch: 15, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47396183013916016
Epoch: 16, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.40611958503723145
Epoch: 17, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.420468807220459
Epoch: 18, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3771395683288574
Epoch: 19, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.456575870513916
Epoch: 20, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5175132751464844
Epoch: 21, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5033974647521973
Epoch: 22, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5238244533538818
Epoch: 23, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4121739864349365
Epoch: 24, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4462547302246094
Epoch: 25, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.44669389724731445
Epoch: 26, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.394 Vali Acc: 0.825 Test Loss: 0.394 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.46066880226135254
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 36451588
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.922536849975586
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.363 Vali Acc: 0.475 Test Loss: 1.363 Test Acc: 0.475
Validation loss decreased (inf --> -0.474986).  Saving model ...
Epoch: 2 cost time: 0.45104479789733887
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.451 Vali Acc: 0.275 Test Loss: 1.451 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4628419876098633
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.283 Vali Acc: 0.475 Test Loss: 1.283 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.5976958274841309
Epoch: 4, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.092 Vali Acc: 0.675 Test Loss: 1.092 Test Acc: 0.675
Validation loss decreased (-0.474987 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.5491836071014404
Epoch: 5, Steps: 3 | Train Loss: 1.068 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5222787857055664
Epoch: 6, Steps: 3 | Train Loss: 0.922 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
Validation loss decreased (-0.674989 --> -0.824992).  Saving model ...
Epoch: 7 cost time: 0.4541349411010742
Epoch: 7, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.750 Vali Acc: 0.900 Test Loss: 0.750 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 0.5403304100036621
Epoch: 8, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5050990581512451
Epoch: 9, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.605 Vali Acc: 0.950 Test Loss: 0.605 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5197291374206543
Epoch: 10, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4394659996032715
Epoch: 11, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.5360202789306641
Epoch: 12, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6519391536712646
Epoch: 13, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.5361251831054688
Epoch: 14, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6015524864196777
Epoch: 15, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6143589019775391
Epoch: 16, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5757102966308594
Epoch: 17, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4774014949798584
Epoch: 18, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.6198761463165283
Epoch: 19, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5821115970611572
Epoch: 20, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5476031303405762
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.47847461700439453
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5638577938079834
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.599045991897583
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5778014659881592
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.65372633934021
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5377895832061768
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4613687992095947
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36594436
model size : 154.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.120142698287964
Epoch: 1, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.4743626117706299
Epoch: 2, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5608911514282227
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.48964548110961914
Epoch: 4, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.161 Vali Acc: 0.650 Test Loss: 1.161 Test Acc: 0.650
Validation loss decreased (-0.399987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.4739971160888672
Epoch: 5, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.47173643112182617
Epoch: 6, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5524137020111084
Epoch: 7, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.919 Vali Acc: 0.800 Test Loss: 0.919 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.48371386528015137
Epoch: 8, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.824 Vali Acc: 0.825 Test Loss: 0.824 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.47740840911865234
Epoch: 9, Steps: 3 | Train Loss: 0.648 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 0.5678203105926514
Epoch: 10, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.45305871963500977
Epoch: 11, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 0.5504391193389893
Epoch: 12, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5432617664337158
Epoch: 13, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.4034922122955322
Epoch: 14, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.49704551696777344
Epoch: 15, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5620260238647461
Epoch: 16, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.5322484970092773
Epoch: 17, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.410 Vali Acc: 0.825 Test Loss: 0.410 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4763822555541992
Epoch: 18, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4182138442993164
Epoch: 19, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.5649845600128174
Epoch: 20, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5316214561462402
Epoch: 21, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.5349776744842529
Epoch: 22, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5060994625091553
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.523406982421875
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.48064684867858887
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5002391338348389
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.47356486320495605
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5798673629760742
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.5003395080566406
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4767477512359619
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5008120536804199
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.47262048721313477
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5012340545654297
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.42444682121276855
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5125293731689453
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5404901504516602
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5118131637573242
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4506382942199707
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36520708
model size : 153.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9121003150939941
Epoch: 1, Steps: 3 | Train Loss: 1.522 Vali Loss: 1.310 Vali Acc: 0.225 Test Loss: 1.310 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.512479305267334
Epoch: 2, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.224987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.46978116035461426
Epoch: 3, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.45601415634155273
Epoch: 4, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.47240757942199707
Epoch: 5, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.170 Vali Acc: 0.525 Test Loss: 1.170 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.5605044364929199
Epoch: 6, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.41400623321533203
Epoch: 7, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.022 Vali Acc: 0.675 Test Loss: 1.022 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.539487361907959
Epoch: 8, Steps: 3 | Train Loss: 1.012 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.45415520668029785
Epoch: 9, Steps: 3 | Train Loss: 0.881 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 0.5652561187744141
Epoch: 10, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4681389331817627
Epoch: 11, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.5442533493041992
Epoch: 12, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47807836532592773
Epoch: 13, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.563560962677002
Epoch: 14, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6094508171081543
Epoch: 15, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 0.6033163070678711
Epoch: 16, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5315968990325928
Epoch: 17, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.5836310386657715
Epoch: 18, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6532785892486572
Epoch: 19, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6130721569061279
Epoch: 20, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6062057018280029
Epoch: 21, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.566436767578125
Epoch: 22, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6494927406311035
Epoch: 23, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.56437087059021
Epoch: 24, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5728304386138916
Epoch: 25, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5428121089935303
Epoch: 26, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6944682598114014
Epoch: 27, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.264 Vali Acc: 0.875 Test Loss: 0.264 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 36446980
model size : 153.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.026641607284546
Epoch: 1, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.386 Vali Acc: 0.350 Test Loss: 1.386 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5513424873352051
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.378 Vali Acc: 0.325 Test Loss: 1.378 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5736894607543945
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.251 Vali Acc: 0.525 Test Loss: 1.251 Test Acc: 0.525
Validation loss decreased (-0.349986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.4509432315826416
Epoch: 4, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.115 Vali Acc: 0.575 Test Loss: 1.115 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 0.5069980621337891
Epoch: 5, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.008 Vali Acc: 0.650 Test Loss: 1.008 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.604313850402832
Epoch: 6, Steps: 3 | Train Loss: 0.914 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.5330321788787842
Epoch: 7, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 0.4986293315887451
Epoch: 8, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 0.5409402847290039
Epoch: 9, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5723152160644531
Epoch: 10, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.616 Vali Acc: 0.875 Test Loss: 0.616 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.5776112079620361
Epoch: 11, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.546 Vali Acc: 0.950 Test Loss: 0.546 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.5927073955535889
Epoch: 12, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.492037296295166
Epoch: 13, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5524919033050537
Epoch: 14, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.625460147857666
Epoch: 15, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.606879711151123
Epoch: 16, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5637052059173584
Epoch: 17, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.6314969062805176
Epoch: 18, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5979456901550293
Epoch: 19, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5022141933441162
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5101854801177979
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5427172183990479
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6169991493225098
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5805134773254395
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5842924118041992
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6100327968597412
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5422663688659668
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5646371841430664
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.49762845039367676
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.975 Test Loss: 0.354 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.43921804428100586
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.4612247943878174
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.5740272998809814
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.5069065093994141
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5175137519836426
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.44927358627319336
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.40055108070373535
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3665497303009033
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3477747440338135
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.3624100685119629
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.3685181140899658
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.3769655227661133
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.3511788845062256
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36603652
model size : 154.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6853554248809814
Epoch: 1, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.381 Vali Acc: 0.325 Test Loss: 1.381 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.47794675827026367
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.300 Test Loss: 1.388 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4874446392059326
Epoch: 3, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.4923977851867676
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
Validation loss decreased (-0.374987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.4000229835510254
Epoch: 5, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.126 Vali Acc: 0.550 Test Loss: 1.126 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.43936800956726074
Epoch: 6, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.033 Vali Acc: 0.725 Test Loss: 1.033 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.4491159915924072
Epoch: 7, Steps: 3 | Train Loss: 0.950 Vali Loss: 0.951 Vali Acc: 0.625 Test Loss: 0.951 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46201086044311523
Epoch: 8, Steps: 3 | Train Loss: 0.857 Vali Loss: 0.871 Vali Acc: 0.850 Test Loss: 0.871 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.4853944778442383
Epoch: 9, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.5039272308349609
Epoch: 10, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.791 Vali Acc: 0.725 Test Loss: 0.791 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.565535306930542
Epoch: 11, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.41981935501098633
Epoch: 12, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.5110960006713867
Epoch: 13, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.43576502799987793
Epoch: 14, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4068729877471924
Epoch: 15, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.4975619316101074
Epoch: 16, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4983537197113037
Epoch: 17, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.4787731170654297
Epoch: 18, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4537343978881836
Epoch: 19, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.41456007957458496
Epoch: 20, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4760892391204834
Epoch: 21, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5287463665008545
Epoch: 22, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.394 Vali Acc: 0.800 Test Loss: 0.394 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5283610820770264
Epoch: 23, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4939539432525635
Epoch: 24, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.289 Vali Acc: 0.825 Test Loss: 0.289 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4165682792663574
Epoch: 25, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.49500584602355957
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.499558687210083
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5314772129058838
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5446178913116455
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36497668
model size : 153.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1098647117614746
Epoch: 1, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.367 Vali Acc: 0.225 Test Loss: 1.367 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.4378340244293213
Epoch: 2, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.351 Vali Acc: 0.350 Test Loss: 1.351 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.44847822189331055
Epoch: 3, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.45101165771484375
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.285 Vali Acc: 0.525 Test Loss: 1.285 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.43093395233154297
Epoch: 5, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.4354865550994873
Epoch: 6, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.169 Vali Acc: 0.675 Test Loss: 1.169 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.4684939384460449
Epoch: 7, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.112 Vali Acc: 0.800 Test Loss: 1.112 Test Acc: 0.800
Validation loss decreased (-0.674988 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.4485657215118408
Epoch: 8, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.041 Vali Acc: 0.800 Test Loss: 1.041 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.45818495750427246
Epoch: 9, Steps: 3 | Train Loss: 0.977 Vali Loss: 0.979 Vali Acc: 0.825 Test Loss: 0.979 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.4472787380218506
Epoch: 10, Steps: 3 | Train Loss: 0.899 Vali Loss: 0.916 Vali Acc: 0.850 Test Loss: 0.916 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.47606921195983887
Epoch: 11, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.847 Vali Acc: 0.850 Test Loss: 0.847 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.4521043300628662
Epoch: 12, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.5495524406433105
Epoch: 13, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.730 Vali Acc: 0.825 Test Loss: 0.730 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4406745433807373
Epoch: 14, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.48484230041503906
Epoch: 15, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.608 Vali Acc: 0.875 Test Loss: 0.608 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.5528097152709961
Epoch: 16, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 0.4570002555847168
Epoch: 17, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.43308162689208984
Epoch: 18, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.49962520599365234
Epoch: 19, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.5114791393280029
Epoch: 20, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4532279968261719
Epoch: 21, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.47991204261779785
Epoch: 22, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.3860189914703369
Epoch: 23, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.39197206497192383
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.361649751663208
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.347196102142334
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.40369629859924316
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.36641621589660645
Epoch: 28, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4153141975402832
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.5431063175201416
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.5259566307067871
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.5161445140838623
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4836006164550781
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.5326001644134521
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5235464572906494
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4641757011413574
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.45743417739868164
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.46653318405151367
Epoch: 38, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4883730411529541
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4506850242614746
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 0.4725940227508545
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5203156471252441
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5294551849365234
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.46651411056518555
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.47992801666259766
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.4703202247619629
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.4675595760345459
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.46306419372558594
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.482957124710083
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.43268632888793945
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 36451588
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8672511577606201
Epoch: 1, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.456 Vali Acc: 0.325 Test Loss: 1.456 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.5745487213134766
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.387 Vali Acc: 0.275 Test Loss: 1.387 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5547440052032471
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (-0.324985 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.565711259841919
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.134 Vali Acc: 0.700 Test Loss: 1.134 Test Acc: 0.700
Validation loss decreased (-0.499987 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.5958042144775391
Epoch: 5, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4847218990325928
Epoch: 6, Steps: 3 | Train Loss: 0.974 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.552741289138794
Epoch: 7, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.863 Vali Acc: 0.900 Test Loss: 0.863 Test Acc: 0.900
Validation loss decreased (-0.724990 --> -0.899991).  Saving model ...
Epoch: 8 cost time: 0.5789647102355957
Epoch: 8, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5576567649841309
Epoch: 9, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6064481735229492
Epoch: 10, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.578 Vali Acc: 0.950 Test Loss: 0.578 Test Acc: 0.950
Validation loss decreased (-0.899991 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.6467850208282471
Epoch: 11, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5984475612640381
Epoch: 12, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.59024977684021
Epoch: 13, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5280807018280029
Epoch: 14, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5522284507751465
Epoch: 15, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.5897805690765381
Epoch: 16, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5755853652954102
Epoch: 17, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.565497875213623
Epoch: 18, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5147037506103516
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5210292339324951
Epoch: 20, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.530569314956665
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5450992584228516
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5699784755706787
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6449172496795654
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5797789096832275
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5778212547302246
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.512519359588623
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36617476
model size : 154.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.043797016143799
Epoch: 1, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.429 Vali Acc: 0.400 Test Loss: 1.429 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5845293998718262
Epoch: 2, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.394 Vali Acc: 0.350 Test Loss: 1.394 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5871603488922119
Epoch: 3, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.318 Vali Acc: 0.425 Test Loss: 1.318 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.5382804870605469
Epoch: 4, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5757400989532471
Epoch: 5, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.5530827045440674
Epoch: 6, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.084 Vali Acc: 0.625 Test Loss: 1.084 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5735135078430176
Epoch: 7, Steps: 3 | Train Loss: 0.934 Vali Loss: 0.998 Vali Acc: 0.750 Test Loss: 0.998 Test Acc: 0.750
Validation loss decreased (-0.649988 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.5671536922454834
Epoch: 8, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.907 Vali Acc: 0.800 Test Loss: 0.907 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.5646042823791504
Epoch: 9, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.840 Vali Acc: 0.825 Test Loss: 0.840 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.5025591850280762
Epoch: 10, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.5128607749938965
Epoch: 11, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.760 Vali Acc: 0.675 Test Loss: 0.760 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.49031901359558105
Epoch: 12, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5576996803283691
Epoch: 13, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.591 Vali Acc: 0.925 Test Loss: 0.591 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.4383542537689209
Epoch: 14, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.510695219039917
Epoch: 15, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.452 Vali Acc: 0.950 Test Loss: 0.452 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5934617519378662
Epoch: 16, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.45910143852233887
Epoch: 17, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6015689373016357
Epoch: 18, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5588293075561523
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5435445308685303
Epoch: 20, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5584285259246826
Epoch: 21, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5852134227752686
Epoch: 22, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5736644268035889
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.587646484375
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7014453411102295
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6250123977661133
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36511492
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.878530740737915
Epoch: 1, Steps: 3 | Train Loss: 1.597 Vali Loss: 1.456 Vali Acc: 0.175 Test Loss: 1.456 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.41835808753967285
Epoch: 2, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.441 Vali Acc: 0.150 Test Loss: 1.441 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42096734046936035
Epoch: 3, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.403 Vali Acc: 0.225 Test Loss: 1.403 Test Acc: 0.225
Validation loss decreased (-0.174985 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.5873024463653564
Epoch: 4, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.357 Vali Acc: 0.225 Test Loss: 1.357 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.45644211769104004
Epoch: 5, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.297 Vali Acc: 0.350 Test Loss: 1.297 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.453601598739624
Epoch: 6, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.4334108829498291
Epoch: 7, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.44611620903015137
Epoch: 8, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.5208854675292969
Epoch: 9, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.5051007270812988
Epoch: 10, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 0.5277137756347656
Epoch: 11, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.45426154136657715
Epoch: 12, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.949 Vali Acc: 0.725 Test Loss: 0.949 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.43962526321411133
Epoch: 13, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4316692352294922
Epoch: 14, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.830 Vali Acc: 0.725 Test Loss: 0.830 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 15 cost time: 0.48309874534606934
Epoch: 15, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 0.5366470813751221
Epoch: 16, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.671 Vali Acc: 0.725 Test Loss: 0.671 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.49011898040771484
Epoch: 17, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 0.5088348388671875
Epoch: 18, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 0.4804978370666504
Epoch: 19, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
Validation loss decreased (-0.749994 --> -0.774994).  Saving model ...
Epoch: 20 cost time: 0.506211519241333
Epoch: 20, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.536 Vali Acc: 0.800 Test Loss: 0.536 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799995).  Saving model ...
Epoch: 21 cost time: 0.4567725658416748
Epoch: 21, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.48606276512145996
Epoch: 22, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.520 Vali Acc: 0.800 Test Loss: 0.520 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4160175323486328
Epoch: 23, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.3544926643371582
Epoch: 24, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.5768673419952393
Epoch: 25, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.459 Vali Acc: 0.825 Test Loss: 0.459 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5022997856140137
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.454 Vali Acc: 0.800 Test Loss: 0.454 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.42386341094970703
Epoch: 27, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.435 Vali Acc: 0.825 Test Loss: 0.435 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.44901514053344727
Epoch: 28, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 29 cost time: 0.43108582496643066
Epoch: 29, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.39176034927368164
Epoch: 30, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.439 Vali Acc: 0.825 Test Loss: 0.439 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4145514965057373
Epoch: 31, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.463 Vali Acc: 0.825 Test Loss: 0.463 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4008667469024658
Epoch: 32, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.39046216011047363
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.44367122650146484
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.466 Vali Acc: 0.825 Test Loss: 0.466 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.4535372257232666
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.441 Vali Acc: 0.825 Test Loss: 0.441 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.45583319664001465
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.418 Vali Acc: 0.825 Test Loss: 0.418 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.45683741569519043
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.415 Vali Acc: 0.825 Test Loss: 0.415 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.45429062843322754
Epoch: 38, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.825 Test Loss: 0.419 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 36456196
model size : 153.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.347155809402466
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.386 Vali Acc: 0.300 Test Loss: 1.386 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5735263824462891
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.60064697265625
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5456235408782959
Epoch: 4, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.4797089099884033
Epoch: 5, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.117 Vali Acc: 0.450 Test Loss: 1.117 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4268486499786377
Epoch: 6, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.014 Vali Acc: 0.750 Test Loss: 1.014 Test Acc: 0.750
Validation loss decreased (-0.524988 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.518134355545044
Epoch: 7, Steps: 3 | Train Loss: 0.928 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5197279453277588
Epoch: 8, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.840 Vali Acc: 0.775 Test Loss: 0.840 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 0.43279337882995605
Epoch: 9, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.5779001712799072
Epoch: 10, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46721887588500977
Epoch: 11, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 0.5239131450653076
Epoch: 12, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.4197709560394287
Epoch: 13, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.5138630867004395
Epoch: 14, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5084536075592041
Epoch: 15, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5027320384979248
Epoch: 16, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5095372200012207
Epoch: 17, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4892103672027588
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5977628231048584
Epoch: 19, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5298352241516113
Epoch: 20, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.41991353034973145
Epoch: 21, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4477396011352539
Epoch: 22, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.43354249000549316
Epoch: 23, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.5677669048309326
Epoch: 24, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.42454957962036133
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.3633546829223633
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.3765416145324707
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.3652341365814209
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.46416711807250977
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.48192286491394043
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4749023914337158
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.44506096839904785
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4801971912384033
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4774765968322754
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36557572
model size : 154.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8695428371429443
Epoch: 1, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.380 Vali Acc: 0.250 Test Loss: 1.380 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.45456790924072266
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.294 Vali Acc: 0.375 Test Loss: 1.294 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.5433807373046875
Epoch: 3, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.4770846366882324
Epoch: 4, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.155 Vali Acc: 0.475 Test Loss: 1.155 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5487387180328369
Epoch: 5, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.47582316398620605
Epoch: 6, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5010125637054443
Epoch: 7, Steps: 3 | Train Loss: 0.950 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.46923160552978516
Epoch: 8, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.896 Vali Acc: 0.750 Test Loss: 0.896 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.5129153728485107
Epoch: 9, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.811 Vali Acc: 0.900 Test Loss: 0.811 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.498790979385376
Epoch: 10, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.731 Vali Acc: 0.650 Test Loss: 0.731 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4968101978302002
Epoch: 11, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.48931217193603516
Epoch: 12, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.607 Vali Acc: 0.925 Test Loss: 0.607 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.4565694332122803
Epoch: 13, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.43932437896728516
Epoch: 14, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.46207451820373535
Epoch: 15, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.46033358573913574
Epoch: 16, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.4174690246582031
Epoch: 17, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.5136082172393799
Epoch: 18, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.5333073139190674
Epoch: 19, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.4415304660797119
Epoch: 20, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.5605320930480957
Epoch: 21, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5809428691864014
Epoch: 22, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5136103630065918
Epoch: 23, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5785975456237793
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5422313213348389
Epoch: 25, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4957559108734131
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5861804485321045
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5513336658477783
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5500326156616211
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.46703147888183594
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 36502276
model size : 153.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5244214534759521
Epoch: 1, Steps: 3 | Train Loss: 1.508 Vali Loss: 1.323 Vali Acc: 0.450 Test Loss: 1.323 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.4369075298309326
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.300 Vali Acc: 0.525 Test Loss: 1.300 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.4368276596069336
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.261 Vali Acc: 0.600 Test Loss: 1.261 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.48261356353759766
Epoch: 4, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.214 Vali Acc: 0.625 Test Loss: 1.214 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.45973634719848633
Epoch: 5, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.35178065299987793
Epoch: 6, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.134 Vali Acc: 0.550 Test Loss: 1.134 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.33753156661987305
Epoch: 7, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.4139094352722168
Epoch: 8, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.3970503807067871
Epoch: 9, Steps: 3 | Train Loss: 0.946 Vali Loss: 0.970 Vali Acc: 0.750 Test Loss: 0.970 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.4089663028717041
Epoch: 10, Steps: 3 | Train Loss: 0.920 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.36916160583496094
Epoch: 11, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.855 Vali Acc: 0.825 Test Loss: 0.855 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.4451627731323242
Epoch: 12, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.5064108371734619
Epoch: 13, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.43451976776123047
Epoch: 14, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4379875659942627
Epoch: 15, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4072408676147461
Epoch: 16, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.4775350093841553
Epoch: 17, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.3951756954193115
Epoch: 18, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3864891529083252
Epoch: 19, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3250603675842285
Epoch: 20, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.41321468353271484
Epoch: 21, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.4349939823150635
Epoch: 22, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.41890525817871094
Epoch: 23, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.42857837677001953
Epoch: 24, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3721914291381836
Epoch: 25, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.3960874080657959
Epoch: 26, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.46781396865844727
Epoch: 27, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.41768956184387207
Epoch: 28, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.3811163902282715
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.42358946800231934
Epoch: 30, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4107489585876465
Epoch: 31, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.34714388847351074
Epoch: 32, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36465412
model size : 153.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.083495616912842
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.403 Vali Acc: 0.225 Test Loss: 1.403 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5619463920593262
Epoch: 2, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.395 Vali Acc: 0.225 Test Loss: 1.395 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6092813014984131
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.224986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.49860239028930664
Epoch: 4, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5375244617462158
Epoch: 5, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.5636622905731201
Epoch: 6, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.064 Vali Acc: 0.575 Test Loss: 1.064 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.48691296577453613
Epoch: 7, Steps: 3 | Train Loss: 0.900 Vali Loss: 0.970 Vali Acc: 0.675 Test Loss: 0.970 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.5682897567749023
Epoch: 8, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 0.5215797424316406
Epoch: 9, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.794 Vali Acc: 0.675 Test Loss: 0.794 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5106773376464844
Epoch: 10, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.746 Vali Acc: 0.625 Test Loss: 0.746 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.47325968742370605
Epoch: 11, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.670 Vali Acc: 0.775 Test Loss: 0.670 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 12 cost time: 0.5158262252807617
Epoch: 12, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.560 Vali Acc: 0.925 Test Loss: 0.560 Test Acc: 0.925
Validation loss decreased (-0.774993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.5593440532684326
Epoch: 13, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.517 Vali Acc: 0.950 Test Loss: 0.517 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.6455059051513672
Epoch: 14, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6160461902618408
Epoch: 15, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5960218906402588
Epoch: 16, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.524078369140625
Epoch: 17, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6402149200439453
Epoch: 18, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.579186201095581
Epoch: 19, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5620017051696777
Epoch: 20, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5587077140808105
Epoch: 21, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5721213817596436
Epoch: 22, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5282700061798096
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36571396
model size : 154.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6023261547088623
Epoch: 1, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.435 Vali Acc: 0.175 Test Loss: 1.435 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.4204714298248291
Epoch: 2, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.403 Vali Acc: 0.275 Test Loss: 1.403 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.46503257751464844
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.329 Vali Acc: 0.375 Test Loss: 1.329 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.41883230209350586
Epoch: 4, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.252 Vali Acc: 0.425 Test Loss: 1.252 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.5119812488555908
Epoch: 5, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.185 Vali Acc: 0.550 Test Loss: 1.185 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.4970214366912842
Epoch: 6, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.128 Vali Acc: 0.725 Test Loss: 1.128 Test Acc: 0.725
Validation loss decreased (-0.549988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.4652066230773926
Epoch: 7, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.084 Vali Acc: 0.800 Test Loss: 1.084 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.4644613265991211
Epoch: 8, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.015 Vali Acc: 0.800 Test Loss: 1.015 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.50022292137146
Epoch: 9, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.941 Vali Acc: 0.800 Test Loss: 0.941 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.42908716201782227
Epoch: 10, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.41304755210876465
Epoch: 11, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.5071437358856201
Epoch: 12, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.732 Vali Acc: 0.825 Test Loss: 0.732 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 13 cost time: 0.5639822483062744
Epoch: 13, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4475679397583008
Epoch: 14, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.642 Vali Acc: 0.825 Test Loss: 0.642 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.43116068840026855
Epoch: 15, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.4665229320526123
Epoch: 16, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4272439479827881
Epoch: 17, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.43734049797058105
Epoch: 18, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.43489933013916016
Epoch: 19, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.47692251205444336
Epoch: 20, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.416 Vali Acc: 0.825 Test Loss: 0.416 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.43538403511047363
Epoch: 21, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.462721586227417
Epoch: 22, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.423 Vali Acc: 0.825 Test Loss: 0.423 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4720597267150879
Epoch: 23, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.46389174461364746
Epoch: 24, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4638056755065918
Epoch: 25, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 36516100
model size : 153.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8274693489074707
Epoch: 1, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.479 Vali Acc: 0.325 Test Loss: 1.479 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.44684362411499023
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4883921146392822
Epoch: 3, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.384 Vali Acc: 0.350 Test Loss: 1.384 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.48790597915649414
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5157644748687744
Epoch: 5, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.4591336250305176
Epoch: 6, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.40940356254577637
Epoch: 7, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.209 Vali Acc: 0.450 Test Loss: 1.209 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.4715995788574219
Epoch: 8, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.171 Vali Acc: 0.475 Test Loss: 1.171 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.4487278461456299
Epoch: 9, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.126 Vali Acc: 0.475 Test Loss: 1.126 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 10 cost time: 0.5106596946716309
Epoch: 10, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
Validation loss decreased (-0.474989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.4610168933868408
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.012 Vali Acc: 0.575 Test Loss: 1.012 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4467134475708008
Epoch: 12, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.959 Vali Acc: 0.750 Test Loss: 0.959 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.4563415050506592
Epoch: 13, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.43193483352661133
Epoch: 14, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.40118885040283203
Epoch: 15, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.790 Vali Acc: 0.675 Test Loss: 0.790 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.37224459648132324
Epoch: 16, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.756 Vali Acc: 0.725 Test Loss: 0.756 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.41689038276672363
Epoch: 17, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 18 cost time: 0.4630722999572754
Epoch: 18, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.4204423427581787
Epoch: 19, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.4652254581451416
Epoch: 20, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.520 Vali Acc: 0.800 Test Loss: 0.520 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.47502613067626953
Epoch: 21, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.494 Vali Acc: 0.825 Test Loss: 0.494 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.39694666862487793
Epoch: 22, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.473 Vali Acc: 0.825 Test Loss: 0.473 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.406231164932251
Epoch: 23, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.467 Vali Acc: 0.825 Test Loss: 0.467 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.41331911087036133
Epoch: 24, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.457 Vali Acc: 0.825 Test Loss: 0.457 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.3406186103820801
Epoch: 25, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.464 Vali Acc: 0.825 Test Loss: 0.464 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.3284618854522705
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.457 Vali Acc: 0.800 Test Loss: 0.457 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.39396166801452637
Epoch: 27, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.41385841369628906
Epoch: 28, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.471 Vali Acc: 0.775 Test Loss: 0.471 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.3891904354095459
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.454 Vali Acc: 0.775 Test Loss: 0.454 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 36474628
model size : 153.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7865259647369385
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.5146315097808838
Epoch: 2, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.320 Vali Acc: 0.200 Test Loss: 1.320 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39585351943969727
Epoch: 3, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.4143562316894531
Epoch: 4, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
Validation loss decreased (-0.424988 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.49204015731811523
Epoch: 5, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3991847038269043
Epoch: 6, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.074 Vali Acc: 0.475 Test Loss: 1.074 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.40972256660461426
Epoch: 7, Steps: 3 | Train Loss: 0.952 Vali Loss: 0.937 Vali Acc: 0.850 Test Loss: 0.937 Test Acc: 0.850
Validation loss decreased (-0.599988 --> -0.849991).  Saving model ...
Epoch: 8 cost time: 0.5010483264923096
Epoch: 8, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.855 Vali Acc: 0.825 Test Loss: 0.855 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.553992748260498
Epoch: 9, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.43425798416137695
Epoch: 10, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.4907515048980713
Epoch: 11, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.619 Vali Acc: 0.925 Test Loss: 0.619 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.46547770500183105
Epoch: 12, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.548 Vali Acc: 0.950 Test Loss: 0.548 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.4783506393432617
Epoch: 13, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.40235471725463867
Epoch: 14, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3217434883117676
Epoch: 15, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.34617018699645996
Epoch: 16, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.44742727279663086
Epoch: 17, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3680741786956787
Epoch: 18, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.36652088165283203
Epoch: 19, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4102935791015625
Epoch: 20, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.3471989631652832
Epoch: 21, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.43990564346313477
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.3892171382904053
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.38481688499450684
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.3244037628173828
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.40355587005615234
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36594436
model size : 154.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7821364402770996
Epoch: 1, Steps: 3 | Train Loss: 1.570 Vali Loss: 1.554 Vali Acc: 0.400 Test Loss: 1.554 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 0.45502591133117676
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.445 Vali Acc: 0.225 Test Loss: 1.445 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4578056335449219
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5317823886871338
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.327 Vali Acc: 0.425 Test Loss: 1.327 Test Acc: 0.425
Validation loss decreased (-0.399984 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.48201441764831543
Epoch: 5, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.259 Vali Acc: 0.425 Test Loss: 1.259 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.47223377227783203
Epoch: 6, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.206 Vali Acc: 0.675 Test Loss: 1.206 Test Acc: 0.675
Validation loss decreased (-0.424987 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.469637393951416
Epoch: 7, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5189051628112793
Epoch: 8, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 0.5047585964202881
Epoch: 9, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.037 Vali Acc: 0.725 Test Loss: 1.037 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.39316844940185547
Epoch: 10, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.965 Vali Acc: 0.750 Test Loss: 0.965 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 0.4056425094604492
Epoch: 11, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.898 Vali Acc: 0.825 Test Loss: 0.898 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.44825172424316406
Epoch: 12, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4554765224456787
Epoch: 13, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.45151519775390625
Epoch: 14, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.5486447811126709
Epoch: 15, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4360921382904053
Epoch: 16, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.43921780586242676
Epoch: 17, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.4280717372894287
Epoch: 18, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.42996764183044434
Epoch: 19, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.43955278396606445
Epoch: 20, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4063992500305176
Epoch: 21, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.39589834213256836
Epoch: 22, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.3856492042541504
Epoch: 23, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.489 Vali Acc: 0.825 Test Loss: 0.489 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3860924243927002
Epoch: 24, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.486 Vali Acc: 0.825 Test Loss: 0.486 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3829002380371094
Epoch: 25, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.470 Vali Acc: 0.825 Test Loss: 0.470 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.37140536308288574
Epoch: 26, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.3663790225982666
Epoch: 27, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4990420341491699
Epoch: 28, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.413 Vali Acc: 0.825 Test Loss: 0.413 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 36525316
model size : 154.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7904396057128906
Epoch: 1, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.432 Vali Acc: 0.325 Test Loss: 1.432 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.40287017822265625
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.418 Vali Acc: 0.225 Test Loss: 1.418 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3659391403198242
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.390 Vali Acc: 0.275 Test Loss: 1.390 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3625173568725586
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.359 Vali Acc: 0.300 Test Loss: 1.359 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3689272403717041
Epoch: 5, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.4417455196380615
Epoch: 6, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.283 Vali Acc: 0.475 Test Loss: 1.283 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.4606339931488037
Epoch: 7, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.244 Vali Acc: 0.525 Test Loss: 1.244 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.41941356658935547
Epoch: 8, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.208 Vali Acc: 0.525 Test Loss: 1.208 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.4370877742767334
Epoch: 9, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.413891077041626
Epoch: 10, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.107 Vali Acc: 0.675 Test Loss: 1.107 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.4152414798736572
Epoch: 11, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.061 Vali Acc: 0.850 Test Loss: 1.061 Test Acc: 0.850
Validation loss decreased (-0.674989 --> -0.849989).  Saving model ...
Epoch: 12 cost time: 0.4366586208343506
Epoch: 12, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.007 Vali Acc: 0.875 Test Loss: 1.007 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874990).  Saving model ...
Epoch: 13 cost time: 0.48394012451171875
Epoch: 13, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.961 Vali Acc: 0.800 Test Loss: 0.961 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4247899055480957
Epoch: 14, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.926 Vali Acc: 0.850 Test Loss: 0.926 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.46692776679992676
Epoch: 15, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.883 Vali Acc: 0.850 Test Loss: 0.883 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.43679022789001465
Epoch: 16, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.826 Vali Acc: 0.850 Test Loss: 0.826 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.37622570991516113
Epoch: 17, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.753 Vali Acc: 0.850 Test Loss: 0.753 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.41567492485046387
Epoch: 18, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.44444990158081055
Epoch: 19, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.606 Vali Acc: 0.875 Test Loss: 0.606 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 0.4957854747772217
Epoch: 20, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 0.45148491859436035
Epoch: 21, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.4768102169036865
Epoch: 22, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.44418859481811523
Epoch: 23, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.472888708114624
Epoch: 24, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.497 Vali Acc: 0.800 Test Loss: 0.497 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.44036865234375
Epoch: 25, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.434584379196167
Epoch: 26, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.46367526054382324
Epoch: 27, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4552285671234131
Epoch: 28, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.494 Vali Acc: 0.825 Test Loss: 0.494 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4590904712677002
Epoch: 29, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.44233250617980957
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.464 Vali Acc: 0.825 Test Loss: 0.464 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4424870014190674
Epoch: 31, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4907701015472412
Epoch: 32, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.447 Vali Acc: 0.825 Test Loss: 0.447 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 36493060
model size : 153.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8149974346160889
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5095131397247314
Epoch: 2, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.373 Vali Acc: 0.325 Test Loss: 1.373 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5370409488677979
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.301 Vali Acc: 0.425 Test Loss: 1.301 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.5353021621704102
Epoch: 4, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.4984469413757324
Epoch: 5, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.132 Vali Acc: 0.750 Test Loss: 1.132 Test Acc: 0.750
Validation loss decreased (-0.499988 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 0.45611572265625
Epoch: 6, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.045 Vali Acc: 0.775 Test Loss: 1.045 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 0.5480499267578125
Epoch: 7, Steps: 3 | Train Loss: 0.976 Vali Loss: 0.957 Vali Acc: 0.825 Test Loss: 0.957 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.5452094078063965
Epoch: 8, Steps: 3 | Train Loss: 0.862 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4447333812713623
Epoch: 9, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.810 Vali Acc: 0.675 Test Loss: 0.810 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5889935493469238
Epoch: 10, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.741 Vali Acc: 0.675 Test Loss: 0.741 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.488269567489624
Epoch: 11, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 0.5784108638763428
Epoch: 12, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.5406773090362549
Epoch: 13, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.5186948776245117
Epoch: 14, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.5597200393676758
Epoch: 15, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.5162951946258545
Epoch: 16, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.5342714786529541
Epoch: 17, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.48026418685913086
Epoch: 18, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.5206985473632812
Epoch: 19, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.5460617542266846
Epoch: 20, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5616364479064941
Epoch: 21, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5165965557098389
Epoch: 22, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 0.5760340690612793
Epoch: 23, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 0.47706007957458496
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.4548988342285156
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.4584507942199707
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.46098923683166504
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4323756694793701
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.46318507194519043
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5225732326507568
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.40282320976257324
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.48322415351867676
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5463447570800781
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4423046112060547
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.45000147819519043
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4546854496002197
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36571396
model size : 154.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.606271743774414
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.419 Vali Acc: 0.300 Test Loss: 1.419 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.43724608421325684
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.429 Vali Acc: 0.350 Test Loss: 1.429 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.46359992027282715
Epoch: 3, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.49149155616760254
Epoch: 4, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4252321720123291
Epoch: 5, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.260 Vali Acc: 0.450 Test Loss: 1.260 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.4421355724334717
Epoch: 6, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.5477938652038574
Epoch: 7, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.44409942626953125
Epoch: 8, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.035 Vali Acc: 0.750 Test Loss: 1.035 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.42113733291625977
Epoch: 9, Steps: 3 | Train Loss: 0.961 Vali Loss: 0.960 Vali Acc: 0.825 Test Loss: 0.960 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.44750118255615234
Epoch: 10, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.897 Vali Acc: 0.850 Test Loss: 0.897 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.4647977352142334
Epoch: 11, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.841 Vali Acc: 0.875 Test Loss: 0.841 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.3902299404144287
Epoch: 12, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.788 Vali Acc: 0.875 Test Loss: 0.788 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.47365808486938477
Epoch: 13, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.724 Vali Acc: 0.875 Test Loss: 0.724 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.41940951347351074
Epoch: 14, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.446211576461792
Epoch: 15, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4535825252532959
Epoch: 16, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.43744587898254395
Epoch: 17, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.44330620765686035
Epoch: 18, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.46421003341674805
Epoch: 19, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.4732534885406494
Epoch: 20, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.37715625762939453
Epoch: 21, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.268 Vali Acc: 0.875 Test Loss: 0.268 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.35016775131225586
Epoch: 22, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.36978697776794434
Epoch: 23, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3769831657409668
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.34842586517333984
Epoch: 25, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.35384607315063477
Epoch: 26, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.31574535369873047
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.34407472610473633
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4031832218170166
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.41904664039611816
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 36529924
model size : 154.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.931900978088379
Epoch: 1, Steps: 3 | Train Loss: 1.635 Vali Loss: 1.445 Vali Acc: 0.300 Test Loss: 1.445 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4261202812194824
Epoch: 2, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.408 Vali Acc: 0.250 Test Loss: 1.408 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39424896240234375
Epoch: 3, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38220763206481934
Epoch: 4, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.4731936454772949
Epoch: 5, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.43923020362854004
Epoch: 6, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.41976499557495117
Epoch: 7, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.4742758274078369
Epoch: 8, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.192 Vali Acc: 0.675 Test Loss: 1.192 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.4486699104309082
Epoch: 9, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.129 Vali Acc: 0.750 Test Loss: 1.129 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749989).  Saving model ...
Epoch: 10 cost time: 0.45224666595458984
Epoch: 10, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.065 Vali Acc: 0.775 Test Loss: 1.065 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 11 cost time: 0.4304172992706299
Epoch: 11, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.007 Vali Acc: 0.775 Test Loss: 1.007 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.47903871536254883
Epoch: 12, Steps: 3 | Train Loss: 0.917 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.42173051834106445
Epoch: 13, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.888 Vali Acc: 0.800 Test Loss: 0.888 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.45360660552978516
Epoch: 14, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.821 Vali Acc: 0.800 Test Loss: 0.821 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.4489402770996094
Epoch: 15, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.42777490615844727
Epoch: 16, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 0.4505641460418701
Epoch: 17, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.5035121440887451
Epoch: 18, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 0.4577198028564453
Epoch: 19, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.48774051666259766
Epoch: 20, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.47860288619995117
Epoch: 21, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.49805784225463867
Epoch: 22, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.5428025722503662
Epoch: 23, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.4558126926422119
Epoch: 24, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.48595356941223145
Epoch: 25, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.41771388053894043
Epoch: 26, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.44066810607910156
Epoch: 27, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.41278791427612305
Epoch: 28, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.4348268508911133
Epoch: 29, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4891011714935303
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.4653196334838867
Epoch: 31, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.4708714485168457
Epoch: 32, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.46741771697998047
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.467332124710083
Epoch: 34, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.5257337093353271
Epoch: 35, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4561452865600586
Epoch: 36, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4261474609375
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4101252555847168
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4214189052581787
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.44063901901245117
Epoch: 40, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.44730496406555176
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.45830297470092773
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.458829402923584
Epoch: 43, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.415891170501709
Epoch: 44, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.4194912910461426
Epoch: 45, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36502276
model size : 153.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7928805351257324
Epoch: 1, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.416 Vali Acc: 0.325 Test Loss: 1.416 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.4872012138366699
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.449 Vali Acc: 0.350 Test Loss: 1.449 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.43332815170288086
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.386 Vali Acc: 0.475 Test Loss: 1.386 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.48394083976745605
Epoch: 4, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.295 Vali Acc: 0.525 Test Loss: 1.295 Test Acc: 0.525
Validation loss decreased (-0.474986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.5782248973846436
Epoch: 5, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5023550987243652
Epoch: 6, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.084 Vali Acc: 0.625 Test Loss: 1.084 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.6005649566650391
Epoch: 7, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.5370593070983887
Epoch: 8, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.943 Vali Acc: 0.775 Test Loss: 0.943 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.5363106727600098
Epoch: 9, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5534224510192871
Epoch: 10, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.808 Vali Acc: 0.700 Test Loss: 0.808 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5437002182006836
Epoch: 11, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.759 Vali Acc: 0.775 Test Loss: 0.759 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 0.5160315036773682
Epoch: 12, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 0.46668457984924316
Epoch: 13, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.4691288471221924
Epoch: 14, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.5585556030273438
Epoch: 15, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5311295986175537
Epoch: 16, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 0.5152935981750488
Epoch: 17, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.4905726909637451
Epoch: 18, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.4353621006011963
Epoch: 19, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.49203944206237793
Epoch: 20, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.47388768196105957
Epoch: 21, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.39775943756103516
Epoch: 22, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5006420612335205
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.47151994705200195
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4519193172454834
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3765585422515869
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.41670846939086914
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.5614736080169678
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.5204041004180908
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 30 cost time: 0.4938771724700928
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 31 cost time: 0.5567271709442139
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 32 cost time: 0.5482869148254395
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5183250904083252
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4786672592163086
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5817718505859375
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.48659372329711914
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5750391483306885
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6213786602020264
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.4992237091064453
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6303319931030273
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5414690971374512
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 36599044
model size : 154.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7354605197906494
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.406 Vali Acc: 0.175 Test Loss: 1.406 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.43282008171081543
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.430 Vali Acc: 0.225 Test Loss: 1.430 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.4068727493286133
Epoch: 3, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.405 Vali Acc: 0.200 Test Loss: 1.405 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.44802308082580566
Epoch: 4, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.354 Vali Acc: 0.300 Test Loss: 1.354 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.42307353019714355
Epoch: 5, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.300 Vali Acc: 0.525 Test Loss: 1.300 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.44043517112731934
Epoch: 6, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.227 Vali Acc: 0.475 Test Loss: 1.227 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4066486358642578
Epoch: 7, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.41960954666137695
Epoch: 8, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.097 Vali Acc: 0.550 Test Loss: 1.097 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.5793335437774658
Epoch: 9, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.42308759689331055
Epoch: 10, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.000 Vali Acc: 0.650 Test Loss: 1.000 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.3647751808166504
Epoch: 11, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.4136970043182373
Epoch: 12, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.900 Vali Acc: 0.825 Test Loss: 0.900 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 0.45754194259643555
Epoch: 13, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.49877429008483887
Epoch: 14, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 0.5053181648254395
Epoch: 15, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.46761488914489746
Epoch: 16, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.4491763114929199
Epoch: 17, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.44573545455932617
Epoch: 18, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4895627498626709
Epoch: 19, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.4163074493408203
Epoch: 20, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.42041969299316406
Epoch: 21, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.4320666790008545
Epoch: 22, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.5558888912200928
Epoch: 23, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.559581995010376
Epoch: 24, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 0.4282805919647217
Epoch: 25, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 0.5462322235107422
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.4210991859436035
Epoch: 27, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.3809494972229004
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.41802191734313965
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4237818717956543
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4090726375579834
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4659750461578369
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.461498498916626
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.875 Test Loss: 0.269 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5060644149780273
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.44441747665405273
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 36 cost time: 0.4301424026489258
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.45922088623046875
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.41923069953918457
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3916900157928467
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.4624803066253662
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4527561664581299
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4307866096496582
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.396451473236084
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4532616138458252
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4207313060760498
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.3872513771057129
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.38628315925598145
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36548356
model size : 154.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6658482551574707
Epoch: 1, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.42258572578430176
Epoch: 2, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.374 Vali Acc: 0.275 Test Loss: 1.374 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.42598533630371094
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.354 Vali Acc: 0.325 Test Loss: 1.354 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.4873666763305664
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.330 Vali Acc: 0.375 Test Loss: 1.330 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5264787673950195
Epoch: 5, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.300 Vali Acc: 0.450 Test Loss: 1.300 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.4765150547027588
Epoch: 6, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.269 Vali Acc: 0.575 Test Loss: 1.269 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574987).  Saving model ...
Epoch: 7 cost time: 0.45021581649780273
Epoch: 7, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.232 Vali Acc: 0.600 Test Loss: 1.232 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.4397280216217041
Epoch: 8, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.193 Vali Acc: 0.575 Test Loss: 1.193 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4387836456298828
Epoch: 9, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.143 Vali Acc: 0.675 Test Loss: 1.143 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.4882047176361084
Epoch: 10, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.102 Vali Acc: 0.725 Test Loss: 1.102 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.4589359760284424
Epoch: 11, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.056 Vali Acc: 0.725 Test Loss: 1.056 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.4436371326446533
Epoch: 12, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.005 Vali Acc: 0.675 Test Loss: 1.005 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4369020462036133
Epoch: 13, Steps: 3 | Train Loss: 0.913 Vali Loss: 0.966 Vali Acc: 0.650 Test Loss: 0.966 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.39134812355041504
Epoch: 14, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.926 Vali Acc: 0.575 Test Loss: 0.926 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.36937403678894043
Epoch: 15, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.868 Vali Acc: 0.625 Test Loss: 0.868 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4064362049102783
Epoch: 16, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.810 Vali Acc: 0.675 Test Loss: 0.810 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.36281538009643555
Epoch: 17, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.734 Vali Acc: 0.900 Test Loss: 0.734 Test Acc: 0.900
Validation loss decreased (-0.724989 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.3965580463409424
Epoch: 18, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.666 Vali Acc: 0.875 Test Loss: 0.666 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.43372011184692383
Epoch: 19, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.605 Vali Acc: 0.875 Test Loss: 0.605 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.38338589668273926
Epoch: 20, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.3622598648071289
Epoch: 21, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.4494156837463379
Epoch: 22, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.38217663764953613
Epoch: 23, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.41883039474487305
Epoch: 24, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.40242862701416016
Epoch: 25, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.42931294441223145
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.414 Vali Acc: 0.825 Test Loss: 0.414 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4287397861480713
Epoch: 27, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.440401554107666
Epoch: 28, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.44069910049438477
Epoch: 29, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.40637874603271484
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.3972940444946289
Epoch: 31, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4025592803955078
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 36525316
model size : 154.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9857103824615479
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.413 Vali Acc: 0.275 Test Loss: 1.413 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.4209918975830078
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.350 Vali Acc: 0.425 Test Loss: 1.350 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.4818098545074463
Epoch: 3, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.38149118423461914
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.237 Vali Acc: 0.275 Test Loss: 1.237 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.38596153259277344
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
Validation loss decreased (-0.424986 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.4423508644104004
Epoch: 6, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.123 Vali Acc: 0.775 Test Loss: 1.123 Test Acc: 0.775
Validation loss decreased (-0.649988 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.4861783981323242
Epoch: 7, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.065 Vali Acc: 0.850 Test Loss: 1.065 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849989).  Saving model ...
Epoch: 8 cost time: 0.42934727668762207
Epoch: 8, Steps: 3 | Train Loss: 0.963 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44323110580444336
Epoch: 9, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.915 Vali Acc: 0.725 Test Loss: 0.915 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4170820713043213
Epoch: 10, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.843 Vali Acc: 0.775 Test Loss: 0.843 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5405828952789307
Epoch: 11, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5292155742645264
Epoch: 12, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.48648691177368164
Epoch: 13, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.5117344856262207
Epoch: 14, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.5431489944458008
Epoch: 15, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5266854763031006
Epoch: 16, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.5582225322723389
Epoch: 17, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.546036958694458
Epoch: 18, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.5326681137084961
Epoch: 19, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.46825599670410156
Epoch: 20, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5472896099090576
Epoch: 21, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5333364009857178
Epoch: 22, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.6312987804412842
Epoch: 23, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5103380680084229
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.43416571617126465
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5971434116363525
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.5236866474151611
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4892868995666504
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4547107219696045
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5675950050354004
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4823307991027832
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4867894649505615
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.516289472579956
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.49965906143188477
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.582014799118042
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.4669363498687744
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.5007810592651367
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.5876004695892334
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 1.000 Test Loss: 0.098 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 36603652
model size : 154.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8311553001403809
Epoch: 1, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.509958028793335
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.349 Vali Acc: 0.475 Test Loss: 1.349 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5384104251861572
Epoch: 3, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.4875302314758301
Epoch: 4, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.275 Vali Acc: 0.625 Test Loss: 1.275 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 0.4419429302215576
Epoch: 5, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.227 Vali Acc: 0.625 Test Loss: 1.227 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.4262204170227051
Epoch: 6, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.179 Vali Acc: 0.600 Test Loss: 1.179 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.43177270889282227
Epoch: 7, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.127 Vali Acc: 0.750 Test Loss: 1.127 Test Acc: 0.750
Validation loss decreased (-0.624988 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 0.4687938690185547
Epoch: 8, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.069 Vali Acc: 0.800 Test Loss: 1.069 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.42346715927124023
Epoch: 9, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.018 Vali Acc: 0.825 Test Loss: 1.018 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.3870091438293457
Epoch: 10, Steps: 3 | Train Loss: 0.931 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4306347370147705
Epoch: 11, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.44176363945007324
Epoch: 12, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.847 Vali Acc: 0.825 Test Loss: 0.847 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.4769253730773926
Epoch: 13, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.789 Vali Acc: 0.875 Test Loss: 0.789 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 0.4645650386810303
Epoch: 14, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.4641430377960205
Epoch: 15, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.41304469108581543
Epoch: 16, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.4591503143310547
Epoch: 17, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.42548441886901855
Epoch: 18, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.4660460948944092
Epoch: 19, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.4399445056915283
Epoch: 20, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5583114624023438
Epoch: 21, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4221339225769043
Epoch: 22, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5523009300231934
Epoch: 23, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4693946838378906
Epoch: 24, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.44507408142089844
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.4528381824493408
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4491004943847656
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4706883430480957
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.42312097549438477
Epoch: 29, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.41479015350341797
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5298995971679688
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5137336254119873
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.41910624504089355
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.925 Test Loss: 0.179 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4450802803039551
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4735431671142578
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36571396
model size : 154.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5789401531219482
Epoch: 1, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.3647279739379883
Epoch: 2, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.403 Vali Acc: 0.250 Test Loss: 1.403 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3743283748626709
Epoch: 3, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.388 Vali Acc: 0.300 Test Loss: 1.388 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.3743581771850586
Epoch: 4, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.367 Vali Acc: 0.300 Test Loss: 1.367 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.43161630630493164
Epoch: 5, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.343 Vali Acc: 0.350 Test Loss: 1.343 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.4028964042663574
Epoch: 6, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.313 Vali Acc: 0.375 Test Loss: 1.313 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.40871095657348633
Epoch: 7, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.3978383541107178
Epoch: 8, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.234 Vali Acc: 0.525 Test Loss: 1.234 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4118468761444092
Epoch: 9, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.41489291191101074
Epoch: 10, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.150 Vali Acc: 0.625 Test Loss: 1.150 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.3926968574523926
Epoch: 11, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.38082337379455566
Epoch: 12, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.057 Vali Acc: 0.650 Test Loss: 1.057 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.39867711067199707
Epoch: 13, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.41465306282043457
Epoch: 14, Steps: 3 | Train Loss: 0.898 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.4475717544555664
Epoch: 15, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4610598087310791
Epoch: 16, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.41063952445983887
Epoch: 17, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.4012899398803711
Epoch: 18, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.695 Vali Acc: 0.775 Test Loss: 0.695 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.40073347091674805
Epoch: 19, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 0.44457268714904785
Epoch: 20, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.4428868293762207
Epoch: 21, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.4255545139312744
Epoch: 22, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.4348745346069336
Epoch: 23, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.4234633445739746
Epoch: 24, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.4571967124938965
Epoch: 25, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 0.4076423645019531
Epoch: 26, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.40157222747802734
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.42770814895629883
Epoch: 28, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.38948702812194824
Epoch: 29, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.43921947479248047
Epoch: 30, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.40402913093566895
Epoch: 31, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.377976655960083
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.40145087242126465
Epoch: 33, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.3751413822174072
Epoch: 34, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4233064651489258
Epoch: 35, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.3913078308105469
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.45011258125305176
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.4055819511413574
Epoch: 38, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.4908101558685303
Epoch: 39, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.45256686210632324
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.3787038326263428
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.36135363578796387
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.3896493911743164
Epoch: 43, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.36106252670288086
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.3597586154937744
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.38394880294799805
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.4875757694244385
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.4438591003417969
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.3943195343017578
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36548356
model size : 154.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8192334175109863
Epoch: 1, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.413 Vali Acc: 0.350 Test Loss: 1.413 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5421760082244873
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.396 Vali Acc: 0.375 Test Loss: 1.396 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.4176781177520752
Epoch: 3, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.334 Vali Acc: 0.450 Test Loss: 1.334 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.465667724609375
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.264 Vali Acc: 0.425 Test Loss: 1.264 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5037002563476562
Epoch: 5, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.188 Vali Acc: 0.600 Test Loss: 1.188 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.5196025371551514
Epoch: 6, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.46564602851867676
Epoch: 7, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.47861719131469727
Epoch: 8, Steps: 3 | Train Loss: 0.951 Vali Loss: 0.975 Vali Acc: 0.750 Test Loss: 0.975 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5848925113677979
Epoch: 9, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.45494937896728516
Epoch: 10, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.4827234745025635
Epoch: 11, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.4826533794403076
Epoch: 12, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5560986995697021
Epoch: 13, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.645 Vali Acc: 0.775 Test Loss: 0.645 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5328516960144043
Epoch: 14, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.6005990505218506
Epoch: 15, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5669493675231934
Epoch: 16, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5134854316711426
Epoch: 17, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.4474465847015381
Epoch: 18, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5114984512329102
Epoch: 19, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.5177686214447021
Epoch: 20, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.5791282653808594
Epoch: 21, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.468153715133667
Epoch: 22, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.39759230613708496
Epoch: 23, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 1.000 Test Loss: 0.202 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 36645124
model size : 154.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7248578071594238
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.422 Vali Acc: 0.250 Test Loss: 1.422 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.35858988761901855
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.396 Vali Acc: 0.250 Test Loss: 1.396 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.3818209171295166
Epoch: 3, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.369 Vali Acc: 0.500 Test Loss: 1.369 Test Acc: 0.500
Validation loss decreased (-0.249986 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.38774824142456055
Epoch: 4, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.4405369758605957
Epoch: 5, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.282 Vali Acc: 0.575 Test Loss: 1.282 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.39649200439453125
Epoch: 6, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.4513509273529053
Epoch: 7, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.43640732765197754
Epoch: 8, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.38976216316223145
Epoch: 9, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.022 Vali Acc: 0.625 Test Loss: 1.022 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.3992743492126465
Epoch: 10, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4108912944793701
Epoch: 11, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.904 Vali Acc: 0.650 Test Loss: 0.904 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 0.3993253707885742
Epoch: 12, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.851 Vali Acc: 0.700 Test Loss: 0.851 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.4264347553253174
Epoch: 13, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.799 Vali Acc: 0.700 Test Loss: 0.799 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 14 cost time: 0.3838472366333008
Epoch: 14, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.732 Vali Acc: 0.750 Test Loss: 0.732 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 0.43851661682128906
Epoch: 15, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
Validation loss decreased (-0.749993 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.4038982391357422
Epoch: 16, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.42775845527648926
Epoch: 17, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.44119811058044434
Epoch: 18, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.3999781608581543
Epoch: 19, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.45682263374328613
Epoch: 20, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.3863537311553955
Epoch: 21, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.3850438594818115
Epoch: 22, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.45037269592285156
Epoch: 23, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.41578102111816406
Epoch: 24, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.46073126792907715
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4539158344268799
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.4871339797973633
Epoch: 27, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.3945610523223877
Epoch: 28, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4216794967651367
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.37203145027160645
Epoch: 30, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.3798401355743408
Epoch: 31, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.43303966522216797
Epoch: 32, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.44103217124938965
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.3881065845489502
Epoch: 34, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.4062330722808838
Epoch: 35, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.3796260356903076
Epoch: 36, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.3949549198150635
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.37485599517822266
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 36608260
model size : 154.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7150073051452637
Epoch: 1, Steps: 3 | Train Loss: 1.561 Vali Loss: 1.442 Vali Acc: 0.075 Test Loss: 1.442 Test Acc: 0.075
Validation loss decreased (inf --> -0.074986).  Saving model ...
Epoch: 2 cost time: 0.44550657272338867
Epoch: 2, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.424 Vali Acc: 0.100 Test Loss: 1.424 Test Acc: 0.100
Validation loss decreased (-0.074986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.37859439849853516
Epoch: 3, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.406 Vali Acc: 0.125 Test Loss: 1.406 Test Acc: 0.125
Validation loss decreased (-0.099986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 0.5293700695037842
Epoch: 4, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.381 Vali Acc: 0.225 Test Loss: 1.381 Test Acc: 0.225
Validation loss decreased (-0.124986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.3805732727050781
Epoch: 5, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.352 Vali Acc: 0.300 Test Loss: 1.352 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.407634973526001
Epoch: 6, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.322 Vali Acc: 0.550 Test Loss: 1.322 Test Acc: 0.550
Validation loss decreased (-0.299986 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.3694162368774414
Epoch: 7, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.288 Vali Acc: 0.575 Test Loss: 1.288 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 0.407742977142334
Epoch: 8, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.256 Vali Acc: 0.625 Test Loss: 1.256 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.3785285949707031
Epoch: 9, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.213 Vali Acc: 0.650 Test Loss: 1.213 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.40398192405700684
Epoch: 10, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.170 Vali Acc: 0.650 Test Loss: 1.170 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.43666768074035645
Epoch: 11, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.122 Vali Acc: 0.650 Test Loss: 1.122 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.382479190826416
Epoch: 12, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.447237491607666
Epoch: 13, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.3971881866455078
Epoch: 14, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 0.43812012672424316
Epoch: 15, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.4579172134399414
Epoch: 16, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.807 Vali Acc: 0.725 Test Loss: 0.807 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 17 cost time: 0.43893980979919434
Epoch: 17, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.744 Vali Acc: 0.700 Test Loss: 0.744 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.41890430450439453
Epoch: 18, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774993).  Saving model ...
Epoch: 19 cost time: 0.46619224548339844
Epoch: 19, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.632 Vali Acc: 0.775 Test Loss: 0.632 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 20 cost time: 0.45620226860046387
Epoch: 20, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.774994 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.435161828994751
Epoch: 21, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.44008326530456543
Epoch: 22, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.48995113372802734
Epoch: 23, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.5203309059143066
Epoch: 24, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.4245927333831787
Epoch: 25, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.42792248725891113
Epoch: 26, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.3840024471282959
Epoch: 27, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.41394495964050293
Epoch: 28, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4236414432525635
Epoch: 29, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.40779733657836914
Epoch: 30, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.47037243843078613
Epoch: 31, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4283421039581299
Epoch: 32, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4267144203186035
Epoch: 33, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.39255499839782715
Epoch: 34, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4291234016418457
Epoch: 35, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.45639896392822266
Epoch: 36, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.4357109069824219
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4553554058074951
Epoch: 38, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4044473171234131
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 36589828
model size : 154.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9935495853424072
Epoch: 1, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.383 Vali Acc: 0.300 Test Loss: 1.383 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5267512798309326
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.246 Vali Acc: 0.525 Test Loss: 1.246 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 0.5841579437255859
Epoch: 3, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 0.6239392757415771
Epoch: 4, Steps: 3 | Train Loss: 1.079 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.5922260284423828
Epoch: 5, Steps: 3 | Train Loss: 0.850 Vali Loss: 0.843 Vali Acc: 0.850 Test Loss: 0.843 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 0.6702446937561035
Epoch: 6, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6056327819824219
Epoch: 7, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 0.5464403629302979
Epoch: 8, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5052499771118164
Epoch: 9, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.439 Vali Acc: 0.950 Test Loss: 0.439 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.5688552856445312
Epoch: 10, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6146795749664307
Epoch: 11, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5319948196411133
Epoch: 12, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.5280733108520508
Epoch: 13, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5276041030883789
Epoch: 14, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.49957966804504395
Epoch: 15, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5540719032287598
Epoch: 16, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6009211540222168
Epoch: 17, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5360586643218994
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5704746246337891
Epoch: 19, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7642209529876709
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.685725212097168
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6305856704711914
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29704708
model size : 127.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.980290174484253
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.332 Vali Acc: 0.150 Test Loss: 1.332 Test Acc: 0.150
Validation loss decreased (inf --> -0.149987).  Saving model ...
Epoch: 2 cost time: 0.44436216354370117
Epoch: 2, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.308 Vali Acc: 0.350 Test Loss: 1.308 Test Acc: 0.350
Validation loss decreased (-0.149987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5654346942901611
Epoch: 3, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.210 Vali Acc: 0.600 Test Loss: 1.210 Test Acc: 0.600
Validation loss decreased (-0.349987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.5711290836334229
Epoch: 4, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6641526222229004
Epoch: 5, Steps: 3 | Train Loss: 0.930 Vali Loss: 0.957 Vali Acc: 0.850 Test Loss: 0.957 Test Acc: 0.850
Validation loss decreased (-0.599988 --> -0.849990).  Saving model ...
Epoch: 6 cost time: 0.5087010860443115
Epoch: 6, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.840 Vali Acc: 0.875 Test Loss: 0.840 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.5650224685668945
Epoch: 7, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.808 Vali Acc: 0.675 Test Loss: 0.808 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.558147668838501
Epoch: 8, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.747 Vali Acc: 0.675 Test Loss: 0.747 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.576667308807373
Epoch: 9, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5702261924743652
Epoch: 10, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5049071311950684
Epoch: 11, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 0.5051717758178711
Epoch: 12, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.5303049087524414
Epoch: 13, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.5472939014434814
Epoch: 14, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5012412071228027
Epoch: 15, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.457 Vali Acc: 0.825 Test Loss: 0.457 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5384213924407959
Epoch: 16, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.431 Vali Acc: 0.825 Test Loss: 0.431 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4069693088531494
Epoch: 17, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4178762435913086
Epoch: 18, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.45877575874328613
Epoch: 19, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5342600345611572
Epoch: 20, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.419 Vali Acc: 0.825 Test Loss: 0.419 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4510223865509033
Epoch: 21, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.419 Vali Acc: 0.800 Test Loss: 0.419 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5240612030029297
Epoch: 22, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.44692087173461914
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 29483524
model size : 127.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.861619234085083
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.394 Vali Acc: 0.300 Test Loss: 1.394 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4790964126586914
Epoch: 2, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.339 Vali Acc: 0.350 Test Loss: 1.339 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.3794567584991455
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.263 Vali Acc: 0.475 Test Loss: 1.263 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.36005067825317383
Epoch: 4, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.47879552841186523
Epoch: 5, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.43683481216430664
Epoch: 6, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.022 Vali Acc: 0.525 Test Loss: 1.022 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.43740034103393555
Epoch: 7, Steps: 3 | Train Loss: 0.952 Vali Loss: 0.948 Vali Acc: 0.575 Test Loss: 0.948 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.475538969039917
Epoch: 8, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.866 Vali Acc: 0.775 Test Loss: 0.866 Test Acc: 0.775
Validation loss decreased (-0.599989 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.40920352935791016
Epoch: 9, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.800 Vali Acc: 0.850 Test Loss: 0.800 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.3730287551879883
Epoch: 10, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4057197570800781
Epoch: 11, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4220082759857178
Epoch: 12, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 0.5710256099700928
Epoch: 13, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.44928979873657227
Epoch: 14, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.4695160388946533
Epoch: 15, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4490220546722412
Epoch: 16, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4964625835418701
Epoch: 17, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4578053951263428
Epoch: 18, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.41161656379699707
Epoch: 19, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5317904949188232
Epoch: 20, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.43544793128967285
Epoch: 21, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.48117518424987793
Epoch: 22, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5047826766967773
Epoch: 23, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4982271194458008
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4391472339630127
Epoch: 25, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.46420979499816895
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.45924830436706543
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.46833300590515137
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4674692153930664
Epoch: 29, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5017342567443848
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4800894260406494
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4454357624053955
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.45977282524108887
Epoch: 33, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.38237786293029785
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5790359973907471
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.47492122650146484
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 29372932
model size : 126.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.929804801940918
Epoch: 1, Steps: 3 | Train Loss: 1.581 Vali Loss: 1.416 Vali Acc: 0.225 Test Loss: 1.416 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5824716091156006
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.374 Vali Acc: 0.125 Test Loss: 1.374 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49758219718933105
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (-0.224986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.6384813785552979
Epoch: 4, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.137 Vali Acc: 0.600 Test Loss: 1.137 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.4358828067779541
Epoch: 5, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.034 Vali Acc: 0.550 Test Loss: 1.034 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5592660903930664
Epoch: 6, Steps: 3 | Train Loss: 0.944 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.5018246173858643
Epoch: 7, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 0.5311462879180908
Epoch: 8, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.5960910320281982
Epoch: 9, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5154900550842285
Epoch: 10, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4593167304992676
Epoch: 11, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.589 Vali Acc: 0.725 Test Loss: 0.589 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.44501709938049316
Epoch: 12, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.44048595428466797
Epoch: 13, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.5329527854919434
Epoch: 14, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.45963621139526367
Epoch: 15, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.477466344833374
Epoch: 16, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5285944938659668
Epoch: 17, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5450873374938965
Epoch: 18, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5565221309661865
Epoch: 19, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.675800085067749
Epoch: 20, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5399513244628906
Epoch: 21, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.6221601963043213
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.45849132537841797
Epoch: 23, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.3728353977203369
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.36271119117736816
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.3679795265197754
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.36883020401000977
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.3889200687408447
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.39468860626220703
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6098489761352539
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.567540168762207
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29492740
model size : 127.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5991957187652588
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.313 Vali Acc: 0.275 Test Loss: 1.313 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.34345030784606934
Epoch: 2, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.279 Vali Acc: 0.425 Test Loss: 1.279 Test Acc: 0.425
Validation loss decreased (-0.274987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.5698215961456299
Epoch: 3, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.217 Vali Acc: 0.550 Test Loss: 1.217 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.4589712619781494
Epoch: 4, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.137 Vali Acc: 0.700 Test Loss: 1.137 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.44876790046691895
Epoch: 5, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 0.46356654167175293
Epoch: 6, Steps: 3 | Train Loss: 1.018 Vali Loss: 0.934 Vali Acc: 0.800 Test Loss: 0.934 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.44185733795166016
Epoch: 7, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.46950531005859375
Epoch: 8, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4630551338195801
Epoch: 9, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 0.44238853454589844
Epoch: 10, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.634 Vali Acc: 0.925 Test Loss: 0.634 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.4787571430206299
Epoch: 11, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5105648040771484
Epoch: 12, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5493330955505371
Epoch: 13, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.4580678939819336
Epoch: 14, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.5365860462188721
Epoch: 15, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4932584762573242
Epoch: 16, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.42090368270874023
Epoch: 17, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4028770923614502
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5691189765930176
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.47017502784729004
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.5756728649139404
Epoch: 21, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3747384548187256
Epoch: 22, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4806797504425049
Epoch: 23, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.4029848575592041
Epoch: 24, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4725484848022461
Epoch: 25, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.5063943862915039
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3683650493621826
Epoch: 27, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.41002464294433594
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4683520793914795
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4615442752838135
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.47280001640319824
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.41451311111450195
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.45496344566345215
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4539756774902344
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4257471561431885
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29419012
model size : 126.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7015974521636963
Epoch: 1, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.412 Vali Acc: 0.300 Test Loss: 1.412 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.35884785652160645
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.39424729347229004
Epoch: 3, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.296 Vali Acc: 0.350 Test Loss: 1.296 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.4652533531188965
Epoch: 4, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.36483097076416016
Epoch: 5, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.220 Vali Acc: 0.450 Test Loss: 1.220 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.35975193977355957
Epoch: 6, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.167 Vali Acc: 0.475 Test Loss: 1.167 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.4981071949005127
Epoch: 7, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.095 Vali Acc: 0.550 Test Loss: 1.095 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.435943603515625
Epoch: 8, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.011 Vali Acc: 0.675 Test Loss: 1.011 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.4289107322692871
Epoch: 9, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.38993191719055176
Epoch: 10, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 11 cost time: 0.44442319869995117
Epoch: 11, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.724992 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.45162224769592285
Epoch: 12, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.4510843753814697
Epoch: 13, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 0.44466090202331543
Epoch: 14, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.408829927444458
Epoch: 15, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.572 Vali Acc: 0.800 Test Loss: 0.572 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4374098777770996
Epoch: 16, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.522 Vali Acc: 0.800 Test Loss: 0.522 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4468657970428467
Epoch: 17, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.4744231700897217
Epoch: 18, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.4340646266937256
Epoch: 19, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.39691710472106934
Epoch: 20, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4071009159088135
Epoch: 21, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.39731407165527344
Epoch: 22, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4226267337799072
Epoch: 23, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.4682328701019287
Epoch: 24, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.427048921585083
Epoch: 25, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.345 Vali Acc: 0.825 Test Loss: 0.345 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.44423580169677734
Epoch: 26, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.38428664207458496
Epoch: 27, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.410 Vali Acc: 0.825 Test Loss: 0.410 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.44225049018859863
Epoch: 28, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.391 Vali Acc: 0.825 Test Loss: 0.391 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.46592283248901367
Epoch: 29, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4717741012573242
Epoch: 30, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4650895595550537
Epoch: 31, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.41239047050476074
Epoch: 32, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.42611050605773926
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.385 Vali Acc: 0.800 Test Loss: 0.385 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 29363716
model size : 126.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6954402923583984
Epoch: 1, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5252361297607422
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.408 Vali Acc: 0.300 Test Loss: 1.408 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4515979290008545
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.247 Vali Acc: 0.475 Test Loss: 1.247 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.4768691062927246
Epoch: 4, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.074 Vali Acc: 0.900 Test Loss: 1.074 Test Acc: 0.900
Validation loss decreased (-0.474988 --> -0.899989).  Saving model ...
Epoch: 5 cost time: 0.4400951862335205
Epoch: 5, Steps: 3 | Train Loss: 0.992 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4534296989440918
Epoch: 6, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.834 Vali Acc: 0.825 Test Loss: 0.834 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.46349048614501953
Epoch: 7, Steps: 3 | Train Loss: 0.754 Vali Loss: 0.752 Vali Acc: 0.875 Test Loss: 0.752 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4369697570800781
Epoch: 8, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4987504482269287
Epoch: 9, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.576 Vali Acc: 0.950 Test Loss: 0.576 Test Acc: 0.950
Validation loss decreased (-0.899989 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5009200572967529
Epoch: 10, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.519 Vali Acc: 0.975 Test Loss: 0.519 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.43683910369873047
Epoch: 11, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48695993423461914
Epoch: 12, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.49984145164489746
Epoch: 13, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.300 Vali Acc: 0.975 Test Loss: 0.300 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.4981210231781006
Epoch: 14, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5559635162353516
Epoch: 15, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5144076347351074
Epoch: 16, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5472078323364258
Epoch: 17, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.41955995559692383
Epoch: 18, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5890703201293945
Epoch: 19, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5643105506896973
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5257186889648438
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.45247697830200195
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.43563032150268555
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5475137233734131
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.46423840522766113
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.43444323539733887
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4570467472076416
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4211692810058594
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5240094661712646
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 29506564
model size : 127.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7974061965942383
Epoch: 1, Steps: 3 | Train Loss: 1.505 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5743191242218018
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.354 Vali Acc: 0.350 Test Loss: 1.354 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.6361453533172607
Epoch: 3, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.271 Vali Acc: 0.375 Test Loss: 1.271 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.5669682025909424
Epoch: 4, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
Validation loss decreased (-0.374987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.5714948177337646
Epoch: 5, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.45835065841674805
Epoch: 6, Steps: 3 | Train Loss: 1.047 Vali Loss: 0.989 Vali Acc: 0.625 Test Loss: 0.989 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.541278600692749
Epoch: 7, Steps: 3 | Train Loss: 0.904 Vali Loss: 0.915 Vali Acc: 0.800 Test Loss: 0.915 Test Acc: 0.800
Validation loss decreased (-0.649988 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.532954216003418
Epoch: 8, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.4753735065460205
Epoch: 9, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.5490128993988037
Epoch: 10, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.581831693649292
Epoch: 11, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5447642803192139
Epoch: 12, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.539 Vali Acc: 0.875 Test Loss: 0.539 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.5243027210235596
Epoch: 13, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.5579006671905518
Epoch: 14, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.5630631446838379
Epoch: 15, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4640946388244629
Epoch: 16, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.406 Vali Acc: 0.825 Test Loss: 0.406 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4352452754974365
Epoch: 17, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.472 Vali Acc: 0.825 Test Loss: 0.472 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4449653625488281
Epoch: 18, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6130974292755127
Epoch: 19, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.49060535430908203
Epoch: 20, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5200619697570801
Epoch: 21, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5030093193054199
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4728727340698242
Epoch: 23, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4390871524810791
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5304903984069824
Epoch: 25, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5311708450317383
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5466415882110596
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5914003849029541
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5760321617126465
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.45202159881591797
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.40897536277770996
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29432836
model size : 126.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7588889598846436
Epoch: 1, Steps: 3 | Train Loss: 1.517 Vali Loss: 1.305 Vali Acc: 0.200 Test Loss: 1.305 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5163004398345947
Epoch: 2, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.316 Vali Acc: 0.475 Test Loss: 1.316 Test Acc: 0.475
Validation loss decreased (-0.199987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.4560573101043701
Epoch: 3, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.5233590602874756
Epoch: 4, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.402130126953125
Epoch: 5, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.169 Vali Acc: 0.550 Test Loss: 1.169 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.6050889492034912
Epoch: 6, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.42029476165771484
Epoch: 7, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.015 Vali Acc: 0.675 Test Loss: 1.015 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.5103638172149658
Epoch: 8, Steps: 3 | Train Loss: 0.940 Vali Loss: 0.934 Vali Acc: 0.775 Test Loss: 0.934 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.4299638271331787
Epoch: 9, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.5652987957000732
Epoch: 10, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 0.4444568157196045
Epoch: 11, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 0.5141160488128662
Epoch: 12, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.713 Vali Acc: 0.775 Test Loss: 0.713 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 0.47196102142333984
Epoch: 13, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.639 Vali Acc: 0.825 Test Loss: 0.639 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.48505377769470215
Epoch: 14, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.569 Vali Acc: 0.900 Test Loss: 0.569 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.47880005836486816
Epoch: 15, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.45980119705200195
Epoch: 16, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.4671924114227295
Epoch: 17, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.41787195205688477
Epoch: 18, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.45643186569213867
Epoch: 19, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.39661717414855957
Epoch: 20, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4112362861633301
Epoch: 21, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5159416198730469
Epoch: 22, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.4822046756744385
Epoch: 23, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.4242668151855469
Epoch: 24, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5489344596862793
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.512824535369873
Epoch: 26, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6007943153381348
Epoch: 27, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.41494297981262207
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5924005508422852
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.875 Test Loss: 0.243 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5936110019683838
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5093405246734619
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.46535229682922363
Epoch: 32, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.40982747077941895
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.47922825813293457
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.925 Test Loss: 0.180 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4745182991027832
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29359108
model size : 126.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7113146781921387
Epoch: 1, Steps: 3 | Train Loss: 1.533 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4823472499847412
Epoch: 2, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.378 Vali Acc: 0.300 Test Loss: 1.378 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5528805255889893
Epoch: 3, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.244 Vali Acc: 0.525 Test Loss: 1.244 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.39675426483154297
Epoch: 4, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.102 Vali Acc: 0.775 Test Loss: 1.102 Test Acc: 0.775
Validation loss decreased (-0.524988 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 0.46596288681030273
Epoch: 5, Steps: 3 | Train Loss: 1.082 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.46126580238342285
Epoch: 6, Steps: 3 | Train Loss: 0.899 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4859964847564697
Epoch: 7, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.834 Vali Acc: 0.825 Test Loss: 0.834 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.4837968349456787
Epoch: 8, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.46581578254699707
Epoch: 9, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5105969905853271
Epoch: 10, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.4551692008972168
Epoch: 11, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.564 Vali Acc: 0.900 Test Loss: 0.564 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.4888145923614502
Epoch: 12, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.499 Vali Acc: 0.950 Test Loss: 0.499 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.48697423934936523
Epoch: 13, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.48636317253112793
Epoch: 14, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.4049556255340576
Epoch: 15, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5957322120666504
Epoch: 16, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.40402674674987793
Epoch: 17, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5250809192657471
Epoch: 18, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5361182689666748
Epoch: 19, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.531005859375
Epoch: 20, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4833090305328369
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.47632479667663574
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.485929012298584
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4537832736968994
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5477402210235596
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.49724555015563965
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.46738743782043457
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4468977451324463
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.43073201179504395
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4198112487792969
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5344202518463135
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4029541015625
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29515780
model size : 127.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7253727912902832
Epoch: 1, Steps: 3 | Train Loss: 1.579 Vali Loss: 1.382 Vali Acc: 0.300 Test Loss: 1.382 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.42197299003601074
Epoch: 2, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.358675479888916
Epoch: 3, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.308 Vali Acc: 0.375 Test Loss: 1.308 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.4276440143585205
Epoch: 4, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.212 Vali Acc: 0.550 Test Loss: 1.212 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.4298436641693115
Epoch: 5, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.39088892936706543
Epoch: 6, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.014 Vali Acc: 0.775 Test Loss: 1.014 Test Acc: 0.775
Validation loss decreased (-0.549989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 0.444091796875
Epoch: 7, Steps: 3 | Train Loss: 0.962 Vali Loss: 0.933 Vali Acc: 0.650 Test Loss: 0.933 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.43526196479797363
Epoch: 8, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.859 Vali Acc: 0.850 Test Loss: 0.859 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.4672255516052246
Epoch: 9, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.45044875144958496
Epoch: 10, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.785 Vali Acc: 0.725 Test Loss: 0.785 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46843934059143066
Epoch: 11, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.720 Vali Acc: 0.775 Test Loss: 0.720 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4170553684234619
Epoch: 12, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.618 Vali Acc: 0.900 Test Loss: 0.618 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.44797372817993164
Epoch: 13, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.4138493537902832
Epoch: 14, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5230886936187744
Epoch: 15, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.5519447326660156
Epoch: 16, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.566831111907959
Epoch: 17, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4670436382293701
Epoch: 18, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.49454331398010254
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5542066097259521
Epoch: 20, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.4732792377471924
Epoch: 21, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.46020030975341797
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5580453872680664
Epoch: 23, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4954531192779541
Epoch: 24, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4319112300872803
Epoch: 25, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.39841294288635254
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3869509696960449
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.39177775382995605
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5111954212188721
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.48497605323791504
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 29409796
model size : 126.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7473084926605225
Epoch: 1, Steps: 3 | Train Loss: 1.566 Vali Loss: 1.384 Vali Acc: 0.175 Test Loss: 1.384 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.3835608959197998
Epoch: 2, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
Validation loss decreased (-0.174986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.44403648376464844
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.4239163398742676
Epoch: 4, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.46677684783935547
Epoch: 5, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.4231843948364258
Epoch: 6, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.169 Vali Acc: 0.675 Test Loss: 1.169 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.43389081954956055
Epoch: 7, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.4305918216705322
Epoch: 8, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4297771453857422
Epoch: 9, Steps: 3 | Train Loss: 0.969 Vali Loss: 0.976 Vali Acc: 0.800 Test Loss: 0.976 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.4228205680847168
Epoch: 10, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.912 Vali Acc: 0.850 Test Loss: 0.912 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.4487447738647461
Epoch: 11, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.842 Vali Acc: 0.825 Test Loss: 0.842 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.43024206161499023
Epoch: 12, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.45563197135925293
Epoch: 13, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.730 Vali Acc: 0.750 Test Loss: 0.730 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.44611668586730957
Epoch: 14, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4830453395843506
Epoch: 15, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.615 Vali Acc: 0.875 Test Loss: 0.615 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.41213154792785645
Epoch: 16, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.42738771438598633
Epoch: 17, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4742105007171631
Epoch: 18, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4453902244567871
Epoch: 19, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.3906989097595215
Epoch: 20, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4869351387023926
Epoch: 21, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.3956029415130615
Epoch: 22, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.415147066116333
Epoch: 23, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.427600622177124
Epoch: 24, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.4425168037414551
Epoch: 25, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.421 Vali Acc: 0.825 Test Loss: 0.421 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.45508313179016113
Epoch: 26, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.485 Vali Acc: 0.800 Test Loss: 0.485 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.43894147872924805
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.428 Vali Acc: 0.825 Test Loss: 0.428 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.40217018127441406
Epoch: 28, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.40210890769958496
Epoch: 29, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.43665289878845215
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.44866371154785156
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.4801630973815918
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.44217801094055176
Epoch: 33, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.49584197998046875
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 29363716
model size : 126.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9529495239257812
Epoch: 1, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.452 Vali Acc: 0.400 Test Loss: 1.452 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 0.4555797576904297
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4986610412597656
Epoch: 3, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.399985 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.4884343147277832
Epoch: 4, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.499987 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.5741622447967529
Epoch: 5, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.047 Vali Acc: 0.625 Test Loss: 1.047 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.444183349609375
Epoch: 6, Steps: 3 | Train Loss: 0.932 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.49124670028686523
Epoch: 7, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.848 Vali Acc: 0.875 Test Loss: 0.848 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.45418500900268555
Epoch: 8, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3554244041442871
Epoch: 9, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.44127511978149414
Epoch: 10, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.593 Vali Acc: 0.925 Test Loss: 0.593 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.4812028408050537
Epoch: 11, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4029233455657959
Epoch: 12, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.4857313632965088
Epoch: 13, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.455 Vali Acc: 0.950 Test Loss: 0.455 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.39782094955444336
Epoch: 14, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.37098026275634766
Epoch: 15, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.4084904193878174
Epoch: 16, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.637188196182251
Epoch: 17, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.4632914066314697
Epoch: 18, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.47758054733276367
Epoch: 19, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4698190689086914
Epoch: 20, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.43004488945007324
Epoch: 21, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.48032212257385254
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.4356989860534668
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.49884486198425293
Epoch: 24, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5351121425628662
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4802858829498291
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.47193169593811035
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.45125269889831543
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5721189975738525
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.45168423652648926
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4224696159362793
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.441333532333374
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29529604
model size : 127.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8960812091827393
Epoch: 1, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.425 Vali Acc: 0.400 Test Loss: 1.425 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.45949316024780273
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.401 Vali Acc: 0.325 Test Loss: 1.401 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43891406059265137
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.40425968170166016
Epoch: 4, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.3980076313018799
Epoch: 5, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.45946502685546875
Epoch: 6, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.057 Vali Acc: 0.625 Test Loss: 1.057 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.4577455520629883
Epoch: 7, Steps: 3 | Train Loss: 0.926 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.4210011959075928
Epoch: 8, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.897 Vali Acc: 0.800 Test Loss: 0.897 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.41695594787597656
Epoch: 9, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.4785788059234619
Epoch: 10, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.39623284339904785
Epoch: 11, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.4482131004333496
Epoch: 12, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.4573705196380615
Epoch: 13, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.46520256996154785
Epoch: 14, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.499 Vali Acc: 0.950 Test Loss: 0.499 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.3958740234375
Epoch: 15, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5186135768890381
Epoch: 16, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.433 Vali Acc: 0.975 Test Loss: 0.433 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.5072565078735352
Epoch: 17, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5732593536376953
Epoch: 18, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5425465106964111
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5113701820373535
Epoch: 20, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5120961666107178
Epoch: 21, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5262267589569092
Epoch: 22, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5025687217712402
Epoch: 23, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4848790168762207
Epoch: 24, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5909757614135742
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5949380397796631
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 29423620
model size : 126.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9543042182922363
Epoch: 1, Steps: 3 | Train Loss: 1.546 Vali Loss: 1.463 Vali Acc: 0.175 Test Loss: 1.463 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.5864584445953369
Epoch: 2, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.445 Vali Acc: 0.175 Test Loss: 1.445 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.611194372177124
Epoch: 3, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.408 Vali Acc: 0.350 Test Loss: 1.408 Test Acc: 0.350
Validation loss decreased (-0.174986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.510507345199585
Epoch: 4, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.363 Vali Acc: 0.350 Test Loss: 1.363 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.5530529022216797
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.5385205745697021
Epoch: 6, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4037621021270752
Epoch: 7, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
Validation loss decreased (-0.399988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.4866292476654053
Epoch: 8, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.145 Vali Acc: 0.675 Test Loss: 1.145 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 0.550055980682373
Epoch: 9, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.089 Vali Acc: 0.675 Test Loss: 1.089 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.5912690162658691
Epoch: 10, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 0.5565848350524902
Epoch: 11, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.986 Vali Acc: 0.700 Test Loss: 0.986 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.5851099491119385
Epoch: 12, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.425828218460083
Epoch: 13, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.915 Vali Acc: 0.700 Test Loss: 0.915 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.6558163166046143
Epoch: 14, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.5868833065032959
Epoch: 15, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 16 cost time: 0.5859334468841553
Epoch: 16, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 0.6608736515045166
Epoch: 17, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774994).  Saving model ...
Epoch: 18 cost time: 0.6363587379455566
Epoch: 18, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6187686920166016
Epoch: 19, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.546 Vali Acc: 0.750 Test Loss: 0.546 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6095857620239258
Epoch: 20, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.486 Vali Acc: 0.825 Test Loss: 0.486 Test Acc: 0.825
Validation loss decreased (-0.774994 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 0.6648392677307129
Epoch: 21, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.466 Vali Acc: 0.825 Test Loss: 0.466 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.585655927658081
Epoch: 22, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.495 Vali Acc: 0.800 Test Loss: 0.495 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5934607982635498
Epoch: 23, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5697216987609863
Epoch: 24, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5486202239990234
Epoch: 25, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.531 Vali Acc: 0.775 Test Loss: 0.531 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6495256423950195
Epoch: 26, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.438 Vali Acc: 0.825 Test Loss: 0.438 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 27 cost time: 0.6254987716674805
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.629220724105835
Epoch: 28, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5517592430114746
Epoch: 29, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.491 Vali Acc: 0.800 Test Loss: 0.491 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5158767700195312
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5939850807189941
Epoch: 31, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5436301231384277
Epoch: 32, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.824996 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 0.56003737449646
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.457 Vali Acc: 0.825 Test Loss: 0.457 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5141239166259766
Epoch: 34, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.442 Vali Acc: 0.825 Test Loss: 0.442 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5638222694396973
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.825 Test Loss: 0.440 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5033016204833984
Epoch: 36, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.428 Vali Acc: 0.825 Test Loss: 0.428 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.608771562576294
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.433 Vali Acc: 0.825 Test Loss: 0.433 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4971797466278076
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.438 Vali Acc: 0.825 Test Loss: 0.438 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5234622955322266
Epoch: 39, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.825 Test Loss: 0.443 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5343544483184814
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.825 Test Loss: 0.452 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.493755578994751
Epoch: 41, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.454 Vali Acc: 0.825 Test Loss: 0.454 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5732426643371582
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.825 Test Loss: 0.459 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 29368324
model size : 126.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0178780555725098
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.378 Vali Acc: 0.300 Test Loss: 1.378 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5008583068847656
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.6413388252258301
Epoch: 3, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5741705894470215
Epoch: 4, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.171 Vali Acc: 0.475 Test Loss: 1.171 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.599553108215332
Epoch: 5, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.096 Vali Acc: 0.550 Test Loss: 1.096 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.6117959022521973
Epoch: 6, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
Validation loss decreased (-0.549989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.5851850509643555
Epoch: 7, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6299030780792236
Epoch: 8, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.839 Vali Acc: 0.775 Test Loss: 0.839 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 0.6635377407073975
Epoch: 9, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.789 Vali Acc: 0.800 Test Loss: 0.789 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.5150773525238037
Epoch: 10, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45304369926452637
Epoch: 11, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 0.5087070465087891
Epoch: 12, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.567 Vali Acc: 0.925 Test Loss: 0.567 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.5798382759094238
Epoch: 13, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.5301473140716553
Epoch: 14, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5603654384613037
Epoch: 15, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6243860721588135
Epoch: 16, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5751457214355469
Epoch: 17, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5123980045318604
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.586723804473877
Epoch: 19, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6164581775665283
Epoch: 20, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5997614860534668
Epoch: 21, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4840271472930908
Epoch: 22, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5586457252502441
Epoch: 23, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.6108283996582031
Epoch: 24, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5897853374481201
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5379509925842285
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.533501386642456
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4662930965423584
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5091347694396973
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.49503278732299805
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5673449039459229
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6385085582733154
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6191527843475342
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.5657808780670166
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.6174967288970947
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.5796017646789551
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5895626544952393
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5974764823913574
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5248186588287354
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.4387247562408447
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.6139216423034668
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.5401849746704102
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.5498075485229492
Epoch: 43, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5201025009155273
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4810640811920166
Epoch: 45, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.478191614151001
Epoch: 46, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6298220157623291
Epoch: 47, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6334195137023926
Epoch: 48, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.4685699939727783
Epoch: 49, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5575823783874512
Epoch: 50, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 29469700
model size : 127.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0052168369293213
Epoch: 1, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.376 Vali Acc: 0.250 Test Loss: 1.376 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5131802558898926
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
Validation loss decreased (-0.249986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.5620651245117188
Epoch: 3, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.208 Vali Acc: 0.525 Test Loss: 1.208 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.5038208961486816
Epoch: 4, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5329558849334717
Epoch: 5, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.070 Vali Acc: 0.725 Test Loss: 1.070 Test Acc: 0.725
Validation loss decreased (-0.524988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 0.5850367546081543
Epoch: 6, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.006 Vali Acc: 0.725 Test Loss: 1.006 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.5460922718048096
Epoch: 7, Steps: 3 | Train Loss: 0.919 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 0.5763289928436279
Epoch: 8, Steps: 3 | Train Loss: 0.863 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.562406063079834
Epoch: 9, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.797 Vali Acc: 0.900 Test Loss: 0.797 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.4767909049987793
Epoch: 10, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.5159316062927246
Epoch: 11, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.659 Vali Acc: 0.925 Test Loss: 0.659 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.572929859161377
Epoch: 12, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5072824954986572
Epoch: 13, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5776095390319824
Epoch: 14, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5294055938720703
Epoch: 15, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.471 Vali Acc: 0.925 Test Loss: 0.471 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5472981929779053
Epoch: 16, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.47112250328063965
Epoch: 17, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.49608302116394043
Epoch: 18, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.49182844161987305
Epoch: 19, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5048577785491943
Epoch: 20, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5144383907318115
Epoch: 21, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.48814988136291504
Epoch: 22, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5113058090209961
Epoch: 23, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5304393768310547
Epoch: 24, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.471904993057251
Epoch: 25, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4511563777923584
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4898958206176758
Epoch: 27, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.42297863960266113
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29414404
model size : 126.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.938749074935913
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.324 Vali Acc: 0.475 Test Loss: 1.324 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.45456814765930176
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.301 Vali Acc: 0.525 Test Loss: 1.301 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.5275177955627441
Epoch: 3, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.259 Vali Acc: 0.550 Test Loss: 1.259 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.45650196075439453
Epoch: 4, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.207 Vali Acc: 0.675 Test Loss: 1.207 Test Acc: 0.675
Validation loss decreased (-0.549987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 0.4382791519165039
Epoch: 5, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.46685123443603516
Epoch: 6, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4340519905090332
Epoch: 7, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.4581882953643799
Epoch: 8, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.016 Vali Acc: 0.750 Test Loss: 1.016 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.42548584938049316
Epoch: 9, Steps: 3 | Train Loss: 0.973 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.47695064544677734
Epoch: 10, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 0.5100126266479492
Epoch: 11, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.843 Vali Acc: 0.850 Test Loss: 0.843 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.4521021842956543
Epoch: 12, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.505326509475708
Epoch: 13, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.5068647861480713
Epoch: 14, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.47050976753234863
Epoch: 15, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.656 Vali Acc: 0.825 Test Loss: 0.656 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5115044116973877
Epoch: 16, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.596 Vali Acc: 0.925 Test Loss: 0.596 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 0.5352299213409424
Epoch: 17, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4960014820098877
Epoch: 18, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.527479887008667
Epoch: 19, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4646284580230713
Epoch: 20, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5140042304992676
Epoch: 21, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5588276386260986
Epoch: 22, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5176587104797363
Epoch: 23, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5270187854766846
Epoch: 24, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4997577667236328
Epoch: 25, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.51127028465271
Epoch: 26, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 29377540
model size : 126.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2405898571014404
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.400 Vali Acc: 0.250 Test Loss: 1.400 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5899465084075928
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.546621561050415
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.5991168022155762
Epoch: 4, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.201 Vali Acc: 0.550 Test Loss: 1.201 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.544562816619873
Epoch: 5, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.117 Vali Acc: 0.525 Test Loss: 1.117 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5255515575408936
Epoch: 6, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.5116634368896484
Epoch: 7, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
Validation loss decreased (-0.549989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.5406308174133301
Epoch: 8, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 0.5470671653747559
Epoch: 9, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5684840679168701
Epoch: 10, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.719 Vali Acc: 0.675 Test Loss: 0.719 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5325706005096436
Epoch: 11, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799994).  Saving model ...
Epoch: 12 cost time: 0.5441431999206543
Epoch: 12, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
Validation loss decreased (-0.799994 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.6906642913818359
Epoch: 13, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.6739292144775391
Epoch: 14, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6382589340209961
Epoch: 15, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6518809795379639
Epoch: 16, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.7118792533874512
Epoch: 17, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.6456916332244873
Epoch: 18, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5366389751434326
Epoch: 19, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5738124847412109
Epoch: 20, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4942443370819092
Epoch: 21, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5953764915466309
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8004906177520752
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7077720165252686
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.670783519744873
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5742347240447998
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5491695404052734
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5595345497131348
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29483524
model size : 127.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.23171067237854
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.441 Vali Acc: 0.125 Test Loss: 1.441 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.5712192058563232
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.407 Vali Acc: 0.275 Test Loss: 1.407 Test Acc: 0.275
Validation loss decreased (-0.124986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.7417185306549072
Epoch: 3, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.6484878063201904
Epoch: 4, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.250 Vali Acc: 0.475 Test Loss: 1.250 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.6013236045837402
Epoch: 5, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.179 Vali Acc: 0.675 Test Loss: 1.179 Test Acc: 0.675
Validation loss decreased (-0.474987 --> -0.674988).  Saving model ...
Epoch: 6 cost time: 0.6653718948364258
Epoch: 6, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.116 Vali Acc: 0.700 Test Loss: 1.116 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.541860818862915
Epoch: 7, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.063 Vali Acc: 0.725 Test Loss: 1.063 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 8 cost time: 0.6422877311706543
Epoch: 8, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.993 Vali Acc: 0.800 Test Loss: 0.993 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.6135585308074951
Epoch: 9, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6509685516357422
Epoch: 10, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.6811697483062744
Epoch: 11, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.637202262878418
Epoch: 12, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.715 Vali Acc: 0.875 Test Loss: 0.715 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.663386344909668
Epoch: 13, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6939296722412109
Epoch: 14, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6577367782592773
Epoch: 15, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7194051742553711
Epoch: 16, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.7001349925994873
Epoch: 17, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6779394149780273
Epoch: 18, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6703779697418213
Epoch: 19, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7053737640380859
Epoch: 20, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.429 Vali Acc: 0.825 Test Loss: 0.429 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6328020095825195
Epoch: 21, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6608977317810059
Epoch: 22, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.398 Vali Acc: 0.825 Test Loss: 0.398 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7180335521697998
Epoch: 23, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.414 Vali Acc: 0.825 Test Loss: 0.414 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.62544846534729
Epoch: 24, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.472 Vali Acc: 0.825 Test Loss: 0.472 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5965046882629395
Epoch: 25, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6945607662200928
Epoch: 26, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 29428228
model size : 126.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1434755325317383
Epoch: 1, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.482 Vali Acc: 0.275 Test Loss: 1.482 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.4788956642150879
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5224831104278564
Epoch: 3, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.385 Vali Acc: 0.350 Test Loss: 1.385 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5421319007873535
Epoch: 4, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.338 Vali Acc: 0.375 Test Loss: 1.338 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5362834930419922
Epoch: 5, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.294 Vali Acc: 0.350 Test Loss: 1.294 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5076053142547607
Epoch: 6, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.253 Vali Acc: 0.450 Test Loss: 1.253 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.5688052177429199
Epoch: 7, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.214 Vali Acc: 0.450 Test Loss: 1.214 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.5406270027160645
Epoch: 8, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.173 Vali Acc: 0.475 Test Loss: 1.173 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.4968132972717285
Epoch: 9, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.119 Vali Acc: 0.450 Test Loss: 1.119 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.558269739151001
Epoch: 10, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.058 Vali Acc: 0.675 Test Loss: 1.058 Test Acc: 0.675
Validation loss decreased (-0.474988 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.5352604389190674
Epoch: 11, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.5113420486450195
Epoch: 12, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.4715421199798584
Epoch: 13, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.4804542064666748
Epoch: 14, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.840 Vali Acc: 0.750 Test Loss: 0.840 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.4639313220977783
Epoch: 15, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.806 Vali Acc: 0.650 Test Loss: 0.806 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4508335590362549
Epoch: 16, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.773 Vali Acc: 0.725 Test Loss: 0.773 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.426832914352417
Epoch: 17, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.722 Vali Acc: 0.775 Test Loss: 0.722 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 18 cost time: 0.5543780326843262
Epoch: 18, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.48621559143066406
Epoch: 19, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.5231626033782959
Epoch: 20, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.45416736602783203
Epoch: 21, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5093896389007568
Epoch: 22, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.4709508419036865
Epoch: 23, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 24 cost time: 0.5392067432403564
Epoch: 24, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.4489107131958008
Epoch: 25, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 0.44774675369262695
Epoch: 26, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.43974781036376953
Epoch: 27, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.40444517135620117
Epoch: 28, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.383 Vali Acc: 0.825 Test Loss: 0.383 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4288008213043213
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.418 Vali Acc: 0.825 Test Loss: 0.418 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.3809220790863037
Epoch: 30, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.433 Vali Acc: 0.800 Test Loss: 0.433 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4423706531524658
Epoch: 31, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.417 Vali Acc: 0.825 Test Loss: 0.417 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4933962821960449
Epoch: 32, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4807004928588867
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 34 cost time: 0.4837303161621094
Epoch: 34, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.5124971866607666
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 0.4675734043121338
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5169095993041992
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.45672035217285156
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4525432586669922
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.49509739875793457
Epoch: 40, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5297441482543945
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.46614861488342285
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5237693786621094
Epoch: 43, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5258758068084717
Epoch: 44, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5112824440002441
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 29386756
model size : 126.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0180795192718506
Epoch: 1, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.5813791751861572
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.311 Vali Acc: 0.225 Test Loss: 1.311 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48883724212646484
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.238 Vali Acc: 0.525 Test Loss: 1.238 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.5672647953033447
Epoch: 4, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.169 Vali Acc: 0.600 Test Loss: 1.169 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.5497984886169434
Epoch: 5, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5113792419433594
Epoch: 6, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.45022010803222656
Epoch: 7, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.921 Vali Acc: 0.875 Test Loss: 0.921 Test Acc: 0.875
Validation loss decreased (-0.599988 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 0.4745674133300781
Epoch: 8, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.833 Vali Acc: 0.825 Test Loss: 0.833 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4648616313934326
Epoch: 9, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5209226608276367
Epoch: 10, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5471816062927246
Epoch: 11, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.584 Vali Acc: 0.900 Test Loss: 0.584 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.5421066284179688
Epoch: 12, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.540 Vali Acc: 0.950 Test Loss: 0.540 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.5144579410552979
Epoch: 13, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47631072998046875
Epoch: 14, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.49379682540893555
Epoch: 15, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.48036670684814453
Epoch: 16, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.42457103729248047
Epoch: 17, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5839228630065918
Epoch: 18, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5971560478210449
Epoch: 19, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5864887237548828
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5100889205932617
Epoch: 21, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5266296863555908
Epoch: 22, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.528616189956665
Epoch: 23, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.43778562545776367
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4837203025817871
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5332431793212891
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5366992950439453
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4682793617248535
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4396796226501465
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.46689438819885254
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5466022491455078
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5776934623718262
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29506564
model size : 127.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.845259666442871
Epoch: 1, Steps: 3 | Train Loss: 1.609 Vali Loss: 1.562 Vali Acc: 0.375 Test Loss: 1.562 Test Acc: 0.375
Validation loss decreased (inf --> -0.374984).  Saving model ...
Epoch: 2 cost time: 0.4035372734069824
Epoch: 2, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.444 Vali Acc: 0.250 Test Loss: 1.444 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45557236671447754
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.383 Vali Acc: 0.325 Test Loss: 1.383 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.390761137008667
Epoch: 4, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
Validation loss decreased (-0.374984 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.4938178062438965
Epoch: 5, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.254 Vali Acc: 0.425 Test Loss: 1.254 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.4971456527709961
Epoch: 6, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.198 Vali Acc: 0.450 Test Loss: 1.198 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.45183658599853516
Epoch: 7, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.142 Vali Acc: 0.725 Test Loss: 1.142 Test Acc: 0.725
Validation loss decreased (-0.449988 --> -0.724989).  Saving model ...
Epoch: 8 cost time: 0.4372520446777344
Epoch: 8, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.41700243949890137
Epoch: 9, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4100918769836426
Epoch: 10, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4090077877044678
Epoch: 11, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.894 Vali Acc: 0.825 Test Loss: 0.894 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.6137130260467529
Epoch: 12, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.845 Vali Acc: 0.800 Test Loss: 0.845 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5152909755706787
Epoch: 13, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 0.4971938133239746
Epoch: 14, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.49265313148498535
Epoch: 15, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.47745275497436523
Epoch: 16, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.5340702533721924
Epoch: 17, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.5095291137695312
Epoch: 18, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.849995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.4191555976867676
Epoch: 19, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4579274654388428
Epoch: 20, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.437 Vali Acc: 0.825 Test Loss: 0.437 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5208332538604736
Epoch: 21, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5271570682525635
Epoch: 22, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.46503233909606934
Epoch: 23, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.43604421615600586
Epoch: 24, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4522559642791748
Epoch: 25, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.44696831703186035
Epoch: 26, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5166544914245605
Epoch: 27, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5511314868927002
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 29437444
model size : 126.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.826653242111206
Epoch: 1, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.438 Vali Acc: 0.300 Test Loss: 1.438 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4289379119873047
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.426 Vali Acc: 0.225 Test Loss: 1.426 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4403965473175049
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.396 Vali Acc: 0.275 Test Loss: 1.396 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4371654987335205
Epoch: 4, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.361 Vali Acc: 0.300 Test Loss: 1.361 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.4626469612121582
Epoch: 5, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.319 Vali Acc: 0.350 Test Loss: 1.319 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.5095090866088867
Epoch: 6, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.271 Vali Acc: 0.475 Test Loss: 1.271 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.5236444473266602
Epoch: 7, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.231 Vali Acc: 0.550 Test Loss: 1.231 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.4489433765411377
Epoch: 8, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.194 Vali Acc: 0.550 Test Loss: 1.194 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.4704093933105469
Epoch: 9, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.5368773937225342
Epoch: 10, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.5223519802093506
Epoch: 11, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.048 Vali Acc: 0.825 Test Loss: 1.048 Test Acc: 0.825
Validation loss decreased (-0.599989 --> -0.824990).  Saving model ...
Epoch: 12 cost time: 0.5547585487365723
Epoch: 12, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.000 Vali Acc: 0.875 Test Loss: 1.000 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874990).  Saving model ...
Epoch: 13 cost time: 0.41095805168151855
Epoch: 13, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.955 Vali Acc: 0.850 Test Loss: 0.955 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.48934340476989746
Epoch: 14, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.917 Vali Acc: 0.850 Test Loss: 0.917 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.42833542823791504
Epoch: 15, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.876 Vali Acc: 0.825 Test Loss: 0.876 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4424302577972412
Epoch: 16, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.825 Vali Acc: 0.850 Test Loss: 0.825 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.40544629096984863
Epoch: 17, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5092058181762695
Epoch: 18, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.697 Vali Acc: 0.875 Test Loss: 0.697 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.4687354564666748
Epoch: 19, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4948709011077881
Epoch: 20, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4884665012359619
Epoch: 21, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.44645142555236816
Epoch: 22, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.45180177688598633
Epoch: 23, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.451 Vali Acc: 0.825 Test Loss: 0.451 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.481273889541626
Epoch: 24, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5090627670288086
Epoch: 25, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.492 Vali Acc: 0.800 Test Loss: 0.492 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4942634105682373
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.483 Vali Acc: 0.825 Test Loss: 0.483 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.46584153175354004
Epoch: 27, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.47808408737182617
Epoch: 28, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.490 Vali Acc: 0.800 Test Loss: 0.490 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 29405188
model size : 126.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.108828544616699
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.375 Vali Acc: 0.450 Test Loss: 1.375 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.48508524894714355
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.369 Vali Acc: 0.325 Test Loss: 1.369 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43350911140441895
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.294 Vali Acc: 0.475 Test Loss: 1.294 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.5024092197418213
Epoch: 4, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5763592720031738
Epoch: 5, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.117 Vali Acc: 0.675 Test Loss: 1.117 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.44702744483947754
Epoch: 6, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.027 Vali Acc: 0.725 Test Loss: 1.027 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.6863479614257812
Epoch: 7, Steps: 3 | Train Loss: 0.974 Vali Loss: 0.940 Vali Acc: 0.800 Test Loss: 0.940 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.6155710220336914
Epoch: 8, Steps: 3 | Train Loss: 0.901 Vali Loss: 0.865 Vali Acc: 0.800 Test Loss: 0.865 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.5475780963897705
Epoch: 9, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.803 Vali Acc: 0.675 Test Loss: 0.803 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5802719593048096
Epoch: 10, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.735 Vali Acc: 0.675 Test Loss: 0.735 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6275312900543213
Epoch: 11, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 0.5870800018310547
Epoch: 12, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 0.4960622787475586
Epoch: 13, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.6701450347900391
Epoch: 14, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.508 Vali Acc: 0.925 Test Loss: 0.508 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5694248676300049
Epoch: 15, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6841409206390381
Epoch: 16, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.414 Vali Acc: 0.825 Test Loss: 0.414 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6531572341918945
Epoch: 17, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6383275985717773
Epoch: 18, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7468864917755127
Epoch: 19, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6200339794158936
Epoch: 20, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5944178104400635
Epoch: 21, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6305696964263916
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5447790622711182
Epoch: 23, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5477123260498047
Epoch: 24, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6394031047821045
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5581603050231934
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.5961871147155762
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.593278169631958
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.5907135009765625
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6381101608276367
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6297159194946289
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6421613693237305
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.570981502532959
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5889642238616943
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.48970961570739746
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4854154586791992
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5697178840637207
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.5065774917602539
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.4424560070037842
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5181357860565186
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5836527347564697
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.43824172019958496
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4462106227874756
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4804365634918213
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4646174907684326
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.46842384338378906
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5781433582305908
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.546290397644043
Epoch: 48, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29483524
model size : 127.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7991235256195068
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.420 Vali Acc: 0.300 Test Loss: 1.420 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5051867961883545
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46683216094970703
Epoch: 3, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.383 Vali Acc: 0.300 Test Loss: 1.383 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5143866539001465
Epoch: 4, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.323 Vali Acc: 0.325 Test Loss: 1.323 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.5401127338409424
Epoch: 5, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.250 Vali Acc: 0.450 Test Loss: 1.250 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.43222975730895996
Epoch: 6, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.4735279083251953
Epoch: 7, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.5449669361114502
Epoch: 8, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.035 Vali Acc: 0.775 Test Loss: 1.035 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 0.49895167350769043
Epoch: 9, Steps: 3 | Train Loss: 0.993 Vali Loss: 0.959 Vali Acc: 0.775 Test Loss: 0.959 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.4849581718444824
Epoch: 10, Steps: 3 | Train Loss: 0.902 Vali Loss: 0.891 Vali Acc: 0.875 Test Loss: 0.891 Test Acc: 0.875
Validation loss decreased (-0.774990 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 0.45543456077575684
Epoch: 11, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.827 Vali Acc: 0.875 Test Loss: 0.827 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.4935269355773926
Epoch: 12, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.776 Vali Acc: 0.825 Test Loss: 0.776 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.480637788772583
Epoch: 13, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.43746209144592285
Epoch: 14, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.431105375289917
Epoch: 15, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.4636363983154297
Epoch: 16, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.4779226779937744
Epoch: 17, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.45793795585632324
Epoch: 18, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.5408899784088135
Epoch: 19, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.46059298515319824
Epoch: 20, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.45990443229675293
Epoch: 21, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4150853157043457
Epoch: 22, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.536858081817627
Epoch: 23, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.45702075958251953
Epoch: 24, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4364588260650635
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4398467540740967
Epoch: 26, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5276224613189697
Epoch: 27, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.47394537925720215
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.48253703117370605
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.42675113677978516
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 29442052
model size : 126.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9566445350646973
Epoch: 1, Steps: 3 | Train Loss: 1.666 Vali Loss: 1.451 Vali Acc: 0.300 Test Loss: 1.451 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.4811522960662842
Epoch: 2, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.415 Vali Acc: 0.250 Test Loss: 1.415 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4722299575805664
Epoch: 3, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.478609561920166
Epoch: 4, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.362 Vali Acc: 0.325 Test Loss: 1.362 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.42293357849121094
Epoch: 5, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.4247305393218994
Epoch: 6, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.45263028144836426
Epoch: 7, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.45877790451049805
Epoch: 8, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.4507713317871094
Epoch: 9, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.132 Vali Acc: 0.775 Test Loss: 1.132 Test Acc: 0.775
Validation loss decreased (-0.549988 --> -0.774989).  Saving model ...
Epoch: 10 cost time: 0.4597506523132324
Epoch: 10, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.069 Vali Acc: 0.800 Test Loss: 1.069 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799989).  Saving model ...
Epoch: 11 cost time: 0.44322824478149414
Epoch: 11, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.012 Vali Acc: 0.825 Test Loss: 1.012 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 12 cost time: 0.4195082187652588
Epoch: 12, Steps: 3 | Train Loss: 0.952 Vali Loss: 0.956 Vali Acc: 0.775 Test Loss: 0.956 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43204736709594727
Epoch: 13, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.898 Vali Acc: 0.775 Test Loss: 0.898 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.44922351837158203
Epoch: 14, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.48015546798706055
Epoch: 15, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.772 Vali Acc: 0.825 Test Loss: 0.772 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.4838907718658447
Epoch: 16, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.41215038299560547
Epoch: 17, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.48154163360595703
Epoch: 18, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.42734265327453613
Epoch: 19, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.421475887298584
Epoch: 20, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4664297103881836
Epoch: 21, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.41758227348327637
Epoch: 22, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.4281177520751953
Epoch: 23, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.42296504974365234
Epoch: 24, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4184272289276123
Epoch: 25, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4328005313873291
Epoch: 26, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4345228672027588
Epoch: 27, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.46637678146362305
Epoch: 28, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 29 cost time: 0.5227169990539551
Epoch: 29, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.4934675693511963
Epoch: 30, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5222711563110352
Epoch: 31, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.45530080795288086
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4323897361755371
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4427621364593506
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4177131652832031
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.3732273578643799
Epoch: 36, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.4846467971801758
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.4462563991546631
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.43911027908325195
Epoch: 39, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5152974128723145
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.474686861038208
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5607638359069824
Epoch: 42, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4739694595336914
Epoch: 43, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4913933277130127
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.47809362411499023
Epoch: 45, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.48409557342529297
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5034470558166504
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29414404
model size : 126.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2044429779052734
Epoch: 1, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.413 Vali Acc: 0.350 Test Loss: 1.413 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.47263503074645996
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.6004536151885986
Epoch: 3, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.377 Vali Acc: 0.450 Test Loss: 1.377 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.4924025535583496
Epoch: 4, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.288 Vali Acc: 0.525 Test Loss: 1.288 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.5009744167327881
Epoch: 5, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.166 Vali Acc: 0.450 Test Loss: 1.166 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3973109722137451
Epoch: 6, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.078 Vali Acc: 0.575 Test Loss: 1.078 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.4663052558898926
Epoch: 7, Steps: 3 | Train Loss: 0.980 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
Validation loss decreased (-0.574989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.6335299015045166
Epoch: 8, Steps: 3 | Train Loss: 0.842 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.4982004165649414
Epoch: 9, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.6183395385742188
Epoch: 10, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.783 Vali Acc: 0.675 Test Loss: 0.783 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4736459255218506
Epoch: 11, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4884834289550781
Epoch: 12, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 0.48813772201538086
Epoch: 13, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
Validation loss decreased (-0.774993 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.6113812923431396
Epoch: 14, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.6139252185821533
Epoch: 15, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.5593540668487549
Epoch: 16, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 0.6036796569824219
Epoch: 17, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 0.6308960914611816
Epoch: 18, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.397 Vali Acc: 0.825 Test Loss: 0.397 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5660531520843506
Epoch: 19, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.5493943691253662
Epoch: 20, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.5847411155700684
Epoch: 21, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4647977352142334
Epoch: 22, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.49855756759643555
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6430063247680664
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7307102680206299
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5129106044769287
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.6399824619293213
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.6299607753753662
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.6194303035736084
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.623539924621582
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.585576057434082
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5917456150054932
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5361626148223877
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.49431467056274414
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5847628116607666
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6521682739257812
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4620492458343506
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.4848170280456543
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5006740093231201
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5840158462524414
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 29511172
model size : 127.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.907395601272583
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.408 Vali Acc: 0.175 Test Loss: 1.408 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.4500083923339844
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.430 Vali Acc: 0.175 Test Loss: 1.430 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5520303249359131
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.401 Vali Acc: 0.225 Test Loss: 1.401 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.4958221912384033
Epoch: 4, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.349 Vali Acc: 0.300 Test Loss: 1.349 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.5154776573181152
Epoch: 5, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.299987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.4326205253601074
Epoch: 6, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.218 Vali Acc: 0.450 Test Loss: 1.218 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3880307674407959
Epoch: 7, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.49019503593444824
Epoch: 8, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.084 Vali Acc: 0.550 Test Loss: 1.084 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.42385196685791016
Epoch: 9, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.5100405216217041
Epoch: 10, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.5282049179077148
Epoch: 11, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.950 Vali Acc: 0.700 Test Loss: 0.950 Test Acc: 0.700
Validation loss decreased (-0.599990 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.5558650493621826
Epoch: 12, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.699991 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 0.534642219543457
Epoch: 13, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.821 Vali Acc: 0.850 Test Loss: 0.821 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.46494126319885254
Epoch: 14, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.747 Vali Acc: 0.875 Test Loss: 0.747 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.4445474147796631
Epoch: 15, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.689 Vali Acc: 0.875 Test Loss: 0.689 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.4267902374267578
Epoch: 16, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.47748708724975586
Epoch: 17, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.5251345634460449
Epoch: 18, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.520958662033081
Epoch: 19, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.43595314025878906
Epoch: 20, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 0.5019392967224121
Epoch: 21, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.5264256000518799
Epoch: 22, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5231659412384033
Epoch: 23, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4801368713378906
Epoch: 24, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.4371345043182373
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5368103981018066
Epoch: 26, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5146288871765137
Epoch: 27, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.5053863525390625
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.49910521507263184
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5135793685913086
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.46123647689819336
Epoch: 31, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.48295044898986816
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5354301929473877
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.48409390449523926
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.4869801998138428
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.46895647048950195
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.4532132148742676
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5750551223754883
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 29460484
model size : 127.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9232220649719238
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.385 Vali Acc: 0.275 Test Loss: 1.385 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.4740767478942871
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.373 Vali Acc: 0.275 Test Loss: 1.373 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.3875424861907959
Epoch: 3, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5434184074401855
Epoch: 4, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.4677000045776367
Epoch: 5, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.45470285415649414
Epoch: 6, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.260 Vali Acc: 0.600 Test Loss: 1.260 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.47349023818969727
Epoch: 7, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4679696559906006
Epoch: 8, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.183 Vali Acc: 0.575 Test Loss: 1.183 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4306790828704834
Epoch: 9, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.4968454837799072
Epoch: 10, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.092 Vali Acc: 0.725 Test Loss: 1.092 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.48032331466674805
Epoch: 11, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.045 Vali Acc: 0.750 Test Loss: 1.045 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.47347569465637207
Epoch: 12, Steps: 3 | Train Loss: 0.953 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.579627513885498
Epoch: 13, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.953 Vali Acc: 0.675 Test Loss: 0.953 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49831295013427734
Epoch: 14, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.913 Vali Acc: 0.650 Test Loss: 0.913 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4709625244140625
Epoch: 15, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.859 Vali Acc: 0.650 Test Loss: 0.859 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.522261381149292
Epoch: 16, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.802 Vali Acc: 0.700 Test Loss: 0.802 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.42776918411254883
Epoch: 17, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.749990 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.4733138084411621
Epoch: 18, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.5127012729644775
Epoch: 19, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 0.4783742427825928
Epoch: 20, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.40064334869384766
Epoch: 21, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.40259289741516113
Epoch: 22, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.42156147956848145
Epoch: 23, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.4065518379211426
Epoch: 24, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.3729875087738037
Epoch: 25, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.38719940185546875
Epoch: 26, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.426 Vali Acc: 0.800 Test Loss: 0.426 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3889791965484619
Epoch: 27, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.427 Vali Acc: 0.825 Test Loss: 0.427 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.3897852897644043
Epoch: 28, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.417 Vali Acc: 0.825 Test Loss: 0.417 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.35312438011169434
Epoch: 29, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.418 Vali Acc: 0.825 Test Loss: 0.418 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.39694833755493164
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.420 Vali Acc: 0.825 Test Loss: 0.420 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.3948709964752197
Epoch: 31, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.410 Vali Acc: 0.825 Test Loss: 0.410 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4218330383300781
Epoch: 32, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.389 Vali Acc: 0.825 Test Loss: 0.389 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.43242883682250977
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 29437444
model size : 126.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0527403354644775
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.425 Vali Acc: 0.275 Test Loss: 1.425 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5407376289367676
Epoch: 2, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.367 Vali Acc: 0.350 Test Loss: 1.367 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.5172984600067139
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.5595324039459229
Epoch: 4, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.5632002353668213
Epoch: 5, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.579613208770752
Epoch: 6, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.113 Vali Acc: 0.775 Test Loss: 1.113 Test Acc: 0.775
Validation loss decreased (-0.599988 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.6554343700408936
Epoch: 7, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.056 Vali Acc: 0.850 Test Loss: 1.056 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849989).  Saving model ...
Epoch: 8 cost time: 0.5380280017852783
Epoch: 8, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.982 Vali Acc: 0.800 Test Loss: 0.982 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.546452522277832
Epoch: 9, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6154663562774658
Epoch: 10, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.830 Vali Acc: 0.725 Test Loss: 0.830 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5722289085388184
Epoch: 11, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.47676873207092285
Epoch: 12, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.682 Vali Acc: 0.825 Test Loss: 0.682 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5225839614868164
Epoch: 13, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
Validation loss decreased (-0.849989 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.5239307880401611
Epoch: 14, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.5672180652618408
Epoch: 15, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.47492551803588867
Epoch: 16, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.5733270645141602
Epoch: 17, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.536625862121582
Epoch: 18, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.539177417755127
Epoch: 19, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5302841663360596
Epoch: 20, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5546913146972656
Epoch: 21, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6257205009460449
Epoch: 22, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6077840328216553
Epoch: 23, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6100983619689941
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.5604910850524902
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.48282933235168457
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.59466552734375
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.5542807579040527
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.6928870677947998
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5750751495361328
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4801015853881836
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5571062564849854
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5731062889099121
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5168173313140869
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5809051990509033
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.6443336009979248
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 37 cost time: 0.6393616199493408
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 38 cost time: 0.6059060096740723
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.6534724235534668
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5693316459655762
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.5480034351348877
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.6084327697753906
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.5111112594604492
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.47737979888916016
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.47431111335754395
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.950 Test Loss: 0.107 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5211014747619629
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.5526413917541504
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.4624152183532715
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.4845883846282959
Epoch: 49, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.5297040939331055
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 29515780
model size : 127.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8270726203918457
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.345 Vali Acc: 0.450 Test Loss: 1.345 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.457735538482666
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.349 Vali Acc: 0.425 Test Loss: 1.349 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4290752410888672
Epoch: 3, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.571265697479248
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.270 Vali Acc: 0.550 Test Loss: 1.270 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.5137155055999756
Epoch: 5, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.218 Vali Acc: 0.600 Test Loss: 1.218 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.47423291206359863
Epoch: 6, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.168 Vali Acc: 0.625 Test Loss: 1.168 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.4695091247558594
Epoch: 7, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.5417225360870361
Epoch: 8, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.052 Vali Acc: 0.725 Test Loss: 1.052 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.5114505290985107
Epoch: 9, Steps: 3 | Train Loss: 0.986 Vali Loss: 0.999 Vali Acc: 0.825 Test Loss: 0.999 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.4993007183074951
Epoch: 10, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.942 Vali Acc: 0.775 Test Loss: 0.942 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4695315361022949
Epoch: 11, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4762868881225586
Epoch: 12, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.5760085582733154
Epoch: 13, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.800 Vali Acc: 0.900 Test Loss: 0.800 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.5455465316772461
Epoch: 14, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.754 Vali Acc: 0.900 Test Loss: 0.754 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.5623021125793457
Epoch: 15, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.684 Vali Acc: 0.875 Test Loss: 0.684 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5647060871124268
Epoch: 16, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.606 Vali Acc: 0.875 Test Loss: 0.606 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.532217264175415
Epoch: 17, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5390522480010986
Epoch: 18, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5452661514282227
Epoch: 19, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.5693602561950684
Epoch: 20, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5374197959899902
Epoch: 21, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.608875036239624
Epoch: 22, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.524141788482666
Epoch: 23, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4995718002319336
Epoch: 24, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.468292236328125
Epoch: 25, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5093555450439453
Epoch: 26, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.5586428642272949
Epoch: 27, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.49004244804382324
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5546762943267822
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.5321042537689209
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.5131142139434814
Epoch: 31, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5236246585845947
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5230746269226074
Epoch: 33, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5343551635742188
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.5570433139801025
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.48310208320617676
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5420131683349609
Epoch: 37, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5014791488647461
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.46560239791870117
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5155074596405029
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.576657772064209
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.4998650550842285
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.45453310012817383
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.4478123188018799
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.42289304733276367
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29483524
model size : 127.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6446256637573242
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.433 Vali Acc: 0.325 Test Loss: 1.433 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.3588440418243408
Epoch: 2, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.419 Vali Acc: 0.350 Test Loss: 1.419 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.4289278984069824
Epoch: 3, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.403 Vali Acc: 0.350 Test Loss: 1.403 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.3965613842010498
Epoch: 4, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.4192812442779541
Epoch: 5, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.45668864250183105
Epoch: 6, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.44231677055358887
Epoch: 7, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.285 Vali Acc: 0.575 Test Loss: 1.285 Test Acc: 0.575
Validation loss decreased (-0.374987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 0.4209725856781006
Epoch: 8, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4058353900909424
Epoch: 9, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.39910125732421875
Epoch: 10, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.152 Vali Acc: 0.550 Test Loss: 1.152 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.39879512786865234
Epoch: 11, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.47431111335754395
Epoch: 12, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.057 Vali Acc: 0.675 Test Loss: 1.057 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.428037166595459
Epoch: 13, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.3717806339263916
Epoch: 14, Steps: 3 | Train Loss: 0.951 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.4368171691894531
Epoch: 15, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.4115915298461914
Epoch: 16, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.45415806770324707
Epoch: 17, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4605989456176758
Epoch: 18, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 0.439711332321167
Epoch: 19, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 0.42766904830932617
Epoch: 20, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 0.41901612281799316
Epoch: 21, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.4469139575958252
Epoch: 22, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.489 Vali Acc: 0.925 Test Loss: 0.489 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.4528474807739258
Epoch: 23, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4238002300262451
Epoch: 24, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5215680599212646
Epoch: 25, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5065903663635254
Epoch: 26, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.48558592796325684
Epoch: 27, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.4895904064178467
Epoch: 28, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.4783058166503906
Epoch: 29, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 0.3898136615753174
Epoch: 30, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 0.3574707508087158
Epoch: 31, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.4095337390899658
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.42675042152404785
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.41700267791748047
Epoch: 34, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.3860664367675781
Epoch: 35, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.40424060821533203
Epoch: 36, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.39792752265930176
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4624803066253662
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.47893762588500977
Epoch: 39, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.4911069869995117
Epoch: 40, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4590184688568115
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4835476875305176
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5010325908660889
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5458805561065674
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.46102309226989746
Epoch: 45, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4398167133331299
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5797412395477295
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.5431597232818604
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.5393366813659668
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4813055992126465
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29460484
model size : 127.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1333541870117188
Epoch: 1, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.421 Vali Acc: 0.325 Test Loss: 1.421 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5540759563446045
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.398 Vali Acc: 0.425 Test Loss: 1.398 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5337848663330078
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.330 Vali Acc: 0.425 Test Loss: 1.330 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.602426290512085
Epoch: 4, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.253 Vali Acc: 0.425 Test Loss: 1.253 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.5684504508972168
Epoch: 5, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.172 Vali Acc: 0.650 Test Loss: 1.172 Test Acc: 0.650
Validation loss decreased (-0.424987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.5920298099517822
Epoch: 6, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.4680659770965576
Epoch: 7, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5754976272583008
Epoch: 8, Steps: 3 | Train Loss: 0.926 Vali Loss: 0.964 Vali Acc: 0.575 Test Loss: 0.964 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6394374370574951
Epoch: 9, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.5104405879974365
Epoch: 10, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.5098216533660889
Epoch: 11, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5348999500274658
Epoch: 12, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5198929309844971
Epoch: 13, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.633 Vali Acc: 0.825 Test Loss: 0.633 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.5625648498535156
Epoch: 14, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.44980645179748535
Epoch: 15, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5397694110870361
Epoch: 16, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.652329683303833
Epoch: 17, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.407 Vali Acc: 0.825 Test Loss: 0.407 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5980648994445801
Epoch: 18, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5570306777954102
Epoch: 19, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6083083152770996
Epoch: 20, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.287 Vali Acc: 1.000 Test Loss: 0.287 Test Acc: 1.000
Validation loss decreased (-0.924995 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 29557252
model size : 127.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.98374605178833
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.434 Vali Acc: 0.300 Test Loss: 1.434 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.45394372940063477
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.413 Vali Acc: 0.300 Test Loss: 1.413 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.4666175842285156
Epoch: 3, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.383 Vali Acc: 0.425 Test Loss: 1.383 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.5219929218292236
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.338 Vali Acc: 0.475 Test Loss: 1.338 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.4926719665527344
Epoch: 5, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.283 Vali Acc: 0.525 Test Loss: 1.283 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.43291282653808594
Epoch: 6, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.39038777351379395
Epoch: 7, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.4597175121307373
Epoch: 8, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.4834578037261963
Epoch: 9, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.013 Vali Acc: 0.625 Test Loss: 1.013 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.41483640670776367
Epoch: 10, Steps: 3 | Train Loss: 0.848 Vali Loss: 0.953 Vali Acc: 0.650 Test Loss: 0.953 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.41706180572509766
Epoch: 11, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.896 Vali Acc: 0.675 Test Loss: 0.896 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 12 cost time: 0.47974252700805664
Epoch: 12, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.836 Vali Acc: 0.700 Test Loss: 0.836 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 0.4916403293609619
Epoch: 13, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.768 Vali Acc: 0.750 Test Loss: 0.768 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.4681880474090576
Epoch: 14, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.701 Vali Acc: 0.775 Test Loss: 0.701 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 15 cost time: 0.4410111904144287
Epoch: 15, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.774993 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.4382741451263428
Epoch: 16, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.436934232711792
Epoch: 17, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.4848289489746094
Epoch: 18, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.4413001537322998
Epoch: 19, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 0.5224907398223877
Epoch: 20, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 0.466921329498291
Epoch: 21, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.6161236763000488
Epoch: 22, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.899996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.49553799629211426
Epoch: 23, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5207552909851074
Epoch: 24, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5213568210601807
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5256805419921875
Epoch: 26, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.55342698097229
Epoch: 27, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5022003650665283
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.47852563858032227
Epoch: 29, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.481076717376709
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.47857666015625
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.45235419273376465
Epoch: 32, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29520388
model size : 127.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1515891551971436
Epoch: 1, Steps: 3 | Train Loss: 1.570 Vali Loss: 1.445 Vali Acc: 0.075 Test Loss: 1.445 Test Acc: 0.075
Validation loss decreased (inf --> -0.074986).  Saving model ...
Epoch: 2 cost time: 0.5256905555725098
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.426 Vali Acc: 0.100 Test Loss: 1.426 Test Acc: 0.100
Validation loss decreased (-0.074986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.48671531677246094
Epoch: 3, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.406 Vali Acc: 0.125 Test Loss: 1.406 Test Acc: 0.125
Validation loss decreased (-0.099986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 0.45641660690307617
Epoch: 4, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.379 Vali Acc: 0.175 Test Loss: 1.379 Test Acc: 0.175
Validation loss decreased (-0.124986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.37930750846862793
Epoch: 5, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.348 Vali Acc: 0.300 Test Loss: 1.348 Test Acc: 0.300
Validation loss decreased (-0.174986 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.5221409797668457
Epoch: 6, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.316 Vali Acc: 0.550 Test Loss: 1.316 Test Acc: 0.550
Validation loss decreased (-0.299987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.5621883869171143
Epoch: 7, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.279 Vali Acc: 0.575 Test Loss: 1.279 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 0.571587324142456
Epoch: 8, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.245 Vali Acc: 0.675 Test Loss: 1.245 Test Acc: 0.675
Validation loss decreased (-0.574987 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.4108247756958008
Epoch: 9, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.201 Vali Acc: 0.625 Test Loss: 1.201 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45511937141418457
Epoch: 10, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4620018005371094
Epoch: 11, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.108 Vali Acc: 0.625 Test Loss: 1.108 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5032780170440674
Epoch: 12, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.5607969760894775
Epoch: 13, Steps: 3 | Train Loss: 0.848 Vali Loss: 0.984 Vali Acc: 0.675 Test Loss: 0.984 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.47411179542541504
Epoch: 14, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.4424586296081543
Epoch: 15, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.853 Vali Acc: 0.725 Test Loss: 0.853 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 0.5163507461547852
Epoch: 16, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.788 Vali Acc: 0.725 Test Loss: 0.788 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 17 cost time: 0.48471570014953613
Epoch: 17, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.722 Vali Acc: 0.725 Test Loss: 0.722 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724993).  Saving model ...
Epoch: 18 cost time: 0.47252750396728516
Epoch: 18, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.671 Vali Acc: 0.725 Test Loss: 0.671 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 19 cost time: 0.5303008556365967
Epoch: 19, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.611 Vali Acc: 0.775 Test Loss: 0.611 Test Acc: 0.775
Validation loss decreased (-0.724993 --> -0.774994).  Saving model ...
Epoch: 20 cost time: 0.5097734928131104
Epoch: 20, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799994).  Saving model ...
Epoch: 21 cost time: 0.5095396041870117
Epoch: 21, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.5327575206756592
Epoch: 22, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.5029349327087402
Epoch: 23, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 0.485551118850708
Epoch: 24, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.5753886699676514
Epoch: 25, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.546612024307251
Epoch: 26, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.585202693939209
Epoch: 27, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.6128826141357422
Epoch: 28, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.5875694751739502
Epoch: 29, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.5381314754486084
Epoch: 30, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.49053454399108887
Epoch: 31, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.5303776264190674
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4632744789123535
Epoch: 33, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5556399822235107
Epoch: 34, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5197956562042236
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5768990516662598
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.5113010406494141
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4747896194458008
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5448465347290039
Epoch: 39, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.48474669456481934
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5141525268554688
Epoch: 41, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.5643289089202881
Epoch: 42, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.5585172176361084
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5355260372161865
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.58125901222229
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6447491645812988
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5493574142456055
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6024191379547119
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.49652099609375
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5632219314575195
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 29501956
model size : 127.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.249452590942383
Epoch: 1, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.6422655582427979
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.5540988445281982
Epoch: 3, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.088 Vali Acc: 0.650 Test Loss: 1.088 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 0.5783734321594238
Epoch: 4, Steps: 3 | Train Loss: 1.070 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.6766819953918457
Epoch: 5, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.921 Vali Acc: 0.625 Test Loss: 0.921 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5385737419128418
Epoch: 6, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.840 Vali Acc: 0.775 Test Loss: 0.840 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.6044588088989258
Epoch: 7, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.5450694561004639
Epoch: 8, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.540 Vali Acc: 0.750 Test Loss: 0.540 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5013294219970703
Epoch: 9, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 0.616264820098877
Epoch: 10, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 0.6630146503448486
Epoch: 11, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5692238807678223
Epoch: 12, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5939047336578369
Epoch: 13, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6061208248138428
Epoch: 14, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5451071262359619
Epoch: 15, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.624779462814331
Epoch: 16, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6287379264831543
Epoch: 17, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6183133125305176
Epoch: 18, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5824122428894043
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6928586959838867
Epoch: 20, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22616836
model size : 100.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0799388885498047
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.332 Vali Acc: 0.250 Test Loss: 1.332 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.4877583980560303
Epoch: 2, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.298 Vali Acc: 0.350 Test Loss: 1.298 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5348947048187256
Epoch: 3, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
Validation loss decreased (-0.349987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.4938955307006836
Epoch: 4, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.128 Vali Acc: 0.750 Test Loss: 1.128 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 0.5255076885223389
Epoch: 5, Steps: 3 | Train Loss: 0.920 Vali Loss: 0.993 Vali Acc: 0.825 Test Loss: 0.993 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.5607814788818359
Epoch: 6, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.892 Vali Acc: 0.800 Test Loss: 0.892 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4859147071838379
Epoch: 7, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.857 Vali Acc: 0.600 Test Loss: 0.857 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5272438526153564
Epoch: 8, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.812 Vali Acc: 0.600 Test Loss: 0.812 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5719351768493652
Epoch: 9, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5651955604553223
Epoch: 10, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 0.5834920406341553
Epoch: 11, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.610 Vali Acc: 0.725 Test Loss: 0.610 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5416555404663086
Epoch: 12, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5609712600708008
Epoch: 13, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 0.5697612762451172
Epoch: 14, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.503 Vali Acc: 0.800 Test Loss: 0.503 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.527594804763794
Epoch: 15, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 0.5283513069152832
Epoch: 16, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.48915886878967285
Epoch: 17, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.432 Vali Acc: 0.825 Test Loss: 0.432 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6108508110046387
Epoch: 18, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.474 Vali Acc: 0.775 Test Loss: 0.474 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5897595882415771
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.474 Vali Acc: 0.775 Test Loss: 0.474 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6131734848022461
Epoch: 20, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.443 Vali Acc: 0.825 Test Loss: 0.443 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5937576293945312
Epoch: 21, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 0.544745922088623
Epoch: 22, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.5604636669158936
Epoch: 23, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5024950504302979
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.448 Vali Acc: 0.825 Test Loss: 0.448 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5504727363586426
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.474 Vali Acc: 0.800 Test Loss: 0.474 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5822510719299316
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.468 Vali Acc: 0.825 Test Loss: 0.468 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.580143928527832
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.468 Vali Acc: 0.800 Test Loss: 0.468 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6488752365112305
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.825 Test Loss: 0.498 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5476913452148438
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6432795524597168
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5638630390167236
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5746614933013916
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22395652
model size : 100.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.65635347366333
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.395 Vali Acc: 0.300 Test Loss: 1.395 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4761016368865967
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.348 Vali Acc: 0.350 Test Loss: 1.348 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.49512457847595215
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.281 Vali Acc: 0.425 Test Loss: 1.281 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.437089204788208
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.202 Vali Acc: 0.625 Test Loss: 1.202 Test Acc: 0.625
Validation loss decreased (-0.424987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.517017126083374
Epoch: 5, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.5140001773834229
Epoch: 6, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.040 Vali Acc: 0.575 Test Loss: 1.040 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5686190128326416
Epoch: 7, Steps: 3 | Train Loss: 0.983 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.6281323432922363
Epoch: 8, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.901 Vali Acc: 0.700 Test Loss: 0.901 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.6019623279571533
Epoch: 9, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.841 Vali Acc: 0.625 Test Loss: 0.841 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5762262344360352
Epoch: 10, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
Validation loss decreased (-0.699991 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.6375114917755127
Epoch: 11, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 0.5535244941711426
Epoch: 12, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.680 Vali Acc: 0.725 Test Loss: 0.680 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6065502166748047
Epoch: 13, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.635 Vali Acc: 0.725 Test Loss: 0.635 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.542177677154541
Epoch: 14, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6046204566955566
Epoch: 15, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.5844740867614746
Epoch: 16, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.5579798221588135
Epoch: 17, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5596010684967041
Epoch: 18, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5710771083831787
Epoch: 19, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5456132888793945
Epoch: 20, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.4698975086212158
Epoch: 21, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.44807887077331543
Epoch: 22, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4601771831512451
Epoch: 23, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6383733749389648
Epoch: 24, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.6369924545288086
Epoch: 25, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6154470443725586
Epoch: 26, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5587399005889893
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.403 Vali Acc: 0.825 Test Loss: 0.403 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5329811573028564
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5121269226074219
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5554392337799072
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6141233444213867
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5686438083648682
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.5622830390930176
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.5016906261444092
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.49062108993530273
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.5205466747283936
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5610833168029785
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.48462605476379395
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4706380367279053
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.47867870330810547
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4521043300628662
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.41954708099365234
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.46579670906066895
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.530731201171875
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6075832843780518
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22285060
model size : 99.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1880269050598145
Epoch: 1, Steps: 3 | Train Loss: 1.587 Vali Loss: 1.436 Vali Acc: 0.200 Test Loss: 1.436 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.615607738494873
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.390 Vali Acc: 0.125 Test Loss: 1.390 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6125752925872803
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.297 Vali Acc: 0.425 Test Loss: 1.297 Test Acc: 0.425
Validation loss decreased (-0.199986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.5230555534362793
Epoch: 4, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.46067094802856445
Epoch: 5, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.5766401290893555
Epoch: 6, Steps: 3 | Train Loss: 0.942 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.5164763927459717
Epoch: 7, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.5846714973449707
Epoch: 8, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.5649943351745605
Epoch: 9, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.677 Vali Acc: 0.900 Test Loss: 0.677 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899993).  Saving model ...
Epoch: 10 cost time: 0.5053715705871582
Epoch: 10, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5192394256591797
Epoch: 11, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.692 Vali Acc: 0.650 Test Loss: 0.692 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.45050740242004395
Epoch: 12, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.46506619453430176
Epoch: 13, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.507 Vali Acc: 0.925 Test Loss: 0.507 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.45580172538757324
Epoch: 14, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.5196506977081299
Epoch: 15, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43906378746032715
Epoch: 16, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.43753933906555176
Epoch: 17, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.46765685081481934
Epoch: 18, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.49943065643310547
Epoch: 19, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5431115627288818
Epoch: 20, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.473463773727417
Epoch: 21, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42531418800354004
Epoch: 22, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4277069568634033
Epoch: 23, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.40215396881103516
Epoch: 24, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5222275257110596
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5026273727416992
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.513904333114624
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5026605129241943
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.480057954788208
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.5461103916168213
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5160443782806396
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.5419487953186035
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.5576345920562744
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4995894432067871
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5892856121063232
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5520772933959961
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.553400993347168
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5388278961181641
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4331502914428711
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5090126991271973
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4795243740081787
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.46042561531066895
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22404868
model size : 100.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.860809564590454
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.5010013580322266
Epoch: 2, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5390565395355225
Epoch: 3, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.6030764579772949
Epoch: 4, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.5237932205200195
Epoch: 5, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.053 Vali Acc: 0.650 Test Loss: 1.053 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 0.5385098457336426
Epoch: 6, Steps: 3 | Train Loss: 0.980 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 0.5796308517456055
Epoch: 7, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.918 Vali Acc: 0.625 Test Loss: 0.918 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.556281566619873
Epoch: 8, Steps: 3 | Train Loss: 0.737 Vali Loss: 0.826 Vali Acc: 0.700 Test Loss: 0.826 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699992).  Saving model ...
Epoch: 9 cost time: 0.5638482570648193
Epoch: 9, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.699992 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.5864896774291992
Epoch: 10, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 11 cost time: 0.5087969303131104
Epoch: 11, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 0.559443473815918
Epoch: 12, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.540963888168335
Epoch: 13, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.5833494663238525
Epoch: 14, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 0.6388270854949951
Epoch: 15, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5744695663452148
Epoch: 16, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.6066892147064209
Epoch: 17, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5684585571289062
Epoch: 18, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.46556997299194336
Epoch: 19, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.4497220516204834
Epoch: 20, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5214371681213379
Epoch: 21, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4610469341278076
Epoch: 22, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5658812522888184
Epoch: 23, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.6541690826416016
Epoch: 24, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6196877956390381
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5818495750427246
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6288571357727051
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5462296009063721
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5552964210510254
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5727536678314209
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5156567096710205
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5838639736175537
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.613452672958374
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22331140
model size : 99.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9183156490325928
Epoch: 1, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.431 Vali Acc: 0.150 Test Loss: 1.431 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.5387299060821533
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
Validation loss decreased (-0.149986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.5657975673675537
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.302 Vali Acc: 0.425 Test Loss: 1.302 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.5684401988983154
Epoch: 4, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.250 Vali Acc: 0.425 Test Loss: 1.250 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 0.5778279304504395
Epoch: 5, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.208 Vali Acc: 0.450 Test Loss: 1.208 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.5623400211334229
Epoch: 6, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.157 Vali Acc: 0.450 Test Loss: 1.157 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.5040216445922852
Epoch: 7, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.5147924423217773
Epoch: 8, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.032 Vali Acc: 0.700 Test Loss: 1.032 Test Acc: 0.700
Validation loss decreased (-0.499989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.48767614364624023
Epoch: 9, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.5929131507873535
Epoch: 10, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 0.5404341220855713
Epoch: 11, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 0.4925558567047119
Epoch: 12, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.550295352935791
Epoch: 13, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 14 cost time: 0.5598318576812744
Epoch: 14, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 0.5508556365966797
Epoch: 15, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 0.5187923908233643
Epoch: 16, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 0.533968448638916
Epoch: 17, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 0.5168061256408691
Epoch: 18, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 0.4890577793121338
Epoch: 19, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.482 Vali Acc: 0.825 Test Loss: 0.482 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 20 cost time: 0.4997580051422119
Epoch: 20, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.449 Vali Acc: 0.825 Test Loss: 0.449 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 21 cost time: 0.5546236038208008
Epoch: 21, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.824996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.4360673427581787
Epoch: 22, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.5036423206329346
Epoch: 23, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4520115852355957
Epoch: 24, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5864095687866211
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.43718910217285156
Epoch: 26, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.367 Vali Acc: 0.825 Test Loss: 0.367 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.46691465377807617
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.46440720558166504
Epoch: 28, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.5181748867034912
Epoch: 29, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5210862159729004
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.45270442962646484
Epoch: 31, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.522691011428833
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5371134281158447
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.4928009510040283
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5262625217437744
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.4829435348510742
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5009152889251709
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4313528537750244
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 22275844
model size : 99.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.046422004699707
Epoch: 1, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.354 Vali Acc: 0.300 Test Loss: 1.354 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6022610664367676
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.371 Vali Acc: 0.400 Test Loss: 1.371 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.5990982055664062
Epoch: 3, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.6102802753448486
Epoch: 4, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.078 Vali Acc: 0.875 Test Loss: 1.078 Test Acc: 0.875
Validation loss decreased (-0.474988 --> -0.874989).  Saving model ...
Epoch: 5 cost time: 0.607170820236206
Epoch: 5, Steps: 3 | Train Loss: 0.993 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5332887172698975
Epoch: 6, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.855 Vali Acc: 0.875 Test Loss: 0.855 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.5067064762115479
Epoch: 7, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.776 Vali Acc: 0.925 Test Loss: 0.776 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924992).  Saving model ...
Epoch: 8 cost time: 0.4966928958892822
Epoch: 8, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4793052673339844
Epoch: 9, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.612 Vali Acc: 0.950 Test Loss: 0.612 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.4796929359436035
Epoch: 10, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.564 Vali Acc: 0.925 Test Loss: 0.564 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4892723560333252
Epoch: 11, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.456 Vali Acc: 0.975 Test Loss: 0.456 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.5222289562225342
Epoch: 12, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4875302314758301
Epoch: 13, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5187780857086182
Epoch: 14, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5328714847564697
Epoch: 15, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5228230953216553
Epoch: 16, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4928269386291504
Epoch: 17, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.47430968284606934
Epoch: 18, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5218214988708496
Epoch: 19, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5472047328948975
Epoch: 20, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6769030094146729
Epoch: 21, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22418692
model size : 100.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8137776851654053
Epoch: 1, Steps: 3 | Train Loss: 1.587 Vali Loss: 1.390 Vali Acc: 0.200 Test Loss: 1.390 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.4781055450439453
Epoch: 2, Steps: 3 | Train Loss: 1.501 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.199986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.48914504051208496
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.47849225997924805
Epoch: 4, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
Validation loss decreased (-0.399987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.46474337577819824
Epoch: 5, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.082 Vali Acc: 0.675 Test Loss: 1.082 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.537940263748169
Epoch: 6, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.41951417922973633
Epoch: 7, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.929 Vali Acc: 0.800 Test Loss: 0.929 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.4146289825439453
Epoch: 8, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.860 Vali Acc: 0.825 Test Loss: 0.860 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.47666501998901367
Epoch: 9, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 0.5977306365966797
Epoch: 10, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.5033020973205566
Epoch: 11, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 0.5334110260009766
Epoch: 12, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5200331211090088
Epoch: 13, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.5426299571990967
Epoch: 14, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.535024881362915
Epoch: 15, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.59775710105896
Epoch: 16, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 0.4279634952545166
Epoch: 17, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4488098621368408
Epoch: 18, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6381232738494873
Epoch: 19, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.41777658462524414
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.5288875102996826
Epoch: 21, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.46419477462768555
Epoch: 22, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4297010898590088
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5603487491607666
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4955480098724365
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4322481155395508
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.5161845684051514
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5016248226165771
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5237088203430176
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.48949527740478516
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5113496780395508
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4518117904663086
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4006478786468506
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4399135112762451
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5396265983581543
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5268146991729736
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22344964
model size : 99.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7777140140533447
Epoch: 1, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.293 Vali Acc: 0.225 Test Loss: 1.293 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.5473370552062988
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
Validation loss decreased (-0.224987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.572380542755127
Epoch: 3, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.274 Vali Acc: 0.525 Test Loss: 1.274 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.4720914363861084
Epoch: 4, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.236 Vali Acc: 0.475 Test Loss: 1.236 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5267124176025391
Epoch: 5, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.190 Vali Acc: 0.475 Test Loss: 1.190 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5369274616241455
Epoch: 6, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.5884528160095215
Epoch: 7, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.6059277057647705
Epoch: 8, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 0.5056459903717041
Epoch: 9, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.904 Vali Acc: 0.825 Test Loss: 0.904 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 0.5745565891265869
Epoch: 10, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.848 Vali Acc: 0.825 Test Loss: 0.848 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.5198197364807129
Epoch: 11, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.5050551891326904
Epoch: 12, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4378690719604492
Epoch: 13, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.686 Vali Acc: 0.825 Test Loss: 0.686 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.5415670871734619
Epoch: 14, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.607 Vali Acc: 0.900 Test Loss: 0.607 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.4526655673980713
Epoch: 15, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.541 Vali Acc: 0.925 Test Loss: 0.541 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.4248838424682617
Epoch: 16, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.40660786628723145
Epoch: 17, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.41138553619384766
Epoch: 18, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.4116091728210449
Epoch: 19, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4127535820007324
Epoch: 20, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5382790565490723
Epoch: 21, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.3898138999938965
Epoch: 22, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.348862886428833
Epoch: 23, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.44574546813964844
Epoch: 24, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.36637020111083984
Epoch: 25, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.5282139778137207
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.48068857192993164
Epoch: 27, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 28 cost time: 0.5043079853057861
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 29 cost time: 0.5032117366790771
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 30 cost time: 0.6175189018249512
Epoch: 30, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 31 cost time: 0.5110495090484619
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.925 Test Loss: 0.196 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 32 cost time: 0.550147533416748
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5895383358001709
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.4420313835144043
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5432534217834473
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.5261621475219727
Epoch: 36, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5645773410797119
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.5500905513763428
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.46951913833618164
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.5352897644042969
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.506950855255127
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.43962860107421875
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.44771742820739746
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5044286251068115
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.925 Test Loss: 0.171 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5894596576690674
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.44469738006591797
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.925 Test Loss: 0.163 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.446047306060791
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.925 Test Loss: 0.158 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.4402916431427002
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.925 Test Loss: 0.155 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.46215033531188965
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.925 Test Loss: 0.155 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.4379599094390869
Epoch: 50, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.925 Test Loss: 0.162 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22271236
model size : 99.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0362765789031982
Epoch: 1, Steps: 3 | Train Loss: 1.537 Vali Loss: 1.380 Vali Acc: 0.350 Test Loss: 1.380 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5133028030395508
Epoch: 2, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.376 Vali Acc: 0.300 Test Loss: 1.376 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49703526496887207
Epoch: 3, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.248 Vali Acc: 0.425 Test Loss: 1.248 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.4738430976867676
Epoch: 4, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.115 Vali Acc: 0.450 Test Loss: 1.115 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 5 cost time: 0.5455000400543213
Epoch: 5, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.449989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.49093055725097656
Epoch: 6, Steps: 3 | Train Loss: 0.862 Vali Loss: 0.931 Vali Acc: 0.825 Test Loss: 0.931 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.5149633884429932
Epoch: 7, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.872 Vali Acc: 0.600 Test Loss: 0.872 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49331045150756836
Epoch: 8, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.747 Vali Acc: 0.875 Test Loss: 0.747 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.5251400470733643
Epoch: 9, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.40845775604248047
Epoch: 10, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.46748781204223633
Epoch: 11, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.609 Vali Acc: 0.900 Test Loss: 0.609 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.5258047580718994
Epoch: 12, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 0.4658071994781494
Epoch: 13, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.4765129089355469
Epoch: 14, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.5559878349304199
Epoch: 15, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5621292591094971
Epoch: 16, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4807257652282715
Epoch: 17, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.5116450786590576
Epoch: 18, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4937605857849121
Epoch: 19, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5358858108520508
Epoch: 20, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.5302994251251221
Epoch: 21, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5670921802520752
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.484896183013916
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 0.5691430568695068
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.47203850746154785
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.4964170455932617
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.48522186279296875
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5098681449890137
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4330618381500244
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.5348148345947266
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5560917854309082
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.48266124725341797
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.4950127601623535
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.496258020401001
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4741950035095215
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.48317980766296387
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5107560157775879
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5051305294036865
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.48030591011047363
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4670541286468506
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5229263305664062
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4874241352081299
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5509436130523682
Epoch: 43, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22427908
model size : 100.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9716856479644775
Epoch: 1, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.372 Vali Acc: 0.375 Test Loss: 1.372 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.4581313133239746
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.4828934669494629
Epoch: 3, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.309 Vali Acc: 0.425 Test Loss: 1.309 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.38039088249206543
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
Validation loss decreased (-0.424987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.45754456520080566
Epoch: 5, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.129 Vali Acc: 0.725 Test Loss: 1.129 Test Acc: 0.725
Validation loss decreased (-0.599988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 0.4397737979888916
Epoch: 6, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.038 Vali Acc: 0.775 Test Loss: 1.038 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 0.43656206130981445
Epoch: 7, Steps: 3 | Train Loss: 0.974 Vali Loss: 0.962 Vali Acc: 0.850 Test Loss: 0.962 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.37880706787109375
Epoch: 8, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.890 Vali Acc: 0.800 Test Loss: 0.890 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4159584045410156
Epoch: 9, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.841 Vali Acc: 0.800 Test Loss: 0.841 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4392707347869873
Epoch: 10, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.38306665420532227
Epoch: 11, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4201197624206543
Epoch: 12, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.672 Vali Acc: 0.900 Test Loss: 0.672 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.38782382011413574
Epoch: 13, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.38911008834838867
Epoch: 14, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.46941518783569336
Epoch: 15, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5277118682861328
Epoch: 16, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.5293409824371338
Epoch: 17, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.4464235305786133
Epoch: 18, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.466677188873291
Epoch: 19, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4735143184661865
Epoch: 20, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.462787389755249
Epoch: 21, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.46104884147644043
Epoch: 22, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.36124134063720703
Epoch: 23, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.410264253616333
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.38494110107421875
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4998950958251953
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.49384474754333496
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22321924
model size : 99.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.073225736618042
Epoch: 1, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.398 Vali Acc: 0.175 Test Loss: 1.398 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.4617931842803955
Epoch: 2, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.174986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.4712660312652588
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.338 Vali Acc: 0.450 Test Loss: 1.338 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.444110631942749
Epoch: 4, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.300 Vali Acc: 0.625 Test Loss: 1.300 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 0.4639146327972412
Epoch: 5, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.242 Vali Acc: 0.675 Test Loss: 1.242 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674988).  Saving model ...
Epoch: 6 cost time: 0.41919469833374023
Epoch: 6, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.191 Vali Acc: 0.725 Test Loss: 1.191 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 0.45301294326782227
Epoch: 7, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.143 Vali Acc: 0.800 Test Loss: 1.143 Test Acc: 0.800
Validation loss decreased (-0.724988 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.45952844619750977
Epoch: 8, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.082 Vali Acc: 0.725 Test Loss: 1.082 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4037041664123535
Epoch: 9, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.022 Vali Acc: 0.775 Test Loss: 1.022 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.41832947731018066
Epoch: 10, Steps: 3 | Train Loss: 0.918 Vali Loss: 0.957 Vali Acc: 0.850 Test Loss: 0.957 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 11 cost time: 0.5030961036682129
Epoch: 11, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.886 Vali Acc: 0.850 Test Loss: 0.886 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.5019769668579102
Epoch: 12, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43642210960388184
Epoch: 13, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.449021577835083
Epoch: 14, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.46262502670288086
Epoch: 15, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.5182456970214844
Epoch: 16, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5146069526672363
Epoch: 17, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5394806861877441
Epoch: 18, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.47061753273010254
Epoch: 19, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.45015525817871094
Epoch: 20, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4570906162261963
Epoch: 21, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.4771299362182617
Epoch: 22, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.4936950206756592
Epoch: 23, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4643433094024658
Epoch: 24, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4148421287536621
Epoch: 25, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5052921772003174
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5067245960235596
Epoch: 27, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.500744104385376
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.45569705963134766
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.43188905715942383
Epoch: 30, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.46018075942993164
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.373 Vali Acc: 0.825 Test Loss: 0.373 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.42464137077331543
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.387 Vali Acc: 0.825 Test Loss: 0.387 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 22275844
model size : 99.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2450904846191406
Epoch: 1, Steps: 3 | Train Loss: 1.571 Vali Loss: 1.445 Vali Acc: 0.275 Test Loss: 1.445 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5680639743804932
Epoch: 2, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.354 Vali Acc: 0.200 Test Loss: 1.354 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5769224166870117
Epoch: 3, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.254 Vali Acc: 0.475 Test Loss: 1.254 Test Acc: 0.475
Validation loss decreased (-0.274986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.5364639759063721
Epoch: 4, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.474987 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 0.6211626529693604
Epoch: 5, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.639671802520752
Epoch: 6, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.6166675090789795
Epoch: 7, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.883 Vali Acc: 0.875 Test Loss: 0.883 Test Acc: 0.875
Validation loss decreased (-0.724990 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 0.5431995391845703
Epoch: 8, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.851 Vali Acc: 0.825 Test Loss: 0.851 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6240108013153076
Epoch: 9, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5755090713500977
Epoch: 10, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.641 Vali Acc: 0.925 Test Loss: 0.641 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.5387310981750488
Epoch: 11, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5982599258422852
Epoch: 12, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.507 Vali Acc: 0.925 Test Loss: 0.507 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.6313800811767578
Epoch: 13, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5689113140106201
Epoch: 14, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7161509990692139
Epoch: 15, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6385049819946289
Epoch: 16, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5219976902008057
Epoch: 17, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4390218257904053
Epoch: 18, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.451 Vali Acc: 0.825 Test Loss: 0.451 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5447161197662354
Epoch: 19, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5811436176300049
Epoch: 20, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5057363510131836
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6271626949310303
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5734326839447021
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.587141752243042
Epoch: 24, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.45644044876098633
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6728560924530029
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5740139484405518
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6666805744171143
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6158652305603027
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5285391807556152
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22441732
model size : 100.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.11165714263916
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.4572336673736572
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5128388404846191
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.313 Vali Acc: 0.425 Test Loss: 1.313 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.6054131984710693
Epoch: 4, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.244 Vali Acc: 0.450 Test Loss: 1.244 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.5103578567504883
Epoch: 5, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
Validation loss decreased (-0.449988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.4781796932220459
Epoch: 6, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.079 Vali Acc: 0.750 Test Loss: 1.079 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.5214526653289795
Epoch: 7, Steps: 3 | Train Loss: 1.011 Vali Loss: 0.996 Vali Acc: 0.775 Test Loss: 0.996 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.4532341957092285
Epoch: 8, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.922 Vali Acc: 0.850 Test Loss: 0.922 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.5111289024353027
Epoch: 9, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4615132808685303
Epoch: 10, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5252425670623779
Epoch: 11, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49059295654296875
Epoch: 12, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.44941258430480957
Epoch: 13, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.605 Vali Acc: 0.925 Test Loss: 0.605 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.532818078994751
Epoch: 14, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.529 Vali Acc: 0.950 Test Loss: 0.529 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5143306255340576
Epoch: 15, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4843273162841797
Epoch: 16, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4996457099914551
Epoch: 17, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5095076560974121
Epoch: 18, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5664162635803223
Epoch: 19, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5380492210388184
Epoch: 20, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4389619827270508
Epoch: 21, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5011026859283447
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6139411926269531
Epoch: 23, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4526190757751465
Epoch: 24, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22335748
model size : 99.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9913158416748047
Epoch: 1, Steps: 3 | Train Loss: 1.553 Vali Loss: 1.474 Vali Acc: 0.175 Test Loss: 1.474 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.5075457096099854
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.447 Vali Acc: 0.100 Test Loss: 1.447 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5385892391204834
Epoch: 3, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.411 Vali Acc: 0.300 Test Loss: 1.411 Test Acc: 0.300
Validation loss decreased (-0.174985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5057308673858643
Epoch: 4, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.371 Vali Acc: 0.375 Test Loss: 1.371 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5451598167419434
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.317 Vali Acc: 0.425 Test Loss: 1.317 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.5397646427154541
Epoch: 6, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.271 Vali Acc: 0.475 Test Loss: 1.271 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.5069088935852051
Epoch: 7, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.230 Vali Acc: 0.525 Test Loss: 1.230 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.531137228012085
Epoch: 8, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.187 Vali Acc: 0.575 Test Loss: 1.187 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.46511387825012207
Epoch: 9, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.135 Vali Acc: 0.575 Test Loss: 1.135 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.48639655113220215
Epoch: 10, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.092 Vali Acc: 0.600 Test Loss: 1.092 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.43273305892944336
Epoch: 11, Steps: 3 | Train Loss: 0.893 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.3920447826385498
Epoch: 12, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.4112272262573242
Epoch: 13, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3520979881286621
Epoch: 14, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.44470763206481934
Epoch: 15, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 0.5052042007446289
Epoch: 16, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.786 Vali Acc: 0.775 Test Loss: 0.786 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.42840051651000977
Epoch: 17, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 18 cost time: 0.489879846572876
Epoch: 18, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 19 cost time: 0.4965190887451172
Epoch: 19, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
Validation loss decreased (-0.774994 --> -0.824995).  Saving model ...
Epoch: 20 cost time: 0.5079638957977295
Epoch: 20, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 0.5135941505432129
Epoch: 21, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.49614572525024414
Epoch: 22, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4844686985015869
Epoch: 23, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.523 Vali Acc: 0.775 Test Loss: 0.523 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4592466354370117
Epoch: 24, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5150468349456787
Epoch: 25, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5117733478546143
Epoch: 26, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.513 Vali Acc: 0.775 Test Loss: 0.513 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5649487972259521
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.5349500179290771
Epoch: 28, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.446 Vali Acc: 0.825 Test Loss: 0.446 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5711596012115479
Epoch: 29, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.476 Vali Acc: 0.825 Test Loss: 0.476 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4840354919433594
Epoch: 30, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.496 Vali Acc: 0.825 Test Loss: 0.496 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4233217239379883
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5678000450134277
Epoch: 32, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.507 Vali Acc: 0.825 Test Loss: 0.507 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.49646496772766113
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.471954345703125
Epoch: 34, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.48024511337280273
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.459 Vali Acc: 0.825 Test Loss: 0.459 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4609651565551758
Epoch: 36, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.424 Vali Acc: 0.825 Test Loss: 0.424 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.46947240829467773
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.397 Vali Acc: 0.825 Test Loss: 0.397 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22280452
model size : 99.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.110055446624756
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.396 Vali Acc: 0.425 Test Loss: 1.396 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.4998056888580322
Epoch: 2, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46968865394592285
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.275 Vali Acc: 0.375 Test Loss: 1.275 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5213901996612549
Epoch: 4, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.172 Vali Acc: 0.450 Test Loss: 1.172 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.44889092445373535
Epoch: 5, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.097 Vali Acc: 0.575 Test Loss: 1.097 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.5212423801422119
Epoch: 6, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 0.4647088050842285
Epoch: 7, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.935 Vali Acc: 0.600 Test Loss: 0.935 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5233578681945801
Epoch: 8, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.888 Vali Acc: 0.625 Test Loss: 0.888 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5503416061401367
Epoch: 9, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.859 Vali Acc: 0.675 Test Loss: 0.859 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.49941349029541016
Epoch: 10, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.792 Vali Acc: 0.725 Test Loss: 0.792 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5130195617675781
Epoch: 11, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 0.47722768783569336
Epoch: 12, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.51141357421875
Epoch: 13, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.4640536308288574
Epoch: 14, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5193853378295898
Epoch: 15, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5121133327484131
Epoch: 16, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.465930700302124
Epoch: 17, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.5313012599945068
Epoch: 18, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.4721333980560303
Epoch: 19, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4264693260192871
Epoch: 20, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.46739864349365234
Epoch: 21, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5740997791290283
Epoch: 22, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.49426794052124023
Epoch: 23, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.45557570457458496
Epoch: 24, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5083837509155273
Epoch: 25, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6158230304718018
Epoch: 26, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5951666831970215
Epoch: 27, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5162558555603027
Epoch: 28, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5140814781188965
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5711419582366943
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5572848320007324
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6695053577423096
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.56191086769104
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5659439563751221
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22381828
model size : 100.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2180252075195312
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.6076092720031738
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.299 Vali Acc: 0.350 Test Loss: 1.299 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5139706134796143
Epoch: 3, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.216 Vali Acc: 0.475 Test Loss: 1.216 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.4579901695251465
Epoch: 4, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.43329787254333496
Epoch: 5, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.072 Vali Acc: 0.850 Test Loss: 1.072 Test Acc: 0.850
Validation loss decreased (-0.599989 --> -0.849989).  Saving model ...
Epoch: 6 cost time: 0.46263647079467773
Epoch: 6, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.020 Vali Acc: 0.700 Test Loss: 1.020 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.46576762199401855
Epoch: 7, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4627861976623535
Epoch: 8, Steps: 3 | Train Loss: 0.908 Vali Loss: 0.916 Vali Acc: 0.900 Test Loss: 0.916 Test Acc: 0.900
Validation loss decreased (-0.849989 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 0.5686349868774414
Epoch: 9, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.442352294921875
Epoch: 10, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4457406997680664
Epoch: 11, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4587836265563965
Epoch: 12, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.685 Vali Acc: 0.900 Test Loss: 0.685 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.4678018093109131
Epoch: 13, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4970724582672119
Epoch: 14, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4982321262359619
Epoch: 15, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.524 Vali Acc: 0.900 Test Loss: 0.524 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5517990589141846
Epoch: 16, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.40643811225891113
Epoch: 17, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.42856478691101074
Epoch: 18, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.679934024810791
Epoch: 19, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.4677128791809082
Epoch: 20, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.49393534660339355
Epoch: 21, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.44099926948547363
Epoch: 22, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.385 Vali Acc: 0.825 Test Loss: 0.385 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5012021064758301
Epoch: 23, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5358173847198486
Epoch: 24, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5164952278137207
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4742567539215088
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.502396821975708
Epoch: 27, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5305020809173584
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5142796039581299
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22326532
model size : 99.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5825767517089844
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.325 Vali Acc: 0.425 Test Loss: 1.325 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.35767364501953125
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.302 Vali Acc: 0.475 Test Loss: 1.302 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.40534257888793945
Epoch: 3, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.259 Vali Acc: 0.550 Test Loss: 1.259 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.44876742362976074
Epoch: 4, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.207 Vali Acc: 0.675 Test Loss: 1.207 Test Acc: 0.675
Validation loss decreased (-0.549987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 0.48238062858581543
Epoch: 5, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.162 Vali Acc: 0.600 Test Loss: 1.162 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4288370609283447
Epoch: 6, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4384477138519287
Epoch: 7, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4018988609313965
Epoch: 8, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.42443084716796875
Epoch: 9, Steps: 3 | Train Loss: 0.954 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.4106028079986572
Epoch: 10, Steps: 3 | Train Loss: 0.943 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.45260167121887207
Epoch: 11, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.4166393280029297
Epoch: 12, Steps: 3 | Train Loss: 0.765 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.48476386070251465
Epoch: 13, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 0.40741395950317383
Epoch: 14, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.48351311683654785
Epoch: 15, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.4111347198486328
Epoch: 16, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.663 Vali Acc: 0.950 Test Loss: 0.663 Test Acc: 0.950
Validation loss decreased (-0.824993 --> -0.949993).  Saving model ...
Epoch: 17 cost time: 0.49242115020751953
Epoch: 17, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.50905442237854
Epoch: 18, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5093545913696289
Epoch: 19, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.48954153060913086
Epoch: 20, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.47319912910461426
Epoch: 21, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.47158169746398926
Epoch: 22, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4711880683898926
Epoch: 23, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4498004913330078
Epoch: 24, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4710555076599121
Epoch: 25, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4799540042877197
Epoch: 26, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4894280433654785
Epoch: 27, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5180783271789551
Epoch: 28, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.5108428001403809
Epoch: 29, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5542745590209961
Epoch: 30, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5138931274414062
Epoch: 31, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.43760204315185547
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4747762680053711
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.47911906242370605
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5399136543273926
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5477333068847656
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5395412445068359
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5421416759490967
Epoch: 38, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.4136831760406494
Epoch: 39, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.4612898826599121
Epoch: 40, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.5306758880615234
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.4877297878265381
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.950 Test Loss: 0.148 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4472634792327881
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.541597843170166
Epoch: 44, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5129115581512451
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.4685523509979248
Epoch: 46, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.46395230293273926
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.473583459854126
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.4594449996948242
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.516484260559082
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22289668
model size : 99.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.993497371673584
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.413 Vali Acc: 0.300 Test Loss: 1.413 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4257814884185791
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.390 Vali Acc: 0.300 Test Loss: 1.390 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.49974822998046875
Epoch: 3, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.316 Vali Acc: 0.325 Test Loss: 1.316 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.5982780456542969
Epoch: 4, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.222 Vali Acc: 0.450 Test Loss: 1.222 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.5872886180877686
Epoch: 5, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.48461318016052246
Epoch: 6, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.45709872245788574
Epoch: 7, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.017 Vali Acc: 0.550 Test Loss: 1.017 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 0.4382812976837158
Epoch: 8, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.549990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.4115755558013916
Epoch: 9, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.860 Vali Acc: 0.675 Test Loss: 0.860 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.34653210639953613
Epoch: 10, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.782 Vali Acc: 0.650 Test Loss: 0.782 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6012990474700928
Epoch: 11, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.4523189067840576
Epoch: 12, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.592 Vali Acc: 0.925 Test Loss: 0.592 Test Acc: 0.925
Validation loss decreased (-0.799993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.45637965202331543
Epoch: 13, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.590 Vali Acc: 0.950 Test Loss: 0.590 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.5349602699279785
Epoch: 14, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5168130397796631
Epoch: 15, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5954580307006836
Epoch: 16, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.530188798904419
Epoch: 17, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.536405086517334
Epoch: 18, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5800211429595947
Epoch: 19, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.51401686668396
Epoch: 20, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5257008075714111
Epoch: 21, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.516 Vali Acc: 0.800 Test Loss: 0.516 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5248112678527832
Epoch: 22, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.496 Vali Acc: 0.800 Test Loss: 0.496 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4905838966369629
Epoch: 23, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5609869956970215
Epoch: 24, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5101139545440674
Epoch: 25, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.509181022644043
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6056914329528809
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5730607509613037
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5714626312255859
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5279598236083984
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5545566082000732
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5888416767120361
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.5147092342376709
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.5457911491394043
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.5677037239074707
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.49817442893981934
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5383124351501465
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5412425994873047
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5453746318817139
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5182499885559082
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5033202171325684
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.4840366840362549
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5889134407043457
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5069167613983154
Epoch: 44, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5096955299377441
Epoch: 45, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22395652
model size : 100.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7782011032104492
Epoch: 1, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.445 Vali Acc: 0.200 Test Loss: 1.445 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.46808409690856934
Epoch: 2, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.409 Vali Acc: 0.300 Test Loss: 1.409 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.4575347900390625
Epoch: 3, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.341 Vali Acc: 0.425 Test Loss: 1.341 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.47502684593200684
Epoch: 4, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.269 Vali Acc: 0.550 Test Loss: 1.269 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.5648238658905029
Epoch: 5, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.213 Vali Acc: 0.550 Test Loss: 1.213 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.5435521602630615
Epoch: 6, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.158 Vali Acc: 0.625 Test Loss: 1.158 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.5572712421417236
Epoch: 7, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.110 Vali Acc: 0.675 Test Loss: 1.110 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.5072610378265381
Epoch: 8, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.043 Vali Acc: 0.750 Test Loss: 1.043 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.6011075973510742
Epoch: 9, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.975 Vali Acc: 0.725 Test Loss: 0.975 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6443643569946289
Epoch: 10, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.563058614730835
Epoch: 11, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.538538932800293
Epoch: 12, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.816 Vali Acc: 0.725 Test Loss: 0.816 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5058069229125977
Epoch: 13, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.42276525497436523
Epoch: 14, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.727 Vali Acc: 0.825 Test Loss: 0.727 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 0.5348432064056396
Epoch: 15, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.674 Vali Acc: 0.825 Test Loss: 0.674 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.5006561279296875
Epoch: 16, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.640 Vali Acc: 0.825 Test Loss: 0.640 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 17 cost time: 0.5173225402832031
Epoch: 17, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4829556941986084
Epoch: 18, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.622 Vali Acc: 0.825 Test Loss: 0.622 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 19 cost time: 0.5936920642852783
Epoch: 19, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 0.606440544128418
Epoch: 20, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.522 Vali Acc: 0.775 Test Loss: 0.522 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.49526262283325195
Epoch: 21, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.459 Vali Acc: 0.825 Test Loss: 0.459 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.4655792713165283
Epoch: 22, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 0.535576581954956
Epoch: 23, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.488675594329834
Epoch: 24, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4947845935821533
Epoch: 25, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4901771545410156
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.573 Vali Acc: 0.800 Test Loss: 0.573 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4933609962463379
Epoch: 27, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5239589214324951
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 0.5121064186096191
Epoch: 29, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 0.5605137348175049
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.5591990947723389
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.617142915725708
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5179741382598877
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5180678367614746
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.403 Vali Acc: 0.825 Test Loss: 0.403 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6092066764831543
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.825 Test Loss: 0.430 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5766687393188477
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5592384338378906
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5387382507324219
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.46844482421875
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.580418586730957
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5269839763641357
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 22340356
model size : 99.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9248244762420654
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.496 Vali Acc: 0.250 Test Loss: 1.496 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.39244866371154785
Epoch: 2, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.438 Vali Acc: 0.275 Test Loss: 1.438 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.48773980140686035
Epoch: 3, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.47595882415771484
Epoch: 4, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.339 Vali Acc: 0.350 Test Loss: 1.339 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.47631096839904785
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.292 Vali Acc: 0.350 Test Loss: 1.292 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.528937578201294
Epoch: 6, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5095160007476807
Epoch: 7, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.221 Vali Acc: 0.450 Test Loss: 1.221 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.4713137149810791
Epoch: 8, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.4869098663330078
Epoch: 9, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.155 Vali Acc: 0.450 Test Loss: 1.155 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5400757789611816
Epoch: 10, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.111 Vali Acc: 0.575 Test Loss: 1.111 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.42366719245910645
Epoch: 11, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.45281410217285156
Epoch: 12, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.027 Vali Acc: 0.650 Test Loss: 1.027 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.5344750881195068
Epoch: 13, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.46489548683166504
Epoch: 14, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4614436626434326
Epoch: 15, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.857 Vali Acc: 0.675 Test Loss: 0.857 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4520430564880371
Epoch: 16, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.825 Vali Acc: 0.650 Test Loss: 0.825 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4748983383178711
Epoch: 17, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.799 Vali Acc: 0.725 Test Loss: 0.799 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724992).  Saving model ...
Epoch: 18 cost time: 0.41289496421813965
Epoch: 18, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.4577677249908447
Epoch: 19, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 0.4918520450592041
Epoch: 20, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.657 Vali Acc: 0.775 Test Loss: 0.657 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 21 cost time: 0.5481281280517578
Epoch: 21, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 0.542492151260376
Epoch: 22, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 0.5618150234222412
Epoch: 23, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.42585039138793945
Epoch: 24, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.43857765197753906
Epoch: 25, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 0.4701414108276367
Epoch: 26, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.45911383628845215
Epoch: 27, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.5127389430999756
Epoch: 28, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47895312309265137
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.453 Vali Acc: 0.825 Test Loss: 0.453 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.38808417320251465
Epoch: 30, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4408111572265625
Epoch: 31, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4994666576385498
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4861483573913574
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4375934600830078
Epoch: 34, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4172787666320801
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4666414260864258
Epoch: 36, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.38549280166625977
Epoch: 37, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 22298884
model size : 99.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.699514389038086
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.368 Vali Acc: 0.250 Test Loss: 1.368 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.3615577220916748
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (-0.249986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.4410545825958252
Epoch: 3, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.5498659610748291
Epoch: 4, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.169 Vali Acc: 0.575 Test Loss: 1.169 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.47081971168518066
Epoch: 5, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.111 Vali Acc: 0.525 Test Loss: 1.111 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4554312229156494
Epoch: 6, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.058 Vali Acc: 0.475 Test Loss: 1.058 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4667203426361084
Epoch: 7, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
Validation loss decreased (-0.574988 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.441434383392334
Epoch: 8, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.901 Vali Acc: 0.825 Test Loss: 0.901 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.5501599311828613
Epoch: 9, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.817 Vali Acc: 0.875 Test Loss: 0.817 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.47960424423217773
Epoch: 10, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.729 Vali Acc: 0.900 Test Loss: 0.729 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.5871226787567139
Epoch: 11, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.4988062381744385
Epoch: 12, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.583 Vali Acc: 0.925 Test Loss: 0.583 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.49768924713134766
Epoch: 13, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.586 Vali Acc: 0.900 Test Loss: 0.586 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.44443821907043457
Epoch: 14, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4527609348297119
Epoch: 15, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5383608341217041
Epoch: 16, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.508894681930542
Epoch: 17, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5629019737243652
Epoch: 18, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5076587200164795
Epoch: 19, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4383430480957031
Epoch: 20, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4481337070465088
Epoch: 21, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5353703498840332
Epoch: 22, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.49036598205566406
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4925990104675293
Epoch: 24, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5228323936462402
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4200766086578369
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5380070209503174
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22418692
model size : 100.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.269763946533203
Epoch: 1, Steps: 3 | Train Loss: 1.639 Vali Loss: 1.578 Vali Acc: 0.375 Test Loss: 1.578 Test Acc: 0.375
Validation loss decreased (inf --> -0.374984).  Saving model ...
Epoch: 2 cost time: 0.49350595474243164
Epoch: 2, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.469 Vali Acc: 0.250 Test Loss: 1.469 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.444812536239624
Epoch: 3, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.403 Vali Acc: 0.275 Test Loss: 1.403 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43491148948669434
Epoch: 4, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
Validation loss decreased (-0.374984 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.45218825340270996
Epoch: 5, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.49726295471191406
Epoch: 6, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.200 Vali Acc: 0.650 Test Loss: 1.200 Test Acc: 0.650
Validation loss decreased (-0.499987 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 0.48408031463623047
Epoch: 7, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.159 Vali Acc: 0.650 Test Loss: 1.159 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.4795396327972412
Epoch: 8, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3610520362854004
Epoch: 9, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.47138524055480957
Epoch: 10, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.45714354515075684
Epoch: 11, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 0.4326028823852539
Epoch: 12, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.890 Vali Acc: 0.800 Test Loss: 0.890 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.40023350715637207
Epoch: 13, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 0.4712851047515869
Epoch: 14, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.4790616035461426
Epoch: 15, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4301464557647705
Epoch: 16, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.45746612548828125
Epoch: 17, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 0.5879249572753906
Epoch: 18, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 0.46865129470825195
Epoch: 19, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 0.43801283836364746
Epoch: 20, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.48892807960510254
Epoch: 21, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.5760452747344971
Epoch: 22, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.47999072074890137
Epoch: 23, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.5175392627716064
Epoch: 24, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.46468186378479004
Epoch: 25, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.5166854858398438
Epoch: 26, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.5003871917724609
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.46249985694885254
Epoch: 28, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4382181167602539
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4705519676208496
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.44132041931152344
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4770972728729248
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.46605873107910156
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.45087337493896484
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.45479798316955566
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.4887535572052002
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 37 cost time: 0.5327003002166748
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 38 cost time: 0.4841780662536621
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 39 cost time: 0.5651206970214844
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.4176013469696045
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4609208106994629
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5254004001617432
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5331072807312012
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5077736377716064
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.522496223449707
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5036580562591553
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5370655059814453
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.5090441703796387
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.49994778633117676
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.562420129776001
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22349572
model size : 99.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.873948574066162
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.4501643180847168
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.438 Vali Acc: 0.275 Test Loss: 1.438 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47267746925354004
Epoch: 3, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.407 Vali Acc: 0.275 Test Loss: 1.407 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4840693473815918
Epoch: 4, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.374 Vali Acc: 0.300 Test Loss: 1.374 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.4607663154602051
Epoch: 5, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5066132545471191
Epoch: 6, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.47131991386413574
Epoch: 7, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.245 Vali Acc: 0.525 Test Loss: 1.245 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.5088882446289062
Epoch: 8, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.5101268291473389
Epoch: 9, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.160 Vali Acc: 0.575 Test Loss: 1.160 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.5375838279724121
Epoch: 10, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.47329282760620117
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.075 Vali Acc: 0.800 Test Loss: 1.075 Test Acc: 0.800
Validation loss decreased (-0.599989 --> -0.799989).  Saving model ...
Epoch: 12 cost time: 0.4153175354003906
Epoch: 12, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.029 Vali Acc: 0.850 Test Loss: 1.029 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 13 cost time: 0.46085381507873535
Epoch: 13, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.993 Vali Acc: 0.825 Test Loss: 0.993 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4274437427520752
Epoch: 14, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.961 Vali Acc: 0.850 Test Loss: 0.961 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.5087237358093262
Epoch: 15, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.922 Vali Acc: 0.825 Test Loss: 0.922 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3831498622894287
Epoch: 16, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.877 Vali Acc: 0.825 Test Loss: 0.877 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4052293300628662
Epoch: 17, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.822 Vali Acc: 0.850 Test Loss: 0.822 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.4655568599700928
Epoch: 18, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.745 Vali Acc: 0.875 Test Loss: 0.745 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.4776124954223633
Epoch: 19, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.680 Vali Acc: 0.875 Test Loss: 0.680 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.48298144340515137
Epoch: 20, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.621 Vali Acc: 0.900 Test Loss: 0.621 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.4725022315979004
Epoch: 21, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.40114927291870117
Epoch: 22, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.4095346927642822
Epoch: 23, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4233393669128418
Epoch: 24, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.42812013626098633
Epoch: 25, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.42579030990600586
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4562342166900635
Epoch: 27, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4532754421234131
Epoch: 28, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5427761077880859
Epoch: 29, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.49114179611206055
Epoch: 30, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5087032318115234
Epoch: 31, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.46997880935668945
Epoch: 32, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 22317316
model size : 99.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0819458961486816
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.375 Vali Acc: 0.475 Test Loss: 1.375 Test Acc: 0.475
Validation loss decreased (inf --> -0.474986).  Saving model ...
Epoch: 2 cost time: 0.6118319034576416
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5597937107086182
Epoch: 3, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6365249156951904
Epoch: 4, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.232 Vali Acc: 0.450 Test Loss: 1.232 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.578819751739502
Epoch: 5, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.140 Vali Acc: 0.575 Test Loss: 1.140 Test Acc: 0.575
Validation loss decreased (-0.474986 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.4292888641357422
Epoch: 6, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.056 Vali Acc: 0.625 Test Loss: 1.056 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.5753319263458252
Epoch: 7, Steps: 3 | Train Loss: 0.979 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.5249605178833008
Epoch: 8, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.914 Vali Acc: 0.675 Test Loss: 0.914 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5827980041503906
Epoch: 9, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.853 Vali Acc: 0.675 Test Loss: 0.853 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5482218265533447
Epoch: 10, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.787 Vali Acc: 0.675 Test Loss: 0.787 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5488343238830566
Epoch: 11, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774993).  Saving model ...
Epoch: 12 cost time: 0.5232429504394531
Epoch: 12, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.774993 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.6246907711029053
Epoch: 13, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.5684938430786133
Epoch: 14, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.584 Vali Acc: 0.900 Test Loss: 0.584 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.546954870223999
Epoch: 15, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.4467475414276123
Epoch: 16, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5183343887329102
Epoch: 17, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.5887174606323242
Epoch: 18, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.5245926380157471
Epoch: 19, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.899996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.6141481399536133
Epoch: 20, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5378012657165527
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5672509670257568
Epoch: 22, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.49532318115234375
Epoch: 23, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.48063182830810547
Epoch: 24, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4829273223876953
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5541102886199951
Epoch: 26, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5366911888122559
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.5159590244293213
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4575974941253662
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.5187389850616455
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.45890212059020996
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5281753540039062
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.4441244602203369
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5052950382232666
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.5997774600982666
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4716026782989502
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5736095905303955
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5399534702301025
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5359055995941162
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5265209674835205
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5383744239807129
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5440552234649658
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5420167446136475
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5749235153198242
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 22395652
model size : 100.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0576441287994385
Epoch: 1, Steps: 3 | Train Loss: 1.562 Vali Loss: 1.414 Vali Acc: 0.275 Test Loss: 1.414 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.48296499252319336
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
Validation loss decreased (-0.274986 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 0.5141310691833496
Epoch: 3, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.378 Vali Acc: 0.350 Test Loss: 1.378 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4991745948791504
Epoch: 4, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.326 Vali Acc: 0.300 Test Loss: 1.326 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4551963806152344
Epoch: 5, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.42211055755615234
Epoch: 6, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.40366530418395996
Epoch: 7, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.137 Vali Acc: 0.575 Test Loss: 1.137 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.38869619369506836
Epoch: 8, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.072 Vali Acc: 0.775 Test Loss: 1.072 Test Acc: 0.775
Validation loss decreased (-0.574989 --> -0.774989).  Saving model ...
Epoch: 9 cost time: 0.5136663913726807
Epoch: 9, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.441453218460083
Epoch: 10, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.952 Vali Acc: 0.850 Test Loss: 0.952 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 11 cost time: 0.45404839515686035
Epoch: 11, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.896 Vali Acc: 0.875 Test Loss: 0.896 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.45591259002685547
Epoch: 12, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.846 Vali Acc: 0.900 Test Loss: 0.846 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 0.5021193027496338
Epoch: 13, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.791 Vali Acc: 0.900 Test Loss: 0.791 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.4817214012145996
Epoch: 14, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.724 Vali Acc: 0.875 Test Loss: 0.724 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4682180881500244
Epoch: 15, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4897792339324951
Epoch: 16, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.47089147567749023
Epoch: 17, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.5832576751708984
Epoch: 18, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.5521552562713623
Epoch: 19, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.5178236961364746
Epoch: 20, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.5332577228546143
Epoch: 21, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5328187942504883
Epoch: 22, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.5120899677276611
Epoch: 23, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 0.4880225658416748
Epoch: 24, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.5165038108825684
Epoch: 25, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.483001708984375
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.463015079498291
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4379251003265381
Epoch: 28, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.46633410453796387
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5101075172424316
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4975879192352295
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4814479351043701
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4421370029449463
Epoch: 33, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.44816064834594727
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5357363224029541
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22354180
model size : 99.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9595494270324707
Epoch: 1, Steps: 3 | Train Loss: 1.635 Vali Loss: 1.459 Vali Acc: 0.300 Test Loss: 1.459 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.42918944358825684
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.420 Vali Acc: 0.275 Test Loss: 1.420 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42346835136413574
Epoch: 3, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.401 Vali Acc: 0.275 Test Loss: 1.401 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49147987365722656
Epoch: 4, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.47871899604797363
Epoch: 5, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.339 Vali Acc: 0.325 Test Loss: 1.339 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.44355034828186035
Epoch: 6, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.302 Vali Acc: 0.425 Test Loss: 1.302 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.4315199851989746
Epoch: 7, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.259 Vali Acc: 0.525 Test Loss: 1.259 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.3836688995361328
Epoch: 8, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.44312000274658203
Epoch: 9, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.153 Vali Acc: 0.625 Test Loss: 1.153 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 0.46784114837646484
Epoch: 10, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.093 Vali Acc: 0.850 Test Loss: 1.093 Test Acc: 0.850
Validation loss decreased (-0.624988 --> -0.849989).  Saving model ...
Epoch: 11 cost time: 0.39095497131347656
Epoch: 11, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.037 Vali Acc: 0.850 Test Loss: 1.037 Test Acc: 0.850
Validation loss decreased (-0.849989 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 0.38103199005126953
Epoch: 12, Steps: 3 | Train Loss: 0.949 Vali Loss: 0.973 Vali Acc: 0.900 Test Loss: 0.973 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899990).  Saving model ...
Epoch: 13 cost time: 0.40891361236572266
Epoch: 13, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.906 Vali Acc: 0.900 Test Loss: 0.906 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.5293397903442383
Epoch: 14, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.836 Vali Acc: 0.875 Test Loss: 0.836 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.47645044326782227
Epoch: 15, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.750 Vali Acc: 0.900 Test Loss: 0.750 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.4576687812805176
Epoch: 16, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.654 Vali Acc: 0.925 Test Loss: 0.654 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 0.4734187126159668
Epoch: 17, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.45583653450012207
Epoch: 18, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.558 Vali Acc: 0.875 Test Loss: 0.558 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.49422192573547363
Epoch: 19, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.42519116401672363
Epoch: 20, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5368425846099854
Epoch: 21, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.45177507400512695
Epoch: 22, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.48764872550964355
Epoch: 23, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4710366725921631
Epoch: 24, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.49407243728637695
Epoch: 25, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4722275733947754
Epoch: 26, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22326532
model size : 99.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8148560523986816
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.410 Vali Acc: 0.350 Test Loss: 1.410 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5445585250854492
Epoch: 2, Steps: 3 | Train Loss: 1.566 Vali Loss: 1.430 Vali Acc: 0.400 Test Loss: 1.430 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.5354387760162354
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.376 Vali Acc: 0.425 Test Loss: 1.376 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.4347705841064453
Epoch: 4, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.295 Vali Acc: 0.525 Test Loss: 1.295 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.609407901763916
Epoch: 5, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.182 Vali Acc: 0.475 Test Loss: 1.182 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6387722492218018
Epoch: 6, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.6138017177581787
Epoch: 7, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.034 Vali Acc: 0.650 Test Loss: 1.034 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.5993378162384033
Epoch: 8, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.5569572448730469
Epoch: 9, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.911 Vali Acc: 0.700 Test Loss: 0.911 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5680670738220215
Epoch: 10, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.851 Vali Acc: 0.650 Test Loss: 0.851 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5700223445892334
Epoch: 11, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5382776260375977
Epoch: 12, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 0.5350477695465088
Epoch: 13, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 14 cost time: 0.6025123596191406
Epoch: 14, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.774993 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.638343095779419
Epoch: 15, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6071186065673828
Epoch: 16, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6264121532440186
Epoch: 17, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6514401435852051
Epoch: 18, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.6430361270904541
Epoch: 19, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5400285720825195
Epoch: 20, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 0.626969575881958
Epoch: 21, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.5703983306884766
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.517324686050415
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5723285675048828
Epoch: 24, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5990862846374512
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6000664234161377
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6612169742584229
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.6584162712097168
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5123472213745117
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5195145606994629
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7150774002075195
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.685431957244873
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.5810723304748535
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.5838601589202881
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6596150398254395
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7091622352600098
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.525932788848877
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5134036540985107
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5649375915527344
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.667747974395752
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6636650562286377
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6401400566101074
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5544891357421875
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22423300
model size : 100.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0761616230010986
Epoch: 1, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.410 Vali Acc: 0.150 Test Loss: 1.410 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.6079914569854736
Epoch: 2, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.426 Vali Acc: 0.150 Test Loss: 1.426 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5069658756256104
Epoch: 3, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.402 Vali Acc: 0.250 Test Loss: 1.402 Test Acc: 0.250
Validation loss decreased (-0.149986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.5750160217285156
Epoch: 4, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.355 Vali Acc: 0.350 Test Loss: 1.355 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.6280472278594971
Epoch: 5, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.562230110168457
Epoch: 6, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.4967041015625
Epoch: 7, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.183 Vali Acc: 0.450 Test Loss: 1.183 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.5313894748687744
Epoch: 8, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.5368545055389404
Epoch: 9, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.077 Vali Acc: 0.650 Test Loss: 1.077 Test Acc: 0.650
Validation loss decreased (-0.499989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.48754215240478516
Epoch: 10, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 0.6021792888641357
Epoch: 11, Steps: 3 | Train Loss: 0.828 Vali Loss: 0.986 Vali Acc: 0.775 Test Loss: 0.986 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.5470492839813232
Epoch: 12, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.935 Vali Acc: 0.825 Test Loss: 0.935 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 0.49895668029785156
Epoch: 13, Steps: 3 | Train Loss: 0.648 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 0.45790910720825195
Epoch: 14, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.836 Vali Acc: 0.825 Test Loss: 0.836 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.5194365978240967
Epoch: 15, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.5944314002990723
Epoch: 16, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 0.501030445098877
Epoch: 17, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.46950793266296387
Epoch: 18, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4799947738647461
Epoch: 19, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4273090362548828
Epoch: 20, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.5046384334564209
Epoch: 21, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 0.4616842269897461
Epoch: 22, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.5267336368560791
Epoch: 23, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.510127067565918
Epoch: 24, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.5435562133789062
Epoch: 25, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.48224949836730957
Epoch: 26, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5289058685302734
Epoch: 27, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5067856311798096
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6027555465698242
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5837616920471191
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5350484848022461
Epoch: 31, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5012738704681396
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.521075963973999
Epoch: 33, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5173194408416748
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22372612
model size : 100.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8241257667541504
Epoch: 1, Steps: 3 | Train Loss: 1.550 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.44956111907958984
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.368 Vali Acc: 0.250 Test Loss: 1.368 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.4680356979370117
Epoch: 3, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.350 Vali Acc: 0.325 Test Loss: 1.350 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.44617414474487305
Epoch: 4, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.328 Vali Acc: 0.375 Test Loss: 1.328 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4187960624694824
Epoch: 5, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.302 Vali Acc: 0.425 Test Loss: 1.302 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.464282751083374
Epoch: 6, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.275 Vali Acc: 0.550 Test Loss: 1.275 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.4348158836364746
Epoch: 7, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.244 Vali Acc: 0.600 Test Loss: 1.244 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.4585995674133301
Epoch: 8, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.208 Vali Acc: 0.575 Test Loss: 1.208 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4504549503326416
Epoch: 9, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.46027517318725586
Epoch: 10, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.124 Vali Acc: 0.700 Test Loss: 1.124 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.439739465713501
Epoch: 11, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.079 Vali Acc: 0.725 Test Loss: 1.079 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.46320486068725586
Epoch: 12, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.033 Vali Acc: 0.650 Test Loss: 1.033 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4155707359313965
Epoch: 13, Steps: 3 | Train Loss: 0.910 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5075092315673828
Epoch: 14, Steps: 3 | Train Loss: 0.862 Vali Loss: 0.961 Vali Acc: 0.650 Test Loss: 0.961 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.43517613410949707
Epoch: 15, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.912 Vali Acc: 0.650 Test Loss: 0.912 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4254729747772217
Epoch: 16, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.41611146926879883
Epoch: 17, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.43707942962646484
Epoch: 18, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.5120069980621338
Epoch: 19, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.4090769290924072
Epoch: 20, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 0.4819772243499756
Epoch: 21, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.4566762447357178
Epoch: 22, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.48673343658447266
Epoch: 23, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.44284772872924805
Epoch: 24, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4506044387817383
Epoch: 25, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.48808908462524414
Epoch: 26, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.47670578956604004
Epoch: 27, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.403 Vali Acc: 0.825 Test Loss: 0.403 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4931461811065674
Epoch: 28, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.500551700592041
Epoch: 29, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4459238052368164
Epoch: 30, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5681538581848145
Epoch: 31, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.46361804008483887
Epoch: 32, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22349572
model size : 99.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.151409864425659
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.6122879981994629
Epoch: 2, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.374 Vali Acc: 0.325 Test Loss: 1.374 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5169739723205566
Epoch: 3, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.306 Vali Acc: 0.525 Test Loss: 1.306 Test Acc: 0.525
Validation loss decreased (-0.324986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.47031354904174805
Epoch: 4, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.4896883964538574
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.181 Vali Acc: 0.625 Test Loss: 1.181 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.5047256946563721
Epoch: 6, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.133 Vali Acc: 0.800 Test Loss: 1.133 Test Acc: 0.800
Validation loss decreased (-0.624988 --> -0.799989).  Saving model ...
Epoch: 7 cost time: 0.5421087741851807
Epoch: 7, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.087 Vali Acc: 0.775 Test Loss: 1.087 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5246925354003906
Epoch: 8, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.038 Vali Acc: 0.850 Test Loss: 1.038 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 9 cost time: 0.4961678981781006
Epoch: 9, Steps: 3 | Train Loss: 0.843 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5001485347747803
Epoch: 10, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.903 Vali Acc: 0.750 Test Loss: 0.903 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5462915897369385
Epoch: 11, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.515568733215332
Epoch: 12, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.775 Vali Acc: 0.800 Test Loss: 0.775 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5561378002166748
Epoch: 13, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 0.45539283752441406
Epoch: 14, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.651 Vali Acc: 0.900 Test Loss: 0.651 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.5066285133361816
Epoch: 15, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.5792899131774902
Epoch: 16, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.5327150821685791
Epoch: 17, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5968947410583496
Epoch: 18, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5263440608978271
Epoch: 19, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5683813095092773
Epoch: 20, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.5929317474365234
Epoch: 21, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.47013378143310547
Epoch: 22, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.49486804008483887
Epoch: 23, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5254983901977539
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.46208739280700684
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6071028709411621
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5137498378753662
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4962756633758545
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5600781440734863
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5386042594909668
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.925 Test Loss: 0.175 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22427908
model size : 100.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9137330055236816
Epoch: 1, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.348 Vali Acc: 0.425 Test Loss: 1.348 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.4932832717895508
Epoch: 2, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.355 Vali Acc: 0.425 Test Loss: 1.355 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4345846176147461
Epoch: 3, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.328 Vali Acc: 0.550 Test Loss: 1.328 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.45136046409606934
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.286 Vali Acc: 0.600 Test Loss: 1.286 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.48422908782958984
Epoch: 5, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.240 Vali Acc: 0.600 Test Loss: 1.240 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.48435473442077637
Epoch: 6, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.194 Vali Acc: 0.625 Test Loss: 1.194 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.49146080017089844
Epoch: 7, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.144 Vali Acc: 0.700 Test Loss: 1.144 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.5003247261047363
Epoch: 8, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.089 Vali Acc: 0.775 Test Loss: 1.089 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774989).  Saving model ...
Epoch: 9 cost time: 0.46013331413269043
Epoch: 9, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.044 Vali Acc: 0.750 Test Loss: 1.044 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5009758472442627
Epoch: 10, Steps: 3 | Train Loss: 0.951 Vali Loss: 0.994 Vali Acc: 0.750 Test Loss: 0.994 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4399709701538086
Epoch: 11, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.945 Vali Acc: 0.800 Test Loss: 0.945 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 0.47733497619628906
Epoch: 12, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.903 Vali Acc: 0.825 Test Loss: 0.903 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 0.42160463333129883
Epoch: 13, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.862 Vali Acc: 0.825 Test Loss: 0.862 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 0.5729875564575195
Epoch: 14, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.823 Vali Acc: 0.825 Test Loss: 0.823 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.4943990707397461
Epoch: 15, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4342491626739502
Epoch: 16, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 17 cost time: 0.46747660636901855
Epoch: 17, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 18 cost time: 0.5190830230712891
Epoch: 18, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.49785637855529785
Epoch: 19, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 0.5702438354492188
Epoch: 20, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.49227380752563477
Epoch: 21, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.4752993583679199
Epoch: 22, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.3823204040527344
Epoch: 23, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4010739326477051
Epoch: 24, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4064948558807373
Epoch: 25, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4709584712982178
Epoch: 26, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.5694377422332764
Epoch: 27, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.46126675605773926
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4234349727630615
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.39685797691345215
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.41253185272216797
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4529879093170166
Epoch: 32, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.444568395614624
Epoch: 33, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4565310478210449
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4165189266204834
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.38860011100769043
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5112369060516357
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4666287899017334
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.44155001640319824
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22395652
model size : 100.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0149056911468506
Epoch: 1, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.441 Vali Acc: 0.300 Test Loss: 1.441 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4854104518890381
Epoch: 2, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.427 Vali Acc: 0.300 Test Loss: 1.427 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5288643836975098
Epoch: 3, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.413 Vali Acc: 0.350 Test Loss: 1.413 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.44785118103027344
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.4494152069091797
Epoch: 5, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.365 Vali Acc: 0.350 Test Loss: 1.365 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.4536111354827881
Epoch: 6, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.333 Vali Acc: 0.350 Test Loss: 1.333 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.4770996570587158
Epoch: 7, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.297 Vali Acc: 0.375 Test Loss: 1.297 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.4629054069519043
Epoch: 8, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.254 Vali Acc: 0.600 Test Loss: 1.254 Test Acc: 0.600
Validation loss decreased (-0.374987 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 0.47084927558898926
Epoch: 9, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.213 Vali Acc: 0.575 Test Loss: 1.213 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4824354648590088
Epoch: 10, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4459514617919922
Epoch: 11, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.128 Vali Acc: 0.650 Test Loss: 1.128 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.41069555282592773
Epoch: 12, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5109984874725342
Epoch: 13, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.058 Vali Acc: 0.750 Test Loss: 1.058 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 0.5423219203948975
Epoch: 14, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.4934401512145996
Epoch: 15, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.986 Vali Acc: 0.700 Test Loss: 0.986 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5336675643920898
Epoch: 16, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.947 Vali Acc: 0.775 Test Loss: 0.947 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.5046539306640625
Epoch: 17, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.910 Vali Acc: 0.750 Test Loss: 0.910 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.44016337394714355
Epoch: 18, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.42862653732299805
Epoch: 19, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.4795818328857422
Epoch: 20, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.701 Vali Acc: 0.875 Test Loss: 0.701 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.48940205574035645
Epoch: 21, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.618 Vali Acc: 0.875 Test Loss: 0.618 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.4056358337402344
Epoch: 22, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.554 Vali Acc: 0.875 Test Loss: 0.554 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.49198055267333984
Epoch: 23, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.47493553161621094
Epoch: 24, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.48779940605163574
Epoch: 25, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.4137125015258789
Epoch: 26, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 0.4476497173309326
Epoch: 27, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.45203590393066406
Epoch: 28, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.49918246269226074
Epoch: 29, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 0.45957207679748535
Epoch: 30, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 0.4262244701385498
Epoch: 31, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.4507584571838379
Epoch: 32, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.5016188621520996
Epoch: 33, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4847114086151123
Epoch: 34, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.5062973499298096
Epoch: 35, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.42369842529296875
Epoch: 36, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4460930824279785
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4548146724700928
Epoch: 38, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4360015392303467
Epoch: 39, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.5086371898651123
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 0.519087553024292
Epoch: 41, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.44835472106933594
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.5466883182525635
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.4618372917175293
Epoch: 44, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 0.48899078369140625
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 0.48237037658691406
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 47 cost time: 0.4927399158477783
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4567146301269531
Epoch: 48, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4307749271392822
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.4568006992340088
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22372612
model size : 100.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.033769130706787
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.412 Vali Acc: 0.300 Test Loss: 1.412 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.47392868995666504
Epoch: 2, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5663549900054932
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.324 Vali Acc: 0.475 Test Loss: 1.324 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.5693683624267578
Epoch: 4, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.260 Vali Acc: 0.450 Test Loss: 1.260 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5539124011993408
Epoch: 5, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.190 Vali Acc: 0.550 Test Loss: 1.190 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.5419681072235107
Epoch: 6, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.5887866020202637
Epoch: 7, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5699622631072998
Epoch: 8, Steps: 3 | Train Loss: 0.992 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.49074745178222656
Epoch: 9, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.5467534065246582
Epoch: 10, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 0.4367485046386719
Epoch: 11, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.4933021068572998
Epoch: 12, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.4977750778198242
Epoch: 13, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 0.43825650215148926
Epoch: 14, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.49666500091552734
Epoch: 15, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5543897151947021
Epoch: 16, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.5090422630310059
Epoch: 17, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5310869216918945
Epoch: 18, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6167421340942383
Epoch: 19, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.46477651596069336
Epoch: 20, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.924997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.5703079700469971
Epoch: 21, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.45247650146484375
Epoch: 22, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.5106382369995117
Epoch: 23, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.549100399017334
Epoch: 24, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.42557406425476074
Epoch: 25, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4711947441101074
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.36146044731140137
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.6182971000671387
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4117860794067383
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5110142230987549
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.514312744140625
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 32 cost time: 0.4687988758087158
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.4905731678009033
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.43953371047973633
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.4738435745239258
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.5776121616363525
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.46541500091552734
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4914529323577881
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5635075569152832
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4783027172088623
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5578603744506836
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5257589817047119
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4076673984527588
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5727136135101318
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5197863578796387
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22469380
model size : 100.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9579169750213623
Epoch: 1, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.428 Vali Acc: 0.225 Test Loss: 1.428 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.39590024948120117
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.398 Vali Acc: 0.275 Test Loss: 1.398 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.3850698471069336
Epoch: 3, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.4689474105834961
Epoch: 4, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.44354772567749023
Epoch: 5, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.288 Vali Acc: 0.575 Test Loss: 1.288 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.46101880073547363
Epoch: 6, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.48094677925109863
Epoch: 7, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.165 Vali Acc: 0.600 Test Loss: 1.165 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.4940667152404785
Epoch: 8, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.101 Vali Acc: 0.625 Test Loss: 1.101 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.46545863151550293
Epoch: 9, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 0.42918920516967773
Epoch: 10, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.46561646461486816
Epoch: 11, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.934 Vali Acc: 0.700 Test Loss: 0.934 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.5013952255249023
Epoch: 12, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.890 Vali Acc: 0.725 Test Loss: 0.890 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.4532146453857422
Epoch: 13, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.4996955394744873
Epoch: 14, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.5316958427429199
Epoch: 15, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43786025047302246
Epoch: 16, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.44773340225219727
Epoch: 17, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 0.4690394401550293
Epoch: 18, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.38005566596984863
Epoch: 19, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3793754577636719
Epoch: 20, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4334695339202881
Epoch: 21, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.5514130592346191
Epoch: 22, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.899996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.5097596645355225
Epoch: 23, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5138092041015625
Epoch: 24, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.4723639488220215
Epoch: 25, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5749623775482178
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4341716766357422
Epoch: 27, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.47351956367492676
Epoch: 28, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4726884365081787
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4792916774749756
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4934253692626953
Epoch: 31, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.48220300674438477
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4650845527648926
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4865119457244873
Epoch: 34, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5033559799194336
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.48896265029907227
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5223848819732666
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.554163932800293
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.47476768493652344
Epoch: 39, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.42888498306274414
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.565624475479126
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4298593997955322
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4449951648712158
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.448136568069458
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.46224021911621094
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5141010284423828
Epoch: 46, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.44064950942993164
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22432516
model size : 100.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0451242923736572
Epoch: 1, Steps: 3 | Train Loss: 1.581 Vali Loss: 1.445 Vali Acc: 0.075 Test Loss: 1.445 Test Acc: 0.075
Validation loss decreased (inf --> -0.074986).  Saving model ...
Epoch: 2 cost time: 0.45789217948913574
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.421 Vali Acc: 0.100 Test Loss: 1.421 Test Acc: 0.100
Validation loss decreased (-0.074986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.46216392517089844
Epoch: 3, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.404 Vali Acc: 0.125 Test Loss: 1.404 Test Acc: 0.125
Validation loss decreased (-0.099986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 0.49434590339660645
Epoch: 4, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.380 Vali Acc: 0.125 Test Loss: 1.380 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 5 cost time: 0.40897488594055176
Epoch: 5, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.354 Vali Acc: 0.300 Test Loss: 1.354 Test Acc: 0.300
Validation loss decreased (-0.124986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.4322683811187744
Epoch: 6, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.4724123477935791
Epoch: 7, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.290 Vali Acc: 0.550 Test Loss: 1.290 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.40604233741760254
Epoch: 8, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.258 Vali Acc: 0.575 Test Loss: 1.258 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 0.443279504776001
Epoch: 9, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.215 Vali Acc: 0.550 Test Loss: 1.215 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5219240188598633
Epoch: 10, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.175 Vali Acc: 0.600 Test Loss: 1.175 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.4391655921936035
Epoch: 11, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.4161393642425537
Epoch: 12, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.4240243434906006
Epoch: 13, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.034 Vali Acc: 0.650 Test Loss: 1.034 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.43910884857177734
Epoch: 14, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.44872140884399414
Epoch: 15, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.913 Vali Acc: 0.675 Test Loss: 0.913 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4466710090637207
Epoch: 16, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.842 Vali Acc: 0.700 Test Loss: 0.842 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699992).  Saving model ...
Epoch: 17 cost time: 0.42514896392822266
Epoch: 17, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.774 Vali Acc: 0.725 Test Loss: 0.774 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 18 cost time: 0.4781019687652588
Epoch: 18, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 0.570913553237915
Epoch: 19, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 0.46268773078918457
Epoch: 20, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
Validation loss decreased (-0.749993 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.40419983863830566
Epoch: 21, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.45656323432922363
Epoch: 22, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.4970545768737793
Epoch: 23, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
Validation loss decreased (-0.849995 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.5231151580810547
Epoch: 24, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.49007105827331543
Epoch: 25, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.46453428268432617
Epoch: 26, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.49715638160705566
Epoch: 27, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4460620880126953
Epoch: 28, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4530045986175537
Epoch: 29, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.4546799659729004
Epoch: 30, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.4734194278717041
Epoch: 31, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.48894762992858887
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4850647449493408
Epoch: 33, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4487307071685791
Epoch: 34, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.49799346923828125
Epoch: 35, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.47982335090637207
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5861818790435791
Epoch: 37, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4857826232910156
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.49451470375061035
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.48666834831237793
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.48403310775756836
Epoch: 41, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_GPT4TS_UEA_ftM_sl100_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 22414084
model size : 100.17MB
