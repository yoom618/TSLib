Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0307624340057373
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.37659549713134766
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.44331979751586914
Epoch: 3, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.130 Vali Acc: 0.133 Test Loss: 1.130 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4018418788909912
Epoch: 4, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.42288970947265625
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4361395835876465
Epoch: 6, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.38559508323669434
Epoch: 7, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4331049919128418
Epoch: 8, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4379730224609375
Epoch: 9, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.44330596923828125
Epoch: 10, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.44494152069091797
Epoch: 11, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4217691421508789
Epoch: 12, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3547966480255127
Epoch: 13, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.45209836959838867
Epoch: 14, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4254179000854492
Epoch: 15, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43786096572875977
Epoch: 16, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4440619945526123
Epoch: 17, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4522542953491211
Epoch: 18, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.40087366104125977
Epoch: 19, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4090554714202881
Epoch: 20, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.43529534339904785
Epoch: 21, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.41178226470947266
Epoch: 22, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4183051586151123
Epoch: 23, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4126620292663574
Epoch: 24, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44671491
model size : 185.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9963264465332031
Epoch: 1, Steps: 1 | Train Loss: 1.327 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36925601959228516
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3683748245239258
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.42629528045654297
Epoch: 4, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3999969959259033
Epoch: 5, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4059748649597168
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.40458178520202637
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.41411852836608887
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.40931200981140137
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.41629528999328613
Epoch: 10, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3910484313964844
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.48382043838500977
Epoch: 12, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.40336060523986816
Epoch: 13, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.3830878734588623
Epoch: 14, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.43857502937316895
Epoch: 15, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.42504072189331055
Epoch: 16, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.40181732177734375
Epoch: 17, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3934478759765625
Epoch: 18, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3637676239013672
Epoch: 19, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.34729909896850586
Epoch: 20, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.39122509956359863
Epoch: 21, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4134998321533203
Epoch: 22, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.43328857421875
Epoch: 23, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4116485118865967
Epoch: 24, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3917529582977295
Epoch: 25, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.44110727310180664
Epoch: 26, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3896181583404541
Epoch: 27, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.40488290786743164
Epoch: 28, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.42121148109436035
Epoch: 29, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.38353586196899414
Epoch: 30, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44487171
model size : 184.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9098618030548096
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36885523796081543
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.135 Vali Acc: 0.133 Test Loss: 1.135 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3708763122558594
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38074350357055664
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3599832057952881
Epoch: 5, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.37328219413757324
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4772486686706543
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3680737018585205
Epoch: 8, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3772287368774414
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.129 Vali Acc: 0.133 Test Loss: 1.129 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3902444839477539
Epoch: 10, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4479496479034424
Epoch: 11, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.3977677822113037
Epoch: 12, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.42319774627685547
Epoch: 13, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.34646105766296387
Epoch: 14, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.41729283332824707
Epoch: 15, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4405965805053711
Epoch: 16, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.37812209129333496
Epoch: 17, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.3727731704711914
Epoch: 18, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3902266025543213
Epoch: 19, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.38730359077453613
Epoch: 20, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.3893923759460449
Epoch: 21, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.38478636741638184
Epoch: 22, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.36805200576782227
Epoch: 23, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.39667272567749023
Epoch: 24, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.3959238529205322
Epoch: 25, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 0.3612709045410156
Epoch: 26, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3837924003601074
Epoch: 27, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.3668403625488281
Epoch: 28, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.3843066692352295
Epoch: 29, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.3457658290863037
Epoch: 30, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.368682861328125
Epoch: 31, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4189643859863281
Epoch: 32, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.38987255096435547
Epoch: 33, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.36660003662109375
Epoch: 34, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.37986254692077637
Epoch: 35, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44395011
model size : 184.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7973198890686035
Epoch: 1, Steps: 1 | Train Loss: 1.333 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4462919235229492
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40068912506103516
Epoch: 3, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43340420722961426
Epoch: 4, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.37215161323547363
Epoch: 5, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4327433109283447
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4583323001861572
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3810279369354248
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4185466766357422
Epoch: 9, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4361441135406494
Epoch: 10, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.41744446754455566
Epoch: 11, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.3762640953063965
Epoch: 12, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.42591381072998047
Epoch: 13, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.38592958450317383
Epoch: 14, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3663976192474365
Epoch: 15, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.3754708766937256
Epoch: 16, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4534122943878174
Epoch: 17, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.3702971935272217
Epoch: 18, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.40876221656799316
Epoch: 19, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.3776860237121582
Epoch: 20, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.3709392547607422
Epoch: 21, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.38138794898986816
Epoch: 22, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 44686851
model size : 185.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9236738681793213
Epoch: 1, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3227529525756836
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.32594990730285645
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.3426938056945801
Epoch: 4, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.39971923828125
Epoch: 5, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.38872694969177246
Epoch: 6, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.37239718437194824
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3626556396484375
Epoch: 8, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.3585238456726074
Epoch: 9, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.3746781349182129
Epoch: 10, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.3371293544769287
Epoch: 11, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.42165112495422363
Epoch: 12, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.3573770523071289
Epoch: 13, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.35300421714782715
Epoch: 14, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.35469913482666016
Epoch: 15, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44521731
model size : 184.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1640167236328125
Epoch: 1, Steps: 1 | Train Loss: 1.626 Vali Loss: 1.381 Vali Acc: 0.333 Test Loss: 1.381 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.4104137420654297
Epoch: 2, Steps: 1 | Train Loss: 1.357 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4240422248840332
Epoch: 3, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.456024169921875
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.443040132522583
Epoch: 5, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4046132564544678
Epoch: 6, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4295215606689453
Epoch: 7, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.46399855613708496
Epoch: 8, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4114048480987549
Epoch: 9, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4010148048400879
Epoch: 10, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.41603970527648926
Epoch: 11, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.48924684524536133
Epoch: 12, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.41785407066345215
Epoch: 13, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44433411
model size : 184.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9852969646453857
Epoch: 1, Steps: 1 | Train Loss: 1.396 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4067707061767578
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3597283363342285
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3776061534881592
Epoch: 4, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3516724109649658
Epoch: 5, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4156060218811035
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.3974955081939697
Epoch: 7, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4225494861602783
Epoch: 8, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4142630100250244
Epoch: 9, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4568941593170166
Epoch: 10, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4344780445098877
Epoch: 11, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.40276217460632324
Epoch: 12, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.4387378692626953
Epoch: 13, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.41221070289611816
Epoch: 14, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4105648994445801
Epoch: 15, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4241626262664795
Epoch: 16, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.4829580783843994
Epoch: 17, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3901236057281494
Epoch: 18, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4213271141052246
Epoch: 19, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.48178815841674805
Epoch: 20, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.40395236015319824
Epoch: 21, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.43366169929504395
Epoch: 22, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.40612196922302246
Epoch: 23, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.44522714614868164
Epoch: 24, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4696230888366699
Epoch: 25, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.44044995307922363
Epoch: 26, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44712195
model size : 185.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.792698621749878
Epoch: 1, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.38496828079223633
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.3647270202636719
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.34688735008239746
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.342907190322876
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.43342089653015137
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.39372825622558594
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.462022066116333
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.40618181228637695
Epoch: 9, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4357414245605469
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4283277988433838
Epoch: 11, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4484977722167969
Epoch: 12, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.42981934547424316
Epoch: 13, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5208709239959717
Epoch: 14, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5507359504699707
Epoch: 15, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5150179862976074
Epoch: 16, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4778451919555664
Epoch: 17, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.47983288764953613
Epoch: 18, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44550915
model size : 184.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0534238815307617
Epoch: 1, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.43617916107177734
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.39415478706359863
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4295928478240967
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4209620952606201
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.4681577682495117
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.39632368087768555
Epoch: 7, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3843648433685303
Epoch: 8, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4679865837097168
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5185110569000244
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.4806356430053711
Epoch: 11, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.44264984130859375
Epoch: 12, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.36676740646362305
Epoch: 13, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.4335355758666992
Epoch: 14, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.46753859519958496
Epoch: 15, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4726741313934326
Epoch: 16, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5041694641113281
Epoch: 17, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.44034647941589355
Epoch: 18, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.49514150619506836
Epoch: 19, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.43328332901000977
Epoch: 20, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4970719814300537
Epoch: 21, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4233975410461426
Epoch: 22, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4166872501373291
Epoch: 23, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44466435
model size : 184.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps114_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.206258773803711
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5566098690032959
Epoch: 2, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4992101192474365
Epoch: 3, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47423696517944336
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4310333728790283
Epoch: 5, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5174849033355713
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4793834686279297
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5000290870666504
Epoch: 8, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.428239107131958
Epoch: 9, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.44555068016052246
Epoch: 10, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.45531582832336426
Epoch: 11, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.45531678199768066
Epoch: 12, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.48032426834106445
Epoch: 13, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.051 Vali Acc: 0.267 Test Loss: 1.051 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5122992992401123
Epoch: 14, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5198013782501221
Epoch: 15, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4819149971008301
Epoch: 16, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4476149082183838
Epoch: 17, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps114_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44746755
model size : 185.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps114_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0210235118865967
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4496767520904541
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.42982053756713867
Epoch: 3, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4210348129272461
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.43648838996887207
Epoch: 5, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4332289695739746
Epoch: 6, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.3840649127960205
Epoch: 7, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.40630388259887695
Epoch: 8, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.4605567455291748
Epoch: 9, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 10 cost time: 0.44341325759887695
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.149 Vali Acc: 0.067 Test Loss: 1.149 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45979833602905273
Epoch: 11, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 12 cost time: 0.43015384674072266
Epoch: 12, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 13 cost time: 0.4491994380950928
Epoch: 13, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4321880340576172
Epoch: 14, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.46439075469970703
Epoch: 15, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4046337604522705
Epoch: 16, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.42068982124328613
Epoch: 17, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.4036431312561035
Epoch: 18, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.39520883560180664
Epoch: 19, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4086296558380127
Epoch: 20, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.3974611759185791
Epoch: 21, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.39376020431518555
Epoch: 22, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.37379932403564453
Epoch: 23, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 0.419053316116333
Epoch: 24, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.46628642082214355
Epoch: 25, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 0.3988614082336426
Epoch: 26, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4434957504272461
Epoch: 27, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.3931865692138672
Epoch: 28, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4437863826751709
Epoch: 29, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.42948102951049805
Epoch: 30, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.328 Vali Acc: 0.333 Test Loss: 1.328 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4595375061035156
Epoch: 31, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.365 Vali Acc: 0.333 Test Loss: 1.365 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.41077184677124023
Epoch: 32, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.45757365226745605
Epoch: 33, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.445 Vali Acc: 0.400 Test Loss: 1.445 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.42991113662719727
Epoch: 34, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.484 Vali Acc: 0.400 Test Loss: 1.484 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5090351104736328
Epoch: 35, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.526 Vali Acc: 0.467 Test Loss: 1.526 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466651).  Saving model ...
Epoch: 36 cost time: 0.42517590522766113
Epoch: 36, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.568 Vali Acc: 0.467 Test Loss: 1.568 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4113452434539795
Epoch: 37, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.609 Vali Acc: 0.467 Test Loss: 1.609 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4600107669830322
Epoch: 38, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.651 Vali Acc: 0.467 Test Loss: 1.651 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4196150302886963
Epoch: 39, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.693 Vali Acc: 0.467 Test Loss: 1.693 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.43262219429016113
Epoch: 40, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.733 Vali Acc: 0.467 Test Loss: 1.733 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.43932509422302246
Epoch: 41, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.772 Vali Acc: 0.467 Test Loss: 1.772 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.46015381813049316
Epoch: 42, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.467 Test Loss: 1.808 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4154958724975586
Epoch: 43, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.467 Test Loss: 1.841 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.4193298816680908
Epoch: 44, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.870 Vali Acc: 0.467 Test Loss: 1.870 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.4188365936279297
Epoch: 45, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.897 Vali Acc: 0.400 Test Loss: 1.897 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps114_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44589315
model size : 184.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps114_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.020136833190918
Epoch: 1, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.40137290954589844
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.133322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.38680386543273926
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.43267130851745605
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.38178348541259766
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.46059393882751465
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.36690258979797363
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.42005109786987305
Epoch: 8, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.3580152988433838
Epoch: 9, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4414217472076416
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.41994810104370117
Epoch: 11, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.39927029609680176
Epoch: 12, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.3484940528869629
Epoch: 13, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps114_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44508675
model size : 184.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1361911296844482
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4321143627166748
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42044544219970703
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.38518214225769043
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4389035701751709
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.430391788482666
Epoch: 6, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4534165859222412
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4333045482635498
Epoch: 8, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4066638946533203
Epoch: 9, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4612302780151367
Epoch: 10, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.47955799102783203
Epoch: 11, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47690844535827637
Epoch: 12, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.46198344230651855
Epoch: 13, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.45566320419311523
Epoch: 14, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.42958712577819824
Epoch: 15, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4038076400756836
Epoch: 16, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4459495544433594
Epoch: 17, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.41670680046081543
Epoch: 18, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4445023536682129
Epoch: 19, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4612410068511963
Epoch: 20, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44790531
model size : 185.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.147277355194092
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.43611907958984375
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.4129812717437744
Epoch: 3, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4555048942565918
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4172232151031494
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4702033996582031
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.40507054328918457
Epoch: 7, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4644343852996826
Epoch: 8, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.45458269119262695
Epoch: 9, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.101 Vali Acc: 0.133 Test Loss: 1.101 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.3786635398864746
Epoch: 10, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.39903831481933594
Epoch: 11, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.40477871894836426
Epoch: 12, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44636931
model size : 184.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8275561332702637
Epoch: 1, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5138061046600342
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.47351884841918945
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.42508697509765625
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.48401308059692383
Epoch: 5, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.45171189308166504
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.47542667388916016
Epoch: 7, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4352843761444092
Epoch: 8, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4168543815612793
Epoch: 9, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4711589813232422
Epoch: 10, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5033464431762695
Epoch: 11, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.48536205291748047
Epoch: 12, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4720327854156494
Epoch: 13, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.48172521591186523
Epoch: 14, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5296428203582764
Epoch: 15, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4859600067138672
Epoch: 16, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4276103973388672
Epoch: 17, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.46009349822998047
Epoch: 18, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5299363136291504
Epoch: 19, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 0.4310171604156494
Epoch: 20, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.44878125190734863
Epoch: 21, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5107448101043701
Epoch: 22, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4568812847137451
Epoch: 23, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.47904539108276367
Epoch: 24, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5600311756134033
Epoch: 25, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5382785797119141
Epoch: 26, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.39961743354797363
Epoch: 27, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4105198383331299
Epoch: 28, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.4667043685913086
Epoch: 29, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 30 cost time: 0.48804712295532227
Epoch: 30, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4307262897491455
Epoch: 31, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5222513675689697
Epoch: 32, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.45250415802001953
Epoch: 33, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4617781639099121
Epoch: 34, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.43509602546691895
Epoch: 35, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.46367430686950684
Epoch: 36, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.517341136932373
Epoch: 37, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.47557592391967773
Epoch: 38, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.47307300567626953
Epoch: 39, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44560131
model size : 184.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.932835340499878
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4318995475769043
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.4441397190093994
Epoch: 3, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.5068271160125732
Epoch: 4, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4574246406555176
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.44794249534606934
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.49855637550354004
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4364655017852783
Epoch: 8, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4791724681854248
Epoch: 9, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.43817615509033203
Epoch: 10, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4442877769470215
Epoch: 11, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.507164716720581
Epoch: 12, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4228665828704834
Epoch: 13, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.001 Vali Acc: 0.400 Test Loss: 1.001 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 44817411
model size : 185.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0602407455444336
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.35948681831359863
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3994419574737549
Epoch: 3, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3795187473297119
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4191465377807617
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3859391212463379
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.48203110694885254
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4503486156463623
Epoch: 8, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.45693421363830566
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.479097843170166
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.42818117141723633
Epoch: 11, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3759925365447998
Epoch: 12, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4320638179779053
Epoch: 13, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.46486687660217285
Epoch: 14, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4852433204650879
Epoch: 15, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4207937717437744
Epoch: 16, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.39186573028564453
Epoch: 17, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.43291568756103516
Epoch: 18, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44675331
model size : 185.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9990580081939697
Epoch: 1, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4105188846588135
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40550875663757324
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43187403678894043
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.39775729179382324
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4520273208618164
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.48378849029541016
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4591703414916992
Epoch: 8, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4190957546234131
Epoch: 9, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4299662113189697
Epoch: 10, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4391343593597412
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44606211
model size : 184.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps132_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2985377311706543
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.5056371688842773
Epoch: 2, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5383517742156982
Epoch: 3, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5256450176239014
Epoch: 4, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4757351875305176
Epoch: 5, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.48567795753479004
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.43389129638671875
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4615969657897949
Epoch: 8, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.4612548351287842
Epoch: 9, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45459818840026855
Epoch: 10, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4689211845397949
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49016737937927246
Epoch: 12, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.49335479736328125
Epoch: 13, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.510056734085083
Epoch: 14, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4476289749145508
Epoch: 15, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.506248950958252
Epoch: 16, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5410308837890625
Epoch: 17, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.48037052154541016
Epoch: 18, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5278103351593018
Epoch: 19, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5301663875579834
Epoch: 20, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4404902458190918
Epoch: 21, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5108981132507324
Epoch: 22, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4483001232147217
Epoch: 23, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps132_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 44870403
model size : 185.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2483527660369873
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4334530830383301
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5059826374053955
Epoch: 3, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.42052197456359863
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.41035962104797363
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4250974655151367
Epoch: 6, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3964080810546875
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.46808886528015137
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.415435791015625
Epoch: 9, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5538966655731201
Epoch: 10, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3966233730316162
Epoch: 11, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4523656368255615
Epoch: 12, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.4534413814544678
Epoch: 13, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4053921699523926
Epoch: 14, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5243854522705078
Epoch: 15, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4443697929382324
Epoch: 16, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.41396069526672363
Epoch: 17, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.43637609481811523
Epoch: 18, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.44933414459228516
Epoch: 19, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.41543006896972656
Epoch: 20, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4535965919494629
Epoch: 21, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.3907663822174072
Epoch: 22, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44732163
model size : 185.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps132_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.969407558441162
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4034593105316162
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4557955265045166
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.39319944381713867
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.40018367767333984
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.37817835807800293
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.38597583770751953
Epoch: 7, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5006394386291504
Epoch: 8, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.39530444145202637
Epoch: 9, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.39478206634521484
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4196436405181885
Epoch: 11, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3760402202606201
Epoch: 12, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3629128932952881
Epoch: 13, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4093058109283447
Epoch: 14, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4259519577026367
Epoch: 15, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5143628120422363
Epoch: 16, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.468045711517334
Epoch: 17, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps132_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44663043
model size : 185.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps139_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8117890357971191
Epoch: 1, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.41800403594970703
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4554145336151123
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4239490032196045
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.449690580368042
Epoch: 5, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4807624816894531
Epoch: 6, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.42241811752319336
Epoch: 7, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49042439460754395
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.47100329399108887
Epoch: 9, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.47924184799194336
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.44937562942504883
Epoch: 11, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4264998435974121
Epoch: 12, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.3909883499145508
Epoch: 13, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4180927276611328
Epoch: 14, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.41287827491760254
Epoch: 15, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.3969151973724365
Epoch: 16, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps139_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 44919555
model size : 186.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps139_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.288951873779297
Epoch: 1, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3764629364013672
Epoch: 2, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.4181044101715088
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.200 Vali Acc: 0.133 Test Loss: 1.200 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.42751049995422363
Epoch: 4, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4642810821533203
Epoch: 5, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.241 Vali Acc: 0.200 Test Loss: 1.241 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.39399242401123047
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5122509002685547
Epoch: 7, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5155377388000488
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.45880794525146484
Epoch: 9, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.174 Vali Acc: 0.133 Test Loss: 1.174 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4019002914428711
Epoch: 10, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.38685011863708496
Epoch: 11, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.40755343437194824
Epoch: 12, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps139_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 44788995
model size : 185.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps139_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0234696865081787
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3587965965270996
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3689877986907959
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.37859296798706055
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.45209455490112305
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.43608975410461426
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4454178810119629
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4919278621673584
Epoch: 8, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5015041828155518
Epoch: 9, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4075949192047119
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.40813446044921875
Epoch: 11, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4947943687438965
Epoch: 12, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.5041496753692627
Epoch: 13, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5176963806152344
Epoch: 14, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.39073801040649414
Epoch: 15, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.42345166206359863
Epoch: 16, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3982250690460205
Epoch: 17, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4277682304382324
Epoch: 18, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5108802318572998
Epoch: 19, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4318399429321289
Epoch: 20, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.42497706413269043
Epoch: 21, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.47733497619628906
Epoch: 22, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.564659595489502
Epoch: 23, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4976387023925781
Epoch: 24, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5206327438354492
Epoch: 25, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.49307870864868164
Epoch: 26, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 27 cost time: 0.43863940238952637
Epoch: 27, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.184 Vali Acc: 0.533 Test Loss: 1.184 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 28 cost time: 0.43663835525512695
Epoch: 28, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.189 Vali Acc: 0.533 Test Loss: 1.189 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4132575988769531
Epoch: 29, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.196 Vali Acc: 0.533 Test Loss: 1.196 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.42250490188598633
Epoch: 30, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.206 Vali Acc: 0.533 Test Loss: 1.206 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.3815648555755615
Epoch: 31, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.218 Vali Acc: 0.533 Test Loss: 1.218 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4765899181365967
Epoch: 32, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.233 Vali Acc: 0.533 Test Loss: 1.233 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.45338892936706543
Epoch: 33, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.249 Vali Acc: 0.533 Test Loss: 1.249 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.464191198348999
Epoch: 34, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.267 Vali Acc: 0.533 Test Loss: 1.267 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.46432042121887207
Epoch: 35, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.287 Vali Acc: 0.533 Test Loss: 1.287 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4466135501861572
Epoch: 36, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.309 Vali Acc: 0.533 Test Loss: 1.309 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.45694875717163086
Epoch: 37, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.332 Vali Acc: 0.533 Test Loss: 1.332 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps139_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44723715
model size : 185.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps148_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8122777938842773
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4027442932128906
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5122873783111572
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.3704068660736084
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3836181163787842
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4182925224304199
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4012794494628906
Epoch: 7, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.094 Vali Acc: 0.133 Test Loss: 1.094 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4029862880706787
Epoch: 8, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4279768466949463
Epoch: 9, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.41887855529785156
Epoch: 10, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.42955875396728516
Epoch: 11, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.41870903968811035
Epoch: 12, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3892035484313965
Epoch: 13, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.45085716247558594
Epoch: 14, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.4820399284362793
Epoch: 15, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.40927982330322266
Epoch: 16, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4300496578216553
Epoch: 17, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.40648412704467773
Epoch: 18, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4853489398956299
Epoch: 19, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.40067481994628906
Epoch: 20, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.43497633934020996
Epoch: 21, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4842851161956787
Epoch: 22, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5228075981140137
Epoch: 23, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.45616936683654785
Epoch: 24, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4900815486907959
Epoch: 25, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4740793704986572
Epoch: 26, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.48984622955322266
Epoch: 27, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps148_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44987139
model size : 186.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps148_str74_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8882479667663574
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.35964298248291016
Epoch: 2, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39376235008239746
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4066760540008545
Epoch: 4, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4093797206878662
Epoch: 5, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.428483247756958
Epoch: 6, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3922550678253174
Epoch: 7, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.368405818939209
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.3973522186279297
Epoch: 9, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.39955615997314453
Epoch: 10, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.44664978981018066
Epoch: 11, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.425922155380249
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.49541497230529785
Epoch: 13, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4521205425262451
Epoch: 14, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4681274890899658
Epoch: 15, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4994020462036133
Epoch: 16, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.41977691650390625
Epoch: 17, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.48626017570495605
Epoch: 18, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.42159128189086914
Epoch: 19, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.45261549949645996
Epoch: 20, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps148_str74_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44864259
model size : 185.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps148_str148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2415335178375244
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.43764543533325195
Epoch: 2, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4309508800506592
Epoch: 3, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3702409267425537
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.40723299980163574
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49123668670654297
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4878385066986084
Epoch: 7, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4682190418243408
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.41463184356689453
Epoch: 9, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4194629192352295
Epoch: 10, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.40254712104797363
Epoch: 11, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5125868320465088
Epoch: 12, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.41371750831604004
Epoch: 13, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4390435218811035
Epoch: 14, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.45549893379211426
Epoch: 15, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3962891101837158
Epoch: 16, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.5507938861846924
Epoch: 17, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.469970703125
Epoch: 18, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.40564465522766113
Epoch: 19, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.5654664039611816
Epoch: 20, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5346307754516602
Epoch: 21, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.44692516326904297
Epoch: 22, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 23 cost time: 0.42656493186950684
Epoch: 23, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.459993839263916
Epoch: 24, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4551854133605957
Epoch: 25, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4163808822631836
Epoch: 26, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4523179531097412
Epoch: 27, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.41878485679626465
Epoch: 28, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4275474548339844
Epoch: 29, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.45702219009399414
Epoch: 30, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.48726797103881836
Epoch: 31, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.42702507972717285
Epoch: 32, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps148_str148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 44802819
model size : 185.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps157_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0455682277679443
Epoch: 1, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.139 Vali Acc: 0.533 Test Loss: 1.139 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.4060699939727783
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.435499906539917
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4332098960876465
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4432709217071533
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4231541156768799
Epoch: 6, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.39142704010009766
Epoch: 7, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4230968952178955
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5173091888427734
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5097677707672119
Epoch: 10, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.49738025665283203
Epoch: 11, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps157_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 45050883
model size : 186.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps157_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9627954959869385
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.38113880157470703
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4097769260406494
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4399080276489258
Epoch: 4, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5390496253967285
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4389159679412842
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4808313846588135
Epoch: 7, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.47582149505615234
Epoch: 8, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4250528812408447
Epoch: 9, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4762396812438965
Epoch: 10, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.445817232131958
Epoch: 11, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4065067768096924
Epoch: 12, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43697166442871094
Epoch: 13, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5009968280792236
Epoch: 14, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4284489154815674
Epoch: 15, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.38460516929626465
Epoch: 16, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4791080951690674
Epoch: 17, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.5463056564331055
Epoch: 18, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.3930685520172119
Epoch: 19, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.038 Vali Acc: 0.667 Test Loss: 1.038 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 20 cost time: 0.45149898529052734
Epoch: 20, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.37274789810180664
Epoch: 21, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4417455196380615
Epoch: 22, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4197697639465332
Epoch: 23, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.40601015090942383
Epoch: 24, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4112358093261719
Epoch: 25, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.3955569267272949
Epoch: 26, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.3757925033569336
Epoch: 27, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4227888584136963
Epoch: 28, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.40871477127075195
Epoch: 29, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps157_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 44939523
model size : 186.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps157_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9857690334320068
Epoch: 1, Steps: 1 | Train Loss: 1.297 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.420208215713501
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.41332268714904785
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5017309188842773
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4174647331237793
Epoch: 5, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.40102553367614746
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4078249931335449
Epoch: 7, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.39669227600097656
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.387357234954834
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.42694664001464844
Epoch: 10, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3737177848815918
Epoch: 11, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3938713073730469
Epoch: 12, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4107551574707031
Epoch: 13, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4256148338317871
Epoch: 14, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5364115238189697
Epoch: 15, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4282259941101074
Epoch: 16, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.536794900894165
Epoch: 17, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5030536651611328
Epoch: 18, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.3934612274169922
Epoch: 19, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps157_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 44881923
model size : 185.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9504525661468506
Epoch: 1, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4410972595214844
Epoch: 2, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46988987922668457
Epoch: 3, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4655923843383789
Epoch: 4, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4290437698364258
Epoch: 5, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.45178914070129395
Epoch: 6, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4877626895904541
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5023126602172852
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.45293188095092773
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4535386562347412
Epoch: 10, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.49823427200317383
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5484206676483154
Epoch: 12, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.45175957679748535
Epoch: 13, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.4403069019317627
Epoch: 14, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.5811378955841064
Epoch: 15, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.3963642120361328
Epoch: 16, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.4776773452758789
Epoch: 17, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5188238620758057
Epoch: 18, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.48055267333984375
Epoch: 19, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.43596887588500977
Epoch: 20, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5076074600219727
Epoch: 21, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5720505714416504
Epoch: 22, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4736795425415039
Epoch: 23, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.44457530975341797
Epoch: 24, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5617668628692627
Epoch: 25, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5131359100341797
Epoch: 26, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 45131523
model size : 186.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9324657917022705
Epoch: 1, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.45183658599853516
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46645379066467285
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4435732364654541
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.46631312370300293
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40858888626098633
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.41097021102905273
Epoch: 7, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.40399932861328125
Epoch: 8, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.46671628952026367
Epoch: 9, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.42866945266723633
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.4795844554901123
Epoch: 11, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4000866413116455
Epoch: 12, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.406238317489624
Epoch: 13, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.40725016593933105
Epoch: 14, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.001 Vali Acc: 0.400 Test Loss: 1.001 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.43494176864624023
Epoch: 15, Steps: 1 | Train Loss: 0.535 Vali Loss: 0.996 Vali Acc: 0.333 Test Loss: 0.996 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4825139045715332
Epoch: 16, Steps: 1 | Train Loss: 0.462 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.38385820388793945
Epoch: 17, Steps: 1 | Train Loss: 0.432 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.40409326553344727
Epoch: 18, Steps: 1 | Train Loss: 0.362 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.3941469192504883
Epoch: 19, Steps: 1 | Train Loss: 0.349 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.41552209854125977
Epoch: 20, Steps: 1 | Train Loss: 0.281 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 45024003
model size : 186.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8873074054718018
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36276698112487793
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4802408218383789
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.3924853801727295
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4980170726776123
Epoch: 5, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.4627845287322998
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.078 Vali Acc: 0.667 Test Loss: 1.078 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.41881561279296875
Epoch: 7, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.076 Vali Acc: 0.667 Test Loss: 1.076 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 0.413677453994751
Epoch: 8, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.072 Vali Acc: 0.733 Test Loss: 1.072 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 0.4902970790863037
Epoch: 9, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.067 Vali Acc: 0.667 Test Loss: 1.067 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.43203139305114746
Epoch: 10, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.42062926292419434
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4193742275238037
Epoch: 12, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5066914558410645
Epoch: 13, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.43167662620544434
Epoch: 14, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.3808326721191406
Epoch: 15, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.395430326461792
Epoch: 16, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5502746105194092
Epoch: 17, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.37295079231262207
Epoch: 18, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 44970243
model size : 186.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps179_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7720303535461426
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.35289931297302246
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.41358518600463867
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4279975891113281
Epoch: 4, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.38343000411987305
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.46617817878723145
Epoch: 6, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.45487403869628906
Epoch: 7, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.35313844680786133
Epoch: 8, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.34238719940185547
Epoch: 9, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.3500335216522217
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4233822822570801
Epoch: 11, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.351146936416626
Epoch: 12, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4135303497314453
Epoch: 13, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.38859081268310547
Epoch: 14, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.495311975479126
Epoch: 15, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.40493083000183105
Epoch: 16, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps179_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 45226755
model size : 187.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps179_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7925856113433838
Epoch: 1, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4006924629211426
Epoch: 2, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5098607540130615
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4854011535644531
Epoch: 4, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.37842869758605957
Epoch: 5, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4202589988708496
Epoch: 6, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5190584659576416
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.42985033988952637
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.41759276390075684
Epoch: 9, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5578539371490479
Epoch: 10, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.47887158393859863
Epoch: 11, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4349396228790283
Epoch: 12, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps179_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 45126915
model size : 186.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps179_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9564731121063232
Epoch: 1, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.47092485427856445
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4194951057434082
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3857753276824951
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4774792194366455
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5023820400238037
Epoch: 6, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3848440647125244
Epoch: 7, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.461759090423584
Epoch: 8, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.47204160690307617
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.3893401622772217
Epoch: 10, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4657139778137207
Epoch: 11, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.491121768951416
Epoch: 12, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4614403247833252
Epoch: 13, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4601304531097412
Epoch: 14, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.44556283950805664
Epoch: 15, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.47418856620788574
Epoch: 16, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5209023952484131
Epoch: 17, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4534153938293457
Epoch: 18, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5258123874664307
Epoch: 19, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4109177589416504
Epoch: 20, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.3489844799041748
Epoch: 21, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.47123217582702637
Epoch: 22, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.3949851989746094
Epoch: 23, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.44574427604675293
Epoch: 24, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.43308186531066895
Epoch: 25, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 0.4929180145263672
Epoch: 26, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5667257308959961
Epoch: 27, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5186057090759277
Epoch: 28, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4627997875213623
Epoch: 29, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5173814296722412
Epoch: 30, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.49687814712524414
Epoch: 31, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5115840435028076
Epoch: 32, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6313357353210449
Epoch: 33, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5492265224456787
Epoch: 34, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4965832233428955
Epoch: 35, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps179_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 45076995
model size : 186.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps193_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9387264251708984
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.38092851638793945
Epoch: 2, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4714620113372803
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5296356678009033
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.4540257453918457
Epoch: 5, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.43590259552001953
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4371213912963867
Epoch: 7, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4566669464111328
Epoch: 8, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.44319844245910645
Epoch: 9, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.37902164459228516
Epoch: 10, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.416532039642334
Epoch: 11, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4273989200592041
Epoch: 12, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.45906996726989746
Epoch: 13, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.42346692085266113
Epoch: 14, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4290657043457031
Epoch: 15, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.403958797454834
Epoch: 16, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.3594796657562256
Epoch: 17, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.37673521041870117
Epoch: 18, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.3759195804595947
Epoch: 19, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4532346725463867
Epoch: 20, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps193_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 45340419
model size : 187.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps193_str97_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7840156555175781
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.219 Vali Acc: 0.133 Test Loss: 1.219 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.3880186080932617
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.190 Vali Acc: 0.067 Test Loss: 1.190 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41217565536499023
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.40439271926879883
Epoch: 4, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.376234769821167
Epoch: 5, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4006655216217041
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.420590877532959
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.38016772270202637
Epoch: 8, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3296468257904053
Epoch: 9, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.36002492904663086
Epoch: 10, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.47692418098449707
Epoch: 11, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3547995090484619
Epoch: 12, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.31820178031921387
Epoch: 13, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4403352737426758
Epoch: 14, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.3930037021636963
Epoch: 15, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4587686061859131
Epoch: 16, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.3561434745788574
Epoch: 17, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps193_str97_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 45248259
model size : 187.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps193_str193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7965662479400635
Epoch: 1, Steps: 1 | Train Loss: 1.289 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3554811477661133
Epoch: 2, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.33730363845825195
Epoch: 3, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.33415746688842773
Epoch: 4, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.35251903533935547
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3201611042022705
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3247082233428955
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.31466102600097656
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.37158894538879395
Epoch: 9, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4076554775238037
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.3558375835418701
Epoch: 11, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.3197004795074463
Epoch: 12, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.3231942653656006
Epoch: 13, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.3160848617553711
Epoch: 14, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps193_str193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 45202179
model size : 187.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps209_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.815596103668213
Epoch: 1, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.37400197982788086
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4249887466430664
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4320690631866455
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4137547016143799
Epoch: 5, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4356224536895752
Epoch: 6, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.37001872062683105
Epoch: 7, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.4160938262939453
Epoch: 8, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.37454724311828613
Epoch: 9, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.46211910247802734
Epoch: 10, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.43162083625793457
Epoch: 11, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.38632702827453613
Epoch: 12, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.48305201530456543
Epoch: 13, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.41356420516967773
Epoch: 14, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4138486385345459
Epoch: 15, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.45756959915161133
Epoch: 16, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4271223545074463
Epoch: 17, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.36977124214172363
Epoch: 18, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.40428972244262695
Epoch: 19, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps209_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 45472515
model size : 188.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps209_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8902873992919922
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4083526134490967
Epoch: 2, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.45090699195861816
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5273783206939697
Epoch: 4, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4688999652862549
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4423058032989502
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.41875362396240234
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.3760371208190918
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4365983009338379
Epoch: 9, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.3842008113861084
Epoch: 10, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.528658390045166
Epoch: 11, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.41443657875061035
Epoch: 12, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.38753414154052734
Epoch: 13, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.3850860595703125
Epoch: 14, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps209_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 45388035
model size : 187.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps209_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9202544689178467
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.40975069999694824
Epoch: 2, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.43973231315612793
Epoch: 3, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3736701011657715
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4059755802154541
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.398618221282959
Epoch: 6, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3898439407348633
Epoch: 7, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.42844390869140625
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.39778733253479004
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4022383689880371
Epoch: 10, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.3691108226776123
Epoch: 11, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.3552713394165039
Epoch: 12, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.3532137870788574
Epoch: 13, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.4152059555053711
Epoch: 14, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.4272429943084717
Epoch: 15, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4126107692718506
Epoch: 16, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4718360900878906
Epoch: 17, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.44277262687683105
Epoch: 18, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3915383815765381
Epoch: 19, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.49543118476867676
Epoch: 20, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.538123369216919
Epoch: 21, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4998047351837158
Epoch: 22, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.38679957389831543
Epoch: 23, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4767277240753174
Epoch: 24, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps209_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 45345795
model size : 187.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps228_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9638328552246094
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.4192519187927246
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.424776554107666
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4246697425842285
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.445080041885376
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.39206981658935547
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4255661964416504
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.42905378341674805
Epoch: 8, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.47237658500671387
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4187045097351074
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5743298530578613
Epoch: 11, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4113802909851074
Epoch: 12, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.3839097023010254
Epoch: 13, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4332149028778076
Epoch: 14, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps228_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 45632259
model size : 188.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps228_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.112623929977417
Epoch: 1, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.428682804107666
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4213747978210449
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45644211769104004
Epoch: 4, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.4286155700683594
Epoch: 5, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.4757091999053955
Epoch: 6, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.4446706771850586
Epoch: 7, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.45148777961730957
Epoch: 8, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.449676513671875
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4998307228088379
Epoch: 10, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4603612422943115
Epoch: 11, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4456648826599121
Epoch: 12, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.473374605178833
Epoch: 13, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.39452457427978516
Epoch: 14, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5467782020568848
Epoch: 15, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5025455951690674
Epoch: 16, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.5475819110870361
Epoch: 17, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.43601083755493164
Epoch: 18, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.47011852264404297
Epoch: 19, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4134089946746826
Epoch: 20, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5175538063049316
Epoch: 21, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4122602939605713
Epoch: 22, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5259537696838379
Epoch: 23, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5471916198730469
Epoch: 24, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.48278212547302246
Epoch: 25, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.48567652702331543
Epoch: 26, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.142 Vali Acc: 0.533 Test Loss: 1.142 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 27 cost time: 0.47600722312927246
Epoch: 27, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.161 Vali Acc: 0.600 Test Loss: 1.161 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599988).  Saving model ...
Epoch: 28 cost time: 0.43230104446411133
Epoch: 28, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.181 Vali Acc: 0.600 Test Loss: 1.181 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5013473033905029
Epoch: 29, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4995565414428711
Epoch: 30, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.223 Vali Acc: 0.600 Test Loss: 1.223 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4028904438018799
Epoch: 31, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.248 Vali Acc: 0.600 Test Loss: 1.248 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.37953615188598633
Epoch: 32, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.274 Vali Acc: 0.600 Test Loss: 1.274 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4907515048980713
Epoch: 33, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4452402591705322
Epoch: 34, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.46880292892456055
Epoch: 35, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.350 Vali Acc: 0.533 Test Loss: 1.350 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4585404396057129
Epoch: 36, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.377 Vali Acc: 0.533 Test Loss: 1.377 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.42229485511779785
Epoch: 37, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.404 Vali Acc: 0.533 Test Loss: 1.404 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps228_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 45555459
model size : 188.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps228_str228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.012840509414673
Epoch: 1, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3809497356414795
Epoch: 2, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43468594551086426
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5126998424530029
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4509756565093994
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43323183059692383
Epoch: 6, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.36094212532043457
Epoch: 7, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.38491368293762207
Epoch: 8, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3791999816894531
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4180009365081787
Epoch: 10, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4290635585784912
Epoch: 11, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps228_str228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 45517059
model size : 188.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.95308256149292
Epoch: 1, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.47174525260925293
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.47078752517700195
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.43343091011047363
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4116482734680176
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.41611266136169434
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3757033348083496
Epoch: 7, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4612009525299072
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4230515956878662
Epoch: 9, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4293828010559082
Epoch: 10, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4620187282562256
Epoch: 11, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.38872742652893066
Epoch: 12, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 45819651
model size : 189.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9467055797576904
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3914163112640381
Epoch: 2, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3745112419128418
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43283557891845703
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3689436912536621
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40721917152404785
Epoch: 6, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3603637218475342
Epoch: 7, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3657853603363037
Epoch: 8, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.35825085639953613
Epoch: 9, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.371063232421875
Epoch: 10, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4122035503387451
Epoch: 11, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 45754371
model size : 189.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8956575393676758
Epoch: 1, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3889923095703125
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3534281253814697
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4101119041442871
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.4001903533935547
Epoch: 5, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.4453566074371338
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.42685699462890625
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.4102027416229248
Epoch: 8, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.4078207015991211
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.35791778564453125
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.5173821449279785
Epoch: 11, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.5011775493621826
Epoch: 12, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.4755074977874756
Epoch: 13, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.5100340843200684
Epoch: 14, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.4537343978881836
Epoch: 15, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.4899582862854004
Epoch: 16, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4243178367614746
Epoch: 17, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5218808650970459
Epoch: 18, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.40863919258117676
Epoch: 19, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.43776869773864746
Epoch: 20, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4495840072631836
Epoch: 21, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.47000980377197266
Epoch: 22, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.48145437240600586
Epoch: 23, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4754939079284668
Epoch: 24, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5015614032745361
Epoch: 25, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 45719811
model size : 189.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps278_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1721725463867188
Epoch: 1, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5434496402740479
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3858647346496582
Epoch: 3, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4118974208831787
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.399733304977417
Epoch: 5, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.4581339359283447
Epoch: 6, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4357168674468994
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5225491523742676
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5062930583953857
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.5431652069091797
Epoch: 10, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45526790618896484
Epoch: 11, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4947052001953125
Epoch: 12, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.43752527236938477
Epoch: 13, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.39687180519104004
Epoch: 14, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4350004196166992
Epoch: 15, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.465137243270874
Epoch: 16, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.48949503898620605
Epoch: 17, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.44573020935058594
Epoch: 18, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4291703701019287
Epoch: 19, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps278_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 46062339
model size : 190.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps278_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7481060028076172
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.3538377285003662
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43782711029052734
Epoch: 3, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4309053421020508
Epoch: 4, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4765036106109619
Epoch: 5, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.432781457901001
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4942030906677246
Epoch: 7, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.44054174423217773
Epoch: 8, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.38421177864074707
Epoch: 9, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.41862964630126953
Epoch: 10, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.41394972801208496
Epoch: 11, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps278_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 46000899
model size : 190.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps278_str278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9978482723236084
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.42555928230285645
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.523909330368042
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5029356479644775
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4529759883880615
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.45440196990966797
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.43492913246154785
Epoch: 7, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5009231567382812
Epoch: 8, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4329369068145752
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.42096471786499023
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.413179874420166
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.39476776123046875
Epoch: 12, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.40668439865112305
Epoch: 13, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps278_str278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 45970179
model size : 190.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps313_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0439321994781494
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.40256381034851074
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.453413724899292
Epoch: 3, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5152525901794434
Epoch: 4, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.49359560012817383
Epoch: 5, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4544246196746826
Epoch: 6, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4451119899749756
Epoch: 7, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5078558921813965
Epoch: 8, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3893873691558838
Epoch: 9, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4564509391784668
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.470935583114624
Epoch: 11, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4816141128540039
Epoch: 12, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.43581390380859375
Epoch: 13, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.48052334785461426
Epoch: 14, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5398974418640137
Epoch: 15, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4480710029602051
Epoch: 16, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.510779857635498
Epoch: 17, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5761139392852783
Epoch: 18, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.47328782081604004
Epoch: 19, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.144 Vali Acc: 0.533 Test Loss: 1.144 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5507700443267822
Epoch: 20, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4820058345794678
Epoch: 21, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.47465014457702637
Epoch: 22, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5006463527679443
Epoch: 23, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.481231689453125
Epoch: 24, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5667014122009277
Epoch: 25, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5215668678283691
Epoch: 26, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps313_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 46369539
model size : 191.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps313_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0260634422302246
Epoch: 1, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.386260986328125
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46698832511901855
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4706151485443115
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4823648929595947
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4364891052246094
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.469928503036499
Epoch: 7, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4183361530303955
Epoch: 8, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.48449206352233887
Epoch: 9, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5360596179962158
Epoch: 10, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.40459465980529785
Epoch: 11, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4226264953613281
Epoch: 12, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.5386912822723389
Epoch: 13, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.43235254287719727
Epoch: 14, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.5058298110961914
Epoch: 15, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4217061996459961
Epoch: 16, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.40425896644592285
Epoch: 17, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3872077465057373
Epoch: 18, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4190404415130615
Epoch: 19, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4444599151611328
Epoch: 20, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.47061657905578613
Epoch: 21, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.40589284896850586
Epoch: 22, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4776153564453125
Epoch: 23, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4904799461364746
Epoch: 24, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps313_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 46315779
model size : 191.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps313_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8805537223815918
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5018675327301025
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.541642427444458
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3793013095855713
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4938163757324219
Epoch: 5, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46257495880126953
Epoch: 6, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5282738208770752
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.42811036109924316
Epoch: 8, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.43691229820251465
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4501352310180664
Epoch: 10, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.41718173027038574
Epoch: 11, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.39585351943969727
Epoch: 12, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.3830592632293701
Epoch: 13, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5184991359710693
Epoch: 14, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.49040770530700684
Epoch: 15, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3837623596191406
Epoch: 16, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.45349645614624023
Epoch: 17, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4198484420776367
Epoch: 18, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.43651866912841797
Epoch: 19, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.3874986171722412
Epoch: 20, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.3955700397491455
Epoch: 21, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.44918203353881836
Epoch: 22, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.403994083404541
Epoch: 23, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.48019886016845703
Epoch: 24, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4677131175994873
Epoch: 25, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps313_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 46288899
model size : 191.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps358_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0663809776306152
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5536417961120605
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4721696376800537
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.49214649200439453
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5031700134277344
Epoch: 5, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.5132722854614258
Epoch: 6, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.5091583728790283
Epoch: 7, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.45060062408447266
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4638941287994385
Epoch: 9, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.517540454864502
Epoch: 10, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4825711250305176
Epoch: 11, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4735987186431885
Epoch: 12, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5660033226013184
Epoch: 13, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6491565704345703
Epoch: 14, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5747480392456055
Epoch: 15, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5364718437194824
Epoch: 16, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.43262386322021484
Epoch: 17, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.030 Vali Acc: 0.333 Test Loss: 1.030 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4466729164123535
Epoch: 18, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5058836936950684
Epoch: 19, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps358_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 46768899
model size : 193.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps358_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0468313694000244
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.44832539558410645
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42930150032043457
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.46201610565185547
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3834805488586426
Epoch: 5, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.41541147232055664
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.40552210807800293
Epoch: 7, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.40453314781188965
Epoch: 8, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.46111488342285156
Epoch: 9, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4080698490142822
Epoch: 10, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.435849666595459
Epoch: 11, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.45712780952453613
Epoch: 12, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.45433616638183594
Epoch: 13, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4390103816986084
Epoch: 14, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4201641082763672
Epoch: 15, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4086036682128906
Epoch: 16, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.3953859806060791
Epoch: 17, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.41817402839660645
Epoch: 18, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.36914992332458496
Epoch: 19, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.48509716987609863
Epoch: 20, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.36246800422668457
Epoch: 21, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps358_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 46722819
model size : 192.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps358_str358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8397407531738281
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4792976379394531
Epoch: 2, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5290303230285645
Epoch: 3, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.45113348960876465
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47652125358581543
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5064589977264404
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4335613250732422
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5911588668823242
Epoch: 8, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.38834118843078613
Epoch: 9, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4011523723602295
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.44440627098083496
Epoch: 11, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4952363967895508
Epoch: 12, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.48731064796447754
Epoch: 13, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.4642636775970459
Epoch: 14, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.49805378913879395
Epoch: 15, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.43682312965393066
Epoch: 16, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.5174605846405029
Epoch: 17, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4293797016143799
Epoch: 18, Steps: 1 | Train Loss: 0.396 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.43839406967163086
Epoch: 19, Steps: 1 | Train Loss: 0.340 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.4148714542388916
Epoch: 20, Steps: 1 | Train Loss: 0.299 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.4583907127380371
Epoch: 21, Steps: 1 | Train Loss: 0.262 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.4412577152252197
Epoch: 22, Steps: 1 | Train Loss: 0.232 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.39612317085266113
Epoch: 23, Steps: 1 | Train Loss: 0.194 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.44809436798095703
Epoch: 24, Steps: 1 | Train Loss: 0.164 Vali Loss: 0.976 Vali Acc: 0.667 Test Loss: 0.976 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 0.46259188652038574
Epoch: 25, Steps: 1 | Train Loss: 0.142 Vali Loss: 0.974 Vali Acc: 0.667 Test Loss: 0.974 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 0.3981459140777588
Epoch: 26, Steps: 1 | Train Loss: 0.113 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 0.4646639823913574
Epoch: 27, Steps: 1 | Train Loss: 0.085 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 0.40210604667663574
Epoch: 28, Steps: 1 | Train Loss: 0.072 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 29 cost time: 0.537900447845459
Epoch: 29, Steps: 1 | Train Loss: 0.075 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.45929932594299316
Epoch: 30, Steps: 1 | Train Loss: 0.047 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4594125747680664
Epoch: 31, Steps: 1 | Train Loss: 0.045 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5097017288208008
Epoch: 32, Steps: 1 | Train Loss: 0.037 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.3701772689819336
Epoch: 33, Steps: 1 | Train Loss: 0.026 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 34 cost time: 0.40940070152282715
Epoch: 34, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.970 Vali Acc: 0.667 Test Loss: 0.970 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 35 cost time: 0.4906005859375
Epoch: 35, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.45731282234191895
Epoch: 36, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4762425422668457
Epoch: 37, Steps: 1 | Train Loss: 0.013 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.44026756286621094
Epoch: 38, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5152826309204102
Epoch: 39, Steps: 1 | Train Loss: 0.010 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4850893020629883
Epoch: 40, Steps: 1 | Train Loss: 0.011 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.49969482421875
Epoch: 41, Steps: 1 | Train Loss: 0.010 Vali Loss: 0.968 Vali Acc: 0.600 Test Loss: 0.968 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.46843457221984863
Epoch: 42, Steps: 1 | Train Loss: 0.008 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4487473964691162
Epoch: 43, Steps: 1 | Train Loss: 0.007 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5271008014678955
Epoch: 44, Steps: 1 | Train Loss: 0.006 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps358_str358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 46699779
model size : 192.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps417_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0439136028289795
Epoch: 1, Steps: 1 | Train Loss: 1.439 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3786165714263916
Epoch: 2, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5093529224395752
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.435197114944458
Epoch: 4, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.40651726722717285
Epoch: 5, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5017390251159668
Epoch: 6, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.46297383308410645
Epoch: 7, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5179555416107178
Epoch: 8, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.44100022315979004
Epoch: 9, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.45706844329833984
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.40984439849853516
Epoch: 11, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5515058040618896
Epoch: 12, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4397454261779785
Epoch: 13, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5054275989532471
Epoch: 14, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4309566020965576
Epoch: 15, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4684638977050781
Epoch: 16, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4842507839202881
Epoch: 17, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5158934593200684
Epoch: 18, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.46942138671875
Epoch: 19, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4578855037689209
Epoch: 20, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.483259916305542
Epoch: 21, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5272336006164551
Epoch: 22, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4726247787475586
Epoch: 23, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5237398147583008
Epoch: 24, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4962794780731201
Epoch: 25, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps417_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 47297283
model size : 195.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps417_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1794073581695557
Epoch: 1, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5175278186798096
Epoch: 2, Steps: 1 | Train Loss: 1.339 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3479347229003906
Epoch: 3, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4090859889984131
Epoch: 4, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.39444518089294434
Epoch: 5, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5204484462738037
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3940725326538086
Epoch: 7, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.46245384216308594
Epoch: 8, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.4775121212005615
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45388221740722656
Epoch: 10, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.42302846908569336
Epoch: 11, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4877336025238037
Epoch: 12, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5129127502441406
Epoch: 13, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.44442033767700195
Epoch: 14, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.440718412399292
Epoch: 15, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 16 cost time: 0.5118308067321777
Epoch: 16, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 0.34778881072998047
Epoch: 17, Steps: 1 | Train Loss: 0.367 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.39601635932922363
Epoch: 18, Steps: 1 | Train Loss: 0.356 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.37752652168273926
Epoch: 19, Steps: 1 | Train Loss: 0.293 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.38144445419311523
Epoch: 20, Steps: 1 | Train Loss: 0.227 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4207651615142822
Epoch: 21, Steps: 1 | Train Loss: 0.203 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4969346523284912
Epoch: 22, Steps: 1 | Train Loss: 0.185 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5230803489685059
Epoch: 23, Steps: 1 | Train Loss: 0.137 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.39713358879089355
Epoch: 24, Steps: 1 | Train Loss: 0.112 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.4635128974914551
Epoch: 25, Steps: 1 | Train Loss: 0.083 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5242152214050293
Epoch: 26, Steps: 1 | Train Loss: 0.073 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4444844722747803
Epoch: 27, Steps: 1 | Train Loss: 0.054 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4304165840148926
Epoch: 28, Steps: 1 | Train Loss: 0.045 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4112851619720459
Epoch: 29, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.3886740207672119
Epoch: 30, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5753858089447021
Epoch: 31, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.4396350383758545
Epoch: 32, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.3726222515106201
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4813883304595947
Epoch: 34, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps417_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 47258883
model size : 194.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps417_str417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2573025226593018
Epoch: 1, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4346187114715576
Epoch: 2, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.4627516269683838
Epoch: 3, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.44197773933410645
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4418501853942871
Epoch: 5, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4065275192260742
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5285718441009521
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4444770812988281
Epoch: 8, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4623894691467285
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.48670434951782227
Epoch: 10, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5639655590057373
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5037157535552979
Epoch: 12, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4586756229400635
Epoch: 13, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5644659996032715
Epoch: 14, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4342198371887207
Epoch: 15, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4611783027648926
Epoch: 16, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.5565433502197266
Epoch: 17, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.5207276344299316
Epoch: 18, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.4358489513397217
Epoch: 19, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.5290546417236328
Epoch: 20, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4924640655517578
Epoch: 21, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5414979457855225
Epoch: 22, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4959385395050049
Epoch: 23, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.43358683586120605
Epoch: 24, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4726247787475586
Epoch: 25, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.49593305587768555
Epoch: 26, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4666626453399658
Epoch: 27, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.48992323875427246
Epoch: 28, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5610177516937256
Epoch: 29, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps417_str417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 47239683
model size : 194.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.939504623413086
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.127 Vali Acc: 0.133 Test Loss: 1.127 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.44655346870422363
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4429891109466553
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3662137985229492
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.45697593688964844
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4260072708129883
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.49118685722351074
Epoch: 7, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.47254085540771484
Epoch: 8, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.38476109504699707
Epoch: 9, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.503056526184082
Epoch: 10, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.42554211616516113
Epoch: 11, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.3899204730987549
Epoch: 12, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4746975898742676
Epoch: 13, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 14 cost time: 0.3976259231567383
Epoch: 14, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.41922450065612793
Epoch: 15, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.376035213470459
Epoch: 16, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3818705081939697
Epoch: 17, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.371535062789917
Epoch: 18, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4142420291900635
Epoch: 19, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4169745445251465
Epoch: 20, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3910970687866211
Epoch: 21, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.34911680221557617
Epoch: 22, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.4495048522949219
Epoch: 23, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5360100269317627
Epoch: 24, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.47423410415649414
Epoch: 25, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4849107265472412
Epoch: 26, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5224671363830566
Epoch: 27, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.48538661003112793
Epoch: 28, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5002243518829346
Epoch: 29, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4755079746246338
Epoch: 30, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.46593165397644043
Epoch: 31, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4796898365020752
Epoch: 32, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 48050691
model size : 197.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.942497968673706
Epoch: 1, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.40657639503479004
Epoch: 2, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.33463621139526367
Epoch: 3, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4291343688964844
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4500236511230469
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.37220191955566406
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.4307551383972168
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.44757795333862305
Epoch: 8, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4144411087036133
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.4192941188812256
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48551225662231445
Epoch: 11, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3833801746368408
Epoch: 12, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.44692182540893555
Epoch: 13, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.3986196517944336
Epoch: 14, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4820859432220459
Epoch: 15, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4163246154785156
Epoch: 16, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.39047670364379883
Epoch: 17, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.3703162670135498
Epoch: 18, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.44757676124572754
Epoch: 19, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 48019971
model size : 197.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.083432912826538
Epoch: 1, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.510669469833374
Epoch: 2, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4979386329650879
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3916661739349365
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.524916410446167
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5051770210266113
Epoch: 6, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.46628856658935547
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5363197326660156
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4207942485809326
Epoch: 9, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5106260776519775
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4916396141052246
Epoch: 11, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.462693452835083
Epoch: 12, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.48078036308288574
Epoch: 13, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5220494270324707
Epoch: 14, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el6_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 48004611
model size : 197.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9834423065185547
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5032246112823486
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.513209342956543
Epoch: 3, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.5450999736785889
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4908318519592285
Epoch: 5, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4599728584289551
Epoch: 6, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.47919321060180664
Epoch: 7, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4290964603424072
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4444093704223633
Epoch: 9, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5263776779174805
Epoch: 10, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5229096412658691
Epoch: 11, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48354315757751465
Epoch: 12, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.47788166999816895
Epoch: 13, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.100 Vali Acc: 0.133 Test Loss: 1.100 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4522714614868164
Epoch: 14, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5450296401977539
Epoch: 15, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.5722730159759521
Epoch: 16, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4817640781402588
Epoch: 17, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4772515296936035
Epoch: 18, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.430633544921875
Epoch: 19, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5423340797424316
Epoch: 20, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6252949237823486
Epoch: 21, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.48456692695617676
Epoch: 22, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.4210672378540039
Epoch: 23, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4864349365234375
Epoch: 24, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4823312759399414
Epoch: 25, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.336 Vali Acc: 0.267 Test Loss: 1.336 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5141000747680664
Epoch: 26, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.412 Vali Acc: 0.267 Test Loss: 1.412 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4629232883453369
Epoch: 27, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.450 Vali Acc: 0.333 Test Loss: 1.450 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4570791721343994
Epoch: 28, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.475 Vali Acc: 0.333 Test Loss: 1.475 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.46907806396484375
Epoch: 29, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.498 Vali Acc: 0.333 Test Loss: 1.498 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.456127405166626
Epoch: 30, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.522 Vali Acc: 0.333 Test Loss: 1.522 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.41471338272094727
Epoch: 31, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.545 Vali Acc: 0.333 Test Loss: 1.545 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.41162896156311035
Epoch: 32, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.568 Vali Acc: 0.400 Test Loss: 1.568 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37583619
model size : 158.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.070359706878662
Epoch: 1, Steps: 1 | Train Loss: 1.331 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5468037128448486
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5659780502319336
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5103194713592529
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.5225934982299805
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4870171546936035
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4651641845703125
Epoch: 7, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4726090431213379
Epoch: 8, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.43465590476989746
Epoch: 9, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4161412715911865
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.40781354904174805
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.48305845260620117
Epoch: 12, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5128285884857178
Epoch: 13, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.42818593978881836
Epoch: 14, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.49240660667419434
Epoch: 15, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4485609531402588
Epoch: 16, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.45769238471984863
Epoch: 17, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4635796546936035
Epoch: 18, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 37399299
model size : 157.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.877037525177002
Epoch: 1, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4224381446838379
Epoch: 2, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.136 Vali Acc: 0.133 Test Loss: 1.136 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44235658645629883
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4140934944152832
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5360188484191895
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5369851589202881
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5512595176696777
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.41617488861083984
Epoch: 8, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4241909980773926
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.3928821086883545
Epoch: 10, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.496671199798584
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.45431947708129883
Epoch: 12, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4804394245147705
Epoch: 13, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.39112138748168945
Epoch: 14, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.4127318859100342
Epoch: 15, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.42388176918029785
Epoch: 16, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4334094524383545
Epoch: 17, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.45366954803466797
Epoch: 18, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.39707255363464355
Epoch: 19, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5346841812133789
Epoch: 20, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.47528553009033203
Epoch: 21, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5173797607421875
Epoch: 22, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.5339338779449463
Epoch: 23, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 0.5206136703491211
Epoch: 24, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4663524627685547
Epoch: 25, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.45120906829833984
Epoch: 26, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.41642260551452637
Epoch: 27, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4467601776123047
Epoch: 28, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.461505651473999
Epoch: 29, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4292623996734619
Epoch: 30, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5048775672912598
Epoch: 31, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.46340298652648926
Epoch: 32, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.49442028999328613
Epoch: 33, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37307139
model size : 156.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.382093667984009
Epoch: 1, Steps: 1 | Train Loss: 1.331 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4620044231414795
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5852746963500977
Epoch: 3, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5014171600341797
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5167996883392334
Epoch: 5, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.44847750663757324
Epoch: 6, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4873795509338379
Epoch: 7, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.391040563583374
Epoch: 8, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5111782550811768
Epoch: 9, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5043056011199951
Epoch: 10, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4380533695220947
Epoch: 11, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4600398540496826
Epoch: 12, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.47016477584838867
Epoch: 13, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3929276466369629
Epoch: 14, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.46224546432495117
Epoch: 15, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.48157286643981934
Epoch: 16, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.46677660942077637
Epoch: 17, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.48025965690612793
Epoch: 18, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.44591689109802246
Epoch: 19, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5445313453674316
Epoch: 20, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.46912264823913574
Epoch: 21, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5250959396362305
Epoch: 22, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37598979
model size : 158.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.507488250732422
Epoch: 1, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4226970672607422
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46341562271118164
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43880295753479004
Epoch: 4, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4427061080932617
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4092991352081299
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5231592655181885
Epoch: 7, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4350149631500244
Epoch: 8, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4023704528808594
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.48998403549194336
Epoch: 10, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4669644832611084
Epoch: 11, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.4724574089050293
Epoch: 12, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5321035385131836
Epoch: 13, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4414329528808594
Epoch: 14, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4290628433227539
Epoch: 15, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4694492816925049
Epoch: 16, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4639289379119873
Epoch: 17, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.43623876571655273
Epoch: 18, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4758596420288086
Epoch: 19, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4611177444458008
Epoch: 20, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4883723258972168
Epoch: 21, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37433859
model size : 157.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.022184133529663
Epoch: 1, Steps: 1 | Train Loss: 1.633 Vali Loss: 1.383 Vali Acc: 0.333 Test Loss: 1.383 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.4696948528289795
Epoch: 2, Steps: 1 | Train Loss: 1.333 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4771006107330322
Epoch: 3, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5375821590423584
Epoch: 4, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5043752193450928
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5750834941864014
Epoch: 6, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.49480724334716797
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4698472023010254
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4415733814239502
Epoch: 9, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4261794090270996
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.47342514991760254
Epoch: 11, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5250957012176514
Epoch: 12, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5346918106079102
Epoch: 13, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4186828136444092
Epoch: 14, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.429213285446167
Epoch: 15, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.43625688552856445
Epoch: 16, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.49959635734558105
Epoch: 17, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5012133121490479
Epoch: 18, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4189307689666748
Epoch: 19, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5215272903442383
Epoch: 20, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5132124423980713
Epoch: 21, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37345539
model size : 157.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1375439167022705
Epoch: 1, Steps: 1 | Train Loss: 1.387 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.537238597869873
Epoch: 2, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.4991917610168457
Epoch: 3, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.472212553024292
Epoch: 4, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.44841933250427246
Epoch: 5, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4613614082336426
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5298826694488525
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.48663806915283203
Epoch: 8, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.46605372428894043
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.450695276260376
Epoch: 10, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.46851491928100586
Epoch: 11, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.47749972343444824
Epoch: 12, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.45545244216918945
Epoch: 13, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.44402599334716797
Epoch: 14, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.4018373489379883
Epoch: 15, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.44383907318115234
Epoch: 16, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.5400159358978271
Epoch: 17, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5031716823577881
Epoch: 18, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.487257719039917
Epoch: 19, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4451277256011963
Epoch: 20, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.46105313301086426
Epoch: 21, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.46364450454711914
Epoch: 22, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5190689563751221
Epoch: 23, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.45503783226013184
Epoch: 24, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4851682186126709
Epoch: 25, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5058128833770752
Epoch: 26, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 37624323
model size : 158.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8239378929138184
Epoch: 1, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4908907413482666
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40940141677856445
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.478320837020874
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.46231770515441895
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.48146843910217285
Epoch: 6, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6313636302947998
Epoch: 7, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.48146867752075195
Epoch: 8, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.42388367652893066
Epoch: 9, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5666496753692627
Epoch: 10, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4822533130645752
Epoch: 11, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5523746013641357
Epoch: 12, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5717620849609375
Epoch: 13, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.48900890350341797
Epoch: 14, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.44229698181152344
Epoch: 15, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5886960029602051
Epoch: 16, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.45137882232666016
Epoch: 17, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4859497547149658
Epoch: 18, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.504509449005127
Epoch: 19, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5381488800048828
Epoch: 20, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.49324989318847656
Epoch: 21, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5208754539489746
Epoch: 22, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.49920034408569336
Epoch: 23, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.518559455871582
Epoch: 24, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.48851680755615234
Epoch: 25, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4878544807434082
Epoch: 26, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5037314891815186
Epoch: 27, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4678475856781006
Epoch: 28, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4872312545776367
Epoch: 29, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4939303398132324
Epoch: 30, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37463043
model size : 157.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.256633996963501
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5190260410308838
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.51021409034729
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4550917148590088
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5020895004272461
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5481927394866943
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.46726226806640625
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.45270848274230957
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.45373988151550293
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4470539093017578
Epoch: 10, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.43671655654907227
Epoch: 11, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.49823617935180664
Epoch: 12, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4451937675476074
Epoch: 13, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4873025417327881
Epoch: 14, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 37378563
model size : 157.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps114_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.271682024002075
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.49473094940185547
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5166032314300537
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5557425022125244
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5103018283843994
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5313467979431152
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.5583481788635254
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5594487190246582
Epoch: 8, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5241568088531494
Epoch: 9, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5395026206970215
Epoch: 10, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4388117790222168
Epoch: 11, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5223758220672607
Epoch: 12, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5112669467926025
Epoch: 13, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5204207897186279
Epoch: 14, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4873166084289551
Epoch: 15, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5530986785888672
Epoch: 16, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps114_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 37658883
model size : 158.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps114_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5696938037872314
Epoch: 1, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.3053469657897949
Epoch: 2, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.3807249069213867
Epoch: 3, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.41039490699768066
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3880577087402344
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.36750078201293945
Epoch: 6, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.45780038833618164
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.38449811935424805
Epoch: 8, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4204692840576172
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.45147109031677246
Epoch: 10, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.42873144149780273
Epoch: 11, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5042746067047119
Epoch: 12, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.46184420585632324
Epoch: 13, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.44190287590026855
Epoch: 14, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps114_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37501443
model size : 157.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps114_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.194484233856201
Epoch: 1, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.49063754081726074
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.133322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5297255516052246
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.538733720779419
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.4869232177734375
Epoch: 5, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4662649631500244
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.5243322849273682
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.4397423267364502
Epoch: 8, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4394385814666748
Epoch: 9, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.519312858581543
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.40729403495788574
Epoch: 11, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.46982574462890625
Epoch: 12, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.42924022674560547
Epoch: 13, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.44599151611328125
Epoch: 14, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5369532108306885
Epoch: 15, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4343130588531494
Epoch: 16, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4360208511352539
Epoch: 17, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps114_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37420803
model size : 157.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.06496262550354
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5266311168670654
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45859336853027344
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5280859470367432
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5318629741668701
Epoch: 5, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4681432247161865
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5655508041381836
Epoch: 7, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.524498701095581
Epoch: 8, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6036252975463867
Epoch: 9, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5194911956787109
Epoch: 10, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4440591335296631
Epoch: 11, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6446061134338379
Epoch: 12, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5210678577423096
Epoch: 13, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4437551498413086
Epoch: 14, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.48589062690734863
Epoch: 15, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4634358882904053
Epoch: 16, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4168994426727295
Epoch: 17, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4179072380065918
Epoch: 18, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4314920902252197
Epoch: 19, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.478931188583374
Epoch: 20, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37702659
model size : 158.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1583032608032227
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3753325939178467
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4505302906036377
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5824072360992432
Epoch: 4, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.41701841354370117
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4650130271911621
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5147573947906494
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4414517879486084
Epoch: 8, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.43166136741638184
Epoch: 9, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.102 Vali Acc: 0.133 Test Loss: 1.102 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5451962947845459
Epoch: 10, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.47464656829833984
Epoch: 11, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.39443159103393555
Epoch: 12, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37549059
model size : 157.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1913647651672363
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4164750576019287
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.39269065856933594
Epoch: 3, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.410541296005249
Epoch: 4, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4942467212677002
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3930635452270508
Epoch: 6, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4435703754425049
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5347638130187988
Epoch: 8, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.49530839920043945
Epoch: 9, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5138208866119385
Epoch: 10, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4878678321838379
Epoch: 11, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4502289295196533
Epoch: 12, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6454610824584961
Epoch: 13, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4432408809661865
Epoch: 14, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4028186798095703
Epoch: 15, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4628748893737793
Epoch: 16, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5152184963226318
Epoch: 17, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.45060253143310547
Epoch: 18, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.076 Vali Acc: 0.200 Test Loss: 1.076 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4383120536804199
Epoch: 19, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4222419261932373
Epoch: 20, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 21 cost time: 0.44557952880859375
Epoch: 21, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4146113395690918
Epoch: 22, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.452380895614624
Epoch: 23, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4354531764984131
Epoch: 24, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4093508720397949
Epoch: 25, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.38700294494628906
Epoch: 26, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 27 cost time: 0.47863101959228516
Epoch: 27, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 28 cost time: 0.5016355514526367
Epoch: 28, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.3976902961730957
Epoch: 29, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.5260744094848633
Epoch: 30, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4629678726196289
Epoch: 31, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4550635814666748
Epoch: 32, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.3750770092010498
Epoch: 33, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4747889041900635
Epoch: 34, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.40247321128845215
Epoch: 35, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.38396573066711426
Epoch: 36, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.41413283348083496
Epoch: 37, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4368269443511963
Epoch: 38, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4795563220977783
Epoch: 39, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37472259
model size : 157.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0938453674316406
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4819216728210449
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.5520744323730469
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5493593215942383
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5156974792480469
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.47785067558288574
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4757533073425293
Epoch: 7, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5562055110931396
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4091923236846924
Epoch: 9, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5601084232330322
Epoch: 10, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5875663757324219
Epoch: 11, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.559659481048584
Epoch: 12, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 37729539
model size : 158.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0246763229370117
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4550004005432129
Epoch: 2, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48929905891418457
Epoch: 3, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49591636657714844
Epoch: 4, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.45168018341064453
Epoch: 5, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5585165023803711
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4553241729736328
Epoch: 7, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4868507385253906
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.48892807960510254
Epoch: 9, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.48886895179748535
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5111205577850342
Epoch: 11, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5276501178741455
Epoch: 12, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4878976345062256
Epoch: 13, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5337450504302979
Epoch: 14, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5123240947723389
Epoch: 15, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5161905288696289
Epoch: 16, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4878072738647461
Epoch: 17, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.465059757232666
Epoch: 18, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.41298508644104004
Epoch: 19, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5029110908508301
Epoch: 20, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.464876651763916
Epoch: 21, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4757804870605469
Epoch: 22, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5479941368103027
Epoch: 23, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4640202522277832
Epoch: 24, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.49793434143066406
Epoch: 25, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4506688117980957
Epoch: 26, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4630558490753174
Epoch: 27, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37587459
model size : 158.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3776166439056396
Epoch: 1, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.48429441452026367
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5358779430389404
Epoch: 3, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5293231010437012
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4490940570831299
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43955564498901367
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.48955345153808594
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.520594596862793
Epoch: 8, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.48763394355773926
Epoch: 9, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.47820281982421875
Epoch: 10, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.43995141983032227
Epoch: 11, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.43699097633361816
Epoch: 12, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.45693254470825195
Epoch: 13, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.5061616897583008
Epoch: 14, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.526033878326416
Epoch: 15, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4179351329803467
Epoch: 16, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.43886733055114746
Epoch: 17, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4566824436187744
Epoch: 18, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.43370866775512695
Epoch: 19, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.508807897567749
Epoch: 20, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.47137951850891113
Epoch: 21, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4517045021057129
Epoch: 22, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4993593692779541
Epoch: 23, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.463336706161499
Epoch: 24, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4495832920074463
Epoch: 25, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37518339
model size : 157.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps132_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0973498821258545
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.036 Vali Acc: 0.667 Test Loss: 1.036 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.369218111038208
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38425135612487793
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.45754027366638184
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4625222682952881
Epoch: 5, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.48102807998657227
Epoch: 6, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5366318225860596
Epoch: 7, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.42213892936706543
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.49710559844970703
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.500669002532959
Epoch: 10, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.42580080032348633
Epoch: 11, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.3909330368041992
Epoch: 12, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.48836708068847656
Epoch: 13, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.014 Vali Acc: 0.333 Test Loss: 1.014 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps132_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 37782531
model size : 158.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.063225746154785
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4657270908355713
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46073174476623535
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45711302757263184
Epoch: 4, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.46002721786499023
Epoch: 5, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4199409484863281
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4126243591308594
Epoch: 7, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5425558090209961
Epoch: 8, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4256150722503662
Epoch: 9, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4043738842010498
Epoch: 10, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.45081281661987305
Epoch: 11, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4405825138092041
Epoch: 12, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.41352152824401855
Epoch: 13, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.45966219902038574
Epoch: 14, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.4739835262298584
Epoch: 15, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.42691469192504883
Epoch: 16, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4779341220855713
Epoch: 17, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5400300025939941
Epoch: 18, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4783298969268799
Epoch: 19, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5024662017822266
Epoch: 20, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.473355770111084
Epoch: 21, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4369320869445801
Epoch: 22, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4660189151763916
Epoch: 23, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.41217970848083496
Epoch: 24, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 37644291
model size : 158.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps132_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.973036289215088
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4754798412322998
Epoch: 2, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38265275955200195
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44946908950805664
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4517819881439209
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46064329147338867
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5079939365386963
Epoch: 7, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.420290470123291
Epoch: 8, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4922909736633301
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4143962860107422
Epoch: 10, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.48752403259277344
Epoch: 11, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps132_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37575171
model size : 158.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps139_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.07108736038208
Epoch: 1, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4383273124694824
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.47552061080932617
Epoch: 3, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4726259708404541
Epoch: 4, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5113835334777832
Epoch: 5, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4603562355041504
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.43947339057922363
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.48790669441223145
Epoch: 8, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4602236747741699
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5429809093475342
Epoch: 10, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5130949020385742
Epoch: 11, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.46732020378112793
Epoch: 12, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps139_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37831683
model size : 158.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps139_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0402023792266846
Epoch: 1, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5325727462768555
Epoch: 2, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.48656344413757324
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.41509008407592773
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.216 Vali Acc: 0.133 Test Loss: 1.216 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.426128625869751
Epoch: 5, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.216 Vali Acc: 0.133 Test Loss: 1.216 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4510178565979004
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.207 Vali Acc: 0.133 Test Loss: 1.207 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5094964504241943
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.194 Vali Acc: 0.133 Test Loss: 1.194 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.47432422637939453
Epoch: 8, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.3623967170715332
Epoch: 9, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.42975521087646484
Epoch: 10, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4611020088195801
Epoch: 11, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4440138339996338
Epoch: 12, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps139_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37701123
model size : 158.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps139_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8135583400726318
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.34841442108154297
Epoch: 2, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44698095321655273
Epoch: 3, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4652881622314453
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.41956067085266113
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.42472195625305176
Epoch: 6, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.42000889778137207
Epoch: 7, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4919121265411377
Epoch: 8, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4637899398803711
Epoch: 9, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.35553598403930664
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.41411399841308594
Epoch: 11, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5171627998352051
Epoch: 12, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.38348841667175293
Epoch: 13, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.441756010055542
Epoch: 14, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.4167773723602295
Epoch: 15, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.37954115867614746
Epoch: 16, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.45869970321655273
Epoch: 17, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.46916651725769043
Epoch: 18, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.44145774841308594
Epoch: 19, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.44351959228515625
Epoch: 20, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.38811540603637695
Epoch: 21, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4516940116882324
Epoch: 22, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4494361877441406
Epoch: 23, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4146387577056885
Epoch: 24, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.47543764114379883
Epoch: 25, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4548225402832031
Epoch: 26, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.389693021774292
Epoch: 27, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4001624584197998
Epoch: 28, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps139_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37635843
model size : 158.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps148_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.092705011367798
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3772876262664795
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43859314918518066
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4560587406158447
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5001225471496582
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5045022964477539
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3968160152435303
Epoch: 7, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.41912341117858887
Epoch: 8, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4443092346191406
Epoch: 9, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.47082042694091797
Epoch: 10, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.4594690799713135
Epoch: 11, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4050872325897217
Epoch: 12, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4159095287322998
Epoch: 13, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4396395683288574
Epoch: 14, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 0.48221278190612793
Epoch: 15, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4175589084625244
Epoch: 16, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4865422248840332
Epoch: 17, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.45038914680480957
Epoch: 18, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.47565436363220215
Epoch: 19, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.47394323348999023
Epoch: 20, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5512495040893555
Epoch: 21, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.48647284507751465
Epoch: 22, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.49030470848083496
Epoch: 23, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5087831020355225
Epoch: 24, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps148_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 37899267
model size : 159.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps148_str74_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.771862268447876
Epoch: 1, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46680116653442383
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46141886711120605
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4473912715911865
Epoch: 4, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4259641170501709
Epoch: 5, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3809976577758789
Epoch: 6, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.3999507427215576
Epoch: 7, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.46184539794921875
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.40556931495666504
Epoch: 9, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.5438687801361084
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5576663017272949
Epoch: 11, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.49291372299194336
Epoch: 12, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4499959945678711
Epoch: 13, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.37287402153015137
Epoch: 14, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4671626091003418
Epoch: 15, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4900679588317871
Epoch: 16, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.557265043258667
Epoch: 17, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4341254234313965
Epoch: 18, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.40982484817504883
Epoch: 19, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps148_str74_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37776387
model size : 158.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps148_str148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0981545448303223
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.436906099319458
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5245997905731201
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.43143248558044434
Epoch: 4, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.46860194206237793
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4639713764190674
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.37278246879577637
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.38284778594970703
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.40769124031066895
Epoch: 9, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5071775913238525
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.535456657409668
Epoch: 11, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5290019512176514
Epoch: 12, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.5412309169769287
Epoch: 13, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5018095970153809
Epoch: 14, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4189765453338623
Epoch: 15, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5382668972015381
Epoch: 16, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4053685665130615
Epoch: 17, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.39864420890808105
Epoch: 18, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.48758578300476074
Epoch: 19, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5130326747894287
Epoch: 20, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.5361659526824951
Epoch: 21, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6216802597045898
Epoch: 22, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.45031166076660156
Epoch: 23, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4129452705383301
Epoch: 24, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.48107194900512695
Epoch: 25, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.42455172538757324
Epoch: 26, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.49857234954833984
Epoch: 27, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.446366548538208
Epoch: 28, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5473380088806152
Epoch: 29, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.43560004234313965
Epoch: 30, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps148_str148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37714947
model size : 158.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps157_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0900044441223145
Epoch: 1, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.36971020698547363
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.36528635025024414
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3764073848724365
Epoch: 4, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.46687841415405273
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.41323018074035645
Epoch: 6, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4156303405761719
Epoch: 7, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4287397861480713
Epoch: 8, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.44492030143737793
Epoch: 9, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4120149612426758
Epoch: 10, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.46959757804870605
Epoch: 11, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps157_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 37963011
model size : 159.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps157_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.006291627883911
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.43183374404907227
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46625661849975586
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5806469917297363
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4479997158050537
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5041146278381348
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.47353601455688477
Epoch: 7, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.46729540824890137
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5080227851867676
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5126259326934814
Epoch: 10, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5550386905670166
Epoch: 11, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5488851070404053
Epoch: 12, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.6116831302642822
Epoch: 13, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.5152947902679443
Epoch: 14, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.5940630435943604
Epoch: 15, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5823342800140381
Epoch: 16, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.5235872268676758
Epoch: 17, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.5604434013366699
Epoch: 18, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.5223178863525391
Epoch: 19, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.5071084499359131
Epoch: 20, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.5619692802429199
Epoch: 21, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.4674549102783203
Epoch: 22, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.4942741394042969
Epoch: 23, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.4841020107269287
Epoch: 24, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.5955901145935059
Epoch: 25, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4299614429473877
Epoch: 26, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5742983818054199
Epoch: 27, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6251158714294434
Epoch: 28, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.445422887802124
Epoch: 29, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5297203063964844
Epoch: 30, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5344514846801758
Epoch: 31, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5353817939758301
Epoch: 32, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5019688606262207
Epoch: 33, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.43562984466552734
Epoch: 34, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps157_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 37851651
model size : 159.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps157_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.943363904953003
Epoch: 1, Steps: 1 | Train Loss: 1.306 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4409635066986084
Epoch: 2, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.4411897659301758
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4771304130554199
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.43740010261535645
Epoch: 5, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.44912099838256836
Epoch: 6, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.46957945823669434
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5171709060668945
Epoch: 8, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4440653324127197
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5492265224456787
Epoch: 10, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.41818666458129883
Epoch: 11, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4457874298095703
Epoch: 12, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.417417049407959
Epoch: 13, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.43974828720092773
Epoch: 14, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.42638683319091797
Epoch: 15, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.45584964752197266
Epoch: 16, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.3998093605041504
Epoch: 17, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4645721912384033
Epoch: 18, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4300074577331543
Epoch: 19, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4543313980102539
Epoch: 20, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps157_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 37794051
model size : 158.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0683233737945557
Epoch: 1, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5066218376159668
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.535785436630249
Epoch: 3, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.47471117973327637
Epoch: 4, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4824490547180176
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5339574813842773
Epoch: 6, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4338388442993164
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.48798656463623047
Epoch: 8, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5422470569610596
Epoch: 9, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5438625812530518
Epoch: 10, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6060762405395508
Epoch: 11, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5848579406738281
Epoch: 12, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5341479778289795
Epoch: 13, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.5906293392181396
Epoch: 14, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.5712344646453857
Epoch: 15, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5699872970581055
Epoch: 16, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5048606395721436
Epoch: 17, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5319762229919434
Epoch: 18, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.47943782806396484
Epoch: 19, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5059418678283691
Epoch: 20, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5273149013519287
Epoch: 21, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4321577548980713
Epoch: 22, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4981684684753418
Epoch: 23, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.47136998176574707
Epoch: 24, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 38043651
model size : 159.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.269817352294922
Epoch: 1, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.4772028923034668
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45863890647888184
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4680333137512207
Epoch: 4, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.46912384033203125
Epoch: 5, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46941137313842773
Epoch: 6, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.48719120025634766
Epoch: 7, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5077059268951416
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.4388875961303711
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4911816120147705
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.49370574951171875
Epoch: 11, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.45206165313720703
Epoch: 12, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4935901165008545
Epoch: 13, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.43245649337768555
Epoch: 14, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4154791831970215
Epoch: 15, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.40297675132751465
Epoch: 16, Steps: 1 | Train Loss: 0.440 Vali Loss: 0.993 Vali Acc: 0.467 Test Loss: 0.993 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.43494701385498047
Epoch: 17, Steps: 1 | Train Loss: 0.376 Vali Loss: 0.986 Vali Acc: 0.467 Test Loss: 0.986 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.46095919609069824
Epoch: 18, Steps: 1 | Train Loss: 0.321 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4128704071044922
Epoch: 19, Steps: 1 | Train Loss: 0.300 Vali Loss: 0.982 Vali Acc: 0.533 Test Loss: 0.982 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.38834714889526367
Epoch: 20, Steps: 1 | Train Loss: 0.245 Vali Loss: 0.983 Vali Acc: 0.533 Test Loss: 0.983 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.43621110916137695
Epoch: 21, Steps: 1 | Train Loss: 0.231 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.47469639778137207
Epoch: 22, Steps: 1 | Train Loss: 0.195 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.45720839500427246
Epoch: 23, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.46491360664367676
Epoch: 24, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5178127288818359
Epoch: 25, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 37936131
model size : 159.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3660855293273926
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5385291576385498
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.457244873046875
Epoch: 3, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4842400550842285
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.44997262954711914
Epoch: 5, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.5098025798797607
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.075 Vali Acc: 0.667 Test Loss: 1.075 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.5299122333526611
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.072 Vali Acc: 0.733 Test Loss: 1.072 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 0.5428557395935059
Epoch: 8, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.069 Vali Acc: 0.733 Test Loss: 1.069 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 0.4423196315765381
Epoch: 9, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.064 Vali Acc: 0.667 Test Loss: 1.064 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4571566581726074
Epoch: 10, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.45203542709350586
Epoch: 11, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5233449935913086
Epoch: 12, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.44528770446777344
Epoch: 13, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5175678730010986
Epoch: 14, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4551515579223633
Epoch: 15, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.47561120986938477
Epoch: 16, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4827311038970947
Epoch: 17, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5205378532409668
Epoch: 18, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 37882371
model size : 159.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps179_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1785106658935547
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46959638595581055
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5461034774780273
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.4334137439727783
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5183854103088379
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4053318500518799
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5005002021789551
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.510901689529419
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4282686710357666
Epoch: 9, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5793194770812988
Epoch: 10, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5756394863128662
Epoch: 11, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.46264004707336426
Epoch: 12, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4933156967163086
Epoch: 13, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.45442819595336914
Epoch: 14, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.47493767738342285
Epoch: 15, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4300713539123535
Epoch: 16, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5699751377105713
Epoch: 17, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5014429092407227
Epoch: 18, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.46464109420776367
Epoch: 19, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5211751461029053
Epoch: 20, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps179_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 38138883
model size : 160.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps179_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.105605363845825
Epoch: 1, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4390275478363037
Epoch: 2, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.41632938385009766
Epoch: 3, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4055156707763672
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4416961669921875
Epoch: 5, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.516204833984375
Epoch: 6, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4623832702636719
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.386307954788208
Epoch: 8, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.38536763191223145
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4017970561981201
Epoch: 10, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4653940200805664
Epoch: 11, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.46036529541015625
Epoch: 12, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps179_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 38039043
model size : 159.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps179_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.880037784576416
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.45928192138671875
Epoch: 2, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3667008876800537
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4037649631500244
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3657076358795166
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.40965914726257324
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.42395567893981934
Epoch: 7, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.45479702949523926
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.35747241973876953
Epoch: 9, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.40747714042663574
Epoch: 10, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.47725796699523926
Epoch: 11, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5620267391204834
Epoch: 12, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps179_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37989123
model size : 159.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps193_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.214538335800171
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5027425289154053
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6587584018707275
Epoch: 3, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4664041996002197
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.44829440116882324
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4446392059326172
Epoch: 6, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.7511200904846191
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4405980110168457
Epoch: 8, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5064969062805176
Epoch: 9, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.501838207244873
Epoch: 10, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.43969011306762695
Epoch: 11, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.5235862731933594
Epoch: 12, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47201037406921387
Epoch: 13, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4650702476501465
Epoch: 14, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5175073146820068
Epoch: 15, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4173555374145508
Epoch: 16, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.483020544052124
Epoch: 17, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5011062622070312
Epoch: 18, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.486997127532959
Epoch: 19, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4174518585205078
Epoch: 20, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.48193931579589844
Epoch: 21, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps193_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 38252547
model size : 160.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps193_str97_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9865734577178955
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.225 Vali Acc: 0.133 Test Loss: 1.225 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.46460413932800293
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.197 Vali Acc: 0.133 Test Loss: 1.197 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.4335000514984131
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.202 Vali Acc: 0.133 Test Loss: 1.202 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5600764751434326
Epoch: 4, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.133321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5059058666229248
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4636855125427246
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.41486167907714844
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.4324531555175781
Epoch: 8, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3774104118347168
Epoch: 9, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5156960487365723
Epoch: 10, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5042753219604492
Epoch: 11, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4873688220977783
Epoch: 12, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5198249816894531
Epoch: 13, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.48892951011657715
Epoch: 14, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.48705339431762695
Epoch: 15, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4808974266052246
Epoch: 16, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.44553303718566895
Epoch: 17, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.38942933082580566
Epoch: 18, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.42482876777648926
Epoch: 19, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps193_str97_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 38160387
model size : 160.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps193_str193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8395233154296875
Epoch: 1, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4528176784515381
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4071996212005615
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.45963406562805176
Epoch: 4, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.46629810333251953
Epoch: 5, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49744629859924316
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5212864875793457
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.37105464935302734
Epoch: 8, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4574465751647949
Epoch: 9, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4204835891723633
Epoch: 10, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4138193130493164
Epoch: 11, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.45084571838378906
Epoch: 12, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.4191780090332031
Epoch: 13, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5123209953308105
Epoch: 14, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5501928329467773
Epoch: 15, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4032301902770996
Epoch: 16, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.505831241607666
Epoch: 17, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.078 Vali Acc: 0.200 Test Loss: 1.078 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5189111232757568
Epoch: 18, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.080 Vali Acc: 0.200 Test Loss: 1.080 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4452338218688965
Epoch: 19, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4845147132873535
Epoch: 20, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4435994625091553
Epoch: 21, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.3947620391845703
Epoch: 22, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps193_str193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 38114307
model size : 160.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps209_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3754570484161377
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5131919384002686
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4586362838745117
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49498915672302246
Epoch: 4, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5319080352783203
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4410398006439209
Epoch: 6, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4256713390350342
Epoch: 7, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5373034477233887
Epoch: 8, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4695742130279541
Epoch: 9, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5311846733093262
Epoch: 10, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.441051721572876
Epoch: 11, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.5442013740539551
Epoch: 12, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4809410572052002
Epoch: 13, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5114946365356445
Epoch: 14, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5443789958953857
Epoch: 15, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5168378353118896
Epoch: 16, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5113368034362793
Epoch: 17, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.521336555480957
Epoch: 18, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4906349182128906
Epoch: 19, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5675168037414551
Epoch: 20, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5609006881713867
Epoch: 21, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps209_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 38384643
model size : 161.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps209_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0915868282318115
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.44118547439575195
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40761542320251465
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.40700531005859375
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3734116554260254
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4027431011199951
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3607490062713623
Epoch: 7, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5262136459350586
Epoch: 8, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4638805389404297
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4128694534301758
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4586963653564453
Epoch: 11, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5002188682556152
Epoch: 12, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4194653034210205
Epoch: 13, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.46100378036499023
Epoch: 14, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4416682720184326
Epoch: 15, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4651916027069092
Epoch: 16, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5117144584655762
Epoch: 17, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4408891201019287
Epoch: 18, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.47217702865600586
Epoch: 19, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.49770665168762207
Epoch: 20, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.43596339225769043
Epoch: 21, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps209_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 38300163
model size : 160.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps209_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8715875148773193
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3748812675476074
Epoch: 2, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4405198097229004
Epoch: 3, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.3918185234069824
Epoch: 4, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.4295504093170166
Epoch: 5, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.43180155754089355
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.43833470344543457
Epoch: 7, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5264065265655518
Epoch: 8, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4398305416107178
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4252438545227051
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.40101194381713867
Epoch: 11, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.4451754093170166
Epoch: 12, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.3747560977935791
Epoch: 13, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4099113941192627
Epoch: 14, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.36850786209106445
Epoch: 15, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4219646453857422
Epoch: 16, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4428706169128418
Epoch: 17, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.46239280700683594
Epoch: 18, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4618644714355469
Epoch: 19, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.37140774726867676
Epoch: 20, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5278456211090088
Epoch: 21, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4133737087249756
Epoch: 22, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps209_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 38257923
model size : 160.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps228_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1387617588043213
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.4655601978302002
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42107415199279785
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4159858226776123
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.49037885665893555
Epoch: 5, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4258391857147217
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.37548398971557617
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.40424299240112305
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5053689479827881
Epoch: 9, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.449155330657959
Epoch: 10, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.46621155738830566
Epoch: 11, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5071136951446533
Epoch: 12, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.41667628288269043
Epoch: 13, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.48065948486328125
Epoch: 14, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps228_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 38544387
model size : 161.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps228_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.026679515838623
Epoch: 1, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3937852382659912
Epoch: 2, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4110589027404785
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4022257328033447
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5502612590789795
Epoch: 5, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6223196983337402
Epoch: 6, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5432569980621338
Epoch: 7, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.48322367668151855
Epoch: 8, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.42339301109313965
Epoch: 9, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6442232131958008
Epoch: 10, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6075899600982666
Epoch: 11, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4639770984649658
Epoch: 12, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5361602306365967
Epoch: 13, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.6070783138275146
Epoch: 14, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3930015563964844
Epoch: 15, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4963188171386719
Epoch: 16, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.5221803188323975
Epoch: 17, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.5522263050079346
Epoch: 18, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4753086566925049
Epoch: 19, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.38094520568847656
Epoch: 20, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.44711875915527344
Epoch: 21, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.5418829917907715
Epoch: 22, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5532846450805664
Epoch: 23, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4988431930541992
Epoch: 24, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.45280885696411133
Epoch: 25, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5328967571258545
Epoch: 26, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4342825412750244
Epoch: 27, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5834283828735352
Epoch: 28, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5267946720123291
Epoch: 29, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5306954383850098
Epoch: 30, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.45929837226867676
Epoch: 31, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps228_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 38467587
model size : 161.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps228_str228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.956547498703003
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4363362789154053
Epoch: 2, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3959066867828369
Epoch: 3, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.41760969161987305
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.46528100967407227
Epoch: 5, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5007157325744629
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.47510385513305664
Epoch: 7, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3993208408355713
Epoch: 8, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4699215888977051
Epoch: 9, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.48191165924072266
Epoch: 10, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4328789710998535
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.48986101150512695
Epoch: 12, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.6189231872558594
Epoch: 13, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.4986112117767334
Epoch: 14, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.45032715797424316
Epoch: 15, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.45120930671691895
Epoch: 16, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.109 Vali Acc: 0.133 Test Loss: 1.109 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.3850367069244385
Epoch: 17, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.106 Vali Acc: 0.133 Test Loss: 1.106 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4285600185394287
Epoch: 18, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.4273519515991211
Epoch: 19, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.48282766342163086
Epoch: 20, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.4684748649597168
Epoch: 21, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.491349458694458
Epoch: 22, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6039938926696777
Epoch: 23, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4516427516937256
Epoch: 24, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.41185832023620605
Epoch: 25, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.46014833450317383
Epoch: 26, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.44779372215270996
Epoch: 27, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5362100601196289
Epoch: 28, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4666635990142822
Epoch: 29, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.3831136226654053
Epoch: 30, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4315309524536133
Epoch: 31, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps228_str228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 38429187
model size : 161.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0113365650177
Epoch: 1, Steps: 1 | Train Loss: 1.346 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.40148043632507324
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.3962972164154053
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.455033540725708
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4307894706726074
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4626598358154297
Epoch: 6, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.500434398651123
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.45632338523864746
Epoch: 8, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4414052963256836
Epoch: 9, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4347066879272461
Epoch: 10, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.390655517578125
Epoch: 11, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.39592671394348145
Epoch: 12, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 38731779
model size : 162.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8467910289764404
Epoch: 1, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3984181880950928
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5418756008148193
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.183 Vali Acc: 0.133 Test Loss: 1.183 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.40671372413635254
Epoch: 4, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4358959197998047
Epoch: 5, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.179 Vali Acc: 0.133 Test Loss: 1.179 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43471264839172363
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5063936710357666
Epoch: 7, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.47783780097961426
Epoch: 8, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.45511674880981445
Epoch: 9, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4508841037750244
Epoch: 10, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.39474034309387207
Epoch: 11, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 38666499
model size : 162.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1447417736053467
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5023844242095947
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5414080619812012
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.510206937789917
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4190397262573242
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4139406681060791
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5366969108581543
Epoch: 7, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4927065372467041
Epoch: 8, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5694563388824463
Epoch: 9, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5088624954223633
Epoch: 10, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5303308963775635
Epoch: 11, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.49604105949401855
Epoch: 12, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4984397888183594
Epoch: 13, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5276525020599365
Epoch: 14, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.47563600540161133
Epoch: 15, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.46089839935302734
Epoch: 16, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4986910820007324
Epoch: 17, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4467470645904541
Epoch: 18, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.46721673011779785
Epoch: 19, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5021138191223145
Epoch: 20, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.47127628326416016
Epoch: 21, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.466961145401001
Epoch: 22, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5291492938995361
Epoch: 23, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5574483871459961
Epoch: 24, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5126657485961914
Epoch: 25, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.37403178215026855
Epoch: 26, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.635084867477417
Epoch: 27, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5444495677947998
Epoch: 28, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 29 cost time: 0.5648820400238037
Epoch: 29, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4583888053894043
Epoch: 30, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.44985485076904297
Epoch: 31, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5306189060211182
Epoch: 32, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.38176727294921875
Epoch: 33, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 34 cost time: 0.4341559410095215
Epoch: 34, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.49062275886535645
Epoch: 35, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.3803679943084717
Epoch: 36, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.44841742515563965
Epoch: 37, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.313 Vali Acc: 0.333 Test Loss: 1.313 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.45995068550109863
Epoch: 38, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.328 Vali Acc: 0.333 Test Loss: 1.328 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.46245527267456055
Epoch: 39, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.344 Vali Acc: 0.333 Test Loss: 1.344 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4877586364746094
Epoch: 40, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.358 Vali Acc: 0.333 Test Loss: 1.358 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.46297264099121094
Epoch: 41, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.371 Vali Acc: 0.333 Test Loss: 1.371 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5274055004119873
Epoch: 42, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.384 Vali Acc: 0.333 Test Loss: 1.384 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4524955749511719
Epoch: 43, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.396 Vali Acc: 0.333 Test Loss: 1.396 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 38631939
model size : 162.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps278_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.136676549911499
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.4435572624206543
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.48849940299987793
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.39648985862731934
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5866734981536865
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4399747848510742
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4328165054321289
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.45059800148010254
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4409339427947998
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.49284791946411133
Epoch: 10, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.49426770210266113
Epoch: 11, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.49468994140625
Epoch: 12, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.41290736198425293
Epoch: 13, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.47678685188293457
Epoch: 14, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.45320653915405273
Epoch: 15, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.43696093559265137
Epoch: 16, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.45225977897644043
Epoch: 17, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.49587130546569824
Epoch: 18, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.45451784133911133
Epoch: 19, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps278_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 38974467
model size : 163.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps278_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8405990600585938
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.43180394172668457
Epoch: 2, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4314725399017334
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49149346351623535
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4398317337036133
Epoch: 5, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3906879425048828
Epoch: 6, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.41002726554870605
Epoch: 7, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3350818157196045
Epoch: 8, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4424550533294678
Epoch: 9, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.43352246284484863
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.41272401809692383
Epoch: 11, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps278_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 38913027
model size : 163.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps278_str278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8119852542877197
Epoch: 1, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.44609522819519043
Epoch: 2, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.48662805557250977
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4274482727050781
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4346773624420166
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5175826549530029
Epoch: 6, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5236508846282959
Epoch: 7, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.41004133224487305
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4007859230041504
Epoch: 9, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4475831985473633
Epoch: 10, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.424424409866333
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5180978775024414
Epoch: 12, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.3466212749481201
Epoch: 13, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps278_str278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 38882307
model size : 163.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps313_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1630046367645264
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4059329032897949
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5156207084655762
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3710451126098633
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.43011045455932617
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4195704460144043
Epoch: 6, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5064189434051514
Epoch: 7, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3955235481262207
Epoch: 8, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4430882930755615
Epoch: 9, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5115714073181152
Epoch: 10, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4327247142791748
Epoch: 11, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4862089157104492
Epoch: 12, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4374828338623047
Epoch: 13, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4743318557739258
Epoch: 14, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4200115203857422
Epoch: 15, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4681527614593506
Epoch: 16, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.46962475776672363
Epoch: 17, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4522745609283447
Epoch: 18, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 19 cost time: 0.47930073738098145
Epoch: 19, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4752209186553955
Epoch: 20, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5290277004241943
Epoch: 21, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4647336006164551
Epoch: 22, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5000438690185547
Epoch: 23, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.223 Vali Acc: 0.467 Test Loss: 1.223 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.577796220779419
Epoch: 24, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.247 Vali Acc: 0.533 Test Loss: 1.247 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 25 cost time: 0.5253818035125732
Epoch: 25, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.271 Vali Acc: 0.467 Test Loss: 1.271 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.44335031509399414
Epoch: 26, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.294 Vali Acc: 0.467 Test Loss: 1.294 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4642972946166992
Epoch: 27, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.316 Vali Acc: 0.467 Test Loss: 1.316 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4491250514984131
Epoch: 28, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.339 Vali Acc: 0.467 Test Loss: 1.339 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4444699287414551
Epoch: 29, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.47699952125549316
Epoch: 30, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.380 Vali Acc: 0.467 Test Loss: 1.380 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5277111530303955
Epoch: 31, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.399 Vali Acc: 0.467 Test Loss: 1.399 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5425088405609131
Epoch: 32, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.417 Vali Acc: 0.467 Test Loss: 1.417 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.48580098152160645
Epoch: 33, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.435 Vali Acc: 0.467 Test Loss: 1.435 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4284343719482422
Epoch: 34, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.454 Vali Acc: 0.467 Test Loss: 1.454 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps313_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 39281667
model size : 164.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps313_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0828890800476074
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4600374698638916
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3991103172302246
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4940645694732666
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3931097984313965
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40709686279296875
Epoch: 6, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5151970386505127
Epoch: 7, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.43257617950439453
Epoch: 8, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.44481921195983887
Epoch: 9, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.38141345977783203
Epoch: 10, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.4786655902862549
Epoch: 11, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.3259551525115967
Epoch: 12, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.45148754119873047
Epoch: 13, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5024464130401611
Epoch: 14, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.46057891845703125
Epoch: 15, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.068 Vali Acc: 0.267 Test Loss: 1.068 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4524965286254883
Epoch: 16, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.44225049018859863
Epoch: 17, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4407312870025635
Epoch: 18, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3838353157043457
Epoch: 19, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4699254035949707
Epoch: 20, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.43520569801330566
Epoch: 21, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.41417527198791504
Epoch: 22, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps313_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 39227907
model size : 164.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps313_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.112898349761963
Epoch: 1, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.29735755920410156
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3500173091888428
Epoch: 3, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3686556816101074
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.37502574920654297
Epoch: 5, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4400174617767334
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.33595752716064453
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4326314926147461
Epoch: 8, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4254758358001709
Epoch: 9, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.42073774337768555
Epoch: 10, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.36646366119384766
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.3399066925048828
Epoch: 12, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3400275707244873
Epoch: 13, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.3809239864349365
Epoch: 14, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.34539294242858887
Epoch: 15, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.3386874198913574
Epoch: 16, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.37308359146118164
Epoch: 17, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.4212188720703125
Epoch: 18, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.4387693405151367
Epoch: 19, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.3953216075897217
Epoch: 20, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.40917539596557617
Epoch: 21, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.3820774555206299
Epoch: 22, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.3637535572052002
Epoch: 23, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.34157514572143555
Epoch: 24, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.3068122863769531
Epoch: 25, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.40292882919311523
Epoch: 26, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.35034656524658203
Epoch: 27, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.3490331172943115
Epoch: 28, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.35860490798950195
Epoch: 29, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps313_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 39201027
model size : 164.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps358_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.87367582321167
Epoch: 1, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3666818141937256
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4551229476928711
Epoch: 3, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.43362855911254883
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.41614317893981934
Epoch: 5, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.4079465866088867
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.44499897956848145
Epoch: 7, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.39739155769348145
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.463824987411499
Epoch: 9, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5294523239135742
Epoch: 10, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4383852481842041
Epoch: 11, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4177114963531494
Epoch: 12, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4463658332824707
Epoch: 13, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4337491989135742
Epoch: 14, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.425173282623291
Epoch: 15, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.47988128662109375
Epoch: 16, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.009 Vali Acc: 0.333 Test Loss: 1.009 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.39338040351867676
Epoch: 17, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.007 Vali Acc: 0.333 Test Loss: 1.007 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.3621861934661865
Epoch: 18, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.007 Vali Acc: 0.333 Test Loss: 1.007 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps358_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 39681027
model size : 166.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps358_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2111010551452637
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.470717191696167
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5037226676940918
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5264744758605957
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4200422763824463
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.36313295364379883
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3823201656341553
Epoch: 7, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.47379446029663086
Epoch: 8, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.43923401832580566
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.44594264030456543
Epoch: 10, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4089024066925049
Epoch: 11, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5411615371704102
Epoch: 12, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5443079471588135
Epoch: 13, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.455308198928833
Epoch: 14, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.40797877311706543
Epoch: 15, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.45869922637939453
Epoch: 16, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.36109471321105957
Epoch: 17, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4008631706237793
Epoch: 18, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.46323490142822266
Epoch: 19, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5431432723999023
Epoch: 20, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps358_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 39634947
model size : 165.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps358_str358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.138007879257202
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.44695281982421875
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42458057403564453
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.44481444358825684
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3714175224304199
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5230071544647217
Epoch: 6, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4774141311645508
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.466048002243042
Epoch: 8, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.505159854888916
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4723796844482422
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.49959897994995117
Epoch: 11, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.5319035053253174
Epoch: 12, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.5632236003875732
Epoch: 13, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5318698883056641
Epoch: 14, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.5078167915344238
Epoch: 15, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.4753737449645996
Epoch: 16, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.46820068359375
Epoch: 17, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4885838031768799
Epoch: 18, Steps: 1 | Train Loss: 0.381 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.50992751121521
Epoch: 19, Steps: 1 | Train Loss: 0.354 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.45387887954711914
Epoch: 20, Steps: 1 | Train Loss: 0.299 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.5404658317565918
Epoch: 21, Steps: 1 | Train Loss: 0.215 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.4324769973754883
Epoch: 22, Steps: 1 | Train Loss: 0.222 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 23 cost time: 0.44695591926574707
Epoch: 23, Steps: 1 | Train Loss: 0.165 Vali Loss: 0.986 Vali Acc: 0.667 Test Loss: 0.986 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 24 cost time: 0.595890998840332
Epoch: 24, Steps: 1 | Train Loss: 0.171 Vali Loss: 0.985 Vali Acc: 0.667 Test Loss: 0.985 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 0.4853379726409912
Epoch: 25, Steps: 1 | Train Loss: 0.119 Vali Loss: 0.984 Vali Acc: 0.667 Test Loss: 0.984 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 0.6893744468688965
Epoch: 26, Steps: 1 | Train Loss: 0.103 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 0.4897644519805908
Epoch: 27, Steps: 1 | Train Loss: 0.079 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 0.43328189849853516
Epoch: 28, Steps: 1 | Train Loss: 0.071 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 29 cost time: 0.47046756744384766
Epoch: 29, Steps: 1 | Train Loss: 0.062 Vali Loss: 0.982 Vali Acc: 0.667 Test Loss: 0.982 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 0.46160101890563965
Epoch: 30, Steps: 1 | Train Loss: 0.040 Vali Loss: 0.982 Vali Acc: 0.667 Test Loss: 0.982 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 31 cost time: 0.48950767517089844
Epoch: 31, Steps: 1 | Train Loss: 0.040 Vali Loss: 0.980 Vali Acc: 0.667 Test Loss: 0.980 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 32 cost time: 0.4831829071044922
Epoch: 32, Steps: 1 | Train Loss: 0.038 Vali Loss: 0.978 Vali Acc: 0.667 Test Loss: 0.978 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 33 cost time: 0.42920780181884766
Epoch: 33, Steps: 1 | Train Loss: 0.026 Vali Loss: 0.976 Vali Acc: 0.667 Test Loss: 0.976 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 34 cost time: 0.44419312477111816
Epoch: 34, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 35 cost time: 0.5235917568206787
Epoch: 35, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4652562141418457
Epoch: 36, Steps: 1 | Train Loss: 0.016 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5260639190673828
Epoch: 37, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.43896937370300293
Epoch: 38, Steps: 1 | Train Loss: 0.015 Vali Loss: 0.960 Vali Acc: 0.600 Test Loss: 0.960 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4995849132537842
Epoch: 39, Steps: 1 | Train Loss: 0.011 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4592020511627197
Epoch: 40, Steps: 1 | Train Loss: 0.010 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4061603546142578
Epoch: 41, Steps: 1 | Train Loss: 0.008 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5269782543182373
Epoch: 42, Steps: 1 | Train Loss: 0.008 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4763755798339844
Epoch: 43, Steps: 1 | Train Loss: 0.005 Vali Loss: 0.951 Vali Acc: 0.600 Test Loss: 0.951 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.37543320655822754
Epoch: 44, Steps: 1 | Train Loss: 0.005 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps358_str358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 39611907
model size : 165.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps417_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.226250410079956
Epoch: 1, Steps: 1 | Train Loss: 1.434 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.44029998779296875
Epoch: 2, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4538741111755371
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4934549331665039
Epoch: 4, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4507629871368408
Epoch: 5, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4640812873840332
Epoch: 6, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.43162965774536133
Epoch: 7, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.46159958839416504
Epoch: 8, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.383436918258667
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4494919776916504
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5192568302154541
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.38103699684143066
Epoch: 12, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.39106297492980957
Epoch: 13, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3769376277923584
Epoch: 14, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.43013834953308105
Epoch: 15, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4167664051055908
Epoch: 16, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4440937042236328
Epoch: 17, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.44278502464294434
Epoch: 18, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4008326530456543
Epoch: 19, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.41881418228149414
Epoch: 20, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5022001266479492
Epoch: 21, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4264042377471924
Epoch: 22, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.47893357276916504
Epoch: 23, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.4920792579650879
Epoch: 24, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.49325037002563477
Epoch: 25, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5098416805267334
Epoch: 26, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4293515682220459
Epoch: 27, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4136800765991211
Epoch: 28, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4414961338043213
Epoch: 29, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5009546279907227
Epoch: 30, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4500610828399658
Epoch: 31, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5078222751617432
Epoch: 32, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5332539081573486
Epoch: 33, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps417_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 40209411
model size : 168.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps417_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0896658897399902
Epoch: 1, Steps: 1 | Train Loss: 1.356 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.477250337600708
Epoch: 2, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3766911029815674
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.44026947021484375
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3443796634674072
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.3865234851837158
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.39510083198547363
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.45360326766967773
Epoch: 8, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.38010334968566895
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.429945707321167
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45157432556152344
Epoch: 11, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.45638608932495117
Epoch: 12, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3884730339050293
Epoch: 13, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.3649749755859375
Epoch: 14, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3705751895904541
Epoch: 15, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.4289097785949707
Epoch: 16, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 17 cost time: 0.42801380157470703
Epoch: 17, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.41436123847961426
Epoch: 18, Steps: 1 | Train Loss: 0.334 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 0.3993558883666992
Epoch: 19, Steps: 1 | Train Loss: 0.290 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4516620635986328
Epoch: 20, Steps: 1 | Train Loss: 0.218 Vali Loss: 0.994 Vali Acc: 0.400 Test Loss: 0.994 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4940786361694336
Epoch: 21, Steps: 1 | Train Loss: 0.182 Vali Loss: 0.995 Vali Acc: 0.400 Test Loss: 0.995 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.42781567573547363
Epoch: 22, Steps: 1 | Train Loss: 0.151 Vali Loss: 0.994 Vali Acc: 0.400 Test Loss: 0.994 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4572172164916992
Epoch: 23, Steps: 1 | Train Loss: 0.134 Vali Loss: 0.994 Vali Acc: 0.400 Test Loss: 0.994 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5071108341217041
Epoch: 24, Steps: 1 | Train Loss: 0.111 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 0.39905428886413574
Epoch: 25, Steps: 1 | Train Loss: 0.081 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.41712284088134766
Epoch: 26, Steps: 1 | Train Loss: 0.083 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.47306251525878906
Epoch: 27, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5150766372680664
Epoch: 28, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3876192569732666
Epoch: 29, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4459371566772461
Epoch: 30, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4860055446624756
Epoch: 31, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.37022852897644043
Epoch: 32, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.3801143169403076
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.4726223945617676
Epoch: 34, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5269594192504883
Epoch: 35, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5277163982391357
Epoch: 36, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.46422266960144043
Epoch: 37, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.42108702659606934
Epoch: 38, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.47536277770996094
Epoch: 39, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.3913264274597168
Epoch: 40, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.49985742568969727
Epoch: 41, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5078299045562744
Epoch: 42, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.44827747344970703
Epoch: 43, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps417_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 40171011
model size : 167.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps417_str417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.093580722808838
Epoch: 1, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4374101161956787
Epoch: 2, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5158262252807617
Epoch: 3, Steps: 1 | Train Loss: 1.311 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4623279571533203
Epoch: 4, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.49834108352661133
Epoch: 5, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5206222534179688
Epoch: 6, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.44979214668273926
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.45891642570495605
Epoch: 8, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.42826223373413086
Epoch: 9, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5589540004730225
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4288146495819092
Epoch: 11, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.457552433013916
Epoch: 12, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4880387783050537
Epoch: 13, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4351329803466797
Epoch: 14, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.41359543800354004
Epoch: 15, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.38971400260925293
Epoch: 16, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.669285774230957
Epoch: 17, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.5081319808959961
Epoch: 18, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.46686315536499023
Epoch: 19, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.43588829040527344
Epoch: 20, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4692068099975586
Epoch: 21, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5224452018737793
Epoch: 22, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5019512176513672
Epoch: 23, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5001952648162842
Epoch: 24, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5486643314361572
Epoch: 25, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4426286220550537
Epoch: 26, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4773850440979004
Epoch: 27, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5026719570159912
Epoch: 28, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps417_str417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 40151811
model size : 167.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0846853256225586
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.129 Vali Acc: 0.133 Test Loss: 1.129 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.46144533157348633
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.40367937088012695
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.42249464988708496
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4052274227142334
Epoch: 5, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.42438721656799316
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.4729936122894287
Epoch: 7, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5237863063812256
Epoch: 8, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4925265312194824
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4313056468963623
Epoch: 10, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.44667577743530273
Epoch: 11, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.48039698600769043
Epoch: 12, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.46579456329345703
Epoch: 13, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.43303799629211426
Epoch: 14, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.086 Vali Acc: 0.200 Test Loss: 1.086 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4225285053253174
Epoch: 15, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.084 Vali Acc: 0.200 Test Loss: 1.084 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4600491523742676
Epoch: 16, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.087 Vali Acc: 0.200 Test Loss: 1.087 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 40962819
model size : 170.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0965304374694824
Epoch: 1, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4559955596923828
Epoch: 2, Steps: 1 | Train Loss: 1.261 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.45679235458374023
Epoch: 3, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.43053483963012695
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.411968469619751
Epoch: 5, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5377371311187744
Epoch: 6, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48090529441833496
Epoch: 7, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.4351222515106201
Epoch: 8, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.40653109550476074
Epoch: 9, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.4420144557952881
Epoch: 10, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.38973140716552734
Epoch: 11, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.513965368270874
Epoch: 12, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4444851875305176
Epoch: 13, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.47866010665893555
Epoch: 14, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.3867976665496826
Epoch: 15, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.3954184055328369
Epoch: 16, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4666280746459961
Epoch: 17, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.40052032470703125
Epoch: 18, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.42037105560302734
Epoch: 19, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 40932099
model size : 170.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0143394470214844
Epoch: 1, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4602994918823242
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5290238857269287
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3814198970794678
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.46396827697753906
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.40770435333251953
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.45340490341186523
Epoch: 7, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.38989973068237305
Epoch: 8, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4808616638183594
Epoch: 9, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.39759302139282227
Epoch: 10, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6052958965301514
Epoch: 11, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.44782543182373047
Epoch: 12, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5441081523895264
Epoch: 13, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.559664249420166
Epoch: 14, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5226609706878662
Epoch: 15, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5001332759857178
Epoch: 16, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el5_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 40916739
model size : 170.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9835395812988281
Epoch: 1, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4792146682739258
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4431326389312744
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5082242488861084
Epoch: 4, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4557955265045166
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4674642086029053
Epoch: 6, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.45826005935668945
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.5402698516845703
Epoch: 8, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4830055236816406
Epoch: 9, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4943113327026367
Epoch: 10, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4645416736602783
Epoch: 11, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5180206298828125
Epoch: 12, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.49017763137817383
Epoch: 13, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5219857692718506
Epoch: 14, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.48540496826171875
Epoch: 15, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4831521511077881
Epoch: 16, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.398637056350708
Epoch: 17, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 30495747
model size : 131.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3269805908203125
Epoch: 1, Steps: 1 | Train Loss: 1.338 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46031761169433594
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.46818017959594727
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4292185306549072
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.42448925971984863
Epoch: 5, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4721500873565674
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4246368408203125
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.47343993186950684
Epoch: 8, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.4514470100402832
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5913863182067871
Epoch: 10, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5021357536315918
Epoch: 11, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.47727441787719727
Epoch: 12, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.45329761505126953
Epoch: 13, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.3945484161376953
Epoch: 14, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.45087194442749023
Epoch: 15, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5206732749938965
Epoch: 16, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.37913060188293457
Epoch: 17, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.3924102783203125
Epoch: 18, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30311427
model size : 130.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0422677993774414
Epoch: 1, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.43529486656188965
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4267091751098633
Epoch: 3, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5168590545654297
Epoch: 4, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7059295177459717
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5105729103088379
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4638357162475586
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5473184585571289
Epoch: 8, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.54278564453125
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.47109436988830566
Epoch: 10, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.135 Vali Acc: 0.133 Test Loss: 1.135 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5823962688446045
Epoch: 11, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.133 Vali Acc: 0.133 Test Loss: 1.133 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 30219267
model size : 129.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.258669137954712
Epoch: 1, Steps: 1 | Train Loss: 1.332 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4870932102203369
Epoch: 2, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5679683685302734
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.522646427154541
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5147242546081543
Epoch: 5, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5109212398529053
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5707435607910156
Epoch: 7, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6309413909912109
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5107052326202393
Epoch: 9, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.5034990310668945
Epoch: 10, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5602531433105469
Epoch: 11, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5207686424255371
Epoch: 12, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5631029605865479
Epoch: 13, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.499408483505249
Epoch: 14, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.423175573348999
Epoch: 15, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4897310733795166
Epoch: 16, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.45649003982543945
Epoch: 17, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.40046119689941406
Epoch: 18, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.48564863204956055
Epoch: 19, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30511107
model size : 131.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.276094436645508
Epoch: 1, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4373035430908203
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.451646089553833
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.42609500885009766
Epoch: 4, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5126175880432129
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.42765307426452637
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.47043633460998535
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.40506529808044434
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.39615702629089355
Epoch: 9, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.37726569175720215
Epoch: 10, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.39197468757629395
Epoch: 11, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4411466121673584
Epoch: 12, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.552107572555542
Epoch: 13, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30345987
model size : 130.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.131347417831421
Epoch: 1, Steps: 1 | Train Loss: 1.636 Vali Loss: 1.384 Vali Acc: 0.333 Test Loss: 1.384 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.5267987251281738
Epoch: 2, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5079593658447266
Epoch: 3, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.47301459312438965
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4843161106109619
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5417160987854004
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4378840923309326
Epoch: 7, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4135265350341797
Epoch: 8, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.3927953243255615
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4568145275115967
Epoch: 10, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.40885043144226074
Epoch: 11, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4422318935394287
Epoch: 12, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5826225280761719
Epoch: 13, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.4593186378479004
Epoch: 14, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4435269832611084
Epoch: 15, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4509110450744629
Epoch: 16, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5416440963745117
Epoch: 17, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5284039974212646
Epoch: 18, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5274217128753662
Epoch: 19, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5114150047302246
Epoch: 20, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.48319244384765625
Epoch: 21, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.536113977432251
Epoch: 22, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.48505258560180664
Epoch: 23, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30257667
model size : 130.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1722803115844727
Epoch: 1, Steps: 1 | Train Loss: 1.364 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.42015933990478516
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.482896089553833
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.4770960807800293
Epoch: 4, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.5011105537414551
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.46558713912963867
Epoch: 6, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.419614315032959
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4435415267944336
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5168581008911133
Epoch: 9, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5100703239440918
Epoch: 10, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5094637870788574
Epoch: 11, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4336721897125244
Epoch: 12, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.5438964366912842
Epoch: 13, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.4256587028503418
Epoch: 14, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4173908233642578
Epoch: 15, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.515519380569458
Epoch: 16, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6555290222167969
Epoch: 17, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4517683982849121
Epoch: 18, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5666978359222412
Epoch: 19, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.49950718879699707
Epoch: 20, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.4676384925842285
Epoch: 21, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5538601875305176
Epoch: 22, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.5363705158233643
Epoch: 23, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5377535820007324
Epoch: 24, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.46439266204833984
Epoch: 25, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4645256996154785
Epoch: 26, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.49153637886047363
Epoch: 27, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.49906444549560547
Epoch: 28, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.372 Vali Acc: 0.333 Test Loss: 1.372 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4575629234313965
Epoch: 29, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.399 Vali Acc: 0.333 Test Loss: 1.399 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4863433837890625
Epoch: 30, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.415 Vali Acc: 0.400 Test Loss: 1.415 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5365979671478271
Epoch: 31, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.426 Vali Acc: 0.400 Test Loss: 1.426 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4583899974822998
Epoch: 32, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 30536451
model size : 131.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9106190204620361
Epoch: 1, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5132405757904053
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38042116165161133
Epoch: 3, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5007150173187256
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5310008525848389
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.46004271507263184
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4422914981842041
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4901604652404785
Epoch: 8, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.44072556495666504
Epoch: 9, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.48184752464294434
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3975183963775635
Epoch: 11, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.511939287185669
Epoch: 12, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.4921140670776367
Epoch: 13, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.49096107482910156
Epoch: 14, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5053479671478271
Epoch: 15, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.42842721939086914
Epoch: 16, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.4725027084350586
Epoch: 17, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.46562767028808594
Epoch: 18, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.4268960952758789
Epoch: 19, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4248061180114746
Epoch: 20, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4551119804382324
Epoch: 21, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4404780864715576
Epoch: 22, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5433588027954102
Epoch: 23, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5621082782745361
Epoch: 24, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4180474281311035
Epoch: 25, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.48984456062316895
Epoch: 26, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4967937469482422
Epoch: 27, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4676694869995117
Epoch: 28, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30375171
model size : 130.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1814095973968506
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4223754405975342
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4094123840332031
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.35367894172668457
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4056885242462158
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.47406840324401855
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4670379161834717
Epoch: 7, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.46367955207824707
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4669480323791504
Epoch: 9, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.45961737632751465
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.3687858581542969
Epoch: 11, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.3900277614593506
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3922104835510254
Epoch: 13, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3916926383972168
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4429299831390381
Epoch: 15, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5354576110839844
Epoch: 16, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5340383052825928
Epoch: 17, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5301451683044434
Epoch: 18, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4889497756958008
Epoch: 19, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4681355953216553
Epoch: 20, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.470874547958374
Epoch: 21, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30290691
model size : 130.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps114_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1510636806488037
Epoch: 1, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.45062971115112305
Epoch: 2, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40212464332580566
Epoch: 3, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4557328224182129
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.4407694339752197
Epoch: 5, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.45588207244873047
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.510871410369873
Epoch: 7, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.41867923736572266
Epoch: 8, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3888211250305176
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4134402275085449
Epoch: 10, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.39420533180236816
Epoch: 11, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.47800421714782715
Epoch: 12, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.050 Vali Acc: 0.267 Test Loss: 1.050 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.504157543182373
Epoch: 13, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5436923503875732
Epoch: 14, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.547074556350708
Epoch: 15, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4244263172149658
Epoch: 16, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4550008773803711
Epoch: 17, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps114_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30571011
model size : 131.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps114_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7409591674804688
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.3681776523590088
Epoch: 2, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.42011570930480957
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4718496799468994
Epoch: 4, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4417574405670166
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.541252851486206
Epoch: 6, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6293935775756836
Epoch: 7, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.43577098846435547
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.157 Vali Acc: 0.067 Test Loss: 1.157 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5147311687469482
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.156 Vali Acc: 0.067 Test Loss: 1.156 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.47707486152648926
Epoch: 10, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.153 Vali Acc: 0.067 Test Loss: 1.153 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4844698905944824
Epoch: 11, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 12 cost time: 0.4890320301055908
Epoch: 12, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 13 cost time: 0.5518913269042969
Epoch: 13, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3938264846801758
Epoch: 14, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4026467800140381
Epoch: 15, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 16 cost time: 0.43863844871520996
Epoch: 16, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 0.5093393325805664
Epoch: 17, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.42702293395996094
Epoch: 18, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.5005762577056885
Epoch: 19, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4710516929626465
Epoch: 20, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5182948112487793
Epoch: 21, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.45229291915893555
Epoch: 22, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5040633678436279
Epoch: 23, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.45346498489379883
Epoch: 24, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5005733966827393
Epoch: 25, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5371444225311279
Epoch: 26, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.565312385559082
Epoch: 27, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.277 Vali Acc: 0.400 Test Loss: 1.277 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 28 cost time: 0.5282468795776367
Epoch: 28, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.509437084197998
Epoch: 29, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.41477441787719727
Epoch: 30, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.385 Vali Acc: 0.400 Test Loss: 1.385 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.45050787925720215
Epoch: 31, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.48893213272094727
Epoch: 32, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.435 Vali Acc: 0.400 Test Loss: 1.435 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4350407123565674
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.454 Vali Acc: 0.400 Test Loss: 1.454 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5243077278137207
Epoch: 34, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.474 Vali Acc: 0.400 Test Loss: 1.474 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4867899417877197
Epoch: 35, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.498 Vali Acc: 0.467 Test Loss: 1.498 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466652).  Saving model ...
Epoch: 36 cost time: 0.505159854888916
Epoch: 36, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.521 Vali Acc: 0.533 Test Loss: 1.521 Test Acc: 0.533
Validation loss decreased (-0.466652 --> -0.533318).  Saving model ...
Epoch: 37 cost time: 0.5339727401733398
Epoch: 37, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.545 Vali Acc: 0.533 Test Loss: 1.545 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5357303619384766
Epoch: 38, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.571 Vali Acc: 0.533 Test Loss: 1.571 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.41656947135925293
Epoch: 39, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.597 Vali Acc: 0.533 Test Loss: 1.597 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.557487964630127
Epoch: 40, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.624 Vali Acc: 0.533 Test Loss: 1.624 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4318234920501709
Epoch: 41, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.649 Vali Acc: 0.533 Test Loss: 1.649 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.49531078338623047
Epoch: 42, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.673 Vali Acc: 0.533 Test Loss: 1.673 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4939005374908447
Epoch: 43, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.533 Test Loss: 1.696 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5190155506134033
Epoch: 44, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.533 Test Loss: 1.719 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.44690966606140137
Epoch: 45, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.742 Vali Acc: 0.533 Test Loss: 1.742 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5328702926635742
Epoch: 46, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.533 Test Loss: 1.764 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps114_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30413571
model size : 130.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps114_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.147580146789551
Epoch: 1, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4472320079803467
Epoch: 2, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.133322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.37486863136291504
Epoch: 3, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4989795684814453
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.4471628665924072
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4368019104003906
Epoch: 6, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4663379192352295
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.37273740768432617
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.4446136951446533
Epoch: 9, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4796266555786133
Epoch: 10, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4038224220275879
Epoch: 11, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5121946334838867
Epoch: 12, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.38765501976013184
Epoch: 13, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4870014190673828
Epoch: 14, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.39672017097473145
Epoch: 15, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4061901569366455
Epoch: 16, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.361513614654541
Epoch: 17, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.41959547996520996
Epoch: 18, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps114_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 30332931
model size : 130.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8539462089538574
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.38985538482666016
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42133140563964844
Epoch: 3, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.42404747009277344
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.47658777236938477
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3852427005767822
Epoch: 6, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.39589810371398926
Epoch: 7, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.118 Vali Acc: 0.133 Test Loss: 1.118 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4787750244140625
Epoch: 8, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.48113107681274414
Epoch: 9, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4246227741241455
Epoch: 10, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4164543151855469
Epoch: 11, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3983476161956787
Epoch: 12, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.3925027847290039
Epoch: 13, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3904857635498047
Epoch: 14, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3705723285675049
Epoch: 15, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5094048976898193
Epoch: 16, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4819672107696533
Epoch: 17, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5012362003326416
Epoch: 18, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.5084218978881836
Epoch: 19, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6196131706237793
Epoch: 20, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4159879684448242
Epoch: 21, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.49065637588500977
Epoch: 22, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.46968960762023926
Epoch: 23, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.47149157524108887
Epoch: 24, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4985036849975586
Epoch: 25, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5137104988098145
Epoch: 26, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5000848770141602
Epoch: 27, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.43859338760375977
Epoch: 28, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.206 Vali Acc: 0.467 Test Loss: 1.206 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 29 cost time: 0.3783833980560303
Epoch: 29, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4104349613189697
Epoch: 30, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.223 Vali Acc: 0.467 Test Loss: 1.223 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.38555335998535156
Epoch: 31, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.238 Vali Acc: 0.467 Test Loss: 1.238 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5188052654266357
Epoch: 32, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.256 Vali Acc: 0.467 Test Loss: 1.256 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4443211555480957
Epoch: 33, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.467 Test Loss: 1.276 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.4738798141479492
Epoch: 34, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.467 Test Loss: 1.296 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.4487454891204834
Epoch: 35, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.316 Vali Acc: 0.467 Test Loss: 1.316 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.41378045082092285
Epoch: 36, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.533 Test Loss: 1.337 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533320).  Saving model ...
Epoch: 37 cost time: 0.3657228946685791
Epoch: 37, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.533 Test Loss: 1.359 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.42496585845947266
Epoch: 38, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.533 Test Loss: 1.381 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4416353702545166
Epoch: 39, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.533 Test Loss: 1.403 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.39042186737060547
Epoch: 40, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.533 Test Loss: 1.424 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.3729274272918701
Epoch: 41, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.533 Test Loss: 1.445 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.42044496536254883
Epoch: 42, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.533 Test Loss: 1.466 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4104800224304199
Epoch: 43, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.533 Test Loss: 1.485 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.41698265075683594
Epoch: 44, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.533 Test Loss: 1.505 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.47014522552490234
Epoch: 45, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.533 Test Loss: 1.523 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.43967628479003906
Epoch: 46, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.467 Test Loss: 1.540 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30614787
model size : 131.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1441221237182617
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5180480480194092
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5763165950775146
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.42188024520874023
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.42482614517211914
Epoch: 5, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.557227611541748
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5437791347503662
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5225884914398193
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5060501098632812
Epoch: 9, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.099 Vali Acc: 0.133 Test Loss: 1.099 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.42607688903808594
Epoch: 10, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.103 Vali Acc: 0.133 Test Loss: 1.103 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3991827964782715
Epoch: 11, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4824249744415283
Epoch: 12, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 30461187
model size : 130.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8846349716186523
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.40576696395874023
Epoch: 2, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5700690746307373
Epoch: 3, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.41257810592651367
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.40392112731933594
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5497145652770996
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5216495990753174
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5352609157562256
Epoch: 8, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.47532010078430176
Epoch: 9, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.44227075576782227
Epoch: 10, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4537675380706787
Epoch: 11, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4631080627441406
Epoch: 12, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4154231548309326
Epoch: 13, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4792656898498535
Epoch: 14, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5005936622619629
Epoch: 15, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.5183656215667725
Epoch: 16, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5045759677886963
Epoch: 17, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.48307371139526367
Epoch: 18, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.077 Vali Acc: 0.200 Test Loss: 1.077 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.49768805503845215
Epoch: 19, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 20 cost time: 0.6428334712982178
Epoch: 20, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.484114408493042
Epoch: 21, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.48229026794433594
Epoch: 22, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4644608497619629
Epoch: 23, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4731252193450928
Epoch: 24, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.49335145950317383
Epoch: 25, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.48408007621765137
Epoch: 26, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.44876694679260254
Epoch: 27, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.49962282180786133
Epoch: 28, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.39974260330200195
Epoch: 29, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5120408535003662
Epoch: 30, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5545556545257568
Epoch: 31, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.43755507469177246
Epoch: 32, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4821043014526367
Epoch: 33, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.43070340156555176
Epoch: 34, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30384387
model size : 130.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.01487135887146
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6026549339294434
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.44832324981689453
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.49943017959594727
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.43522024154663086
Epoch: 5, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.48261070251464844
Epoch: 6, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4200417995452881
Epoch: 7, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4218733310699463
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4794735908508301
Epoch: 9, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5528357028961182
Epoch: 10, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6189155578613281
Epoch: 11, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4384171962738037
Epoch: 12, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.41155552864074707
Epoch: 13, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5459420680999756
Epoch: 14, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5913219451904297
Epoch: 15, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.44722747802734375
Epoch: 16, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4574418067932129
Epoch: 17, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4739806652069092
Epoch: 18, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.47112584114074707
Epoch: 19, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.43884897232055664
Epoch: 20, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.47879457473754883
Epoch: 21, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5016360282897949
Epoch: 22, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 30641667
model size : 131.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0743789672851562
Epoch: 1, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4485914707183838
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4832797050476074
Epoch: 3, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4927680492401123
Epoch: 4, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4095494747161865
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5434272289276123
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3894357681274414
Epoch: 7, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4508178234100342
Epoch: 8, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.42787909507751465
Epoch: 9, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.39832401275634766
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.45314812660217285
Epoch: 11, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4193718433380127
Epoch: 12, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4391758441925049
Epoch: 13, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.45476317405700684
Epoch: 14, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.41627931594848633
Epoch: 15, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.40255141258239746
Epoch: 16, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.3738377094268799
Epoch: 17, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4058561325073242
Epoch: 18, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4387657642364502
Epoch: 19, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.46071863174438477
Epoch: 20, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30499587
model size : 131.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.154423475265503
Epoch: 1, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.40179014205932617
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4356074333190918
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3689413070678711
Epoch: 4, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4673914909362793
Epoch: 5, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47059202194213867
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4267885684967041
Epoch: 7, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.44493937492370605
Epoch: 8, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.42115187644958496
Epoch: 9, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.43190598487854004
Epoch: 10, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4138803482055664
Epoch: 11, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30430467
model size : 130.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps132_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2164876461029053
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.4651343822479248
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.039 Vali Acc: 0.667 Test Loss: 1.039 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 0.3709592819213867
Epoch: 3, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.4521510601043701
Epoch: 4, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.43210577964782715
Epoch: 5, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4695241451263428
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4424891471862793
Epoch: 7, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.45224738121032715
Epoch: 8, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6250021457672119
Epoch: 9, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4606449604034424
Epoch: 10, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4683685302734375
Epoch: 11, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4712800979614258
Epoch: 12, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.48363327980041504
Epoch: 13, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps132_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 30694659
model size : 131.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.161881446838379
Epoch: 1, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3906266689300537
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5203285217285156
Epoch: 3, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47603726387023926
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5160365104675293
Epoch: 5, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5394961833953857
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5020184516906738
Epoch: 7, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.46223926544189453
Epoch: 8, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.373244047164917
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5522050857543945
Epoch: 10, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.36815428733825684
Epoch: 11, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.41935014724731445
Epoch: 12, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.45007801055908203
Epoch: 13, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.46880531311035156
Epoch: 14, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3704874515533447
Epoch: 15, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.36869120597839355
Epoch: 16, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4917910099029541
Epoch: 17, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.39420270919799805
Epoch: 18, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5317659378051758
Epoch: 19, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.49207043647766113
Epoch: 20, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.47779345512390137
Epoch: 21, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30556419
model size : 131.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps132_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.037648916244507
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.407092809677124
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4627399444580078
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38820338249206543
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40893054008483887
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5462005138397217
Epoch: 6, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45293664932250977
Epoch: 7, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.511277437210083
Epoch: 8, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4358954429626465
Epoch: 9, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.44891357421875
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3908989429473877
Epoch: 11, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps132_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 30487299
model size : 130.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps139_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.295327663421631
Epoch: 1, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4661376476287842
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4535079002380371
Epoch: 3, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5177018642425537
Epoch: 4, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6681838035583496
Epoch: 5, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5522432327270508
Epoch: 6, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5808918476104736
Epoch: 7, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5433127880096436
Epoch: 8, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5336258411407471
Epoch: 9, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5455195903778076
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4475269317626953
Epoch: 11, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5245635509490967
Epoch: 12, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4549405574798584
Epoch: 13, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.5108182430267334
Epoch: 14, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.6065993309020996
Epoch: 15, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.40337181091308594
Epoch: 16, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.47067904472351074
Epoch: 17, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4837827682495117
Epoch: 18, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4867117404937744
Epoch: 19, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6129882335662842
Epoch: 20, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.5900716781616211
Epoch: 21, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.49866580963134766
Epoch: 22, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.41641998291015625
Epoch: 23, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4971659183502197
Epoch: 24, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4538552761077881
Epoch: 25, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5100119113922119
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5038886070251465
Epoch: 27, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5311424732208252
Epoch: 28, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.297 Vali Acc: 0.333 Test Loss: 1.297 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5676183700561523
Epoch: 29, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4427835941314697
Epoch: 30, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps139_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30743811
model size : 131.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps139_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.211214065551758
Epoch: 1, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.46985769271850586
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5096776485443115
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.199 Vali Acc: 0.133 Test Loss: 1.199 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5580728054046631
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.231 Vali Acc: 0.133 Test Loss: 1.231 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5217306613922119
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4783158302307129
Epoch: 6, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.47852158546447754
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.482607364654541
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.191 Vali Acc: 0.133 Test Loss: 1.191 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4452345371246338
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.47498130798339844
Epoch: 10, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.4461967945098877
Epoch: 11, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.4866509437561035
Epoch: 12, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43170690536499023
Epoch: 13, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4648604393005371
Epoch: 14, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5533809661865234
Epoch: 15, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4683187007904053
Epoch: 16, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4643383026123047
Epoch: 17, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4308662414550781
Epoch: 18, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5704281330108643
Epoch: 19, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4636044502258301
Epoch: 20, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5739126205444336
Epoch: 21, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps139_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30613251
model size : 131.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps139_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9480957984924316
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.639087438583374
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40038418769836426
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4597053527832031
Epoch: 4, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5387938022613525
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5068094730377197
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4771595001220703
Epoch: 7, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5046713352203369
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4266071319580078
Epoch: 9, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4224529266357422
Epoch: 10, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5344254970550537
Epoch: 11, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.499920129776001
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.38165950775146484
Epoch: 13, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.44519877433776855
Epoch: 14, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4645721912384033
Epoch: 15, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5192985534667969
Epoch: 16, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4668862819671631
Epoch: 17, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.46872830390930176
Epoch: 18, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4085409641265869
Epoch: 19, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4381847381591797
Epoch: 20, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 21 cost time: 0.45221805572509766
Epoch: 21, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 0.4096393585205078
Epoch: 22, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4870574474334717
Epoch: 23, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4231407642364502
Epoch: 24, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.42778635025024414
Epoch: 25, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4510536193847656
Epoch: 26, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.187 Vali Acc: 0.467 Test Loss: 1.187 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5079648494720459
Epoch: 27, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.194 Vali Acc: 0.533 Test Loss: 1.194 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 28 cost time: 0.49689269065856934
Epoch: 28, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.201 Vali Acc: 0.533 Test Loss: 1.201 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4551093578338623
Epoch: 29, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.3880932331085205
Epoch: 30, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.417940616607666
Epoch: 31, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4322326183319092
Epoch: 32, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.240 Vali Acc: 0.533 Test Loss: 1.240 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.37749505043029785
Epoch: 33, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.252 Vali Acc: 0.533 Test Loss: 1.252 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.422987699508667
Epoch: 34, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.265 Vali Acc: 0.533 Test Loss: 1.265 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4432408809661865
Epoch: 35, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.279 Vali Acc: 0.533 Test Loss: 1.279 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.3773536682128906
Epoch: 36, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.293 Vali Acc: 0.533 Test Loss: 1.293 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4231071472167969
Epoch: 37, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.307 Vali Acc: 0.467 Test Loss: 1.307 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps139_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30547971
model size : 131.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps148_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0191309452056885
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.40415024757385254
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44444704055786133
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4452390670776367
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.514207124710083
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.533665657043457
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4728391170501709
Epoch: 7, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5354089736938477
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.46945691108703613
Epoch: 9, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5546278953552246
Epoch: 10, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.466747522354126
Epoch: 11, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.45763468742370605
Epoch: 12, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5355408191680908
Epoch: 13, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5264153480529785
Epoch: 14, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5389349460601807
Epoch: 15, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.49398088455200195
Epoch: 16, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.48864054679870605
Epoch: 17, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.48378872871398926
Epoch: 18, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.43328857421875
Epoch: 19, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4421107769012451
Epoch: 20, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps148_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30811395
model size : 132.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps148_str74_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.048917293548584
Epoch: 1, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5021443367004395
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4779636859893799
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45330214500427246
Epoch: 4, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4997270107269287
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4565467834472656
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4954342842102051
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4655187129974365
Epoch: 8, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.41646265983581543
Epoch: 9, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.5598640441894531
Epoch: 10, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4570002555847168
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4996664524078369
Epoch: 12, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4879910945892334
Epoch: 13, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5554423332214355
Epoch: 14, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4106442928314209
Epoch: 15, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.545417308807373
Epoch: 16, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5669152736663818
Epoch: 17, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.3957090377807617
Epoch: 18, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.47667956352233887
Epoch: 19, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps148_str74_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 30688515
model size : 131.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps148_str148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.291785717010498
Epoch: 1, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.458143949508667
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4257528781890869
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.44150638580322266
Epoch: 4, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5359325408935547
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4260890483856201
Epoch: 6, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.45281529426574707
Epoch: 7, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.44287824630737305
Epoch: 8, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.523576021194458
Epoch: 9, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4750242233276367
Epoch: 10, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4639899730682373
Epoch: 11, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.3999497890472412
Epoch: 12, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.4515657424926758
Epoch: 13, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.575812578201294
Epoch: 14, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4610888957977295
Epoch: 15, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43094348907470703
Epoch: 16, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4849205017089844
Epoch: 17, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3799459934234619
Epoch: 18, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.41049838066101074
Epoch: 19, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.4414207935333252
Epoch: 20, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.43883562088012695
Epoch: 21, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5516810417175293
Epoch: 22, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 23 cost time: 0.5157420635223389
Epoch: 23, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5596051216125488
Epoch: 24, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5249066352844238
Epoch: 25, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.41193366050720215
Epoch: 26, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.42969751358032227
Epoch: 27, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5160562992095947
Epoch: 28, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4168074131011963
Epoch: 29, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.42722606658935547
Epoch: 30, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.49463510513305664
Epoch: 31, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5300240516662598
Epoch: 32, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps148_str148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30627075
model size : 131.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps157_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8903963565826416
Epoch: 1, Steps: 1 | Train Loss: 1.332 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5527985095977783
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39463186264038086
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4221353530883789
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.481442928314209
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.49329137802124023
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5447700023651123
Epoch: 7, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.654982328414917
Epoch: 8, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5340306758880615
Epoch: 9, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4940919876098633
Epoch: 10, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.464555025100708
Epoch: 11, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps157_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 30875139
model size : 132.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps157_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0820071697235107
Epoch: 1, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.42987585067749023
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5246055126190186
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.4158494472503662
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4454507827758789
Epoch: 5, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.3989238739013672
Epoch: 6, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.47608065605163574
Epoch: 7, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3924543857574463
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4596884250640869
Epoch: 9, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.41098451614379883
Epoch: 10, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5137646198272705
Epoch: 11, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.45087170600891113
Epoch: 12, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.4596292972564697
Epoch: 13, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.4603393077850342
Epoch: 14, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.41374945640563965
Epoch: 15, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.37392568588256836
Epoch: 16, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.6136133670806885
Epoch: 17, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.43557143211364746
Epoch: 18, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.5113935470581055
Epoch: 19, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.39243555068969727
Epoch: 20, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.3872413635253906
Epoch: 21, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42207837104797363
Epoch: 22, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.37308478355407715
Epoch: 23, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.4513249397277832
Epoch: 24, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.46878671646118164
Epoch: 25, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.48411989212036133
Epoch: 26, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5196259021759033
Epoch: 27, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.43058323860168457
Epoch: 28, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4357140064239502
Epoch: 29, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4206712245941162
Epoch: 30, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4716670513153076
Epoch: 31, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4362621307373047
Epoch: 32, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.45480847358703613
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps157_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 30763779
model size : 132.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps157_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9556543827056885
Epoch: 1, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.4493222236633301
Epoch: 2, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.41292738914489746
Epoch: 3, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.416257381439209
Epoch: 4, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4501678943634033
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.40394163131713867
Epoch: 6, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5236103534698486
Epoch: 7, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4567267894744873
Epoch: 8, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.48354125022888184
Epoch: 9, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5294301509857178
Epoch: 10, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.3934032917022705
Epoch: 11, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5207257270812988
Epoch: 12, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4246692657470703
Epoch: 13, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.46996331214904785
Epoch: 14, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4552299976348877
Epoch: 15, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.44728565216064453
Epoch: 16, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4629390239715576
Epoch: 17, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.46312832832336426
Epoch: 18, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.47584986686706543
Epoch: 19, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4109187126159668
Epoch: 20, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps157_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 30706179
model size : 131.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.09316349029541
Epoch: 1, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.47705912590026855
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.48934388160705566
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4704442024230957
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4280247688293457
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.4372551441192627
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.46303462982177734
Epoch: 7, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4475288391113281
Epoch: 8, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4617938995361328
Epoch: 9, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.46319031715393066
Epoch: 10, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.48987412452697754
Epoch: 11, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5838725566864014
Epoch: 12, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.509392499923706
Epoch: 13, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4389457702636719
Epoch: 14, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.5033411979675293
Epoch: 15, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.4667980670928955
Epoch: 16, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.5229504108428955
Epoch: 17, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.37938618659973145
Epoch: 18, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.42014336585998535
Epoch: 19, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4501223564147949
Epoch: 20, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.40892481803894043
Epoch: 21, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4039468765258789
Epoch: 22, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.490476131439209
Epoch: 23, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.46296262741088867
Epoch: 24, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5242316722869873
Epoch: 25, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.47205591201782227
Epoch: 26, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 30955779
model size : 132.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.013568639755249
Epoch: 1, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.3712632656097412
Epoch: 2, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4869546890258789
Epoch: 3, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5376300811767578
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4127352237701416
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.42375612258911133
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.41263866424560547
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3993840217590332
Epoch: 8, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.4318208694458008
Epoch: 9, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.47667813301086426
Epoch: 10, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4823141098022461
Epoch: 11, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.46901535987854004
Epoch: 12, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.46065497398376465
Epoch: 13, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.42336177825927734
Epoch: 14, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.005 Vali Acc: 0.333 Test Loss: 1.005 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4326591491699219
Epoch: 15, Steps: 1 | Train Loss: 0.474 Vali Loss: 0.997 Vali Acc: 0.333 Test Loss: 0.997 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5157599449157715
Epoch: 16, Steps: 1 | Train Loss: 0.381 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.49886560440063477
Epoch: 17, Steps: 1 | Train Loss: 0.380 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.46450114250183105
Epoch: 18, Steps: 1 | Train Loss: 0.305 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.41033124923706055
Epoch: 19, Steps: 1 | Train Loss: 0.310 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.38463258743286133
Epoch: 20, Steps: 1 | Train Loss: 0.247 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.43578624725341797
Epoch: 21, Steps: 1 | Train Loss: 0.233 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.44287562370300293
Epoch: 22, Steps: 1 | Train Loss: 0.185 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5077290534973145
Epoch: 23, Steps: 1 | Train Loss: 0.148 Vali Loss: 0.993 Vali Acc: 0.467 Test Loss: 0.993 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5113415718078613
Epoch: 24, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5429906845092773
Epoch: 25, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.47063326835632324
Epoch: 26, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4774768352508545
Epoch: 27, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4139413833618164
Epoch: 28, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.015 Vali Acc: 0.400 Test Loss: 1.015 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4451172351837158
Epoch: 29, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 30848259
model size : 132.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9787955284118652
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4378788471221924
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.47315454483032227
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4431600570678711
Epoch: 4, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.071 Vali Acc: 0.667 Test Loss: 1.071 Test Acc: 0.667
Validation loss decreased (-0.466656 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.4585280418395996
Epoch: 5, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.47783756256103516
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5006132125854492
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.071 Vali Acc: 0.733 Test Loss: 1.071 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 0.5020625591278076
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.068 Vali Acc: 0.733 Test Loss: 1.068 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 0.4150359630584717
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.063 Vali Acc: 0.733 Test Loss: 1.063 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.5522449016571045
Epoch: 10, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5063769817352295
Epoch: 11, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.38753199577331543
Epoch: 12, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.47136497497558594
Epoch: 13, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.40266919136047363
Epoch: 14, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.45975327491760254
Epoch: 15, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4467782974243164
Epoch: 16, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4066176414489746
Epoch: 17, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4608755111694336
Epoch: 18, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4648914337158203
Epoch: 19, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 30794499
model size : 132.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps179_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8656632900238037
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.48201489448547363
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.43933987617492676
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.40372633934020996
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47965455055236816
Epoch: 5, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5344827175140381
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4638524055480957
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4448368549346924
Epoch: 8, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.49601149559020996
Epoch: 9, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4110677242279053
Epoch: 10, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.42770814895629883
Epoch: 11, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.44654011726379395
Epoch: 12, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps179_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 31051011
model size : 133.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps179_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3293070793151855
Epoch: 1, Steps: 1 | Train Loss: 1.329 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4405081272125244
Epoch: 2, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4470646381378174
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5014064311981201
Epoch: 4, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4659419059753418
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5190374851226807
Epoch: 6, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4897804260253906
Epoch: 7, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4473395347595215
Epoch: 8, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.40960168838500977
Epoch: 9, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.49544382095336914
Epoch: 10, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4461219310760498
Epoch: 11, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5210263729095459
Epoch: 12, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps179_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 30951171
model size : 132.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps179_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.920499324798584
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4257807731628418
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5861036777496338
Epoch: 3, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4293694496154785
Epoch: 4, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47713756561279297
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5442569255828857
Epoch: 6, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6707205772399902
Epoch: 7, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.48701977729797363
Epoch: 8, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5148577690124512
Epoch: 9, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5732851028442383
Epoch: 10, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.46401095390319824
Epoch: 11, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.46224331855773926
Epoch: 12, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps179_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 30901251
model size : 132.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps193_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.041917324066162
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4328896999359131
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.38955187797546387
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4779856204986572
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.082 Vali Acc: 0.667 Test Loss: 1.082 Test Acc: 0.667
Validation loss decreased (-0.466656 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.5050623416900635
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4830210208892822
Epoch: 6, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4688444137573242
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.44919371604919434
Epoch: 8, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.505523681640625
Epoch: 9, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5076861381530762
Epoch: 10, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.46463847160339355
Epoch: 11, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4303102493286133
Epoch: 12, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.059 Vali Acc: 0.667 Test Loss: 1.059 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 0.4715902805328369
Epoch: 13, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4808821678161621
Epoch: 14, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5306799411773682
Epoch: 15, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.45978689193725586
Epoch: 16, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4469633102416992
Epoch: 17, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5172395706176758
Epoch: 18, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5251471996307373
Epoch: 19, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.43293166160583496
Epoch: 20, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.44110798835754395
Epoch: 21, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5596632957458496
Epoch: 22, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps193_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 31164675
model size : 133.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps193_str97_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0614027976989746
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.232 Vali Acc: 0.133 Test Loss: 1.232 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.46906566619873047
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.202 Vali Acc: 0.133 Test Loss: 1.202 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.49845004081726074
Epoch: 3, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4447648525238037
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.46225690841674805
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.487734317779541
Epoch: 6, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5130527019500732
Epoch: 7, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.41623520851135254
Epoch: 8, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.42226505279541016
Epoch: 9, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4159104824066162
Epoch: 10, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5032174587249756
Epoch: 11, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.47461390495300293
Epoch: 12, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5020260810852051
Epoch: 13, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4700202941894531
Epoch: 14, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.38280248641967773
Epoch: 15, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.362994909286499
Epoch: 16, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5330886840820312
Epoch: 17, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps193_str97_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 31072515
model size : 133.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps193_str193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9705822467803955
Epoch: 1, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3892855644226074
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5375566482543945
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.45278286933898926
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.37633633613586426
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3578307628631592
Epoch: 6, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.47748851776123047
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.3823418617248535
Epoch: 8, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4119889736175537
Epoch: 9, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4476306438446045
Epoch: 10, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.35518527030944824
Epoch: 11, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4038357734680176
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.44942617416381836
Epoch: 13, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.38051295280456543
Epoch: 14, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps193_str193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 31026435
model size : 133.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps209_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9404065608978271
Epoch: 1, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4038388729095459
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45403003692626953
Epoch: 3, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.440777063369751
Epoch: 4, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5774369239807129
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3380930423736572
Epoch: 6, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.44823384284973145
Epoch: 7, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.43415188789367676
Epoch: 8, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4794785976409912
Epoch: 9, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.5174286365509033
Epoch: 10, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.5628049373626709
Epoch: 11, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.4905717372894287
Epoch: 12, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.4751770496368408
Epoch: 13, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5504977703094482
Epoch: 14, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4156315326690674
Epoch: 15, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5034265518188477
Epoch: 16, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5228326320648193
Epoch: 17, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.38629913330078125
Epoch: 18, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3939824104309082
Epoch: 19, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.45686841011047363
Epoch: 20, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.48003292083740234
Epoch: 21, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.48423004150390625
Epoch: 22, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps209_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 31296771
model size : 134.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps209_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.178847551345825
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5915169715881348
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49655747413635254
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5068187713623047
Epoch: 4, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5533015727996826
Epoch: 5, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.43721747398376465
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5188896656036377
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.42469000816345215
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5372178554534912
Epoch: 9, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4956626892089844
Epoch: 10, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5741338729858398
Epoch: 11, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4647393226623535
Epoch: 12, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.412733793258667
Epoch: 13, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4748682975769043
Epoch: 14, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5730724334716797
Epoch: 15, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4586808681488037
Epoch: 16, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.494767427444458
Epoch: 17, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5187397003173828
Epoch: 18, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.45514655113220215
Epoch: 19, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4752004146575928
Epoch: 20, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4171879291534424
Epoch: 21, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps209_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 31212291
model size : 133.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps209_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2119362354278564
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4471423625946045
Epoch: 2, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.46738624572753906
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.4886741638183594
Epoch: 4, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5300989151000977
Epoch: 5, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.48951292037963867
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4482886791229248
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5284004211425781
Epoch: 8, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.42597270011901855
Epoch: 9, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.439619779586792
Epoch: 10, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.47408413887023926
Epoch: 11, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.4332869052886963
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.045 Vali Acc: 0.667 Test Loss: 1.045 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 0.4690406322479248
Epoch: 13, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.502338171005249
Epoch: 14, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5217163562774658
Epoch: 15, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5656487941741943
Epoch: 16, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.44033312797546387
Epoch: 17, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4089021682739258
Epoch: 18, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4553685188293457
Epoch: 19, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.48276424407958984
Epoch: 20, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4319159984588623
Epoch: 21, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4044766426086426
Epoch: 22, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps209_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 31170051
model size : 133.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps228_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9307053089141846
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.3789184093475342
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44638657569885254
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.37648797035217285
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4163210391998291
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46129775047302246
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3900425434112549
Epoch: 7, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5071783065795898
Epoch: 8, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.43691301345825195
Epoch: 9, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.43692588806152344
Epoch: 10, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4374513626098633
Epoch: 11, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps228_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 31456515
model size : 134.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps228_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.981292486190796
Epoch: 1, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.436877965927124
Epoch: 2, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5528273582458496
Epoch: 3, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5126709938049316
Epoch: 4, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.40862202644348145
Epoch: 5, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.41660571098327637
Epoch: 6, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.42949628829956055
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5321810245513916
Epoch: 8, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.44512295722961426
Epoch: 9, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5749568939208984
Epoch: 10, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46822643280029297
Epoch: 11, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.49161338806152344
Epoch: 12, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.42933177947998047
Epoch: 13, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47795629501342773
Epoch: 14, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4905581474304199
Epoch: 15, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5444824695587158
Epoch: 16, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.506096601486206
Epoch: 17, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4717123508453369
Epoch: 18, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5074865818023682
Epoch: 19, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5154342651367188
Epoch: 20, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.45777177810668945
Epoch: 21, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5536403656005859
Epoch: 22, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.48827624320983887
Epoch: 23, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5195386409759521
Epoch: 24, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4631352424621582
Epoch: 25, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps228_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 31379715
model size : 134.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps228_str228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8477673530578613
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3895995616912842
Epoch: 2, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4889085292816162
Epoch: 3, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.150 Vali Acc: 0.067 Test Loss: 1.150 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.432295560836792
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4838829040527344
Epoch: 5, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.47034430503845215
Epoch: 6, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.447951078414917
Epoch: 7, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.48042988777160645
Epoch: 8, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4378933906555176
Epoch: 9, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4684412479400635
Epoch: 10, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.48059535026550293
Epoch: 11, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4689297676086426
Epoch: 12, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4562504291534424
Epoch: 13, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4619021415710449
Epoch: 14, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4672541618347168
Epoch: 15, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps228_str228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 31341315
model size : 134.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1026384830474854
Epoch: 1, Steps: 1 | Train Loss: 1.356 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.47226762771606445
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4251551628112793
Epoch: 3, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.430983304977417
Epoch: 4, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47322869300842285
Epoch: 5, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.39424800872802734
Epoch: 6, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5053977966308594
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5654051303863525
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.48604440689086914
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.39224815368652344
Epoch: 10, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.520411491394043
Epoch: 11, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40724730491638184
Epoch: 12, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4283475875854492
Epoch: 13, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.46817541122436523
Epoch: 14, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.42208099365234375
Epoch: 15, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5093255043029785
Epoch: 16, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4518146514892578
Epoch: 17, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5558276176452637
Epoch: 18, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4826478958129883
Epoch: 19, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4071667194366455
Epoch: 20, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4020204544067383
Epoch: 21, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4906787872314453
Epoch: 22, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.42033839225769043
Epoch: 23, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.513932466506958
Epoch: 24, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 31643907
model size : 135.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2007882595062256
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4999251365661621
Epoch: 2, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.182 Vali Acc: 0.133 Test Loss: 1.182 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5218188762664795
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5988869667053223
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49692296981811523
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4699876308441162
Epoch: 6, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4188425540924072
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.49358177185058594
Epoch: 8, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4740579128265381
Epoch: 9, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.565943717956543
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5678699016571045
Epoch: 11, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 12 cost time: 0.49620556831359863
Epoch: 12, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.5990700721740723
Epoch: 13, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.4553956985473633
Epoch: 14, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.4967834949493408
Epoch: 15, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.5132737159729004
Epoch: 16, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 0.43512392044067383
Epoch: 17, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.5444645881652832
Epoch: 18, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.4639558792114258
Epoch: 19, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.42690014839172363
Epoch: 20, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.44188809394836426
Epoch: 21, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5390667915344238
Epoch: 22, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6114616394042969
Epoch: 23, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.46322083473205566
Epoch: 24, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5815067291259766
Epoch: 25, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4905083179473877
Epoch: 26, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.45763540267944336
Epoch: 27, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.49393296241760254
Epoch: 28, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 31578627
model size : 135.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8365139961242676
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3555006980895996
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.37144017219543457
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4396500587463379
Epoch: 4, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.420055627822876
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.49787235260009766
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.41426968574523926
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4607808589935303
Epoch: 8, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3975107669830322
Epoch: 9, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4051821231842041
Epoch: 10, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4089932441711426
Epoch: 11, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 31544067
model size : 135.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps278_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3290984630584717
Epoch: 1, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.3814523220062256
Epoch: 2, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.41762518882751465
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3735063076019287
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4210195541381836
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3961632251739502
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3775050640106201
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4549901485443115
Epoch: 8, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.42236757278442383
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4420754909515381
Epoch: 10, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4057004451751709
Epoch: 11, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.45339250564575195
Epoch: 12, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.3990044593811035
Epoch: 13, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4071683883666992
Epoch: 14, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.44019103050231934
Epoch: 15, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4413309097290039
Epoch: 16, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.446211576461792
Epoch: 17, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.36272454261779785
Epoch: 18, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps278_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 31886595
model size : 136.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps278_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1283557415008545
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.45020127296447754
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3686850070953369
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.40620994567871094
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4293389320373535
Epoch: 5, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4477238655090332
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.37221217155456543
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.48903822898864746
Epoch: 8, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4376685619354248
Epoch: 9, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.38109326362609863
Epoch: 10, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4027383327484131
Epoch: 11, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps278_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 31825155
model size : 136.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps278_str278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.371577739715576
Epoch: 1, Steps: 1 | Train Loss: 1.268 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4878554344177246
Epoch: 2, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42322468757629395
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4989800453186035
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44612717628479004
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4429137706756592
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4844396114349365
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.44005513191223145
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.46772289276123047
Epoch: 9, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5185937881469727
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5374228954315186
Epoch: 11, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5166668891906738
Epoch: 12, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5233795642852783
Epoch: 13, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps278_str278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 31794435
model size : 135.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps313_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1252639293670654
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.52614426612854
Epoch: 2, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5134928226470947
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5029008388519287
Epoch: 4, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4999668598175049
Epoch: 5, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4701981544494629
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.48046088218688965
Epoch: 7, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.44520998001098633
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4902324676513672
Epoch: 9, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.579094648361206
Epoch: 10, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5762536525726318
Epoch: 11, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5407052040100098
Epoch: 12, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4845621585845947
Epoch: 13, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps313_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 32193795
model size : 137.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps313_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.348473310470581
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4586758613586426
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4982447624206543
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5065414905548096
Epoch: 4, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.47940778732299805
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.48088502883911133
Epoch: 6, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4894602298736572
Epoch: 7, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4455904960632324
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4436070919036865
Epoch: 9, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.41475343704223633
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4425351619720459
Epoch: 11, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4785933494567871
Epoch: 12, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.371065616607666
Epoch: 13, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.5023939609527588
Epoch: 14, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3902928829193115
Epoch: 15, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5094168186187744
Epoch: 16, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5094931125640869
Epoch: 17, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5072901248931885
Epoch: 18, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4010000228881836
Epoch: 19, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.35343337059020996
Epoch: 20, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.46132755279541016
Epoch: 21, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5423505306243896
Epoch: 22, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4487268924713135
Epoch: 23, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps313_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 32140035
model size : 137.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps313_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.146221876144409
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.3990457057952881
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3969383239746094
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5592927932739258
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4141547679901123
Epoch: 5, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.411022424697876
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.43759608268737793
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4491097927093506
Epoch: 8, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4523353576660156
Epoch: 9, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.41628456115722656
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.48511838912963867
Epoch: 11, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.40021562576293945
Epoch: 12, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3848154544830322
Epoch: 13, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.43906569480895996
Epoch: 14, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4447214603424072
Epoch: 15, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48921728134155273
Epoch: 16, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4947671890258789
Epoch: 17, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.49858593940734863
Epoch: 18, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4563286304473877
Epoch: 19, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5894088745117188
Epoch: 20, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5892024040222168
Epoch: 21, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5338747501373291
Epoch: 22, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4724118709564209
Epoch: 23, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4497818946838379
Epoch: 24, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps313_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 32113155
model size : 137.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps358_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2950496673583984
Epoch: 1, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5067813396453857
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5631608963012695
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.5357613563537598
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4921994209289551
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.46310901641845703
Epoch: 6, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5488219261169434
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6444721221923828
Epoch: 8, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4784846305847168
Epoch: 9, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.4764401912689209
Epoch: 10, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47028565406799316
Epoch: 11, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4154341220855713
Epoch: 12, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5540909767150879
Epoch: 13, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.40293145179748535
Epoch: 14, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5106070041656494
Epoch: 15, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.47461724281311035
Epoch: 16, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5087170600891113
Epoch: 17, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5401887893676758
Epoch: 18, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4688248634338379
Epoch: 19, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.039 Vali Acc: 0.333 Test Loss: 1.039 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps358_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 32593155
model size : 139.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps358_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.15407133102417
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.45023393630981445
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.36145567893981934
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5004267692565918
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49457597732543945
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4858112335205078
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5601320266723633
Epoch: 7, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.41667652130126953
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.4317913055419922
Epoch: 9, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4231445789337158
Epoch: 10, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47273969650268555
Epoch: 11, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.41053271293640137
Epoch: 12, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4705677032470703
Epoch: 13, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.48681116104125977
Epoch: 14, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.48923397064208984
Epoch: 15, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.47061920166015625
Epoch: 16, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4999246597290039
Epoch: 17, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.43532609939575195
Epoch: 18, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.44176745414733887
Epoch: 19, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps358_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 32547075
model size : 138.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps358_str358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1865830421447754
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.37023282051086426
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.40433502197265625
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4664285182952881
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.41408824920654297
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4943735599517822
Epoch: 6, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4879176616668701
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5446994304656982
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.438828706741333
Epoch: 9, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4785325527191162
Epoch: 10, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4447648525238037
Epoch: 11, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.40502166748046875
Epoch: 12, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.5645015239715576
Epoch: 13, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.48386526107788086
Epoch: 14, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5032029151916504
Epoch: 15, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4848639965057373
Epoch: 16, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.48021483421325684
Epoch: 17, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.47673583030700684
Epoch: 18, Steps: 1 | Train Loss: 0.382 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4106876850128174
Epoch: 19, Steps: 1 | Train Loss: 0.341 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.44882917404174805
Epoch: 20, Steps: 1 | Train Loss: 0.287 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.48325681686401367
Epoch: 21, Steps: 1 | Train Loss: 0.231 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.39337921142578125
Epoch: 22, Steps: 1 | Train Loss: 0.205 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.3663771152496338
Epoch: 23, Steps: 1 | Train Loss: 0.174 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.3974118232727051
Epoch: 24, Steps: 1 | Train Loss: 0.170 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 0.4978671073913574
Epoch: 25, Steps: 1 | Train Loss: 0.126 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.4409780502319336
Epoch: 26, Steps: 1 | Train Loss: 0.108 Vali Loss: 0.980 Vali Acc: 0.667 Test Loss: 0.980 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 0.43344998359680176
Epoch: 27, Steps: 1 | Train Loss: 0.080 Vali Loss: 0.978 Vali Acc: 0.667 Test Loss: 0.978 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 0.48969030380249023
Epoch: 28, Steps: 1 | Train Loss: 0.085 Vali Loss: 0.977 Vali Acc: 0.667 Test Loss: 0.977 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 29 cost time: 0.504021167755127
Epoch: 29, Steps: 1 | Train Loss: 0.064 Vali Loss: 0.976 Vali Acc: 0.667 Test Loss: 0.976 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 0.5202367305755615
Epoch: 30, Steps: 1 | Train Loss: 0.062 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.477278470993042
Epoch: 31, Steps: 1 | Train Loss: 0.043 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4887123107910156
Epoch: 32, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.47456860542297363
Epoch: 33, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.461928129196167
Epoch: 34, Steps: 1 | Train Loss: 0.025 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.43828415870666504
Epoch: 35, Steps: 1 | Train Loss: 0.021 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.42101120948791504
Epoch: 36, Steps: 1 | Train Loss: 0.016 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.4911766052246094
Epoch: 37, Steps: 1 | Train Loss: 0.015 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5083134174346924
Epoch: 38, Steps: 1 | Train Loss: 0.013 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4682302474975586
Epoch: 39, Steps: 1 | Train Loss: 0.012 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps358_str358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 32524035
model size : 138.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps417_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1430816650390625
Epoch: 1, Steps: 1 | Train Loss: 1.423 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3899359703063965
Epoch: 2, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5031423568725586
Epoch: 3, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4799063205718994
Epoch: 4, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.38698363304138184
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.45989060401916504
Epoch: 6, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.48790836334228516
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.49442100524902344
Epoch: 8, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5074849128723145
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5360612869262695
Epoch: 10, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.4835774898529053
Epoch: 11, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.43811845779418945
Epoch: 12, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.45984625816345215
Epoch: 13, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.46986842155456543
Epoch: 14, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5210006237030029
Epoch: 15, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5504171848297119
Epoch: 16, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4958791732788086
Epoch: 17, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5312039852142334
Epoch: 18, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.49288368225097656
Epoch: 19, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.446610689163208
Epoch: 20, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5127203464508057
Epoch: 21, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4439363479614258
Epoch: 22, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.43004798889160156
Epoch: 23, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.38928771018981934
Epoch: 24, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4423201084136963
Epoch: 25, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps417_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 33121539
model size : 141.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps417_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1475181579589844
Epoch: 1, Steps: 1 | Train Loss: 1.348 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4108858108520508
Epoch: 2, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.42792463302612305
Epoch: 3, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.47333240509033203
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4374253749847412
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4063742160797119
Epoch: 6, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4611632823944092
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4385373592376709
Epoch: 8, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3850977420806885
Epoch: 9, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.3877573013305664
Epoch: 10, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.39180755615234375
Epoch: 11, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.40123486518859863
Epoch: 12, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.40517354011535645
Epoch: 13, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.49994921684265137
Epoch: 14, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.426281213760376
Epoch: 15, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3660728931427002
Epoch: 16, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4808950424194336
Epoch: 17, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.40319132804870605
Epoch: 18, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.002 Vali Acc: 0.400 Test Loss: 1.002 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5039913654327393
Epoch: 19, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.002 Vali Acc: 0.333 Test Loss: 1.002 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.46039605140686035
Epoch: 20, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.003 Vali Acc: 0.333 Test Loss: 1.003 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.49899864196777344
Epoch: 21, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.004 Vali Acc: 0.333 Test Loss: 1.004 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4101393222808838
Epoch: 22, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.007 Vali Acc: 0.400 Test Loss: 1.007 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.47487378120422363
Epoch: 23, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4766535758972168
Epoch: 24, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps417_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 33083139
model size : 140.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps417_str417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0850040912628174
Epoch: 1, Steps: 1 | Train Loss: 1.335 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4810166358947754
Epoch: 2, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5515165328979492
Epoch: 3, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4514045715332031
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4585897922515869
Epoch: 5, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.47389864921569824
Epoch: 6, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4042625427246094
Epoch: 7, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4660158157348633
Epoch: 8, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4564981460571289
Epoch: 9, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.43796539306640625
Epoch: 10, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.46122217178344727
Epoch: 11, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5367615222930908
Epoch: 12, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4381241798400879
Epoch: 13, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5534253120422363
Epoch: 14, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.40119171142578125
Epoch: 15, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.42957091331481934
Epoch: 16, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.36548399925231934
Epoch: 17, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.44001317024230957
Epoch: 18, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.540574312210083
Epoch: 19, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3940596580505371
Epoch: 20, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.48137998580932617
Epoch: 21, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5389478206634521
Epoch: 22, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4069998264312744
Epoch: 23, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.45971059799194336
Epoch: 24, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.45386338233947754
Epoch: 25, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.36608123779296875
Epoch: 26, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4699392318725586
Epoch: 27, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps417_str417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 33063939
model size : 140.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.792266845703125
Epoch: 1, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.131 Vali Acc: 0.133 Test Loss: 1.131 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4877943992614746
Epoch: 2, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.45778346061706543
Epoch: 3, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5363876819610596
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5240926742553711
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5326368808746338
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4934883117675781
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4852912425994873
Epoch: 8, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5339541435241699
Epoch: 9, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.43648290634155273
Epoch: 10, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5405421257019043
Epoch: 11, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5162053108215332
Epoch: 12, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.45464253425598145
Epoch: 13, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.5478854179382324
Epoch: 14, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.5663852691650391
Epoch: 15, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4401512145996094
Epoch: 16, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5289881229400635
Epoch: 17, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.537456750869751
Epoch: 18, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4515225887298584
Epoch: 19, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4421968460083008
Epoch: 20, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.569568395614624
Epoch: 21, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.47252392768859863
Epoch: 22, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5631139278411865
Epoch: 23, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4886298179626465
Epoch: 24, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 33874947
model size : 143.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1325249671936035
Epoch: 1, Steps: 1 | Train Loss: 1.295 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5309016704559326
Epoch: 2, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.49484992027282715
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.44059038162231445
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.535057783126831
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.48009705543518066
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.46031713485717773
Epoch: 7, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4361612796783447
Epoch: 8, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.3793635368347168
Epoch: 9, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.49307990074157715
Epoch: 10, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.45645689964294434
Epoch: 11, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.5723655223846436
Epoch: 12, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5237350463867188
Epoch: 13, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4789292812347412
Epoch: 14, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.48256444931030273
Epoch: 15, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5387170314788818
Epoch: 16, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5638902187347412
Epoch: 17, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.45989251136779785
Epoch: 18, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5682296752929688
Epoch: 19, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.48592376708984375
Epoch: 20, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5803554058074951
Epoch: 21, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 33844227
model size : 143.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0623464584350586
Epoch: 1, Steps: 1 | Train Loss: 1.312 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4659912586212158
Epoch: 2, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5637867450714111
Epoch: 3, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5065653324127197
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.4507269859313965
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4567995071411133
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5926289558410645
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4054381847381592
Epoch: 8, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4197549819946289
Epoch: 9, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5228304862976074
Epoch: 10, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.45795607566833496
Epoch: 11, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.44294047355651855
Epoch: 12, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.45404887199401855
Epoch: 13, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.3948538303375244
Epoch: 14, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el4_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 33828867
model size : 143.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1642558574676514
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4495248794555664
Epoch: 2, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.49828004837036133
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.49726271629333496
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.41747021675109863
Epoch: 5, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.125 Vali Acc: 0.133 Test Loss: 1.125 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.45830726623535156
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.122 Vali Acc: 0.067 Test Loss: 1.122 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4825272560119629
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.38440966606140137
Epoch: 8, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.45792412757873535
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5394859313964844
Epoch: 10, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.517707109451294
Epoch: 11, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4342644214630127
Epoch: 12, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.3921201229095459
Epoch: 13, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.47199177742004395
Epoch: 14, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5095834732055664
Epoch: 15, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3895289897918701
Epoch: 16, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5507633686065674
Epoch: 17, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.42368626594543457
Epoch: 18, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5234146118164062
Epoch: 19, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3874382972717285
Epoch: 20, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5159893035888672
Epoch: 21, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.47368741035461426
Epoch: 22, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5381190776824951
Epoch: 23, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.587745189666748
Epoch: 24, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.44043588638305664
Epoch: 25, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.47655677795410156
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.41803646087646484
Epoch: 27, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23407875
model size : 103.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.066577196121216
Epoch: 1, Steps: 1 | Train Loss: 1.331 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.44336938858032227
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4373354911804199
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.42699217796325684
Epoch: 4, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5256049633026123
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.45949649810791016
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4962022304534912
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.43159985542297363
Epoch: 8, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.41719913482666016
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.43570470809936523
Epoch: 10, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4692375659942627
Epoch: 11, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4936690330505371
Epoch: 12, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.44404125213623047
Epoch: 13, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4070420265197754
Epoch: 14, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.42132115364074707
Epoch: 15, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4404587745666504
Epoch: 16, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.45874834060668945
Epoch: 17, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23223555
model size : 103.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0039098262786865
Epoch: 1, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3974490165710449
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.138 Vali Acc: 0.067 Test Loss: 1.138 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46916723251342773
Epoch: 3, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4060249328613281
Epoch: 4, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5138280391693115
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4697000980377197
Epoch: 6, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4122486114501953
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.42330265045166016
Epoch: 8, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4536552429199219
Epoch: 9, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4757728576660156
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5019698143005371
Epoch: 11, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 23131395
model size : 102.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.132720470428467
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5591795444488525
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4978485107421875
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5388641357421875
Epoch: 4, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4599301815032959
Epoch: 5, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.48604583740234375
Epoch: 6, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4676189422607422
Epoch: 7, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.584869384765625
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.47115468978881836
Epoch: 9, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.49455857276916504
Epoch: 10, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.48294949531555176
Epoch: 11, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.5353529453277588
Epoch: 12, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.45789575576782227
Epoch: 13, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6092243194580078
Epoch: 14, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5987148284912109
Epoch: 15, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5138468742370605
Epoch: 16, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4497983455657959
Epoch: 17, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.45789599418640137
Epoch: 18, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5204157829284668
Epoch: 19, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4496955871582031
Epoch: 20, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4509775638580322
Epoch: 21, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23423235
model size : 104.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0974512100219727
Epoch: 1, Steps: 1 | Train Loss: 1.346 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5127067565917969
Epoch: 2, Steps: 1 | Train Loss: 1.272 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5451738834381104
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.429614782333374
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4072091579437256
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.5387392044067383
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.45525407791137695
Epoch: 7, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4561960697174072
Epoch: 8, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5129423141479492
Epoch: 9, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6174671649932861
Epoch: 10, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4812757968902588
Epoch: 11, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4192469120025635
Epoch: 12, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.487912654876709
Epoch: 13, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.49226880073547363
Epoch: 14, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5090947151184082
Epoch: 15, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23258115
model size : 103.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9748201370239258
Epoch: 1, Steps: 1 | Train Loss: 1.598 Vali Loss: 1.389 Vali Acc: 0.333 Test Loss: 1.389 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.3875277042388916
Epoch: 2, Steps: 1 | Train Loss: 1.369 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4782521724700928
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4039771556854248
Epoch: 4, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.40116119384765625
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.41762256622314453
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.46240901947021484
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4659898281097412
Epoch: 8, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3994297981262207
Epoch: 9, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4875011444091797
Epoch: 10, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5170891284942627
Epoch: 11, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.40448832511901855
Epoch: 12, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4932689666748047
Epoch: 13, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.45748376846313477
Epoch: 14, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23169795
model size : 103.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.095740556716919
Epoch: 1, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4476912021636963
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.4053192138671875
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.41466188430786133
Epoch: 4, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.45891499519348145
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.44178152084350586
Epoch: 6, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4295647144317627
Epoch: 7, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.4338996410369873
Epoch: 8, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.45484232902526855
Epoch: 9, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4371953010559082
Epoch: 10, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.43285298347473145
Epoch: 11, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.507026195526123
Epoch: 12, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.43805432319641113
Epoch: 13, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.5243942737579346
Epoch: 14, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.657804012298584
Epoch: 15, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.45886707305908203
Epoch: 16, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.46792173385620117
Epoch: 17, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.45519518852233887
Epoch: 18, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.40332651138305664
Epoch: 19, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.46044421195983887
Epoch: 20, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4970090389251709
Epoch: 21, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.60349440574646
Epoch: 22, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.587038516998291
Epoch: 23, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23448579
model size : 104.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8509211540222168
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.45569825172424316
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.44655299186706543
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5108964443206787
Epoch: 4, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6007552146911621
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5312118530273438
Epoch: 6, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4163823127746582
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4780092239379883
Epoch: 8, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4896979331970215
Epoch: 9, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4552438259124756
Epoch: 10, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4999198913574219
Epoch: 11, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5597639083862305
Epoch: 12, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4670438766479492
Epoch: 13, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.46462416648864746
Epoch: 14, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5479440689086914
Epoch: 15, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4492452144622803
Epoch: 16, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4388911724090576
Epoch: 17, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5311083793640137
Epoch: 18, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5467560291290283
Epoch: 19, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4203763008117676
Epoch: 20, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.44121241569519043
Epoch: 21, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4655458927154541
Epoch: 22, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4822263717651367
Epoch: 23, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5295088291168213
Epoch: 24, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4985649585723877
Epoch: 25, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4631474018096924
Epoch: 26, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23287299
model size : 103.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0765581130981445
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5810928344726562
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43024563789367676
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38167357444763184
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5321171283721924
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.45006775856018066
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3898911476135254
Epoch: 7, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4785730838775635
Epoch: 8, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5253398418426514
Epoch: 9, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.463498592376709
Epoch: 10, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5191619396209717
Epoch: 11, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5280981063842773
Epoch: 12, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.48874402046203613
Epoch: 13, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.46620678901672363
Epoch: 14, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4639625549316406
Epoch: 15, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4351940155029297
Epoch: 16, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4875025749206543
Epoch: 17, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4455082416534424
Epoch: 18, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4482295513153076
Epoch: 19, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5328049659729004
Epoch: 20, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4021639823913574
Epoch: 21, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5166444778442383
Epoch: 22, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4538094997406006
Epoch: 23, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23202819
model size : 103.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps114_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9093389511108398
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.44088315963745117
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.47527551651000977
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43261075019836426
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4831054210662842
Epoch: 5, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.5135672092437744
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4674088954925537
Epoch: 7, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.46135997772216797
Epoch: 8, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4401111602783203
Epoch: 9, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.43126368522644043
Epoch: 10, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.48099637031555176
Epoch: 11, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.060 Vali Acc: 0.267 Test Loss: 1.060 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4642171859741211
Epoch: 12, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.064 Vali Acc: 0.267 Test Loss: 1.064 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.44780826568603516
Epoch: 13, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4853978157043457
Epoch: 14, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6151027679443359
Epoch: 15, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps114_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23483139
model size : 104.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps114_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0622613430023193
Epoch: 1, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4835197925567627
Epoch: 2, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4689755439758301
Epoch: 3, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.41286754608154297
Epoch: 4, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.539487361907959
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5850458145141602
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5062029361724854
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5269627571105957
Epoch: 8, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5028233528137207
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5687685012817383
Epoch: 10, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.161 Vali Acc: 0.133 Test Loss: 1.161 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5860605239868164
Epoch: 11, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5896263122558594
Epoch: 12, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5508072376251221
Epoch: 13, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5422115325927734
Epoch: 14, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4421565532684326
Epoch: 15, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps114_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 23325699
model size : 103.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps114_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.068817138671875
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4715893268585205
Epoch: 2, Steps: 1 | Train Loss: 1.283 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.199988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5387897491455078
Epoch: 3, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4532177448272705
Epoch: 4, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4718461036682129
Epoch: 5, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5077149868011475
Epoch: 6, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5580780506134033
Epoch: 7, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.5840866565704346
Epoch: 8, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.46701979637145996
Epoch: 9, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.481518030166626
Epoch: 10, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5237553119659424
Epoch: 11, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.542701005935669
Epoch: 12, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5518276691436768
Epoch: 13, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.48451662063598633
Epoch: 14, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4723639488220215
Epoch: 15, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5131094455718994
Epoch: 16, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4685947895050049
Epoch: 17, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.38144683837890625
Epoch: 18, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4282495975494385
Epoch: 19, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps114_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23245059
model size : 103.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2019412517547607
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4289131164550781
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5333561897277832
Epoch: 3, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5690300464630127
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5002038478851318
Epoch: 5, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6275882720947266
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5203666687011719
Epoch: 7, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.122 Vali Acc: 0.133 Test Loss: 1.122 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5410957336425781
Epoch: 8, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.49405479431152344
Epoch: 9, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5562326908111572
Epoch: 10, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6323719024658203
Epoch: 11, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.47568464279174805
Epoch: 12, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.436276912689209
Epoch: 13, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.49862122535705566
Epoch: 14, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.5598664283752441
Epoch: 15, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4767119884490967
Epoch: 16, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.42688417434692383
Epoch: 17, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5441546440124512
Epoch: 18, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5680744647979736
Epoch: 19, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5342824459075928
Epoch: 20, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4857513904571533
Epoch: 21, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.46773838996887207
Epoch: 22, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5744884014129639
Epoch: 23, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6481506824493408
Epoch: 24, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 23526915
model size : 104.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9170730113983154
Epoch: 1, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.44933223724365234
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.3881247043609619
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.48160266876220703
Epoch: 4, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4577915668487549
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.37158775329589844
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.34661054611206055
Epoch: 7, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.3909316062927246
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.3962416648864746
Epoch: 9, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.46737217903137207
Epoch: 10, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4688889980316162
Epoch: 11, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.44703221321105957
Epoch: 12, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.45356202125549316
Epoch: 13, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23373315
model size : 103.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0939252376556396
Epoch: 1, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5149853229522705
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6437392234802246
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4991118907928467
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40033698081970215
Epoch: 5, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4750633239746094
Epoch: 6, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.42835283279418945
Epoch: 7, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5055971145629883
Epoch: 8, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5276997089385986
Epoch: 9, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5218846797943115
Epoch: 10, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5376968383789062
Epoch: 11, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5747911930084229
Epoch: 12, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.43912601470947266
Epoch: 13, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.46939778327941895
Epoch: 14, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4702324867248535
Epoch: 15, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4537627696990967
Epoch: 16, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4474015235900879
Epoch: 17, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4682295322418213
Epoch: 18, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.546954870223999
Epoch: 19, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4864063262939453
Epoch: 20, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4457864761352539
Epoch: 21, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.42737913131713867
Epoch: 22, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4857449531555176
Epoch: 23, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5264759063720703
Epoch: 24, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.48876404762268066
Epoch: 25, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.48296332359313965
Epoch: 26, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5007538795471191
Epoch: 27, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5626697540283203
Epoch: 28, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 23296515
model size : 103.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps125_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.914353370666504
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5433151721954346
Epoch: 2, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5208275318145752
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5599408149719238
Epoch: 4, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5388898849487305
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.46114563941955566
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5012106895446777
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.031 Vali Acc: 0.333 Test Loss: 1.031 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.46784329414367676
Epoch: 8, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4496345520019531
Epoch: 9, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.027 Vali Acc: 0.333 Test Loss: 1.027 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4775378704071045
Epoch: 10, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.49790072441101074
Epoch: 11, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5184934139251709
Epoch: 12, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.4730696678161621
Epoch: 13, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47662806510925293
Epoch: 14, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4998514652252197
Epoch: 15, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4132497310638428
Epoch: 16, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.44385719299316406
Epoch: 17, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.3599281311035156
Epoch: 18, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4998750686645508
Epoch: 19, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.41472339630126953
Epoch: 20, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.48221921920776367
Epoch: 21, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4510467052459717
Epoch: 22, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps125_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23553795
model size : 104.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps125_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.918868064880371
Epoch: 1, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5278851985931396
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43947339057922363
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5152325630187988
Epoch: 4, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42820167541503906
Epoch: 5, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4893965721130371
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.49316906929016113
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5205729007720947
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5528240203857422
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.48130345344543457
Epoch: 10, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5547440052032471
Epoch: 11, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5330493450164795
Epoch: 12, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.44128847122192383
Epoch: 13, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.501286506652832
Epoch: 14, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5653786659240723
Epoch: 15, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5311827659606934
Epoch: 16, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5372574329376221
Epoch: 17, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5023605823516846
Epoch: 18, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5158133506774902
Epoch: 19, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5255088806152344
Epoch: 20, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps125_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23411715
model size : 103.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps125_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9722914695739746
Epoch: 1, Steps: 1 | Train Loss: 1.280 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.418198823928833
Epoch: 2, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48061132431030273
Epoch: 3, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.485349178314209
Epoch: 4, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.45497775077819824
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5178675651550293
Epoch: 6, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4994487762451172
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.44099974632263184
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.46756458282470703
Epoch: 9, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.39372897148132324
Epoch: 10, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.49680376052856445
Epoch: 11, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps125_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23342595
model size : 103.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps132_str33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1503279209136963
Epoch: 1, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.40389394760131836
Epoch: 2, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5010929107666016
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.4447898864746094
Epoch: 4, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.028 Vali Acc: 0.733 Test Loss: 1.028 Test Acc: 0.733
Validation loss decreased (-0.599990 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 0.4560563564300537
Epoch: 5, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.47864747047424316
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5114006996154785
Epoch: 7, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5381097793579102
Epoch: 8, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.49454331398010254
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5813338756561279
Epoch: 10, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.47448015213012695
Epoch: 11, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5247869491577148
Epoch: 12, Steps: 1 | Train Loss: 0.712 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5342106819152832
Epoch: 13, Steps: 1 | Train Loss: 0.532 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.499584436416626
Epoch: 14, Steps: 1 | Train Loss: 0.552 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps132_str33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 23606787
model size : 104.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps132_str66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.065617084503174
Epoch: 1, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.391493558883667
Epoch: 2, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4408700466156006
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.427997350692749
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3914010524749756
Epoch: 5, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5746772289276123
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.46614527702331543
Epoch: 7, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.090 Vali Acc: 0.133 Test Loss: 1.090 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4773430824279785
Epoch: 8, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.44850802421569824
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.49903416633605957
Epoch: 10, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.53094482421875
Epoch: 11, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.47737717628479004
Epoch: 12, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.45029640197753906
Epoch: 13, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5215611457824707
Epoch: 14, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4715142250061035
Epoch: 15, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5231621265411377
Epoch: 16, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.516183614730835
Epoch: 17, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4895484447479248
Epoch: 18, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6309635639190674
Epoch: 19, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5795116424560547
Epoch: 20, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5055022239685059
Epoch: 21, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps132_str66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23468547
model size : 104.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps132_str132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.023852586746216
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.45496416091918945
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4844484329223633
Epoch: 3, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4801642894744873
Epoch: 4, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4639241695404053
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4461181163787842
Epoch: 6, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.42585206031799316
Epoch: 7, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.46713876724243164
Epoch: 8, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.37744975090026855
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.3984096050262451
Epoch: 10, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4995424747467041
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4179399013519287
Epoch: 12, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps132_str132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23399427
model size : 103.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps139_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.131114959716797
Epoch: 1, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.51529860496521
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.48128771781921387
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.522144079208374
Epoch: 4, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5739028453826904
Epoch: 5, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5814142227172852
Epoch: 6, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5569107532501221
Epoch: 7, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.49969935417175293
Epoch: 8, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5576217174530029
Epoch: 9, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.42598772048950195
Epoch: 10, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.599254846572876
Epoch: 11, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.49710536003112793
Epoch: 12, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps139_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 23655939
model size : 104.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps139_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.015219211578369
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.39739441871643066
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.37907958030700684
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.41935086250305176
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.225 Vali Acc: 0.133 Test Loss: 1.225 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4636666774749756
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.243 Vali Acc: 0.200 Test Loss: 1.243 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.46171021461486816
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.238 Vali Acc: 0.200 Test Loss: 1.238 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.41729164123535156
Epoch: 7, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.34996628761291504
Epoch: 8, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.43219900131225586
Epoch: 9, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.194 Vali Acc: 0.133 Test Loss: 1.194 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4802415370941162
Epoch: 10, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4578714370727539
Epoch: 11, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.47970104217529297
Epoch: 12, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps139_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23525379
model size : 104.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps139_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.959585189819336
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3711423873901367
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5662274360656738
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4446392059326172
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42134904861450195
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.39795374870300293
Epoch: 6, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45395660400390625
Epoch: 7, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.536710262298584
Epoch: 8, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5414421558380127
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4847218990325928
Epoch: 10, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4417233467102051
Epoch: 11, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.3900754451751709
Epoch: 12, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.40698695182800293
Epoch: 13, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.36029863357543945
Epoch: 14, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4755864143371582
Epoch: 15, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.38127708435058594
Epoch: 16, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4496428966522217
Epoch: 17, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4508819580078125
Epoch: 18, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.44188404083251953
Epoch: 19, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.46407580375671387
Epoch: 20, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.46750521659851074
Epoch: 21, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.46767663955688477
Epoch: 22, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.40996694564819336
Epoch: 23, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.40959739685058594
Epoch: 24, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.44431447982788086
Epoch: 25, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4490201473236084
Epoch: 26, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.3736259937286377
Epoch: 27, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4162564277648926
Epoch: 28, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.49100279808044434
Epoch: 29, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.209 Vali Acc: 0.467 Test Loss: 1.209 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps139_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23460099
model size : 104.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps148_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7499823570251465
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.3650236129760742
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42060327529907227
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.31617021560668945
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.32804417610168457
Epoch: 5, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4289696216583252
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5191431045532227
Epoch: 7, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.47019076347351074
Epoch: 8, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.42666077613830566
Epoch: 9, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.35430216789245605
Epoch: 10, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.34714484214782715
Epoch: 11, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3435642719268799
Epoch: 12, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4405689239501953
Epoch: 13, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.3698232173919678
Epoch: 14, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.46443700790405273
Epoch: 15, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.48285937309265137
Epoch: 16, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4927372932434082
Epoch: 17, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4734029769897461
Epoch: 18, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.46749281883239746
Epoch: 19, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5359320640563965
Epoch: 20, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4775967597961426
Epoch: 21, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5164821147918701
Epoch: 22, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5088381767272949
Epoch: 23, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps148_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23723523
model size : 105.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps148_str74_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2533998489379883
Epoch: 1, Steps: 1 | Train Loss: 1.301 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4220314025878906
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.44493937492370605
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.43818068504333496
Epoch: 4, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4071340560913086
Epoch: 5, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4244825839996338
Epoch: 6, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5203123092651367
Epoch: 7, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4621772766113281
Epoch: 8, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5347781181335449
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4101262092590332
Epoch: 10, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.4815688133239746
Epoch: 11, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5861124992370605
Epoch: 12, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4768834114074707
Epoch: 13, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5155947208404541
Epoch: 14, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3906388282775879
Epoch: 15, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4193861484527588
Epoch: 16, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4986450672149658
Epoch: 17, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4197049140930176
Epoch: 18, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.41774892807006836
Epoch: 19, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4115314483642578
Epoch: 20, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps148_str74_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23600643
model size : 104.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps148_str148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9784433841705322
Epoch: 1, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.41710519790649414
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.40828990936279297
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5343718528747559
Epoch: 4, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.453838586807251
Epoch: 5, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49323534965515137
Epoch: 6, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4948618412017822
Epoch: 7, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.48853421211242676
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6137571334838867
Epoch: 9, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.46959447860717773
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4956395626068115
Epoch: 11, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4824507236480713
Epoch: 12, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.46620774269104004
Epoch: 13, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.43834996223449707
Epoch: 14, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4117705821990967
Epoch: 15, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.3693716526031494
Epoch: 16, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.48163723945617676
Epoch: 17, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps148_str148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23539203
model size : 104.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps157_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9040157794952393
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4290299415588379
Epoch: 2, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40344929695129395
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5161647796630859
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4129161834716797
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.40671277046203613
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45485639572143555
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.6626236438751221
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4733006954193115
Epoch: 9, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4559612274169922
Epoch: 10, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4793128967285156
Epoch: 11, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4294595718383789
Epoch: 12, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.534156322479248
Epoch: 13, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5028934478759766
Epoch: 14, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.45830202102661133
Epoch: 15, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4864499568939209
Epoch: 16, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.136 Vali Acc: 0.533 Test Loss: 1.136 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5000519752502441
Epoch: 17, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4569263458251953
Epoch: 18, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.45319604873657227
Epoch: 19, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.40143656730651855
Epoch: 20, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4800527095794678
Epoch: 21, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4688100814819336
Epoch: 22, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4139261245727539
Epoch: 23, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.43157410621643066
Epoch: 24, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps157_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23787267
model size : 105.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps157_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0975937843322754
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.460003137588501
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.395017147064209
Epoch: 3, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3950324058532715
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.3918333053588867
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.44080519676208496
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.46820521354675293
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.42368006706237793
Epoch: 8, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.38618040084838867
Epoch: 9, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.40176820755004883
Epoch: 10, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4064481258392334
Epoch: 11, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.33986449241638184
Epoch: 12, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.40619516372680664
Epoch: 13, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.3816237449645996
Epoch: 14, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 15 cost time: 0.38663411140441895
Epoch: 15, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3985731601715088
Epoch: 16, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.46910977363586426
Epoch: 17, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.48554396629333496
Epoch: 18, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.47464752197265625
Epoch: 19, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4147059917449951
Epoch: 20, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.47710371017456055
Epoch: 21, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.49771595001220703
Epoch: 22, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.43547916412353516
Epoch: 23, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.5285046100616455
Epoch: 24, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.023 Vali Acc: 0.667 Test Loss: 1.023 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 25 cost time: 0.49318790435791016
Epoch: 25, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4964747428894043
Epoch: 26, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.46362996101379395
Epoch: 27, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.45551347732543945
Epoch: 28, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.021 Vali Acc: 0.533 Test Loss: 1.021 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5702450275421143
Epoch: 29, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5690720081329346
Epoch: 30, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4169929027557373
Epoch: 31, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.41886258125305176
Epoch: 32, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.44489407539367676
Epoch: 33, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4404599666595459
Epoch: 34, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps157_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 23675907
model size : 104.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps157_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.756845474243164
Epoch: 1, Steps: 1 | Train Loss: 1.355 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4738309383392334
Epoch: 2, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.4613840579986572
Epoch: 3, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.44942426681518555
Epoch: 4, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.41600561141967773
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4586057662963867
Epoch: 6, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.40789794921875
Epoch: 7, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4073927402496338
Epoch: 8, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.37276387214660645
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5183193683624268
Epoch: 10, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.3992273807525635
Epoch: 11, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.44388771057128906
Epoch: 12, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47461605072021484
Epoch: 13, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4734470844268799
Epoch: 14, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.42345166206359863
Epoch: 15, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4637477397918701
Epoch: 16, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4610774517059326
Epoch: 17, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.47533559799194336
Epoch: 18, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.417111873626709
Epoch: 19, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.40628743171691895
Epoch: 20, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.37593555450439453
Epoch: 21, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps157_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23618307
model size : 104.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps167_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7576861381530762
Epoch: 1, Steps: 1 | Train Loss: 1.315 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.481090784072876
Epoch: 2, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3601651191711426
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45907068252563477
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4675166606903076
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.41288256645202637
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.3295576572418213
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.44721531867980957
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4655580520629883
Epoch: 9, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4971013069152832
Epoch: 10, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.43492555618286133
Epoch: 11, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4576857089996338
Epoch: 12, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.36684584617614746
Epoch: 13, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.4212818145751953
Epoch: 14, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.49704933166503906
Epoch: 15, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.36533617973327637
Epoch: 16, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.42772865295410156
Epoch: 17, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4471004009246826
Epoch: 18, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.435316801071167
Epoch: 19, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.4369182586669922
Epoch: 20, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.46804165840148926
Epoch: 21, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.055 Vali Acc: 0.267 Test Loss: 1.055 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.41573476791381836
Epoch: 22, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.40940141677856445
Epoch: 23, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4124724864959717
Epoch: 24, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4285929203033447
Epoch: 25, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4838261604309082
Epoch: 26, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4189333915710449
Epoch: 27, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4100077152252197
Epoch: 28, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5117371082305908
Epoch: 29, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps167_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 23867907
model size : 105.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps167_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.047309160232544
Epoch: 1, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4408540725708008
Epoch: 2, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.42954277992248535
Epoch: 3, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4578261375427246
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5197563171386719
Epoch: 5, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5702347755432129
Epoch: 6, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4871189594268799
Epoch: 7, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5548768043518066
Epoch: 8, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.4837934970855713
Epoch: 9, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.4840357303619385
Epoch: 10, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5646383762359619
Epoch: 11, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.011 Vali Acc: 0.333 Test Loss: 1.011 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.42650914192199707
Epoch: 12, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.009 Vali Acc: 0.267 Test Loss: 1.009 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4725074768066406
Epoch: 13, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5247542858123779
Epoch: 14, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4447774887084961
Epoch: 15, Steps: 1 | Train Loss: 0.430 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.479292631149292
Epoch: 16, Steps: 1 | Train Loss: 0.430 Vali Loss: 0.993 Vali Acc: 0.467 Test Loss: 0.993 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5296695232391357
Epoch: 17, Steps: 1 | Train Loss: 0.432 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.42957162857055664
Epoch: 18, Steps: 1 | Train Loss: 0.304 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.44385600090026855
Epoch: 19, Steps: 1 | Train Loss: 0.276 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps167_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 23760387
model size : 105.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps167_str167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7517063617706299
Epoch: 1, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.45273518562316895
Epoch: 2, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.41670680046081543
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.45122194290161133
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4750523567199707
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.44701719284057617
Epoch: 6, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.47109389305114746
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.47445225715637207
Epoch: 8, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.39580821990966797
Epoch: 9, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.43822717666625977
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.4700963497161865
Epoch: 11, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4805269241333008
Epoch: 12, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4448251724243164
Epoch: 13, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5180478096008301
Epoch: 14, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6274714469909668
Epoch: 15, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5594844818115234
Epoch: 16, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.47693896293640137
Epoch: 17, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5507974624633789
Epoch: 18, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6095173358917236
Epoch: 19, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5538480281829834
Epoch: 20, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps167_str167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 23706627
model size : 105.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps179_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1527099609375
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4372406005859375
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.199989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.4968135356903076
Epoch: 3, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.43994879722595215
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.46784472465515137
Epoch: 5, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3876791000366211
Epoch: 6, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5536506175994873
Epoch: 7, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5831031799316406
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.48636436462402344
Epoch: 9, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.4817984104156494
Epoch: 10, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.43494153022766113
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4387490749359131
Epoch: 12, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps179_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23963139
model size : 106.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps179_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.112539291381836
Epoch: 1, Steps: 1 | Train Loss: 1.394 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4723782539367676
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.39321255683898926
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4201183319091797
Epoch: 4, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5255355834960938
Epoch: 5, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4702451229095459
Epoch: 6, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.503504753112793
Epoch: 7, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.42833924293518066
Epoch: 8, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.45679521560668945
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5000386238098145
Epoch: 10, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5127549171447754
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4830048084259033
Epoch: 12, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5180199146270752
Epoch: 13, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5052459239959717
Epoch: 14, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5322270393371582
Epoch: 15, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.378063440322876
Epoch: 16, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.42931342124938965
Epoch: 17, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.39737868309020996
Epoch: 18, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4014780521392822
Epoch: 19, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.40731215476989746
Epoch: 20, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.3960535526275635
Epoch: 21, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps179_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 23863299
model size : 105.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps179_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.970184564590454
Epoch: 1, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.47835779190063477
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5662097930908203
Epoch: 3, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.481123685836792
Epoch: 4, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4512062072753906
Epoch: 5, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.48214077949523926
Epoch: 6, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.51763916015625
Epoch: 7, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.38892340660095215
Epoch: 8, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.47380805015563965
Epoch: 9, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5024120807647705
Epoch: 10, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5970640182495117
Epoch: 11, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.46204447746276855
Epoch: 12, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5022561550140381
Epoch: 13, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4327821731567383
Epoch: 14, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4738008975982666
Epoch: 15, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.36911773681640625
Epoch: 16, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.35373878479003906
Epoch: 17, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4185824394226074
Epoch: 18, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.45307111740112305
Epoch: 19, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4304671287536621
Epoch: 20, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4446253776550293
Epoch: 21, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4675462245941162
Epoch: 22, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5284125804901123
Epoch: 23, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.49984216690063477
Epoch: 24, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4863555431365967
Epoch: 25, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.41333556175231934
Epoch: 26, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5201804637908936
Epoch: 27, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.480226993560791
Epoch: 28, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps179_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 23813379
model size : 105.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps193_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.985908031463623
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.43288254737854004
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4619936943054199
Epoch: 3, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4171586036682129
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.42681288719177246
Epoch: 5, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.42673182487487793
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3923530578613281
Epoch: 7, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.078 Vali Acc: 0.667 Test Loss: 1.078 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 0.4224083423614502
Epoch: 8, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.45595622062683105
Epoch: 9, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.41436147689819336
Epoch: 10, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4841041564941406
Epoch: 11, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4497413635253906
Epoch: 12, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4237384796142578
Epoch: 13, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4251401424407959
Epoch: 14, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5189774036407471
Epoch: 15, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.47109150886535645
Epoch: 16, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4302694797515869
Epoch: 17, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps193_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 24076803
model size : 106.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps193_str97_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.030355930328369
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.243 Vali Acc: 0.133 Test Loss: 1.243 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.4317893981933594
Epoch: 2, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.212 Vali Acc: 0.133 Test Loss: 1.212 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.43706321716308594
Epoch: 3, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.209 Vali Acc: 0.133 Test Loss: 1.209 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.4597334861755371
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.41720056533813477
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.42394280433654785
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.48861074447631836
Epoch: 7, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.4325282573699951
Epoch: 8, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4564847946166992
Epoch: 9, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.45723390579223633
Epoch: 10, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.469618558883667
Epoch: 11, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.49955081939697266
Epoch: 12, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3907463550567627
Epoch: 13, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.44936251640319824
Epoch: 14, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.48981714248657227
Epoch: 15, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5748112201690674
Epoch: 16, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.46002912521362305
Epoch: 17, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5048487186431885
Epoch: 18, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4451625347137451
Epoch: 19, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.40743112564086914
Epoch: 20, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.516331672668457
Epoch: 21, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps193_str97_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 23984643
model size : 106.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps193_str193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.062838315963745
Epoch: 1, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4460935592651367
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.48497533798217773
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4405851364135742
Epoch: 4, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.49622035026550293
Epoch: 5, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4591078758239746
Epoch: 6, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5106468200683594
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5082855224609375
Epoch: 8, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5364763736724854
Epoch: 9, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5858113765716553
Epoch: 10, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5526301860809326
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5890891551971436
Epoch: 12, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5110464096069336
Epoch: 13, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4715101718902588
Epoch: 14, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps193_str193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 23938563
model size : 105.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps209_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1390554904937744
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4513537883758545
Epoch: 2, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.48912692070007324
Epoch: 3, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5716941356658936
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4432499408721924
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4505350589752197
Epoch: 6, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4222102165222168
Epoch: 7, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4132864475250244
Epoch: 8, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4762847423553467
Epoch: 9, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.43981170654296875
Epoch: 10, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3885672092437744
Epoch: 11, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.037 Vali Acc: 0.333 Test Loss: 1.037 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.3676736354827881
Epoch: 12, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps209_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 24208899
model size : 107.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps209_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.141139268875122
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.3761720657348633
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.169 Vali Acc: 0.067 Test Loss: 1.169 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3697848320007324
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.45375776290893555
Epoch: 4, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4946770668029785
Epoch: 5, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4206111431121826
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.3948063850402832
Epoch: 7, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.37848448753356934
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.43568944931030273
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4267542362213135
Epoch: 10, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.37589025497436523
Epoch: 11, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.43411898612976074
Epoch: 12, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3998384475708008
Epoch: 13, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.43358826637268066
Epoch: 14, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3914639949798584
Epoch: 15, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.43236351013183594
Epoch: 16, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.45223379135131836
Epoch: 17, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.47161102294921875
Epoch: 18, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.478651762008667
Epoch: 19, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.41405367851257324
Epoch: 20, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4613487720489502
Epoch: 21, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps209_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 24124419
model size : 106.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps209_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2856857776641846
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4100799560546875
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.415302038192749
Epoch: 3, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.4817051887512207
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.426938533782959
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5147571563720703
Epoch: 6, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4413909912109375
Epoch: 7, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.3941383361816406
Epoch: 8, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6404006481170654
Epoch: 9, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.38903307914733887
Epoch: 10, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.35425496101379395
Epoch: 11, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.34378910064697266
Epoch: 12, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.3228745460510254
Epoch: 13, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.34977269172668457
Epoch: 14, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.3501572608947754
Epoch: 15, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.4470193386077881
Epoch: 16, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.40137743949890137
Epoch: 17, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.35367321968078613
Epoch: 18, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3377254009246826
Epoch: 19, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.34337592124938965
Epoch: 20, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.3670351505279541
Epoch: 21, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3625915050506592
Epoch: 22, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.44762206077575684
Epoch: 23, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.3741014003753662
Epoch: 24, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4565308094024658
Epoch: 25, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps209_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 24082179
model size : 106.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps228_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9831244945526123
Epoch: 1, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.36153602600097656
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.33371853828430176
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.3827204704284668
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.38551831245422363
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.3490581512451172
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4471259117126465
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4312617778778076
Epoch: 8, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.38138508796691895
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.38736605644226074
Epoch: 10, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3867626190185547
Epoch: 11, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3680429458618164
Epoch: 12, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4198315143585205
Epoch: 13, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.3911173343658447
Epoch: 14, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.41728830337524414
Epoch: 15, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.46618223190307617
Epoch: 16, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.3509399890899658
Epoch: 17, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4753754138946533
Epoch: 18, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps228_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 24368643
model size : 107.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps228_str114_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7479252815246582
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3732459545135498
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.33333730697631836
Epoch: 3, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3784472942352295
Epoch: 4, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.35639238357543945
Epoch: 5, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.4806535243988037
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4742090702056885
Epoch: 7, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.43072938919067383
Epoch: 8, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.36601853370666504
Epoch: 9, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4174816608428955
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3839130401611328
Epoch: 11, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4162306785583496
Epoch: 12, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.3805713653564453
Epoch: 13, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.34052324295043945
Epoch: 14, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.5005455017089844
Epoch: 15, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.321941614151001
Epoch: 16, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.4203493595123291
Epoch: 17, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3601524829864502
Epoch: 18, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.359269380569458
Epoch: 19, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3605473041534424
Epoch: 20, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.36641359329223633
Epoch: 21, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.33437395095825195
Epoch: 22, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.35558128356933594
Epoch: 23, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.33101749420166016
Epoch: 24, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.34975171089172363
Epoch: 25, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4076344966888428
Epoch: 26, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps228_str114_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 24291843
model size : 107.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps228_str228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6661429405212402
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3170139789581299
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.315598726272583
Epoch: 3, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.158 Vali Acc: 0.067 Test Loss: 1.158 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.29592132568359375
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.155 Vali Acc: 0.067 Test Loss: 1.155 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.31052184104919434
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.33703064918518066
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3433535099029541
Epoch: 7, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3779430389404297
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.33490824699401855
Epoch: 9, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.33524250984191895
Epoch: 10, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.378476619720459
Epoch: 11, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4220743179321289
Epoch: 12, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3390541076660156
Epoch: 13, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3980860710144043
Epoch: 14, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3384273052215576
Epoch: 15, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.36952686309814453
Epoch: 16, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.35064125061035156
Epoch: 17, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.335129976272583
Epoch: 18, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3671543598175049
Epoch: 19, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.338822603225708
Epoch: 20, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.31333470344543457
Epoch: 21, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps228_str228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 24253443
model size : 107.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps250_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.679246187210083
Epoch: 1, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.32615208625793457
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.40189242362976074
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3738682270050049
Epoch: 4, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.38640689849853516
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3504292964935303
Epoch: 6, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3754706382751465
Epoch: 7, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4039134979248047
Epoch: 8, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.3808932304382324
Epoch: 9, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.33960938453674316
Epoch: 10, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3254249095916748
Epoch: 11, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.35144519805908203
Epoch: 12, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps250_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 24556035
model size : 108.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps250_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8590173721313477
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.3632781505584717
Epoch: 2, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.181 Vali Acc: 0.133 Test Loss: 1.181 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38382840156555176
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.182 Vali Acc: 0.067 Test Loss: 1.182 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.37597203254699707
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.186 Vali Acc: 0.067 Test Loss: 1.186 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4033541679382324
Epoch: 5, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.186 Vali Acc: 0.067 Test Loss: 1.186 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.383953332901001
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.185 Vali Acc: 0.067 Test Loss: 1.185 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.428239107131958
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.184 Vali Acc: 0.067 Test Loss: 1.184 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.35907554626464844
Epoch: 8, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.183 Vali Acc: 0.067 Test Loss: 1.183 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.39557433128356934
Epoch: 9, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.180 Vali Acc: 0.067 Test Loss: 1.180 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.38233017921447754
Epoch: 10, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.175 Vali Acc: 0.067 Test Loss: 1.175 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.3847775459289551
Epoch: 11, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps250_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 24490755
model size : 108.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps250_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.701552391052246
Epoch: 1, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.3907327651977539
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3959059715270996
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.3572547435760498
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4290602207183838
Epoch: 5, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3707432746887207
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4022483825683594
Epoch: 7, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3779642581939697
Epoch: 8, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.3763701915740967
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.4017815589904785
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.42012715339660645
Epoch: 11, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40616631507873535
Epoch: 12, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.36771225929260254
Epoch: 13, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.3642268180847168
Epoch: 14, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.38272857666015625
Epoch: 15, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.44195008277893066
Epoch: 16, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.40445518493652344
Epoch: 17, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3861699104309082
Epoch: 18, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.37015318870544434
Epoch: 19, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.3545527458190918
Epoch: 20, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.3138549327850342
Epoch: 21, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.31149864196777344
Epoch: 22, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.3259735107421875
Epoch: 23, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps250_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 24456195
model size : 107.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps278_str70_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.634099006652832
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.358290433883667
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.3808634281158447
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3222057819366455
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4120063781738281
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.3990938663482666
Epoch: 6, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4723377227783203
Epoch: 7, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5027883052825928
Epoch: 8, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.3748300075531006
Epoch: 9, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.36411237716674805
Epoch: 10, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4482381343841553
Epoch: 11, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.3641226291656494
Epoch: 12, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps278_str70_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 24798723
model size : 109.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps278_str139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8264341354370117
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.3971102237701416
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.34092020988464355
Epoch: 3, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4154953956604004
Epoch: 4, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.39637231826782227
Epoch: 5, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.37377333641052246
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3343207836151123
Epoch: 7, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.4009745121002197
Epoch: 8, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.3928647041320801
Epoch: 9, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.35479021072387695
Epoch: 10, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3394348621368408
Epoch: 11, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.31932520866394043
Epoch: 12, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps278_str139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 24737283
model size : 109.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps278_str278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7120578289031982
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.33896398544311523
Epoch: 2, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.3604588508605957
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.3866889476776123
Epoch: 4, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4373600482940674
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3814253807067871
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4648094177246094
Epoch: 7, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.3717808723449707
Epoch: 8, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.32233524322509766
Epoch: 9, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.3618123531341553
Epoch: 10, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.42534518241882324
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.3897550106048584
Epoch: 12, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.38471221923828125
Epoch: 13, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps278_str278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 24706563
model size : 108.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps313_str79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8270015716552734
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.3533809185028076
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46257877349853516
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.36548781394958496
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4028003215789795
Epoch: 5, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3688020706176758
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.37335944175720215
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.46566104888916016
Epoch: 8, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.3747689723968506
Epoch: 9, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4479656219482422
Epoch: 10, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4426252841949463
Epoch: 11, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.46425628662109375
Epoch: 12, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4159238338470459
Epoch: 13, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.43826889991760254
Epoch: 14, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3728933334350586
Epoch: 15, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.42407655715942383
Epoch: 16, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.36567211151123047
Epoch: 17, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.37671971321105957
Epoch: 18, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.42842936515808105
Epoch: 19, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4049804210662842
Epoch: 20, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.3474602699279785
Epoch: 21, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.39676475524902344
Epoch: 22, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.36351728439331055
Epoch: 23, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.3646199703216553
Epoch: 24, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 0.3996553421020508
Epoch: 25, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.3971521854400635
Epoch: 26, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.210 Vali Acc: 0.467 Test Loss: 1.210 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4400315284729004
Epoch: 27, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.3937375545501709
Epoch: 28, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4024837017059326
Epoch: 29, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.36118507385253906
Epoch: 30, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.415238618850708
Epoch: 31, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.37150001525878906
Epoch: 32, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.42248988151550293
Epoch: 33, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.3457481861114502
Epoch: 34, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.342 Vali Acc: 0.333 Test Loss: 1.342 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps313_str79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 25105923
model size : 110.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps313_str157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.991156816482544
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.3924267292022705
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40595483779907227
Epoch: 3, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45867371559143066
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.43123841285705566
Epoch: 5, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5306682586669922
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4138524532318115
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4884626865386963
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4062011241912842
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.40746021270751953
Epoch: 10, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5164234638214111
Epoch: 11, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps313_str157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 25052163
model size : 110.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps313_str313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2486209869384766
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.37121009826660156
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3433353900909424
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.48946428298950195
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3886287212371826
Epoch: 5, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.37689781188964844
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4121084213256836
Epoch: 7, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.3581883907318115
Epoch: 8, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.3860602378845215
Epoch: 9, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47584009170532227
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3417344093322754
Epoch: 11, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.40533947944641113
Epoch: 12, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.44069862365722656
Epoch: 13, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.4888882637023926
Epoch: 14, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.45882511138916016
Epoch: 15, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.40691137313842773
Epoch: 16, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.439774751663208
Epoch: 17, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.49001336097717285
Epoch: 18, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4874441623687744
Epoch: 19, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5275020599365234
Epoch: 20, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5224301815032959
Epoch: 21, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4890122413635254
Epoch: 22, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4355001449584961
Epoch: 23, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.42760300636291504
Epoch: 24, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps313_str313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 25025283
model size : 110.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps358_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2264676094055176
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.3604545593261719
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5086653232574463
Epoch: 3, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45458340644836426
Epoch: 4, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.405102014541626
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4063847064971924
Epoch: 6, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4007878303527832
Epoch: 7, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4843285083770752
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.48612236976623535
Epoch: 9, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.46160125732421875
Epoch: 10, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5009322166442871
Epoch: 11, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.45351362228393555
Epoch: 12, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.432772159576416
Epoch: 13, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.6434402465820312
Epoch: 14, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4808988571166992
Epoch: 15, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4391911029815674
Epoch: 16, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.43075013160705566
Epoch: 17, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4256627559661865
Epoch: 18, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4693281650543213
Epoch: 19, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.47330665588378906
Epoch: 20, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.44487524032592773
Epoch: 21, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5462677478790283
Epoch: 22, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4329667091369629
Epoch: 23, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.596398115158081
Epoch: 24, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4315190315246582
Epoch: 25, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4608924388885498
Epoch: 26, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps358_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 25505283
model size : 111.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps358_str179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9269821643829346
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4548075199127197
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4483163356781006
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4360959529876709
Epoch: 4, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4383068084716797
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4196197986602783
Epoch: 6, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5283017158508301
Epoch: 7, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.46396493911743164
Epoch: 8, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.4288980960845947
Epoch: 9, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.47419238090515137
Epoch: 10, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4463949203491211
Epoch: 11, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.49459195137023926
Epoch: 12, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4785423278808594
Epoch: 13, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5022644996643066
Epoch: 14, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6071429252624512
Epoch: 15, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4359416961669922
Epoch: 16, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4281423091888428
Epoch: 17, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5283713340759277
Epoch: 18, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.47869014739990234
Epoch: 19, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.45395588874816895
Epoch: 20, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps358_str179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 25459203
model size : 111.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps358_str358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1130287647247314
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.36487913131713867
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.49265241622924805
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5051255226135254
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.43623924255371094
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.388822078704834
Epoch: 6, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5231227874755859
Epoch: 7, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.49564266204833984
Epoch: 8, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.39386439323425293
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.40427446365356445
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.42304420471191406
Epoch: 11, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.37987446784973145
Epoch: 12, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.5623378753662109
Epoch: 13, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.41323280334472656
Epoch: 14, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.44652628898620605
Epoch: 15, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.49681854248046875
Epoch: 16, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.4179384708404541
Epoch: 17, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.5484068393707275
Epoch: 18, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.47003769874572754
Epoch: 19, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.38817715644836426
Epoch: 20, Steps: 1 | Train Loss: 0.303 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5017437934875488
Epoch: 21, Steps: 1 | Train Loss: 0.288 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4537193775177002
Epoch: 22, Steps: 1 | Train Loss: 0.255 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4522993564605713
Epoch: 23, Steps: 1 | Train Loss: 0.211 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5038504600524902
Epoch: 24, Steps: 1 | Train Loss: 0.186 Vali Loss: 0.990 Vali Acc: 0.533 Test Loss: 0.990 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.473982572555542
Epoch: 25, Steps: 1 | Train Loss: 0.128 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 0.4707820415496826
Epoch: 26, Steps: 1 | Train Loss: 0.133 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.46173739433288574
Epoch: 27, Steps: 1 | Train Loss: 0.083 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4507479667663574
Epoch: 28, Steps: 1 | Train Loss: 0.085 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.47717976570129395
Epoch: 29, Steps: 1 | Train Loss: 0.068 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4339599609375
Epoch: 30, Steps: 1 | Train Loss: 0.064 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4398322105407715
Epoch: 31, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5381605625152588
Epoch: 32, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.41762709617614746
Epoch: 33, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.37931036949157715
Epoch: 34, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.42853355407714844
Epoch: 35, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps358_str358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 25436163
model size : 111.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps417_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.873042345046997
Epoch: 1, Steps: 1 | Train Loss: 1.324 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.3892858028411865
Epoch: 2, Steps: 1 | Train Loss: 1.295 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42645812034606934
Epoch: 3, Steps: 1 | Train Loss: 1.348 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49843716621398926
Epoch: 4, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.41715073585510254
Epoch: 5, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.35931968688964844
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3851618766784668
Epoch: 7, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.40556812286376953
Epoch: 8, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.41353869438171387
Epoch: 9, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.40701723098754883
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4064311981201172
Epoch: 11, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4389052391052246
Epoch: 12, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.4041306972503662
Epoch: 13, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5656147003173828
Epoch: 14, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.45598554611206055
Epoch: 15, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.40113043785095215
Epoch: 16, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5214812755584717
Epoch: 17, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.4547722339630127
Epoch: 18, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4982011318206787
Epoch: 19, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5071299076080322
Epoch: 20, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.49866247177124023
Epoch: 21, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.40632200241088867
Epoch: 22, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.39900851249694824
Epoch: 23, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4815688133239746
Epoch: 24, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.40257930755615234
Epoch: 25, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5719640254974365
Epoch: 26, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5800285339355469
Epoch: 27, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.43936705589294434
Epoch: 28, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4885106086730957
Epoch: 29, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.39342784881591797
Epoch: 30, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.34900617599487305
Epoch: 31, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.49944114685058594
Epoch: 32, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps417_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 26033667
model size : 113.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps417_str209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1208443641662598
Epoch: 1, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.43773865699768066
Epoch: 2, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.4355494976043701
Epoch: 3, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.39516448974609375
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.443310022354126
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5209910869598389
Epoch: 6, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4837493896484375
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5560932159423828
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4607887268066406
Epoch: 9, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.44858789443969727
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.5006458759307861
Epoch: 11, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.41008758544921875
Epoch: 12, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.4313182830810547
Epoch: 13, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.34517598152160645
Epoch: 14, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4369473457336426
Epoch: 15, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3947422504425049
Epoch: 16, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4655179977416992
Epoch: 17, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3512885570526123
Epoch: 18, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.017 Vali Acc: 0.333 Test Loss: 1.017 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.35129547119140625
Epoch: 19, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.018 Vali Acc: 0.333 Test Loss: 1.018 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4324381351470947
Epoch: 20, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5222368240356445
Epoch: 21, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5502324104309082
Epoch: 22, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.439866304397583
Epoch: 23, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps417_str209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 25995267
model size : 113.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps417_str417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3903284072875977
Epoch: 1, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.311 Vali Acc: 0.267 Test Loss: 1.311 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4706895351409912
Epoch: 2, Steps: 1 | Train Loss: 1.315 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.37906956672668457
Epoch: 3, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.45975279808044434
Epoch: 4, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.46065688133239746
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3779628276824951
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5240862369537354
Epoch: 7, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4376976490020752
Epoch: 8, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.44036006927490234
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.41828346252441406
Epoch: 10, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4593665599822998
Epoch: 11, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.44716382026672363
Epoch: 12, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5718374252319336
Epoch: 13, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.43871116638183594
Epoch: 14, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.40345215797424316
Epoch: 15, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.49704885482788086
Epoch: 16, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4814126491546631
Epoch: 17, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.4550797939300537
Epoch: 18, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4308328628540039
Epoch: 19, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3868367671966553
Epoch: 20, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.36995601654052734
Epoch: 21, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.398761510848999
Epoch: 22, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.34543871879577637
Epoch: 23, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.43091773986816406
Epoch: 24, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.43599367141723633
Epoch: 25, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5253562927246094
Epoch: 26, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.506904125213623
Epoch: 27, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps417_str417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 25976067
model size : 113.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps500_str125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3789520263671875
Epoch: 1, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4644613265991211
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.4793074131011963
Epoch: 3, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4317662715911865
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.47069883346557617
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.48384976387023926
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4224212169647217
Epoch: 7, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.4369058609008789
Epoch: 8, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 9 cost time: 0.40213775634765625
Epoch: 9, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.46047234535217285
Epoch: 10, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5178060531616211
Epoch: 11, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5342433452606201
Epoch: 12, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5056886672973633
Epoch: 13, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 14 cost time: 0.41007375717163086
Epoch: 14, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 15 cost time: 0.5454349517822266
Epoch: 15, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43862318992614746
Epoch: 16, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.5870046615600586
Epoch: 17, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.37390685081481934
Epoch: 18, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.45372796058654785
Epoch: 19, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.115 Vali Acc: 0.133 Test Loss: 1.115 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3964393138885498
Epoch: 20, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.478090763092041
Epoch: 21, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.42602109909057617
Epoch: 22, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4709899425506592
Epoch: 23, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.3985922336578369
Epoch: 24, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.46335697174072266
Epoch: 25, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.44853949546813965
Epoch: 26, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps500_str125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 26787075
model size : 116.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps500_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0508720874786377
Epoch: 1, Steps: 1 | Train Loss: 1.349 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.42787742614746094
Epoch: 2, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.45133423805236816
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.3840775489807129
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44918107986450195
Epoch: 5, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4723374843597412
Epoch: 6, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.44223833084106445
Epoch: 7, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.47327136993408203
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.47637510299682617
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4854304790496826
Epoch: 10, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.41991496086120605
Epoch: 11, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.3943459987640381
Epoch: 12, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.353621244430542
Epoch: 13, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps500_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 26756355
model size : 116.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps500_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9466609954833984
Epoch: 1, Steps: 1 | Train Loss: 1.324 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.42310571670532227
Epoch: 2, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5525307655334473
Epoch: 3, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6785008907318115
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4507591724395752
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.49170899391174316
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4675436019897461
Epoch: 7, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.49701595306396484
Epoch: 8, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6041154861450195
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.45252275466918945
Epoch: 10, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.44890856742858887
Epoch: 11, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.535344123840332
Epoch: 12, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4502851963043213
Epoch: 13, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5368103981018066
Epoch: 14, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5673961639404297
Epoch: 15, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_GPT4TS_UEA_ftM_sl2500_ll0_pl0_el3_dm768_df768_ps500_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 26740995
model size : 116.67MB
