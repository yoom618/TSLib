Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5767433643341064
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.567 Vali Acc: 0.406 Test Loss: 1.567 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 2.724738597869873
Epoch: 2, Steps: 12 | Train Loss: 1.322 Vali Loss: 0.983 Vali Acc: 0.711 Test Loss: 0.983 Test Acc: 0.711
Validation loss decreased (-0.405540 --> -0.711101).  Saving model ...
Epoch: 3 cost time: 2.14335560798645
Epoch: 3, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.693 Vali Acc: 0.706 Test Loss: 0.693 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.863651990890503
Epoch: 4, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.472 Vali Acc: 0.783 Test Loss: 0.472 Test Acc: 0.783
Validation loss decreased (-0.711101 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 2.6230273246765137
Epoch: 5, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.513 Vali Acc: 0.794 Test Loss: 0.513 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794439).  Saving model ...
Epoch: 6 cost time: 2.2916061878204346
Epoch: 6, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 2.451415777206421
Epoch: 7, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.843423366546631
Epoch: 8, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6847574710845947
Epoch: 9, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.222 Vali Acc: 0.883 Test Loss: 0.222 Test Acc: 0.883
Validation loss decreased (-0.833330 --> -0.883331).  Saving model ...
Epoch: 10 cost time: 2.5159525871276855
Epoch: 10, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.992966413497925
Epoch: 11, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5905609130859375
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.658489942550659
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 3.0448458194732666
Epoch: 14, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 2.7617454528808594
Epoch: 15, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.681 Vali Acc: 0.861 Test Loss: 0.681 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1337413787841797
Epoch: 16, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.960 Vali Acc: 0.850 Test Loss: 0.960 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9909889698028564
Epoch: 17, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.247697591781616
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.171356678009033
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.444 Vali Acc: 0.928 Test Loss: 0.444 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927773).  Saving model ...
Epoch: 20 cost time: 2.0913949012756348
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0185413360595703
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.640 Vali Acc: 0.878 Test Loss: 0.640 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9797379970550537
Epoch: 22, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.517 Vali Acc: 0.883 Test Loss: 0.517 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.986337184906006
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.830 Vali Acc: 0.906 Test Loss: 0.830 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3733696937561035
Epoch: 24, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.927773 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 2.8574576377868652
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.538 Vali Acc: 0.917 Test Loss: 0.538 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1097452640533447
Epoch: 26, Steps: 12 | Train Loss: 0.164 Vali Loss: 1.298 Vali Acc: 0.900 Test Loss: 1.298 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.76636004447937
Epoch: 27, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.602 Vali Acc: 0.911 Test Loss: 0.602 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9878621101379395
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.770 Vali Acc: 0.917 Test Loss: 0.770 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.851839303970337
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.389 Vali Acc: 0.928 Test Loss: 0.389 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.815328598022461
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.765 Vali Acc: 0.917 Test Loss: 0.765 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.567133665084839
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.917 Test Loss: 0.592 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.4710495471954346
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.499 Vali Acc: 0.928 Test Loss: 0.499 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.0649054050445557
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.933 Test Loss: 0.603 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.854116678237915
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.917 Test Loss: 0.975 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 43846662
model size : 181.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.066755294799805
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.627 Vali Acc: 0.422 Test Loss: 1.627 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 1.8288946151733398
Epoch: 2, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.206 Vali Acc: 0.711 Test Loss: 1.206 Test Acc: 0.711
Validation loss decreased (-0.422206 --> -0.711099).  Saving model ...
Epoch: 3 cost time: 2.2809877395629883
Epoch: 3, Steps: 12 | Train Loss: 1.030 Vali Loss: 0.791 Vali Acc: 0.783 Test Loss: 0.791 Test Acc: 0.783
Validation loss decreased (-0.711099 --> -0.783325).  Saving model ...
Epoch: 4 cost time: 2.156398057937622
Epoch: 4, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.549 Vali Acc: 0.733 Test Loss: 0.549 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6283247470855713
Epoch: 5, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.424 Vali Acc: 0.772 Test Loss: 0.424 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.645326852798462
Epoch: 6, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.575 Vali Acc: 0.778 Test Loss: 0.575 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.339545249938965
Epoch: 7, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
Validation loss decreased (-0.783325 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.5987815856933594
Epoch: 8, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.37430739402771
Epoch: 9, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.600 Vali Acc: 0.800 Test Loss: 0.600 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6989662647247314
Epoch: 10, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.343564748764038
Epoch: 11, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5365138053894043
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.248 Vali Acc: 0.872 Test Loss: 0.248 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872220).  Saving model ...
Epoch: 13 cost time: 2.3255884647369385
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2316625118255615
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.203 Vali Acc: 0.900 Test Loss: 0.203 Test Acc: 0.900
Validation loss decreased (-0.872220 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 1.9959440231323242
Epoch: 15, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 2.403872489929199
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9292733669281006
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.352328300476074
Epoch: 18, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.845576286315918
Epoch: 19, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3392388820648193
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.368 Vali Acc: 0.883 Test Loss: 0.368 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.671187400817871
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4239630699157715
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8723275661468506
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.4387049674987793
Epoch: 24, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.468 Vali Acc: 0.922 Test Loss: 0.468 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922218).  Saving model ...
Epoch: 25 cost time: 1.5659921169281006
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.522 Vali Acc: 0.911 Test Loss: 0.522 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6732532978057861
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.681 Vali Acc: 0.878 Test Loss: 0.681 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.004283905029297
Epoch: 27, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.910 Vali Acc: 0.889 Test Loss: 0.910 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.063477039337158
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 2.051945924758911
Epoch: 29, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.397 Vali Acc: 0.933 Test Loss: 0.397 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.128523111343384
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.433 Vali Acc: 0.917 Test Loss: 0.433 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9450504779815674
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.777 Vali Acc: 0.906 Test Loss: 0.777 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0483944416046143
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.856863021850586
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.842 Vali Acc: 0.917 Test Loss: 0.842 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.907984733581543
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.371 Vali Acc: 0.928 Test Loss: 0.371 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9325082302093506
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.580 Vali Acc: 0.917 Test Loss: 0.580 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.026973009109497
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.889 Test Loss: 0.827 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.1387555599212646
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.603208541870117
Epoch: 38, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.967 Vali Acc: 0.878 Test Loss: 0.967 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 43699206
model size : 181.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.339929103851318
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.669 Vali Acc: 0.417 Test Loss: 1.669 Test Acc: 0.417
Validation loss decreased (inf --> -0.416650).  Saving model ...
Epoch: 2 cost time: 2.105764865875244
Epoch: 2, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.356 Vali Acc: 0.661 Test Loss: 1.356 Test Acc: 0.661
Validation loss decreased (-0.416650 --> -0.661098).  Saving model ...
Epoch: 3 cost time: 2.557253122329712
Epoch: 3, Steps: 12 | Train Loss: 1.199 Vali Loss: 0.953 Vali Acc: 0.728 Test Loss: 0.953 Test Acc: 0.728
Validation loss decreased (-0.661098 --> -0.727768).  Saving model ...
Epoch: 4 cost time: 2.7850866317749023
Epoch: 4, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.648 Vali Acc: 0.706 Test Loss: 0.648 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.243842363357544
Epoch: 5, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.509 Vali Acc: 0.767 Test Loss: 0.509 Test Acc: 0.767
Validation loss decreased (-0.727768 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 2.1606130599975586
Epoch: 6, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 2.7221474647521973
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.378 Vali Acc: 0.783 Test Loss: 0.378 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783330).  Saving model ...
Epoch: 8 cost time: 2.00748872756958
Epoch: 8, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.783330 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 2.732635259628296
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
Validation loss decreased (-0.855552 --> -0.894442).  Saving model ...
Epoch: 10 cost time: 2.4938948154449463
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.453 Vali Acc: 0.817 Test Loss: 0.453 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0903329849243164
Epoch: 11, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7196009159088135
Epoch: 12, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.434 Vali Acc: 0.828 Test Loss: 0.434 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8279869556427
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2186696529388428
Epoch: 14, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 2.629483461380005
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.134718418121338
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.317 Vali Acc: 0.928 Test Loss: 0.317 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927775).  Saving model ...
Epoch: 17 cost time: 2.741366386413574
Epoch: 17, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 18 cost time: 2.2229716777801514
Epoch: 18, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.058884382247925
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7141549587249756
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.792438268661499
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.222444772720337
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9474842548370361
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.6176440715789795
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.7342686653137207
Epoch: 25, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2226173877716064
Epoch: 26, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
Validation loss decreased (-0.927775 --> -0.949999).  Saving model ...
Epoch: 27 cost time: 2.7690043449401855
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.136 Vali Acc: 0.956 Test Loss: 0.136 Test Acc: 0.956
Validation loss decreased (-0.949999 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 2.203805446624756
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0925145149230957
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.524 Vali Acc: 0.928 Test Loss: 0.524 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.747349262237549
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.7570981979370117
Epoch: 31, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.446 Vali Acc: 0.917 Test Loss: 0.446 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.118515729904175
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.5740604400634766
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.2855443954467773
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.357 Vali Acc: 0.933 Test Loss: 0.357 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.5444955825805664
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.404 Vali Acc: 0.933 Test Loss: 0.404 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.8406810760498047
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.080503225326538
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.939 Test Loss: 0.258 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 43650054
model size : 181.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.998091459274292
Epoch: 1, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.474 Vali Acc: 0.494 Test Loss: 1.474 Test Acc: 0.494
Validation loss decreased (inf --> -0.494430).  Saving model ...
Epoch: 2 cost time: 3.39154052734375
Epoch: 2, Steps: 12 | Train Loss: 1.223 Vali Loss: 0.937 Vali Acc: 0.717 Test Loss: 0.937 Test Acc: 0.717
Validation loss decreased (-0.494430 --> -0.716657).  Saving model ...
Epoch: 3 cost time: 3.4341161251068115
Epoch: 3, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.648 Vali Acc: 0.672 Test Loss: 0.648 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0015828609466553
Epoch: 4, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.536 Vali Acc: 0.733 Test Loss: 0.536 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 3.32919979095459
Epoch: 5, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.361 Vali Acc: 0.844 Test Loss: 0.361 Test Acc: 0.844
Validation loss decreased (-0.733328 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 2.81619930267334
Epoch: 6, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0308985710144043
Epoch: 7, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.488858222961426
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.889321804046631
Epoch: 9, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.601 Vali Acc: 0.817 Test Loss: 0.601 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.492542266845703
Epoch: 10, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 3.9755215644836426
Epoch: 11, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4070417881011963
Epoch: 12, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 4.0738184452056885
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.658906936645508
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.387 Vali Acc: 0.878 Test Loss: 0.387 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.1047515869140625
Epoch: 15, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 3.7290308475494385
Epoch: 16, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.083319187164307
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 3.425438404083252
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2288968563079834
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.352 Vali Acc: 0.894 Test Loss: 0.352 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.450371026992798
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905552).  Saving model ...
Epoch: 21 cost time: 3.0486903190612793
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.792 Vali Acc: 0.889 Test Loss: 0.792 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.991955518722534
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.973 Vali Acc: 0.894 Test Loss: 0.973 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0663211345672607
Epoch: 23, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905552).  Saving model ...
Epoch: 24 cost time: 2.975243330001831
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.647 Vali Acc: 0.883 Test Loss: 0.647 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.757460355758667
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.421 Vali Acc: 0.917 Test Loss: 0.421 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916662).  Saving model ...
Epoch: 26 cost time: 3.8682589530944824
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.652 Vali Acc: 0.872 Test Loss: 0.652 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.117525100708008
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.830 Vali Acc: 0.867 Test Loss: 0.830 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.783749580383301
Epoch: 28, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.660 Vali Acc: 0.883 Test Loss: 0.660 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.253429651260376
Epoch: 29, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.9613218307495117
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.883 Test Loss: 0.500 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.111504077911377
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.840 Vali Acc: 0.900 Test Loss: 0.840 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.4928877353668213
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.610 Vali Acc: 0.911 Test Loss: 0.610 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.015640020370483
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.776 Vali Acc: 0.894 Test Loss: 0.776 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.8025922775268555
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.661 Vali Acc: 0.900 Test Loss: 0.661 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.9852898120880127
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.732 Vali Acc: 0.906 Test Loss: 0.732 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 43895814
model size : 182.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.605597257614136
Epoch: 1, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.513 Vali Acc: 0.556 Test Loss: 1.513 Test Acc: 0.556
Validation loss decreased (inf --> -0.555540).  Saving model ...
Epoch: 2 cost time: 2.9144527912139893
Epoch: 2, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.112 Vali Acc: 0.628 Test Loss: 1.112 Test Acc: 0.628
Validation loss decreased (-0.555540 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 2.6614491939544678
Epoch: 3, Steps: 12 | Train Loss: 0.986 Vali Loss: 0.764 Vali Acc: 0.689 Test Loss: 0.764 Test Acc: 0.689
Validation loss decreased (-0.627767 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 2.982633113861084
Epoch: 4, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.573 Vali Acc: 0.767 Test Loss: 0.573 Test Acc: 0.767
Validation loss decreased (-0.688881 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 3.214421033859253
Epoch: 5, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.481 Vali Acc: 0.772 Test Loss: 0.481 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 2.5114426612854004
Epoch: 6, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.432 Vali Acc: 0.822 Test Loss: 0.432 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 3.1812732219696045
Epoch: 7, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7854857444763184
Epoch: 8, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.574 Vali Acc: 0.811 Test Loss: 0.574 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.322540521621704
Epoch: 9, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.437 Vali Acc: 0.828 Test Loss: 0.437 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 3.0977416038513184
Epoch: 10, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.390 Vali Acc: 0.839 Test Loss: 0.390 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 3.1234960556030273
Epoch: 11, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.462 Vali Acc: 0.839 Test Loss: 0.462 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3384339809417725
Epoch: 12, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.393 Vali Acc: 0.844 Test Loss: 0.393 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 2.529468536376953
Epoch: 13, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.413 Vali Acc: 0.839 Test Loss: 0.413 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.251500129699707
Epoch: 14, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.659 Vali Acc: 0.872 Test Loss: 0.659 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872216).  Saving model ...
Epoch: 15 cost time: 3.031663417816162
Epoch: 15, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9941184520721436
Epoch: 16, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.121694803237915
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
Validation loss decreased (-0.872216 --> -0.905554).  Saving model ...
Epoch: 18 cost time: 2.708017587661743
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.096090316772461
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.362 Vali Acc: 0.911 Test Loss: 0.362 Test Acc: 0.911
Validation loss decreased (-0.905554 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 2.6825733184814453
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.367 Vali Acc: 0.883 Test Loss: 0.367 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2484099864959717
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9700562953948975
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.432293176651001
Epoch: 23, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.920 Vali Acc: 0.850 Test Loss: 0.920 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3811495304107666
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2925713062286377
Epoch: 25, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.8679819107055664
Epoch: 26, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.240694999694824
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.407 Vali Acc: 0.922 Test Loss: 0.407 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922218).  Saving model ...
Epoch: 28 cost time: 2.8187594413757324
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.805 Vali Acc: 0.872 Test Loss: 0.805 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.248789072036743
Epoch: 29, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.831 Vali Acc: 0.922 Test Loss: 0.831 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2593674659729004
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.400 Vali Acc: 0.939 Test Loss: 0.400 Test Acc: 0.939
Validation loss decreased (-0.922218 --> -0.938885).  Saving model ...
Epoch: 31 cost time: 3.2612879276275635
Epoch: 31, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.339 Vali Acc: 0.933 Test Loss: 0.339 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.197563886642456
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.642 Vali Acc: 0.933 Test Loss: 0.642 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.9021382331848145
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.493 Vali Acc: 0.939 Test Loss: 0.493 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.351316213607788
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.381 Vali Acc: 0.922 Test Loss: 0.381 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.9685235023498535
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.136362075805664
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.940 Vali Acc: 0.850 Test Loss: 0.940 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.096112012863159
Epoch: 37, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.591 Vali Acc: 0.900 Test Loss: 0.591 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.3866264820098877
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.581 Vali Acc: 0.883 Test Loss: 0.581 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.319277286529541
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.110 Vali Acc: 0.883 Test Loss: 1.110 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.0898032188415527
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 43748358
model size : 181.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.940730333328247
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.699 Vali Acc: 0.244 Test Loss: 1.699 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 2.0391056537628174
Epoch: 2, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.428 Vali Acc: 0.633 Test Loss: 1.428 Test Acc: 0.633
Validation loss decreased (-0.244427 --> -0.633319).  Saving model ...
Epoch: 3 cost time: 1.8161811828613281
Epoch: 3, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.028 Vali Acc: 0.689 Test Loss: 1.028 Test Acc: 0.689
Validation loss decreased (-0.633319 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 1.9434058666229248
Epoch: 4, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
Validation loss decreased (-0.688879 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.790281057357788
Epoch: 5, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.573 Vali Acc: 0.761 Test Loss: 0.573 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 1.9896197319030762
Epoch: 6, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.550 Vali Acc: 0.744 Test Loss: 0.550 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0996110439300537
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.495 Vali Acc: 0.767 Test Loss: 0.495 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 1.7126660346984863
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 2.0394022464752197
Epoch: 9, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805552).  Saving model ...
Epoch: 10 cost time: 1.8149399757385254
Epoch: 10, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.543 Vali Acc: 0.794 Test Loss: 0.543 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0298657417297363
Epoch: 11, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0095744132995605
Epoch: 12, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
Validation loss decreased (-0.805552 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.7460711002349854
Epoch: 13, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.570 Vali Acc: 0.817 Test Loss: 0.570 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0561907291412354
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.070345401763916
Epoch: 15, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.9908533096313477
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 1.9749953746795654
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.630018949508667
Epoch: 18, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.402 Vali Acc: 0.883 Test Loss: 0.402 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0324714183807373
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0327534675598145
Epoch: 20, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.708395004272461
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8230257034301758
Epoch: 22, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6850755214691162
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7382471561431885
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.706740140914917
Epoch: 25, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 26 cost time: 1.6813502311706543
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.6704025268554688
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6633517742156982
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6493337154388428
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7119591236114502
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.442 Vali Acc: 0.883 Test Loss: 0.442 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8153128623962402
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 2.0635242462158203
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.594 Vali Acc: 0.883 Test Loss: 0.594 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9107961654663086
Epoch: 33, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.809312343597412
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.387 Vali Acc: 0.894 Test Loss: 0.387 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.1295113563537598
Epoch: 35, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.378 Vali Acc: 0.883 Test Loss: 0.378 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.024951934814453
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5678074359893799
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3676972389221191
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9686121940612793
Epoch: 39, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.447 Vali Acc: 0.894 Test Loss: 0.447 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.8368573188781738
Epoch: 40, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.407 Vali Acc: 0.928 Test Loss: 0.407 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927774).  Saving model ...
Epoch: 41 cost time: 1.3044664859771729
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.933 Test Loss: 0.148 Test Acc: 0.933
Validation loss decreased (-0.927774 --> -0.933332).  Saving model ...
Epoch: 42 cost time: 1.9074442386627197
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9646284580230713
Epoch: 43, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7423229217529297
Epoch: 44, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.618 Vali Acc: 0.900 Test Loss: 0.618 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4165332317352295
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.008244276046753
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.9334063529968262
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.8468742370605469
Epoch: 48, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.939 Test Loss: 0.155 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 49 cost time: 1.9409103393554688
Epoch: 49, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.971510887145996
Epoch: 50, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.329 Vali Acc: 0.956 Test Loss: 0.329 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955552).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 43674630
model size : 181.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0802247524261475
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.640 Vali Acc: 0.444 Test Loss: 1.640 Test Acc: 0.444
Validation loss decreased (inf --> -0.444428).  Saving model ...
Epoch: 2 cost time: 3.0333714485168457
Epoch: 2, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.190 Vali Acc: 0.617 Test Loss: 1.190 Test Acc: 0.617
Validation loss decreased (-0.444428 --> -0.616655).  Saving model ...
Epoch: 3 cost time: 2.693542242050171
Epoch: 3, Steps: 12 | Train Loss: 1.001 Vali Loss: 0.676 Vali Acc: 0.733 Test Loss: 0.676 Test Acc: 0.733
Validation loss decreased (-0.616655 --> -0.733327).  Saving model ...
Epoch: 4 cost time: 3.1147122383117676
Epoch: 4, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.512 Vali Acc: 0.744 Test Loss: 0.512 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 2.620548963546753
Epoch: 5, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.370 Vali Acc: 0.800 Test Loss: 0.370 Test Acc: 0.800
Validation loss decreased (-0.744439 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.9525113105773926
Epoch: 6, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.30892276763916
Epoch: 7, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.361 Vali Acc: 0.844 Test Loss: 0.361 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 2.9903452396392822
Epoch: 8, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3227202892303467
Epoch: 9, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.514 Vali Acc: 0.767 Test Loss: 0.514 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.900684118270874
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 2.553223133087158
Epoch: 11, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.744 Vali Acc: 0.811 Test Loss: 0.744 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0427091121673584
Epoch: 12, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9629194736480713
Epoch: 13, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.207 Vali Acc: 0.900 Test Loss: 0.207 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 3.230234384536743
Epoch: 14, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7735743522644043
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 3.220050096511841
Epoch: 16, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2713844776153564
Epoch: 17, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8774561882019043
Epoch: 18, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.498 Vali Acc: 0.911 Test Loss: 0.498 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911106).  Saving model ...
Epoch: 19 cost time: 2.924078941345215
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.911106 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 2.4437825679779053
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7765696048736572
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.151061773300171
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.522 Vali Acc: 0.894 Test Loss: 0.522 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.479440689086914
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3601746559143066
Epoch: 24, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.785 Vali Acc: 0.900 Test Loss: 0.785 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2044832706451416
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1765661239624023
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.653 Vali Acc: 0.894 Test Loss: 0.653 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3113763332366943
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.1236369609832764
Epoch: 28, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.323 Vali Acc: 0.933 Test Loss: 0.323 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1960203647613525
Epoch: 29, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 43803654
model size : 181.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.4721434116363525
Epoch: 1, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.574 Vali Acc: 0.550 Test Loss: 1.574 Test Acc: 0.550
Validation loss decreased (inf --> -0.549984).  Saving model ...
Epoch: 2 cost time: 2.673849582672119
Epoch: 2, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.251 Vali Acc: 0.561 Test Loss: 1.251 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561099).  Saving model ...
Epoch: 3 cost time: 2.6587252616882324
Epoch: 3, Steps: 12 | Train Loss: 1.122 Vali Loss: 0.850 Vali Acc: 0.711 Test Loss: 0.850 Test Acc: 0.711
Validation loss decreased (-0.561099 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 2.203322172164917
Epoch: 4, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.549 Vali Acc: 0.767 Test Loss: 0.549 Test Acc: 0.767
Validation loss decreased (-0.711103 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 2.4512317180633545
Epoch: 5, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.432 Vali Acc: 0.772 Test Loss: 0.432 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772218).  Saving model ...
Epoch: 6 cost time: 2.684101104736328
Epoch: 6, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
Validation loss decreased (-0.772218 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 2.233079671859741
Epoch: 7, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.374 Vali Acc: 0.806 Test Loss: 0.374 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8063836097717285
Epoch: 8, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.7752838134765625
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
Validation loss decreased (-0.833330 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 2.1587934494018555
Epoch: 10, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.526444435119629
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 12 cost time: 1.964238166809082
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3613693714141846
Epoch: 13, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8598003387451172
Epoch: 14, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5121376514434814
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.607835531234741
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4354465007781982
Epoch: 17, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.157 Vali Acc: 0.917 Test Loss: 0.157 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 2.4561214447021484
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.715149164199829
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3807320594787598
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4821059703826904
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.896 Vali Acc: 0.844 Test Loss: 0.896 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6201634407043457
Epoch: 22, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5031795501708984
Epoch: 23, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.555 Vali Acc: 0.894 Test Loss: 0.555 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4859724044799805
Epoch: 24, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.437570571899414
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.871901512145996
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.432 Vali Acc: 0.894 Test Loss: 0.432 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5145084857940674
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 43754502
model size : 181.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.492063045501709
Epoch: 1, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.667 Vali Acc: 0.406 Test Loss: 1.667 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 1.664646863937378
Epoch: 2, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.418 Vali Acc: 0.633 Test Loss: 1.418 Test Acc: 0.633
Validation loss decreased (-0.405539 --> -0.633319).  Saving model ...
Epoch: 3 cost time: 1.550384759902954
Epoch: 3, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.067 Vali Acc: 0.722 Test Loss: 1.067 Test Acc: 0.722
Validation loss decreased (-0.633319 --> -0.722212).  Saving model ...
Epoch: 4 cost time: 1.5719995498657227
Epoch: 4, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.690 Vali Acc: 0.711 Test Loss: 0.690 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.563159704208374
Epoch: 5, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 1.6793127059936523
Epoch: 6, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
Validation loss decreased (-0.755550 --> -0.844440).  Saving model ...
Epoch: 7 cost time: 1.7228050231933594
Epoch: 7, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 1.9251317977905273
Epoch: 8, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.386 Vali Acc: 0.828 Test Loss: 0.386 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7328660488128662
Epoch: 9, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.7088210582733154
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.293 Vali Acc: 0.833 Test Loss: 0.293 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.422597885131836
Epoch: 11, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.7737040519714355
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.302 Vali Acc: 0.839 Test Loss: 0.302 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5798020362854004
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.400 Vali Acc: 0.844 Test Loss: 0.400 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.550992488861084
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.256 Vali Acc: 0.844 Test Loss: 0.256 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3906471729278564
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 1.544297456741333
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.476412057876587
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.5792100429534912
Epoch: 18, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5768513679504395
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.420210599899292
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.412074327468872
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3789846897125244
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.519 Vali Acc: 0.911 Test Loss: 0.519 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3292350769042969
Epoch: 23, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.430485486984253
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.714238166809082
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4314181804656982
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.67745041847229
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 43717638
model size : 181.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.429527759552002
Epoch: 1, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.658 Vali Acc: 0.339 Test Loss: 1.658 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 2.6778781414031982
Epoch: 2, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.164 Vali Acc: 0.667 Test Loss: 1.164 Test Acc: 0.667
Validation loss decreased (-0.338872 --> -0.666655).  Saving model ...
Epoch: 3 cost time: 2.4778225421905518
Epoch: 3, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.672 Vali Acc: 0.683 Test Loss: 0.672 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683327).  Saving model ...
Epoch: 4 cost time: 2.6190972328186035
Epoch: 4, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.444 Vali Acc: 0.756 Test Loss: 0.444 Test Acc: 0.756
Validation loss decreased (-0.683327 --> -0.755551).  Saving model ...
Epoch: 5 cost time: 2.42972993850708
Epoch: 5, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
Validation loss decreased (-0.755551 --> -0.838886).  Saving model ...
Epoch: 6 cost time: 2.410644769668579
Epoch: 6, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7362048625946045
Epoch: 7, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
Validation loss decreased (-0.838886 --> -0.866664).  Saving model ...
Epoch: 8 cost time: 2.2476859092712402
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.417 Vali Acc: 0.811 Test Loss: 0.417 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.240295648574829
Epoch: 9, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.366 Vali Acc: 0.872 Test Loss: 0.366 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 2.3542473316192627
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.488760232925415
Epoch: 11, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 12 cost time: 2.4073398113250732
Epoch: 12, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2158472537994385
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8476579189300537
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.416 Vali Acc: 0.872 Test Loss: 0.416 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6028127670288086
Epoch: 15, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4486873149871826
Epoch: 16, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8423171043395996
Epoch: 17, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6099867820739746
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.429 Vali Acc: 0.878 Test Loss: 0.429 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5075058937072754
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.593 Vali Acc: 0.906 Test Loss: 0.593 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905550).  Saving model ...
Epoch: 20 cost time: 2.6029245853424072
Epoch: 20, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.905550 --> -0.922220).  Saving model ...
Epoch: 21 cost time: 2.7685155868530273
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.555 Vali Acc: 0.894 Test Loss: 0.555 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.545586585998535
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5406763553619385
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.767483711242676
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.438243865966797
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.454 Vali Acc: 0.906 Test Loss: 0.454 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.423177719116211
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2831950187683105
Epoch: 27, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.233633279800415
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.913 Vali Acc: 0.883 Test Loss: 0.913 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1402499675750732
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.561 Vali Acc: 0.906 Test Loss: 0.561 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.2077157497406006
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.889 Test Loss: 0.620 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 43852806
model size : 181.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.846320867538452
Epoch: 1, Steps: 12 | Train Loss: 1.936 Vali Loss: 1.685 Vali Acc: 0.317 Test Loss: 1.685 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 2.2194292545318604
Epoch: 2, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.311 Vali Acc: 0.550 Test Loss: 1.311 Test Acc: 0.550
Validation loss decreased (-0.316650 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 2.2312822341918945
Epoch: 3, Steps: 12 | Train Loss: 1.127 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
Validation loss decreased (-0.549987 --> -0.744436).  Saving model ...
Epoch: 4 cost time: 2.1612672805786133
Epoch: 4, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.514 Vali Acc: 0.767 Test Loss: 0.514 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 2.205812454223633
Epoch: 5, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.440 Vali Acc: 0.789 Test Loss: 0.440 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 2.150986671447754
Epoch: 6, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.788884 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 2.2487330436706543
Epoch: 7, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.249148368835449
Epoch: 8, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.091198682785034
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.317964553833008
Epoch: 10, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.389 Vali Acc: 0.856 Test Loss: 0.389 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4697623252868652
Epoch: 11, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 2.088737726211548
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.250 Vali Acc: 0.878 Test Loss: 0.250 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.9189152717590332
Epoch: 13, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 2.3482344150543213
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.069535732269287
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4144089221954346
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 2.6615891456604004
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3340985774993896
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1578545570373535
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 2.5719070434570312
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6585159301757812
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.166529417037964
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.531 Vali Acc: 0.917 Test Loss: 0.531 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.545214891433716
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.6528966426849365
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4671883583068848
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.433171272277832
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.392861843109131
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.634300708770752
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3857674598693848
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 43809798
model size : 181.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.045118808746338
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.736 Vali Acc: 0.272 Test Loss: 1.736 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 1.3769810199737549
Epoch: 2, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.505 Vali Acc: 0.467 Test Loss: 1.505 Test Acc: 0.467
Validation loss decreased (-0.272205 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 1.4318480491638184
Epoch: 3, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.119 Vali Acc: 0.672 Test Loss: 1.119 Test Acc: 0.672
Validation loss decreased (-0.466652 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.3232951164245605
Epoch: 4, Steps: 12 | Train Loss: 0.967 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
Validation loss decreased (-0.672211 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 1.400040864944458
Epoch: 5, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.497 Vali Acc: 0.772 Test Loss: 0.497 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 1.4991323947906494
Epoch: 6, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.397 Vali Acc: 0.822 Test Loss: 0.397 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.339132308959961
Epoch: 7, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.395 Vali Acc: 0.789 Test Loss: 0.395 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4317450523376465
Epoch: 8, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 1.3292582035064697
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.295 Vali Acc: 0.833 Test Loss: 0.295 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3353862762451172
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 11 cost time: 1.2299275398254395
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.226487159729004
Epoch: 12, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.265132188796997
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.268 Vali Acc: 0.844 Test Loss: 0.268 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2670743465423584
Epoch: 14, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.2822225093841553
Epoch: 15, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.243 Vali Acc: 0.867 Test Loss: 0.243 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2441821098327637
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2737360000610352
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2023391723632812
Epoch: 18, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.334 Vali Acc: 0.883 Test Loss: 0.334 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.265153408050537
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.334 Vali Acc: 0.883 Test Loss: 0.334 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.275386095046997
Epoch: 20, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.410 Vali Acc: 0.867 Test Loss: 0.410 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1536719799041748
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.1575500965118408
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.500 Vali Acc: 0.894 Test Loss: 0.500 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894439).  Saving model ...
Epoch: 23 cost time: 1.158599615097046
Epoch: 23, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2186150550842285
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.894439 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.159097671508789
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2098464965820312
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2412164211273193
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.407 Vali Acc: 0.872 Test Loss: 0.407 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2208797931671143
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 29 cost time: 1.0957722663879395
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.066779613494873
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6145150661468506
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3296754360198975
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.318326473236084
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5140063762664795
Epoch: 34, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.361 Vali Acc: 0.917 Test Loss: 0.361 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2621982097625732
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3664054870605469
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3677959442138672
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 38 cost time: 1.0783560276031494
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.922219 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.116905927658081
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1194603443145752
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.319 Vali Acc: 0.922 Test Loss: 0.319 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0213978290557861
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2231776714324951
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1057543754577637
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9828615188598633
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.939 Test Loss: 0.219 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9982187747955322
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.079237699508667
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2488946914672852
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.386 Vali Acc: 0.906 Test Loss: 0.386 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9870920181274414
Epoch: 48, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 43760646
model size : 181.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.149596691131592
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.639 Vali Acc: 0.361 Test Loss: 1.639 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 2.1676464080810547
Epoch: 2, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.208 Vali Acc: 0.628 Test Loss: 1.208 Test Acc: 0.628
Validation loss decreased (-0.361095 --> -0.627766).  Saving model ...
Epoch: 3 cost time: 2.064324140548706
Epoch: 3, Steps: 12 | Train Loss: 0.992 Vali Loss: 0.769 Vali Acc: 0.633 Test Loss: 0.769 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633326).  Saving model ...
Epoch: 4 cost time: 2.5050201416015625
Epoch: 4, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (-0.633326 --> -0.722217).  Saving model ...
Epoch: 5 cost time: 2.721639633178711
Epoch: 5, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.449 Vali Acc: 0.783 Test Loss: 0.449 Test Acc: 0.783
Validation loss decreased (-0.722217 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 2.6599106788635254
Epoch: 6, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.392 Vali Acc: 0.811 Test Loss: 0.392 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 2.5599746704101562
Epoch: 7, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
Validation loss decreased (-0.811107 --> -0.872220).  Saving model ...
Epoch: 8 cost time: 2.2860207557678223
Epoch: 8, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.761155128479004
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.415701389312744
Epoch: 10, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.251068592071533
Epoch: 11, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.872220 --> -0.905553).  Saving model ...
Epoch: 12 cost time: 2.4234426021575928
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 13 cost time: 1.9777650833129883
Epoch: 13, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.402177095413208
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.256 Vali Acc: 0.867 Test Loss: 0.256 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0453875064849854
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.611851930618286
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.40860652923584
Epoch: 17, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2834832668304443
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7569580078125
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.086 Vali Acc: 0.833 Test Loss: 1.086 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2722926139831543
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4973948001861572
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4465556144714355
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.677 Vali Acc: 0.878 Test Loss: 0.677 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 43908102
model size : 182.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3109989166259766
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.704 Vali Acc: 0.328 Test Loss: 1.704 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.72843599319458
Epoch: 2, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.392 Vali Acc: 0.628 Test Loss: 1.392 Test Acc: 0.628
Validation loss decreased (-0.327761 --> -0.627764).  Saving model ...
Epoch: 3 cost time: 1.5177574157714844
Epoch: 3, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
Validation loss decreased (-0.627764 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.3637752532958984
Epoch: 4, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.668 Vali Acc: 0.700 Test Loss: 0.668 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699993).  Saving model ...
Epoch: 5 cost time: 1.2686398029327393
Epoch: 5, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.537 Vali Acc: 0.744 Test Loss: 0.537 Test Acc: 0.744
Validation loss decreased (-0.699993 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 1.3621277809143066
Epoch: 6, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.394 Vali Acc: 0.783 Test Loss: 0.394 Test Acc: 0.783
Validation loss decreased (-0.744439 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.2373602390289307
Epoch: 7, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.330 Vali Acc: 0.817 Test Loss: 0.330 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.2019720077514648
Epoch: 8, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.312 Vali Acc: 0.839 Test Loss: 0.312 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 1.3958070278167725
Epoch: 9, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.260 Vali Acc: 0.872 Test Loss: 0.260 Test Acc: 0.872
Validation loss decreased (-0.838886 --> -0.872220).  Saving model ...
Epoch: 10 cost time: 1.184851884841919
Epoch: 10, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9460034370422363
Epoch: 11, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.304 Vali Acc: 0.828 Test Loss: 0.304 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0772647857666016
Epoch: 12, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.279 Vali Acc: 0.844 Test Loss: 0.279 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0411453247070312
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.0620534420013428
Epoch: 14, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.247 Vali Acc: 0.878 Test Loss: 0.247 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2911972999572754
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3370039463043213
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5350990295410156
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 1.23199462890625
Epoch: 18, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.431344985961914
Epoch: 19, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1954219341278076
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4950637817382812
Epoch: 21, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 22 cost time: 1.498342514038086
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.306969165802002
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.168 Vali Acc: 0.928 Test Loss: 0.168 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927776).  Saving model ...
Epoch: 24 cost time: 1.359875202178955
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.139 Vali Acc: 0.939 Test Loss: 0.139 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938888).  Saving model ...
Epoch: 25 cost time: 1.415940284729004
Epoch: 25, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1554183959960938
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5430479049682617
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3744590282440186
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6472187042236328
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.378 Vali Acc: 0.911 Test Loss: 0.378 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2056589126586914
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.271967887878418
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3123185634613037
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.5497546195983887
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3058247566223145
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 43840518
model size : 181.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7378408908843994
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.708 Vali Acc: 0.333 Test Loss: 1.708 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 1.1384775638580322
Epoch: 2, Steps: 12 | Train Loss: 1.606 Vali Loss: 1.471 Vali Acc: 0.606 Test Loss: 1.471 Test Acc: 0.606
Validation loss decreased (-0.333316 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 1.2203757762908936
Epoch: 3, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.155 Vali Acc: 0.683 Test Loss: 1.155 Test Acc: 0.683
Validation loss decreased (-0.605541 --> -0.683322).  Saving model ...
Epoch: 4 cost time: 0.989344596862793
Epoch: 4, Steps: 12 | Train Loss: 1.062 Vali Loss: 0.817 Vali Acc: 0.722 Test Loss: 0.817 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722214).  Saving model ...
Epoch: 5 cost time: 1.1112582683563232
Epoch: 5, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.620 Vali Acc: 0.700 Test Loss: 0.620 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.148010492324829
Epoch: 6, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
Validation loss decreased (-0.722214 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 1.0964672565460205
Epoch: 7, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 1.0481154918670654
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.389 Vali Acc: 0.783 Test Loss: 0.389 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 0.939659595489502
Epoch: 9, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
Validation loss decreased (-0.783329 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 0.8167538642883301
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0724189281463623
Epoch: 11, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9844470024108887
Epoch: 12, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0057506561279297
Epoch: 13, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8882927894592285
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.0238773822784424
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.219 Vali Acc: 0.883 Test Loss: 0.219 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.976841926574707
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.218 Vali Acc: 0.894 Test Loss: 0.218 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.0364668369293213
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.9806952476501465
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0250990390777588
Epoch: 19, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.433 Vali Acc: 0.872 Test Loss: 0.433 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0276834964752197
Epoch: 20, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2130112648010254
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.194 Vali Acc: 0.906 Test Loss: 0.194 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.059107780456543
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1838645935058594
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9319641590118408
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0317625999450684
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.166 Vali Acc: 0.906 Test Loss: 0.166 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2572355270385742
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0813145637512207
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 43809798
model size : 181.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1794891357421875
Epoch: 1, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.548 Vali Acc: 0.556 Test Loss: 1.548 Test Acc: 0.556
Validation loss decreased (inf --> -0.555540).  Saving model ...
Epoch: 2 cost time: 2.186978578567505
Epoch: 2, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.046 Vali Acc: 0.694 Test Loss: 1.046 Test Acc: 0.694
Validation loss decreased (-0.555540 --> -0.694434).  Saving model ...
Epoch: 3 cost time: 2.124185085296631
Epoch: 3, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.694434 --> -0.783328).  Saving model ...
Epoch: 4 cost time: 1.9915504455566406
Epoch: 4, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.472 Vali Acc: 0.767 Test Loss: 0.472 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.005063533782959
Epoch: 5, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.780 Vali Acc: 0.794 Test Loss: 0.780 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794437).  Saving model ...
Epoch: 6 cost time: 1.9367365837097168
Epoch: 6, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.224226474761963
Epoch: 7, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.308 Vali Acc: 0.828 Test Loss: 0.308 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827775).  Saving model ...
Epoch: 8 cost time: 2.2859179973602295
Epoch: 8, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.295 Vali Acc: 0.822 Test Loss: 0.295 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8304448127746582
Epoch: 9, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
Validation loss decreased (-0.827775 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.9025704860687256
Epoch: 10, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888887).  Saving model ...
Epoch: 11 cost time: 1.6786413192749023
Epoch: 11, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2983176708221436
Epoch: 12, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.888887 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 2.2454683780670166
Epoch: 13, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4294602870941162
Epoch: 14, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 1.7981927394866943
Epoch: 15, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7285773754119873
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.855165719985962
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6688563823699951
Epoch: 18, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 19 cost time: 1.893629789352417
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.634 Vali Acc: 0.883 Test Loss: 0.634 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.279925584793091
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1992175579071045
Epoch: 21, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8456456661224365
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.352 Vali Acc: 0.911 Test Loss: 0.352 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0505926609039307
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2878191471099854
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.2769391536712646
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.366 Vali Acc: 0.933 Test Loss: 0.366 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8552908897399902
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.621 Vali Acc: 0.900 Test Loss: 0.621 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.89626145362854
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.642 Vali Acc: 0.933 Test Loss: 0.642 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.231691598892212
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9083137512207031
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.928 Test Loss: 0.459 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.00040864944458
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.500 Vali Acc: 0.911 Test Loss: 0.500 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.0813260078430176
Epoch: 31, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9067130088806152
Epoch: 32, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.545 Vali Acc: 0.917 Test Loss: 0.545 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.7325940132141113
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.752 Vali Acc: 0.894 Test Loss: 0.752 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6489121913909912
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.499 Vali Acc: 0.917 Test Loss: 0.499 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 43957254
model size : 182.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.055248975753784
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.700 Vali Acc: 0.294 Test Loss: 1.700 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 1.2128322124481201
Epoch: 2, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.366 Vali Acc: 0.561 Test Loss: 1.366 Test Acc: 0.561
Validation loss decreased (-0.294427 --> -0.561097).  Saving model ...
Epoch: 3 cost time: 1.2297940254211426
Epoch: 3, Steps: 12 | Train Loss: 1.231 Vali Loss: 0.953 Vali Acc: 0.656 Test Loss: 0.953 Test Acc: 0.656
Validation loss decreased (-0.561097 --> -0.655546).  Saving model ...
Epoch: 4 cost time: 1.6169612407684326
Epoch: 4, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
Validation loss decreased (-0.655546 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.466897964477539
Epoch: 5, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.415 Vali Acc: 0.806 Test Loss: 0.415 Test Acc: 0.806
Validation loss decreased (-0.761105 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 1.470529556274414
Epoch: 6, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.433 Vali Acc: 0.794 Test Loss: 0.433 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.141831636428833
Epoch: 7, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.4325449466705322
Epoch: 8, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.423 Vali Acc: 0.822 Test Loss: 0.423 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2950351238250732
Epoch: 9, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2654621601104736
Epoch: 10, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3704135417938232
Epoch: 11, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 1.265707015991211
Epoch: 12, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4210169315338135
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.578268051147461
Epoch: 14, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 1.4491026401519775
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3694376945495605
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 1.4241790771484375
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3451406955718994
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.157 Vali Acc: 0.922 Test Loss: 0.157 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922221).  Saving model ...
Epoch: 19 cost time: 1.3970561027526855
Epoch: 19, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.933 Test Loss: 0.157 Test Acc: 0.933
Validation loss decreased (-0.922221 --> -0.933332).  Saving model ...
Epoch: 20 cost time: 1.386948823928833
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.105921745300293
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5219862461090088
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3266315460205078
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.237694263458252
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3723862171173096
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.367 Vali Acc: 0.911 Test Loss: 0.367 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.601743221282959
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4688506126403809
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5339076519012451
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4279577732086182
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938886).  Saving model ...
Epoch: 30 cost time: 1.554224967956543
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4519577026367188
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.928 Test Loss: 0.146 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5675303936004639
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.427661418914795
Epoch: 33, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2970051765441895
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.235 Vali Acc: 0.939 Test Loss: 0.235 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 1.5176432132720947
Epoch: 35, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5528745651245117
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.43558669090271
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 38 cost time: 1.4703316688537598
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.928 Test Loss: 0.325 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4169821739196777
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5644745826721191
Epoch: 40, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.740 Vali Acc: 0.889 Test Loss: 0.740 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3659894466400146
Epoch: 41, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 42 cost time: 1.4575159549713135
Epoch: 42, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4812307357788086
Epoch: 43, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.540 Vali Acc: 0.906 Test Loss: 0.540 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5617280006408691
Epoch: 44, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5280208587646484
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.563 Vali Acc: 0.922 Test Loss: 0.563 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5732982158660889
Epoch: 46, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.491 Vali Acc: 0.917 Test Loss: 0.491 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4203431606292725
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.418 Vali Acc: 0.917 Test Loss: 0.418 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.613349437713623
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3304948806762695
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3338186740875244
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.939 Test Loss: 0.368 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 43889670
model size : 182.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7933640480041504
Epoch: 1, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.656 Vali Acc: 0.428 Test Loss: 1.656 Test Acc: 0.428
Validation loss decreased (inf --> -0.427761).  Saving model ...
Epoch: 2 cost time: 1.0702056884765625
Epoch: 2, Steps: 12 | Train Loss: 1.544 Vali Loss: 1.369 Vali Acc: 0.606 Test Loss: 1.369 Test Acc: 0.606
Validation loss decreased (-0.427761 --> -0.605542).  Saving model ...
Epoch: 3 cost time: 1.0749061107635498
Epoch: 3, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.040 Vali Acc: 0.689 Test Loss: 1.040 Test Acc: 0.689
Validation loss decreased (-0.605542 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 1.0614631175994873
Epoch: 4, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
Validation loss decreased (-0.688878 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.2256598472595215
Epoch: 5, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.526 Vali Acc: 0.744 Test Loss: 0.526 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 1.1721603870391846
Epoch: 6, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.447 Vali Acc: 0.778 Test Loss: 0.447 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 1.1506595611572266
Epoch: 7, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.389 Vali Acc: 0.822 Test Loss: 0.389 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.3107457160949707
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.1681032180786133
Epoch: 9, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.2238397598266602
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 1.3345239162445068
Epoch: 11, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.383 Vali Acc: 0.839 Test Loss: 0.383 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.257873773574829
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.365 Vali Acc: 0.856 Test Loss: 0.365 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3435859680175781
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0835387706756592
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
Validation loss decreased (-0.866664 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 1.0368599891662598
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.241076946258545
Epoch: 16, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.269 Vali Acc: 0.861 Test Loss: 0.269 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0060131549835205
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.280 Vali Acc: 0.850 Test Loss: 0.280 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2323009967803955
Epoch: 18, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1904957294464111
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.192 Vali Acc: 0.911 Test Loss: 0.192 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 1.1956069469451904
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.183370590209961
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0609090328216553
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0649302005767822
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0533993244171143
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0029635429382324
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.480 Vali Acc: 0.883 Test Loss: 0.480 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1123652458190918
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9657959938049316
Epoch: 27, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1406257152557373
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.016648292541504
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 43858950
model size : 181.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2390224933624268
Epoch: 1, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.650 Vali Acc: 0.411 Test Loss: 1.650 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 1.329268217086792
Epoch: 2, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.243 Vali Acc: 0.611 Test Loss: 1.243 Test Acc: 0.611
Validation loss decreased (-0.411095 --> -0.611099).  Saving model ...
Epoch: 3 cost time: 1.4672832489013672
Epoch: 3, Steps: 12 | Train Loss: 1.115 Vali Loss: 0.789 Vali Acc: 0.767 Test Loss: 0.789 Test Acc: 0.767
Validation loss decreased (-0.611099 --> -0.766659).  Saving model ...
Epoch: 4 cost time: 1.0205316543579102
Epoch: 4, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.477 Vali Acc: 0.817 Test Loss: 0.477 Test Acc: 0.817
Validation loss decreased (-0.766659 --> -0.816662).  Saving model ...
Epoch: 5 cost time: 1.5192053318023682
Epoch: 5, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3379664421081543
Epoch: 6, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.402 Vali Acc: 0.800 Test Loss: 0.402 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5024566650390625
Epoch: 7, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 1.2881646156311035
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.256 Vali Acc: 0.867 Test Loss: 0.256 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 1.3609836101531982
Epoch: 9, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.279327154159546
Epoch: 10, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.1750967502593994
Epoch: 11, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911109).  Saving model ...
Epoch: 12 cost time: 1.2802026271820068
Epoch: 12, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.359527349472046
Epoch: 13, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.437 Vali Acc: 0.883 Test Loss: 0.437 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.368886947631836
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 1.3745837211608887
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.571 Vali Acc: 0.894 Test Loss: 0.571 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1282572746276855
Epoch: 16, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2918062210083008
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2797889709472656
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.811 Vali Acc: 0.833 Test Loss: 0.811 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4549808502197266
Epoch: 19, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.531 Vali Acc: 0.911 Test Loss: 0.531 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1057417392730713
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.295 Vali Acc: 0.939 Test Loss: 0.295 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938886).  Saving model ...
Epoch: 21 cost time: 1.3537101745605469
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.390 Vali Acc: 0.894 Test Loss: 0.390 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5075855255126953
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1452245712280273
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.375056505203247
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5772042274475098
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3810343742370605
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5538768768310547
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4684648513793945
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.639 Vali Acc: 0.861 Test Loss: 0.639 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4967987537384033
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2915596961975098
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 43969542
model size : 182.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8670074939727783
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.708 Vali Acc: 0.239 Test Loss: 1.708 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 1.1857261657714844
Epoch: 2, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.383 Vali Acc: 0.600 Test Loss: 1.383 Test Acc: 0.600
Validation loss decreased (-0.238872 --> -0.599986).  Saving model ...
Epoch: 3 cost time: 0.966742753982544
Epoch: 3, Steps: 12 | Train Loss: 1.178 Vali Loss: 0.925 Vali Acc: 0.689 Test Loss: 0.925 Test Acc: 0.689
Validation loss decreased (-0.599986 --> -0.688880).  Saving model ...
Epoch: 4 cost time: 1.0700302124023438
Epoch: 4, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.553 Vali Acc: 0.778 Test Loss: 0.553 Test Acc: 0.778
Validation loss decreased (-0.688880 --> -0.777772).  Saving model ...
Epoch: 5 cost time: 1.0483131408691406
Epoch: 5, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.1840474605560303
Epoch: 6, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.373 Vali Acc: 0.800 Test Loss: 0.373 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.2207648754119873
Epoch: 7, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827773).  Saving model ...
Epoch: 8 cost time: 1.0085408687591553
Epoch: 8, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
Validation loss decreased (-0.827773 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 1.111917495727539
Epoch: 9, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2479240894317627
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.357 Vali Acc: 0.856 Test Loss: 0.357 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0826811790466309
Epoch: 11, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2354309558868408
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
Validation loss decreased (-0.866664 --> -0.899998).  Saving model ...
Epoch: 13 cost time: 1.0313994884490967
Epoch: 13, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.333812952041626
Epoch: 14, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1315803527832031
Epoch: 15, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.229 Vali Acc: 0.883 Test Loss: 0.229 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1406745910644531
Epoch: 16, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
Validation loss decreased (-0.899998 --> -0.933332).  Saving model ...
Epoch: 17 cost time: 1.2816400527954102
Epoch: 17, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0757207870483398
Epoch: 18, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0922760963439941
Epoch: 19, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.410 Vali Acc: 0.856 Test Loss: 0.410 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2181761264801025
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8964240550994873
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3005213737487793
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.177954912185669
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.069828987121582
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1841981410980225
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9991312026977539
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 43932678
model size : 182.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.734356641769409
Epoch: 1, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.731 Vali Acc: 0.256 Test Loss: 1.731 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.9039435386657715
Epoch: 2, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.493 Vali Acc: 0.594 Test Loss: 1.493 Test Acc: 0.594
Validation loss decreased (-0.255538 --> -0.594430).  Saving model ...
Epoch: 3 cost time: 1.0236873626708984
Epoch: 3, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.161 Vali Acc: 0.694 Test Loss: 1.161 Test Acc: 0.694
Validation loss decreased (-0.594430 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 1.076827049255371
Epoch: 4, Steps: 12 | Train Loss: 1.053 Vali Loss: 0.793 Vali Acc: 0.711 Test Loss: 0.793 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 1.1035346984863281
Epoch: 5, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.555 Vali Acc: 0.756 Test Loss: 0.555 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 1.1348118782043457
Epoch: 6, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.460 Vali Acc: 0.789 Test Loss: 0.460 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.0831108093261719
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.423 Vali Acc: 0.783 Test Loss: 0.423 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6995949745178223
Epoch: 8, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 0.9869003295898438
Epoch: 9, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.0772645473480225
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.007155179977417
Epoch: 11, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1272437572479248
Epoch: 12, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 0.972541332244873
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.411 Vali Acc: 0.828 Test Loss: 0.411 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9728116989135742
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.128143310546875
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.049865484237671
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 1.0815832614898682
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0073976516723633
Epoch: 18, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.257 Vali Acc: 0.878 Test Loss: 0.257 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0549962520599365
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.211 Vali Acc: 0.889 Test Loss: 0.211 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1390538215637207
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.0640788078308105
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2123241424560547
Epoch: 22, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.171 Vali Acc: 0.900 Test Loss: 0.171 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0471248626708984
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.180 Vali Acc: 0.911 Test Loss: 0.180 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 1.2165379524230957
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1562464237213135
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9581942558288574
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.423 Vali Acc: 0.872 Test Loss: 0.423 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1986579895019531
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0622014999389648
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.164 Vali Acc: 0.911 Test Loss: 0.164 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 1.070174217224121
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2041385173797607
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 1.073397159576416
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.176 Vali Acc: 0.906 Test Loss: 0.176 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1627447605133057
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.199 Vali Acc: 0.906 Test Loss: 0.199 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0714561939239502
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.309 Vali Acc: 0.928 Test Loss: 0.309 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.000978708267212
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.203829050064087
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 36 cost time: 1.1835675239562988
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1617233753204346
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.0112943649291992
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2382962703704834
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.175232172012329
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.900 Test Loss: 0.205 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1728572845458984
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0126190185546875
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0288679599761963
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.293 Vali Acc: 0.939 Test Loss: 0.293 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1397428512573242
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0301172733306885
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.2375543117523193
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.225996494293213
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 43908102
model size : 182.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.985379934310913
Epoch: 1, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.585 Vali Acc: 0.539 Test Loss: 1.585 Test Acc: 0.539
Validation loss decreased (inf --> -0.538873).  Saving model ...
Epoch: 2 cost time: 1.5037496089935303
Epoch: 2, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.162 Vali Acc: 0.672 Test Loss: 1.162 Test Acc: 0.672
Validation loss decreased (-0.538873 --> -0.672211).  Saving model ...
Epoch: 3 cost time: 1.2524688243865967
Epoch: 3, Steps: 12 | Train Loss: 0.997 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
Validation loss decreased (-0.672211 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.2337403297424316
Epoch: 4, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.456 Vali Acc: 0.783 Test Loss: 0.456 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.3602445125579834
Epoch: 5, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.353 Vali Acc: 0.817 Test Loss: 0.353 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.3691914081573486
Epoch: 6, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
Validation loss decreased (-0.816663 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 1.4161531925201416
Epoch: 7, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 8 cost time: 1.0756745338439941
Epoch: 8, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3269619941711426
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2903988361358643
Epoch: 10, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1613163948059082
Epoch: 11, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.011399745941162
Epoch: 12, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.1970767974853516
Epoch: 13, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.332 Vali Acc: 0.894 Test Loss: 0.332 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 1.3442633152008057
Epoch: 14, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 1.3506474494934082
Epoch: 15, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5309460163116455
Epoch: 16, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.342 Vali Acc: 0.894 Test Loss: 0.342 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3350293636322021
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 1.3787930011749268
Epoch: 18, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 19 cost time: 1.6150972843170166
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.393 Vali Acc: 0.894 Test Loss: 0.393 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3302443027496338
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3934566974639893
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4038276672363281
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.103322982788086
Epoch: 23, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.413 Vali Acc: 0.906 Test Loss: 0.413 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5433626174926758
Epoch: 24, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.402 Vali Acc: 0.839 Test Loss: 1.402 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4024782180786133
Epoch: 25, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3208987712860107
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5180013179779053
Epoch: 27, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.839 Vali Acc: 0.861 Test Loss: 0.839 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3753724098205566
Epoch: 28, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 44073990
model size : 182.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7198266983032227
Epoch: 1, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.558 Vali Acc: 0.511 Test Loss: 1.558 Test Acc: 0.511
Validation loss decreased (inf --> -0.511096).  Saving model ...
Epoch: 2 cost time: 1.145437240600586
Epoch: 2, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.218 Vali Acc: 0.639 Test Loss: 1.218 Test Acc: 0.639
Validation loss decreased (-0.511096 --> -0.638877).  Saving model ...
Epoch: 3 cost time: 0.9081144332885742
Epoch: 3, Steps: 12 | Train Loss: 1.098 Vali Loss: 0.851 Vali Acc: 0.778 Test Loss: 0.851 Test Acc: 0.778
Validation loss decreased (-0.638877 --> -0.777769).  Saving model ...
Epoch: 4 cost time: 1.2090864181518555
Epoch: 4, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 1.28652024269104
Epoch: 5, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.467 Vali Acc: 0.761 Test Loss: 0.467 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9783709049224854
Epoch: 6, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.387 Vali Acc: 0.811 Test Loss: 0.387 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.028022050857544
Epoch: 7, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.353 Vali Acc: 0.800 Test Loss: 0.353 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1597273349761963
Epoch: 8, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 0.9672126770019531
Epoch: 9, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.384 Vali Acc: 0.828 Test Loss: 0.384 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0947115421295166
Epoch: 10, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1624031066894531
Epoch: 11, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.454 Vali Acc: 0.828 Test Loss: 0.454 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1814038753509521
Epoch: 12, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.838885 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.174565076828003
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.244 Vali Acc: 0.878 Test Loss: 0.244 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 1.0567612648010254
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.2020909786224365
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0277581214904785
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2180914878845215
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.385 Vali Acc: 0.878 Test Loss: 0.385 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9767508506774902
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0438315868377686
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 1.0384225845336914
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.1028950214385986
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9692156314849854
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.672 Vali Acc: 0.861 Test Loss: 0.672 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2062797546386719
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.109358549118042
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2443325519561768
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.159850835800171
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0291533470153809
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 28 cost time: 1.0696232318878174
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 1.0307471752166748
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.425 Vali Acc: 0.894 Test Loss: 0.425 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.004399299621582
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.328 Vali Acc: 0.939 Test Loss: 0.328 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9893529415130615
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9216043949127197
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.335 Vali Acc: 0.911 Test Loss: 0.335 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0373947620391846
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.499 Vali Acc: 0.894 Test Loss: 0.499 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0396370887756348
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1196188926696777
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.173 Vali Acc: 0.928 Test Loss: 0.173 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.258291482925415
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0644752979278564
Epoch: 37, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.03916335105896
Epoch: 38, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 44030982
model size : 182.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8314881324768066
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.648 Vali Acc: 0.339 Test Loss: 1.648 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 0.9942882061004639
Epoch: 2, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.367 Vali Acc: 0.622 Test Loss: 1.367 Test Acc: 0.622
Validation loss decreased (-0.338872 --> -0.622209).  Saving model ...
Epoch: 3 cost time: 1.0444965362548828
Epoch: 3, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.050 Vali Acc: 0.717 Test Loss: 1.050 Test Acc: 0.717
Validation loss decreased (-0.622209 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 1.0391497611999512
Epoch: 4, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.767 Vali Acc: 0.722 Test Loss: 0.767 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 1.094867467880249
Epoch: 5, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.599 Vali Acc: 0.728 Test Loss: 0.599 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 1.097269058227539
Epoch: 6, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.508 Vali Acc: 0.767 Test Loss: 0.508 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 1.0045716762542725
Epoch: 7, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.461 Vali Acc: 0.756 Test Loss: 0.461 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8898899555206299
Epoch: 8, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.408 Vali Acc: 0.794 Test Loss: 0.408 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 0.9562804698944092
Epoch: 9, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.378 Vali Acc: 0.794 Test Loss: 0.378 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794441).  Saving model ...
Epoch: 10 cost time: 1.123396873474121
Epoch: 10, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.362 Vali Acc: 0.800 Test Loss: 0.362 Test Acc: 0.800
Validation loss decreased (-0.794441 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 1.1678388118743896
Epoch: 11, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
Validation loss decreased (-0.799996 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 1.0548076629638672
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2091290950775146
Epoch: 13, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0986881256103516
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0431010723114014
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.104212760925293
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 1.2311410903930664
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 1.1099786758422852
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.258 Vali Acc: 0.867 Test Loss: 0.258 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2170004844665527
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8595983982086182
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 0.8913426399230957
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 0.8509843349456787
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.202 Vali Acc: 0.894 Test Loss: 0.202 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1131820678710938
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.384 Vali Acc: 0.883 Test Loss: 0.384 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0577456951141357
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1768319606781006
Epoch: 25, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0720796585083008
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1820862293243408
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2339158058166504
Epoch: 28, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1067793369293213
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2099480628967285
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2006428241729736
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 44012550
model size : 182.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.87626051902771
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.552 Vali Acc: 0.433 Test Loss: 1.552 Test Acc: 0.433
Validation loss decreased (inf --> -0.433318).  Saving model ...
Epoch: 2 cost time: 2.0846261978149414
Epoch: 2, Steps: 12 | Train Loss: 1.305 Vali Loss: 0.955 Vali Acc: 0.728 Test Loss: 0.955 Test Acc: 0.728
Validation loss decreased (-0.433318 --> -0.727768).  Saving model ...
Epoch: 3 cost time: 2.56046199798584
Epoch: 3, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.688 Vali Acc: 0.728 Test Loss: 0.688 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 2.6422500610351562
Epoch: 4, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.462 Vali Acc: 0.794 Test Loss: 0.462 Test Acc: 0.794
Validation loss decreased (-0.727771 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 1.9778454303741455
Epoch: 5, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.557 Vali Acc: 0.772 Test Loss: 0.557 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.620055675506592
Epoch: 6, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.466 Vali Acc: 0.783 Test Loss: 0.466 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.832488775253296
Epoch: 7, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.410 Vali Acc: 0.806 Test Loss: 0.410 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.2678263187408447
Epoch: 8, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
Validation loss decreased (-0.805551 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 2.6920199394226074
Epoch: 9, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.363 Vali Acc: 0.839 Test Loss: 0.363 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3432488441467285
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.731441020965576
Epoch: 11, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.255 Vali Acc: 0.867 Test Loss: 0.255 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 2.273745059967041
Epoch: 12, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.163 Vali Acc: 0.917 Test Loss: 0.163 Test Acc: 0.917
Validation loss decreased (-0.866664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 2.4615797996520996
Epoch: 13, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 14 cost time: 2.871525764465332
Epoch: 14, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.670 Vali Acc: 0.861 Test Loss: 0.670 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.574709415435791
Epoch: 15, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3362154960632324
Epoch: 16, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6708734035491943
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6965672969818115
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.333131790161133
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.358565092086792
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.7650928497314453
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 22 cost time: 2.4475669860839844
Epoch: 22, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.927775 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 2.36397123336792
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.561 Vali Acc: 0.928 Test Loss: 0.561 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8740010261535645
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.7210943698883057
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.911 Test Loss: 0.581 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4748525619506836
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.917 Test Loss: 0.587 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.6098575592041016
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 2.521418571472168
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5652120113372803
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.510 Vali Acc: 0.906 Test Loss: 0.510 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3044207096099854
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3674886226654053
Epoch: 31, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.360 Vali Acc: 0.878 Test Loss: 1.360 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.4300942420959473
Epoch: 32, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.6019930839538574
Epoch: 33, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.167 Vali Acc: 0.889 Test Loss: 1.167 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.1336007118225098
Epoch: 34, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.3105883598327637
Epoch: 35, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.6175858974456787
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.118583917617798
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 36758790
model size : 154.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5750489234924316
Epoch: 1, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.620 Vali Acc: 0.439 Test Loss: 1.620 Test Acc: 0.439
Validation loss decreased (inf --> -0.438873).  Saving model ...
Epoch: 2 cost time: 1.9075565338134766
Epoch: 2, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.185 Vali Acc: 0.706 Test Loss: 1.185 Test Acc: 0.706
Validation loss decreased (-0.438873 --> -0.705544).  Saving model ...
Epoch: 3 cost time: 1.9042131900787354
Epoch: 3, Steps: 12 | Train Loss: 1.012 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
Validation loss decreased (-0.705544 --> -0.777770).  Saving model ...
Epoch: 4 cost time: 1.9850234985351562
Epoch: 4, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.550 Vali Acc: 0.733 Test Loss: 0.550 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8277812004089355
Epoch: 5, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.418 Vali Acc: 0.772 Test Loss: 0.418 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8860726356506348
Epoch: 6, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.528 Vali Acc: 0.778 Test Loss: 0.528 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777772).  Saving model ...
Epoch: 7 cost time: 2.1262056827545166
Epoch: 7, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
Validation loss decreased (-0.777772 --> -0.866664).  Saving model ...
Epoch: 8 cost time: 1.6876695156097412
Epoch: 8, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.310 Vali Acc: 0.828 Test Loss: 0.310 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1061856746673584
Epoch: 9, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.609 Vali Acc: 0.817 Test Loss: 0.609 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8833277225494385
Epoch: 10, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6973381042480469
Epoch: 11, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3418738842010498
Epoch: 12, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.221 Vali Acc: 0.878 Test Loss: 0.221 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877776).  Saving model ...
Epoch: 13 cost time: 1.8172483444213867
Epoch: 13, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
Validation loss decreased (-0.877776 --> -0.888887).  Saving model ...
Epoch: 14 cost time: 1.9593899250030518
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.888887 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 1.9396140575408936
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.197960138320923
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9093635082244873
Epoch: 17, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0968780517578125
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.291567802429199
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9789154529571533
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.132 Vali Acc: 0.928 Test Loss: 0.132 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 2.3678395748138428
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.576 Vali Acc: 0.911 Test Loss: 0.576 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0262653827667236
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0188357830047607
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0778884887695312
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.373 Vali Acc: 0.928 Test Loss: 0.373 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.045375347137451
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.198 Vali Acc: 0.867 Test Loss: 1.198 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.186258554458618
Epoch: 26, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.630 Vali Acc: 0.906 Test Loss: 0.630 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.13751220703125
Epoch: 27, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.927 Vali Acc: 0.861 Test Loss: 0.927 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6877171993255615
Epoch: 28, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.769 Vali Acc: 0.894 Test Loss: 0.769 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8264617919921875
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.915055274963379
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 36611334
model size : 154.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.813270330429077
Epoch: 1, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.664 Vali Acc: 0.406 Test Loss: 1.664 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 1.575059413909912
Epoch: 2, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.333 Vali Acc: 0.672 Test Loss: 1.333 Test Acc: 0.672
Validation loss decreased (-0.405539 --> -0.672209).  Saving model ...
Epoch: 3 cost time: 1.515836477279663
Epoch: 3, Steps: 12 | Train Loss: 1.168 Vali Loss: 0.923 Vali Acc: 0.711 Test Loss: 0.923 Test Acc: 0.711
Validation loss decreased (-0.672209 --> -0.711102).  Saving model ...
Epoch: 4 cost time: 1.8074045181274414
Epoch: 4, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.630 Vali Acc: 0.700 Test Loss: 0.630 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.777869462966919
Epoch: 5, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.506 Vali Acc: 0.767 Test Loss: 0.506 Test Acc: 0.767
Validation loss decreased (-0.711102 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 1.80271577835083
Epoch: 6, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.470 Vali Acc: 0.806 Test Loss: 0.470 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 1.740328073501587
Epoch: 7, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.367 Vali Acc: 0.800 Test Loss: 0.367 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6947014331817627
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.6669766902923584
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 1.6963603496551514
Epoch: 10, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6383728981018066
Epoch: 11, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.409 Vali Acc: 0.839 Test Loss: 0.409 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6329705715179443
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6740024089813232
Epoch: 13, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 1.5013513565063477
Epoch: 14, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.191 Vali Acc: 0.906 Test Loss: 0.191 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 15 cost time: 1.7098581790924072
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9747939109802246
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4995927810668945
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
Validation loss decreased (-0.905554 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 2.0164475440979004
Epoch: 18, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.520226001739502
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0364742279052734
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.606309413909912
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1990931034088135
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5024440288543701
Epoch: 23, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 2.2230160236358643
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8198225498199463
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 1.8396353721618652
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.682464361190796
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9414012432098389
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8200247287750244
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.508 Vali Acc: 0.922 Test Loss: 0.508 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.323324680328369
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7232563495635986
Epoch: 31, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.230506420135498
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.412 Vali Acc: 0.911 Test Loss: 0.412 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0066144466400146
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9134485721588135
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.401 Vali Acc: 0.911 Test Loss: 0.401 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7986528873443604
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 36562182
model size : 154.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.875936985015869
Epoch: 1, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.454 Vali Acc: 0.522 Test Loss: 1.454 Test Acc: 0.522
Validation loss decreased (inf --> -0.522208).  Saving model ...
Epoch: 2 cost time: 2.2626795768737793
Epoch: 2, Steps: 12 | Train Loss: 1.239 Vali Loss: 0.924 Vali Acc: 0.706 Test Loss: 0.924 Test Acc: 0.706
Validation loss decreased (-0.522208 --> -0.705546).  Saving model ...
Epoch: 3 cost time: 2.2628238201141357
Epoch: 3, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.670 Vali Acc: 0.672 Test Loss: 0.670 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.243708848953247
Epoch: 4, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.538 Vali Acc: 0.722 Test Loss: 0.538 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722217).  Saving model ...
Epoch: 5 cost time: 2.263828992843628
Epoch: 5, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.374 Vali Acc: 0.806 Test Loss: 0.374 Test Acc: 0.806
Validation loss decreased (-0.722217 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 2.31315541267395
Epoch: 6, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.2832798957824707
Epoch: 7, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 2.319497585296631
Epoch: 8, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.502 Vali Acc: 0.794 Test Loss: 0.502 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8549940586090088
Epoch: 9, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.175513744354248
Epoch: 10, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 1.7562556266784668
Epoch: 11, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1272993087768555
Epoch: 12, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894442).  Saving model ...
Epoch: 13 cost time: 1.96297025680542
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.152583122253418
Epoch: 14, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.815 Vali Acc: 0.861 Test Loss: 0.815 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.097951650619507
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.119654893875122
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.103870153427124
Epoch: 17, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.263770580291748
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.721 Vali Acc: 0.883 Test Loss: 0.721 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.286379337310791
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.756 Vali Acc: 0.906 Test Loss: 0.756 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7076103687286377
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.299 Vali Acc: 0.894 Test Loss: 1.299 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2186293601989746
Epoch: 21, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.989 Vali Acc: 0.889 Test Loss: 0.989 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7213683128356934
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.525 Vali Acc: 0.894 Test Loss: 0.525 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.284505605697632
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.634 Vali Acc: 0.922 Test Loss: 0.634 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922216).  Saving model ...
Epoch: 24 cost time: 2.0706472396850586
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.529 Vali Acc: 0.917 Test Loss: 0.529 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.698349952697754
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.813 Vali Acc: 0.889 Test Loss: 0.813 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.244840621948242
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.969 Vali Acc: 0.872 Test Loss: 0.969 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.435062885284424
Epoch: 27, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0688652992248535
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.743 Vali Acc: 0.900 Test Loss: 0.743 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.4813992977142334
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.715 Vali Acc: 0.894 Test Loss: 0.715 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.690922975540161
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.755 Vali Acc: 0.878 Test Loss: 0.755 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.262510061264038
Epoch: 31, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.800 Vali Acc: 0.839 Test Loss: 1.800 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.67348313331604
Epoch: 32, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.944 Vali Acc: 0.889 Test Loss: 0.944 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.404478073120117
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 36807942
model size : 155.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.697504758834839
Epoch: 1, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.500 Vali Acc: 0.561 Test Loss: 1.500 Test Acc: 0.561
Validation loss decreased (inf --> -0.561096).  Saving model ...
Epoch: 2 cost time: 2.200767993927002
Epoch: 2, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.088 Vali Acc: 0.628 Test Loss: 1.088 Test Acc: 0.628
Validation loss decreased (-0.561096 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 1.9779136180877686
Epoch: 3, Steps: 12 | Train Loss: 0.953 Vali Loss: 0.754 Vali Acc: 0.683 Test Loss: 0.754 Test Acc: 0.683
Validation loss decreased (-0.627767 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.9505949020385742
Epoch: 4, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.586 Vali Acc: 0.728 Test Loss: 0.586 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727772).  Saving model ...
Epoch: 5 cost time: 2.2229506969451904
Epoch: 5, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.485 Vali Acc: 0.761 Test Loss: 0.485 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 2.0240845680236816
Epoch: 6, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.411 Vali Acc: 0.806 Test Loss: 0.411 Test Acc: 0.806
Validation loss decreased (-0.761106 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 1.9813754558563232
Epoch: 7, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.904088020324707
Epoch: 8, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.462 Vali Acc: 0.828 Test Loss: 0.462 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 9 cost time: 1.927401065826416
Epoch: 9, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 2.247633457183838
Epoch: 10, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.3518972396850586
Epoch: 11, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.9460854530334473
Epoch: 12, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3023743629455566
Epoch: 13, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.047269105911255
Epoch: 14, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.416 Vali Acc: 0.867 Test Loss: 0.416 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2461462020874023
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.385 Vali Acc: 0.894 Test Loss: 0.385 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 1.9148776531219482
Epoch: 16, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 2.082073450088501
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1503021717071533
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.389 Vali Acc: 0.883 Test Loss: 0.389 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6649267673492432
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.170792818069458
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5798258781433105
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.720 Vali Acc: 0.889 Test Loss: 0.720 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.703833818435669
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911107).  Saving model ...
Epoch: 23 cost time: 1.828726053237915
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.935 Vali Acc: 0.894 Test Loss: 0.935 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6845269203186035
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 1.911163568496704
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.085 Vali Acc: 0.828 Test Loss: 1.085 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6588592529296875
Epoch: 26, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.079744815826416
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8594715595245361
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.185063123703003
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.762 Vali Acc: 0.894 Test Loss: 0.762 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8984694480895996
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922218).  Saving model ...
Epoch: 31 cost time: 1.8852264881134033
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.048382043838501
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 33 cost time: 1.8935177326202393
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927776).  Saving model ...
Epoch: 34 cost time: 1.929837942123413
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.825578212738037
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.368 Vali Acc: 0.933 Test Loss: 0.368 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 1.8772571086883545
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1034951210021973
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.483 Vali Acc: 0.933 Test Loss: 0.483 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.833859920501709
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
Validation loss decreased (-0.933330 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 2.2270560264587402
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.532 Vali Acc: 0.906 Test Loss: 0.532 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8567876815795898
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.540 Vali Acc: 0.917 Test Loss: 0.540 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.026545286178589
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.878 Vali Acc: 0.894 Test Loss: 0.878 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8625679016113281
Epoch: 42, Steps: 12 | Train Loss: 0.345 Vali Loss: 1.280 Vali Acc: 0.878 Test Loss: 1.280 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.0200724601745605
Epoch: 43, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.217 Vali Acc: 0.883 Test Loss: 1.217 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6912033557891846
Epoch: 44, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.701766014099121
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.347606897354126
Epoch: 46, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.485 Vali Acc: 0.922 Test Loss: 0.485 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.5999627113342285
Epoch: 47, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.507 Vali Acc: 0.922 Test Loss: 0.507 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8670623302459717
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.587 Vali Acc: 0.911 Test Loss: 0.587 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 36660486
model size : 154.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.015197277069092
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.695 Vali Acc: 0.272 Test Loss: 1.695 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 1.173297643661499
Epoch: 2, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.400 Vali Acc: 0.611 Test Loss: 1.400 Test Acc: 0.611
Validation loss decreased (-0.272205 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 1.2607390880584717
Epoch: 3, Steps: 12 | Train Loss: 1.295 Vali Loss: 0.998 Vali Acc: 0.661 Test Loss: 0.998 Test Acc: 0.661
Validation loss decreased (-0.611097 --> -0.661101).  Saving model ...
Epoch: 4 cost time: 1.2585551738739014
Epoch: 4, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.732 Vali Acc: 0.733 Test Loss: 0.732 Test Acc: 0.733
Validation loss decreased (-0.661101 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.4571757316589355
Epoch: 5, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.583 Vali Acc: 0.733 Test Loss: 0.583 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733328).  Saving model ...
Epoch: 6 cost time: 1.289738655090332
Epoch: 6, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.510 Vali Acc: 0.739 Test Loss: 0.510 Test Acc: 0.739
Validation loss decreased (-0.733328 --> -0.738884).  Saving model ...
Epoch: 7 cost time: 1.5485482215881348
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.437 Vali Acc: 0.794 Test Loss: 0.437 Test Acc: 0.794
Validation loss decreased (-0.738884 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 1.219299554824829
Epoch: 8, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.438 Vali Acc: 0.794 Test Loss: 0.438 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4944889545440674
Epoch: 9, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.459 Vali Acc: 0.794 Test Loss: 0.459 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.347745656967163
Epoch: 10, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 1.5106244087219238
Epoch: 11, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.448 Vali Acc: 0.811 Test Loss: 0.448 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 1.320380687713623
Epoch: 12, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
Validation loss decreased (-0.811107 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 1.498166561126709
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2921829223632812
Epoch: 14, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.431 Vali Acc: 0.839 Test Loss: 0.431 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3106672763824463
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4380035400390625
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.5487942695617676
Epoch: 17, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.378 Vali Acc: 0.883 Test Loss: 0.378 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3114666938781738
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.231525182723999
Epoch: 19, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.500077247619629
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 21 cost time: 1.5492262840270996
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.278109073638916
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2296385765075684
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 1.2958004474639893
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2848050594329834
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.349 Vali Acc: 0.878 Test Loss: 0.349 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.210303783416748
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2154450416564941
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.515967607498169
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.084503173828125
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.856 Vali Acc: 0.889 Test Loss: 0.856 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4554812908172607
Epoch: 30, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3562517166137695
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927775).  Saving model ...
Epoch: 32 cost time: 1.4310081005096436
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.235539436340332
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.448829174041748
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.928 Test Loss: 0.338 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2582452297210693
Epoch: 35, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.329 Vali Acc: 0.911 Test Loss: 0.329 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1698167324066162
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.479478120803833
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.391 Vali Acc: 0.922 Test Loss: 0.391 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2587895393371582
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3962547779083252
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.894 Test Loss: 0.470 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.219102144241333
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.636 Vali Acc: 0.917 Test Loss: 0.636 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4859023094177246
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.363 Vali Acc: 0.928 Test Loss: 0.363 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 36586758
model size : 154.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8685803413391113
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.634 Vali Acc: 0.428 Test Loss: 1.634 Test Acc: 0.428
Validation loss decreased (inf --> -0.427761).  Saving model ...
Epoch: 2 cost time: 1.7790467739105225
Epoch: 2, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.166 Vali Acc: 0.633 Test Loss: 1.166 Test Acc: 0.633
Validation loss decreased (-0.427761 --> -0.633322).  Saving model ...
Epoch: 3 cost time: 1.9564640522003174
Epoch: 3, Steps: 12 | Train Loss: 0.971 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
Validation loss decreased (-0.633322 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 2.269429922103882
Epoch: 4, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.484 Vali Acc: 0.744 Test Loss: 0.484 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744440).  Saving model ...
Epoch: 5 cost time: 1.8643317222595215
Epoch: 5, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.386 Vali Acc: 0.783 Test Loss: 0.386 Test Acc: 0.783
Validation loss decreased (-0.744440 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.9436988830566406
Epoch: 6, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 2.188140630722046
Epoch: 7, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.367 Vali Acc: 0.806 Test Loss: 0.367 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7889070510864258
Epoch: 8, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.389 Vali Acc: 0.833 Test Loss: 0.389 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8706319332122803
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.501 Vali Acc: 0.817 Test Loss: 0.501 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8519186973571777
Epoch: 10, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.263 Vali Acc: 0.861 Test Loss: 0.263 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.942633867263794
Epoch: 11, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.586 Vali Acc: 0.817 Test Loss: 0.586 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6252937316894531
Epoch: 12, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.861108 --> -0.899998).  Saving model ...
Epoch: 13 cost time: 1.863661289215088
Epoch: 13, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 1.9003450870513916
Epoch: 14, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7942235469818115
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 1.779245376586914
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.593135118484497
Epoch: 17, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8736085891723633
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8080875873565674
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9281344413757324
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0834527015686035
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.916665 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.987494945526123
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.348250389099121
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.650 Vali Acc: 0.922 Test Loss: 0.650 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9887993335723877
Epoch: 24, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.334862470626831
Epoch: 25, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.358 Vali Acc: 0.872 Test Loss: 0.358 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8853156566619873
Epoch: 26, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.380718946456909
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.944 Test Loss: 0.145 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.8704392910003662
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.330 Vali Acc: 0.956 Test Loss: 0.330 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955552).  Saving model ...
Epoch: 29 cost time: 1.8740754127502441
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.688 Vali Acc: 0.889 Test Loss: 0.688 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.876420021057129
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.0617997646331787
Epoch: 31, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.228 Vali Acc: 0.867 Test Loss: 1.228 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.817002773284912
Epoch: 32, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.405 Vali Acc: 0.922 Test Loss: 0.405 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.2657623291015625
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6739654541015625
Epoch: 34, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.355 Vali Acc: 0.928 Test Loss: 0.355 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.062460422515869
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.710 Vali Acc: 0.906 Test Loss: 0.710 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6292085647583008
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.407 Vali Acc: 0.922 Test Loss: 0.407 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.3313515186309814
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.922 Test Loss: 0.704 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8664591312408447
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.403 Vali Acc: 0.944 Test Loss: 0.403 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 36715782
model size : 154.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2222273349761963
Epoch: 1, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.563 Vali Acc: 0.544 Test Loss: 1.563 Test Acc: 0.544
Validation loss decreased (inf --> -0.544429).  Saving model ...
Epoch: 2 cost time: 2.163431167602539
Epoch: 2, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.227 Vali Acc: 0.589 Test Loss: 1.227 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588877).  Saving model ...
Epoch: 3 cost time: 2.2470715045928955
Epoch: 3, Steps: 12 | Train Loss: 1.094 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
Validation loss decreased (-0.588877 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.8674004077911377
Epoch: 4, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.716658 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.8085682392120361
Epoch: 5, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.438 Vali Acc: 0.772 Test Loss: 0.438 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772218).  Saving model ...
Epoch: 6 cost time: 1.3347303867340088
Epoch: 6, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
Validation loss decreased (-0.772218 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.80952787399292
Epoch: 7, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.395 Vali Acc: 0.828 Test Loss: 0.395 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4057667255401611
Epoch: 8, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.2538623809814453
Epoch: 9, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.0387132167816162
Epoch: 10, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5444929599761963
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
Validation loss decreased (-0.855552 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 1.7141196727752686
Epoch: 12, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.702772855758667
Epoch: 13, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7190241813659668
Epoch: 14, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6947932243347168
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.678776502609253
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.408 Vali Acc: 0.878 Test Loss: 0.408 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6896765232086182
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.423 Vali Acc: 0.894 Test Loss: 0.423 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6621081829071045
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 1.6968858242034912
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.425 Vali Acc: 0.894 Test Loss: 0.425 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6944212913513184
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 1.896254062652588
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7675426006317139
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.860 Vali Acc: 0.867 Test Loss: 0.860 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8350558280944824
Epoch: 23, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.914668321609497
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.418 Vali Acc: 0.906 Test Loss: 0.418 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7027039527893066
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1866097450256348
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8197526931762695
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.754917860031128
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.328 Vali Acc: 0.928 Test Loss: 0.328 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1113500595092773
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.307 Vali Acc: 0.911 Test Loss: 0.307 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.710890531539917
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 36666630
model size : 154.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9767990112304688
Epoch: 1, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.660 Vali Acc: 0.383 Test Loss: 1.660 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 1.1391687393188477
Epoch: 2, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.401 Vali Acc: 0.672 Test Loss: 1.401 Test Acc: 0.672
Validation loss decreased (-0.383317 --> -0.672208).  Saving model ...
Epoch: 3 cost time: 0.918982744216919
Epoch: 3, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.057 Vali Acc: 0.717 Test Loss: 1.057 Test Acc: 0.717
Validation loss decreased (-0.672208 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 1.333064079284668
Epoch: 4, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.697 Vali Acc: 0.767 Test Loss: 0.697 Test Acc: 0.767
Validation loss decreased (-0.716656 --> -0.766660).  Saving model ...
Epoch: 5 cost time: 1.1868622303009033
Epoch: 5, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.529 Vali Acc: 0.739 Test Loss: 0.529 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1937148571014404
Epoch: 6, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.424 Vali Acc: 0.789 Test Loss: 0.424 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 1.1395771503448486
Epoch: 7, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.788885 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.0781548023223877
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.391 Vali Acc: 0.828 Test Loss: 0.391 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4127953052520752
Epoch: 9, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 1.147212028503418
Epoch: 10, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4034733772277832
Epoch: 11, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.8840162754058838
Epoch: 12, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2314972877502441
Epoch: 13, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3585898876190186
Epoch: 14, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.250694990158081
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 1.2069981098175049
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933332).  Saving model ...
Epoch: 17 cost time: 1.4349865913391113
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2382586002349854
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3825733661651611
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2374045848846436
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.324232578277588
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2690761089324951
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2628822326660156
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.162 Vali Acc: 0.939 Test Loss: 0.162 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 1.14920973777771
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1689341068267822
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4782776832580566
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1611125469207764
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1483714580535889
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4453682899475098
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2935104370117188
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.176 Vali Acc: 0.928 Test Loss: 0.176 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.068422555923462
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4098162651062012
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3875224590301514
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.282 Vali Acc: 0.956 Test Loss: 0.282 Test Acc: 0.956
Validation loss decreased (-0.938887 --> -0.955553).  Saving model ...
Epoch: 34 cost time: 1.4089832305908203
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.147 Vali Acc: 0.944 Test Loss: 0.147 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1549041271209717
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.472545862197876
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3989875316619873
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.310 Vali Acc: 0.928 Test Loss: 0.310 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.193671703338623
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3822016716003418
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2611417770385742
Epoch: 40, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.363 Vali Acc: 0.939 Test Loss: 0.363 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5284504890441895
Epoch: 41, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.517 Vali Acc: 0.917 Test Loss: 0.517 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2579326629638672
Epoch: 42, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1227092742919922
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 36629766
model size : 154.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.919203281402588
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.648 Vali Acc: 0.344 Test Loss: 1.648 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 1.891125202178955
Epoch: 2, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.143 Vali Acc: 0.667 Test Loss: 1.143 Test Acc: 0.667
Validation loss decreased (-0.344428 --> -0.666655).  Saving model ...
Epoch: 3 cost time: 1.9555110931396484
Epoch: 3, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.658 Vali Acc: 0.700 Test Loss: 0.658 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 2.19621205329895
Epoch: 4, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.462 Vali Acc: 0.733 Test Loss: 0.462 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733329).  Saving model ...
Epoch: 5 cost time: 1.8398194313049316
Epoch: 5, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.327 Vali Acc: 0.822 Test Loss: 0.327 Test Acc: 0.822
Validation loss decreased (-0.733329 --> -0.822219).  Saving model ...
Epoch: 6 cost time: 1.9524059295654297
Epoch: 6, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8786265850067139
Epoch: 7, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
Validation loss decreased (-0.822219 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 1.818089246749878
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.453 Vali Acc: 0.817 Test Loss: 0.453 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.008294105529785
Epoch: 9, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.393 Vali Acc: 0.872 Test Loss: 0.393 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 1.8188281059265137
Epoch: 10, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.341 Vali Acc: 0.839 Test Loss: 0.341 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1190826892852783
Epoch: 11, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5301625728607178
Epoch: 12, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.9193134307861328
Epoch: 13, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 1.5886013507843018
Epoch: 14, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5352389812469482
Epoch: 15, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.449 Vali Acc: 0.839 Test Loss: 0.449 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6389076709747314
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6026506423950195
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
Validation loss decreased (-0.899998 --> -0.938887).  Saving model ...
Epoch: 18 cost time: 1.380629301071167
Epoch: 18, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.944 Vali Acc: 0.850 Test Loss: 0.944 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5985581874847412
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.361 Vali Acc: 0.878 Test Loss: 0.361 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.589306116104126
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4382750988006592
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.643 Vali Acc: 0.889 Test Loss: 0.643 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1484582424163818
Epoch: 22, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.465 Vali Acc: 0.928 Test Loss: 0.465 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5279736518859863
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6439459323883057
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.894 Test Loss: 0.547 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.601158618927002
Epoch: 25, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.403 Vali Acc: 0.883 Test Loss: 0.403 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5800175666809082
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.627490758895874
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.439 Vali Acc: 0.906 Test Loss: 0.439 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 36764934
model size : 154.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5682826042175293
Epoch: 1, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.681 Vali Acc: 0.294 Test Loss: 1.681 Test Acc: 0.294
Validation loss decreased (inf --> -0.294428).  Saving model ...
Epoch: 2 cost time: 1.580681324005127
Epoch: 2, Steps: 12 | Train Loss: 1.574 Vali Loss: 1.294 Vali Acc: 0.578 Test Loss: 1.294 Test Acc: 0.578
Validation loss decreased (-0.294428 --> -0.577765).  Saving model ...
Epoch: 3 cost time: 1.5019500255584717
Epoch: 3, Steps: 12 | Train Loss: 1.108 Vali Loss: 0.832 Vali Acc: 0.739 Test Loss: 0.832 Test Acc: 0.739
Validation loss decreased (-0.577765 --> -0.738881).  Saving model ...
Epoch: 4 cost time: 2.0723531246185303
Epoch: 4, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.738881 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 1.4721670150756836
Epoch: 5, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.459 Vali Acc: 0.783 Test Loss: 0.459 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 2.1691031455993652
Epoch: 6, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
Validation loss decreased (-0.783329 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 1.6708381175994873
Epoch: 7, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.06203031539917
Epoch: 8, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.258 Vali Acc: 0.867 Test Loss: 0.258 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 1.8004741668701172
Epoch: 9, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7952113151550293
Epoch: 10, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 2.084290027618408
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7702240943908691
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 2.0996127128601074
Epoch: 13, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 2.1909685134887695
Epoch: 14, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8270559310913086
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.363 Vali Acc: 0.894 Test Loss: 0.363 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5429387092590332
Epoch: 16, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 1.7928950786590576
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1157071590423584
Epoch: 18, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7541208267211914
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.156 Vali Acc: 0.917 Test Loss: 0.156 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.111473321914673
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 1.8389570713043213
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9167375564575195
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9953250885009766
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8370888233184814
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.451 Vali Acc: 0.894 Test Loss: 0.451 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1751794815063477
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8292644023895264
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 27 cost time: 2.0176761150360107
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.480236530303955
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.4880397319793701
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.544 Vali Acc: 0.911 Test Loss: 0.544 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8130764961242676
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 1.6750242710113525
Epoch: 31, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.686 Vali Acc: 0.894 Test Loss: 0.686 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.075416326522827
Epoch: 32, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5166876316070557
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.987452745437622
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.446 Vali Acc: 0.922 Test Loss: 0.446 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6802942752838135
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.463 Vali Acc: 0.911 Test Loss: 0.463 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.0282297134399414
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.546 Vali Acc: 0.922 Test Loss: 0.546 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.323915719985962
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.430 Vali Acc: 0.928 Test Loss: 0.430 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6876146793365479
Epoch: 38, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.657 Vali Acc: 0.900 Test Loss: 0.657 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.030266523361206
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.922 Test Loss: 0.618 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.8469152450561523
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.685 Vali Acc: 0.922 Test Loss: 0.685 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 36721926
model size : 154.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6364729404449463
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.731 Vali Acc: 0.244 Test Loss: 1.731 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.0874676704406738
Epoch: 2, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.501 Vali Acc: 0.461 Test Loss: 1.501 Test Acc: 0.461
Validation loss decreased (-0.244427 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 1.084942102432251
Epoch: 3, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.120 Vali Acc: 0.678 Test Loss: 1.120 Test Acc: 0.678
Validation loss decreased (-0.461096 --> -0.677767).  Saving model ...
Epoch: 4 cost time: 0.9846327304840088
Epoch: 4, Steps: 12 | Train Loss: 0.975 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
Validation loss decreased (-0.677767 --> -0.761104).  Saving model ...
Epoch: 5 cost time: 1.1440844535827637
Epoch: 5, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.493 Vali Acc: 0.794 Test Loss: 0.493 Test Acc: 0.794
Validation loss decreased (-0.761104 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.025876760482788
Epoch: 6, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.383 Vali Acc: 0.806 Test Loss: 0.383 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.0640575885772705
Epoch: 7, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.386 Vali Acc: 0.806 Test Loss: 0.386 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0854144096374512
Epoch: 8, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.1235918998718262
Epoch: 9, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.005403757095337
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9865705966949463
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.409 Vali Acc: 0.839 Test Loss: 0.409 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.905393123626709
Epoch: 12, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0001046657562256
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9879474639892578
Epoch: 14, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.2364387512207031
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1136481761932373
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.1114859580993652
Epoch: 17, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.189 Vali Acc: 0.900 Test Loss: 0.189 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 18 cost time: 1.0905284881591797
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 1.131312370300293
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.989577054977417
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0676238536834717
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.201 Vali Acc: 0.894 Test Loss: 0.201 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2478258609771729
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1706619262695312
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.200 Vali Acc: 0.894 Test Loss: 0.200 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1257569789886475
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0655744075775146
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.310760498046875
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.125788688659668
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1293153762817383
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 36672774
model size : 154.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.051718473434448
Epoch: 1, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.632 Vali Acc: 0.378 Test Loss: 1.632 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 1.8601300716400146
Epoch: 2, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.208 Vali Acc: 0.633 Test Loss: 1.208 Test Acc: 0.633
Validation loss decreased (-0.377761 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 1.9430289268493652
Epoch: 3, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.776 Vali Acc: 0.644 Test Loss: 0.776 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644437).  Saving model ...
Epoch: 4 cost time: 2.3021767139434814
Epoch: 4, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (-0.644437 --> -0.716661).  Saving model ...
Epoch: 5 cost time: 2.1612398624420166
Epoch: 5, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.486 Vali Acc: 0.767 Test Loss: 0.486 Test Acc: 0.767
Validation loss decreased (-0.716661 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 1.8578591346740723
Epoch: 6, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.414 Vali Acc: 0.789 Test Loss: 0.414 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 1.9476702213287354
Epoch: 7, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.312 Vali Acc: 0.828 Test Loss: 0.312 Test Acc: 0.828
Validation loss decreased (-0.788885 --> -0.827775).  Saving model ...
Epoch: 8 cost time: 2.004242420196533
Epoch: 8, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.411 Vali Acc: 0.839 Test Loss: 0.411 Test Acc: 0.839
Validation loss decreased (-0.827775 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.4193918704986572
Epoch: 9, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8642661571502686
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 2.0093419551849365
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
Validation loss decreased (-0.849996 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 2.1350762844085693
Epoch: 12, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.261 Vali Acc: 0.861 Test Loss: 0.261 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.956132173538208
Epoch: 13, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8421928882598877
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.181 Vali Acc: 0.900 Test Loss: 0.181 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 2.2089767456054688
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7242331504821777
Epoch: 16, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.050834894180298
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.533 Vali Acc: 0.906 Test Loss: 0.533 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905550).  Saving model ...
Epoch: 18 cost time: 2.1358230113983154
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.905550 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.2050957679748535
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.548 Vali Acc: 0.878 Test Loss: 0.548 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8025474548339844
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.12187123298645
Epoch: 21, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.743913173675537
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.174736976623535
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7244083881378174
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6842296123504639
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.7314815521240234
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
Validation loss decreased (-0.922220 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 1.696908950805664
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.374 Vali Acc: 0.933 Test Loss: 0.374 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6667883396148682
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.738046407699585
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7205109596252441
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.443 Vali Acc: 0.911 Test Loss: 0.443 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7323741912841797
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.457 Vali Acc: 0.906 Test Loss: 0.457 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7149763107299805
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.313 Vali Acc: 0.928 Test Loss: 0.313 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.243476152420044
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8954505920410156
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9783086776733398
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.604 Vali Acc: 0.894 Test Loss: 0.604 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9831430912017822
Epoch: 36, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 36820230
model size : 155.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1928951740264893
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.700 Vali Acc: 0.328 Test Loss: 1.700 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.5815823078155518
Epoch: 2, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.372 Vali Acc: 0.606 Test Loss: 1.372 Test Acc: 0.606
Validation loss decreased (-0.327761 --> -0.605542).  Saving model ...
Epoch: 3 cost time: 1.0658397674560547
Epoch: 3, Steps: 12 | Train Loss: 1.224 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.605542 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.503967046737671
Epoch: 4, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.661 Vali Acc: 0.667 Test Loss: 0.661 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4192078113555908
Epoch: 5, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.532 Vali Acc: 0.744 Test Loss: 0.532 Test Acc: 0.744
Validation loss decreased (-0.699990 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 1.5978734493255615
Epoch: 6, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
Validation loss decreased (-0.744439 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.5094058513641357
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.320 Vali Acc: 0.817 Test Loss: 0.320 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.1839401721954346
Epoch: 8, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.295 Vali Acc: 0.822 Test Loss: 0.295 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 1.3969089984893799
Epoch: 9, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
Validation loss decreased (-0.822219 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.2415885925292969
Epoch: 10, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5610308647155762
Epoch: 11, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.280 Vali Acc: 0.839 Test Loss: 0.280 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3722445964813232
Epoch: 12, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 1.647249460220337
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3788111209869385
Epoch: 14, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5273253917694092
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.405 Vali Acc: 0.878 Test Loss: 0.405 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 1.3632187843322754
Epoch: 16, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 1.577411413192749
Epoch: 17, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.5723493099212646
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 1.4204514026641846
Epoch: 19, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6007518768310547
Epoch: 20, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3114402294158936
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.396 Vali Acc: 0.883 Test Loss: 0.396 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2243597507476807
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3270914554595947
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4827380180358887
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 1.401386022567749
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4326798915863037
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.5427961349487305
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.601 Vali Acc: 0.889 Test Loss: 0.601 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3590583801269531
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.635 Vali Acc: 0.894 Test Loss: 0.635 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3221189975738525
Epoch: 29, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.182 Vali Acc: 0.900 Test Loss: 0.182 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5382261276245117
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.481003761291504
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4014503955841064
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.343282699584961
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5392892360687256
Epoch: 34, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.556 Vali Acc: 0.878 Test Loss: 0.556 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.416158676147461
Epoch: 35, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5751049518585205
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 36752646
model size : 154.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.158087730407715
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.699 Vali Acc: 0.350 Test Loss: 1.699 Test Acc: 0.350
Validation loss decreased (inf --> -0.349983).  Saving model ...
Epoch: 2 cost time: 1.2331116199493408
Epoch: 2, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.449 Vali Acc: 0.611 Test Loss: 1.449 Test Acc: 0.611
Validation loss decreased (-0.349983 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 0.971672534942627
Epoch: 3, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.128 Vali Acc: 0.694 Test Loss: 1.128 Test Acc: 0.694
Validation loss decreased (-0.611097 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 0.9468088150024414
Epoch: 4, Steps: 12 | Train Loss: 1.064 Vali Loss: 0.794 Vali Acc: 0.728 Test Loss: 0.794 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 0.9556164741516113
Epoch: 5, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.601 Vali Acc: 0.706 Test Loss: 0.601 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8332557678222656
Epoch: 6, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
Validation loss decreased (-0.727770 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 0.9614996910095215
Epoch: 7, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.383 Vali Acc: 0.794 Test Loss: 0.383 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794441).  Saving model ...
Epoch: 8 cost time: 0.8670008182525635
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.371 Vali Acc: 0.794 Test Loss: 0.371 Test Acc: 0.794
Validation loss decreased (-0.794441 --> -0.794441).  Saving model ...
Epoch: 9 cost time: 0.9866714477539062
Epoch: 9, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
Validation loss decreased (-0.794441 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 0.967484712600708
Epoch: 10, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.0418930053710938
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1438698768615723
Epoch: 12, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9962902069091797
Epoch: 13, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 1.124617576599121
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 1.1200339794158936
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.242 Vali Acc: 0.872 Test Loss: 0.242 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9223446846008301
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.240 Vali Acc: 0.878 Test Loss: 0.240 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1553001403808594
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 1.1220686435699463
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 0.9709813594818115
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1748592853546143
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.405 Vali Acc: 0.872 Test Loss: 0.405 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1306872367858887
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.174452781677246
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1338703632354736
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.007617473602295
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9205498695373535
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2344908714294434
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1456365585327148
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0735719203948975
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.267740249633789
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.1088011264801025
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0873095989227295
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.933 Test Loss: 0.104 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 32 cost time: 1.195967674255371
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.933 Test Loss: 0.136 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2503869533538818
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.437 Vali Acc: 0.928 Test Loss: 0.437 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0419299602508545
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9950165748596191
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1717240810394287
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0298757553100586
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.427 Vali Acc: 0.894 Test Loss: 0.427 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0452051162719727
Epoch: 38, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9927389621734619
Epoch: 39, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.430 Vali Acc: 0.883 Test Loss: 0.430 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2528715133666992
Epoch: 40, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8852133750915527
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 36721926
model size : 154.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5565245151519775
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.539 Vali Acc: 0.567 Test Loss: 1.539 Test Acc: 0.567
Validation loss decreased (inf --> -0.566651).  Saving model ...
Epoch: 2 cost time: 2.1939215660095215
Epoch: 2, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.566651 --> -0.699990).  Saving model ...
Epoch: 3 cost time: 2.148075819015503
Epoch: 3, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
Validation loss decreased (-0.699990 --> -0.761105).  Saving model ...
Epoch: 4 cost time: 1.8448278903961182
Epoch: 4, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.417 Vali Acc: 0.772 Test Loss: 0.417 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.5073177814483643
Epoch: 5, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.733 Vali Acc: 0.794 Test Loss: 0.733 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794437).  Saving model ...
Epoch: 6 cost time: 2.211374282836914
Epoch: 6, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 2.083038091659546
Epoch: 7, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.4794092178344727
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.324 Vali Acc: 0.822 Test Loss: 0.324 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.054489850997925
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9856390953063965
Epoch: 10, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
Validation loss decreased (-0.833330 --> -0.905553).  Saving model ...
Epoch: 11 cost time: 1.7807672023773193
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1059799194335938
Epoch: 12, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7021269798278809
Epoch: 13, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7153615951538086
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5001506805419922
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.401 Vali Acc: 0.894 Test Loss: 0.401 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7360568046569824
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5914011001586914
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 1.662365198135376
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.432 Vali Acc: 0.894 Test Loss: 0.432 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6504042148590088
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.165 Vali Acc: 0.917 Test Loss: 0.165 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7277843952178955
Epoch: 20, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
Validation loss decreased (-0.922220 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 1.6107332706451416
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0459461212158203
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1265742778778076
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4100666046142578
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.307852268218994
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.394 Vali Acc: 0.928 Test Loss: 0.394 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8507037162780762
Epoch: 26, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.171494483947754
Epoch: 27, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7759568691253662
Epoch: 28, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.691 Vali Acc: 0.883 Test Loss: 0.691 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.996870756149292
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9970531463623047
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.928 Test Loss: 0.301 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 36869382
model size : 155.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7586400508880615
Epoch: 1, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.2519876956939697
Epoch: 2, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.343 Vali Acc: 0.583 Test Loss: 1.343 Test Acc: 0.583
Validation loss decreased (-0.299983 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 1.1816706657409668
Epoch: 3, Steps: 12 | Train Loss: 1.199 Vali Loss: 0.925 Vali Acc: 0.678 Test Loss: 0.925 Test Acc: 0.678
Validation loss decreased (-0.583320 --> -0.677769).  Saving model ...
Epoch: 4 cost time: 1.4268605709075928
Epoch: 4, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.599 Vali Acc: 0.767 Test Loss: 0.599 Test Acc: 0.767
Validation loss decreased (-0.677769 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 1.3417880535125732
Epoch: 5, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.440 Vali Acc: 0.778 Test Loss: 0.440 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.1441783905029297
Epoch: 6, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.415 Vali Acc: 0.794 Test Loss: 0.415 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.4095849990844727
Epoch: 7, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
Validation loss decreased (-0.794440 --> -0.877775).  Saving model ...
Epoch: 8 cost time: 1.5275371074676514
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.521 Vali Acc: 0.811 Test Loss: 0.521 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2507541179656982
Epoch: 9, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3385043144226074
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.1462552547454834
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4925782680511475
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2636969089508057
Epoch: 13, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.360 Vali Acc: 0.872 Test Loss: 0.360 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.391340970993042
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 1.3182873725891113
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.363 Vali Acc: 0.883 Test Loss: 0.363 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4814839363098145
Epoch: 16, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2762596607208252
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4704978466033936
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2725260257720947
Epoch: 19, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4762189388275146
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.494 Vali Acc: 0.917 Test Loss: 0.494 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3028790950775146
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.582242727279663
Epoch: 22, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3082959651947021
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.444 Vali Acc: 0.894 Test Loss: 0.444 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5737035274505615
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 36801798
model size : 155.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5718088150024414
Epoch: 1, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.654 Vali Acc: 0.428 Test Loss: 1.654 Test Acc: 0.428
Validation loss decreased (inf --> -0.427761).  Saving model ...
Epoch: 2 cost time: 0.9728355407714844
Epoch: 2, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.364 Vali Acc: 0.567 Test Loss: 1.364 Test Acc: 0.567
Validation loss decreased (-0.427761 --> -0.566653).  Saving model ...
Epoch: 3 cost time: 0.9464223384857178
Epoch: 3, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.037 Vali Acc: 0.689 Test Loss: 1.037 Test Acc: 0.689
Validation loss decreased (-0.566653 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 1.0571842193603516
Epoch: 4, Steps: 12 | Train Loss: 0.926 Vali Loss: 0.721 Vali Acc: 0.761 Test Loss: 0.721 Test Acc: 0.761
Validation loss decreased (-0.688879 --> -0.761104).  Saving model ...
Epoch: 5 cost time: 0.9534327983856201
Epoch: 5, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.526 Vali Acc: 0.744 Test Loss: 0.526 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9653751850128174
Epoch: 6, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.473 Vali Acc: 0.756 Test Loss: 0.473 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8173601627349854
Epoch: 7, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.761104 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 1.044661045074463
Epoch: 8, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.002197265625
Epoch: 9, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844442).  Saving model ...
Epoch: 10 cost time: 1.0451545715332031
Epoch: 10, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.272 Vali Acc: 0.850 Test Loss: 0.272 Test Acc: 0.850
Validation loss decreased (-0.844442 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.1308937072753906
Epoch: 11, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 1.1037907600402832
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.0148890018463135
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.224 Vali Acc: 0.894 Test Loss: 0.224 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.0790045261383057
Epoch: 14, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.237 Vali Acc: 0.878 Test Loss: 0.237 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1420001983642578
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.229 Vali Acc: 0.883 Test Loss: 0.229 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0645971298217773
Epoch: 16, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 17 cost time: 1.201575517654419
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.206 Vali Acc: 0.872 Test Loss: 0.206 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2473585605621338
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.257 Vali Acc: 0.867 Test Loss: 0.257 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0537786483764648
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.168 Vali Acc: 0.911 Test Loss: 0.168 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 1.2039883136749268
Epoch: 20, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0641067028045654
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.370 Vali Acc: 0.878 Test Loss: 0.370 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9897103309631348
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.187 Vali Acc: 0.911 Test Loss: 0.187 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.007735013961792
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933332).  Saving model ...
Epoch: 24 cost time: 1.1583361625671387
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9304060935974121
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.445 Vali Acc: 0.906 Test Loss: 0.445 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9463856220245361
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1639695167541504
Epoch: 27, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.204 Vali Acc: 0.906 Test Loss: 0.204 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.027141809463501
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9598283767700195
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.977879524230957
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1387369632720947
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0840339660644531
Epoch: 32, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9635164737701416
Epoch: 33, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.176 Vali Acc: 0.928 Test Loss: 0.176 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 36771078
model size : 154.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.822495937347412
Epoch: 1, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.639 Vali Acc: 0.417 Test Loss: 1.639 Test Acc: 0.417
Validation loss decreased (inf --> -0.416650).  Saving model ...
Epoch: 2 cost time: 1.513862133026123
Epoch: 2, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.221 Vali Acc: 0.617 Test Loss: 1.221 Test Acc: 0.617
Validation loss decreased (-0.416650 --> -0.616654).  Saving model ...
Epoch: 3 cost time: 1.3405044078826904
Epoch: 3, Steps: 12 | Train Loss: 1.116 Vali Loss: 0.764 Vali Acc: 0.783 Test Loss: 0.764 Test Acc: 0.783
Validation loss decreased (-0.616654 --> -0.783326).  Saving model ...
Epoch: 4 cost time: 1.4527616500854492
Epoch: 4, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.455 Vali Acc: 0.794 Test Loss: 0.455 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 1.556481122970581
Epoch: 5, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 6 cost time: 1.4384093284606934
Epoch: 6, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.476 Vali Acc: 0.811 Test Loss: 0.476 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5425801277160645
Epoch: 7, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.486 Vali Acc: 0.828 Test Loss: 0.486 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827773).  Saving model ...
Epoch: 8 cost time: 1.4244446754455566
Epoch: 8, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 1.2478234767913818
Epoch: 9, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.399 Vali Acc: 0.844 Test Loss: 0.399 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4051237106323242
Epoch: 10, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3199553489685059
Epoch: 11, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.361250400543213
Epoch: 12, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.398 Vali Acc: 0.867 Test Loss: 0.398 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 1.2552344799041748
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.6258270740509033
Epoch: 14, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 1.3284544944763184
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.524846076965332
Epoch: 16, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3374996185302734
Epoch: 17, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905552).  Saving model ...
Epoch: 18 cost time: 1.522301435470581
Epoch: 18, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3556811809539795
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2214040756225586
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.688 Vali Acc: 0.878 Test Loss: 0.688 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5562949180603027
Epoch: 21, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.610 Vali Acc: 0.872 Test Loss: 0.610 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2559185028076172
Epoch: 22, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.592 Vali Acc: 0.889 Test Loss: 0.592 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6179134845733643
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.361 Vali Acc: 0.872 Test Loss: 0.361 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4104046821594238
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 1.5255303382873535
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
Validation loss decreased (-0.916663 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 1.215017557144165
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5346851348876953
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.928 Test Loss: 0.321 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4029624462127686
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1520941257476807
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5464918613433838
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1628625392913818
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1763157844543457
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.665 Vali Acc: 0.878 Test Loss: 0.665 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4392971992492676
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3685171604156494
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5210301876068115
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 36881670
model size : 155.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3521718978881836
Epoch: 1, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.707 Vali Acc: 0.283 Test Loss: 1.707 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 1.0360743999481201
Epoch: 2, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.383 Vali Acc: 0.617 Test Loss: 1.383 Test Acc: 0.617
Validation loss decreased (-0.283316 --> -0.616653).  Saving model ...
Epoch: 3 cost time: 1.315796136856079
Epoch: 3, Steps: 12 | Train Loss: 1.194 Vali Loss: 0.968 Vali Acc: 0.678 Test Loss: 0.968 Test Acc: 0.678
Validation loss decreased (-0.616653 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 1.2422361373901367
Epoch: 4, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.587 Vali Acc: 0.733 Test Loss: 0.587 Test Acc: 0.733
Validation loss decreased (-0.677768 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 1.1728506088256836
Epoch: 5, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.456 Vali Acc: 0.783 Test Loss: 0.456 Test Acc: 0.783
Validation loss decreased (-0.733327 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.2795202732086182
Epoch: 6, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.136352777481079
Epoch: 7, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.2336993217468262
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
Validation loss decreased (-0.833329 --> -0.894442).  Saving model ...
Epoch: 9 cost time: 1.1498358249664307
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.279 Vali Acc: 0.833 Test Loss: 0.279 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1899678707122803
Epoch: 10, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0083410739898682
Epoch: 11, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1878087520599365
Epoch: 12, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0629057884216309
Epoch: 13, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0434350967407227
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.244 Vali Acc: 0.872 Test Loss: 0.244 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2507758140563965
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2445509433746338
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.449 Vali Acc: 0.894 Test Loss: 0.449 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2093379497528076
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1840636730194092
Epoch: 18, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 36844806
model size : 155.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.547495126724243
Epoch: 1, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.725 Vali Acc: 0.289 Test Loss: 1.725 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.9325122833251953
Epoch: 2, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.478 Vali Acc: 0.600 Test Loss: 1.478 Test Acc: 0.600
Validation loss decreased (-0.288872 --> -0.599985).  Saving model ...
Epoch: 3 cost time: 1.0406856536865234
Epoch: 3, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.129 Vali Acc: 0.728 Test Loss: 1.129 Test Acc: 0.728
Validation loss decreased (-0.599985 --> -0.727766).  Saving model ...
Epoch: 4 cost time: 1.108604907989502
Epoch: 4, Steps: 12 | Train Loss: 1.014 Vali Loss: 0.764 Vali Acc: 0.733 Test Loss: 0.764 Test Acc: 0.733
Validation loss decreased (-0.727766 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.0014820098876953
Epoch: 5, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.552 Vali Acc: 0.772 Test Loss: 0.552 Test Acc: 0.772
Validation loss decreased (-0.733326 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 0.9264006614685059
Epoch: 6, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.434 Vali Acc: 0.778 Test Loss: 0.434 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 1.2626464366912842
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.1921825408935547
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.1276805400848389
Epoch: 9, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.361 Vali Acc: 0.844 Test Loss: 0.361 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.0800371170043945
Epoch: 10, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.262 Vali Acc: 0.856 Test Loss: 0.262 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.19045090675354
Epoch: 11, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.280 Vali Acc: 0.839 Test Loss: 0.280 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.137660264968872
Epoch: 12, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0139856338500977
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.916229248046875
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888887).  Saving model ...
Epoch: 15 cost time: 1.197934627532959
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.257 Vali Acc: 0.850 Test Loss: 0.257 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1843292713165283
Epoch: 16, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.035512924194336
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9648971557617188
Epoch: 18, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.2846696376800537
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0346183776855469
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.243 Vali Acc: 0.878 Test Loss: 0.243 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.193634271621704
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2620694637298584
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0144000053405762
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.354 Vali Acc: 0.878 Test Loss: 0.354 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9913721084594727
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 1.2259299755096436
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 1.0841846466064453
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2632513046264648
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1895084381103516
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0008182525634766
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0350673198699951
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.928 Test Loss: 0.175 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 1.106931209564209
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0755019187927246
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.889 Test Loss: 0.203 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9326720237731934
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0684964656829834
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0934624671936035
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0512943267822266
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9444196224212646
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1572186946868896
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1854603290557861
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0311615467071533
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.369 Vali Acc: 0.894 Test Loss: 0.369 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 36820230
model size : 155.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3046281337738037
Epoch: 1, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 1.2204606533050537
Epoch: 2, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.141 Vali Acc: 0.644 Test Loss: 1.141 Test Acc: 0.644
Validation loss decreased (-0.499984 --> -0.644433).  Saving model ...
Epoch: 3 cost time: 1.3190793991088867
Epoch: 3, Steps: 12 | Train Loss: 0.941 Vali Loss: 0.680 Vali Acc: 0.739 Test Loss: 0.680 Test Acc: 0.739
Validation loss decreased (-0.644433 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 1.3040847778320312
Epoch: 4, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.438 Vali Acc: 0.800 Test Loss: 0.438 Test Acc: 0.800
Validation loss decreased (-0.738882 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.6283972263336182
Epoch: 5, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 6 cost time: 1.2309174537658691
Epoch: 6, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.308 Vali Acc: 0.828 Test Loss: 0.308 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 7 cost time: 1.466796875
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
Validation loss decreased (-0.827775 --> -0.866664).  Saving model ...
Epoch: 8 cost time: 1.6104819774627686
Epoch: 8, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.214174509048462
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.444 Vali Acc: 0.828 Test Loss: 0.444 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.445145606994629
Epoch: 10, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.3170037269592285
Epoch: 11, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4889492988586426
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4093589782714844
Epoch: 13, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2536170482635498
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.235 Vali Acc: 0.872 Test Loss: 0.235 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4369943141937256
Epoch: 15, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1771106719970703
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 17 cost time: 1.4822349548339844
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2835958003997803
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4604041576385498
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.433 Vali Acc: 0.878 Test Loss: 0.433 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2508025169372559
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
Validation loss decreased (-0.899998 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 1.4662530422210693
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1969914436340332
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2000658512115479
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1990022659301758
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2036285400390625
Epoch: 25, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.436 Vali Acc: 0.906 Test Loss: 0.436 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0996148586273193
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.974665641784668
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.631 Vali Acc: 0.906 Test Loss: 0.631 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.113896369934082
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.787 Vali Acc: 0.867 Test Loss: 0.787 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1929240226745605
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.623 Vali Acc: 0.911 Test Loss: 0.623 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9852244853973389
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.338 Vali Acc: 0.922 Test Loss: 0.338 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 36986118
model size : 155.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.41774845123291
Epoch: 1, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.547 Vali Acc: 0.533 Test Loss: 1.547 Test Acc: 0.533
Validation loss decreased (inf --> -0.533318).  Saving model ...
Epoch: 2 cost time: 1.107635736465454
Epoch: 2, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.207 Vali Acc: 0.633 Test Loss: 1.207 Test Acc: 0.633
Validation loss decreased (-0.533318 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 1.1165382862091064
Epoch: 3, Steps: 12 | Train Loss: 1.097 Vali Loss: 0.853 Vali Acc: 0.794 Test Loss: 0.853 Test Acc: 0.794
Validation loss decreased (-0.633321 --> -0.794436).  Saving model ...
Epoch: 4 cost time: 0.8569986820220947
Epoch: 4, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.593 Vali Acc: 0.800 Test Loss: 0.593 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799994).  Saving model ...
Epoch: 5 cost time: 1.1168949604034424
Epoch: 5, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.465 Vali Acc: 0.767 Test Loss: 0.465 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9311411380767822
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.0941271781921387
Epoch: 7, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.368 Vali Acc: 0.811 Test Loss: 0.368 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.005251169204712
Epoch: 8, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 1.1149840354919434
Epoch: 9, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 0.9445865154266357
Epoch: 10, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.255077838897705
Epoch: 11, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.0414721965789795
Epoch: 12, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 1.148542881011963
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.237 Vali Acc: 0.878 Test Loss: 0.237 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0429060459136963
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.171381950378418
Epoch: 15, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.0774047374725342
Epoch: 16, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2189195156097412
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0549139976501465
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.946056604385376
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0907292366027832
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0724265575408936
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.1099276542663574
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.537 Vali Acc: 0.889 Test Loss: 0.537 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1166434288024902
Epoch: 23, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1232872009277344
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1109552383422852
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1944963932037354
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.495 Vali Acc: 0.906 Test Loss: 0.495 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0122630596160889
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9296832084655762
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2863438129425049
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2776062488555908
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.384 Vali Acc: 0.894 Test Loss: 0.384 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.207404375076294
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 1.2148959636688232
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0183098316192627
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 1.0692994594573975
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0045409202575684
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.9583971500396729
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 37 cost time: 1.2173640727996826
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0182158946990967
Epoch: 38, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.554 Vali Acc: 0.928 Test Loss: 0.554 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1987581253051758
Epoch: 39, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.042220115661621
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.308 Vali Acc: 0.939 Test Loss: 0.308 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2437386512756348
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.961 Test Loss: 0.227 Test Acc: 0.961
Validation loss decreased (-0.938887 --> -0.961109).  Saving model ...
Epoch: 42 cost time: 0.9824891090393066
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.360 Vali Acc: 0.939 Test Loss: 0.360 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2947096824645996
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.313 Vali Acc: 0.928 Test Loss: 0.313 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2118210792541504
Epoch: 44, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9994747638702393
Epoch: 45, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2911949157714844
Epoch: 46, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0366685390472412
Epoch: 47, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2369089126586914
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.683 Vali Acc: 0.883 Test Loss: 0.683 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.218684434890747
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.382 Vali Acc: 0.928 Test Loss: 0.382 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.091606616973877
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.432 Vali Acc: 0.894 Test Loss: 0.432 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 36943110
model size : 155.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8024799823760986
Epoch: 1, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.649 Vali Acc: 0.328 Test Loss: 1.649 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 0.9345479011535645
Epoch: 2, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.358 Vali Acc: 0.622 Test Loss: 1.358 Test Acc: 0.622
Validation loss decreased (-0.327761 --> -0.622209).  Saving model ...
Epoch: 3 cost time: 1.199394702911377
Epoch: 3, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.033 Vali Acc: 0.717 Test Loss: 1.033 Test Acc: 0.717
Validation loss decreased (-0.622209 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 0.9882314205169678
Epoch: 4, Steps: 12 | Train Loss: 0.927 Vali Loss: 0.760 Vali Acc: 0.700 Test Loss: 0.760 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1013131141662598
Epoch: 5, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.574 Vali Acc: 0.733 Test Loss: 0.574 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733328).  Saving model ...
Epoch: 6 cost time: 0.995128870010376
Epoch: 6, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.489 Vali Acc: 0.767 Test Loss: 0.489 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 1.0915684700012207
Epoch: 7, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.435 Vali Acc: 0.756 Test Loss: 0.435 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9404478073120117
Epoch: 8, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.384 Vali Acc: 0.800 Test Loss: 0.384 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 0.9413125514984131
Epoch: 9, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.1357178688049316
Epoch: 10, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 0.9065563678741455
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 12 cost time: 1.0029523372650146
Epoch: 12, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 1.1757550239562988
Epoch: 13, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9206609725952148
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1261136531829834
Epoch: 15, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.1052882671356201
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 1.061457633972168
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.004032850265503
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.261 Vali Acc: 0.867 Test Loss: 0.261 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1575868129730225
Epoch: 19, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.104741096496582
Epoch: 20, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 1.1903660297393799
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0704329013824463
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.244 Vali Acc: 0.872 Test Loss: 0.244 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.007723093032837
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.208 Vali Acc: 0.900 Test Loss: 0.208 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899998).  Saving model ...
Epoch: 24 cost time: 1.1115834712982178
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.185 Vali Acc: 0.911 Test Loss: 0.185 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 1.1207218170166016
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2891099452972412
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0626840591430664
Epoch: 27, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.366 Vali Acc: 0.872 Test Loss: 0.366 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9085268974304199
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.189 Vali Acc: 0.894 Test Loss: 0.189 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1449062824249268
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 30 cost time: 1.1163110733032227
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1407954692840576
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0426454544067383
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0393199920654297
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1852588653564453
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9850058555603027
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0851609706878662
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0904541015625
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0284509658813477
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1271426677703857
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 36924678
model size : 155.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3765499591827393
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.541 Vali Acc: 0.433 Test Loss: 1.541 Test Acc: 0.433
Validation loss decreased (inf --> -0.433318).  Saving model ...
Epoch: 2 cost time: 2.3058888912200928
Epoch: 2, Steps: 12 | Train Loss: 1.284 Vali Loss: 0.951 Vali Acc: 0.733 Test Loss: 0.951 Test Acc: 0.733
Validation loss decreased (-0.433318 --> -0.733324).  Saving model ...
Epoch: 3 cost time: 2.027618169784546
Epoch: 3, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.655 Vali Acc: 0.733 Test Loss: 0.655 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733327).  Saving model ...
Epoch: 4 cost time: 1.7013659477233887
Epoch: 4, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
Validation loss decreased (-0.733327 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.907907485961914
Epoch: 5, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.517 Vali Acc: 0.778 Test Loss: 0.517 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.178340435028076
Epoch: 6, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.6581389904022217
Epoch: 7, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.344 Vali Acc: 0.822 Test Loss: 0.344 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 8 cost time: 2.009422540664673
Epoch: 8, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.822219 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 2.0772390365600586
Epoch: 9, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6415281295776367
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0974514484405518
Epoch: 11, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.886575698852539
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.483 Vali Acc: 0.839 Test Loss: 0.483 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6250464916229248
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
Validation loss decreased (-0.866664 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 2.0989716053009033
Epoch: 14, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.391 Vali Acc: 0.883 Test Loss: 0.391 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.016263961791992
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8921289443969727
Epoch: 16, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.193126916885376
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.351 Vali Acc: 0.894 Test Loss: 0.351 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8267138004302979
Epoch: 18, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.005997657775879
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.391 Vali Acc: 0.933 Test Loss: 0.391 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933329).  Saving model ...
Epoch: 20 cost time: 2.0947329998016357
Epoch: 20, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7225897312164307
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.375 Vali Acc: 0.928 Test Loss: 0.375 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6905882358551025
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.599 Vali Acc: 0.933 Test Loss: 0.599 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3573954105377197
Epoch: 23, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.559 Vali Acc: 0.906 Test Loss: 0.559 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.40000581741333
Epoch: 24, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.438 Vali Acc: 0.939 Test Loss: 0.438 Test Acc: 0.939
Validation loss decreased (-0.933329 --> -0.938885).  Saving model ...
Epoch: 25 cost time: 1.528038501739502
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.405 Vali Acc: 0.944 Test Loss: 0.405 Test Acc: 0.944
Validation loss decreased (-0.938885 --> -0.944440).  Saving model ...
Epoch: 26 cost time: 1.7711472511291504
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.484 Vali Acc: 0.939 Test Loss: 0.484 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8123257160186768
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.501 Vali Acc: 0.911 Test Loss: 0.501 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.859905481338501
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.526 Vali Acc: 0.911 Test Loss: 0.526 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7670259475708008
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.928 Test Loss: 0.300 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8480889797210693
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.485 Vali Acc: 0.944 Test Loss: 0.485 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7533650398254395
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.444 Vali Acc: 0.922 Test Loss: 0.444 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5401175022125244
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.352 Vali Acc: 0.944 Test Loss: 0.352 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 33 cost time: 1.7646420001983643
Epoch: 33, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.059 Vali Acc: 0.917 Test Loss: 1.059 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1748359203338623
Epoch: 34, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.430 Vali Acc: 0.928 Test Loss: 0.430 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7019932270050049
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.469 Vali Acc: 0.944 Test Loss: 0.469 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.9225685596466064
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.933 Test Loss: 0.770 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5542340278625488
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.055 Vali Acc: 0.900 Test Loss: 1.055 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6178698539733887
Epoch: 38, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.301 Vali Acc: 0.917 Test Loss: 1.301 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.9290390014648438
Epoch: 39, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.447 Vali Acc: 0.961 Test Loss: 0.447 Test Acc: 0.961
Validation loss decreased (-0.944441 --> -0.961107).  Saving model ...
Epoch: 40 cost time: 2.0399413108825684
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.455 Vali Acc: 0.928 Test Loss: 0.455 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9623565673828125
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.105 Vali Acc: 0.933 Test Loss: 1.105 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.190608501434326
Epoch: 42, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.311 Vali Acc: 0.939 Test Loss: 0.311 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9107012748718262
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.208 Vali Acc: 0.922 Test Loss: 1.208 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.2375972270965576
Epoch: 44, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.646 Vali Acc: 0.928 Test Loss: 0.646 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7733631134033203
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.092 Vali Acc: 0.900 Test Loss: 1.092 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.1508772373199463
Epoch: 46, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.331 Vali Acc: 0.911 Test Loss: 1.331 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.605553388595581
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.701 Vali Acc: 0.911 Test Loss: 0.701 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.7807466983795166
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.939 Test Loss: 0.603 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.9655952453613281
Epoch: 49, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.072 Vali Acc: 0.906 Test Loss: 1.072 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 29670918
model size : 127.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6195967197418213
Epoch: 1, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.608 Vali Acc: 0.433 Test Loss: 1.608 Test Acc: 0.433
Validation loss decreased (inf --> -0.433317).  Saving model ...
Epoch: 2 cost time: 1.1801578998565674
Epoch: 2, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.163 Vali Acc: 0.722 Test Loss: 1.163 Test Acc: 0.722
Validation loss decreased (-0.433317 --> -0.722211).  Saving model ...
Epoch: 3 cost time: 1.697014331817627
Epoch: 3, Steps: 12 | Train Loss: 0.985 Vali Loss: 0.770 Vali Acc: 0.761 Test Loss: 0.770 Test Acc: 0.761
Validation loss decreased (-0.722211 --> -0.761103).  Saving model ...
Epoch: 4 cost time: 1.257157802581787
Epoch: 4, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.552 Vali Acc: 0.739 Test Loss: 0.552 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6287319660186768
Epoch: 5, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.435 Vali Acc: 0.778 Test Loss: 0.435 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.2925124168395996
Epoch: 6, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.461 Vali Acc: 0.772 Test Loss: 0.461 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4236009120941162
Epoch: 7, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
Validation loss decreased (-0.777773 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 1.5073859691619873
Epoch: 8, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3506696224212646
Epoch: 9, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.503 Vali Acc: 0.828 Test Loss: 0.503 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7808701992034912
Epoch: 10, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.443 Vali Acc: 0.839 Test Loss: 0.443 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4719631671905518
Epoch: 11, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3525402545928955
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.253 Vali Acc: 0.861 Test Loss: 0.253 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861109).  Saving model ...
Epoch: 13 cost time: 1.6457831859588623
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.256 Vali Acc: 0.872 Test Loss: 0.256 Test Acc: 0.872
Validation loss decreased (-0.861109 --> -0.872220).  Saving model ...
Epoch: 14 cost time: 1.2958524227142334
Epoch: 14, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.204 Vali Acc: 0.883 Test Loss: 0.204 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 1.4514172077178955
Epoch: 15, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.154 Vali Acc: 0.922 Test Loss: 0.154 Test Acc: 0.922
Validation loss decreased (-0.883331 --> -0.922221).  Saving model ...
Epoch: 16 cost time: 1.3294000625610352
Epoch: 16, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5249693393707275
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.141343116760254
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7700071334838867
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.466 Vali Acc: 0.867 Test Loss: 0.466 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4816653728485107
Epoch: 20, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.387 Vali Acc: 0.906 Test Loss: 0.387 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.908811330795288
Epoch: 21, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.333343505859375
Epoch: 22, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.443 Vali Acc: 0.894 Test Loss: 0.443 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7333166599273682
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4627001285552979
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.453 Vali Acc: 0.906 Test Loss: 0.453 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.842165231704712
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.911 Vali Acc: 0.872 Test Loss: 0.911 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 29523462
model size : 127.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2670257091522217
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.655 Vali Acc: 0.428 Test Loss: 1.655 Test Acc: 0.428
Validation loss decreased (inf --> -0.427761).  Saving model ...
Epoch: 2 cost time: 1.4224681854248047
Epoch: 2, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.316 Vali Acc: 0.689 Test Loss: 1.316 Test Acc: 0.689
Validation loss decreased (-0.427761 --> -0.688876).  Saving model ...
Epoch: 3 cost time: 1.0896754264831543
Epoch: 3, Steps: 12 | Train Loss: 1.159 Vali Loss: 0.918 Vali Acc: 0.722 Test Loss: 0.918 Test Acc: 0.722
Validation loss decreased (-0.688876 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 1.3976447582244873
Epoch: 4, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.632 Vali Acc: 0.711 Test Loss: 0.632 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.409712791442871
Epoch: 5, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.497 Vali Acc: 0.778 Test Loss: 0.497 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.4017393589019775
Epoch: 6, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.446 Vali Acc: 0.811 Test Loss: 0.446 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.3329832553863525
Epoch: 7, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.348 Vali Acc: 0.811 Test Loss: 0.348 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 8 cost time: 1.0083441734313965
Epoch: 8, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.811108 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.0830340385437012
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883331).  Saving model ...
Epoch: 10 cost time: 1.0580370426177979
Epoch: 10, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9942593574523926
Epoch: 11, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3192517757415771
Epoch: 12, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3106229305267334
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2269341945648193
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.163 Vali Acc: 0.928 Test Loss: 0.163 Test Acc: 0.928
Validation loss decreased (-0.883331 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 1.2687461376190186
Epoch: 15, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2584991455078125
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2409851551055908
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7200140953063965
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3473904132843018
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.830550193786621
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.154 Vali Acc: 0.928 Test Loss: 0.154 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 1.332348108291626
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.844886302947998
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2491438388824463
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2615776062011719
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.922 Test Loss: 0.174 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8227167129516602
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3863739967346191
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3054356575012207
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8236863613128662
Epoch: 28, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.436 Vali Acc: 0.906 Test Loss: 0.436 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3376655578613281
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6286113262176514
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 29474310
model size : 127.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.973602294921875
Epoch: 1, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.441 Vali Acc: 0.550 Test Loss: 1.441 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 1.8566663265228271
Epoch: 2, Steps: 12 | Train Loss: 1.208 Vali Loss: 0.913 Vali Acc: 0.722 Test Loss: 0.913 Test Acc: 0.722
Validation loss decreased (-0.549986 --> -0.722213).  Saving model ...
Epoch: 3 cost time: 1.7215232849121094
Epoch: 3, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.656 Vali Acc: 0.683 Test Loss: 0.656 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8485133647918701
Epoch: 4, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.548 Vali Acc: 0.717 Test Loss: 0.548 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2190444469451904
Epoch: 5, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
Validation loss decreased (-0.722213 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 2.1091341972351074
Epoch: 6, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.0110321044921875
Epoch: 7, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7399401664733887
Epoch: 8, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.656 Vali Acc: 0.811 Test Loss: 0.656 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.197680950164795
Epoch: 9, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.880 Vali Acc: 0.817 Test Loss: 0.880 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9066238403320312
Epoch: 10, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8729674816131592
Epoch: 11, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.16924786567688
Epoch: 12, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.374 Vali Acc: 0.856 Test Loss: 0.374 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.1106770038604736
Epoch: 13, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.384 Vali Acc: 0.844 Test Loss: 0.384 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8895113468170166
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.441 Vali Acc: 0.861 Test Loss: 0.441 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 1.6721997261047363
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872216).  Saving model ...
Epoch: 16 cost time: 1.0982005596160889
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.582751989364624
Epoch: 17, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.872216 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.575256586074829
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.725 Vali Acc: 0.867 Test Loss: 0.725 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6002533435821533
Epoch: 19, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.051 Vali Acc: 0.856 Test Loss: 1.051 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6360266208648682
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.045 Vali Acc: 0.878 Test Loss: 1.045 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6017403602600098
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.689 Vali Acc: 0.872 Test Loss: 0.689 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7655694484710693
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.772 Vali Acc: 0.867 Test Loss: 0.772 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9842448234558105
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.395 Vali Acc: 0.883 Test Loss: 0.395 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.763073205947876
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.330 Vali Acc: 0.828 Test Loss: 1.330 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.062541961669922
Epoch: 25, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.422 Vali Acc: 0.894 Test Loss: 0.422 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.561903476715088
Epoch: 26, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.381 Vali Acc: 0.894 Test Loss: 0.381 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.141742467880249
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 29720070
model size : 128.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.824444532394409
Epoch: 1, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.486 Vali Acc: 0.550 Test Loss: 1.486 Test Acc: 0.550
Validation loss decreased (inf --> -0.549985).  Saving model ...
Epoch: 2 cost time: 1.7488229274749756
Epoch: 2, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.072 Vali Acc: 0.633 Test Loss: 1.072 Test Acc: 0.633
Validation loss decreased (-0.549985 --> -0.633323).  Saving model ...
Epoch: 3 cost time: 1.6936607360839844
Epoch: 3, Steps: 12 | Train Loss: 0.947 Vali Loss: 0.748 Vali Acc: 0.683 Test Loss: 0.748 Test Acc: 0.683
Validation loss decreased (-0.633323 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.3755629062652588
Epoch: 4, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.575 Vali Acc: 0.772 Test Loss: 0.575 Test Acc: 0.772
Validation loss decreased (-0.683326 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 1.777587890625
Epoch: 5, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.487 Vali Acc: 0.756 Test Loss: 0.487 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5483920574188232
Epoch: 6, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.465 Vali Acc: 0.794 Test Loss: 0.465 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.6856143474578857
Epoch: 7, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.469 Vali Acc: 0.794 Test Loss: 0.469 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5656094551086426
Epoch: 8, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.507 Vali Acc: 0.811 Test Loss: 0.507 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811106).  Saving model ...
Epoch: 9 cost time: 1.887230634689331
Epoch: 9, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
Validation loss decreased (-0.811106 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.6698956489562988
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.858564853668213
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4755024909973145
Epoch: 12, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8961701393127441
Epoch: 13, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866662).  Saving model ...
Epoch: 14 cost time: 1.4818718433380127
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 1.8828177452087402
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5773460865020752
Epoch: 16, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5346128940582275
Epoch: 17, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9153952598571777
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.671 Vali Acc: 0.872 Test Loss: 0.671 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6514546871185303
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 1.894104242324829
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6651067733764648
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.937385082244873
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5598807334899902
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.522 Vali Acc: 0.894 Test Loss: 0.522 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.059241771697998
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7081646919250488
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.221 Vali Acc: 0.850 Test Loss: 1.221 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7755377292633057
Epoch: 26, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.6020269393920898
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.410 Vali Acc: 0.878 Test Loss: 0.410 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8776874542236328
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8292768001556396
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.481 Vali Acc: 0.917 Test Loss: 0.481 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8376474380493164
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.373 Vali Acc: 0.928 Test Loss: 0.373 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927774).  Saving model ...
Epoch: 31 cost time: 1.6232938766479492
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9976856708526611
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6713602542877197
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.664 Vali Acc: 0.889 Test Loss: 0.664 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.004380941390991
Epoch: 34, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4859943389892578
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.670746088027954
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.393 Vali Acc: 0.922 Test Loss: 0.393 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.766791820526123
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.366 Vali Acc: 0.894 Test Loss: 0.366 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3930211067199707
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8157062530517578
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.521 Vali Acc: 0.894 Test Loss: 0.521 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5602350234985352
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.569 Vali Acc: 0.883 Test Loss: 0.569 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 29572614
model size : 127.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.721926689147949
Epoch: 1, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.691 Vali Acc: 0.278 Test Loss: 1.691 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 1.0522737503051758
Epoch: 2, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.394 Vali Acc: 0.622 Test Loss: 1.394 Test Acc: 0.622
Validation loss decreased (-0.277761 --> -0.622208).  Saving model ...
Epoch: 3 cost time: 1.0498387813568115
Epoch: 3, Steps: 12 | Train Loss: 1.317 Vali Loss: 0.998 Vali Acc: 0.661 Test Loss: 0.998 Test Acc: 0.661
Validation loss decreased (-0.622208 --> -0.661101).  Saving model ...
Epoch: 4 cost time: 0.8876795768737793
Epoch: 4, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.691 Vali Acc: 0.744 Test Loss: 0.691 Test Acc: 0.744
Validation loss decreased (-0.661101 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 1.0571153163909912
Epoch: 5, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 0.9921431541442871
Epoch: 6, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.504 Vali Acc: 0.756 Test Loss: 0.504 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755551).  Saving model ...
Epoch: 7 cost time: 0.964977502822876
Epoch: 7, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.416 Vali Acc: 0.778 Test Loss: 0.416 Test Acc: 0.778
Validation loss decreased (-0.755551 --> -0.777774).  Saving model ...
Epoch: 8 cost time: 1.003230333328247
Epoch: 8, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.400 Vali Acc: 0.806 Test Loss: 0.400 Test Acc: 0.806
Validation loss decreased (-0.777774 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 0.8514418601989746
Epoch: 9, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9043529033660889
Epoch: 10, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.334141492843628
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.078836441040039
Epoch: 12, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 1.2255373001098633
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.547 Vali Acc: 0.817 Test Loss: 0.547 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9599275588989258
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9451673030853271
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.362 Vali Acc: 0.883 Test Loss: 0.362 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 1.267482042312622
Epoch: 16, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.0580284595489502
Epoch: 17, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.369 Vali Acc: 0.883 Test Loss: 0.369 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9894261360168457
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.367 Vali Acc: 0.906 Test Loss: 0.367 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 1.2297956943511963
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.409 Vali Acc: 0.906 Test Loss: 0.409 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1102845668792725
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9497311115264893
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3990345001220703
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3133435249328613
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1268260478973389
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3237483501434326
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.362 Vali Acc: 0.883 Test Loss: 0.362 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.177945852279663
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0927484035491943
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.365910291671753
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 29 cost time: 1.2600936889648438
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.443 Vali Acc: 0.917 Test Loss: 0.443 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916662).  Saving model ...
Epoch: 30 cost time: 1.0373055934906006
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2716422080993652
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 32 cost time: 1.0262835025787354
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0411505699157715
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.410 Vali Acc: 0.894 Test Loss: 0.410 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2629179954528809
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.07027268409729
Epoch: 35, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 1.2671608924865723
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1270430088043213
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.409 Vali Acc: 0.917 Test Loss: 0.409 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.021747350692749
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.365 Vali Acc: 0.906 Test Loss: 0.365 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2362091541290283
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.094055414199829
Epoch: 40, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2329490184783936
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3210866451263428
Epoch: 42, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.469 Vali Acc: 0.922 Test Loss: 0.469 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1164586544036865
Epoch: 43, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.087 Vali Acc: 0.861 Test Loss: 1.087 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2025766372680664
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.529 Vali Acc: 0.894 Test Loss: 0.529 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.027587652206421
Epoch: 45, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.682 Vali Acc: 0.894 Test Loss: 0.682 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 29498886
model size : 127.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1469452381134033
Epoch: 1, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.622 Vali Acc: 0.456 Test Loss: 1.622 Test Acc: 0.456
Validation loss decreased (inf --> -0.455539).  Saving model ...
Epoch: 2 cost time: 1.3599789142608643
Epoch: 2, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.151 Vali Acc: 0.639 Test Loss: 1.151 Test Acc: 0.639
Validation loss decreased (-0.455539 --> -0.638877).  Saving model ...
Epoch: 3 cost time: 1.65980863571167
Epoch: 3, Steps: 12 | Train Loss: 0.946 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
Validation loss decreased (-0.638877 --> -0.722216).  Saving model ...
Epoch: 4 cost time: 1.363948106765747
Epoch: 4, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.510 Vali Acc: 0.750 Test Loss: 0.510 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 1.8478317260742188
Epoch: 5, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.373 Vali Acc: 0.789 Test Loss: 0.373 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 1.4248523712158203
Epoch: 6, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
Validation loss decreased (-0.788885 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 1.8082146644592285
Epoch: 7, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5370430946350098
Epoch: 8, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.849997 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.2746269702911377
Epoch: 9, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.620 Vali Acc: 0.789 Test Loss: 0.620 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7404754161834717
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.275 Vali Acc: 0.839 Test Loss: 0.275 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3554301261901855
Epoch: 11, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2463438510894775
Epoch: 12, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.191 Vali Acc: 0.900 Test Loss: 0.191 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 13 cost time: 1.8429005146026611
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.401219129562378
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.400 Vali Acc: 0.872 Test Loss: 0.400 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8223810195922852
Epoch: 15, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.653322696685791
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.657 Vali Acc: 0.883 Test Loss: 0.657 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8023271560668945
Epoch: 17, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.61734938621521
Epoch: 18, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.551 Vali Acc: 0.883 Test Loss: 0.551 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7945384979248047
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.5376477241516113
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.542 Vali Acc: 0.917 Test Loss: 0.542 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8954782485961914
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.486 Vali Acc: 0.894 Test Loss: 0.486 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7157297134399414
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.487 Vali Acc: 0.872 Test Loss: 0.487 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2550389766693115
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.802 Vali Acc: 0.906 Test Loss: 0.802 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9164671897888184
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5497913360595703
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.696 Vali Acc: 0.894 Test Loss: 0.696 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7844595909118652
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.612 Vali Acc: 0.906 Test Loss: 0.612 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.598700761795044
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.452 Vali Acc: 0.906 Test Loss: 0.452 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9208436012268066
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.663 Vali Acc: 0.889 Test Loss: 0.663 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6633059978485107
Epoch: 29, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.665 Vali Acc: 0.917 Test Loss: 0.665 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 29627910
model size : 127.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2559638023376465
Epoch: 1, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.560 Vali Acc: 0.550 Test Loss: 1.560 Test Acc: 0.550
Validation loss decreased (inf --> -0.549984).  Saving model ...
Epoch: 2 cost time: 1.375842571258545
Epoch: 2, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.205 Vali Acc: 0.600 Test Loss: 1.205 Test Acc: 0.600
Validation loss decreased (-0.549984 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.0572450160980225
Epoch: 3, Steps: 12 | Train Loss: 1.083 Vali Loss: 0.805 Vali Acc: 0.689 Test Loss: 0.805 Test Acc: 0.689
Validation loss decreased (-0.599988 --> -0.688881).  Saving model ...
Epoch: 4 cost time: 1.355858564376831
Epoch: 4, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.554 Vali Acc: 0.744 Test Loss: 0.554 Test Acc: 0.744
Validation loss decreased (-0.688881 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.3741869926452637
Epoch: 5, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.451 Vali Acc: 0.756 Test Loss: 0.451 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755551).  Saving model ...
Epoch: 6 cost time: 1.3493447303771973
Epoch: 6, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.416 Vali Acc: 0.817 Test Loss: 0.416 Test Acc: 0.817
Validation loss decreased (-0.755551 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.3399903774261475
Epoch: 7, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.351897954940796
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.3001909255981445
Epoch: 9, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844442).  Saving model ...
Epoch: 10 cost time: 1.2938435077667236
Epoch: 10, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
Validation loss decreased (-0.844442 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.2824621200561523
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 1.1033899784088135
Epoch: 12, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.269 Vali Acc: 0.856 Test Loss: 0.269 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.181445837020874
Epoch: 13, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8825967311859131
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.203312873840332
Epoch: 15, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.9928202629089355
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3383605480194092
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.2758877277374268
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3120217323303223
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.331007957458496
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.358 Vali Acc: 0.878 Test Loss: 0.358 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3134911060333252
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3421971797943115
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.690 Vali Acc: 0.878 Test Loss: 0.690 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7687904834747314
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 1.270589828491211
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.589 Vali Acc: 0.911 Test Loss: 0.589 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7681910991668701
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.378 Vali Acc: 0.939 Test Loss: 0.378 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938885).  Saving model ...
Epoch: 26 cost time: 1.1516916751861572
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4082608222961426
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.469 Vali Acc: 0.906 Test Loss: 0.469 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7825345993041992
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5457916259765625
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3130972385406494
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.416 Vali Acc: 0.928 Test Loss: 0.416 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8786060810089111
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.987 Vali Acc: 0.917 Test Loss: 0.987 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4402666091918945
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3967492580413818
Epoch: 33, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.808 Vali Acc: 0.894 Test Loss: 0.808 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8114330768585205
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.494 Vali Acc: 0.917 Test Loss: 0.494 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.457529067993164
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 29578758
model size : 127.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8782432079315186
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.653 Vali Acc: 0.406 Test Loss: 1.653 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 1.2443957328796387
Epoch: 2, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.393 Vali Acc: 0.656 Test Loss: 1.393 Test Acc: 0.656
Validation loss decreased (-0.405539 --> -0.655542).  Saving model ...
Epoch: 3 cost time: 1.0085198879241943
Epoch: 3, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.049 Vali Acc: 0.744 Test Loss: 1.049 Test Acc: 0.744
Validation loss decreased (-0.655542 --> -0.744434).  Saving model ...
Epoch: 4 cost time: 0.8878095149993896
Epoch: 4, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.693 Vali Acc: 0.728 Test Loss: 0.693 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.085308313369751
Epoch: 5, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.505 Vali Acc: 0.744 Test Loss: 0.505 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 1.2143712043762207
Epoch: 6, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.434 Vali Acc: 0.778 Test Loss: 0.434 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 1.06827974319458
Epoch: 7, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.349 Vali Acc: 0.811 Test Loss: 0.349 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811108).  Saving model ...
Epoch: 8 cost time: 1.230320930480957
Epoch: 8, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
Validation loss decreased (-0.811108 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 0.9245572090148926
Epoch: 9, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.2751414775848389
Epoch: 10, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 0.8729248046875
Epoch: 11, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0843462944030762
Epoch: 12, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.167529821395874
Epoch: 13, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.483 Vali Acc: 0.828 Test Loss: 0.483 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.06557035446167
Epoch: 14, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.231990098953247
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.200 Vali Acc: 0.878 Test Loss: 0.200 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877776).  Saving model ...
Epoch: 16 cost time: 1.0417201519012451
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.877776 --> -0.911109).  Saving model ...
Epoch: 17 cost time: 1.1733088493347168
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9976210594177246
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0162127017974854
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.1430134773254395
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.872002363204956
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.163 Vali Acc: 0.928 Test Loss: 0.163 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 1.0239677429199219
Epoch: 22, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7416741847991943
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9836058616638184
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7611880302429199
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9546732902526855
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.86324143409729
Epoch: 27, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2508904933929443
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0489530563354492
Epoch: 29, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9448065757751465
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1191773414611816
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.9335799217224121
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9361288547515869
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.336 Vali Acc: 0.939 Test Loss: 0.336 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 34 cost time: 1.252936840057373
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8708388805389404
Epoch: 35, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0395901203155518
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2369389533996582
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.333 Vali Acc: 0.928 Test Loss: 0.333 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0149474143981934
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.938886 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.1878933906555176
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9809505939483643
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.939 Test Loss: 0.253 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9904942512512207
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2791779041290283
Epoch: 42, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.115950584411621
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1346478462219238
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3259804248809814
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.767 Vali Acc: 0.917 Test Loss: 0.767 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0686354637145996
Epoch: 46, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2846934795379639
Epoch: 47, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.39439058303833
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.939 Test Loss: 0.257 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 29541894
model size : 127.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4470505714416504
Epoch: 1, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.647 Vali Acc: 0.367 Test Loss: 1.647 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 1.2008440494537354
Epoch: 2, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.143 Vali Acc: 0.661 Test Loss: 1.143 Test Acc: 0.661
Validation loss decreased (-0.366650 --> -0.661100).  Saving model ...
Epoch: 3 cost time: 1.4815406799316406
Epoch: 3, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.668 Vali Acc: 0.711 Test Loss: 0.668 Test Acc: 0.711
Validation loss decreased (-0.661100 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 1.4996695518493652
Epoch: 4, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.461 Vali Acc: 0.739 Test Loss: 0.461 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738884).  Saving model ...
Epoch: 5 cost time: 1.3972764015197754
Epoch: 5, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
Validation loss decreased (-0.738884 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.454749345779419
Epoch: 6, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.265 Vali Acc: 0.867 Test Loss: 0.265 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 7 cost time: 1.489851713180542
Epoch: 7, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4451918601989746
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.302 Vali Acc: 0.822 Test Loss: 0.302 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2168774604797363
Epoch: 9, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4889535903930664
Epoch: 10, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.413 Vali Acc: 0.839 Test Loss: 0.413 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4846405982971191
Epoch: 11, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.474 Vali Acc: 0.822 Test Loss: 0.474 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.432809829711914
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.372 Vali Acc: 0.856 Test Loss: 0.372 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.486302137374878
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 14 cost time: 1.2905316352844238
Epoch: 14, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.3948407173156738
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.305220127105713
Epoch: 16, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.3474128246307373
Epoch: 17, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 1.3565382957458496
Epoch: 18, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7927677631378174
Epoch: 19, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8986821174621582
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4674248695373535
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7507264614105225
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.375 Vali Acc: 0.928 Test Loss: 0.375 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927774).  Saving model ...
Epoch: 23 cost time: 1.4203300476074219
Epoch: 23, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9891641139984131
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.587 Vali Acc: 0.906 Test Loss: 0.587 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.815950632095337
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6103119850158691
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.742 Vali Acc: 0.889 Test Loss: 0.742 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.245089054107666
Epoch: 27, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.913 Vali Acc: 0.861 Test Loss: 0.913 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8286714553833008
Epoch: 28, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8311567306518555
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.550739049911499
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8697552680969238
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.911 Test Loss: 0.590 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5493178367614746
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.341 Vali Acc: 0.928 Test Loss: 0.341 Test Acc: 0.928
Validation loss decreased (-0.927774 --> -0.927774).  Saving model ...
Epoch: 33 cost time: 1.3824448585510254
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.721 Vali Acc: 0.906 Test Loss: 0.721 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8466863632202148
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.651 Vali Acc: 0.894 Test Loss: 0.651 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2752528190612793
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
Validation loss decreased (-0.927774 --> -0.927775).  Saving model ...
Epoch: 36 cost time: 1.3956074714660645
Epoch: 36, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.164 Vali Acc: 0.911 Test Loss: 1.164 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.318504810333252
Epoch: 37, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.377 Vali Acc: 0.906 Test Loss: 0.377 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.906219244003296
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6376748085021973
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.543 Vali Acc: 0.933 Test Loss: 0.543 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933328).  Saving model ...
Epoch: 40 cost time: 1.3555305004119873
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.433 Vali Acc: 0.928 Test Loss: 0.433 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9323527812957764
Epoch: 41, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.336 Vali Acc: 0.928 Test Loss: 0.336 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.677473783493042
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.770 Vali Acc: 0.911 Test Loss: 0.770 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7941479682922363
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 1.4872322082519531
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.928 Test Loss: 0.385 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8901803493499756
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.834 Vali Acc: 0.900 Test Loss: 0.834 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.609118938446045
Epoch: 46, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.286 Vali Acc: 0.928 Test Loss: 0.286 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4737882614135742
Epoch: 47, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.484 Vali Acc: 0.917 Test Loss: 0.484 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.832862138748169
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.922 Test Loss: 0.716 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.8570024967193604
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.814 Vali Acc: 0.911 Test Loss: 0.814 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6442816257476807
Epoch: 50, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.483 Vali Acc: 0.911 Test Loss: 0.483 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 29677062
model size : 127.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5098438262939453
Epoch: 1, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.673 Vali Acc: 0.333 Test Loss: 1.673 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 1.7844829559326172
Epoch: 2, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.288 Vali Acc: 0.583 Test Loss: 1.288 Test Acc: 0.583
Validation loss decreased (-0.333317 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 1.6033289432525635
Epoch: 3, Steps: 12 | Train Loss: 1.081 Vali Loss: 0.839 Vali Acc: 0.739 Test Loss: 0.839 Test Acc: 0.739
Validation loss decreased (-0.583320 --> -0.738880).  Saving model ...
Epoch: 4 cost time: 1.4666569232940674
Epoch: 4, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.529 Vali Acc: 0.772 Test Loss: 0.529 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 1.576953411102295
Epoch: 5, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.427 Vali Acc: 0.772 Test Loss: 0.427 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772218).  Saving model ...
Epoch: 6 cost time: 1.9038681983947754
Epoch: 6, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
Validation loss decreased (-0.772218 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 1.3228800296783447
Epoch: 7, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1754486560821533
Epoch: 8, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.270 Vali Acc: 0.856 Test Loss: 0.270 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 1.7993485927581787
Epoch: 9, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3773982524871826
Epoch: 10, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.8015453815460205
Epoch: 11, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5682373046875
Epoch: 12, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 1.7576889991760254
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.6459581851959229
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.784492015838623
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.575385332107544
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 1.8433701992034912
Epoch: 17, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.209 Vali Acc: 0.894 Test Loss: 0.209 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4910695552825928
Epoch: 18, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.630 Vali Acc: 0.906 Test Loss: 0.630 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5837962627410889
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.1391863822937012
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.403 Vali Acc: 0.906 Test Loss: 0.403 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0328259468078613
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0135776996612549
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.574 Vali Acc: 0.894 Test Loss: 0.574 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.004185676574707
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8177094459533691
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1980857849121094
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.178 Vali Acc: 0.922 Test Loss: 0.178 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.0603740215301514
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2131786346435547
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 1.2279951572418213
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 1.3289823532104492
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.928 Test Loss: 0.275 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.195826768875122
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.363 Vali Acc: 0.928 Test Loss: 0.363 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3083229064941406
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.385401964187622
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3516268730163574
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.268967628479004
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.356858730316162
Epoch: 35, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.381 Vali Acc: 0.939 Test Loss: 0.381 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3498737812042236
Epoch: 36, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.924 Vali Acc: 0.883 Test Loss: 0.924 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3640878200531006
Epoch: 37, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.458 Vali Acc: 0.850 Test Loss: 1.458 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3889379501342773
Epoch: 38, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 29634054
model size : 127.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9179913997650146
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.731 Vali Acc: 0.261 Test Loss: 1.731 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.0383830070495605
Epoch: 2, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.498 Vali Acc: 0.461 Test Loss: 1.498 Test Acc: 0.461
Validation loss decreased (-0.261094 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 0.8447582721710205
Epoch: 3, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.116 Vali Acc: 0.667 Test Loss: 1.116 Test Acc: 0.667
Validation loss decreased (-0.461096 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 1.0662155151367188
Epoch: 4, Steps: 12 | Train Loss: 0.975 Vali Loss: 0.730 Vali Acc: 0.744 Test Loss: 0.730 Test Acc: 0.744
Validation loss decreased (-0.666656 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 0.8622338771820068
Epoch: 5, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 0.7833104133605957
Epoch: 6, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.0922482013702393
Epoch: 7, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9530744552612305
Epoch: 8, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.9595944881439209
Epoch: 9, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.297 Vali Acc: 0.839 Test Loss: 0.297 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8363544940948486
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872220).  Saving model ...
Epoch: 11 cost time: 1.1080574989318848
Epoch: 11, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.380 Vali Acc: 0.856 Test Loss: 0.380 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1131079196929932
Epoch: 12, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.249 Vali Acc: 0.867 Test Loss: 0.249 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9256649017333984
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9225316047668457
Epoch: 14, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1356878280639648
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
Validation loss decreased (-0.872220 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 1.0904769897460938
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 1.0321476459503174
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9543695449829102
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8085377216339111
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.920529842376709
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 0.8940696716308594
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.237 Vali Acc: 0.861 Test Loss: 0.237 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0505151748657227
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0425245761871338
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.330 Vali Acc: 0.911 Test Loss: 0.330 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8879265785217285
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.886815071105957
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.015702724456787
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0064489841461182
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.925114631652832
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9581210613250732
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0119872093200684
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 29584902
model size : 127.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1673760414123535
Epoch: 1, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.623 Vali Acc: 0.378 Test Loss: 1.623 Test Acc: 0.378
Validation loss decreased (inf --> -0.377762).  Saving model ...
Epoch: 2 cost time: 1.3381781578063965
Epoch: 2, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.183 Vali Acc: 0.644 Test Loss: 1.183 Test Acc: 0.644
Validation loss decreased (-0.377762 --> -0.644433).  Saving model ...
Epoch: 3 cost time: 1.8645823001861572
Epoch: 3, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.772 Vali Acc: 0.628 Test Loss: 0.772 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3551843166351318
Epoch: 4, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.562 Vali Acc: 0.733 Test Loss: 0.562 Test Acc: 0.733
Validation loss decreased (-0.644433 --> -0.733328).  Saving model ...
Epoch: 5 cost time: 1.7938573360443115
Epoch: 5, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.471 Vali Acc: 0.767 Test Loss: 0.471 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 1.4183764457702637
Epoch: 6, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 1.8287556171417236
Epoch: 7, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.281 Vali Acc: 0.844 Test Loss: 0.281 Test Acc: 0.844
Validation loss decreased (-0.799995 --> -0.844442).  Saving model ...
Epoch: 8 cost time: 1.4652135372161865
Epoch: 8, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
Validation loss decreased (-0.844442 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 1.8456060886383057
Epoch: 9, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4627413749694824
Epoch: 10, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6495630741119385
Epoch: 11, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.230 Vali Acc: 0.894 Test Loss: 0.230 Test Acc: 0.894
Validation loss decreased (-0.849996 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 1.5219733715057373
Epoch: 12, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.173 Vali Acc: 0.928 Test Loss: 0.173 Test Acc: 0.928
Validation loss decreased (-0.894442 --> -0.927776).  Saving model ...
Epoch: 13 cost time: 1.7854621410369873
Epoch: 13, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.647139310836792
Epoch: 14, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
Validation loss decreased (-0.927776 --> -0.949999).  Saving model ...
Epoch: 15 cost time: 1.9247910976409912
Epoch: 15, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8135521411895752
Epoch: 16, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.138 Vali Acc: 0.928 Test Loss: 0.138 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.538853406906128
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7408816814422607
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4545247554779053
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9158470630645752
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.331 Vali Acc: 0.928 Test Loss: 0.331 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7833092212677002
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.566720724105835
Epoch: 22, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3511378765106201
Epoch: 23, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.674 Vali Acc: 0.894 Test Loss: 0.674 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7686512470245361
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 29732358
model size : 128.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9951283931732178
Epoch: 1, Steps: 12 | Train Loss: 1.899 Vali Loss: 1.697 Vali Acc: 0.328 Test Loss: 1.697 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.225358247756958
Epoch: 2, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.366 Vali Acc: 0.622 Test Loss: 1.366 Test Acc: 0.622
Validation loss decreased (-0.327761 --> -0.622209).  Saving model ...
Epoch: 3 cost time: 1.1239526271820068
Epoch: 3, Steps: 12 | Train Loss: 1.229 Vali Loss: 0.979 Vali Acc: 0.711 Test Loss: 0.979 Test Acc: 0.711
Validation loss decreased (-0.622209 --> -0.711101).  Saving model ...
Epoch: 4 cost time: 1.293748378753662
Epoch: 4, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.673 Vali Acc: 0.678 Test Loss: 0.673 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2577784061431885
Epoch: 5, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.534 Vali Acc: 0.767 Test Loss: 0.534 Test Acc: 0.767
Validation loss decreased (-0.711101 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 1.1297667026519775
Epoch: 6, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.380 Vali Acc: 0.783 Test Loss: 0.380 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783330).  Saving model ...
Epoch: 7 cost time: 0.9519124031066895
Epoch: 7, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.328 Vali Acc: 0.817 Test Loss: 0.328 Test Acc: 0.817
Validation loss decreased (-0.783330 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.2634737491607666
Epoch: 8, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2604954242706299
Epoch: 9, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
Validation loss decreased (-0.816663 --> -0.872220).  Saving model ...
Epoch: 10 cost time: 1.3238029479980469
Epoch: 10, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.257 Vali Acc: 0.844 Test Loss: 0.257 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.983997106552124
Epoch: 11, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9825644493103027
Epoch: 12, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9737122058868408
Epoch: 13, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.377 Vali Acc: 0.856 Test Loss: 0.377 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.28385329246521
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0062220096588135
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 1.279090404510498
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.0360419750213623
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.037402629852295
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.2887673377990723
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 20 cost time: 0.996131420135498
Epoch: 20, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3166546821594238
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9283382892608643
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1114144325256348
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2578544616699219
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1556262969970703
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 1.3017606735229492
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.577 Vali Acc: 0.928 Test Loss: 0.577 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1999647617340088
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1078367233276367
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2391529083251953
Epoch: 29, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.595 Vali Acc: 0.894 Test Loss: 0.595 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2690410614013672
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 1.3647053241729736
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.509 Vali Acc: 0.928 Test Loss: 0.509 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.242605447769165
Epoch: 32, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.633 Vali Acc: 0.861 Test Loss: 0.633 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0799298286437988
Epoch: 33, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3047471046447754
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2951843738555908
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.113731861114502
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3706004619598389
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.356 Vali Acc: 0.939 Test Loss: 0.356 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938885).  Saving model ...
Epoch: 38 cost time: 1.307471513748169
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0946235656738281
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.275 Vali Acc: 0.900 Test Loss: 1.275 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0354037284851074
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9834344387054443
Epoch: 41, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9854328632354736
Epoch: 42, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0672008991241455
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.938885 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.0664775371551514
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8604707717895508
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.059 Vali Acc: 0.861 Test Loss: 1.059 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1134779453277588
Epoch: 46, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.758 Vali Acc: 0.867 Test Loss: 0.758 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0240862369537354
Epoch: 47, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1348588466644287
Epoch: 48, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8395707607269287
Epoch: 49, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.425 Vali Acc: 0.939 Test Loss: 0.425 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0188524723052979
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 29664774
model size : 127.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7833645343780518
Epoch: 1, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.693 Vali Acc: 0.372 Test Loss: 1.693 Test Acc: 0.372
Validation loss decreased (inf --> -0.372205).  Saving model ...
Epoch: 2 cost time: 0.8223936557769775
Epoch: 2, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.441 Vali Acc: 0.617 Test Loss: 1.441 Test Acc: 0.617
Validation loss decreased (-0.372205 --> -0.616652).  Saving model ...
Epoch: 3 cost time: 1.0640342235565186
Epoch: 3, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.119 Vali Acc: 0.694 Test Loss: 1.119 Test Acc: 0.694
Validation loss decreased (-0.616652 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 0.9903163909912109
Epoch: 4, Steps: 12 | Train Loss: 1.044 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 1.0326530933380127
Epoch: 5, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.607 Vali Acc: 0.689 Test Loss: 0.607 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.113964319229126
Epoch: 6, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
Validation loss decreased (-0.716659 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 0.9614183902740479
Epoch: 7, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 0.8502528667449951
Epoch: 8, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.401 Vali Acc: 0.789 Test Loss: 0.401 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1146373748779297
Epoch: 9, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 0.9213588237762451
Epoch: 10, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 0.7961418628692627
Epoch: 11, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 0.9603157043457031
Epoch: 12, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.065237045288086
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.1089110374450684
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 0.8197977542877197
Epoch: 15, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0052874088287354
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8851528167724609
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7402744293212891
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0389492511749268
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 0.8440036773681641
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8183445930480957
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8157563209533691
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0072331428527832
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9134576320648193
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.0924007892608643
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.244 Vali Acc: 0.883 Test Loss: 0.244 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1376450061798096
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9311354160308838
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8880126476287842
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1002659797668457
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8743281364440918
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7539806365966797
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9315793514251709
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.9312911033630371
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9456958770751953
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9959042072296143
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1390302181243896
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1004276275634766
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0013055801391602
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1586542129516602
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0635669231414795
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9422214031219482
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.149726390838623
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.357 Vali Acc: 0.894 Test Loss: 0.357 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 29634054
model size : 127.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5474259853363037
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.526 Vali Acc: 0.578 Test Loss: 1.526 Test Acc: 0.578
Validation loss decreased (inf --> -0.577763).  Saving model ...
Epoch: 2 cost time: 1.4198968410491943
Epoch: 2, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
Validation loss decreased (-0.577763 --> -0.699990).  Saving model ...
Epoch: 3 cost time: 1.324657917022705
Epoch: 3, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.579 Vali Acc: 0.767 Test Loss: 0.579 Test Acc: 0.767
Validation loss decreased (-0.699990 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 1.8181838989257812
Epoch: 4, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.424 Vali Acc: 0.761 Test Loss: 0.424 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3084166049957275
Epoch: 5, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.8442769050598145
Epoch: 6, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 1.3052301406860352
Epoch: 7, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
Validation loss decreased (-0.799995 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.8220977783203125
Epoch: 8, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3478879928588867
Epoch: 9, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.293 Vali Acc: 0.844 Test Loss: 0.293 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844442).  Saving model ...
Epoch: 10 cost time: 1.786731243133545
Epoch: 10, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
Validation loss decreased (-0.844442 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.4228734970092773
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6719059944152832
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.684603214263916
Epoch: 13, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.34169340133667
Epoch: 14, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 1.4489011764526367
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9247465133666992
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.336 Vali Acc: 0.894 Test Loss: 0.336 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4465384483337402
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9203612804412842
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.339 Vali Acc: 0.928 Test Loss: 0.339 Test Acc: 0.928
Validation loss decreased (-0.899996 --> -0.927774).  Saving model ...
Epoch: 19 cost time: 1.5244660377502441
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.546 Vali Acc: 0.911 Test Loss: 0.546 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0386927127838135
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0568151473999023
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4645259380340576
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.096693992614746
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.669 Vali Acc: 0.867 Test Loss: 0.669 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5755853652954102
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.563 Vali Acc: 0.911 Test Loss: 0.563 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2153048515319824
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.020 Vali Acc: 0.900 Test Loss: 1.020 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.240051031112671
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
Validation loss decreased (-0.927774 --> -0.933330).  Saving model ...
Epoch: 27 cost time: 1.1867010593414307
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.906 Test Loss: 0.514 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2685034275054932
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.171949863433838
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.950 Vali Acc: 0.883 Test Loss: 0.950 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1670210361480713
Epoch: 30, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9760894775390625
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.632 Vali Acc: 0.889 Test Loss: 0.632 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0798888206481934
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.888 Vali Acc: 0.906 Test Loss: 0.888 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1754522323608398
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.742 Vali Acc: 0.900 Test Loss: 0.742 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3633861541748047
Epoch: 34, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.662 Vali Acc: 0.906 Test Loss: 0.662 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.416558027267456
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.911 Test Loss: 0.535 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3656938076019287
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.607 Vali Acc: 0.911 Test Loss: 0.607 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 29781510
model size : 128.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.872272491455078
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.9361879825592041
Epoch: 2, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.336 Vali Acc: 0.583 Test Loss: 1.336 Test Acc: 0.583
Validation loss decreased (-0.299983 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 1.2091567516326904
Epoch: 3, Steps: 12 | Train Loss: 1.216 Vali Loss: 0.946 Vali Acc: 0.644 Test Loss: 0.946 Test Acc: 0.644
Validation loss decreased (-0.583320 --> -0.644435).  Saving model ...
Epoch: 4 cost time: 1.005275011062622
Epoch: 4, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.619 Vali Acc: 0.756 Test Loss: 0.619 Test Acc: 0.756
Validation loss decreased (-0.644435 --> -0.755549).  Saving model ...
Epoch: 5 cost time: 1.3002657890319824
Epoch: 5, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.419 Vali Acc: 0.778 Test Loss: 0.419 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777774).  Saving model ...
Epoch: 6 cost time: 1.0604708194732666
Epoch: 6, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.402 Vali Acc: 0.794 Test Loss: 0.402 Test Acc: 0.794
Validation loss decreased (-0.777774 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 0.9558911323547363
Epoch: 7, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.085129737854004
Epoch: 8, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0270166397094727
Epoch: 9, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.500 Vali Acc: 0.839 Test Loss: 0.500 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.022444248199463
Epoch: 10, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.415 Vali Acc: 0.822 Test Loss: 0.415 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2368459701538086
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.424 Vali Acc: 0.839 Test Loss: 0.424 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2436420917510986
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 1.1908748149871826
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.370 Vali Acc: 0.872 Test Loss: 0.370 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.1321144104003906
Epoch: 14, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 1.0572328567504883
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 0.9701457023620605
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1539294719696045
Epoch: 17, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8906824588775635
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.183 Vali Acc: 0.906 Test Loss: 0.183 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 19 cost time: 0.9834432601928711
Epoch: 19, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 1.21405029296875
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1655874252319336
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0098962783813477
Epoch: 22, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9614953994750977
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.192 Vali Acc: 0.911 Test Loss: 0.192 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1950504779815674
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.163 Vali Acc: 0.933 Test Loss: 0.163 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933332).  Saving model ...
Epoch: 25 cost time: 1.1102359294891357
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 1.220949411392212
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0879995822906494
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8935770988464355
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1541802883148193
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.371 Vali Acc: 0.939 Test Loss: 0.371 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.064239501953125
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9920504093170166
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9154970645904541
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2175052165985107
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.156270980834961
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9504070281982422
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.928 Test Loss: 0.468 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 29713926
model size : 128.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6915221214294434
Epoch: 1, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.645 Vali Acc: 0.422 Test Loss: 1.645 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 1.13319730758667
Epoch: 2, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.340 Vali Acc: 0.594 Test Loss: 1.340 Test Acc: 0.594
Validation loss decreased (-0.422206 --> -0.594431).  Saving model ...
Epoch: 3 cost time: 0.9125545024871826
Epoch: 3, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.594431 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 0.831895112991333
Epoch: 4, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.714 Vali Acc: 0.744 Test Loss: 0.714 Test Acc: 0.744
Validation loss decreased (-0.699990 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 0.872974157333374
Epoch: 5, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749995).  Saving model ...
Epoch: 6 cost time: 1.1369667053222656
Epoch: 6, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.469 Vali Acc: 0.811 Test Loss: 0.469 Test Acc: 0.811
Validation loss decreased (-0.749995 --> -0.811106).  Saving model ...
Epoch: 7 cost time: 0.9178740978240967
Epoch: 7, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.404 Vali Acc: 0.783 Test Loss: 0.404 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0918805599212646
Epoch: 8, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.038787603378296
Epoch: 9, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 0.9673759937286377
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0821785926818848
Epoch: 11, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.400 Vali Acc: 0.839 Test Loss: 0.400 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.114149570465088
Epoch: 12, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 0.8821120262145996
Epoch: 13, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 1.0706264972686768
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 0.863271951675415
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 0.97780442237854
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.163 Vali Acc: 0.911 Test Loss: 0.163 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8912661075592041
Epoch: 17, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.233 Vali Acc: 0.883 Test Loss: 0.233 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8084392547607422
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9202413558959961
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.922220 --> -0.949999).  Saving model ...
Epoch: 20 cost time: 0.8464515209197998
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.348 Vali Acc: 0.894 Test Loss: 0.348 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0556347370147705
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9614384174346924
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.198 Vali Acc: 0.894 Test Loss: 0.198 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9535927772521973
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9254257678985596
Epoch: 24, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0386919975280762
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8241286277770996
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0146877765655518
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0531835556030273
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0634236335754395
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 29683206
model size : 127.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.761108875274658
Epoch: 1, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.635 Vali Acc: 0.439 Test Loss: 1.635 Test Acc: 0.439
Validation loss decreased (inf --> -0.438873).  Saving model ...
Epoch: 2 cost time: 0.9056661128997803
Epoch: 2, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.212 Vali Acc: 0.628 Test Loss: 1.212 Test Acc: 0.628
Validation loss decreased (-0.438873 --> -0.627766).  Saving model ...
Epoch: 3 cost time: 0.9674339294433594
Epoch: 3, Steps: 12 | Train Loss: 1.094 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
Validation loss decreased (-0.627766 --> -0.755548).  Saving model ...
Epoch: 4 cost time: 1.1010100841522217
Epoch: 4, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.489 Vali Acc: 0.800 Test Loss: 0.489 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799995).  Saving model ...
Epoch: 5 cost time: 1.0247337818145752
Epoch: 5, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.0498192310333252
Epoch: 6, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.394 Vali Acc: 0.822 Test Loss: 0.394 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.0242156982421875
Epoch: 7, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.1712803840637207
Epoch: 8, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.258 Vali Acc: 0.861 Test Loss: 0.258 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861109).  Saving model ...
Epoch: 9 cost time: 1.0165624618530273
Epoch: 9, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.477 Vali Acc: 0.839 Test Loss: 0.477 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.037541151046753
Epoch: 10, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9600157737731934
Epoch: 11, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
Validation loss decreased (-0.861109 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.030801773071289
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0006935596466064
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1359317302703857
Epoch: 14, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.097444772720337
Epoch: 15, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.048790454864502
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2845680713653564
Epoch: 17, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
Validation loss decreased (-0.877775 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 1.0633862018585205
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.666 Vali Acc: 0.861 Test Loss: 0.666 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0540282726287842
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.371 Vali Acc: 0.906 Test Loss: 0.371 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1640441417694092
Epoch: 20, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.352 Vali Acc: 0.928 Test Loss: 0.352 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927774).  Saving model ...
Epoch: 21 cost time: 1.303689956665039
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0144646167755127
Epoch: 22, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.705 Vali Acc: 0.906 Test Loss: 0.705 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3470203876495361
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1081700325012207
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0496203899383545
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.366 Vali Acc: 0.906 Test Loss: 0.366 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9301719665527344
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3271362781524658
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
Validation loss decreased (-0.927774 --> -0.927775).  Saving model ...
Epoch: 28 cost time: 1.0870215892791748
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1383917331695557
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2691574096679688
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0507848262786865
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3583228588104248
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 1.1703462600708008
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.928 Test Loss: 0.445 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1489043235778809
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0867412090301514
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4040281772613525
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1286776065826416
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.668 Vali Acc: 0.917 Test Loss: 0.668 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9640364646911621
Epoch: 38, Steps: 12 | Train Loss: 0.239 Vali Loss: 1.288 Vali Acc: 0.900 Test Loss: 1.288 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2792637348175049
Epoch: 39, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1409220695495605
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.232950210571289
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.311729907989502
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.423 Vali Acc: 0.906 Test Loss: 0.423 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 29793798
model size : 128.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.753427028656006
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.698 Vali Acc: 0.317 Test Loss: 1.698 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 1.079699993133545
Epoch: 2, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.359 Vali Acc: 0.622 Test Loss: 1.359 Test Acc: 0.622
Validation loss decreased (-0.316650 --> -0.622209).  Saving model ...
Epoch: 3 cost time: 1.0290496349334717
Epoch: 3, Steps: 12 | Train Loss: 1.178 Vali Loss: 0.936 Vali Acc: 0.678 Test Loss: 0.936 Test Acc: 0.678
Validation loss decreased (-0.622209 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 1.1330788135528564
Epoch: 4, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.577 Vali Acc: 0.767 Test Loss: 0.577 Test Acc: 0.767
Validation loss decreased (-0.677768 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 1.146592378616333
Epoch: 5, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 0.9167890548706055
Epoch: 6, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.0843071937561035
Epoch: 7, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.465 Vali Acc: 0.839 Test Loss: 0.465 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838884).  Saving model ...
Epoch: 8 cost time: 1.0073816776275635
Epoch: 8, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 1.0404741764068604
Epoch: 9, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.287 Vali Acc: 0.839 Test Loss: 0.287 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8820137977600098
Epoch: 10, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.918447732925415
Epoch: 11, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0838978290557861
Epoch: 12, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 0.8591446876525879
Epoch: 13, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.9142372608184814
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 0.8978917598724365
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8579144477844238
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 0.8536813259124756
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8511841297149658
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7453486919403076
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.409 Vali Acc: 0.856 Test Loss: 0.409 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7948997020721436
Epoch: 20, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8040680885314941
Epoch: 21, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7453820705413818
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.430 Vali Acc: 0.883 Test Loss: 0.430 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7277088165283203
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 24 cost time: 0.8690249919891357
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.641716718673706
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8999536037445068
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8515274524688721
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8029906749725342
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.362 Vali Acc: 0.894 Test Loss: 0.362 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8534951210021973
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9424800872802734
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.918065071105957
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9747717380523682
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9942362308502197
Epoch: 33, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 29756934
model size : 128.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.962545871734619
Epoch: 1, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.722 Vali Acc: 0.289 Test Loss: 1.722 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.9808042049407959
Epoch: 2, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.466 Vali Acc: 0.611 Test Loss: 1.466 Test Acc: 0.611
Validation loss decreased (-0.288872 --> -0.611096).  Saving model ...
Epoch: 3 cost time: 1.0330607891082764
Epoch: 3, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.115 Vali Acc: 0.733 Test Loss: 1.115 Test Acc: 0.733
Validation loss decreased (-0.611096 --> -0.733322).  Saving model ...
Epoch: 4 cost time: 1.1609408855438232
Epoch: 4, Steps: 12 | Train Loss: 1.031 Vali Loss: 0.760 Vali Acc: 0.739 Test Loss: 0.760 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 1.060600996017456
Epoch: 5, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.546 Vali Acc: 0.778 Test Loss: 0.546 Test Acc: 0.778
Validation loss decreased (-0.738881 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 1.2437596321105957
Epoch: 6, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.451 Vali Acc: 0.767 Test Loss: 0.451 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0423870086669922
Epoch: 7, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
Validation loss decreased (-0.777772 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 0.8525116443634033
Epoch: 8, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.333 Vali Acc: 0.833 Test Loss: 0.333 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.0154588222503662
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 0.968543529510498
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 0.7600867748260498
Epoch: 11, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9164323806762695
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.370 Vali Acc: 0.828 Test Loss: 0.370 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7580835819244385
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 0.8300831317901611
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.241 Vali Acc: 0.872 Test Loss: 0.241 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872220).  Saving model ...
Epoch: 15 cost time: 0.9064724445343018
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.255 Vali Acc: 0.856 Test Loss: 0.255 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7954885959625244
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
Validation loss decreased (-0.872220 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.001129150390625
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8783776760101318
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1256766319274902
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 1.0485866069793701
Epoch: 20, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.214 Vali Acc: 0.889 Test Loss: 0.214 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.93638014793396
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.407 Vali Acc: 0.883 Test Loss: 0.407 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.085235834121704
Epoch: 22, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.081162452697754
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9385251998901367
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 0.8472084999084473
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9991495609283447
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.015880823135376
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9344379901885986
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0791144371032715
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 1.0274910926818848
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9178829193115234
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 32 cost time: 1.1791949272155762
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1199419498443604
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.911 Test Loss: 0.165 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9424600601196289
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.159 Vali Acc: 0.939 Test Loss: 0.159 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 1.100691318511963
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9986104965209961
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.0904364585876465
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1398475170135498
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 1.0629751682281494
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0744810104370117
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9858355522155762
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8283596038818359
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1081733703613281
Epoch: 43, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0822901725769043
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.944117546081543
Epoch: 45, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0631768703460693
Epoch: 46, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.011124849319458
Epoch: 47, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9135353565216064
Epoch: 48, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 29732358
model size : 128.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4534647464752197
Epoch: 1, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.563 Vali Acc: 0.544 Test Loss: 1.563 Test Acc: 0.544
Validation loss decreased (inf --> -0.544429).  Saving model ...
Epoch: 2 cost time: 1.0005364418029785
Epoch: 2, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.132 Vali Acc: 0.661 Test Loss: 1.132 Test Acc: 0.661
Validation loss decreased (-0.544429 --> -0.661100).  Saving model ...
Epoch: 3 cost time: 0.9111630916595459
Epoch: 3, Steps: 12 | Train Loss: 0.948 Vali Loss: 0.688 Vali Acc: 0.739 Test Loss: 0.688 Test Acc: 0.739
Validation loss decreased (-0.661100 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 0.9223537445068359
Epoch: 4, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.448 Vali Acc: 0.806 Test Loss: 0.448 Test Acc: 0.806
Validation loss decreased (-0.738882 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 0.9746444225311279
Epoch: 5, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.373 Vali Acc: 0.789 Test Loss: 0.373 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0283465385437012
Epoch: 6, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 0.9768171310424805
Epoch: 7, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
Validation loss decreased (-0.838886 --> -0.883331).  Saving model ...
Epoch: 8 cost time: 0.9354946613311768
Epoch: 8, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8912129402160645
Epoch: 9, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0901439189910889
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3280394077301025
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.393 Vali Acc: 0.872 Test Loss: 0.393 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.046886682510376
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.224 Vali Acc: 0.889 Test Loss: 0.224 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888887).  Saving model ...
Epoch: 13 cost time: 1.3429832458496094
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
Validation loss decreased (-0.888887 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 1.28145170211792
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.905553 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.8870749473571777
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9117255210876465
Epoch: 16, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.343 Vali Acc: 0.872 Test Loss: 0.343 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2901291847229004
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.378 Vali Acc: 0.883 Test Loss: 0.378 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.23423171043396
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.161 Vali Acc: 0.922 Test Loss: 0.161 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.132472276687622
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.328 Vali Acc: 0.928 Test Loss: 0.328 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.044739007949829
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0143802165985107
Epoch: 21, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3653090000152588
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.409 Vali Acc: 0.883 Test Loss: 0.409 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3243820667266846
Epoch: 23, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.088496446609497
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.648 Vali Acc: 0.883 Test Loss: 0.648 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 29898246
model size : 128.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6556057929992676
Epoch: 1, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.536 Vali Acc: 0.528 Test Loss: 1.536 Test Acc: 0.528
Validation loss decreased (inf --> -0.527762).  Saving model ...
Epoch: 2 cost time: 0.9991347789764404
Epoch: 2, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.185 Vali Acc: 0.683 Test Loss: 1.185 Test Acc: 0.683
Validation loss decreased (-0.527762 --> -0.683321).  Saving model ...
Epoch: 3 cost time: 0.8283908367156982
Epoch: 3, Steps: 12 | Train Loss: 1.102 Vali Loss: 0.832 Vali Acc: 0.778 Test Loss: 0.832 Test Acc: 0.778
Validation loss decreased (-0.683321 --> -0.777769).  Saving model ...
Epoch: 4 cost time: 0.9126429557800293
Epoch: 4, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.587 Vali Acc: 0.794 Test Loss: 0.587 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794439).  Saving model ...
Epoch: 5 cost time: 1.1183207035064697
Epoch: 5, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.465 Vali Acc: 0.761 Test Loss: 0.465 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0157427787780762
Epoch: 6, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
Validation loss decreased (-0.794439 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 0.8608138561248779
Epoch: 7, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.340 Vali Acc: 0.800 Test Loss: 0.340 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8661682605743408
Epoch: 8, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0335485935211182
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.493 Vali Acc: 0.811 Test Loss: 0.493 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0886671543121338
Epoch: 10, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 11 cost time: 0.7923316955566406
Epoch: 11, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0578010082244873
Epoch: 12, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
Validation loss decreased (-0.838886 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 1.0679066181182861
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.872219 --> -0.911109).  Saving model ...
Epoch: 14 cost time: 0.9111788272857666
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9817759990692139
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0387368202209473
Epoch: 16, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9268407821655273
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.431 Vali Acc: 0.867 Test Loss: 0.431 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9554214477539062
Epoch: 18, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0336923599243164
Epoch: 19, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.071718692779541
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9969730377197266
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.900 Test Loss: 0.175 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1090359687805176
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.092869758605957
Epoch: 23, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.494 Vali Acc: 0.883 Test Loss: 0.494 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 29855238
model size : 128.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9542322158813477
Epoch: 1, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.638 Vali Acc: 0.339 Test Loss: 1.638 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 0.9060721397399902
Epoch: 2, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.349 Vali Acc: 0.611 Test Loss: 1.349 Test Acc: 0.611
Validation loss decreased (-0.338873 --> -0.611098).  Saving model ...
Epoch: 3 cost time: 1.0792903900146484
Epoch: 3, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.038 Vali Acc: 0.711 Test Loss: 1.038 Test Acc: 0.711
Validation loss decreased (-0.611098 --> -0.711101).  Saving model ...
Epoch: 4 cost time: 1.119095802307129
Epoch: 4, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 0.8525080680847168
Epoch: 5, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.579 Vali Acc: 0.733 Test Loss: 0.579 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733328).  Saving model ...
Epoch: 6 cost time: 1.0666062831878662
Epoch: 6, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.494 Vali Acc: 0.761 Test Loss: 0.494 Test Acc: 0.761
Validation loss decreased (-0.733328 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 0.917992115020752
Epoch: 7, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.448 Vali Acc: 0.744 Test Loss: 0.448 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9138731956481934
Epoch: 8, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
Validation loss decreased (-0.761106 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 0.9934628009796143
Epoch: 9, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.371 Vali Acc: 0.806 Test Loss: 0.371 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9966516494750977
Epoch: 10, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.397 Vali Acc: 0.794 Test Loss: 0.397 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9725408554077148
Epoch: 11, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 0.8637311458587646
Epoch: 12, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 0.9464023113250732
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.286 Vali Acc: 0.839 Test Loss: 0.286 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7754318714141846
Epoch: 14, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.877349853515625
Epoch: 15, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 0.7848405838012695
Epoch: 16, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 0.8693604469299316
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.9167017936706543
Epoch: 18, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.217 Vali Acc: 0.878 Test Loss: 0.217 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.803642749786377
Epoch: 19, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9421300888061523
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 21 cost time: 1.0640504360198975
Epoch: 21, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1213016510009766
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 23 cost time: 0.9137265682220459
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.188 Vali Acc: 0.906 Test Loss: 0.188 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 24 cost time: 1.031440019607544
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.160 Vali Acc: 0.917 Test Loss: 0.160 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 1.0043716430664062
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0621955394744873
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9975874423980713
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0864448547363281
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0451664924621582
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1046850681304932
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9098031520843506
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8556458950042725
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8512213230133057
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.102384328842163
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 29836806
model size : 128.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.46066951751709
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.566 Vali Acc: 0.356 Test Loss: 1.566 Test Acc: 0.356
Validation loss decreased (inf --> -0.355540).  Saving model ...
Epoch: 2 cost time: 1.2746102809906006
Epoch: 2, Steps: 12 | Train Loss: 1.271 Vali Loss: 0.971 Vali Acc: 0.706 Test Loss: 0.971 Test Acc: 0.706
Validation loss decreased (-0.355540 --> -0.705546).  Saving model ...
Epoch: 3 cost time: 1.2852756977081299
Epoch: 3, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.663 Vali Acc: 0.739 Test Loss: 0.663 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 1.6951169967651367
Epoch: 4, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
Validation loss decreased (-0.738882 --> -0.799995).  Saving model ...
Epoch: 5 cost time: 1.3263976573944092
Epoch: 5, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.441 Vali Acc: 0.761 Test Loss: 0.441 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2627744674682617
Epoch: 6, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.7466669082641602
Epoch: 7, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 8 cost time: 1.4051904678344727
Epoch: 8, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.557 Vali Acc: 0.806 Test Loss: 0.557 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2690339088439941
Epoch: 9, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.260 Vali Acc: 0.861 Test Loss: 0.260 Test Acc: 0.861
Validation loss decreased (-0.822219 --> -0.861109).  Saving model ...
Epoch: 10 cost time: 1.7615647315979004
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.466 Vali Acc: 0.839 Test Loss: 0.466 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7520406246185303
Epoch: 11, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
Validation loss decreased (-0.861109 --> -0.899998).  Saving model ...
Epoch: 12 cost time: 1.7491629123687744
Epoch: 12, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.43705153465271
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927776).  Saving model ...
Epoch: 14 cost time: 1.035590648651123
Epoch: 14, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4589707851409912
Epoch: 15, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7087855339050293
Epoch: 16, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4121003150939941
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6183748245239258
Epoch: 18, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.804063081741333
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 1.256810188293457
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6116082668304443
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.532 Vali Acc: 0.878 Test Loss: 0.532 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4606585502624512
Epoch: 22, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.404 Vali Acc: 0.928 Test Loss: 0.404 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6056747436523438
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.314 Vali Acc: 0.939 Test Loss: 0.314 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 24 cost time: 1.344268560409546
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3496830463409424
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6628715991973877
Epoch: 26, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.643 Vali Acc: 0.856 Test Loss: 1.643 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3062517642974854
Epoch: 27, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6591010093688965
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.376 Vali Acc: 0.906 Test Loss: 0.376 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.617098093032837
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.736 Vali Acc: 0.911 Test Loss: 0.736 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.460810661315918
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.939 Test Loss: 0.236 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 31 cost time: 1.956282377243042
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.933 Test Loss: 0.436 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6970813274383545
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 33 cost time: 1.8770644664764404
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.772 Vali Acc: 0.922 Test Loss: 0.772 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8654730319976807
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5685570240020752
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.934464693069458
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.924 Vali Acc: 0.922 Test Loss: 0.924 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.9015610218048096
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.437 Vali Acc: 0.922 Test Loss: 0.437 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5131895542144775
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.504 Vali Acc: 0.878 Test Loss: 1.504 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.943037509918213
Epoch: 39, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.641 Vali Acc: 0.889 Test Loss: 0.641 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7919535636901855
Epoch: 40, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.699 Vali Acc: 0.928 Test Loss: 0.699 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6175117492675781
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.609 Vali Acc: 0.928 Test Loss: 0.609 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4394683837890625
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.523 Vali Acc: 0.944 Test Loss: 0.523 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944439).  Saving model ...
Epoch: 43 cost time: 1.415818691253662
Epoch: 43, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.169 Vali Acc: 0.883 Test Loss: 1.169 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4730808734893799
Epoch: 44, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.602 Vali Acc: 0.922 Test Loss: 0.602 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3564560413360596
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.994 Vali Acc: 0.906 Test Loss: 0.994 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3823885917663574
Epoch: 46, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.846 Vali Acc: 0.917 Test Loss: 0.846 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.3855535984039307
Epoch: 47, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.462 Vali Acc: 0.900 Test Loss: 1.462 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4262354373931885
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.702 Vali Acc: 0.928 Test Loss: 0.702 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.4351325035095215
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.967 Vali Acc: 0.917 Test Loss: 0.967 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3475687503814697
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.631 Vali Acc: 0.917 Test Loss: 0.631 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 22583046
model size : 100.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3689229488372803
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.618 Vali Acc: 0.406 Test Loss: 1.618 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 1.5714256763458252
Epoch: 2, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.191 Vali Acc: 0.728 Test Loss: 1.191 Test Acc: 0.728
Validation loss decreased (-0.405539 --> -0.727766).  Saving model ...
Epoch: 3 cost time: 1.3537333011627197
Epoch: 3, Steps: 12 | Train Loss: 1.013 Vali Loss: 0.807 Vali Acc: 0.750 Test Loss: 0.807 Test Acc: 0.750
Validation loss decreased (-0.727766 --> -0.749992).  Saving model ...
Epoch: 4 cost time: 1.1720283031463623
Epoch: 4, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.584 Vali Acc: 0.772 Test Loss: 0.584 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 1.5229074954986572
Epoch: 5, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.447 Vali Acc: 0.772 Test Loss: 0.447 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772218).  Saving model ...
Epoch: 6 cost time: 1.309962511062622
Epoch: 6, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.443 Vali Acc: 0.794 Test Loss: 0.443 Test Acc: 0.794
Validation loss decreased (-0.772218 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.6061041355133057
Epoch: 7, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.321 Vali Acc: 0.828 Test Loss: 0.321 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827775).  Saving model ...
Epoch: 8 cost time: 1.3547933101654053
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.314 Vali Acc: 0.811 Test Loss: 0.314 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9986181259155273
Epoch: 9, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.759 Vali Acc: 0.817 Test Loss: 0.759 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.001633882522583
Epoch: 10, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.483 Vali Acc: 0.839 Test Loss: 0.483 Test Acc: 0.839
Validation loss decreased (-0.827775 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.5614047050476074
Epoch: 11, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 1.5057799816131592
Epoch: 12, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.271 Vali Acc: 0.844 Test Loss: 0.271 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844442).  Saving model ...
Epoch: 13 cost time: 1.24723482131958
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
Validation loss decreased (-0.844442 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.5794847011566162
Epoch: 14, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4845824241638184
Epoch: 15, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.154 Vali Acc: 0.933 Test Loss: 0.154 Test Acc: 0.933
Validation loss decreased (-0.888886 --> -0.933332).  Saving model ...
Epoch: 16 cost time: 1.6064651012420654
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5774095058441162
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.140 Vali Acc: 0.928 Test Loss: 0.140 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4467053413391113
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.461672067642212
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.363 Vali Acc: 0.878 Test Loss: 0.363 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6290099620819092
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.155 Vali Acc: 0.928 Test Loss: 0.155 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.765510082244873
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4066407680511475
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 23 cost time: 1.1621944904327393
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5967934131622314
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.504 Vali Acc: 0.906 Test Loss: 0.504 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6849403381347656
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.356255292892456
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.600 Vali Acc: 0.894 Test Loss: 0.600 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6245231628417969
Epoch: 27, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.932 Vali Acc: 0.878 Test Loss: 0.932 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6044230461120605
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.509 Vali Acc: 0.917 Test Loss: 0.509 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4935204982757568
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.371 Vali Acc: 0.928 Test Loss: 0.371 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1756508350372314
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6245217323303223
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.555 Vali Acc: 0.928 Test Loss: 0.555 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6109118461608887
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22435590
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.696666717529297
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.655 Vali Acc: 0.389 Test Loss: 1.655 Test Acc: 0.389
Validation loss decreased (inf --> -0.388872).  Saving model ...
Epoch: 2 cost time: 1.3293166160583496
Epoch: 2, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.333 Vali Acc: 0.694 Test Loss: 1.333 Test Acc: 0.694
Validation loss decreased (-0.388872 --> -0.694431).  Saving model ...
Epoch: 3 cost time: 1.6815502643585205
Epoch: 3, Steps: 12 | Train Loss: 1.189 Vali Loss: 0.979 Vali Acc: 0.694 Test Loss: 0.979 Test Acc: 0.694
Validation loss decreased (-0.694431 --> -0.694435).  Saving model ...
Epoch: 4 cost time: 1.5629713535308838
Epoch: 4, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 1.5432324409484863
Epoch: 5, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
Validation loss decreased (-0.716660 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 1.2458784580230713
Epoch: 6, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.474 Vali Acc: 0.789 Test Loss: 0.474 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.5575847625732422
Epoch: 7, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.406 Vali Acc: 0.783 Test Loss: 0.406 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4277701377868652
Epoch: 8, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 0.8794898986816406
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.2170228958129883
Epoch: 10, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7320685386657715
Epoch: 11, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.2182605266571045
Epoch: 12, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.410 Vali Acc: 0.822 Test Loss: 0.410 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7033016681671143
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 0.866891622543335
Epoch: 14, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 1.3286187648773193
Epoch: 15, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.363509178161621
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0854620933532715
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1012647151947021
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0790214538574219
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927775).  Saving model ...
Epoch: 20 cost time: 1.0448169708251953
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0122902393341064
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.384 Vali Acc: 0.922 Test Loss: 0.384 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0837059020996094
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.364 Vali Acc: 0.911 Test Loss: 0.364 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.031731367111206
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.166 Vali Acc: 0.922 Test Loss: 0.166 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.07535982131958
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.400 Vali Acc: 0.928 Test Loss: 0.400 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0679943561553955
Epoch: 25, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.906 Test Loss: 0.188 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.966475248336792
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9286985397338867
Epoch: 27, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.420 Vali Acc: 0.928 Test Loss: 0.420 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.984846830368042
Epoch: 28, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.789 Vali Acc: 0.900 Test Loss: 0.789 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0023672580718994
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 22386438
model size : 100.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.924243211746216
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.444 Vali Acc: 0.567 Test Loss: 1.444 Test Acc: 0.567
Validation loss decreased (inf --> -0.566652).  Saving model ...
Epoch: 2 cost time: 1.3396186828613281
Epoch: 2, Steps: 12 | Train Loss: 1.222 Vali Loss: 0.939 Vali Acc: 0.733 Test Loss: 0.939 Test Acc: 0.733
Validation loss decreased (-0.566652 --> -0.733324).  Saving model ...
Epoch: 3 cost time: 1.2550275325775146
Epoch: 3, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.690 Vali Acc: 0.667 Test Loss: 0.690 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2584292888641357
Epoch: 4, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.552 Vali Acc: 0.717 Test Loss: 0.552 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2289080619812012
Epoch: 5, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.375 Vali Acc: 0.811 Test Loss: 0.375 Test Acc: 0.811
Validation loss decreased (-0.733324 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.3214597702026367
Epoch: 6, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
Validation loss decreased (-0.811107 --> -0.872219).  Saving model ...
Epoch: 7 cost time: 1.3898017406463623
Epoch: 7, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.423231601715088
Epoch: 8, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4355366230010986
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4213171005249023
Epoch: 10, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.250 Vali Acc: 0.878 Test Loss: 0.250 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 1.4232265949249268
Epoch: 11, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2375843524932861
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.492506742477417
Epoch: 13, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4241161346435547
Epoch: 14, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5040671825408936
Epoch: 15, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4588868618011475
Epoch: 16, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5568151473999023
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.449251413345337
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5046865940093994
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.622 Vali Acc: 0.894 Test Loss: 0.622 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894438).  Saving model ...
Epoch: 20 cost time: 1.563917875289917
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.332756519317627
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.475 Vali Acc: 0.922 Test Loss: 0.475 Test Acc: 0.922
Validation loss decreased (-0.894438 --> -0.922217).  Saving model ...
Epoch: 22 cost time: 1.3661863803863525
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5420501232147217
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.361656665802002
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.652 Vali Acc: 0.922 Test Loss: 0.652 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.23388671875
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.291078805923462
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.768 Vali Acc: 0.878 Test Loss: 0.768 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1986100673675537
Epoch: 27, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.775 Vali Acc: 0.861 Test Loss: 0.775 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3267438411712646
Epoch: 28, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.384 Vali Acc: 0.922 Test Loss: 0.384 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 1.3897833824157715
Epoch: 29, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.623 Vali Acc: 0.889 Test Loss: 0.623 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4431042671203613
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4291408061981201
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.677 Vali Acc: 0.900 Test Loss: 0.677 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5515682697296143
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.639 Vali Acc: 0.911 Test Loss: 0.639 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4436392784118652
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.695 Vali Acc: 0.906 Test Loss: 0.695 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4600534439086914
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.754 Vali Acc: 0.900 Test Loss: 1.754 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4242877960205078
Epoch: 35, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.638 Vali Acc: 0.894 Test Loss: 1.638 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4020264148712158
Epoch: 36, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.545 Vali Acc: 0.911 Test Loss: 0.545 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2695221900939941
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 2.430 Vali Acc: 0.856 Test Loss: 2.430 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3824121952056885
Epoch: 38, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.823 Vali Acc: 0.878 Test Loss: 0.823 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 22632198
model size : 101.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9141058921813965
Epoch: 1, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.482 Vali Acc: 0.528 Test Loss: 1.482 Test Acc: 0.528
Validation loss decreased (inf --> -0.527763).  Saving model ...
Epoch: 2 cost time: 1.2246384620666504
Epoch: 2, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.074 Vali Acc: 0.672 Test Loss: 1.074 Test Acc: 0.672
Validation loss decreased (-0.527763 --> -0.672211).  Saving model ...
Epoch: 3 cost time: 1.2012968063354492
Epoch: 3, Steps: 12 | Train Loss: 0.933 Vali Loss: 0.778 Vali Acc: 0.678 Test Loss: 0.778 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677770).  Saving model ...
Epoch: 4 cost time: 1.2294371128082275
Epoch: 4, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
Validation loss decreased (-0.677770 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.2873296737670898
Epoch: 5, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.501 Vali Acc: 0.750 Test Loss: 0.501 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2406494617462158
Epoch: 6, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.405 Vali Acc: 0.811 Test Loss: 0.405 Test Acc: 0.811
Validation loss decreased (-0.761105 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.298309087753296
Epoch: 7, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.433 Vali Acc: 0.817 Test Loss: 0.433 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 8 cost time: 1.171891450881958
Epoch: 8, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1990227699279785
Epoch: 9, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 1.2393567562103271
Epoch: 10, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
Validation loss decreased (-0.822218 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.2050936222076416
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.253218173980713
Epoch: 12, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.25858736038208
Epoch: 13, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.358 Vali Acc: 0.878 Test Loss: 0.358 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 14 cost time: 1.1556990146636963
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 1.2259747982025146
Epoch: 15, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1667804718017578
Epoch: 16, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 1.2048718929290771
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.251453161239624
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.216216802597046
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.250305414199829
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3281781673431396
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.219646692276001
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2971773147583008
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.827 Vali Acc: 0.889 Test Loss: 0.827 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.235952377319336
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.258284330368042
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2473831176757812
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2298381328582764
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.681 Vali Acc: 0.917 Test Loss: 0.681 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 22484742
model size : 100.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7377004623413086
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.695 Vali Acc: 0.272 Test Loss: 1.695 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 0.8319811820983887
Epoch: 2, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.417 Vali Acc: 0.606 Test Loss: 1.417 Test Acc: 0.606
Validation loss decreased (-0.272205 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 0.8613829612731934
Epoch: 3, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.046 Vali Acc: 0.672 Test Loss: 1.046 Test Acc: 0.672
Validation loss decreased (-0.605541 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 0.9136698246002197
Epoch: 4, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
Validation loss decreased (-0.672212 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 0.9646742343902588
Epoch: 5, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.590 Vali Acc: 0.733 Test Loss: 0.590 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9645090103149414
Epoch: 6, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.526 Vali Acc: 0.739 Test Loss: 0.526 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738884).  Saving model ...
Epoch: 7 cost time: 1.0625085830688477
Epoch: 7, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.424 Vali Acc: 0.778 Test Loss: 0.424 Test Acc: 0.778
Validation loss decreased (-0.738884 --> -0.777774).  Saving model ...
Epoch: 8 cost time: 0.9735784530639648
Epoch: 8, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.420 Vali Acc: 0.822 Test Loss: 0.420 Test Acc: 0.822
Validation loss decreased (-0.777774 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 0.9674479961395264
Epoch: 9, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.458 Vali Acc: 0.794 Test Loss: 0.458 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9324989318847656
Epoch: 10, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.444 Vali Acc: 0.806 Test Loss: 0.444 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9424283504486084
Epoch: 11, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.533 Vali Acc: 0.811 Test Loss: 0.533 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8899648189544678
Epoch: 12, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.474 Vali Acc: 0.828 Test Loss: 0.474 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 0.87054443359375
Epoch: 13, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.389 Vali Acc: 0.856 Test Loss: 0.389 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.0226116180419922
Epoch: 14, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 0.9033987522125244
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 0.9033341407775879
Epoch: 16, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 0.8522374629974365
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8789470195770264
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 0.9983417987823486
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.923170804977417
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9470868110656738
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.166 Vali Acc: 0.928 Test Loss: 0.166 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 0.9153211116790771
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8886148929595947
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9662942886352539
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8801984786987305
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9523341655731201
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9437332153320312
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.013033390045166
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.002155065536499
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9472284317016602
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9294717311859131
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.560 Vali Acc: 0.911 Test Loss: 0.560 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 22411014
model size : 100.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3589279651641846
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.630 Vali Acc: 0.472 Test Loss: 1.630 Test Acc: 0.472
Validation loss decreased (inf --> -0.472206).  Saving model ...
Epoch: 2 cost time: 1.0481209754943848
Epoch: 2, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.172 Vali Acc: 0.683 Test Loss: 1.172 Test Acc: 0.683
Validation loss decreased (-0.472206 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 1.2176616191864014
Epoch: 3, Steps: 12 | Train Loss: 0.977 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.683322 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.240248441696167
Epoch: 4, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.506 Vali Acc: 0.750 Test Loss: 0.506 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 1.2655203342437744
Epoch: 5, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 1.3263063430786133
Epoch: 6, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 1.3265812397003174
Epoch: 7, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
Validation loss decreased (-0.822219 --> -0.872219).  Saving model ...
Epoch: 8 cost time: 1.3379569053649902
Epoch: 8, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 9 cost time: 1.292367935180664
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4112849235534668
Epoch: 10, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.474 Vali Acc: 0.839 Test Loss: 0.474 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2447090148925781
Epoch: 11, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2778398990631104
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 13 cost time: 1.2343435287475586
Epoch: 13, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.294532060623169
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 1.2309153079986572
Epoch: 15, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.406 Vali Acc: 0.878 Test Loss: 0.406 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.215247392654419
Epoch: 16, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.677 Vali Acc: 0.878 Test Loss: 0.677 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2670352458953857
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2689423561096191
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.404 Vali Acc: 0.911 Test Loss: 0.404 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 1.250154733657837
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2175946235656738
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 1.180833101272583
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.353 Vali Acc: 0.922 Test Loss: 0.353 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 1.2796850204467773
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.804 Vali Acc: 0.883 Test Loss: 0.804 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2275516986846924
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0628890991210938
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.632 Vali Acc: 0.906 Test Loss: 0.632 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2011535167694092
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1737711429595947
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.539 Vali Acc: 0.917 Test Loss: 0.539 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2562527656555176
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.417 Vali Acc: 0.911 Test Loss: 0.417 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1662652492523193
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.605 Vali Acc: 0.922 Test Loss: 0.605 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.957756757736206
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1707510948181152
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.746 Vali Acc: 0.906 Test Loss: 0.746 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2461597919464111
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.486 Vali Acc: 0.922 Test Loss: 0.486 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 22540038
model size : 100.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.679253578186035
Epoch: 1, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.563 Vali Acc: 0.494 Test Loss: 1.563 Test Acc: 0.494
Validation loss decreased (inf --> -0.494429).  Saving model ...
Epoch: 2 cost time: 0.9298985004425049
Epoch: 2, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.227 Vali Acc: 0.633 Test Loss: 1.227 Test Acc: 0.633
Validation loss decreased (-0.494429 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 0.914818286895752
Epoch: 3, Steps: 12 | Train Loss: 1.090 Vali Loss: 0.862 Vali Acc: 0.694 Test Loss: 0.862 Test Acc: 0.694
Validation loss decreased (-0.633321 --> -0.694436).  Saving model ...
Epoch: 4 cost time: 0.84195876121521
Epoch: 4, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.694436 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.0692036151885986
Epoch: 5, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.483 Vali Acc: 0.739 Test Loss: 0.483 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0552589893341064
Epoch: 6, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
Validation loss decreased (-0.749994 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.1058695316314697
Epoch: 7, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.1013593673706055
Epoch: 8, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2946531772613525
Epoch: 9, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.257 Vali Acc: 0.867 Test Loss: 0.257 Test Acc: 0.867
Validation loss decreased (-0.827774 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 1.3580830097198486
Epoch: 10, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.301903486251831
Epoch: 11, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.261 Vali Acc: 0.850 Test Loss: 0.261 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.253300428390503
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2407569885253906
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.253784418106079
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2449500560760498
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2549169063568115
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.385 Vali Acc: 0.878 Test Loss: 0.385 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1138083934783936
Epoch: 17, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 1.1100409030914307
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.176729679107666
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 20 cost time: 1.1143889427185059
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2704882621765137
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2014079093933105
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2252025604248047
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.074251413345337
Epoch: 24, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2209224700927734
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.508 Vali Acc: 0.906 Test Loss: 0.508 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2433276176452637
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2170507907867432
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1343190670013428
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1220319271087646
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22490886
model size : 100.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.093140125274658
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.654 Vali Acc: 0.378 Test Loss: 1.654 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.9567010402679443
Epoch: 2, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.400 Vali Acc: 0.650 Test Loss: 1.400 Test Acc: 0.650
Validation loss decreased (-0.377761 --> -0.649986).  Saving model ...
Epoch: 3 cost time: 0.9976775646209717
Epoch: 3, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.089 Vali Acc: 0.722 Test Loss: 1.089 Test Acc: 0.722
Validation loss decreased (-0.649986 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 1.020857810974121
Epoch: 4, Steps: 12 | Train Loss: 0.934 Vali Loss: 0.761 Vali Acc: 0.744 Test Loss: 0.761 Test Acc: 0.744
Validation loss decreased (-0.722211 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 0.7402005195617676
Epoch: 5, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.545 Vali Acc: 0.761 Test Loss: 0.545 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 0.9605867862701416
Epoch: 6, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.444 Vali Acc: 0.767 Test Loss: 0.444 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 0.9213962554931641
Epoch: 7, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
Validation loss decreased (-0.766662 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 0.9321825504302979
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.381 Vali Acc: 0.839 Test Loss: 0.381 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 0.8759422302246094
Epoch: 9, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 0.9410321712493896
Epoch: 10, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9392096996307373
Epoch: 11, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 0.9468343257904053
Epoch: 12, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.950089693069458
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.032951831817627
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.9152877330780029
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.186 Vali Acc: 0.911 Test Loss: 0.186 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 1.0042660236358643
Epoch: 16, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.9865057468414307
Epoch: 17, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.181 Vali Acc: 0.922 Test Loss: 0.181 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.8796260356903076
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.912409782409668
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9081387519836426
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9002876281738281
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9619917869567871
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9446308612823486
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.999295711517334
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.9916491508483887
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9888195991516113
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.933 Test Loss: 0.134 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 27 cost time: 0.9769947528839111
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9187133312225342
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.057969331741333
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9681122303009033
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7762072086334229
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.415 Vali Acc: 0.928 Test Loss: 0.415 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8292434215545654
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.956 Test Loss: 0.130 Test Acc: 0.956
Validation loss decreased (-0.933332 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 1.0331993103027344
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
Validation loss decreased (-0.955554 --> -0.961110).  Saving model ...
Epoch: 34 cost time: 1.0576410293579102
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7712059020996094
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8152256011962891
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8704774379730225
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.602 Vali Acc: 0.911 Test Loss: 0.602 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8710188865661621
Epoch: 38, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.948136568069458
Epoch: 39, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.971 Vali Acc: 0.850 Test Loss: 0.971 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9077506065368652
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.159 Vali Acc: 0.933 Test Loss: 0.159 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9743552207946777
Epoch: 41, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.313 Vali Acc: 0.928 Test Loss: 0.313 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9620256423950195
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8526415824890137
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 22454022
model size : 100.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9986233711242676
Epoch: 1, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.650 Vali Acc: 0.339 Test Loss: 1.650 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 1.0008130073547363
Epoch: 2, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.167 Vali Acc: 0.644 Test Loss: 1.167 Test Acc: 0.644
Validation loss decreased (-0.338872 --> -0.644433).  Saving model ...
Epoch: 3 cost time: 1.1067965030670166
Epoch: 3, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.716 Vali Acc: 0.728 Test Loss: 0.716 Test Acc: 0.728
Validation loss decreased (-0.644433 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.0625898838043213
Epoch: 4, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.508 Vali Acc: 0.717 Test Loss: 0.508 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8596067428588867
Epoch: 5, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.360 Vali Acc: 0.811 Test Loss: 0.360 Test Acc: 0.811
Validation loss decreased (-0.727771 --> -0.811108).  Saving model ...
Epoch: 6 cost time: 1.0788335800170898
Epoch: 6, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.331 Vali Acc: 0.817 Test Loss: 0.331 Test Acc: 0.817
Validation loss decreased (-0.811108 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.0598750114440918
Epoch: 7, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.0783817768096924
Epoch: 8, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.369 Vali Acc: 0.839 Test Loss: 0.369 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.018247127532959
Epoch: 9, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.1463992595672607
Epoch: 10, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1182711124420166
Epoch: 11, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
Validation loss decreased (-0.849997 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 1.1612374782562256
Epoch: 12, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 13 cost time: 1.1605584621429443
Epoch: 13, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1303982734680176
Epoch: 14, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2600085735321045
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 1.0810716152191162
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2382891178131104
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1909468173980713
Epoch: 18, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2188153266906738
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.433 Vali Acc: 0.906 Test Loss: 0.433 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.308504343032837
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.427 Vali Acc: 0.906 Test Loss: 0.427 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1023781299591064
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1623456478118896
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.798 Vali Acc: 0.872 Test Loss: 0.798 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2024526596069336
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1920742988586426
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.391 Vali Acc: 0.894 Test Loss: 0.391 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.16383957862854
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 1.2360320091247559
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.335 Vali Acc: 0.944 Test Loss: 0.335 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 1.2232024669647217
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2421109676361084
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.459 Vali Acc: 0.928 Test Loss: 0.459 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2796881198883057
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1351792812347412
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.440 Vali Acc: 0.906 Test Loss: 0.440 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1348299980163574
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.601 Vali Acc: 0.894 Test Loss: 0.601 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2197620868682861
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1843109130859375
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.971 Vali Acc: 0.872 Test Loss: 0.971 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2328314781188965
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.565 Vali Acc: 0.911 Test Loss: 0.565 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.299426794052124
Epoch: 35, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.442 Vali Acc: 0.894 Test Loss: 0.442 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.218357801437378
Epoch: 36, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 22589190
model size : 100.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8322551250457764
Epoch: 1, Steps: 12 | Train Loss: 1.967 Vali Loss: 1.676 Vali Acc: 0.311 Test Loss: 1.676 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 1.1425392627716064
Epoch: 2, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.314 Vali Acc: 0.572 Test Loss: 1.314 Test Acc: 0.572
Validation loss decreased (-0.311094 --> -0.572209).  Saving model ...
Epoch: 3 cost time: 1.061347246170044
Epoch: 3, Steps: 12 | Train Loss: 1.089 Vali Loss: 0.893 Vali Acc: 0.739 Test Loss: 0.893 Test Acc: 0.739
Validation loss decreased (-0.572209 --> -0.738880).  Saving model ...
Epoch: 4 cost time: 1.153620958328247
Epoch: 4, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.1700794696807861
Epoch: 5, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.493 Vali Acc: 0.750 Test Loss: 0.493 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 6 cost time: 1.2382607460021973
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
Validation loss decreased (-0.749995 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.112778902053833
Epoch: 7, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.1391313076019287
Epoch: 8, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
Validation loss decreased (-0.844441 --> -0.905553).  Saving model ...
Epoch: 9 cost time: 1.181281566619873
Epoch: 9, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.252 Vali Acc: 0.883 Test Loss: 0.252 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9993331432342529
Epoch: 10, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0207040309906006
Epoch: 11, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.429 Vali Acc: 0.839 Test Loss: 0.429 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1388227939605713
Epoch: 12, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9479491710662842
Epoch: 13, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.8131721019744873
Epoch: 14, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.201 Vali Acc: 0.900 Test Loss: 0.201 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0607759952545166
Epoch: 15, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.417 Vali Acc: 0.872 Test Loss: 0.417 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9404070377349854
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.128 Vali Acc: 0.939 Test Loss: 0.128 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938888).  Saving model ...
Epoch: 17 cost time: 1.05853271484375
Epoch: 17, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.927600622177124
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.170050859451294
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0613248348236084
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.222005844116211
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1026620864868164
Epoch: 22, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.359 Vali Acc: 0.894 Test Loss: 0.359 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2365212440490723
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2090704441070557
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0761823654174805
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2321856021881104
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.481 Vali Acc: 0.911 Test Loss: 0.481 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22546182
model size : 100.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.143317937850952
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.729 Vali Acc: 0.261 Test Loss: 1.729 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 0.8012290000915527
Epoch: 2, Steps: 12 | Train Loss: 1.629 Vali Loss: 1.507 Vali Acc: 0.456 Test Loss: 1.507 Test Acc: 0.456
Validation loss decreased (-0.261094 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 0.825526237487793
Epoch: 3, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.168 Vali Acc: 0.678 Test Loss: 1.168 Test Acc: 0.678
Validation loss decreased (-0.455540 --> -0.677766).  Saving model ...
Epoch: 4 cost time: 0.8442642688751221
Epoch: 4, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.799 Vali Acc: 0.739 Test Loss: 0.799 Test Acc: 0.739
Validation loss decreased (-0.677766 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 0.8785076141357422
Epoch: 5, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.554 Vali Acc: 0.772 Test Loss: 0.554 Test Acc: 0.772
Validation loss decreased (-0.738881 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 1.077460527420044
Epoch: 6, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.772217 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 0.8286504745483398
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.384 Vali Acc: 0.817 Test Loss: 0.384 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8736400604248047
Epoch: 8, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.370 Vali Acc: 0.828 Test Loss: 0.370 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9354524612426758
Epoch: 9, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.271 Vali Acc: 0.844 Test Loss: 0.271 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844442).  Saving model ...
Epoch: 10 cost time: 0.8405232429504395
Epoch: 10, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
Validation loss decreased (-0.844442 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.8367259502410889
Epoch: 11, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.397 Vali Acc: 0.856 Test Loss: 0.397 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7961740493774414
Epoch: 12, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.277 Vali Acc: 0.833 Test Loss: 0.277 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7819161415100098
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8809669017791748
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 15 cost time: 0.8412754535675049
Epoch: 15, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
Validation loss decreased (-0.888887 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 0.8061926364898682
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 0.8533070087432861
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.196 Vali Acc: 0.900 Test Loss: 0.196 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.103360652923584
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0597567558288574
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8787081241607666
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.198 Vali Acc: 0.900 Test Loss: 0.198 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0111474990844727
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 0.7929675579071045
Epoch: 22, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.191 Vali Acc: 0.906 Test Loss: 0.191 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9261322021484375
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9108505249023438
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 0.8583700656890869
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8040275573730469
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7534198760986328
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.939 Test Loss: 0.189 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 28 cost time: 0.8091974258422852
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8003363609313965
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8663234710693359
Epoch: 30, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.612 Vali Acc: 0.906 Test Loss: 0.612 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8379554748535156
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8606159687042236
Epoch: 32, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8772685527801514
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.392 Vali Acc: 0.906 Test Loss: 0.392 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9344143867492676
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.773003339767456
Epoch: 35, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8227076530456543
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.430 Vali Acc: 0.872 Test Loss: 0.430 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7732219696044922
Epoch: 37, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.433 Vali Acc: 0.894 Test Loss: 0.433 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22497030
model size : 100.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.051557779312134
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.619 Vali Acc: 0.417 Test Loss: 1.619 Test Acc: 0.417
Validation loss decreased (inf --> -0.416650).  Saving model ...
Epoch: 2 cost time: 1.0624446868896484
Epoch: 2, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.205 Vali Acc: 0.633 Test Loss: 1.205 Test Acc: 0.633
Validation loss decreased (-0.416650 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 1.1202759742736816
Epoch: 3, Steps: 12 | Train Loss: 0.989 Vali Loss: 0.799 Vali Acc: 0.683 Test Loss: 0.799 Test Acc: 0.683
Validation loss decreased (-0.633321 --> -0.683325).  Saving model ...
Epoch: 4 cost time: 1.113858938217163
Epoch: 4, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.585 Vali Acc: 0.700 Test Loss: 0.585 Test Acc: 0.700
Validation loss decreased (-0.683325 --> -0.699994).  Saving model ...
Epoch: 5 cost time: 1.1598615646362305
Epoch: 5, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
Validation loss decreased (-0.699994 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 1.0779097080230713
Epoch: 6, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.442 Vali Acc: 0.789 Test Loss: 0.442 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.199784278869629
Epoch: 7, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.268 Vali Acc: 0.861 Test Loss: 0.268 Test Acc: 0.861
Validation loss decreased (-0.788884 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 1.2243766784667969
Epoch: 8, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9662280082702637
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 10 cost time: 1.1621990203857422
Epoch: 10, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888887).  Saving model ...
Epoch: 11 cost time: 0.9839410781860352
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
Validation loss decreased (-0.888887 --> -0.905554).  Saving model ...
Epoch: 12 cost time: 1.24208664894104
Epoch: 12, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
Validation loss decreased (-0.905554 --> -0.922220).  Saving model ...
Epoch: 13 cost time: 1.147709846496582
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.443 Vali Acc: 0.883 Test Loss: 0.443 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0921733379364014
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.750 Vali Acc: 0.828 Test Loss: 0.750 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2845194339752197
Epoch: 15, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2632153034210205
Epoch: 16, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0064537525177002
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2227537631988525
Epoch: 18, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.230478048324585
Epoch: 19, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 20 cost time: 1.073335886001587
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.089778184890747
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3340198993682861
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.320425033569336
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.271359920501709
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1779882907867432
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.900 Test Loss: 0.181 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2082734107971191
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.495 Vali Acc: 0.917 Test Loss: 0.495 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1918368339538574
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1207878589630127
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.636 Vali Acc: 0.917 Test Loss: 0.636 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.203709363937378
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 22644486
model size : 101.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.965472936630249
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.693 Vali Acc: 0.322 Test Loss: 1.693 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.8926358222961426
Epoch: 2, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.381 Vali Acc: 0.594 Test Loss: 1.381 Test Acc: 0.594
Validation loss decreased (-0.322205 --> -0.594431).  Saving model ...
Epoch: 3 cost time: 0.8449780941009521
Epoch: 3, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
Validation loss decreased (-0.594431 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 0.8489077091217041
Epoch: 4, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.724 Vali Acc: 0.678 Test Loss: 0.724 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8690109252929688
Epoch: 5, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.551 Vali Acc: 0.739 Test Loss: 0.551 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738883).  Saving model ...
Epoch: 6 cost time: 0.7313337326049805
Epoch: 6, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.439 Vali Acc: 0.783 Test Loss: 0.439 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 0.957500696182251
Epoch: 7, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 0.8706636428833008
Epoch: 8, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.833330 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.8681249618530273
Epoch: 9, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.284 Vali Acc: 0.839 Test Loss: 0.284 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.873056173324585
Epoch: 10, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8421378135681152
Epoch: 11, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8118736743927002
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.321 Vali Acc: 0.828 Test Loss: 0.321 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8658287525177002
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.296 Vali Acc: 0.839 Test Loss: 0.296 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8463883399963379
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9691860675811768
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.437 Vali Acc: 0.867 Test Loss: 0.437 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8904991149902344
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0395748615264893
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.8948543071746826
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0642290115356445
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.476 Vali Acc: 0.894 Test Loss: 0.476 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.005225419998169
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7660679817199707
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9281907081604004
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.9604525566101074
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 0.8832497596740723
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.416 Vali Acc: 0.906 Test Loss: 0.416 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9345543384552002
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9355287551879883
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.635 Vali Acc: 0.894 Test Loss: 0.635 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8545117378234863
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 0.8835368156433105
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.439 Vali Acc: 0.906 Test Loss: 0.439 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1153197288513184
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.463 Vali Acc: 0.928 Test Loss: 0.463 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9078969955444336
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.472 Vali Acc: 0.911 Test Loss: 0.472 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8308651447296143
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.396 Vali Acc: 0.933 Test Loss: 0.396 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.8313422203063965
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.354 Vali Acc: 0.939 Test Loss: 0.354 Test Acc: 0.939
Validation loss decreased (-0.933329 --> -0.938885).  Saving model ...
Epoch: 33 cost time: 0.9427359104156494
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8635087013244629
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.460 Vali Acc: 0.894 Test Loss: 0.460 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9134726524353027
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0201022624969482
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.421 Vali Acc: 0.894 Test Loss: 0.421 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9446594715118408
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.876964807510376
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.410 Vali Acc: 0.928 Test Loss: 0.410 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9387483596801758
Epoch: 39, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.024794340133667
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.493 Vali Acc: 0.922 Test Loss: 0.493 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9923501014709473
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9876313209533691
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22576902
model size : 100.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.746152400970459
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.691 Vali Acc: 0.356 Test Loss: 1.691 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 0.81986403465271
Epoch: 2, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.452 Vali Acc: 0.622 Test Loss: 1.452 Test Acc: 0.622
Validation loss decreased (-0.355539 --> -0.622208).  Saving model ...
Epoch: 3 cost time: 0.7792055606842041
Epoch: 3, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.153 Vali Acc: 0.694 Test Loss: 1.153 Test Acc: 0.694
Validation loss decreased (-0.622208 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 0.8429818153381348
Epoch: 4, Steps: 12 | Train Loss: 1.075 Vali Loss: 0.850 Vali Acc: 0.733 Test Loss: 0.850 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733325).  Saving model ...
Epoch: 5 cost time: 0.8766899108886719
Epoch: 5, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.645 Vali Acc: 0.700 Test Loss: 0.645 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9823129177093506
Epoch: 6, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 0.9263989925384521
Epoch: 7, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.465 Vali Acc: 0.744 Test Loss: 0.465 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8691451549530029
Epoch: 8, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.410 Vali Acc: 0.789 Test Loss: 0.410 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788885).  Saving model ...
Epoch: 9 cost time: 0.8757658004760742
Epoch: 9, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
Validation loss decreased (-0.788885 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 0.9554288387298584
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 0.8856403827667236
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 0.8765926361083984
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9301643371582031
Epoch: 13, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
Validation loss decreased (-0.855553 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 0.9120125770568848
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.8667910099029541
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.252 Vali Acc: 0.883 Test Loss: 0.252 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8890671730041504
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.208 Vali Acc: 0.894 Test Loss: 0.208 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 0.8746612071990967
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 0.9019739627838135
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9258413314819336
Epoch: 19, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8911101818084717
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 1.1880860328674316
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.9495513439178467
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9574682712554932
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.818199872970581
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 0.9282395839691162
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.917 Test Loss: 0.150 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9253537654876709
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.161 Vali Acc: 0.911 Test Loss: 0.161 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9067952632904053
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8834140300750732
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.981081485748291
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0732026100158691
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.928 Test Loss: 0.151 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 1.0244526863098145
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9955630302429199
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.483 Vali Acc: 0.911 Test Loss: 0.483 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.841256856918335
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8349981307983398
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.363 Vali Acc: 0.894 Test Loss: 0.363 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9170196056365967
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9910659790039062
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.9433612823486328
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9614319801330566
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.917 Test Loss: 0.161 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9456453323364258
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9119133949279785
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8583266735076904
Epoch: 41, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.9162130355834961
Epoch: 42, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9112269878387451
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8999996185302734
Epoch: 44, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.309 Vali Acc: 0.939 Test Loss: 0.309 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 45 cost time: 0.7891988754272461
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9774301052093506
Epoch: 46, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8683695793151855
Epoch: 47, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8904438018798828
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.375 Vali Acc: 0.906 Test Loss: 0.375 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8466999530792236
Epoch: 49, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0294816493988037
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22546182
model size : 100.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1236231327056885
Epoch: 1, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.532 Vali Acc: 0.539 Test Loss: 1.532 Test Acc: 0.539
Validation loss decreased (inf --> -0.538874).  Saving model ...
Epoch: 2 cost time: 1.1382336616516113
Epoch: 2, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.043 Vali Acc: 0.728 Test Loss: 1.043 Test Acc: 0.728
Validation loss decreased (-0.538874 --> -0.727767).  Saving model ...
Epoch: 3 cost time: 1.081085205078125
Epoch: 3, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.622 Vali Acc: 0.778 Test Loss: 0.622 Test Acc: 0.778
Validation loss decreased (-0.727767 --> -0.777772).  Saving model ...
Epoch: 4 cost time: 1.1379246711730957
Epoch: 4, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.437 Vali Acc: 0.772 Test Loss: 0.437 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.182507038116455
Epoch: 5, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.169250726699829
Epoch: 6, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.492 Vali Acc: 0.794 Test Loss: 0.492 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.0241279602050781
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.302 Vali Acc: 0.828 Test Loss: 0.302 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827775).  Saving model ...
Epoch: 8 cost time: 1.1625142097473145
Epoch: 8, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0699329376220703
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
Validation loss decreased (-0.827775 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.0974953174591064
Epoch: 10, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.284113883972168
Epoch: 11, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 1.0908203125
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0058307647705078
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.951056957244873
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
Validation loss decreased (-0.872220 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 0.9580695629119873
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.186 Vali Acc: 0.911 Test Loss: 0.186 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 1.0327835083007812
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0760655403137207
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.386 Vali Acc: 0.917 Test Loss: 0.386 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.9400079250335693
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922219).  Saving model ...
Epoch: 19 cost time: 0.9787418842315674
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.865 Vali Acc: 0.856 Test Loss: 0.865 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8932192325592041
Epoch: 20, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0094225406646729
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.0003440380096436
Epoch: 22, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.653 Vali Acc: 0.883 Test Loss: 0.653 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0261671543121338
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.332 Vali Acc: 0.894 Test Loss: 0.332 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.078883171081543
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1331231594085693
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.630 Vali Acc: 0.917 Test Loss: 0.630 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2599682807922363
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 1.118391513824463
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.402 Vali Acc: 0.922 Test Loss: 0.402 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0689048767089844
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.888014554977417
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.363 Vali Acc: 0.928 Test Loss: 0.363 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.059363842010498
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9941956996917725
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.600 Vali Acc: 0.883 Test Loss: 0.600 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0750985145568848
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 1.0733277797698975
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.727 Vali Acc: 0.917 Test Loss: 0.727 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1494140625
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.468 Vali Acc: 0.928 Test Loss: 0.468 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.15537691116333
Epoch: 35, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.547 Vali Acc: 0.928 Test Loss: 0.547 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9875364303588867
Epoch: 36, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.473 Vali Acc: 0.917 Test Loss: 0.473 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8599700927734375
Epoch: 37, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.417 Vali Acc: 0.928 Test Loss: 0.417 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0741944313049316
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9645853042602539
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0358166694641113
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0026187896728516
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.015 Vali Acc: 0.906 Test Loss: 1.015 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9204316139221191
Epoch: 42, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.019 Vali Acc: 0.889 Test Loss: 1.019 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 22693638
model size : 101.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8653945922851562
Epoch: 1, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.700 Vali Acc: 0.322 Test Loss: 1.700 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 1.031721591949463
Epoch: 2, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.354 Vali Acc: 0.611 Test Loss: 1.354 Test Acc: 0.611
Validation loss decreased (-0.322205 --> -0.611098).  Saving model ...
Epoch: 3 cost time: 0.9224648475646973
Epoch: 3, Steps: 12 | Train Loss: 1.212 Vali Loss: 0.983 Vali Acc: 0.656 Test Loss: 0.983 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655546).  Saving model ...
Epoch: 4 cost time: 0.9477014541625977
Epoch: 4, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.654 Vali Acc: 0.767 Test Loss: 0.654 Test Acc: 0.767
Validation loss decreased (-0.655546 --> -0.766660).  Saving model ...
Epoch: 5 cost time: 0.8389291763305664
Epoch: 5, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.448 Vali Acc: 0.783 Test Loss: 0.448 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 0.9475421905517578
Epoch: 6, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.443 Vali Acc: 0.783 Test Loss: 0.443 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 0.8474111557006836
Epoch: 7, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.317 Vali Acc: 0.839 Test Loss: 0.317 Test Acc: 0.839
Validation loss decreased (-0.783329 --> -0.838886).  Saving model ...
Epoch: 8 cost time: 0.9629995822906494
Epoch: 8, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9525861740112305
Epoch: 9, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.491 Vali Acc: 0.828 Test Loss: 0.491 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9224238395690918
Epoch: 10, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9876136779785156
Epoch: 11, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.299 Vali Acc: 0.817 Test Loss: 0.299 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7942225933074951
Epoch: 12, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
Validation loss decreased (-0.838886 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 0.8431344032287598
Epoch: 13, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8384978771209717
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 0.8054471015930176
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 0.8539142608642578
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8701653480529785
Epoch: 17, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.89056396484375
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0140998363494873
Epoch: 19, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 20 cost time: 1.1397809982299805
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2254021167755127
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.430 Vali Acc: 0.889 Test Loss: 0.430 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2165577411651611
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2004015445709229
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.025010347366333
Epoch: 24, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0647048950195312
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0758647918701172
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1415083408355713
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0017273426055908
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.383 Vali Acc: 0.928 Test Loss: 0.383 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1029481887817383
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 22626054
model size : 100.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.022278070449829
Epoch: 1, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.642 Vali Acc: 0.417 Test Loss: 1.642 Test Acc: 0.417
Validation loss decreased (inf --> -0.416650).  Saving model ...
Epoch: 2 cost time: 0.8359405994415283
Epoch: 2, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.345 Vali Acc: 0.611 Test Loss: 1.345 Test Acc: 0.611
Validation loss decreased (-0.416650 --> -0.611098).  Saving model ...
Epoch: 3 cost time: 0.7707829475402832
Epoch: 3, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.040 Vali Acc: 0.683 Test Loss: 1.040 Test Acc: 0.683
Validation loss decreased (-0.611098 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 0.864886999130249
Epoch: 4, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
Validation loss decreased (-0.683323 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 0.8332605361938477
Epoch: 5, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.552 Vali Acc: 0.750 Test Loss: 0.552 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 0.741645336151123
Epoch: 6, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.476 Vali Acc: 0.772 Test Loss: 0.476 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 0.7986712455749512
Epoch: 7, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 0.9013795852661133
Epoch: 8, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.822218 --> -0.877774).  Saving model ...
Epoch: 9 cost time: 0.83880615234375
Epoch: 9, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8239068984985352
Epoch: 10, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7955296039581299
Epoch: 11, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7675132751464844
Epoch: 12, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8327581882476807
Epoch: 13, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.341 Vali Acc: 0.856 Test Loss: 0.341 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9692261219024658
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.249 Vali Acc: 0.867 Test Loss: 0.249 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8750443458557129
Epoch: 15, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.214 Vali Acc: 0.867 Test Loss: 0.214 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8917703628540039
Epoch: 16, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.240 Vali Acc: 0.867 Test Loss: 0.240 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0250654220581055
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 0.8342530727386475
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.207 Vali Acc: 0.878 Test Loss: 0.207 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.892693042755127
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.883331 --> -0.938887).  Saving model ...
Epoch: 20 cost time: 0.9154531955718994
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8399279117584229
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9117381572723389
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.222 Vali Acc: 0.878 Test Loss: 0.222 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.019679307937622
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.871593713760376
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.371 Vali Acc: 0.883 Test Loss: 0.371 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8698103427886963
Epoch: 25, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7987208366394043
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.445 Vali Acc: 0.883 Test Loss: 0.445 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9030740261077881
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7872014045715332
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8761093616485596
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22595334
model size : 100.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8073835372924805
Epoch: 1, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.637 Vali Acc: 0.383 Test Loss: 1.637 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 0.8352401256561279
Epoch: 2, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.225 Vali Acc: 0.650 Test Loss: 1.225 Test Acc: 0.650
Validation loss decreased (-0.383317 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 0.913851261138916
Epoch: 3, Steps: 12 | Train Loss: 1.132 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.649988 --> -0.749992).  Saving model ...
Epoch: 4 cost time: 1.0628228187561035
Epoch: 4, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.510 Vali Acc: 0.811 Test Loss: 0.510 Test Acc: 0.811
Validation loss decreased (-0.749992 --> -0.811106).  Saving model ...
Epoch: 5 cost time: 1.1809613704681396
Epoch: 5, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.416 Vali Acc: 0.789 Test Loss: 0.416 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1701574325561523
Epoch: 6, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.0106210708618164
Epoch: 7, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.437 Vali Acc: 0.839 Test Loss: 0.437 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 0.8210692405700684
Epoch: 8, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
Validation loss decreased (-0.838885 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 0.9789419174194336
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.366 Vali Acc: 0.867 Test Loss: 0.366 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9272780418395996
Epoch: 10, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.246 Vali Acc: 0.878 Test Loss: 0.246 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 0.8764004707336426
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 0.8993024826049805
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9802262783050537
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8266854286193848
Epoch: 14, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 0.9041883945465088
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.427 Vali Acc: 0.894 Test Loss: 0.427 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9259827136993408
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.0287446975708008
Epoch: 17, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.9757652282714844
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0599792003631592
Epoch: 19, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.9195082187652588
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9585208892822266
Epoch: 21, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8645749092102051
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9341292381286621
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.361 Vali Acc: 0.883 Test Loss: 0.361 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9572470188140869
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.472 Vali Acc: 0.928 Test Loss: 0.472 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927773).  Saving model ...
Epoch: 25 cost time: 0.8393139839172363
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9468169212341309
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.587 Vali Acc: 0.911 Test Loss: 0.587 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.029956579208374
Epoch: 27, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.491 Vali Acc: 0.894 Test Loss: 0.491 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8962180614471436
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.927773 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.9530415534973145
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9156830310821533
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.043482780456543
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1976814270019531
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.354 Vali Acc: 0.944 Test Loss: 0.354 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1232764720916748
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.894 Test Loss: 0.599 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1562864780426025
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9161262512207031
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.510 Vali Acc: 0.928 Test Loss: 0.510 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1200587749481201
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.911 Test Loss: 0.663 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9028830528259277
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.176314353942871
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.171 Vali Acc: 0.889 Test Loss: 1.171 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 22705926
model size : 101.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8175981044769287
Epoch: 1, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.703 Vali Acc: 0.333 Test Loss: 1.703 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 0.8718013763427734
Epoch: 2, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.378 Vali Acc: 0.594 Test Loss: 1.378 Test Acc: 0.594
Validation loss decreased (-0.333316 --> -0.594431).  Saving model ...
Epoch: 3 cost time: 0.976431131362915
Epoch: 3, Steps: 12 | Train Loss: 1.161 Vali Loss: 0.988 Vali Acc: 0.672 Test Loss: 0.988 Test Acc: 0.672
Validation loss decreased (-0.594431 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 1.0010037422180176
Epoch: 4, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
Validation loss decreased (-0.672212 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 0.819589376449585
Epoch: 5, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.473 Vali Acc: 0.806 Test Loss: 0.473 Test Acc: 0.806
Validation loss decreased (-0.738883 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 0.8891470432281494
Epoch: 6, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.378 Vali Acc: 0.778 Test Loss: 0.378 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8578481674194336
Epoch: 7, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.488 Vali Acc: 0.811 Test Loss: 0.488 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 8 cost time: 0.8511941432952881
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 0.7944481372833252
Epoch: 9, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 0.9782600402832031
Epoch: 10, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 0.8253378868103027
Epoch: 11, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.434 Vali Acc: 0.806 Test Loss: 0.434 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0140407085418701
Epoch: 12, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 0.9281635284423828
Epoch: 13, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 0.9301958084106445
Epoch: 14, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.975654125213623
Epoch: 15, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.194 Vali Acc: 0.906 Test Loss: 0.194 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905554).  Saving model ...
Epoch: 16 cost time: 0.9725930690765381
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.905554 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.9257538318634033
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9482676982879639
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8751993179321289
Epoch: 19, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8696622848510742
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8226819038391113
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8505954742431641
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8790993690490723
Epoch: 23, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 24 cost time: 0.9124398231506348
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.471 Vali Acc: 0.911 Test Loss: 0.471 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9748415946960449
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.130 Vali Acc: 0.933 Test Loss: 0.130 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 26 cost time: 0.8643457889556885
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9611878395080566
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.847832202911377
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9177510738372803
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9716911315917969
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.939 Test Loss: 0.247 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938886).  Saving model ...
Epoch: 31 cost time: 0.8923091888427734
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8495252132415771
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9759018421173096
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9480180740356445
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8637735843658447
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9097683429718018
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8860139846801758
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9294278621673584
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.389 Vali Acc: 0.939 Test Loss: 0.389 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8625257015228271
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8600878715515137
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 22669062
model size : 101.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1295206546783447
Epoch: 1, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.720 Vali Acc: 0.272 Test Loss: 1.720 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 0.9087038040161133
Epoch: 2, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.475 Vali Acc: 0.606 Test Loss: 1.475 Test Acc: 0.606
Validation loss decreased (-0.272205 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 0.8505716323852539
Epoch: 3, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.142 Vali Acc: 0.722 Test Loss: 1.142 Test Acc: 0.722
Validation loss decreased (-0.605541 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 0.9350364208221436
Epoch: 4, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.815 Vali Acc: 0.739 Test Loss: 0.815 Test Acc: 0.739
Validation loss decreased (-0.722211 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 0.8338406085968018
Epoch: 5, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.581 Vali Acc: 0.767 Test Loss: 0.581 Test Acc: 0.767
Validation loss decreased (-0.738881 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 0.955106258392334
Epoch: 6, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.467 Vali Acc: 0.778 Test Loss: 0.467 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 0.8230044841766357
Epoch: 7, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.411 Vali Acc: 0.817 Test Loss: 0.411 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 0.8701674938201904
Epoch: 8, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.345 Vali Acc: 0.828 Test Loss: 0.345 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 0.9541325569152832
Epoch: 9, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 0.8903534412384033
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.299 Vali Acc: 0.839 Test Loss: 0.299 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9411165714263916
Epoch: 11, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.261 Vali Acc: 0.861 Test Loss: 0.261 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 0.822462797164917
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9819073677062988
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.425 Vali Acc: 0.839 Test Loss: 0.425 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9210870265960693
Epoch: 14, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 0.928077220916748
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.226 Vali Acc: 0.878 Test Loss: 0.226 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9570157527923584
Epoch: 16, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7908399105072021
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 0.9213173389434814
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8566555976867676
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 0.9948508739471436
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.894235372543335
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.366 Vali Acc: 0.906 Test Loss: 0.366 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0615429878234863
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.941572904586792
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0744109153747559
Epoch: 24, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.987647294998169
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 0.9632453918457031
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.963402509689331
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.188 Vali Acc: 0.906 Test Loss: 0.188 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0097706317901611
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.930107831954956
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9228425025939941
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9438209533691406
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8155794143676758
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 33 cost time: 0.8899519443511963
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0345573425292969
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9565761089324951
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.351 Vali Acc: 0.906 Test Loss: 0.351 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0678553581237793
Epoch: 36, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9085211753845215
Epoch: 37, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9416084289550781
Epoch: 38, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0025553703308105
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9506945610046387
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9260199069976807
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.426 Vali Acc: 0.906 Test Loss: 0.426 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.859154462814331
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 22644486
model size : 101.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9857587814331055
Epoch: 1, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.565 Vali Acc: 0.550 Test Loss: 1.565 Test Acc: 0.550
Validation loss decreased (inf --> -0.549984).  Saving model ...
Epoch: 2 cost time: 1.0468173027038574
Epoch: 2, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.151 Vali Acc: 0.689 Test Loss: 1.151 Test Acc: 0.689
Validation loss decreased (-0.549984 --> -0.688877).  Saving model ...
Epoch: 3 cost time: 1.0776982307434082
Epoch: 3, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.734 Vali Acc: 0.739 Test Loss: 0.734 Test Acc: 0.739
Validation loss decreased (-0.688877 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 0.8785181045532227
Epoch: 4, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.475 Vali Acc: 0.800 Test Loss: 0.475 Test Acc: 0.800
Validation loss decreased (-0.738882 --> -0.799995).  Saving model ...
Epoch: 5 cost time: 1.0056943893432617
Epoch: 5, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 0.9628105163574219
Epoch: 6, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.314 Vali Acc: 0.828 Test Loss: 0.314 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827775).  Saving model ...
Epoch: 7 cost time: 1.0058858394622803
Epoch: 7, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
Validation loss decreased (-0.827775 --> -0.872219).  Saving model ...
Epoch: 8 cost time: 0.9756977558135986
Epoch: 8, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.940924882888794
Epoch: 9, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.868067741394043
Epoch: 10, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9175889492034912
Epoch: 11, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9460804462432861
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9133546352386475
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 0.9488980770111084
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 0.9887654781341553
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9084453582763672
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1627976894378662
Epoch: 17, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0035314559936523
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.905553 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 1.0699312686920166
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.162536859512329
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0269973278045654
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.384 Vali Acc: 0.928 Test Loss: 0.384 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.104384422302246
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.874169111251831
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0128848552703857
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9846954345703125
Epoch: 25, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8313241004943848
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8011372089385986
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.645 Vali Acc: 0.906 Test Loss: 0.645 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0593647956848145
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 22810374
model size : 101.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9857826232910156
Epoch: 1, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.542 Vali Acc: 0.472 Test Loss: 1.542 Test Acc: 0.472
Validation loss decreased (inf --> -0.472207).  Saving model ...
Epoch: 2 cost time: 0.8626198768615723
Epoch: 2, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.216 Vali Acc: 0.639 Test Loss: 1.216 Test Acc: 0.639
Validation loss decreased (-0.472207 --> -0.638877).  Saving model ...
Epoch: 3 cost time: 0.9222497940063477
Epoch: 3, Steps: 12 | Train Loss: 1.103 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
Validation loss decreased (-0.638877 --> -0.761102).  Saving model ...
Epoch: 4 cost time: 0.9723591804504395
Epoch: 4, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788883).  Saving model ...
Epoch: 5 cost time: 1.0242388248443604
Epoch: 5, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.488 Vali Acc: 0.750 Test Loss: 0.488 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9481050968170166
Epoch: 6, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.417 Vali Acc: 0.800 Test Loss: 0.417 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 0.9549775123596191
Epoch: 7, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 0.9093561172485352
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9132978916168213
Epoch: 9, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.091200828552246
Epoch: 10, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 0.8267052173614502
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0913598537445068
Epoch: 12, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.05068039894104
Epoch: 13, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8407835960388184
Epoch: 14, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.311272144317627
Epoch: 15, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 16 cost time: 0.9966864585876465
Epoch: 16, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9394237995147705
Epoch: 17, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9263851642608643
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 0.9734618663787842
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9280352592468262
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.0231401920318604
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.2179288864135742
Epoch: 22, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9269802570343018
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0365259647369385
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.146 Vali Acc: 0.933 Test Loss: 0.146 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 25 cost time: 0.9125151634216309
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8150951862335205
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0129611492156982
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8338532447814941
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8464739322662354
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8445253372192383
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8891470432281494
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8893618583679199
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8240339756011963
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.392 Vali Acc: 0.906 Test Loss: 0.392 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0131065845489502
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.403 Vali Acc: 0.906 Test Loss: 0.403 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 22767366
model size : 101.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8666152954101562
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.651 Vali Acc: 0.317 Test Loss: 1.651 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 0.8323521614074707
Epoch: 2, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.360 Vali Acc: 0.656 Test Loss: 1.360 Test Acc: 0.656
Validation loss decreased (-0.316650 --> -0.655542).  Saving model ...
Epoch: 3 cost time: 0.8093538284301758
Epoch: 3, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.070 Vali Acc: 0.683 Test Loss: 1.070 Test Acc: 0.683
Validation loss decreased (-0.655542 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 0.7020993232727051
Epoch: 4, Steps: 12 | Train Loss: 0.983 Vali Loss: 0.804 Vali Acc: 0.717 Test Loss: 0.804 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 0.7387385368347168
Epoch: 5, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.607 Vali Acc: 0.744 Test Loss: 0.607 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 0.8166191577911377
Epoch: 6, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.504 Vali Acc: 0.778 Test Loss: 0.504 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 0.8547699451446533
Epoch: 7, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.464 Vali Acc: 0.744 Test Loss: 0.464 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8970212936401367
Epoch: 8, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.400 Vali Acc: 0.794 Test Loss: 0.400 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 0.9335989952087402
Epoch: 9, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 10 cost time: 0.8639318943023682
Epoch: 10, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 0.9350559711456299
Epoch: 11, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.822219 --> -0.899997).  Saving model ...
Epoch: 12 cost time: 0.8757977485656738
Epoch: 12, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.283 Vali Acc: 0.844 Test Loss: 0.283 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9010300636291504
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8968431949615479
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.943718433380127
Epoch: 15, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.968313455581665
Epoch: 16, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0892200469970703
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0936534404754639
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 0.9936809539794922
Epoch: 19, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8212933540344238
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8968846797943115
Epoch: 21, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9395604133605957
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9378015995025635
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.9518747329711914
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9237446784973145
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9506502151489258
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.882659912109375
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.826909065246582
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.175436019897461
Epoch: 29, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.205 Vali Acc: 0.889 Test Loss: 0.205 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8230338096618652
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7595269680023193
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7490794658660889
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8915095329284668
Epoch: 33, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.410 Vali Acc: 0.894 Test Loss: 0.410 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_GPT4TS_UEA_ftM_sl51_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 22748934
model size : 101.45MB
