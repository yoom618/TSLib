Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.661848306655884
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.895941257476807
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.450914621353149
Epoch: 3, Steps: 20 | Train Loss: 0.766 Vali Loss: 1.096 Vali Acc: 0.490 Test Loss: 1.096 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.545774936676025
Epoch: 4, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 3.059319257736206
Epoch: 5, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.735 Vali Acc: 0.640 Test Loss: 0.735 Test Acc: 0.640
Validation loss decreased (-0.499992 --> -0.639993).  Saving model ...
Epoch: 6 cost time: 4.079316854476929
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.827 Vali Acc: 0.480 Test Loss: 0.827 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.958937168121338
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.794800043106079
Epoch: 8, Steps: 20 | Train Loss: 1.041 Vali Loss: 0.830 Vali Acc: 0.470 Test Loss: 0.830 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.1063456535339355
Epoch: 9, Steps: 20 | Train Loss: 0.868 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.896869659423828
Epoch: 10, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.900 Vali Acc: 0.490 Test Loss: 0.900 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.607192039489746
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.3312668800354
Epoch: 12, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.894 Vali Acc: 0.490 Test Loss: 0.894 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.062553882598877
Epoch: 13, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.714 Vali Acc: 0.620 Test Loss: 0.714 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.9308648109436035
Epoch: 14, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.993 Vali Acc: 0.530 Test Loss: 0.993 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.001912355422974
Epoch: 15, Steps: 20 | Train Loss: 0.730 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 43656194
model size : 181.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.169231653213501
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.841891050338745
Epoch: 2, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.9063851833343506
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.789 Vali Acc: 0.480 Test Loss: 0.789 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.162745475769043
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.187438011169434
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8607797622680664
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5023550987243652
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.791 Vali Acc: 0.600 Test Loss: 0.791 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 4.272974252700806
Epoch: 8, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.930051803588867
Epoch: 9, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.1446921825408936
Epoch: 10, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.942441701889038
Epoch: 11, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.876 Vali Acc: 0.490 Test Loss: 0.876 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.421480417251587
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.873643159866333
Epoch: 13, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.682 Vali Acc: 0.570 Test Loss: 0.682 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.153773784637451
Epoch: 14, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.758 Vali Acc: 0.540 Test Loss: 0.758 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.269942283630371
Epoch: 15, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.771 Vali Acc: 0.600 Test Loss: 0.771 Test Acc: 0.600
Validation loss decreased (-0.599992 --> -0.599992).  Saving model ...
Epoch: 16 cost time: 3.713866710662842
Epoch: 16, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.626680850982666
Epoch: 17, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.793 Vali Acc: 0.600 Test Loss: 0.793 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8651506900787354
Epoch: 18, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.295616865158081
Epoch: 19, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.720 Vali Acc: 0.610 Test Loss: 0.720 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609993).  Saving model ...
Epoch: 20 cost time: 4.281234979629517
Epoch: 20, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.917 Vali Acc: 0.510 Test Loss: 0.917 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.0117926597595215
Epoch: 21, Steps: 20 | Train Loss: 0.651 Vali Loss: 1.157 Vali Acc: 0.570 Test Loss: 1.157 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8037664890289307
Epoch: 22, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8489081859588623
Epoch: 23, Steps: 20 | Train Loss: 0.612 Vali Loss: 1.292 Vali Acc: 0.520 Test Loss: 1.292 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.7432913780212402
Epoch: 24, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.822 Vali Acc: 0.640 Test Loss: 0.822 Test Acc: 0.640
Validation loss decreased (-0.609993 --> -0.639992).  Saving model ...
Epoch: 25 cost time: 2.8775670528411865
Epoch: 25, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7896580696105957
Epoch: 26, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.930 Vali Acc: 0.520 Test Loss: 0.930 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2575058937072754
Epoch: 27, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.886 Vali Acc: 0.580 Test Loss: 0.886 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.7396743297576904
Epoch: 28, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.768 Vali Acc: 0.560 Test Loss: 0.768 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.7998087406158447
Epoch: 29, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.924 Vali Acc: 0.570 Test Loss: 0.924 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.650953531265259
Epoch: 30, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.963 Vali Acc: 0.610 Test Loss: 0.963 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.4762489795684814
Epoch: 31, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.938 Vali Acc: 0.530 Test Loss: 0.938 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.348585844039917
Epoch: 32, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.827 Vali Acc: 0.590 Test Loss: 0.827 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.816493511199951
Epoch: 33, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.314584732055664
Epoch: 34, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.112 Vali Acc: 0.590 Test Loss: 1.112 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 43582466
model size : 180.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.661441802978516
Epoch: 1, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 4.328651666641235
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.575287580490112
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2364513874053955
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.019 Vali Acc: 0.490 Test Loss: 1.019 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.085674285888672
Epoch: 5, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.941756963729858
Epoch: 6, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 5.025255918502808
Epoch: 7, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.677 Vali Acc: 0.620 Test Loss: 0.677 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619993).  Saving model ...
Epoch: 8 cost time: 4.391507625579834
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.331892013549805
Epoch: 9, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.913 Vali Acc: 0.530 Test Loss: 0.913 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.949657678604126
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.990959405899048
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6498031616210938
Epoch: 12, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4352312088012695
Epoch: 13, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.725 Vali Acc: 0.600 Test Loss: 0.725 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.419728994369507
Epoch: 14, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.283622980117798
Epoch: 15, Steps: 20 | Train Loss: 0.691 Vali Loss: 1.024 Vali Acc: 0.510 Test Loss: 1.024 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.071513652801514
Epoch: 16, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.870 Vali Acc: 0.490 Test Loss: 0.870 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.407430171966553
Epoch: 17, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.951 Vali Acc: 0.570 Test Loss: 0.951 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 43717634
model size : 181.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.2655229568481445
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.724 Vali Acc: 0.450 Test Loss: 0.724 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.3082964420318604
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.734 Vali Acc: 0.460 Test Loss: 0.734 Test Acc: 0.460
Validation loss decreased (-0.449993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 3.0085902214050293
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 3.991903066635132
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 4.433749198913574
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.973386526107788
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.751 Vali Acc: 0.450 Test Loss: 0.751 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.000943183898926
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.996290445327759
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.06790566444397
Epoch: 9, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.858 Vali Acc: 0.490 Test Loss: 0.858 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.575275182723999
Epoch: 10, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 11 cost time: 2.7591969966888428
Epoch: 11, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2599711418151855
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 13 cost time: 3.700904130935669
Epoch: 13, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.688 Vali Acc: 0.580 Test Loss: 0.688 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 3.648033857345581
Epoch: 14, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1136248111724854
Epoch: 15, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9806697368621826
Epoch: 16, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.97637939453125
Epoch: 17, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.317702054977417
Epoch: 18, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8221747875213623
Epoch: 19, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1328554153442383
Epoch: 20, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 21 cost time: 3.5366337299346924
Epoch: 21, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.818 Vali Acc: 0.620 Test Loss: 0.818 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619992).  Saving model ...
Epoch: 22 cost time: 3.117861747741699
Epoch: 22, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.902 Vali Acc: 0.530 Test Loss: 0.902 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.472794532775879
Epoch: 23, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.894 Vali Acc: 0.610 Test Loss: 0.894 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3535165786743164
Epoch: 24, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.785 Vali Acc: 0.620 Test Loss: 0.785 Test Acc: 0.620
Validation loss decreased (-0.619992 --> -0.619992).  Saving model ...
Epoch: 25 cost time: 2.8217203617095947
Epoch: 25, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.905 Vali Acc: 0.610 Test Loss: 0.905 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.42091703414917
Epoch: 26, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.069 Vali Acc: 0.590 Test Loss: 1.069 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.358349323272705
Epoch: 27, Steps: 20 | Train Loss: 0.606 Vali Loss: 1.122 Vali Acc: 0.570 Test Loss: 1.122 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.4323854446411133
Epoch: 28, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.184 Vali Acc: 0.470 Test Loss: 1.184 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.776796579360962
Epoch: 29, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.241443157196045
Epoch: 30, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.247 Vali Acc: 0.490 Test Loss: 1.247 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.5395424365997314
Epoch: 31, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.338 Vali Acc: 0.550 Test Loss: 1.338 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.44130802154541
Epoch: 32, Steps: 20 | Train Loss: 0.573 Vali Loss: 1.022 Vali Acc: 0.570 Test Loss: 1.022 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.5528481006622314
Epoch: 33, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.145 Vali Acc: 0.540 Test Loss: 1.145 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.783735990524292
Epoch: 34, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.287 Vali Acc: 0.480 Test Loss: 1.287 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 43643906
model size : 181.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.463615894317627
Epoch: 1, Steps: 20 | Train Loss: 0.816 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.003817319869995
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.848 Vali Acc: 0.480 Test Loss: 0.848 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6165757179260254
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.971017599105835
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 3.841181993484497
Epoch: 5, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.503369092941284
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.092492341995239
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.4049532413482666
Epoch: 8, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 3.0208117961883545
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.801 Vali Acc: 0.440 Test Loss: 0.801 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.328758478164673
Epoch: 10, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 3.0725290775299072
Epoch: 11, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.90443754196167
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9863760471343994
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.321877717971802
Epoch: 14, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.764 Vali Acc: 0.570 Test Loss: 0.764 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 4.221124887466431
Epoch: 15, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6161892414093018
Epoch: 16, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6434133052825928
Epoch: 17, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.808 Vali Acc: 0.600 Test Loss: 0.808 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 18 cost time: 2.2988226413726807
Epoch: 18, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.442317247390747
Epoch: 19, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.773 Vali Acc: 0.570 Test Loss: 0.773 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5813493728637695
Epoch: 20, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.924 Vali Acc: 0.580 Test Loss: 0.924 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2319352626800537
Epoch: 21, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.743 Vali Acc: 0.590 Test Loss: 0.743 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4317545890808105
Epoch: 22, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.441105604171753
Epoch: 23, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.914 Vali Acc: 0.520 Test Loss: 0.914 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.462385654449463
Epoch: 24, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.379328727722168
Epoch: 25, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.12410569190979
Epoch: 26, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.874 Vali Acc: 0.530 Test Loss: 0.874 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.254880666732788
Epoch: 27, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.258 Vali Acc: 0.530 Test Loss: 1.258 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 43619330
model size : 181.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.142560958862305
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.682403564453125
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.717 Vali Acc: 0.450 Test Loss: 0.717 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6259241104125977
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 4.074472188949585
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 4.328330993652344
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.890 Vali Acc: 0.550 Test Loss: 0.890 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 3.860785961151123
Epoch: 6, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.725 Vali Acc: 0.540 Test Loss: 0.725 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.174027442932129
Epoch: 7, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.716 Vali Acc: 0.570 Test Loss: 0.716 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 4.3279030323028564
Epoch: 8, Steps: 20 | Train Loss: 0.781 Vali Loss: 0.698 Vali Acc: 0.580 Test Loss: 0.698 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 4.318199396133423
Epoch: 9, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.647 Vali Acc: 0.620 Test Loss: 0.647 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619994).  Saving model ...
Epoch: 10 cost time: 4.482445001602173
Epoch: 10, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.860 Vali Acc: 0.530 Test Loss: 0.860 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.100444793701172
Epoch: 11, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.303391456604004
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.728 Vali Acc: 0.570 Test Loss: 0.728 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.386566877365112
Epoch: 13, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.0454020500183105
Epoch: 14, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.706 Vali Acc: 0.560 Test Loss: 0.706 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.088551044464111
Epoch: 15, Steps: 20 | Train Loss: 0.611 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.103097200393677
Epoch: 16, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.702 Vali Acc: 0.580 Test Loss: 0.702 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.071614503860474
Epoch: 17, Steps: 20 | Train Loss: 0.636 Vali Loss: 1.054 Vali Acc: 0.510 Test Loss: 1.054 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.273650407791138
Epoch: 18, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.826 Vali Acc: 0.580 Test Loss: 0.826 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.977548122406006
Epoch: 19, Steps: 20 | Train Loss: 0.675 Vali Loss: 1.038 Vali Acc: 0.490 Test Loss: 1.038 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 43779074
model size : 181.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.79794454574585
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.692 Vali Acc: 0.520 Test Loss: 0.692 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.9970648288726807
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8333868980407715
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.991525650024414
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 3.529825448989868
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.736497163772583
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.284296751022339
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.182584762573242
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 3.03739333152771
Epoch: 9, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.509777545928955
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.01289439201355
Epoch: 11, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9035634994506836
Epoch: 12, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.733 Vali Acc: 0.570 Test Loss: 0.733 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 2.3513171672821045
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 14 cost time: 2.808218479156494
Epoch: 14, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.724 Vali Acc: 0.580 Test Loss: 0.724 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0661962032318115
Epoch: 15, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.375256299972534
Epoch: 16, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.726 Vali Acc: 0.580 Test Loss: 0.726 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5840940475463867
Epoch: 17, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.906 Vali Acc: 0.540 Test Loss: 0.906 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0554537773132324
Epoch: 18, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9338324069976807
Epoch: 19, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.970 Vali Acc: 0.600 Test Loss: 0.970 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 3.2279696464538574
Epoch: 20, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4451911449432373
Epoch: 21, Steps: 20 | Train Loss: 0.501 Vali Loss: 1.181 Vali Acc: 0.470 Test Loss: 1.181 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7289280891418457
Epoch: 22, Steps: 20 | Train Loss: 0.560 Vali Loss: 1.019 Vali Acc: 0.530 Test Loss: 1.019 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.700984239578247
Epoch: 23, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.404848575592041
Epoch: 24, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.444974422454834
Epoch: 25, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.938 Vali Acc: 0.500 Test Loss: 0.938 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5344736576080322
Epoch: 26, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.015 Vali Acc: 0.550 Test Loss: 1.015 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.485875368118286
Epoch: 27, Steps: 20 | Train Loss: 0.496 Vali Loss: 1.101 Vali Acc: 0.570 Test Loss: 1.101 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.881335496902466
Epoch: 28, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.972388982772827
Epoch: 29, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.035 Vali Acc: 0.530 Test Loss: 1.035 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 43708418
model size : 181.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.750171661376953
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.707 Vali Acc: 0.470 Test Loss: 0.707 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.4902544021606445
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
Validation loss decreased (-0.469993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.8825864791870117
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5396580696105957
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.599269151687622
Epoch: 5, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.405578851699829
Epoch: 6, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1050565242767334
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.692 Vali Acc: 0.490 Test Loss: 0.692 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.727461814880371
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.708 Vali Acc: 0.570 Test Loss: 0.708 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 2.6032192707061768
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.374593496322632
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1258134841918945
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8969600200653076
Epoch: 12, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.016897439956665
Epoch: 13, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2088215351104736
Epoch: 14, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.847 Vali Acc: 0.520 Test Loss: 0.847 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1320252418518066
Epoch: 15, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.701 Vali Acc: 0.570 Test Loss: 0.701 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 16 cost time: 1.8994576930999756
Epoch: 16, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.723 Vali Acc: 0.590 Test Loss: 0.723 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 17 cost time: 2.2032997608184814
Epoch: 17, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0393166542053223
Epoch: 18, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7454636096954346
Epoch: 19, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.910 Vali Acc: 0.600 Test Loss: 0.910 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 20 cost time: 2.112567901611328
Epoch: 20, Steps: 20 | Train Loss: 0.563 Vali Loss: 1.011 Vali Acc: 0.560 Test Loss: 1.011 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.274448871612549
Epoch: 21, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3225955963134766
Epoch: 22, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1791954040527344
Epoch: 23, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.966 Vali Acc: 0.550 Test Loss: 0.966 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1980676651000977
Epoch: 24, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.862 Vali Acc: 0.510 Test Loss: 0.862 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.996239185333252
Epoch: 25, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.922 Vali Acc: 0.610 Test Loss: 0.922 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609991).  Saving model ...
Epoch: 26 cost time: 2.158233642578125
Epoch: 26, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.964 Vali Acc: 0.560 Test Loss: 0.964 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1563096046447754
Epoch: 27, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.006 Vali Acc: 0.530 Test Loss: 1.006 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8564128875732422
Epoch: 28, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.034 Vali Acc: 0.530 Test Loss: 1.034 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0962908267974854
Epoch: 29, Steps: 20 | Train Loss: 0.547 Vali Loss: 1.154 Vali Acc: 0.590 Test Loss: 1.154 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2837252616882324
Epoch: 30, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.214 Vali Acc: 0.590 Test Loss: 1.214 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2504513263702393
Epoch: 31, Steps: 20 | Train Loss: 0.367 Vali Loss: 1.109 Vali Acc: 0.610 Test Loss: 1.109 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.931135654449463
Epoch: 32, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.055 Vali Acc: 0.590 Test Loss: 1.055 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.910341501235962
Epoch: 33, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9416725635528564
Epoch: 34, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.468 Vali Acc: 0.500 Test Loss: 1.468 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8371498584747314
Epoch: 35, Steps: 20 | Train Loss: 0.367 Vali Loss: 1.516 Vali Acc: 0.520 Test Loss: 1.516 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 43671554
model size : 181.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.8773345947265625
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 4.1392576694488525
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.367811679840088
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.064572334289551
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.023019790649414
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.920973539352417
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4512414932250977
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.250441312789917
Epoch: 8, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.197758674621582
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.779 Vali Acc: 0.460 Test Loss: 0.779 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6728429794311523
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.441202402114868
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.703 Vali Acc: 0.580 Test Loss: 0.703 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 12 cost time: 4.1235716342926025
Epoch: 12, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.816328287124634
Epoch: 13, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.968014717102051
Epoch: 14, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.829 Vali Acc: 0.520 Test Loss: 0.829 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.706088066101074
Epoch: 15, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.824 Vali Acc: 0.620 Test Loss: 0.824 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619992).  Saving model ...
Epoch: 16 cost time: 3.9408047199249268
Epoch: 16, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.887 Vali Acc: 0.540 Test Loss: 0.887 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.646369218826294
Epoch: 17, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.985 Vali Acc: 0.520 Test Loss: 0.985 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.199190616607666
Epoch: 18, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.811 Vali Acc: 0.560 Test Loss: 0.811 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.981501579284668
Epoch: 19, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.941 Vali Acc: 0.520 Test Loss: 0.941 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.889608383178711
Epoch: 20, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.871 Vali Acc: 0.540 Test Loss: 0.871 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.805265426635742
Epoch: 21, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.333824872970581
Epoch: 22, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.799 Vali Acc: 0.570 Test Loss: 0.799 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.3972063064575195
Epoch: 23, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.974 Vali Acc: 0.560 Test Loss: 0.974 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2569565773010254
Epoch: 24, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.016 Vali Acc: 0.570 Test Loss: 1.016 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.6742968559265137
Epoch: 25, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.405 Vali Acc: 0.570 Test Loss: 1.405 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 43769858
model size : 181.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.267621278762817
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.674 Vali Acc: 0.560 Test Loss: 0.674 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.7678656578063965
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.707 Vali Acc: 0.530 Test Loss: 0.707 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.129807949066162
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.579967737197876
Epoch: 4, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.162976264953613
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.495842218399048
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8215763568878174
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8322393894195557
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.661609411239624
Epoch: 9, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.052375078201294
Epoch: 10, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.24110746383667
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 43748354
model size : 181.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8270130157470703
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.468405246734619
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0582528114318848
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.0712432861328125
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5069499015808105
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 2.665428876876831
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.8475613594055176
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.765 Vali Acc: 0.460 Test Loss: 0.765 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.543733596801758
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6133956909179688
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4171621799468994
Epoch: 10, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 2.7372970581054688
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.811 Vali Acc: 0.470 Test Loss: 0.811 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.527203321456909
Epoch: 12, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.29632830619812
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2240216732025146
Epoch: 14, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.724 Vali Acc: 0.630 Test Loss: 0.724 Test Acc: 0.630
Validation loss decreased (-0.529993 --> -0.629993).  Saving model ...
Epoch: 15 cost time: 1.785045862197876
Epoch: 15, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9912488460540771
Epoch: 16, Steps: 20 | Train Loss: 0.634 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6326830387115479
Epoch: 17, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.717 Vali Acc: 0.590 Test Loss: 0.717 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7770824432373047
Epoch: 18, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.828 Vali Acc: 0.510 Test Loss: 0.828 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6943728923797607
Epoch: 19, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7119042873382568
Epoch: 20, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.873 Vali Acc: 0.550 Test Loss: 0.873 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1084799766540527
Epoch: 21, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.922 Vali Acc: 0.550 Test Loss: 0.922 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7978999614715576
Epoch: 22, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.782 Vali Acc: 0.540 Test Loss: 0.782 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0268394947052
Epoch: 23, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.940 Vali Acc: 0.550 Test Loss: 0.940 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6927106380462646
Epoch: 24, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 43729922
model size : 181.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.890558958053589
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.678 Vali Acc: 0.500 Test Loss: 0.678 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8998405933380127
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.623577833175659
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7461283206939697
Epoch: 4, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.735522985458374
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.122058868408203
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 3.0656490325927734
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 3.0553815364837646
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8754730224609375
Epoch: 9, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3065600395202637
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 2.7181179523468018
Epoch: 11, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.804 Vali Acc: 0.550 Test Loss: 0.804 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 3.400322914123535
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0756986141204834
Epoch: 13, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.905 Vali Acc: 0.510 Test Loss: 0.905 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.221064805984497
Epoch: 14, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.817 Vali Acc: 0.580 Test Loss: 0.817 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579992).  Saving model ...
Epoch: 15 cost time: 3.3690929412841797
Epoch: 15, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.782 Vali Acc: 0.570 Test Loss: 0.782 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.352813959121704
Epoch: 16, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589993).  Saving model ...
Epoch: 17 cost time: 3.5802104473114014
Epoch: 17, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.931 Vali Acc: 0.540 Test Loss: 0.931 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4754796028137207
Epoch: 18, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.998 Vali Acc: 0.590 Test Loss: 0.998 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6633570194244385
Epoch: 19, Steps: 20 | Train Loss: 0.541 Vali Loss: 1.068 Vali Acc: 0.590 Test Loss: 1.068 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.831615924835205
Epoch: 20, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.135667562484741
Epoch: 21, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.034 Vali Acc: 0.530 Test Loss: 1.034 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1366918087005615
Epoch: 22, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.178 Vali Acc: 0.510 Test Loss: 1.178 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.397489309310913
Epoch: 23, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.908 Vali Acc: 0.540 Test Loss: 0.908 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.194775104522705
Epoch: 24, Steps: 20 | Train Loss: 0.542 Vali Loss: 1.018 Vali Acc: 0.530 Test Loss: 1.018 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.4490766525268555
Epoch: 25, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.098 Vali Acc: 0.630 Test Loss: 1.098 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629989).  Saving model ...
Epoch: 26 cost time: 2.253797769546509
Epoch: 26, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.476317882537842
Epoch: 27, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4897828102111816
Epoch: 28, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.280 Vali Acc: 0.530 Test Loss: 1.280 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7800307273864746
Epoch: 29, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.465 Vali Acc: 0.550 Test Loss: 1.465 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.329352855682373
Epoch: 30, Steps: 20 | Train Loss: 0.413 Vali Loss: 1.352 Vali Acc: 0.580 Test Loss: 1.352 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.854433536529541
Epoch: 31, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3571152687072754
Epoch: 32, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.1959519386291504
Epoch: 33, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.330 Vali Acc: 0.470 Test Loss: 1.330 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3859965801239014
Epoch: 34, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.477 Vali Acc: 0.580 Test Loss: 1.477 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.2612550258636475
Epoch: 35, Steps: 20 | Train Loss: 0.755 Vali Loss: 2.444 Vali Acc: 0.520 Test Loss: 2.444 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 43834370
model size : 181.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.338733673095703
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.836315631866455
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.786 Vali Acc: 0.480 Test Loss: 0.786 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.564088821411133
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.032179832458496
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.6575145721435547
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5357978343963623
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 2.082672119140625
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.830 Vali Acc: 0.480 Test Loss: 0.830 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0191071033477783
Epoch: 8, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0114965438842773
Epoch: 9, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.676844358444214
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4279892444610596
Epoch: 11, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4221644401550293
Epoch: 12, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6527409553527832
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.915 Vali Acc: 0.540 Test Loss: 0.915 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3061554431915283
Epoch: 14, Steps: 20 | Train Loss: 0.675 Vali Loss: 1.182 Vali Acc: 0.480 Test Loss: 1.182 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.364556074142456
Epoch: 15, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.792 Vali Acc: 0.550 Test Loss: 0.792 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 16 cost time: 1.926250696182251
Epoch: 16, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.699 Vali Acc: 0.570 Test Loss: 0.699 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569993).  Saving model ...
Epoch: 17 cost time: 1.9765775203704834
Epoch: 17, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.861 Vali Acc: 0.480 Test Loss: 0.861 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.363419771194458
Epoch: 18, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.826 Vali Acc: 0.580 Test Loss: 0.826 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 19 cost time: 2.4583778381347656
Epoch: 19, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0833351612091064
Epoch: 20, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.408048629760742
Epoch: 21, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.347515344619751
Epoch: 22, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.844 Vali Acc: 0.580 Test Loss: 0.844 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.358330011367798
Epoch: 23, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.437941551208496
Epoch: 24, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.983 Vali Acc: 0.520 Test Loss: 0.983 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.465768814086914
Epoch: 25, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.855 Vali Acc: 0.550 Test Loss: 0.855 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3466274738311768
Epoch: 26, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.272814989089966
Epoch: 27, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.967 Vali Acc: 0.570 Test Loss: 0.967 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.255290985107422
Epoch: 28, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.887 Vali Acc: 0.540 Test Loss: 0.887 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 43809794
model size : 181.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.456663608551025
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.6037826538085938
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3664073944091797
Epoch: 3, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.044250011444092
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0419116020202637
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.414792776107788
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 1.8547632694244385
Epoch: 7, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3335015773773193
Epoch: 8, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.514174461364746
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7227919101715088
Epoch: 10, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7458076477050781
Epoch: 11, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.1105811595916748
Epoch: 12, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4405500888824463
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 1.283724308013916
Epoch: 14, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4099111557006836
Epoch: 15, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6340889930725098
Epoch: 16, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8394362926483154
Epoch: 17, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3337931632995605
Epoch: 18, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.831 Vali Acc: 0.570 Test Loss: 0.831 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 19 cost time: 1.238767385482788
Epoch: 19, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.885 Vali Acc: 0.520 Test Loss: 0.885 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6418943405151367
Epoch: 20, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5276825428009033
Epoch: 21, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.891 Vali Acc: 0.520 Test Loss: 0.891 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6271815299987793
Epoch: 22, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.823 Vali Acc: 0.550 Test Loss: 0.823 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5139737129211426
Epoch: 23, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.947 Vali Acc: 0.560 Test Loss: 0.947 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6549713611602783
Epoch: 24, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.821 Vali Acc: 0.580 Test Loss: 0.821 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 25 cost time: 1.809657096862793
Epoch: 25, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.920 Vali Acc: 0.600 Test Loss: 0.920 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599991).  Saving model ...
Epoch: 26 cost time: 1.4189894199371338
Epoch: 26, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.021 Vali Acc: 0.540 Test Loss: 1.021 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6106665134429932
Epoch: 27, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.129 Vali Acc: 0.540 Test Loss: 1.129 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6310279369354248
Epoch: 28, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.054 Vali Acc: 0.570 Test Loss: 1.054 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.160093069076538
Epoch: 29, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.946 Vali Acc: 0.570 Test Loss: 0.946 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.001911163330078
Epoch: 30, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.959 Vali Acc: 0.540 Test Loss: 0.959 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.908911943435669
Epoch: 31, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.959 Vali Acc: 0.560 Test Loss: 0.959 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0068185329437256
Epoch: 32, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.157 Vali Acc: 0.590 Test Loss: 1.157 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8236083984375
Epoch: 33, Steps: 20 | Train Loss: 0.312 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.333167314529419
Epoch: 34, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.068 Vali Acc: 0.510 Test Loss: 1.068 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9214096069335938
Epoch: 35, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.021 Vali Acc: 0.580 Test Loss: 1.021 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 43788290
model size : 181.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.337239027023315
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 4.044959306716919
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2716362476348877
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 3.130953788757324
Epoch: 4, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0546247959136963
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.366424560546875
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.691 Vali Acc: 0.600 Test Loss: 0.691 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599993).  Saving model ...
Epoch: 7 cost time: 3.2458460330963135
Epoch: 7, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.780 Vali Acc: 0.460 Test Loss: 0.780 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6490566730499268
Epoch: 8, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8097660541534424
Epoch: 9, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.716 Vali Acc: 0.600 Test Loss: 0.716 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6023502349853516
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.695 Vali Acc: 0.630 Test Loss: 0.695 Test Acc: 0.630
Validation loss decreased (-0.599993 --> -0.629993).  Saving model ...
Epoch: 11 cost time: 2.8450331687927246
Epoch: 11, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9252614974975586
Epoch: 12, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.850 Vali Acc: 0.540 Test Loss: 0.850 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.993553400039673
Epoch: 13, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.651968002319336
Epoch: 14, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.680 Vali Acc: 0.560 Test Loss: 0.680 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.184993267059326
Epoch: 15, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.102010488510132
Epoch: 16, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.571296453475952
Epoch: 17, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.893317937850952
Epoch: 18, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.694 Vali Acc: 0.590 Test Loss: 0.694 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.653261661529541
Epoch: 19, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.097 Vali Acc: 0.510 Test Loss: 1.097 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.529698371887207
Epoch: 20, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 43895810
model size : 182.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5309865474700928
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.9713077545166016
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2956788539886475
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.267681121826172
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7847719192504883
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8845257759094238
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.790 Vali Acc: 0.460 Test Loss: 0.790 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.071899890899658
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0219640731811523
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.814 Vali Acc: 0.440 Test Loss: 0.814 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2707114219665527
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.882610559463501
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2404909133911133
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 2.077195644378662
Epoch: 12, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.771 Vali Acc: 0.650 Test Loss: 0.771 Test Acc: 0.650
Validation loss decreased (-0.549993 --> -0.649992).  Saving model ...
Epoch: 13 cost time: 2.318206310272217
Epoch: 13, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.643 Vali Acc: 0.640 Test Loss: 0.643 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1206109523773193
Epoch: 14, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.659 Vali Acc: 0.540 Test Loss: 0.659 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5862300395965576
Epoch: 15, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7012903690338135
Epoch: 16, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.810 Vali Acc: 0.580 Test Loss: 0.810 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5989973545074463
Epoch: 17, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.702 Vali Acc: 0.570 Test Loss: 0.702 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5821280479431152
Epoch: 18, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.823 Vali Acc: 0.550 Test Loss: 0.823 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.074789524078369
Epoch: 19, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.846 Vali Acc: 0.530 Test Loss: 0.846 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9999380111694336
Epoch: 20, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3247408866882324
Epoch: 21, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.105736255645752
Epoch: 22, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 43862018
model size : 182.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.738571882247925
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.5336408615112305
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.688 Vali Acc: 0.500 Test Loss: 0.688 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7461683750152588
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5867981910705566
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7350749969482422
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.604400634765625
Epoch: 6, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.631077527999878
Epoch: 7, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1290884017944336
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.584007978439331
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6878993511199951
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9523770809173584
Epoch: 11, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.686 Vali Acc: 0.600 Test Loss: 0.686 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 1.3825464248657227
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.674 Vali Acc: 0.550 Test Loss: 0.674 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4716236591339111
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.800 Vali Acc: 0.490 Test Loss: 0.800 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4707331657409668
Epoch: 14, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.887 Vali Acc: 0.510 Test Loss: 0.887 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8506155014038086
Epoch: 15, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6094551086425781
Epoch: 16, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5128250122070312
Epoch: 17, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6985583305358887
Epoch: 18, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8447742462158203
Epoch: 19, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.006 Vali Acc: 0.490 Test Loss: 1.006 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.516289472579956
Epoch: 20, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.153 Vali Acc: 0.480 Test Loss: 1.153 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3868751525878906
Epoch: 21, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.960 Vali Acc: 0.550 Test Loss: 0.960 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 43849730
model size : 181.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.8643128871917725
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.688 Vali Acc: 0.460 Test Loss: 0.688 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 3.5520875453948975
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
Validation loss decreased (-0.459993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 4.274259090423584
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8869900703430176
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.345170021057129
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.520534992218018
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.3809356689453125
Epoch: 7, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.834 Vali Acc: 0.480 Test Loss: 0.834 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3574767112731934
Epoch: 8, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8830976486206055
Epoch: 9, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 4.605594873428345
Epoch: 10, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9341113567352295
Epoch: 11, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 3.4062047004699707
Epoch: 12, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.687 Vali Acc: 0.630 Test Loss: 0.687 Test Acc: 0.630
Validation loss decreased (-0.549992 --> -0.629993).  Saving model ...
Epoch: 13 cost time: 3.735088348388672
Epoch: 13, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.717 Vali Acc: 0.600 Test Loss: 0.717 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.174964666366577
Epoch: 14, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.843 Vali Acc: 0.480 Test Loss: 0.843 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9795894622802734
Epoch: 15, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8807146549224854
Epoch: 16, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6496453285217285
Epoch: 17, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.812 Vali Acc: 0.440 Test Loss: 0.812 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4824483394622803
Epoch: 18, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.807 Vali Acc: 0.570 Test Loss: 0.807 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.164959669113159
Epoch: 19, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.752 Vali Acc: 0.580 Test Loss: 0.752 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7174298763275146
Epoch: 20, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.053 Vali Acc: 0.500 Test Loss: 1.053 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.6767759323120117
Epoch: 21, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.659344434738159
Epoch: 22, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.006 Vali Acc: 0.470 Test Loss: 1.006 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 43960322
model size : 182.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.127598285675049
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.703 Vali Acc: 0.440 Test Loss: 0.703 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.7534728050231934
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (-0.439993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.769479513168335
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9874253273010254
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9613568782806396
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.393969774246216
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 2.1059963703155518
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3289663791656494
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.827 Vali Acc: 0.470 Test Loss: 0.827 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1019322872161865
Epoch: 9, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 2.368288040161133
Epoch: 10, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5347020626068115
Epoch: 11, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.678 Vali Acc: 0.610 Test Loss: 0.678 Test Acc: 0.610
Validation loss decreased (-0.529993 --> -0.609993).  Saving model ...
Epoch: 12 cost time: 2.0362250804901123
Epoch: 12, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.913 Vali Acc: 0.560 Test Loss: 0.913 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1439926624298096
Epoch: 13, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6854467391967773
Epoch: 14, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.666 Vali Acc: 0.580 Test Loss: 0.666 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.503675699234009
Epoch: 15, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3956692218780518
Epoch: 16, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.709 Vali Acc: 0.600 Test Loss: 0.709 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2771003246307373
Epoch: 17, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.751 Vali Acc: 0.590 Test Loss: 0.751 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.228147268295288
Epoch: 18, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.738 Vali Acc: 0.590 Test Loss: 0.738 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5194313526153564
Epoch: 19, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.596607208251953
Epoch: 20, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.73055362701416
Epoch: 21, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 43926530
model size : 182.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8216562271118164
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.704 Vali Acc: 0.480 Test Loss: 0.704 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.8884356021881104
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.7767715454101562
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9926834106445312
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.9938771724700928
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2134578227996826
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8953676223754883
Epoch: 7, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.725 Vali Acc: 0.540 Test Loss: 0.725 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.9710192680358887
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.11149263381958
Epoch: 9, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.825 Vali Acc: 0.470 Test Loss: 0.825 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.169722080230713
Epoch: 10, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.730 Vali Acc: 0.570 Test Loss: 0.730 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 1.1741647720336914
Epoch: 11, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4361951351165771
Epoch: 12, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8141810894012451
Epoch: 13, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.613232135772705
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2628695964813232
Epoch: 15, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.746 Vali Acc: 0.580 Test Loss: 0.746 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 16 cost time: 1.9237947463989258
Epoch: 16, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6271758079528809
Epoch: 17, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.915 Vali Acc: 0.510 Test Loss: 0.915 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7909672260284424
Epoch: 18, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8706293106079102
Epoch: 19, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.877 Vali Acc: 0.540 Test Loss: 0.877 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.847818374633789
Epoch: 20, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6769084930419922
Epoch: 21, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.841 Vali Acc: 0.570 Test Loss: 0.841 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6436710357666016
Epoch: 22, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5234806537628174
Epoch: 23, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.995 Vali Acc: 0.550 Test Loss: 0.995 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6089270114898682
Epoch: 24, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.855 Vali Acc: 0.540 Test Loss: 0.855 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.714346170425415
Epoch: 25, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 43911170
model size : 182.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7726211547851562
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.1845974922180176
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2980754375457764
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1296770572662354
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0005292892456055
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.788614273071289
Epoch: 6, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8152689933776855
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.050468683242798
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.740 Vali Acc: 0.560 Test Loss: 0.740 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.8188610076904297
Epoch: 9, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.961 Vali Acc: 0.540 Test Loss: 0.961 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.914675235748291
Epoch: 10, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1499650478363037
Epoch: 11, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0371415615081787
Epoch: 12, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.204047918319702
Epoch: 13, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.731 Vali Acc: 0.560 Test Loss: 0.731 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 2.2892701625823975
Epoch: 14, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.889 Vali Acc: 0.590 Test Loss: 0.889 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589991).  Saving model ...
Epoch: 15 cost time: 2.2262213230133057
Epoch: 15, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2058188915252686
Epoch: 16, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.15191912651062
Epoch: 17, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.907926082611084
Epoch: 18, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.929 Vali Acc: 0.540 Test Loss: 0.929 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.987243413925171
Epoch: 19, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.974 Vali Acc: 0.530 Test Loss: 0.974 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.446462869644165
Epoch: 20, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.068 Vali Acc: 0.520 Test Loss: 1.068 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.174546957015991
Epoch: 21, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.134 Vali Acc: 0.560 Test Loss: 1.134 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.184340476989746
Epoch: 22, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.274 Vali Acc: 0.550 Test Loss: 1.274 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.19062876701355
Epoch: 23, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.067 Vali Acc: 0.580 Test Loss: 1.067 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8294320106506348
Epoch: 24, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.053 Vali Acc: 0.540 Test Loss: 1.053 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 44000258
model size : 182.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.917224645614624
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.779106855392456
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3767940998077393
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6609902381896973
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.690 Vali Acc: 0.500 Test Loss: 0.690 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7044463157653809
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.306577205657959
Epoch: 6, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.865438461303711
Epoch: 7, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.809 Vali Acc: 0.530 Test Loss: 0.809 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 2.0788285732269287
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9428911209106445
Epoch: 9, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.931 Vali Acc: 0.450 Test Loss: 0.931 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6442124843597412
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 1.5458316802978516
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.036271095275879
Epoch: 12, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.730 Vali Acc: 0.560 Test Loss: 0.730 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 1.6496500968933105
Epoch: 13, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.897 Vali Acc: 0.580 Test Loss: 0.897 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579991).  Saving model ...
Epoch: 14 cost time: 1.9283123016357422
Epoch: 14, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.722 Vali Acc: 0.590 Test Loss: 0.722 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589993).  Saving model ...
Epoch: 15 cost time: 1.732283353805542
Epoch: 15, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.750 Vali Acc: 0.580 Test Loss: 0.750 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0598857402801514
Epoch: 16, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.852 Vali Acc: 0.550 Test Loss: 0.852 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6265144348144531
Epoch: 17, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.967 Vali Acc: 0.570 Test Loss: 0.967 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8886513710021973
Epoch: 18, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3604934215545654
Epoch: 19, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.796036720275879
Epoch: 20, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.949 Vali Acc: 0.540 Test Loss: 0.949 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.347790241241455
Epoch: 21, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.915 Vali Acc: 0.520 Test Loss: 0.915 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.310697317123413
Epoch: 22, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.938 Vali Acc: 0.580 Test Loss: 0.938 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6994242668151855
Epoch: 23, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.078 Vali Acc: 0.620 Test Loss: 1.078 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619989).  Saving model ...
Epoch: 24 cost time: 1.9172415733337402
Epoch: 24, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.068 Vali Acc: 0.540 Test Loss: 1.068 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4405159950256348
Epoch: 25, Steps: 20 | Train Loss: 0.342 Vali Loss: 0.945 Vali Acc: 0.560 Test Loss: 0.945 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.090254783630371
Epoch: 26, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.993 Vali Acc: 0.610 Test Loss: 0.993 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.091567039489746
Epoch: 27, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.322 Vali Acc: 0.480 Test Loss: 1.322 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7203712463378906
Epoch: 28, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.126 Vali Acc: 0.560 Test Loss: 1.126 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9756617546081543
Epoch: 29, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.149 Vali Acc: 0.530 Test Loss: 1.149 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8513402938842773
Epoch: 30, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.133 Vali Acc: 0.630 Test Loss: 1.133 Test Acc: 0.630
Validation loss decreased (-0.619989 --> -0.629989).  Saving model ...
Epoch: 31 cost time: 1.8823764324188232
Epoch: 31, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.016 Vali Acc: 0.530 Test Loss: 1.016 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.126438856124878
Epoch: 32, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.107 Vali Acc: 0.560 Test Loss: 1.107 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0944948196411133
Epoch: 33, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.079 Vali Acc: 0.580 Test Loss: 1.079 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.725583791732788
Epoch: 34, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7750334739685059
Epoch: 35, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.197 Vali Acc: 0.540 Test Loss: 1.197 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.1892282962799072
Epoch: 36, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.334 Vali Acc: 0.520 Test Loss: 1.334 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8381853103637695
Epoch: 37, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.343 Vali Acc: 0.580 Test Loss: 1.343 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5060689449310303
Epoch: 38, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.209 Vali Acc: 0.540 Test Loss: 1.209 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8044991493225098
Epoch: 39, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.109 Vali Acc: 0.610 Test Loss: 1.109 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.673424482345581
Epoch: 40, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.238 Vali Acc: 0.560 Test Loss: 1.238 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 43984898
model size : 182.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3294997215270996
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3649265766143799
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.692 Vali Acc: 0.530 Test Loss: 0.692 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.5675828456878662
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5870029926300049
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7072038650512695
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6980111598968506
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7874677181243896
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7700119018554688
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.6896815299987793
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.673 Vali Acc: 0.570 Test Loss: 0.673 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 10 cost time: 1.7703983783721924
Epoch: 10, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.746511697769165
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.654 Vali Acc: 0.560 Test Loss: 0.654 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6362841129302979
Epoch: 12, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.659 Vali Acc: 0.560 Test Loss: 0.659 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6427478790283203
Epoch: 13, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.719 Vali Acc: 0.620 Test Loss: 0.719 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619993).  Saving model ...
Epoch: 14 cost time: 1.6231365203857422
Epoch: 14, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5212316513061523
Epoch: 15, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.568758487701416
Epoch: 16, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.87752366065979
Epoch: 17, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.700 Vali Acc: 0.600 Test Loss: 0.700 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8075613975524902
Epoch: 18, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6312406063079834
Epoch: 19, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.056992769241333
Epoch: 20, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.882 Vali Acc: 0.590 Test Loss: 0.882 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8223567008972168
Epoch: 21, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.977 Vali Acc: 0.560 Test Loss: 0.977 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8300209045410156
Epoch: 22, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.937 Vali Acc: 0.570 Test Loss: 0.937 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0102717876434326
Epoch: 23, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 43972610
model size : 182.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.469712734222412
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.133418083190918
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.734 Vali Acc: 0.470 Test Loss: 0.734 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.915187120437622
Epoch: 3, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 2.089393138885498
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0933215618133545
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.15521240234375
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8591465950012207
Epoch: 7, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4697132110595703
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.739 Vali Acc: 0.580 Test Loss: 0.739 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 1.7989509105682373
Epoch: 9, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.705 Vali Acc: 0.520 Test Loss: 0.705 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.267759323120117
Epoch: 10, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.410482406616211
Epoch: 11, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.751 Vali Acc: 0.560 Test Loss: 0.751 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.501112937927246
Epoch: 12, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.415712356567383
Epoch: 13, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.656 Vali Acc: 0.620 Test Loss: 0.656 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619993).  Saving model ...
Epoch: 14 cost time: 2.361367702484131
Epoch: 14, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4281704425811768
Epoch: 15, Steps: 20 | Train Loss: 0.522 Vali Loss: 1.012 Vali Acc: 0.460 Test Loss: 1.012 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.444617986679077
Epoch: 16, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.714859962463379
Epoch: 17, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.943 Vali Acc: 0.540 Test Loss: 0.943 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3059916496276855
Epoch: 18, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.876 Vali Acc: 0.550 Test Loss: 0.876 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0126311779022217
Epoch: 19, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.844 Vali Acc: 0.560 Test Loss: 0.844 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.594226598739624
Epoch: 20, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.344916820526123
Epoch: 21, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6767749786376953
Epoch: 22, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.918 Vali Acc: 0.550 Test Loss: 0.918 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.288062572479248
Epoch: 23, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.045 Vali Acc: 0.590 Test Loss: 1.045 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 44064770
model size : 182.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.966773271560669
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.9622776508331299
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.988778829574585
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.699 Vali Acc: 0.490 Test Loss: 0.699 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.945289134979248
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0068233013153076
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 1.8439476490020752
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7623331546783447
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.6442723274230957
Epoch: 8, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8987045288085938
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8360276222229004
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.6940760612487793
Epoch: 11, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 1.5790643692016602
Epoch: 12, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.965996503829956
Epoch: 13, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.713 Vali Acc: 0.600 Test Loss: 0.713 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 1.7840564250946045
Epoch: 14, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.884 Vali Acc: 0.550 Test Loss: 0.884 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8250858783721924
Epoch: 15, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1260921955108643
Epoch: 16, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.702 Vali Acc: 0.600 Test Loss: 0.702 Test Acc: 0.600
Validation loss decreased (-0.599993 --> -0.599993).  Saving model ...
Epoch: 17 cost time: 1.7837715148925781
Epoch: 17, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5993783473968506
Epoch: 18, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.804 Vali Acc: 0.590 Test Loss: 0.804 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.587486982345581
Epoch: 19, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4245638847351074
Epoch: 20, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3664467334747314
Epoch: 21, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.564039707183838
Epoch: 22, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.788 Vali Acc: 0.520 Test Loss: 0.788 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4003303050994873
Epoch: 23, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.796 Vali Acc: 0.640 Test Loss: 0.796 Test Acc: 0.640
Validation loss decreased (-0.599993 --> -0.639992).  Saving model ...
Epoch: 24 cost time: 1.4720463752746582
Epoch: 24, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4982926845550537
Epoch: 25, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.971 Vali Acc: 0.550 Test Loss: 0.971 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5962004661560059
Epoch: 26, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.078 Vali Acc: 0.520 Test Loss: 1.078 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4958839416503906
Epoch: 27, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.992 Vali Acc: 0.580 Test Loss: 0.992 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.760070562362671
Epoch: 28, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.372 Vali Acc: 0.480 Test Loss: 1.372 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7012410163879395
Epoch: 29, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.091 Vali Acc: 0.540 Test Loss: 1.091 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.993441104888916
Epoch: 30, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.102 Vali Acc: 0.570 Test Loss: 1.102 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6641027927398682
Epoch: 31, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.221 Vali Acc: 0.570 Test Loss: 1.221 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6236984729766846
Epoch: 32, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.224 Vali Acc: 0.520 Test Loss: 1.224 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7192633152008057
Epoch: 33, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.136 Vali Acc: 0.550 Test Loss: 1.136 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 44049410
model size : 182.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.703956365585327
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.4859411716461182
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5786707401275635
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.851010799407959
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.760331392288208
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7809374332427979
Epoch: 6, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.114833354949951
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.854677677154541
Epoch: 8, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.80427885055542
Epoch: 9, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.966846227645874
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 1.8340280055999756
Epoch: 11, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9241533279418945
Epoch: 12, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 1.6945509910583496
Epoch: 13, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9418389797210693
Epoch: 14, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6557676792144775
Epoch: 15, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7352275848388672
Epoch: 16, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9241292476654053
Epoch: 17, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.839 Vali Acc: 0.580 Test Loss: 0.839 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 18 cost time: 1.6740872859954834
Epoch: 18, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.851 Vali Acc: 0.540 Test Loss: 0.851 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6448249816894531
Epoch: 19, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.534 Vali Acc: 0.430 Test Loss: 1.534 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6532812118530273
Epoch: 20, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5003759860992432
Epoch: 21, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.844 Vali Acc: 0.520 Test Loss: 0.844 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8710503578186035
Epoch: 22, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.825 Vali Acc: 0.610 Test Loss: 0.825 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 23 cost time: 1.3477098941802979
Epoch: 23, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.881 Vali Acc: 0.570 Test Loss: 0.881 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6292550563812256
Epoch: 24, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.872 Vali Acc: 0.540 Test Loss: 0.872 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4570026397705078
Epoch: 25, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6014869213104248
Epoch: 26, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.913 Vali Acc: 0.560 Test Loss: 0.913 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4286763668060303
Epoch: 27, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3430345058441162
Epoch: 28, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.843 Vali Acc: 0.650 Test Loss: 0.843 Test Acc: 0.650
Validation loss decreased (-0.609992 --> -0.649992).  Saving model ...
Epoch: 29 cost time: 1.5085890293121338
Epoch: 29, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.903 Vali Acc: 0.530 Test Loss: 0.903 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9730994701385498
Epoch: 30, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.838 Vali Acc: 0.570 Test Loss: 0.838 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4509174823760986
Epoch: 31, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5677707195281982
Epoch: 32, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.176 Vali Acc: 0.550 Test Loss: 1.176 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3102788925170898
Epoch: 33, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.949 Vali Acc: 0.580 Test Loss: 0.949 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3996636867523193
Epoch: 34, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.926 Vali Acc: 0.600 Test Loss: 0.926 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4829275608062744
Epoch: 35, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.034 Vali Acc: 0.610 Test Loss: 1.034 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3966424465179443
Epoch: 36, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.168 Vali Acc: 0.530 Test Loss: 1.168 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.734541416168213
Epoch: 37, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.109 Vali Acc: 0.580 Test Loss: 1.109 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8422658443450928
Epoch: 38, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.248 Vali Acc: 0.540 Test Loss: 1.248 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 44037122
model size : 182.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.1732635498046875
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 4.062858581542969
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 4.3795623779296875
Epoch: 3, Steps: 20 | Train Loss: 0.789 Vali Loss: 1.019 Vali Acc: 0.490 Test Loss: 1.019 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.412196397781372
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.893 Vali Acc: 0.440 Test Loss: 0.893 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.309999465942383
Epoch: 5, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.234349489212036
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.808 Vali Acc: 0.470 Test Loss: 0.808 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.550755262374878
Epoch: 7, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.514790773391724
Epoch: 8, Steps: 20 | Train Loss: 1.088 Vali Loss: 0.824 Vali Acc: 0.450 Test Loss: 0.824 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.15915322303772
Epoch: 9, Steps: 20 | Train Loss: 0.727 Vali Loss: 1.149 Vali Acc: 0.470 Test Loss: 1.149 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7129199504852295
Epoch: 10, Steps: 20 | Train Loss: 0.769 Vali Loss: 1.024 Vali Acc: 0.520 Test Loss: 1.024 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.010827302932739
Epoch: 11, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.677 Vali Acc: 0.600 Test Loss: 0.677 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 4.103309392929077
Epoch: 12, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.883 Vali Acc: 0.500 Test Loss: 0.883 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.979057788848877
Epoch: 13, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.054373264312744
Epoch: 14, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.035 Vali Acc: 0.540 Test Loss: 1.035 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4851298332214355
Epoch: 15, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.035218238830566
Epoch: 16, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.823 Vali Acc: 0.570 Test Loss: 0.823 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.724003791809082
Epoch: 17, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.755 Vali Acc: 0.600 Test Loss: 0.755 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3969779014587402
Epoch: 18, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.751 Vali Acc: 0.610 Test Loss: 0.751 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609992).  Saving model ...
Epoch: 19 cost time: 3.4487111568450928
Epoch: 19, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.737 Vali Acc: 0.640 Test Loss: 0.737 Test Acc: 0.640
Validation loss decreased (-0.609992 --> -0.639993).  Saving model ...
Epoch: 20 cost time: 2.987715244293213
Epoch: 20, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.790 Vali Acc: 0.610 Test Loss: 0.790 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.381159543991089
Epoch: 21, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.812 Vali Acc: 0.570 Test Loss: 0.812 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.905949115753174
Epoch: 22, Steps: 20 | Train Loss: 0.716 Vali Loss: 1.193 Vali Acc: 0.600 Test Loss: 1.193 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.737849235534668
Epoch: 23, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.779 Vali Acc: 0.590 Test Loss: 0.779 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5595831871032715
Epoch: 24, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.815 Vali Acc: 0.530 Test Loss: 0.815 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.961566209793091
Epoch: 25, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.866 Vali Acc: 0.580 Test Loss: 0.866 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.501725435256958
Epoch: 26, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.843 Vali Acc: 0.560 Test Loss: 0.843 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7447946071624756
Epoch: 27, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.882 Vali Acc: 0.570 Test Loss: 0.882 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.2073111534118652
Epoch: 28, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.010 Vali Acc: 0.630 Test Loss: 1.010 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.1764893531799316
Epoch: 29, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.790 Vali Acc: 0.600 Test Loss: 0.790 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 36568322
model size : 154.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.652757883071899
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.882 Vali Acc: 0.490 Test Loss: 0.882 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 2.3045992851257324
Epoch: 2, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
Validation loss decreased (-0.489991 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.6019198894500732
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6586859226226807
Epoch: 4, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.911936044692993
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1281354427337646
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4298975467681885
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.728 Vali Acc: 0.620 Test Loss: 0.728 Test Acc: 0.620
Validation loss decreased (-0.529993 --> -0.619993).  Saving model ...
Epoch: 8 cost time: 2.0028483867645264
Epoch: 8, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5374910831451416
Epoch: 9, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.398798942565918
Epoch: 10, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.822 Vali Acc: 0.510 Test Loss: 0.822 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3674979209899902
Epoch: 11, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.898 Vali Acc: 0.490 Test Loss: 0.898 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.801016330718994
Epoch: 12, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8083043098449707
Epoch: 13, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.691 Vali Acc: 0.620 Test Loss: 0.691 Test Acc: 0.620
Validation loss decreased (-0.619993 --> -0.619993).  Saving model ...
Epoch: 14 cost time: 3.137955665588379
Epoch: 14, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.285568952560425
Epoch: 15, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1246871948242188
Epoch: 16, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.708 Vali Acc: 0.620 Test Loss: 0.708 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3294410705566406
Epoch: 17, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.723 Vali Acc: 0.610 Test Loss: 0.723 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9733197689056396
Epoch: 18, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.823 Vali Acc: 0.610 Test Loss: 0.823 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.963562250137329
Epoch: 19, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.805 Vali Acc: 0.590 Test Loss: 0.805 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.6070117950439453
Epoch: 20, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.923 Vali Acc: 0.480 Test Loss: 0.923 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.39605975151062
Epoch: 21, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.861 Vali Acc: 0.580 Test Loss: 0.861 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.860349178314209
Epoch: 22, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.852 Vali Acc: 0.570 Test Loss: 0.852 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.4441745281219482
Epoch: 23, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 36494594
model size : 153.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.596826791763306
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 3.1761863231658936
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0440478324890137
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4196269512176514
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.527822256088257
Epoch: 5, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.786 Vali Acc: 0.450 Test Loss: 0.786 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3844268321990967
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.6878836154937744
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5679771900177
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.782 Vali Acc: 0.550 Test Loss: 0.782 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 2.486222505569458
Epoch: 9, Steps: 20 | Train Loss: 0.810 Vali Loss: 1.017 Vali Acc: 0.480 Test Loss: 1.017 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2492432594299316
Epoch: 10, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.200943946838379
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.540055751800537
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.854 Vali Acc: 0.540 Test Loss: 0.854 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.33411431312561
Epoch: 13, Steps: 20 | Train Loss: 0.797 Vali Loss: 1.064 Vali Acc: 0.520 Test Loss: 1.064 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5665171146392822
Epoch: 14, Steps: 20 | Train Loss: 0.764 Vali Loss: 1.057 Vali Acc: 0.540 Test Loss: 1.057 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6290123462677
Epoch: 15, Steps: 20 | Train Loss: 0.683 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.750605821609497
Epoch: 16, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.040205955505371
Epoch: 17, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.878 Vali Acc: 0.560 Test Loss: 0.878 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 18 cost time: 2.669935941696167
Epoch: 18, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3032565116882324
Epoch: 19, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.999 Vali Acc: 0.540 Test Loss: 0.999 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3393001556396484
Epoch: 20, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.754 Vali Acc: 0.640 Test Loss: 0.754 Test Acc: 0.640
Validation loss decreased (-0.559991 --> -0.639992).  Saving model ...
Epoch: 21 cost time: 3.848358631134033
Epoch: 21, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.184 Vali Acc: 0.480 Test Loss: 1.184 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3529293537139893
Epoch: 22, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.937 Vali Acc: 0.530 Test Loss: 0.937 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.281690835952759
Epoch: 23, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.846 Vali Acc: 0.520 Test Loss: 0.846 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.0432212352752686
Epoch: 24, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.910132884979248
Epoch: 25, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5932576656341553
Epoch: 26, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.947 Vali Acc: 0.550 Test Loss: 0.947 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1376523971557617
Epoch: 27, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.857 Vali Acc: 0.610 Test Loss: 0.857 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.7582881450653076
Epoch: 28, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.949 Vali Acc: 0.490 Test Loss: 0.949 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.4034392833709717
Epoch: 29, Steps: 20 | Train Loss: 0.454 Vali Loss: 1.141 Vali Acc: 0.580 Test Loss: 1.141 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.2681522369384766
Epoch: 30, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 36629762
model size : 154.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.088392972946167
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.733 Vali Acc: 0.450 Test Loss: 0.733 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.374117851257324
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 2.6111748218536377
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.580411434173584
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.741 Vali Acc: 0.450 Test Loss: 0.741 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3218114376068115
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.729 Vali Acc: 0.460 Test Loss: 0.729 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4695041179656982
Epoch: 6, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.781597137451172
Epoch: 7, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8261630535125732
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.024 Vali Acc: 0.510 Test Loss: 1.024 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509990).  Saving model ...
Epoch: 9 cost time: 2.036987781524658
Epoch: 9, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.994 Vali Acc: 0.470 Test Loss: 0.994 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5271456241607666
Epoch: 10, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
Validation loss decreased (-0.509990 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.404280662536621
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.707 Vali Acc: 0.530 Test Loss: 0.707 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8623595237731934
Epoch: 12, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6483025550842285
Epoch: 13, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.664 Vali Acc: 0.620 Test Loss: 0.664 Test Acc: 0.620
Validation loss decreased (-0.539992 --> -0.619993).  Saving model ...
Epoch: 14 cost time: 1.7510309219360352
Epoch: 14, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8243651390075684
Epoch: 15, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.891 Vali Acc: 0.490 Test Loss: 0.891 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3627574443817139
Epoch: 16, Steps: 20 | Train Loss: 0.732 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2999422550201416
Epoch: 17, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.108501434326172
Epoch: 18, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.828 Vali Acc: 0.530 Test Loss: 0.828 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4920573234558105
Epoch: 19, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.824 Vali Acc: 0.600 Test Loss: 0.824 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8298492431640625
Epoch: 20, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.158 Vali Acc: 0.510 Test Loss: 1.158 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1234450340270996
Epoch: 21, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0602612495422363
Epoch: 22, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8214030265808105
Epoch: 23, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.764 Vali Acc: 0.600 Test Loss: 0.764 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 36556034
model size : 154.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.218724250793457
Epoch: 1, Steps: 20 | Train Loss: 0.804 Vali Loss: 0.786 Vali Acc: 0.440 Test Loss: 0.786 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 1.9890341758728027
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
Validation loss decreased (-0.439992 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.692458391189575
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.7925879955291748
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.3947315216064453
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.813 Vali Acc: 0.470 Test Loss: 0.813 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.849170207977295
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6737101078033447
Epoch: 7, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.600468397140503
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5000345706939697
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.823 Vali Acc: 0.430 Test Loss: 0.823 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.486859083175659
Epoch: 10, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 2.3229784965515137
Epoch: 11, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.226449728012085
Epoch: 12, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1272287368774414
Epoch: 13, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3901596069335938
Epoch: 14, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3796701431274414
Epoch: 15, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.077471971511841
Epoch: 16, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.938159704208374
Epoch: 17, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.097161293029785
Epoch: 18, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.839390993118286
Epoch: 19, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.851 Vali Acc: 0.560 Test Loss: 0.851 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559991).  Saving model ...
Epoch: 20 cost time: 2.239121198654175
Epoch: 20, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.766 Vali Acc: 0.560 Test Loss: 0.766 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559992).  Saving model ...
Epoch: 21 cost time: 2.299808979034424
Epoch: 21, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.779 Vali Acc: 0.560 Test Loss: 0.779 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9023733139038086
Epoch: 22, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.693 Vali Acc: 0.600 Test Loss: 0.693 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599993).  Saving model ...
Epoch: 23 cost time: 1.8148193359375
Epoch: 23, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0152595043182373
Epoch: 24, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.799 Vali Acc: 0.570 Test Loss: 0.799 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.032930850982666
Epoch: 25, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.868 Vali Acc: 0.560 Test Loss: 0.868 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9930453300476074
Epoch: 26, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.875 Vali Acc: 0.620 Test Loss: 0.875 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619991).  Saving model ...
Epoch: 27 cost time: 2.0646913051605225
Epoch: 27, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.007 Vali Acc: 0.550 Test Loss: 1.007 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.6063172817230225
Epoch: 28, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.534961462020874
Epoch: 29, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.260 Vali Acc: 0.610 Test Loss: 1.260 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.612884044647217
Epoch: 30, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.237 Vali Acc: 0.530 Test Loss: 1.237 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.075887441635132
Epoch: 31, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.052 Vali Acc: 0.490 Test Loss: 1.052 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.578195333480835
Epoch: 32, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.079 Vali Acc: 0.570 Test Loss: 1.079 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.081561803817749
Epoch: 33, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.218 Vali Acc: 0.550 Test Loss: 1.218 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.7817468643188477
Epoch: 34, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.465 Vali Acc: 0.520 Test Loss: 1.465 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.706885576248169
Epoch: 35, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.038377046585083
Epoch: 36, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.450 Vali Acc: 0.530 Test Loss: 1.450 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 36531458
model size : 154.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.757139205932617
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 4.0290608406066895
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 4.408399343490601
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.109329462051392
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 4.152872323989868
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519991).  Saving model ...
Epoch: 6 cost time: 3.237992286682129
Epoch: 6, Steps: 20 | Train Loss: 0.855 Vali Loss: 0.694 Vali Acc: 0.580 Test Loss: 0.694 Test Acc: 0.580
Validation loss decreased (-0.519991 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 3.3579745292663574
Epoch: 7, Steps: 20 | Train Loss: 0.872 Vali Loss: 1.015 Vali Acc: 0.520 Test Loss: 1.015 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.776939868927002
Epoch: 8, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4944264888763428
Epoch: 9, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.898 Vali Acc: 0.480 Test Loss: 0.898 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.096341371536255
Epoch: 10, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.755892753601074
Epoch: 11, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.738980770111084
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.675 Vali Acc: 0.620 Test Loss: 0.675 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619993).  Saving model ...
Epoch: 13 cost time: 2.9080660343170166
Epoch: 13, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.083720445632935
Epoch: 14, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.825 Vali Acc: 0.590 Test Loss: 0.825 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.422694444656372
Epoch: 15, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.864 Vali Acc: 0.520 Test Loss: 0.864 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.203670263290405
Epoch: 16, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.732 Vali Acc: 0.590 Test Loss: 0.732 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8256633281707764
Epoch: 17, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.9226465225219727
Epoch: 18, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.883 Vali Acc: 0.540 Test Loss: 0.883 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.288344621658325
Epoch: 19, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.696 Vali Acc: 0.640 Test Loss: 0.696 Test Acc: 0.640
Validation loss decreased (-0.619993 --> -0.639993).  Saving model ...
Epoch: 20 cost time: 3.3100345134735107
Epoch: 20, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3534958362579346
Epoch: 21, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.758 Vali Acc: 0.580 Test Loss: 0.758 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.251709461212158
Epoch: 22, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.231 Vali Acc: 0.530 Test Loss: 1.231 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.654067039489746
Epoch: 23, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.751 Vali Acc: 0.560 Test Loss: 0.751 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.782184362411499
Epoch: 24, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.809 Vali Acc: 0.530 Test Loss: 0.809 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.874910831451416
Epoch: 25, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.770 Vali Acc: 0.560 Test Loss: 0.770 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.0263895988464355
Epoch: 26, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.902 Vali Acc: 0.580 Test Loss: 0.902 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.347737073898315
Epoch: 27, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.4250612258911133
Epoch: 28, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.992 Vali Acc: 0.560 Test Loss: 0.992 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.9189844131469727
Epoch: 29, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.131 Vali Acc: 0.490 Test Loss: 1.131 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 36691202
model size : 154.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.005350112915039
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.518841028213501
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9074485301971436
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3885552883148193
Epoch: 4, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 3.0536458492279053
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8685588836669922
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4538583755493164
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.756 Vali Acc: 0.540 Test Loss: 0.756 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 3.849726676940918
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.686 Vali Acc: 0.580 Test Loss: 0.686 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 2.2159042358398438
Epoch: 9, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0911178588867188
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.695 Vali Acc: 0.590 Test Loss: 0.695 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 11 cost time: 2.778989315032959
Epoch: 11, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.979 Vali Acc: 0.520 Test Loss: 0.979 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6735706329345703
Epoch: 12, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.896 Vali Acc: 0.610 Test Loss: 0.896 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609991).  Saving model ...
Epoch: 13 cost time: 2.7767765522003174
Epoch: 13, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.707 Vali Acc: 0.560 Test Loss: 0.707 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.225506544113159
Epoch: 14, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2600958347320557
Epoch: 15, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.764 Vali Acc: 0.610 Test Loss: 0.764 Test Acc: 0.610
Validation loss decreased (-0.609991 --> -0.609992).  Saving model ...
Epoch: 16 cost time: 1.6976821422576904
Epoch: 16, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2594287395477295
Epoch: 17, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.804 Vali Acc: 0.560 Test Loss: 0.804 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.287364959716797
Epoch: 18, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.920 Vali Acc: 0.590 Test Loss: 0.920 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.332775115966797
Epoch: 19, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.563 Vali Acc: 0.570 Test Loss: 1.563 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.7989771366119385
Epoch: 20, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.876 Vali Acc: 0.600 Test Loss: 0.876 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6384053230285645
Epoch: 21, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1495208740234375
Epoch: 22, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.106 Vali Acc: 0.570 Test Loss: 1.106 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.622312545776367
Epoch: 23, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.159905433654785
Epoch: 24, Steps: 20 | Train Loss: 0.561 Vali Loss: 1.128 Vali Acc: 0.610 Test Loss: 1.128 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0746471881866455
Epoch: 25, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 36620546
model size : 154.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.199420213699341
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.9127657413482666
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5591461658477783
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.340104579925537
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6011078357696533
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5354409217834473
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2123942375183105
Epoch: 7, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1394176483154297
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.128453493118286
Epoch: 9, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7602508068084717
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.700 Vali Acc: 0.570 Test Loss: 0.700 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 2.0506093502044678
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.683 Vali Acc: 0.550 Test Loss: 0.683 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6677870750427246
Epoch: 12, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.823 Vali Acc: 0.550 Test Loss: 0.823 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8995580673217773
Epoch: 13, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.761 Vali Acc: 0.560 Test Loss: 0.761 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.009430170059204
Epoch: 14, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0399370193481445
Epoch: 15, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3442926406860352
Epoch: 16, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.478215217590332
Epoch: 17, Steps: 20 | Train Loss: 0.605 Vali Loss: 1.101 Vali Acc: 0.520 Test Loss: 1.101 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.628066062927246
Epoch: 18, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.669 Vali Acc: 0.570 Test Loss: 0.669 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 19 cost time: 1.4914162158966064
Epoch: 19, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.938331127166748
Epoch: 20, Steps: 20 | Train Loss: 0.538 Vali Loss: 1.001 Vali Acc: 0.620 Test Loss: 1.001 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619990).  Saving model ...
Epoch: 21 cost time: 1.4576616287231445
Epoch: 21, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4435691833496094
Epoch: 22, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3081722259521484
Epoch: 23, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.221 Vali Acc: 0.510 Test Loss: 1.221 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3785979747772217
Epoch: 24, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9229800701141357
Epoch: 25, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.061 Vali Acc: 0.520 Test Loss: 1.061 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2082865238189697
Epoch: 26, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.916 Vali Acc: 0.550 Test Loss: 0.916 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5954842567443848
Epoch: 27, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3968665599822998
Epoch: 28, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.109 Vali Acc: 0.530 Test Loss: 1.109 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5797412395477295
Epoch: 29, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.164 Vali Acc: 0.570 Test Loss: 1.164 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5620505809783936
Epoch: 30, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.386 Vali Acc: 0.480 Test Loss: 1.386 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 36583682
model size : 154.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.2747015953063965
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.5748209953308105
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.4932301044464111
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.9649338722229004
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.277949571609497
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.088482856750488
Epoch: 6, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.520766496658325
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.006709575653076
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9184134006500244
Epoch: 9, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.536881685256958
Epoch: 10, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.707 Vali Acc: 0.530 Test Loss: 0.707 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 2.4847280979156494
Epoch: 11, Steps: 20 | Train Loss: 0.777 Vali Loss: 0.673 Vali Acc: 0.650 Test Loss: 0.673 Test Acc: 0.650
Validation loss decreased (-0.529993 --> -0.649993).  Saving model ...
Epoch: 12 cost time: 4.2063024044036865
Epoch: 12, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.183783292770386
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.712 Vali Acc: 0.540 Test Loss: 0.712 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8251943588256836
Epoch: 14, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.398008584976196
Epoch: 15, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.742 Vali Acc: 0.570 Test Loss: 0.742 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.029580354690552
Epoch: 16, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.273983955383301
Epoch: 17, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0135209560394287
Epoch: 18, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2608628273010254
Epoch: 19, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6483845710754395
Epoch: 20, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6225273609161377
Epoch: 21, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 36681986
model size : 154.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.379424810409546
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.671 Vali Acc: 0.570 Test Loss: 0.671 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.7015509605407715
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.110055923461914
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7602686882019043
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7343342304229736
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.684 Vali Acc: 0.530 Test Loss: 0.684 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.55173397064209
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.282709836959839
Epoch: 7, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8474814891815186
Epoch: 8, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.889 Vali Acc: 0.500 Test Loss: 0.889 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.634570598602295
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3242969512939453
Epoch: 10, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1648428440093994
Epoch: 11, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.797 Vali Acc: 0.560 Test Loss: 0.797 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 36660482
model size : 154.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2334020137786865
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1485316753387451
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1254301071166992
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.423565149307251
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.136842966079712
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4738388061523438
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 2.255340099334717
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 8 cost time: 2.360032320022583
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.273075819015503
Epoch: 9, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4087774753570557
Epoch: 10, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.687 Vali Acc: 0.580 Test Loss: 0.687 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 1.9307167530059814
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3470895290374756
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.397627353668213
Epoch: 13, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.280578374862671
Epoch: 14, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9486935138702393
Epoch: 15, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8907105922698975
Epoch: 16, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6394999027252197
Epoch: 17, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1019530296325684
Epoch: 18, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0179128646850586
Epoch: 19, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3250162601470947
Epoch: 20, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.922 Vali Acc: 0.520 Test Loss: 0.922 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 36642050
model size : 154.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.6241371631622314
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.688 Vali Acc: 0.490 Test Loss: 0.688 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.9244608879089355
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.0259242057800293
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.537609100341797
Epoch: 4, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 3.0915894508361816
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8420157432556152
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.5186338424682617
Epoch: 7, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.663 Vali Acc: 0.600 Test Loss: 0.663 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 2.3250882625579834
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6512234210968018
Epoch: 9, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.106757640838623
Epoch: 10, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.620281219482422
Epoch: 11, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3457882404327393
Epoch: 12, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.670438051223755
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2794628143310547
Epoch: 14, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.733 Vali Acc: 0.590 Test Loss: 0.733 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.796052932739258
Epoch: 15, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.740 Vali Acc: 0.630 Test Loss: 0.740 Test Acc: 0.630
Validation loss decreased (-0.599993 --> -0.629993).  Saving model ...
Epoch: 16 cost time: 2.5151402950286865
Epoch: 16, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.738745927810669
Epoch: 17, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.809 Vali Acc: 0.540 Test Loss: 0.809 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.071204423904419
Epoch: 18, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.972 Vali Acc: 0.520 Test Loss: 0.972 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7000293731689453
Epoch: 19, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.885 Vali Acc: 0.530 Test Loss: 0.885 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6164593696594238
Epoch: 20, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1288306713104248
Epoch: 21, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.931 Vali Acc: 0.540 Test Loss: 0.931 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0684013366699219
Epoch: 22, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.082 Vali Acc: 0.520 Test Loss: 1.082 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6719708442687988
Epoch: 23, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.279 Vali Acc: 0.490 Test Loss: 1.279 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.85798978805542
Epoch: 24, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.886 Vali Acc: 0.560 Test Loss: 0.886 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.980721950531006
Epoch: 25, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.098 Vali Acc: 0.570 Test Loss: 1.098 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 36746498
model size : 154.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.478497505187988
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.001657485961914
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.819 Vali Acc: 0.420 Test Loss: 0.819 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7481367588043213
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.307619333267212
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.662909984588623
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1685338020324707
Epoch: 6, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.903 Vali Acc: 0.510 Test Loss: 0.903 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6263275146484375
Epoch: 7, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 2.681953191757202
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.875291109085083
Epoch: 9, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3967244625091553
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.689 Vali Acc: 0.560 Test Loss: 0.689 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559993).  Saving model ...
Epoch: 11 cost time: 2.465367317199707
Epoch: 11, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.919217824935913
Epoch: 12, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.740 Vali Acc: 0.570 Test Loss: 0.740 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 2.5817136764526367
Epoch: 13, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.830 Vali Acc: 0.510 Test Loss: 0.830 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7666573524475098
Epoch: 14, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.931626558303833
Epoch: 15, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9766228199005127
Epoch: 16, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.878 Vali Acc: 0.560 Test Loss: 0.878 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7768306732177734
Epoch: 17, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.738 Vali Acc: 0.590 Test Loss: 0.738 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 18 cost time: 2.1530420780181885
Epoch: 18, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.90065598487854
Epoch: 19, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.859 Vali Acc: 0.550 Test Loss: 0.859 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.994652509689331
Epoch: 20, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1688153743743896
Epoch: 21, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.913 Vali Acc: 0.500 Test Loss: 0.913 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8197205066680908
Epoch: 22, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.762 Vali Acc: 0.630 Test Loss: 0.762 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629992).  Saving model ...
Epoch: 23 cost time: 2.3618552684783936
Epoch: 23, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5868654251098633
Epoch: 24, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.966 Vali Acc: 0.550 Test Loss: 0.966 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.175536870956421
Epoch: 25, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.207 Vali Acc: 0.510 Test Loss: 1.207 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4817862510681152
Epoch: 26, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.083 Vali Acc: 0.560 Test Loss: 1.083 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.4884538650512695
Epoch: 27, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.945 Vali Acc: 0.560 Test Loss: 0.945 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6309680938720703
Epoch: 28, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.148 Vali Acc: 0.590 Test Loss: 1.148 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6713454723358154
Epoch: 29, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6522142887115479
Epoch: 30, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.053 Vali Acc: 0.540 Test Loss: 1.053 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4333879947662354
Epoch: 31, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.509 Vali Acc: 0.500 Test Loss: 1.509 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.119901180267334
Epoch: 32, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.529 Vali Acc: 0.540 Test Loss: 1.529 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 36721922
model size : 154.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6718835830688477
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5940966606140137
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.3726396560668945
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.051680088043213
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8188679218292236
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6239674091339111
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8145709037780762
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.55535888671875
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.7382547855377197
Epoch: 9, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.739 Vali Acc: 0.600 Test Loss: 0.739 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599993).  Saving model ...
Epoch: 10 cost time: 2.1512930393218994
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.139 Vali Acc: 0.480 Test Loss: 1.139 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.934424877166748
Epoch: 11, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8499929904937744
Epoch: 12, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.604247808456421
Epoch: 13, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4617986679077148
Epoch: 14, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.775 Vali Acc: 0.520 Test Loss: 0.775 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.390573263168335
Epoch: 15, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3309135437011719
Epoch: 16, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6933507919311523
Epoch: 17, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.824 Vali Acc: 0.520 Test Loss: 0.824 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3726847171783447
Epoch: 18, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.785 Vali Acc: 0.610 Test Loss: 0.785 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609992).  Saving model ...
Epoch: 19 cost time: 1.6834993362426758
Epoch: 19, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4681529998779297
Epoch: 20, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.886 Vali Acc: 0.480 Test Loss: 0.886 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8180975914001465
Epoch: 21, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9693841934204102
Epoch: 22, Steps: 20 | Train Loss: 0.413 Vali Loss: 1.011 Vali Acc: 0.570 Test Loss: 1.011 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.177497386932373
Epoch: 23, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.936 Vali Acc: 0.590 Test Loss: 0.936 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0026776790618896
Epoch: 24, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.935 Vali Acc: 0.570 Test Loss: 0.935 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1270980834960938
Epoch: 25, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.820 Vali Acc: 0.610 Test Loss: 0.820 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1309118270874023
Epoch: 26, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.111 Vali Acc: 0.530 Test Loss: 1.111 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2846250534057617
Epoch: 27, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.066 Vali Acc: 0.530 Test Loss: 1.066 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0017340183258057
Epoch: 28, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.982 Vali Acc: 0.540 Test Loss: 0.982 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 36700418
model size : 154.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.039580583572388
Epoch: 1, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.512721061706543
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.783356189727783
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.8084192276000977
Epoch: 4, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9634339809417725
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 2.8624491691589355
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.698 Vali Acc: 0.570 Test Loss: 0.698 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 2.2022132873535156
Epoch: 7, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.647792339324951
Epoch: 8, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.898 Vali Acc: 0.490 Test Loss: 0.898 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7658028602600098
Epoch: 9, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.727 Vali Acc: 0.570 Test Loss: 0.727 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4303150177001953
Epoch: 10, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.722 Vali Acc: 0.580 Test Loss: 0.722 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 2.536210775375366
Epoch: 11, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.216820478439331
Epoch: 12, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8742468357086182
Epoch: 13, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.752687931060791
Epoch: 14, Steps: 20 | Train Loss: 0.681 Vali Loss: 1.002 Vali Acc: 0.510 Test Loss: 1.002 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.052337169647217
Epoch: 15, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.950066566467285
Epoch: 16, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.766 Vali Acc: 0.470 Test Loss: 0.766 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.921473264694214
Epoch: 17, Steps: 20 | Train Loss: 0.550 Vali Loss: 1.011 Vali Acc: 0.520 Test Loss: 1.011 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8232131004333496
Epoch: 18, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.869 Vali Acc: 0.580 Test Loss: 0.869 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1038260459899902
Epoch: 19, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.693 Vali Acc: 0.610 Test Loss: 0.693 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 20 cost time: 3.003981828689575
Epoch: 20, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.822 Vali Acc: 0.550 Test Loss: 0.822 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.420323371887207
Epoch: 21, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.788 Vali Acc: 0.560 Test Loss: 0.788 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.525418996810913
Epoch: 22, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.814 Vali Acc: 0.590 Test Loss: 0.814 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0212807655334473
Epoch: 23, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.700 Vali Acc: 0.600 Test Loss: 0.700 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6460323333740234
Epoch: 24, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.5361311435699463
Epoch: 25, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.712 Vali Acc: 0.630 Test Loss: 0.712 Test Acc: 0.630
Validation loss decreased (-0.609993 --> -0.629993).  Saving model ...
Epoch: 26 cost time: 2.922639846801758
Epoch: 26, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.209 Vali Acc: 0.570 Test Loss: 1.209 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3826234340667725
Epoch: 27, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.987 Vali Acc: 0.560 Test Loss: 0.987 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9164721965789795
Epoch: 28, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.064 Vali Acc: 0.550 Test Loss: 1.064 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8096883296966553
Epoch: 29, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.100 Vali Acc: 0.590 Test Loss: 1.100 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.049241542816162
Epoch: 30, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.005 Vali Acc: 0.540 Test Loss: 1.005 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.1885392665863037
Epoch: 31, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.911 Vali Acc: 0.620 Test Loss: 0.911 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8084242343902588
Epoch: 32, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.325 Vali Acc: 0.570 Test Loss: 1.325 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0114903450012207
Epoch: 33, Steps: 20 | Train Loss: 0.536 Vali Loss: 1.340 Vali Acc: 0.540 Test Loss: 1.340 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.4582695960998535
Epoch: 34, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.479386329650879
Epoch: 35, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.065 Vali Acc: 0.550 Test Loss: 1.065 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 36807938
model size : 155.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.586400032043457
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.710 Vali Acc: 0.430 Test Loss: 0.710 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.5020358562469482
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.717 Vali Acc: 0.430 Test Loss: 0.717 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.106114387512207
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
Validation loss decreased (-0.429993 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 1.708784580230713
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.557389736175537
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.9226195812225342
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.807 Vali Acc: 0.460 Test Loss: 0.807 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9548838138580322
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2847635746002197
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.777 Vali Acc: 0.440 Test Loss: 0.777 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.174149751663208
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 10 cost time: 2.105846881866455
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.780 Vali Acc: 0.460 Test Loss: 0.780 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5337629318237305
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.690 Vali Acc: 0.510 Test Loss: 0.690 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 1.4746544361114502
Epoch: 12, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.762 Vali Acc: 0.590 Test Loss: 0.762 Test Acc: 0.590
Validation loss decreased (-0.509993 --> -0.589992).  Saving model ...
Epoch: 13 cost time: 1.5795726776123047
Epoch: 13, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.678807258605957
Epoch: 14, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9174745082855225
Epoch: 15, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.691493034362793
Epoch: 16, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.989 Vali Acc: 0.530 Test Loss: 0.989 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4939377307891846
Epoch: 17, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0110881328582764
Epoch: 18, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.008 Vali Acc: 0.520 Test Loss: 1.008 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.286835193634033
Epoch: 19, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.863 Vali Acc: 0.480 Test Loss: 0.863 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8475377559661865
Epoch: 20, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.792 Vali Acc: 0.570 Test Loss: 0.792 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3403024673461914
Epoch: 21, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.929 Vali Acc: 0.490 Test Loss: 0.929 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.191380739212036
Epoch: 22, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.991 Vali Acc: 0.490 Test Loss: 0.991 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 36774146
model size : 154.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9026246070861816
Epoch: 1, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.679 Vali Acc: 0.550 Test Loss: 0.679 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.0259907245635986
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.692 Vali Acc: 0.490 Test Loss: 0.692 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8558294773101807
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.02888822555542
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.552603006362915
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9816856384277344
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6996495723724365
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.676 Vali Acc: 0.520 Test Loss: 0.676 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4695618152618408
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.677 Vali Acc: 0.540 Test Loss: 0.677 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6653740406036377
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4034185409545898
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.73482084274292
Epoch: 11, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 36761858
model size : 154.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.452707290649414
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.690 Vali Acc: 0.490 Test Loss: 0.690 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.8055944442749023
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9865124225616455
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 3.250082492828369
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 4.155179738998413
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0857656002044678
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.7097878456115723
Epoch: 7, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.893 Vali Acc: 0.480 Test Loss: 0.893 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5354881286621094
Epoch: 8, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.7070348262786865
Epoch: 9, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8919870853424072
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.8541150093078613
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 12 cost time: 2.9874658584594727
Epoch: 12, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.224628210067749
Epoch: 13, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.692 Vali Acc: 0.580 Test Loss: 0.692 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 3.511583089828491
Epoch: 14, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.968196153640747
Epoch: 15, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.864 Vali Acc: 0.540 Test Loss: 0.864 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.232076406478882
Epoch: 16, Steps: 20 | Train Loss: 0.603 Vali Loss: 1.064 Vali Acc: 0.490 Test Loss: 1.064 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7595868110656738
Epoch: 17, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.848 Vali Acc: 0.570 Test Loss: 0.848 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4577052593231201
Epoch: 18, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.702 Vali Acc: 0.620 Test Loss: 0.702 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619993).  Saving model ...
Epoch: 19 cost time: 1.9724864959716797
Epoch: 19, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4754769802093506
Epoch: 20, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.253253221511841
Epoch: 21, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.880389928817749
Epoch: 22, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.851 Vali Acc: 0.570 Test Loss: 0.851 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.5565054416656494
Epoch: 23, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.860 Vali Acc: 0.610 Test Loss: 0.860 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4793171882629395
Epoch: 24, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.073 Vali Acc: 0.580 Test Loss: 1.073 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4753727912902832
Epoch: 25, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.947 Vali Acc: 0.580 Test Loss: 0.947 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.298943519592285
Epoch: 26, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.962 Vali Acc: 0.470 Test Loss: 0.962 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.0455055236816406
Epoch: 27, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.070 Vali Acc: 0.440 Test Loss: 1.070 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9833450317382812
Epoch: 28, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.166 Vali Acc: 0.580 Test Loss: 1.166 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 36872450
model size : 155.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.861280202865601
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.705 Vali Acc: 0.430 Test Loss: 0.705 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.8201758861541748
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
Validation loss decreased (-0.429993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.941070556640625
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.517237901687622
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4282069206237793
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7838785648345947
Epoch: 6, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.695 Vali Acc: 0.590 Test Loss: 0.695 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589993).  Saving model ...
Epoch: 7 cost time: 2.369915008544922
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.691 Vali Acc: 0.510 Test Loss: 0.691 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.297276496887207
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1800315380096436
Epoch: 9, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.720 Vali Acc: 0.570 Test Loss: 0.720 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0907232761383057
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.263624429702759
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.671 Vali Acc: 0.600 Test Loss: 0.671 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 1.8048818111419678
Epoch: 12, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.767 Vali Acc: 0.570 Test Loss: 0.767 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9944100379943848
Epoch: 13, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7403018474578857
Epoch: 14, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.684 Vali Acc: 0.560 Test Loss: 0.684 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2410740852355957
Epoch: 15, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3242416381835938
Epoch: 16, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8446509838104248
Epoch: 17, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3378870487213135
Epoch: 18, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0705299377441406
Epoch: 19, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2514195442199707
Epoch: 20, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.858 Vali Acc: 0.570 Test Loss: 0.858 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.71648907661438
Epoch: 21, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 36838658
model size : 155.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.598722696304321
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.9235312938690186
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.058018684387207
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.722 Vali Acc: 0.430 Test Loss: 0.722 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9241085052490234
Epoch: 4, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 2.1958909034729004
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7594048976898193
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.399148941040039
Epoch: 7, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.721 Vali Acc: 0.590 Test Loss: 0.721 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589993).  Saving model ...
Epoch: 8 cost time: 1.620011568069458
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5898008346557617
Epoch: 9, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.829 Vali Acc: 0.470 Test Loss: 0.829 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.200180768966675
Epoch: 10, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5602960586547852
Epoch: 11, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5655272006988525
Epoch: 12, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6658365726470947
Epoch: 13, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2842392921447754
Epoch: 14, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9147224426269531
Epoch: 15, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.744 Vali Acc: 0.640 Test Loss: 0.744 Test Acc: 0.640
Validation loss decreased (-0.589993 --> -0.639993).  Saving model ...
Epoch: 16 cost time: 1.8322856426239014
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.720 Vali Acc: 0.560 Test Loss: 0.720 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8668444156646729
Epoch: 17, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9113037586212158
Epoch: 18, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7545745372772217
Epoch: 19, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.953 Vali Acc: 0.560 Test Loss: 0.953 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8737695217132568
Epoch: 20, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.026 Vali Acc: 0.510 Test Loss: 1.026 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.426090955734253
Epoch: 21, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.582242488861084
Epoch: 22, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.984 Vali Acc: 0.560 Test Loss: 0.984 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8287231922149658
Epoch: 23, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.981 Vali Acc: 0.480 Test Loss: 0.981 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5730116367340088
Epoch: 24, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.037 Vali Acc: 0.530 Test Loss: 1.037 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0486576557159424
Epoch: 25, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.973 Vali Acc: 0.520 Test Loss: 0.973 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 36823298
model size : 155.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.723851680755615
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.4860332012176514
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.6099894046783447
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.635146379470825
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.352532148361206
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.681 Vali Acc: 0.530 Test Loss: 0.681 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 2.472684621810913
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 2.953336715698242
Epoch: 7, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8988468647003174
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8454768657684326
Epoch: 9, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8721163272857666
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1896989345550537
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.154827356338501
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2192435264587402
Epoch: 13, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.503950834274292
Epoch: 14, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 2.7505407333374023
Epoch: 15, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.805 Vali Acc: 0.560 Test Loss: 0.805 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 16 cost time: 2.406724452972412
Epoch: 16, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.030 Vali Acc: 0.460 Test Loss: 1.030 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4095282554626465
Epoch: 17, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5993881225585938
Epoch: 18, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.873 Vali Acc: 0.530 Test Loss: 0.873 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.652496337890625
Epoch: 19, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.850 Vali Acc: 0.550 Test Loss: 0.850 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.7669570446014404
Epoch: 20, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.155 Vali Acc: 0.530 Test Loss: 1.155 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.254077434539795
Epoch: 21, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.793 Vali Acc: 0.620 Test Loss: 0.793 Test Acc: 0.620
Validation loss decreased (-0.559992 --> -0.619992).  Saving model ...
Epoch: 22 cost time: 1.5982921123504639
Epoch: 22, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.003 Vali Acc: 0.540 Test Loss: 1.003 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.729893684387207
Epoch: 23, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.259 Vali Acc: 0.510 Test Loss: 1.259 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2711575031280518
Epoch: 24, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.894 Vali Acc: 0.640 Test Loss: 0.894 Test Acc: 0.640
Validation loss decreased (-0.619992 --> -0.639991).  Saving model ...
Epoch: 25 cost time: 2.8485848903656006
Epoch: 25, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.972 Vali Acc: 0.530 Test Loss: 0.972 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3581454753875732
Epoch: 26, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.048 Vali Acc: 0.560 Test Loss: 1.048 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.58001708984375
Epoch: 27, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9941983222961426
Epoch: 28, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.100 Vali Acc: 0.570 Test Loss: 1.100 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.240724802017212
Epoch: 29, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.139 Vali Acc: 0.570 Test Loss: 1.139 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0266668796539307
Epoch: 30, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.999 Vali Acc: 0.540 Test Loss: 0.999 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.586435317993164
Epoch: 31, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.556673049926758
Epoch: 32, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.341 Vali Acc: 0.570 Test Loss: 1.341 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.3286826610565186
Epoch: 33, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.246 Vali Acc: 0.620 Test Loss: 1.246 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9965944290161133
Epoch: 34, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.150 Vali Acc: 0.660 Test Loss: 1.150 Test Acc: 0.660
Validation loss decreased (-0.639991 --> -0.659988).  Saving model ...
Epoch: 35 cost time: 2.519308567047119
Epoch: 35, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.247 Vali Acc: 0.590 Test Loss: 1.247 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.068690061569214
Epoch: 36, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.282 Vali Acc: 0.560 Test Loss: 1.282 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8116276264190674
Epoch: 37, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.290 Vali Acc: 0.530 Test Loss: 1.290 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.0883326530456543
Epoch: 38, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.376 Vali Acc: 0.540 Test Loss: 1.376 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.1116063594818115
Epoch: 39, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.326 Vali Acc: 0.580 Test Loss: 1.326 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.9226181507110596
Epoch: 40, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.524 Vali Acc: 0.550 Test Loss: 1.524 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.8033909797668457
Epoch: 41, Steps: 20 | Train Loss: 0.244 Vali Loss: 1.680 Vali Acc: 0.560 Test Loss: 1.680 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.8550424575805664
Epoch: 42, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.794 Vali Acc: 0.550 Test Loss: 1.794 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.2817115783691406
Epoch: 43, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.699 Vali Acc: 0.600 Test Loss: 1.699 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.7474067211151123
Epoch: 44, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.975 Vali Acc: 0.490 Test Loss: 1.975 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 36912386
model size : 155.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.620402574539185
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.1554245948791504
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.690 Vali Acc: 0.470 Test Loss: 0.690 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8351283073425293
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6002566814422607
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.682 Vali Acc: 0.550 Test Loss: 0.682 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.313058614730835
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.289405345916748
Epoch: 6, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8583741188049316
Epoch: 7, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.255272150039673
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.656 Vali Acc: 0.610 Test Loss: 0.656 Test Acc: 0.610
Validation loss decreased (-0.549993 --> -0.609993).  Saving model ...
Epoch: 9 cost time: 2.307905673980713
Epoch: 9, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8505349159240723
Epoch: 10, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3948771953582764
Epoch: 11, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.610933542251587
Epoch: 12, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.706 Vali Acc: 0.600 Test Loss: 0.706 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4489827156066895
Epoch: 13, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.872 Vali Acc: 0.550 Test Loss: 0.872 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6739580631256104
Epoch: 14, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.721 Vali Acc: 0.590 Test Loss: 0.721 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.475522756576538
Epoch: 15, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7158215045928955
Epoch: 16, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.898270606994629
Epoch: 17, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5078930854797363
Epoch: 18, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.977 Vali Acc: 0.510 Test Loss: 0.977 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 36897026
model size : 155.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.568100690841675
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.699 Vali Acc: 0.540 Test Loss: 0.699 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.6680326461791992
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.8743891716003418
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.042586326599121
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7100954055786133
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.686 Vali Acc: 0.560 Test Loss: 0.686 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.5317811965942383
Epoch: 6, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.733 Vali Acc: 0.410 Test Loss: 0.733 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3633759021759033
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.672 Vali Acc: 0.570 Test Loss: 0.672 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 1.6639909744262695
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.699 Vali Acc: 0.540 Test Loss: 0.699 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.525991678237915
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 1.5707528591156006
Epoch: 10, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3880739212036133
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.664 Vali Acc: 0.600 Test Loss: 0.664 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 1.8611493110656738
Epoch: 12, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.689 Vali Acc: 0.590 Test Loss: 0.689 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6339192390441895
Epoch: 13, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.758 Vali Acc: 0.590 Test Loss: 0.758 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4399993419647217
Epoch: 14, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4387097358703613
Epoch: 15, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6644442081451416
Epoch: 16, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.357483148574829
Epoch: 17, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0743768215179443
Epoch: 18, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.705 Vali Acc: 0.590 Test Loss: 0.705 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.126495122909546
Epoch: 19, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.827348232269287
Epoch: 20, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.959 Vali Acc: 0.590 Test Loss: 0.959 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.713447093963623
Epoch: 21, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 36884738
model size : 155.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.171123266220093
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.716 Vali Acc: 0.460 Test Loss: 0.716 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.266712188720703
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.317793369293213
Epoch: 3, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4494249820709229
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 2.3969078063964844
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 2.4878203868865967
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 2.937944173812866
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.329343795776367
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3712685108184814
Epoch: 9, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.949676275253296
Epoch: 10, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.435427665710449
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 2.4176244735717773
Epoch: 12, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.773 Vali Acc: 0.590 Test Loss: 0.773 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 13 cost time: 2.5427772998809814
Epoch: 13, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.379157543182373
Epoch: 14, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.763 Vali Acc: 0.590 Test Loss: 0.763 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589992).  Saving model ...
Epoch: 15 cost time: 2.5191726684570312
Epoch: 15, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9406559467315674
Epoch: 16, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4056642055511475
Epoch: 17, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.939213752746582
Epoch: 18, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.930 Vali Acc: 0.490 Test Loss: 0.930 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2754807472229004
Epoch: 19, Steps: 20 | Train Loss: 0.601 Vali Loss: 1.097 Vali Acc: 0.490 Test Loss: 1.097 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.890878200531006
Epoch: 20, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.879 Vali Acc: 0.550 Test Loss: 0.879 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.943237543106079
Epoch: 21, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7961061000823975
Epoch: 22, Steps: 20 | Train Loss: 0.504 Vali Loss: 1.027 Vali Acc: 0.570 Test Loss: 1.027 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.769835948944092
Epoch: 23, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.062 Vali Acc: 0.530 Test Loss: 1.062 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4960503578186035
Epoch: 24, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.973 Vali Acc: 0.590 Test Loss: 0.973 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 36976898
model size : 155.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.182628631591797
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.696 Vali Acc: 0.470 Test Loss: 0.696 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.8749887943267822
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.714 Vali Acc: 0.460 Test Loss: 0.714 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7294385433197021
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.6375887393951416
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.44873046875
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.712047815322876
Epoch: 6, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.072753429412842
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 1.725404977798462
Epoch: 8, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0165042877197266
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6649038791656494
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8597667217254639
Epoch: 11, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.720 Vali Acc: 0.570 Test Loss: 0.720 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.7154600620269775
Epoch: 12, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.804 Vali Acc: 0.530 Test Loss: 0.804 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.785062551498413
Epoch: 13, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.664 Vali Acc: 0.590 Test Loss: 0.664 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 14 cost time: 2.181757688522339
Epoch: 14, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.874 Vali Acc: 0.550 Test Loss: 0.874 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8201076984405518
Epoch: 15, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9231016635894775
Epoch: 16, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3206822872161865
Epoch: 17, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.907 Vali Acc: 0.530 Test Loss: 0.907 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1167197227478027
Epoch: 18, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.797 Vali Acc: 0.590 Test Loss: 0.797 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5924558639526367
Epoch: 19, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5417921543121338
Epoch: 20, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.800 Vali Acc: 0.570 Test Loss: 0.800 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.671827793121338
Epoch: 21, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.960 Vali Acc: 0.510 Test Loss: 0.960 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6115093231201172
Epoch: 22, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.902 Vali Acc: 0.610 Test Loss: 0.902 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609991).  Saving model ...
Epoch: 23 cost time: 1.6581249237060547
Epoch: 23, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.035 Vali Acc: 0.590 Test Loss: 1.035 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.582118272781372
Epoch: 24, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.896 Vali Acc: 0.620 Test Loss: 0.896 Test Acc: 0.620
Validation loss decreased (-0.609991 --> -0.619991).  Saving model ...
Epoch: 25 cost time: 1.9169416427612305
Epoch: 25, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.943 Vali Acc: 0.610 Test Loss: 0.943 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9652612209320068
Epoch: 26, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9718115329742432
Epoch: 27, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.978 Vali Acc: 0.560 Test Loss: 0.978 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2590107917785645
Epoch: 28, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.456 Vali Acc: 0.540 Test Loss: 1.456 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6481082439422607
Epoch: 29, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.194 Vali Acc: 0.530 Test Loss: 1.194 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0826356410980225
Epoch: 30, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.192 Vali Acc: 0.580 Test Loss: 1.192 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.06597638130188
Epoch: 31, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.155 Vali Acc: 0.560 Test Loss: 1.155 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.466958999633789
Epoch: 32, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.239 Vali Acc: 0.550 Test Loss: 1.239 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.160085439682007
Epoch: 33, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.100027322769165
Epoch: 34, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.233 Vali Acc: 0.530 Test Loss: 1.233 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 36961538
model size : 155.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7889418601989746
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.688 Vali Acc: 0.540 Test Loss: 0.688 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.4173762798309326
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9787895679473877
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.232926607131958
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.735 Vali Acc: 0.450 Test Loss: 0.735 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9481005668640137
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4728338718414307
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.301560640335083
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.170532464981079
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.273101329803467
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5950722694396973
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.689 Vali Acc: 0.530 Test Loss: 0.689 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.391056776046753
Epoch: 11, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 2.5472373962402344
Epoch: 12, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.741 Vali Acc: 0.590 Test Loss: 0.741 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 2.55368709564209
Epoch: 13, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.699 Vali Acc: 0.590 Test Loss: 0.699 Test Acc: 0.590
Validation loss decreased (-0.589993 --> -0.589993).  Saving model ...
Epoch: 14 cost time: 2.370922803878784
Epoch: 14, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.062243938446045
Epoch: 15, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2175118923187256
Epoch: 16, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0142312049865723
Epoch: 17, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.648 Vali Acc: 0.600 Test Loss: 0.648 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599994).  Saving model ...
Epoch: 18 cost time: 1.8456993103027344
Epoch: 18, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.980877161026001
Epoch: 19, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0726428031921387
Epoch: 20, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.855 Vali Acc: 0.610 Test Loss: 0.855 Test Acc: 0.610
Validation loss decreased (-0.599994 --> -0.609991).  Saving model ...
Epoch: 21 cost time: 1.9228267669677734
Epoch: 21, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.444387197494507
Epoch: 22, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.847 Vali Acc: 0.580 Test Loss: 0.847 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8888754844665527
Epoch: 23, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.887 Vali Acc: 0.530 Test Loss: 0.887 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2685062885284424
Epoch: 24, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4464666843414307
Epoch: 25, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.977 Vali Acc: 0.490 Test Loss: 0.977 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9790027141571045
Epoch: 26, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1798837184906006
Epoch: 27, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.026 Vali Acc: 0.550 Test Loss: 1.026 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.034764528274536
Epoch: 28, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.876 Vali Acc: 0.550 Test Loss: 0.876 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.410057306289673
Epoch: 29, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.996 Vali Acc: 0.560 Test Loss: 0.996 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1163878440856934
Epoch: 30, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.199 Vali Acc: 0.490 Test Loss: 1.199 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 36949250
model size : 155.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.143999338150024
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.6243526935577393
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.691 Vali Acc: 0.550 Test Loss: 0.691 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.971830368041992
Epoch: 3, Steps: 20 | Train Loss: 0.847 Vali Loss: 1.048 Vali Acc: 0.490 Test Loss: 1.048 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.472681760787964
Epoch: 4, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.837 Vali Acc: 0.470 Test Loss: 0.837 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3884174823760986
Epoch: 5, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.1170759201049805
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2478206157684326
Epoch: 7, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2489280700683594
Epoch: 8, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.360775947570801
Epoch: 9, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.969 Vali Acc: 0.490 Test Loss: 0.969 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.4242076873779297
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.406907558441162
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.717 Vali Acc: 0.600 Test Loss: 0.717 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 3.1011598110198975
Epoch: 12, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4357452392578125
Epoch: 13, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.911 Vali Acc: 0.520 Test Loss: 0.911 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.716026782989502
Epoch: 14, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.830 Vali Acc: 0.530 Test Loss: 0.830 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0723330974578857
Epoch: 15, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.028055906295776
Epoch: 16, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.792 Vali Acc: 0.550 Test Loss: 0.792 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.093681573867798
Epoch: 17, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.043388843536377
Epoch: 18, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.711 Vali Acc: 0.590 Test Loss: 0.711 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.712883949279785
Epoch: 19, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.025 Vali Acc: 0.570 Test Loss: 1.025 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.065272092819214
Epoch: 20, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.953734874725342
Epoch: 21, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.745 Vali Acc: 0.560 Test Loss: 0.745 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 29480450
model size : 127.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.7823240756988525
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.834 Vali Acc: 0.490 Test Loss: 0.834 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.7918176651000977
Epoch: 2, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.705 Vali Acc: 0.520 Test Loss: 0.705 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.943288803100586
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2414772510528564
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 3.290715456008911
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 3.951605796813965
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 3.939067840576172
Epoch: 7, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.749 Vali Acc: 0.570 Test Loss: 0.749 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 3.9104576110839844
Epoch: 8, Steps: 20 | Train Loss: 0.770 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3855154514312744
Epoch: 9, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6145756244659424
Epoch: 10, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.940 Vali Acc: 0.520 Test Loss: 0.940 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5054430961608887
Epoch: 11, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.899 Vali Acc: 0.500 Test Loss: 0.899 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1186788082122803
Epoch: 12, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.540311813354492
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 2.0201449394226074
Epoch: 14, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.682332754135132
Epoch: 15, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.680206298828125
Epoch: 16, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.676 Vali Acc: 0.640 Test Loss: 0.676 Test Acc: 0.640
Validation loss decreased (-0.569993 --> -0.639993).  Saving model ...
Epoch: 17 cost time: 3.1721079349517822
Epoch: 17, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7567389011383057
Epoch: 18, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.816 Vali Acc: 0.600 Test Loss: 0.816 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.062911510467529
Epoch: 19, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8610761165618896
Epoch: 20, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2981674671173096
Epoch: 21, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.737 Vali Acc: 0.620 Test Loss: 0.737 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.970850706100464
Epoch: 22, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3508200645446777
Epoch: 23, Steps: 20 | Train Loss: 0.815 Vali Loss: 1.149 Vali Acc: 0.540 Test Loss: 1.149 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.322190761566162
Epoch: 24, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.853 Vali Acc: 0.600 Test Loss: 0.853 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.902329444885254
Epoch: 25, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7908592224121094
Epoch: 26, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.004 Vali Acc: 0.520 Test Loss: 1.004 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 29406722
model size : 126.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.648337125778198
Epoch: 1, Steps: 20 | Train Loss: 0.778 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.493712902069092
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.281738758087158
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.744 Vali Acc: 0.590 Test Loss: 0.744 Test Acc: 0.590
Validation loss decreased (-0.499993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 5.473609924316406
Epoch: 4, Steps: 20 | Train Loss: 0.745 Vali Loss: 1.045 Vali Acc: 0.490 Test Loss: 1.045 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.657208442687988
Epoch: 5, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.302966833114624
Epoch: 6, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6607587337493896
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.943441867828369
Epoch: 8, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.959 Vali Acc: 0.520 Test Loss: 0.959 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9988300800323486
Epoch: 9, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.730311155319214
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.878 Vali Acc: 0.500 Test Loss: 0.878 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.802150011062622
Epoch: 11, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.800 Vali Acc: 0.520 Test Loss: 0.800 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.344990253448486
Epoch: 12, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.346074342727661
Epoch: 13, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.695 Vali Acc: 0.640 Test Loss: 0.695 Test Acc: 0.640
Validation loss decreased (-0.589993 --> -0.639993).  Saving model ...
Epoch: 14 cost time: 4.225779294967651
Epoch: 14, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.26138973236084
Epoch: 15, Steps: 20 | Train Loss: 0.779 Vali Loss: 0.895 Vali Acc: 0.480 Test Loss: 0.895 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.10247015953064
Epoch: 16, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.808 Vali Acc: 0.560 Test Loss: 0.808 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5685572624206543
Epoch: 17, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.30154013633728
Epoch: 18, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.671 Vali Acc: 0.640 Test Loss: 0.671 Test Acc: 0.640
Validation loss decreased (-0.639993 --> -0.639993).  Saving model ...
Epoch: 19 cost time: 2.069845676422119
Epoch: 19, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.869 Vali Acc: 0.620 Test Loss: 0.869 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1398282051086426
Epoch: 20, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.759 Vali Acc: 0.630 Test Loss: 0.759 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.326843738555908
Epoch: 21, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.810 Vali Acc: 0.620 Test Loss: 0.810 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.096118211746216
Epoch: 22, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.833 Vali Acc: 0.570 Test Loss: 0.833 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.603567123413086
Epoch: 23, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.627889633178711
Epoch: 24, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.6716370582580566
Epoch: 25, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.983 Vali Acc: 0.580 Test Loss: 0.983 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1649320125579834
Epoch: 26, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.963 Vali Acc: 0.550 Test Loss: 0.963 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.9165682792663574
Epoch: 27, Steps: 20 | Train Loss: 0.574 Vali Loss: 1.004 Vali Acc: 0.610 Test Loss: 1.004 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9099128246307373
Epoch: 28, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 29541890
model size : 127.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5171597003936768
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.3275139331817627
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.5598180294036865
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7380764484405518
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.348381757736206
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 3.499819040298462
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6812057495117188
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.161105632781982
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 4.119343280792236
Epoch: 9, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.108382225036621
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.828 Vali Acc: 0.520 Test Loss: 0.828 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1912009716033936
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.705 Vali Acc: 0.570 Test Loss: 0.705 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 3.542681932449341
Epoch: 12, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.710 Vali Acc: 0.560 Test Loss: 0.710 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.73022723197937
Epoch: 13, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.669 Vali Acc: 0.600 Test Loss: 0.669 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 3.8049259185791016
Epoch: 14, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.484247922897339
Epoch: 15, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.339808702468872
Epoch: 16, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.64566969871521
Epoch: 17, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.884 Vali Acc: 0.560 Test Loss: 0.884 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.328972339630127
Epoch: 18, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.492896318435669
Epoch: 19, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2670440673828125
Epoch: 20, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6850736141204834
Epoch: 21, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.793 Vali Acc: 0.640 Test Loss: 0.793 Test Acc: 0.640
Validation loss decreased (-0.599993 --> -0.639992).  Saving model ...
Epoch: 22 cost time: 4.516278505325317
Epoch: 22, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.72404146194458
Epoch: 23, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.868 Vali Acc: 0.620 Test Loss: 0.868 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.307415246963501
Epoch: 24, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3842949867248535
Epoch: 25, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.8478171825408936
Epoch: 26, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3261349201202393
Epoch: 27, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.380 Vali Acc: 0.580 Test Loss: 1.380 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.350121259689331
Epoch: 28, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.542 Vali Acc: 0.520 Test Loss: 1.542 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.60335111618042
Epoch: 29, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.899 Vali Acc: 0.560 Test Loss: 0.899 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.573272943496704
Epoch: 30, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.386 Vali Acc: 0.570 Test Loss: 1.386 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.731624126434326
Epoch: 31, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.146 Vali Acc: 0.540 Test Loss: 1.146 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 29468162
model size : 127.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.554414749145508
Epoch: 1, Steps: 20 | Train Loss: 0.807 Vali Loss: 0.770 Vali Acc: 0.440 Test Loss: 0.770 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.969511032104492
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
Validation loss decreased (-0.439992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 2.9233803749084473
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.760 Vali Acc: 0.430 Test Loss: 0.760 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.456026315689087
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 3.194894790649414
Epoch: 5, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.880 Vali Acc: 0.480 Test Loss: 0.880 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.039446592330933
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.349792242050171
Epoch: 7, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.862234115600586
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.861 Vali Acc: 0.520 Test Loss: 0.861 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.707249164581299
Epoch: 9, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.777 Vali Acc: 0.470 Test Loss: 0.777 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5364720821380615
Epoch: 10, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.686 Vali Acc: 0.580 Test Loss: 0.686 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 2.7790019512176514
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1113595962524414
Epoch: 12, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.784 Vali Acc: 0.530 Test Loss: 0.784 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8214495182037354
Epoch: 13, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0942721366882324
Epoch: 14, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.720508098602295
Epoch: 15, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7316811084747314
Epoch: 16, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.304612874984741
Epoch: 17, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.788 Vali Acc: 0.560 Test Loss: 0.788 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.23547101020813
Epoch: 18, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.015099048614502
Epoch: 19, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1307454109191895
Epoch: 20, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.847 Vali Acc: 0.610 Test Loss: 0.847 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 21 cost time: 4.338536500930786
Epoch: 21, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.917027711868286
Epoch: 22, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.833 Vali Acc: 0.620 Test Loss: 0.833 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619992).  Saving model ...
Epoch: 23 cost time: 4.5039427280426025
Epoch: 23, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.978 Vali Acc: 0.540 Test Loss: 0.978 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9436123371124268
Epoch: 24, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.877 Vali Acc: 0.600 Test Loss: 0.877 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6735482215881348
Epoch: 25, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.997 Vali Acc: 0.590 Test Loss: 0.997 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9257616996765137
Epoch: 26, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.791 Vali Acc: 0.580 Test Loss: 0.791 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.881193161010742
Epoch: 27, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.043 Vali Acc: 0.550 Test Loss: 1.043 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.3039162158966064
Epoch: 28, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.9837422370910645
Epoch: 29, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.075 Vali Acc: 0.630 Test Loss: 1.075 Test Acc: 0.630
Validation loss decreased (-0.619992 --> -0.629989).  Saving model ...
Epoch: 30 cost time: 3.4763355255126953
Epoch: 30, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.080 Vali Acc: 0.550 Test Loss: 1.080 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.7348721027374268
Epoch: 31, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.303 Vali Acc: 0.580 Test Loss: 1.303 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.390770435333252
Epoch: 32, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.275 Vali Acc: 0.610 Test Loss: 1.275 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.198562383651733
Epoch: 33, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.194 Vali Acc: 0.550 Test Loss: 1.194 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.99372935295105
Epoch: 34, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.224 Vali Acc: 0.480 Test Loss: 1.224 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.9263358116149902
Epoch: 35, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.135 Vali Acc: 0.590 Test Loss: 1.135 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.5888731479644775
Epoch: 36, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.284 Vali Acc: 0.620 Test Loss: 1.284 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.1852009296417236
Epoch: 37, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.370 Vali Acc: 0.490 Test Loss: 1.370 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.97723650932312
Epoch: 38, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.276 Vali Acc: 0.580 Test Loss: 1.276 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.179478168487549
Epoch: 39, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.493 Vali Acc: 0.530 Test Loss: 1.493 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 29443586
model size : 126.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.404877662658691
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.4442524909973145
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.9852898120880127
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.263564348220825
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 4.747244596481323
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 3.462848663330078
Epoch: 6, Steps: 20 | Train Loss: 0.792 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5112226009368896
Epoch: 7, Steps: 20 | Train Loss: 0.947 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3490138053894043
Epoch: 8, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3651039600372314
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.676 Vali Acc: 0.560 Test Loss: 0.676 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 3.396002769470215
Epoch: 10, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.699 Vali Acc: 0.570 Test Loss: 0.699 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 3.1887359619140625
Epoch: 11, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 12 cost time: 3.035102605819702
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7943854331970215
Epoch: 13, Steps: 20 | Train Loss: 0.842 Vali Loss: 1.409 Vali Acc: 0.510 Test Loss: 1.409 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.131099224090576
Epoch: 14, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.673 Vali Acc: 0.570 Test Loss: 0.673 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.388852119445801
Epoch: 15, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9014530181884766
Epoch: 16, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.805 Vali Acc: 0.610 Test Loss: 0.805 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 17 cost time: 3.7558934688568115
Epoch: 17, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.749 Vali Acc: 0.600 Test Loss: 0.749 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.48689603805542
Epoch: 18, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.655 Vali Acc: 0.610 Test Loss: 0.655 Test Acc: 0.610
Validation loss decreased (-0.609992 --> -0.609993).  Saving model ...
Epoch: 19 cost time: 3.4481921195983887
Epoch: 19, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.904 Vali Acc: 0.550 Test Loss: 0.904 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.986563205718994
Epoch: 20, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.701 Vali Acc: 0.560 Test Loss: 0.701 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.279996395111084
Epoch: 21, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.728 Vali Acc: 0.570 Test Loss: 0.728 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.760909795761108
Epoch: 22, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.940 Vali Acc: 0.590 Test Loss: 0.940 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.779033184051514
Epoch: 23, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.939 Vali Acc: 0.520 Test Loss: 0.939 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.155764818191528
Epoch: 24, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.897 Vali Acc: 0.590 Test Loss: 0.897 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.516420841217041
Epoch: 25, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.948 Vali Acc: 0.540 Test Loss: 0.948 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.82776665687561
Epoch: 26, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.008 Vali Acc: 0.620 Test Loss: 1.008 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619990).  Saving model ...
Epoch: 27 cost time: 4.4916672706604
Epoch: 27, Steps: 20 | Train Loss: 0.678 Vali Loss: 1.257 Vali Acc: 0.600 Test Loss: 1.257 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.126742839813232
Epoch: 28, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.079 Vali Acc: 0.580 Test Loss: 1.079 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.998566389083862
Epoch: 29, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.050 Vali Acc: 0.580 Test Loss: 1.050 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.052724599838257
Epoch: 30, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.864 Vali Acc: 0.630 Test Loss: 0.864 Test Acc: 0.630
Validation loss decreased (-0.619990 --> -0.629991).  Saving model ...
Epoch: 31 cost time: 4.899915456771851
Epoch: 31, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.166 Vali Acc: 0.580 Test Loss: 1.166 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.74455189704895
Epoch: 32, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.144 Vali Acc: 0.580 Test Loss: 1.144 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.166349411010742
Epoch: 33, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.065 Vali Acc: 0.570 Test Loss: 1.065 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.16298770904541
Epoch: 34, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.277 Vali Acc: 0.580 Test Loss: 1.277 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.7235121726989746
Epoch: 35, Steps: 20 | Train Loss: 0.682 Vali Loss: 2.044 Vali Acc: 0.530 Test Loss: 2.044 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.5814714431762695
Epoch: 36, Steps: 20 | Train Loss: 0.509 Vali Loss: 1.167 Vali Acc: 0.610 Test Loss: 1.167 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.912593126296997
Epoch: 37, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.310 Vali Acc: 0.530 Test Loss: 1.310 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.662510395050049
Epoch: 38, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.089 Vali Acc: 0.540 Test Loss: 1.089 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.591357946395874
Epoch: 39, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.310 Vali Acc: 0.520 Test Loss: 1.310 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.863757610321045
Epoch: 40, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.593 Vali Acc: 0.510 Test Loss: 1.593 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 29603330
model size : 127.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.748974561691284
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.692 Vali Acc: 0.610 Test Loss: 0.692 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 2.261221408843994
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.36181640625
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4201481342315674
Epoch: 4, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6749603748321533
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4799349308013916
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.809 Vali Acc: 0.480 Test Loss: 0.809 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.518446922302246
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.799290895462036
Epoch: 8, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.619096040725708
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.704 Vali Acc: 0.580 Test Loss: 0.704 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6658222675323486
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.2131779193878174
Epoch: 11, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 29532674
model size : 127.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8324382305145264
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.707 Vali Acc: 0.490 Test Loss: 0.707 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.2806479930877686
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.55401611328125
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 2.272287130355835
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.285677909851074
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9445805549621582
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9623491764068604
Epoch: 7, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.774735689163208
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.710 Vali Acc: 0.440 Test Loss: 0.710 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.276312828063965
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.689 Vali Acc: 0.570 Test Loss: 0.689 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 10 cost time: 2.5267670154571533
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1598622798919678
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7825233936309814
Epoch: 12, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6621341705322266
Epoch: 13, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.737 Vali Acc: 0.590 Test Loss: 0.737 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 14 cost time: 1.9100322723388672
Epoch: 14, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2388076782226562
Epoch: 15, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.723 Vali Acc: 0.570 Test Loss: 0.723 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.507814884185791
Epoch: 16, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.898672342300415
Epoch: 17, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.477515935897827
Epoch: 18, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.254197835922241
Epoch: 19, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.869 Vali Acc: 0.490 Test Loss: 0.869 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2724192142486572
Epoch: 20, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.952 Vali Acc: 0.540 Test Loss: 0.952 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8134417533874512
Epoch: 21, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.937 Vali Acc: 0.490 Test Loss: 0.937 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9658269882202148
Epoch: 22, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.167 Vali Acc: 0.510 Test Loss: 1.167 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6364567279815674
Epoch: 23, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 29495810
model size : 127.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.7330992221832275
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.354116916656494
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.888123035430908
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5959675312042236
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.582390546798706
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5468175411224365
Epoch: 6, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.9756221771240234
Epoch: 7, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4540910720825195
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.728349208831787
Epoch: 9, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1101863384246826
Epoch: 10, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.764 Vali Acc: 0.570 Test Loss: 0.764 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 3.15407657623291
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6457767486572266
Epoch: 12, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6652073860168457
Epoch: 13, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9560301303863525
Epoch: 14, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.316282033920288
Epoch: 15, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569993).  Saving model ...
Epoch: 16 cost time: 2.329833745956421
Epoch: 16, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.953 Vali Acc: 0.540 Test Loss: 0.953 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.927794933319092
Epoch: 17, Steps: 20 | Train Loss: 0.595 Vali Loss: 1.204 Vali Acc: 0.530 Test Loss: 1.204 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.943485975265503
Epoch: 18, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.745 Vali Acc: 0.590 Test Loss: 0.745 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 19 cost time: 3.334681272506714
Epoch: 19, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.945 Vali Acc: 0.550 Test Loss: 0.945 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1721503734588623
Epoch: 20, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.934 Vali Acc: 0.580 Test Loss: 0.934 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.87791109085083
Epoch: 21, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.006 Vali Acc: 0.550 Test Loss: 1.006 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.798957109451294
Epoch: 22, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.3156497478485107
Epoch: 23, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.447 Vali Acc: 0.500 Test Loss: 1.447 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9611821174621582
Epoch: 24, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.923 Vali Acc: 0.570 Test Loss: 0.923 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.969536542892456
Epoch: 25, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.238 Vali Acc: 0.490 Test Loss: 1.238 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2477855682373047
Epoch: 26, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.689 Vali Acc: 0.440 Test Loss: 1.689 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5538318157196045
Epoch: 27, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.186 Vali Acc: 0.520 Test Loss: 1.186 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.3485019207000732
Epoch: 28, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.420 Vali Acc: 0.500 Test Loss: 1.420 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 29594114
model size : 127.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.062651634216309
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.678 Vali Acc: 0.540 Test Loss: 0.678 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.8987653255462646
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.443436622619629
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.199446439743042
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.168997049331665
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.680 Vali Acc: 0.530 Test Loss: 0.680 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.147627115249634
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3880693912506104
Epoch: 7, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.517958879470825
Epoch: 8, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.661907196044922
Epoch: 9, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1283111572265625
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.742180585861206
Epoch: 11, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8801112174987793
Epoch: 12, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 3.7691633701324463
Epoch: 13, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2822158336639404
Epoch: 14, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 1.9011263847351074
Epoch: 15, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9299347400665283
Epoch: 16, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4796507358551025
Epoch: 17, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.776 Vali Acc: 0.570 Test Loss: 0.776 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.189939022064209
Epoch: 18, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.808 Vali Acc: 0.560 Test Loss: 0.808 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.474209785461426
Epoch: 19, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.791 Vali Acc: 0.620 Test Loss: 0.791 Test Acc: 0.620
Validation loss decreased (-0.569992 --> -0.619992).  Saving model ...
Epoch: 20 cost time: 2.5972070693969727
Epoch: 20, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.992 Vali Acc: 0.580 Test Loss: 0.992 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5101802349090576
Epoch: 21, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.859 Vali Acc: 0.550 Test Loss: 0.859 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.958494186401367
Epoch: 22, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.033 Vali Acc: 0.540 Test Loss: 1.033 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7170615196228027
Epoch: 23, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2927000522613525
Epoch: 24, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.009 Vali Acc: 0.560 Test Loss: 1.009 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1076152324676514
Epoch: 25, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.274 Vali Acc: 0.530 Test Loss: 1.274 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0480828285217285
Epoch: 26, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.136 Vali Acc: 0.480 Test Loss: 1.136 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7020864486694336
Epoch: 27, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.003614664077759
Epoch: 28, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.110 Vali Acc: 0.480 Test Loss: 1.110 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.299224853515625
Epoch: 29, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.955 Vali Acc: 0.590 Test Loss: 0.955 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 29572610
model size : 127.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.932958364486694
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.3588457107543945
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1434807777404785
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.0298967361450195
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6004226207733154
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6623132228851318
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.416929006576538
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.5785937309265137
Epoch: 8, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.355091094970703
Epoch: 9, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.699812412261963
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0735039710998535
Epoch: 11, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.872 Vali Acc: 0.520 Test Loss: 0.872 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5449671745300293
Epoch: 12, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7703585624694824
Epoch: 13, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 2.045538902282715
Epoch: 14, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8552982807159424
Epoch: 15, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8785948753356934
Epoch: 16, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.933 Vali Acc: 0.580 Test Loss: 0.933 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6946706771850586
Epoch: 17, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.816 Vali Acc: 0.580 Test Loss: 0.816 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2914936542510986
Epoch: 18, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.812 Vali Acc: 0.530 Test Loss: 0.812 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0569310188293457
Epoch: 19, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.991 Vali Acc: 0.480 Test Loss: 0.991 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2615904808044434
Epoch: 20, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.803 Vali Acc: 0.560 Test Loss: 0.803 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4012010097503662
Epoch: 21, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.949 Vali Acc: 0.590 Test Loss: 0.949 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 22 cost time: 1.3406181335449219
Epoch: 22, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.089 Vali Acc: 0.530 Test Loss: 1.089 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.98805832862854
Epoch: 23, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.869 Vali Acc: 0.510 Test Loss: 0.869 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.150865077972412
Epoch: 24, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.174 Vali Acc: 0.580 Test Loss: 1.174 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5838007926940918
Epoch: 25, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.083 Vali Acc: 0.470 Test Loss: 1.083 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.135869026184082
Epoch: 26, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.903 Vali Acc: 0.580 Test Loss: 0.903 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5253965854644775
Epoch: 27, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.194 Vali Acc: 0.550 Test Loss: 1.194 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.242293119430542
Epoch: 28, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9135785102844238
Epoch: 29, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.270 Vali Acc: 0.580 Test Loss: 1.270 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7158794403076172
Epoch: 30, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.049 Vali Acc: 0.590 Test Loss: 1.049 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9803462028503418
Epoch: 31, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.043 Vali Acc: 0.610 Test Loss: 1.043 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609990).  Saving model ...
Epoch: 32 cost time: 2.2399773597717285
Epoch: 32, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.152 Vali Acc: 0.640 Test Loss: 1.152 Test Acc: 0.640
Validation loss decreased (-0.609990 --> -0.639988).  Saving model ...
Epoch: 33 cost time: 2.317382574081421
Epoch: 33, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.191 Vali Acc: 0.590 Test Loss: 1.191 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0122287273406982
Epoch: 34, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.172 Vali Acc: 0.570 Test Loss: 1.172 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.4651265144348145
Epoch: 35, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.509 Vali Acc: 0.520 Test Loss: 1.509 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.9570786952972412
Epoch: 36, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.538 Vali Acc: 0.540 Test Loss: 1.538 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.4329702854156494
Epoch: 37, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.295 Vali Acc: 0.590 Test Loss: 1.295 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.078641176223755
Epoch: 38, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.483 Vali Acc: 0.550 Test Loss: 1.483 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.385683536529541
Epoch: 39, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.442948818206787
Epoch: 40, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.682 Vali Acc: 0.530 Test Loss: 1.682 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.0598011016845703
Epoch: 41, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.695 Vali Acc: 0.560 Test Loss: 1.695 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.8365702629089355
Epoch: 42, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.796 Vali Acc: 0.560 Test Loss: 1.796 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 29554178
model size : 127.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.948163270950317
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.3837389945983887
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.2591774463653564
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.488063097000122
Epoch: 4, Steps: 20 | Train Loss: 0.774 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6553525924682617
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.001490592956543
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3904311656951904
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 3.0068747997283936
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.693 Vali Acc: 0.540 Test Loss: 0.693 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7084500789642334
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4479026794433594
Epoch: 10, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.585505723953247
Epoch: 11, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.732889413833618
Epoch: 12, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.662 Vali Acc: 0.590 Test Loss: 0.662 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 2.0068864822387695
Epoch: 13, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.756 Vali Acc: 0.550 Test Loss: 0.756 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7217423915863037
Epoch: 14, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8743503093719482
Epoch: 15, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.860 Vali Acc: 0.580 Test Loss: 0.860 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3552510738372803
Epoch: 16, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.674 Vali Acc: 0.640 Test Loss: 0.674 Test Acc: 0.640
Validation loss decreased (-0.589993 --> -0.639993).  Saving model ...
Epoch: 17 cost time: 2.713690757751465
Epoch: 17, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.854 Vali Acc: 0.540 Test Loss: 0.854 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5004634857177734
Epoch: 18, Steps: 20 | Train Loss: 0.535 Vali Loss: 1.077 Vali Acc: 0.540 Test Loss: 1.077 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6255698204040527
Epoch: 19, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.865 Vali Acc: 0.580 Test Loss: 0.865 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7777984142303467
Epoch: 20, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.899 Vali Acc: 0.580 Test Loss: 0.899 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8137035369873047
Epoch: 21, Steps: 20 | Train Loss: 0.549 Vali Loss: 1.289 Vali Acc: 0.520 Test Loss: 1.289 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4541358947753906
Epoch: 22, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.091 Vali Acc: 0.590 Test Loss: 1.091 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1162312030792236
Epoch: 23, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.975 Vali Acc: 0.500 Test Loss: 0.975 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.9003963470458984
Epoch: 24, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.010991334915161
Epoch: 25, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.008 Vali Acc: 0.570 Test Loss: 1.008 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.877617359161377
Epoch: 26, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.050 Vali Acc: 0.580 Test Loss: 1.050 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 29658626
model size : 127.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.543689489364624
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.4695415496826172
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.807 Vali Acc: 0.440 Test Loss: 0.807 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5976648330688477
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.762 Vali Acc: 0.480 Test Loss: 0.762 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9690535068511963
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.769502878189087
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.646265983581543
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7912333011627197
Epoch: 7, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9319028854370117
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.9738576412200928
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0224785804748535
Epoch: 10, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7338895797729492
Epoch: 11, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6259772777557373
Epoch: 12, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6445224285125732
Epoch: 13, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4602932929992676
Epoch: 14, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.766 Vali Acc: 0.560 Test Loss: 0.766 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 1.3988533020019531
Epoch: 15, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6073453426361084
Epoch: 16, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6449496746063232
Epoch: 17, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.947 Vali Acc: 0.530 Test Loss: 0.947 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7174527645111084
Epoch: 18, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9151041507720947
Epoch: 19, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.790 Vali Acc: 0.570 Test Loss: 0.790 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 20 cost time: 2.3059778213500977
Epoch: 20, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9012701511383057
Epoch: 21, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8143253326416016
Epoch: 22, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.836 Vali Acc: 0.550 Test Loss: 0.836 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2927393913269043
Epoch: 23, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0354185104370117
Epoch: 24, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.925 Vali Acc: 0.560 Test Loss: 0.925 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2124791145324707
Epoch: 25, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.945 Vali Acc: 0.520 Test Loss: 0.945 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.851557731628418
Epoch: 26, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.831552505493164
Epoch: 27, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 2.006272792816162
Epoch: 28, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 1.3469791412353516
Epoch: 29, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9465959072113037
Epoch: 30, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.897 Vali Acc: 0.530 Test Loss: 0.897 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6353437900543213
Epoch: 31, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.481 Vali Acc: 0.570 Test Loss: 1.481 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0280144214630127
Epoch: 32, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.261 Vali Acc: 0.580 Test Loss: 1.261 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0754146575927734
Epoch: 33, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.351 Vali Acc: 0.580 Test Loss: 1.351 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.003371000289917
Epoch: 34, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.291 Vali Acc: 0.570 Test Loss: 1.291 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.1393492221832275
Epoch: 35, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.234 Vali Acc: 0.570 Test Loss: 1.234 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7727031707763672
Epoch: 36, Steps: 20 | Train Loss: 0.299 Vali Loss: 2.031 Vali Acc: 0.500 Test Loss: 2.031 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.0881853103637695
Epoch: 37, Steps: 20 | Train Loss: 0.410 Vali Loss: 2.468 Vali Acc: 0.520 Test Loss: 2.468 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8309524059295654
Epoch: 38, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.090 Vali Acc: 0.600 Test Loss: 1.090 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 29634050
model size : 127.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6194441318511963
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.386559009552002
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4957923889160156
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6080653667449951
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.743 Vali Acc: 0.450 Test Loss: 0.743 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6212854385375977
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9215142726898193
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.8731439113616943
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.760 Vali Acc: 0.450 Test Loss: 0.760 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5185611248016357
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7009162902832031
Epoch: 9, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 1.8256139755249023
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5220656394958496
Epoch: 11, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589993).  Saving model ...
Epoch: 12 cost time: 1.3530211448669434
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4911003112792969
Epoch: 13, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4148001670837402
Epoch: 14, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.740 Vali Acc: 0.590 Test Loss: 0.740 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5538523197174072
Epoch: 15, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.915 Vali Acc: 0.480 Test Loss: 0.915 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6098721027374268
Epoch: 16, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4393665790557861
Epoch: 17, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.732 Vali Acc: 0.590 Test Loss: 0.732 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6303961277008057
Epoch: 18, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.726 Vali Acc: 0.630 Test Loss: 0.726 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629993).  Saving model ...
Epoch: 19 cost time: 1.5142064094543457
Epoch: 19, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.897 Vali Acc: 0.520 Test Loss: 0.897 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7917754650115967
Epoch: 20, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.787 Vali Acc: 0.580 Test Loss: 0.787 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7267529964447021
Epoch: 21, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.909 Vali Acc: 0.560 Test Loss: 0.909 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6954450607299805
Epoch: 22, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.953 Vali Acc: 0.580 Test Loss: 0.953 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7691292762756348
Epoch: 23, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.845 Vali Acc: 0.580 Test Loss: 0.845 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7141180038452148
Epoch: 24, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.855 Vali Acc: 0.580 Test Loss: 0.855 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6678857803344727
Epoch: 25, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.843 Vali Acc: 0.580 Test Loss: 0.843 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4711134433746338
Epoch: 26, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.012 Vali Acc: 0.560 Test Loss: 1.012 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4142882823944092
Epoch: 27, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.977 Vali Acc: 0.530 Test Loss: 0.977 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7670564651489258
Epoch: 28, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.980 Vali Acc: 0.570 Test Loss: 0.980 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 29612546
model size : 127.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.047301530838013
Epoch: 1, Steps: 20 | Train Loss: 0.791 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.853421926498413
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8375847339630127
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5319483280181885
Epoch: 4, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2800259590148926
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.743532657623291
Epoch: 6, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.724025011062622
Epoch: 7, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.771 Vali Acc: 0.470 Test Loss: 0.771 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7993595600128174
Epoch: 8, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.463146924972534
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.421627998352051
Epoch: 10, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.752 Vali Acc: 0.580 Test Loss: 0.752 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 2.5739052295684814
Epoch: 11, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.38649845123291
Epoch: 12, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0197978019714355
Epoch: 13, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1494250297546387
Epoch: 14, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.855417490005493
Epoch: 15, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.699 Vali Acc: 0.590 Test Loss: 0.699 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589993).  Saving model ...
Epoch: 16 cost time: 2.0660951137542725
Epoch: 16, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.880760908126831
Epoch: 17, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.988 Vali Acc: 0.560 Test Loss: 0.988 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4455862045288086
Epoch: 18, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.141435384750366
Epoch: 19, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.999 Vali Acc: 0.590 Test Loss: 0.999 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6644980907440186
Epoch: 20, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0962891578674316
Epoch: 21, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.864 Vali Acc: 0.490 Test Loss: 0.864 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.694153070449829
Epoch: 22, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.906 Vali Acc: 0.600 Test Loss: 0.906 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 23 cost time: 2.338718891143799
Epoch: 23, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.859 Vali Acc: 0.590 Test Loss: 0.859 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.031360387802124
Epoch: 24, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.878 Vali Acc: 0.610 Test Loss: 0.878 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609991).  Saving model ...
Epoch: 25 cost time: 2.713505744934082
Epoch: 25, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.171 Vali Acc: 0.530 Test Loss: 1.171 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9183282852172852
Epoch: 26, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.978 Vali Acc: 0.590 Test Loss: 0.978 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7560036182403564
Epoch: 27, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.091 Vali Acc: 0.570 Test Loss: 1.091 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.792348861694336
Epoch: 28, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.202 Vali Acc: 0.510 Test Loss: 1.202 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4533891677856445
Epoch: 29, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.969 Vali Acc: 0.570 Test Loss: 0.969 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8309190273284912
Epoch: 30, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.3774988651275635
Epoch: 31, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.497 Vali Acc: 0.580 Test Loss: 1.497 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.490022659301758
Epoch: 32, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.269 Vali Acc: 0.510 Test Loss: 1.269 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.5433032512664795
Epoch: 33, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.281 Vali Acc: 0.610 Test Loss: 1.281 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.6375491619110107
Epoch: 34, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.236 Vali Acc: 0.570 Test Loss: 1.236 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 29720066
model size : 128.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.008293867111206
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.771178960800171
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.480402946472168
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.011826515197754
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.763 Vali Acc: 0.460 Test Loss: 0.763 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0226199626922607
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.763 Vali Acc: 0.460 Test Loss: 0.763 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.921168565750122
Epoch: 6, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6846532821655273
Epoch: 7, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 1.8488192558288574
Epoch: 8, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.373460054397583
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 2.2646827697753906
Epoch: 10, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.758 Vali Acc: 0.540 Test Loss: 0.758 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.9215049743652344
Epoch: 11, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.966048240661621
Epoch: 12, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 13 cost time: 2.3559350967407227
Epoch: 13, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.661 Vali Acc: 0.600 Test Loss: 0.661 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 2.188263177871704
Epoch: 14, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8002967834472656
Epoch: 15, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.800 Vali Acc: 0.610 Test Loss: 0.800 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609992).  Saving model ...
Epoch: 16 cost time: 2.256126880645752
Epoch: 16, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.920 Vali Acc: 0.540 Test Loss: 0.920 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6028757095336914
Epoch: 17, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.676 Vali Acc: 0.550 Test Loss: 0.676 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1696901321411133
Epoch: 18, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7082695960998535
Epoch: 19, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0799572467803955
Epoch: 20, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1371030807495117
Epoch: 21, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.749 Vali Acc: 0.570 Test Loss: 0.749 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2274274826049805
Epoch: 22, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4030306339263916
Epoch: 23, Steps: 20 | Train Loss: 0.412 Vali Loss: 1.301 Vali Acc: 0.520 Test Loss: 1.301 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0496675968170166
Epoch: 24, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.060 Vali Acc: 0.570 Test Loss: 1.060 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0515127182006836
Epoch: 25, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.820 Vali Acc: 0.470 Test Loss: 0.820 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 29686274
model size : 127.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.259818077087402
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.681 Vali Acc: 0.540 Test Loss: 0.681 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.5182604789733887
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8235564231872559
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.688 Vali Acc: 0.510 Test Loss: 0.688 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4189372062683105
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5374090671539307
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4983994960784912
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4440114498138428
Epoch: 7, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.559704065322876
Epoch: 8, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.557279109954834
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7062222957611084
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.690 Vali Acc: 0.530 Test Loss: 0.690 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4768621921539307
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.674 Vali Acc: 0.560 Test Loss: 0.674 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 1.712991714477539
Epoch: 12, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1065311431884766
Epoch: 13, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.732 Vali Acc: 0.560 Test Loss: 0.732 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5739374160766602
Epoch: 14, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.986 Vali Acc: 0.520 Test Loss: 0.986 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6485259532928467
Epoch: 15, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.899 Vali Acc: 0.590 Test Loss: 0.899 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589991).  Saving model ...
Epoch: 16 cost time: 1.76949143409729
Epoch: 16, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9730117321014404
Epoch: 17, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7166194915771484
Epoch: 18, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.708 Vali Acc: 0.590 Test Loss: 0.708 Test Acc: 0.590
Validation loss decreased (-0.589991 --> -0.589993).  Saving model ...
Epoch: 19 cost time: 1.592606544494629
Epoch: 19, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5348756313323975
Epoch: 20, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.835 Vali Acc: 0.580 Test Loss: 0.835 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8580119609832764
Epoch: 21, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.751 Vali Acc: 0.600 Test Loss: 0.751 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 22 cost time: 1.4913227558135986
Epoch: 22, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.900 Vali Acc: 0.630 Test Loss: 0.900 Test Acc: 0.630
Validation loss decreased (-0.599992 --> -0.629991).  Saving model ...
Epoch: 23 cost time: 1.4830124378204346
Epoch: 23, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.838 Vali Acc: 0.630 Test Loss: 0.838 Test Acc: 0.630
Validation loss decreased (-0.629991 --> -0.629992).  Saving model ...
Epoch: 24 cost time: 1.5129685401916504
Epoch: 24, Steps: 20 | Train Loss: 0.416 Vali Loss: 1.066 Vali Acc: 0.630 Test Loss: 1.066 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3291752338409424
Epoch: 25, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.898 Vali Acc: 0.580 Test Loss: 0.898 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6754786968231201
Epoch: 26, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.776 Vali Acc: 0.570 Test Loss: 0.776 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4533874988555908
Epoch: 27, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4435412883758545
Epoch: 28, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
Validation loss decreased (-0.629992 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 1.4926707744598389
Epoch: 29, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6449642181396484
Epoch: 30, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6780853271484375
Epoch: 31, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.104 Vali Acc: 0.630 Test Loss: 1.104 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.292609691619873
Epoch: 32, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4472196102142334
Epoch: 33, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.200 Vali Acc: 0.570 Test Loss: 1.200 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2926042079925537
Epoch: 34, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.074 Vali Acc: 0.580 Test Loss: 1.074 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8245272636413574
Epoch: 35, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.255 Vali Acc: 0.590 Test Loss: 1.255 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6919734477996826
Epoch: 36, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.172 Vali Acc: 0.620 Test Loss: 1.172 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4930615425109863
Epoch: 37, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.201 Vali Acc: 0.610 Test Loss: 1.201 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.4079477787017822
Epoch: 38, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.749 Vali Acc: 0.470 Test Loss: 1.749 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 29673986
model size : 127.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.859026193618774
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.696 Vali Acc: 0.460 Test Loss: 0.696 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.8323755264282227
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.18902587890625
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.68806791305542
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.700639486312866
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.259319543838501
Epoch: 6, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.737 Vali Acc: 0.580 Test Loss: 0.737 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 3.1636621952056885
Epoch: 7, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.916 Vali Acc: 0.480 Test Loss: 0.916 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9872677326202393
Epoch: 8, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4855291843414307
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4505209922790527
Epoch: 10, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.663 Vali Acc: 0.580 Test Loss: 0.663 Test Acc: 0.580
Validation loss decreased (-0.579993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 2.3616514205932617
Epoch: 11, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.714 Vali Acc: 0.600 Test Loss: 0.714 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 2.3047311305999756
Epoch: 12, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.697 Vali Acc: 0.580 Test Loss: 0.697 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.847081184387207
Epoch: 13, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0265913009643555
Epoch: 14, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.923 Vali Acc: 0.490 Test Loss: 0.923 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0348424911499023
Epoch: 15, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4018025398254395
Epoch: 16, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.972 Vali Acc: 0.520 Test Loss: 0.972 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4908652305603027
Epoch: 17, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.690737247467041
Epoch: 18, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6297175884246826
Epoch: 19, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.108139991760254
Epoch: 20, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.036 Vali Acc: 0.490 Test Loss: 1.036 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.93359112739563
Epoch: 21, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.856 Vali Acc: 0.550 Test Loss: 0.856 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 29784578
model size : 128.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.485199213027954
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.698 Vali Acc: 0.470 Test Loss: 0.698 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.6819825172424316
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.797708511352539
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.809 Vali Acc: 0.480 Test Loss: 0.809 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.918060302734375
Epoch: 4, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.758 Vali Acc: 0.490 Test Loss: 0.758 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8004887104034424
Epoch: 5, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 2.1447253227233887
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.173513412475586
Epoch: 7, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6828503608703613
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.498058557510376
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7414042949676514
Epoch: 10, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.824 Vali Acc: 0.520 Test Loss: 0.824 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7874722480773926
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.858086109161377
Epoch: 12, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.853 Vali Acc: 0.560 Test Loss: 0.853 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 13 cost time: 1.8685882091522217
Epoch: 13, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.696 Vali Acc: 0.510 Test Loss: 0.696 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0833916664123535
Epoch: 14, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.685 Vali Acc: 0.590 Test Loss: 0.685 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589993).  Saving model ...
Epoch: 15 cost time: 2.022367477416992
Epoch: 15, Steps: 20 | Train Loss: 0.776 Vali Loss: 0.860 Vali Acc: 0.570 Test Loss: 0.860 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.056065082550049
Epoch: 16, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3675172328948975
Epoch: 17, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.822202444076538
Epoch: 18, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.854 Vali Acc: 0.570 Test Loss: 0.854 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3504910469055176
Epoch: 19, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.815 Vali Acc: 0.530 Test Loss: 0.815 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8306853771209717
Epoch: 20, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.792 Vali Acc: 0.600 Test Loss: 0.792 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 21 cost time: 1.9338996410369873
Epoch: 21, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.901 Vali Acc: 0.560 Test Loss: 0.901 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.79030442237854
Epoch: 22, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.062 Vali Acc: 0.500 Test Loss: 1.062 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6173110008239746
Epoch: 23, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.954 Vali Acc: 0.600 Test Loss: 0.954 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2436885833740234
Epoch: 24, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.902 Vali Acc: 0.570 Test Loss: 0.902 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.010213613510132
Epoch: 25, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.052 Vali Acc: 0.540 Test Loss: 1.052 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8204481601715088
Epoch: 26, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.954 Vali Acc: 0.580 Test Loss: 0.954 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.24630069732666
Epoch: 27, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8588109016418457
Epoch: 28, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.941 Vali Acc: 0.640 Test Loss: 0.941 Test Acc: 0.640
Validation loss decreased (-0.599992 --> -0.639991).  Saving model ...
Epoch: 29 cost time: 1.877938985824585
Epoch: 29, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.077 Vali Acc: 0.560 Test Loss: 1.077 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6819519996643066
Epoch: 30, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.947 Vali Acc: 0.580 Test Loss: 0.947 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6968533992767334
Epoch: 31, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.401 Vali Acc: 0.590 Test Loss: 1.401 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6387386322021484
Epoch: 32, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8359489440917969
Epoch: 33, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.118759870529175
Epoch: 34, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.200 Vali Acc: 0.530 Test Loss: 1.200 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8104536533355713
Epoch: 35, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.258 Vali Acc: 0.550 Test Loss: 1.258 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.760657787322998
Epoch: 36, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.077 Vali Acc: 0.560 Test Loss: 1.077 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.549393892288208
Epoch: 37, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.9048998355865479
Epoch: 38, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.449 Vali Acc: 0.580 Test Loss: 1.449 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 29750786
model size : 128.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.668173313140869
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.416710376739502
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3898828029632568
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.434570550918579
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.6880650520324707
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4164280891418457
Epoch: 6, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5620276927947998
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.729 Vali Acc: 0.460 Test Loss: 0.729 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5988805294036865
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3629348278045654
Epoch: 9, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2748844623565674
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4799013137817383
Epoch: 11, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.3954699039459229
Epoch: 12, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3822064399719238
Epoch: 13, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2663843631744385
Epoch: 14, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.852 Vali Acc: 0.510 Test Loss: 0.852 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.097154140472412
Epoch: 15, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.800 Vali Acc: 0.590 Test Loss: 0.800 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 1.2503626346588135
Epoch: 16, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2681727409362793
Epoch: 17, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2379801273345947
Epoch: 18, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.896 Vali Acc: 0.510 Test Loss: 0.896 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.346181869506836
Epoch: 19, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4483487606048584
Epoch: 20, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.712 Vali Acc: 0.600 Test Loss: 0.712 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599993).  Saving model ...
Epoch: 21 cost time: 1.3366658687591553
Epoch: 21, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3467497825622559
Epoch: 22, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5737242698669434
Epoch: 23, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.273885726928711
Epoch: 24, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.887 Vali Acc: 0.520 Test Loss: 0.887 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6259238719940186
Epoch: 25, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.134 Vali Acc: 0.510 Test Loss: 1.134 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7637851238250732
Epoch: 26, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.036 Vali Acc: 0.540 Test Loss: 1.036 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4368820190429688
Epoch: 27, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.871 Vali Acc: 0.530 Test Loss: 0.871 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.646221399307251
Epoch: 28, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.266 Vali Acc: 0.530 Test Loss: 1.266 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3179221153259277
Epoch: 29, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.941 Vali Acc: 0.510 Test Loss: 0.941 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2643976211547852
Epoch: 30, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.054 Vali Acc: 0.550 Test Loss: 1.054 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 29735426
model size : 128.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.220459222793579
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.81341552734375
Epoch: 2, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.695 Vali Acc: 0.480 Test Loss: 0.695 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0606281757354736
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5922236442565918
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.727 Vali Acc: 0.440 Test Loss: 0.727 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.893232822418213
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.684 Vali Acc: 0.570 Test Loss: 0.684 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.5173835754394531
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.707 Vali Acc: 0.490 Test Loss: 0.707 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8897705078125
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9806087017059326
Epoch: 8, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9964869022369385
Epoch: 9, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8901453018188477
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.703 Vali Acc: 0.620 Test Loss: 0.703 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619993).  Saving model ...
Epoch: 11 cost time: 1.8809146881103516
Epoch: 11, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.141235113143921
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6433141231536865
Epoch: 13, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3795185089111328
Epoch: 14, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6194007396697998
Epoch: 15, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3488576412200928
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 1.081 Vali Acc: 0.470 Test Loss: 1.081 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6916401386260986
Epoch: 17, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.843 Vali Acc: 0.510 Test Loss: 0.843 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3988754749298096
Epoch: 18, Steps: 20 | Train Loss: 0.485 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6217494010925293
Epoch: 19, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0902669429779053
Epoch: 20, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.876 Vali Acc: 0.580 Test Loss: 0.876 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 29824514
model size : 128.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.964665651321411
Epoch: 1, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.689 Vali Acc: 0.530 Test Loss: 0.689 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.9399564266204834
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.666536569595337
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.476970911026001
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.673 Vali Acc: 0.560 Test Loss: 0.673 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 1.2757954597473145
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.39603853225708
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1896264553070068
Epoch: 7, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.296830177307129
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.653 Vali Acc: 0.610 Test Loss: 0.653 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 9 cost time: 1.7539737224578857
Epoch: 9, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2747113704681396
Epoch: 10, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2226908206939697
Epoch: 11, Steps: 20 | Train Loss: 0.578 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.563943862915039
Epoch: 12, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.531620740890503
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.809 Vali Acc: 0.580 Test Loss: 0.809 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5763881206512451
Epoch: 14, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.708 Vali Acc: 0.620 Test Loss: 0.708 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619993).  Saving model ...
Epoch: 15 cost time: 2.000777006149292
Epoch: 15, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6417899131774902
Epoch: 16, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.40855073928833
Epoch: 17, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.819 Vali Acc: 0.560 Test Loss: 0.819 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5010054111480713
Epoch: 18, Steps: 20 | Train Loss: 0.464 Vali Loss: 1.081 Vali Acc: 0.460 Test Loss: 1.081 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.658895492553711
Epoch: 19, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.050 Vali Acc: 0.490 Test Loss: 1.050 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6455485820770264
Epoch: 20, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.543213129043579
Epoch: 21, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.851 Vali Acc: 0.580 Test Loss: 0.851 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5721769332885742
Epoch: 22, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.986 Vali Acc: 0.530 Test Loss: 0.986 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3215808868408203
Epoch: 23, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.872 Vali Acc: 0.550 Test Loss: 0.872 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4729208946228027
Epoch: 24, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.969 Vali Acc: 0.520 Test Loss: 0.969 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 29809154
model size : 128.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.083036422729492
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.2420070171356201
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.3888885974884033
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.736 Vali Acc: 0.440 Test Loss: 0.736 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2761871814727783
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2768528461456299
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3134803771972656
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3827416896820068
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.685 Vali Acc: 0.540 Test Loss: 0.685 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.7833139896392822
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5258188247680664
Epoch: 9, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.691002607345581
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 1.7839949131011963
Epoch: 11, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.712 Vali Acc: 0.580 Test Loss: 0.712 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579993).  Saving model ...
Epoch: 12 cost time: 1.7136707305908203
Epoch: 12, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4561913013458252
Epoch: 13, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6343660354614258
Epoch: 14, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5509693622589111
Epoch: 15, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.737 Vali Acc: 0.610 Test Loss: 0.737 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 16 cost time: 1.7802023887634277
Epoch: 16, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.749 Vali Acc: 0.600 Test Loss: 0.749 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.660897970199585
Epoch: 17, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.794 Vali Acc: 0.530 Test Loss: 0.794 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.559218406677246
Epoch: 18, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.628263235092163
Epoch: 19, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.845 Vali Acc: 0.560 Test Loss: 0.845 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7202787399291992
Epoch: 20, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.725 Vali Acc: 0.600 Test Loss: 0.725 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.614424467086792
Epoch: 21, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6949248313903809
Epoch: 22, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.878 Vali Acc: 0.580 Test Loss: 0.878 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.492544412612915
Epoch: 23, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.004 Vali Acc: 0.510 Test Loss: 1.004 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3028831481933594
Epoch: 24, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.920 Vali Acc: 0.560 Test Loss: 0.920 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4763870239257812
Epoch: 25, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.918 Vali Acc: 0.630 Test Loss: 0.918 Test Acc: 0.630
Validation loss decreased (-0.609993 --> -0.629991).  Saving model ...
Epoch: 26 cost time: 1.4064130783081055
Epoch: 26, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.150 Vali Acc: 0.530 Test Loss: 1.150 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.531477451324463
Epoch: 27, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.990 Vali Acc: 0.540 Test Loss: 0.990 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2493739128112793
Epoch: 28, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.124 Vali Acc: 0.550 Test Loss: 1.124 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7999377250671387
Epoch: 29, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.192 Vali Acc: 0.550 Test Loss: 1.192 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.643911600112915
Epoch: 30, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.975 Vali Acc: 0.590 Test Loss: 0.975 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8774795532226562
Epoch: 31, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.994 Vali Acc: 0.590 Test Loss: 0.994 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7904608249664307
Epoch: 32, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.048 Vali Acc: 0.510 Test Loss: 1.048 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.521195888519287
Epoch: 33, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.135 Vali Acc: 0.540 Test Loss: 1.135 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6902685165405273
Epoch: 34, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.093 Vali Acc: 0.560 Test Loss: 1.093 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8298940658569336
Epoch: 35, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.144 Vali Acc: 0.570 Test Loss: 1.144 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 29796866
model size : 128.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3358399868011475
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.3633201122283936
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.4736037254333496
Epoch: 3, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.7851836681365967
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5067861080169678
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7082970142364502
Epoch: 6, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8670122623443604
Epoch: 7, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7159531116485596
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6085789203643799
Epoch: 9, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4981415271759033
Epoch: 10, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3868989944458008
Epoch: 11, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.725 Vali Acc: 0.610 Test Loss: 0.725 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609993).  Saving model ...
Epoch: 12 cost time: 1.2753541469573975
Epoch: 12, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.764 Vali Acc: 0.590 Test Loss: 0.764 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4406108856201172
Epoch: 13, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.720 Vali Acc: 0.620 Test Loss: 0.720 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619993).  Saving model ...
Epoch: 14 cost time: 1.1948878765106201
Epoch: 14, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5280735492706299
Epoch: 15, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3394324779510498
Epoch: 16, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.607670545578003
Epoch: 17, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.847 Vali Acc: 0.570 Test Loss: 0.847 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8099241256713867
Epoch: 18, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.805 Vali Acc: 0.600 Test Loss: 0.805 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5991342067718506
Epoch: 19, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.967 Vali Acc: 0.570 Test Loss: 0.967 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3809783458709717
Epoch: 20, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.895 Vali Acc: 0.580 Test Loss: 0.895 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5833816528320312
Epoch: 21, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.035 Vali Acc: 0.520 Test Loss: 1.035 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7651407718658447
Epoch: 22, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.984 Vali Acc: 0.610 Test Loss: 0.984 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.946796178817749
Epoch: 23, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.144 Vali Acc: 0.540 Test Loss: 1.144 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 29889026
model size : 128.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.36460018157959
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.695 Vali Acc: 0.490 Test Loss: 0.695 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.6966617107391357
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6734097003936768
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.0550029277801514
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.615248441696167
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.8532617092132568
Epoch: 6, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7177093029022217
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.9236323833465576
Epoch: 8, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7541248798370361
Epoch: 9, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.823 Vali Acc: 0.480 Test Loss: 0.823 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5435822010040283
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5179576873779297
Epoch: 11, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8990435600280762
Epoch: 12, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8118345737457275
Epoch: 13, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.573746919631958
Epoch: 14, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.972 Vali Acc: 0.500 Test Loss: 0.972 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4800245761871338
Epoch: 15, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 16 cost time: 1.4780020713806152
Epoch: 16, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.801 Vali Acc: 0.560 Test Loss: 0.801 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5261688232421875
Epoch: 17, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.883742094039917
Epoch: 18, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.736 Vali Acc: 0.620 Test Loss: 0.736 Test Acc: 0.620
Validation loss decreased (-0.559992 --> -0.619993).  Saving model ...
Epoch: 19 cost time: 1.74507737159729
Epoch: 19, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.846 Vali Acc: 0.480 Test Loss: 0.846 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.032498359680176
Epoch: 20, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.899 Vali Acc: 0.600 Test Loss: 0.899 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6024730205535889
Epoch: 21, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.895 Vali Acc: 0.590 Test Loss: 0.895 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.559267282485962
Epoch: 22, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4125521183013916
Epoch: 23, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.913 Vali Acc: 0.510 Test Loss: 0.913 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.565436601638794
Epoch: 24, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.039 Vali Acc: 0.530 Test Loss: 1.039 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3956260681152344
Epoch: 25, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.015 Vali Acc: 0.570 Test Loss: 1.015 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3220524787902832
Epoch: 26, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.992 Vali Acc: 0.560 Test Loss: 0.992 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2903287410736084
Epoch: 27, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5212655067443848
Epoch: 28, Steps: 20 | Train Loss: 0.356 Vali Loss: 0.962 Vali Acc: 0.560 Test Loss: 0.962 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 29873666
model size : 128.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.171412944793701
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.4565849304199219
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4763343334197998
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.734 Vali Acc: 0.440 Test Loss: 0.734 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9115605354309082
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2600340843200684
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4924492835998535
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.738 Vali Acc: 0.450 Test Loss: 0.738 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4320318698883057
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2736105918884277
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.6247138977050781
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.812 Vali Acc: 0.530 Test Loss: 0.812 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3436636924743652
Epoch: 10, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.3337695598602295
Epoch: 11, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6148312091827393
Epoch: 12, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.713 Vali Acc: 0.590 Test Loss: 0.713 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 1.538663387298584
Epoch: 13, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.852 Vali Acc: 0.460 Test Loss: 0.852 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4237079620361328
Epoch: 14, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.653735876083374
Epoch: 15, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5351150035858154
Epoch: 16, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2868564128875732
Epoch: 17, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7954745292663574
Epoch: 18, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.482494592666626
Epoch: 19, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.368041753768921
Epoch: 20, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.905 Vali Acc: 0.600 Test Loss: 0.905 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599991).  Saving model ...
Epoch: 21 cost time: 1.1924333572387695
Epoch: 21, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.805 Vali Acc: 0.560 Test Loss: 0.805 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.220778226852417
Epoch: 22, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.942 Vali Acc: 0.570 Test Loss: 0.942 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.569810152053833
Epoch: 23, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.013 Vali Acc: 0.590 Test Loss: 1.013 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.245215892791748
Epoch: 24, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.904 Vali Acc: 0.540 Test Loss: 0.904 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.141129732131958
Epoch: 25, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.987 Vali Acc: 0.540 Test Loss: 0.987 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.339402198791504
Epoch: 26, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.948 Vali Acc: 0.510 Test Loss: 0.948 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2639670372009277
Epoch: 27, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.874 Vali Acc: 0.580 Test Loss: 0.874 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6123335361480713
Epoch: 28, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.901 Vali Acc: 0.550 Test Loss: 0.901 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7272343635559082
Epoch: 29, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.281 Vali Acc: 0.480 Test Loss: 1.281 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5741918087005615
Epoch: 30, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.954 Vali Acc: 0.480 Test Loss: 0.954 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 29861378
model size : 128.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.571696758270264
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.6672019958496094
Epoch: 2, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8699679374694824
Epoch: 3, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.850 Vali Acc: 0.500 Test Loss: 0.850 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6287686824798584
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.881 Vali Acc: 0.460 Test Loss: 0.881 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.561941385269165
Epoch: 5, Steps: 20 | Train Loss: 0.811 Vali Loss: 0.757 Vali Acc: 0.600 Test Loss: 0.757 Test Acc: 0.600
Validation loss decreased (-0.499993 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.598437786102295
Epoch: 6, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5593907833099365
Epoch: 7, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4937233924865723
Epoch: 8, Steps: 20 | Train Loss: 0.928 Vali Loss: 1.063 Vali Acc: 0.510 Test Loss: 1.063 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5045363903045654
Epoch: 9, Steps: 20 | Train Loss: 0.978 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5475268363952637
Epoch: 10, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.903 Vali Acc: 0.460 Test Loss: 0.903 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9716527462005615
Epoch: 11, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6733551025390625
Epoch: 12, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.723 Vali Acc: 0.590 Test Loss: 0.723 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3020312786102295
Epoch: 13, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2171692848205566
Epoch: 14, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6784439086914062
Epoch: 15, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22392578
model size : 100.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.643740177154541
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.808 Vali Acc: 0.490 Test Loss: 0.808 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.3579678535461426
Epoch: 2, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.688 Vali Acc: 0.540 Test Loss: 0.688 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.8793065547943115
Epoch: 3, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7368683815002441
Epoch: 4, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5013558864593506
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3354849815368652
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.814 Vali Acc: 0.510 Test Loss: 0.814 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2483036518096924
Epoch: 7, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.698 Vali Acc: 0.580 Test Loss: 0.698 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 2.033064603805542
Epoch: 8, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1595468521118164
Epoch: 9, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.097928524017334
Epoch: 10, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.249879837036133
Epoch: 11, Steps: 20 | Train Loss: 0.769 Vali Loss: 1.002 Vali Acc: 0.490 Test Loss: 1.002 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.069444417953491
Epoch: 12, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0132150650024414
Epoch: 13, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.045048236846924
Epoch: 14, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4882733821868896
Epoch: 15, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0648717880249023
Epoch: 16, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.080381155014038
Epoch: 17, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 22318850
model size : 99.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.083073377609253
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.77531099319458
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8109116554260254
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2315433025360107
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.871 Vali Acc: 0.470 Test Loss: 0.871 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0194804668426514
Epoch: 5, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6772754192352295
Epoch: 6, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.56152081489563
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 2.461036205291748
Epoch: 8, Steps: 20 | Train Loss: 0.793 Vali Loss: 0.873 Vali Acc: 0.520 Test Loss: 0.873 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5302481651306152
Epoch: 9, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.793 Vali Acc: 0.560 Test Loss: 0.793 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8649582862854004
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.85939884185791
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.700 Vali Acc: 0.570 Test Loss: 0.700 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 2.1892387866973877
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2912075519561768
Epoch: 13, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0506012439727783
Epoch: 14, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5887129306793213
Epoch: 15, Steps: 20 | Train Loss: 0.799 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.717111587524414
Epoch: 16, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6308772563934326
Epoch: 17, Steps: 20 | Train Loss: 0.601 Vali Loss: 1.177 Vali Acc: 0.540 Test Loss: 1.177 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.655885696411133
Epoch: 18, Steps: 20 | Train Loss: 0.715 Vali Loss: 1.153 Vali Acc: 0.490 Test Loss: 1.153 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.797386646270752
Epoch: 19, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.868 Vali Acc: 0.590 Test Loss: 0.868 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589991).  Saving model ...
Epoch: 20 cost time: 2.6718688011169434
Epoch: 20, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9006826877593994
Epoch: 21, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7703325748443604
Epoch: 22, Steps: 20 | Train Loss: 0.714 Vali Loss: 1.636 Vali Acc: 0.490 Test Loss: 1.636 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5791540145874023
Epoch: 23, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.974 Vali Acc: 0.470 Test Loss: 0.974 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.06927227973938
Epoch: 24, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.938 Vali Acc: 0.570 Test Loss: 0.938 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4470338821411133
Epoch: 25, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.436892032623291
Epoch: 26, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.786 Vali Acc: 0.570 Test Loss: 0.786 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.866621732711792
Epoch: 27, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.720 Vali Acc: 0.570 Test Loss: 0.720 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.365549325942993
Epoch: 28, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.836 Vali Acc: 0.620 Test Loss: 0.836 Test Acc: 0.620
Validation loss decreased (-0.589991 --> -0.619992).  Saving model ...
Epoch: 29 cost time: 2.7063796520233154
Epoch: 29, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.950 Vali Acc: 0.510 Test Loss: 0.950 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.60850191116333
Epoch: 30, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.875 Vali Acc: 0.500 Test Loss: 0.875 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.8061957359313965
Epoch: 31, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.938 Vali Acc: 0.490 Test Loss: 0.938 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.599517822265625
Epoch: 32, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.846 Vali Acc: 0.550 Test Loss: 0.846 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.1873178482055664
Epoch: 33, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.957 Vali Acc: 0.640 Test Loss: 0.957 Test Acc: 0.640
Validation loss decreased (-0.619992 --> -0.639990).  Saving model ...
Epoch: 34 cost time: 2.1718764305114746
Epoch: 34, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.863 Vali Acc: 0.570 Test Loss: 0.863 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.2020719051361084
Epoch: 35, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.446 Vali Acc: 0.570 Test Loss: 1.446 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.764169216156006
Epoch: 36, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.975 Vali Acc: 0.640 Test Loss: 0.975 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.842650890350342
Epoch: 37, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.873 Vali Acc: 0.570 Test Loss: 0.873 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.4466392993927
Epoch: 38, Steps: 20 | Train Loss: 0.460 Vali Loss: 1.063 Vali Acc: 0.560 Test Loss: 1.063 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.755286693572998
Epoch: 39, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.6737704277038574
Epoch: 40, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.132 Vali Acc: 0.570 Test Loss: 1.132 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.306468963623047
Epoch: 41, Steps: 20 | Train Loss: 0.694 Vali Loss: 1.048 Vali Acc: 0.560 Test Loss: 1.048 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.428997278213501
Epoch: 42, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.331 Vali Acc: 0.590 Test Loss: 1.331 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.435152292251587
Epoch: 43, Steps: 20 | Train Loss: 0.541 Vali Loss: 1.104 Vali Acc: 0.590 Test Loss: 1.104 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 22454018
model size : 100.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.4794416427612305
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.117995262145996
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.9236185550689697
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.9192442893981934
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.5995852947235107
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7960693836212158
Epoch: 6, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8699944019317627
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 1.8945655822753906
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
Validation loss decreased (-0.509992 --> -0.589993).  Saving model ...
Epoch: 9 cost time: 1.9643886089324951
Epoch: 9, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.038424491882324
Epoch: 10, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.746 Vali Acc: 0.440 Test Loss: 0.746 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0349209308624268
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2393853664398193
Epoch: 12, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5916459560394287
Epoch: 13, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.662 Vali Acc: 0.610 Test Loss: 0.662 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609993).  Saving model ...
Epoch: 14 cost time: 2.223745107650757
Epoch: 14, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.811 Vali Acc: 0.480 Test Loss: 0.811 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5172572135925293
Epoch: 15, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5123910903930664
Epoch: 16, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.49198579788208
Epoch: 17, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.921 Vali Acc: 0.480 Test Loss: 0.921 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8138175010681152
Epoch: 18, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.742281436920166
Epoch: 19, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.671 Vali Acc: 0.620 Test Loss: 0.671 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619993).  Saving model ...
Epoch: 20 cost time: 2.152423858642578
Epoch: 20, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.832 Vali Acc: 0.580 Test Loss: 0.832 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4722838401794434
Epoch: 21, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.854 Vali Acc: 0.580 Test Loss: 0.854 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.172799825668335
Epoch: 22, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.670 Vali Acc: 0.640 Test Loss: 0.670 Test Acc: 0.640
Validation loss decreased (-0.619993 --> -0.639993).  Saving model ...
Epoch: 23 cost time: 1.9679439067840576
Epoch: 23, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.815 Vali Acc: 0.550 Test Loss: 0.815 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0002737045288086
Epoch: 24, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.728 Vali Acc: 0.570 Test Loss: 0.728 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9670848846435547
Epoch: 25, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.892 Vali Acc: 0.560 Test Loss: 0.892 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1944527626037598
Epoch: 26, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.787 Vali Acc: 0.590 Test Loss: 0.787 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.441837787628174
Epoch: 27, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.876 Vali Acc: 0.510 Test Loss: 0.876 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3861148357391357
Epoch: 28, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.900 Vali Acc: 0.530 Test Loss: 0.900 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3644521236419678
Epoch: 29, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.972 Vali Acc: 0.580 Test Loss: 0.972 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3547542095184326
Epoch: 30, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.036 Vali Acc: 0.530 Test Loss: 1.036 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.3901290893554688
Epoch: 31, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.840 Vali Acc: 0.600 Test Loss: 0.840 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2754569053649902
Epoch: 32, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 22380290
model size : 100.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.154013633728027
Epoch: 1, Steps: 20 | Train Loss: 0.810 Vali Loss: 0.750 Vali Acc: 0.420 Test Loss: 0.750 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 2.2137796878814697
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.756 Vali Acc: 0.460 Test Loss: 0.756 Test Acc: 0.460
Validation loss decreased (-0.419992 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 2.1877622604370117
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.753 Vali Acc: 0.440 Test Loss: 0.753 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.727339744567871
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
Validation loss decreased (-0.459992 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.2668120861053467
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.803 Vali Acc: 0.480 Test Loss: 0.803 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8291759490966797
Epoch: 6, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8155262470245361
Epoch: 7, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8185827732086182
Epoch: 8, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.775 Vali Acc: 0.520 Test Loss: 0.775 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8629670143127441
Epoch: 9, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8125131130218506
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.704 Vali Acc: 0.470 Test Loss: 0.704 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.92012357711792
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.893911600112915
Epoch: 12, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 13 cost time: 1.727663516998291
Epoch: 13, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6865909099578857
Epoch: 14, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7804617881774902
Epoch: 15, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0096933841705322
Epoch: 16, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.724 Vali Acc: 0.610 Test Loss: 0.724 Test Acc: 0.610
Validation loss decreased (-0.529993 --> -0.609993).  Saving model ...
Epoch: 17 cost time: 2.1177189350128174
Epoch: 17, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0019354820251465
Epoch: 18, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5877745151519775
Epoch: 19, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.685 Vali Acc: 0.550 Test Loss: 0.685 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8797197341918945
Epoch: 20, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.944765329360962
Epoch: 21, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.117875337600708
Epoch: 22, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.197861433029175
Epoch: 23, Steps: 20 | Train Loss: 0.641 Vali Loss: 1.098 Vali Acc: 0.480 Test Loss: 1.098 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.999049186706543
Epoch: 24, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.873 Vali Acc: 0.580 Test Loss: 0.873 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1899631023406982
Epoch: 25, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.866 Vali Acc: 0.550 Test Loss: 0.866 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0115909576416016
Epoch: 26, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.812 Vali Acc: 0.580 Test Loss: 0.812 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22355714
model size : 99.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.6487367153167725
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.2676684856414795
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3599905967712402
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.800 Vali Acc: 0.470 Test Loss: 0.800 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.799830198287964
Epoch: 4, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.819 Vali Acc: 0.430 Test Loss: 0.819 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.243816375732422
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 3.0016443729400635
Epoch: 6, Steps: 20 | Train Loss: 0.859 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.968174934387207
Epoch: 7, Steps: 20 | Train Loss: 0.850 Vali Loss: 0.896 Vali Acc: 0.520 Test Loss: 0.896 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.024742841720581
Epoch: 8, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2432005405426025
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.676 Vali Acc: 0.560 Test Loss: 0.676 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 2.702514171600342
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.917 Vali Acc: 0.520 Test Loss: 0.917 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2203705310821533
Epoch: 11, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8780786991119385
Epoch: 12, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.701 Vali Acc: 0.590 Test Loss: 0.701 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 2.9574296474456787
Epoch: 13, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.814 Vali Acc: 0.480 Test Loss: 0.814 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.00247859954834
Epoch: 14, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3711962699890137
Epoch: 15, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0995395183563232
Epoch: 16, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.715 Vali Acc: 0.620 Test Loss: 0.715 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619993).  Saving model ...
Epoch: 17 cost time: 1.978825330734253
Epoch: 17, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.805 Vali Acc: 0.490 Test Loss: 0.805 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8350818157196045
Epoch: 18, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.874 Vali Acc: 0.580 Test Loss: 0.874 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.843801975250244
Epoch: 19, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7779765129089355
Epoch: 20, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.706 Vali Acc: 0.600 Test Loss: 0.706 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8647820949554443
Epoch: 21, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.812 Vali Acc: 0.530 Test Loss: 0.812 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.907304286956787
Epoch: 22, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.809 Vali Acc: 0.600 Test Loss: 0.809 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3010082244873047
Epoch: 23, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.923 Vali Acc: 0.520 Test Loss: 0.923 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.0504369735717773
Epoch: 24, Steps: 20 | Train Loss: 0.591 Vali Loss: 1.127 Vali Acc: 0.480 Test Loss: 1.127 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7055795192718506
Epoch: 25, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.091 Vali Acc: 0.520 Test Loss: 1.091 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.8261828422546387
Epoch: 26, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.797 Vali Acc: 0.600 Test Loss: 0.797 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 22515458
model size : 100.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.142852067947388
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.690 Vali Acc: 0.570 Test Loss: 0.690 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.6955196857452393
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0735154151916504
Epoch: 3, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8722622394561768
Epoch: 4, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.716 Vali Acc: 0.570 Test Loss: 0.716 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9336881637573242
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7698895931243896
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7096927165985107
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0321402549743652
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.683 Vali Acc: 0.610 Test Loss: 0.683 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 9 cost time: 1.5772347450256348
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.673 Vali Acc: 0.590 Test Loss: 0.673 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0877842903137207
Epoch: 10, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.666 Vali Acc: 0.560 Test Loss: 0.666 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4130382537841797
Epoch: 11, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6893389225006104
Epoch: 12, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.197183132171631
Epoch: 13, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4924895763397217
Epoch: 14, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.676 Vali Acc: 0.590 Test Loss: 0.676 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9153218269348145
Epoch: 15, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.698 Vali Acc: 0.610 Test Loss: 0.698 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7593543529510498
Epoch: 16, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.674 Vali Acc: 0.590 Test Loss: 0.674 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.093405246734619
Epoch: 17, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4716062545776367
Epoch: 18, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.754 Vali Acc: 0.580 Test Loss: 0.754 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22444802
model size : 100.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.625965118408203
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.3810040950775146
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.6070959568023682
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6956844329833984
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6536026000976562
Epoch: 5, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5716423988342285
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4962778091430664
Epoch: 7, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.423030138015747
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6546730995178223
Epoch: 9, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7076330184936523
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.668527364730835
Epoch: 11, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.665 Vali Acc: 0.570 Test Loss: 0.665 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.4733459949493408
Epoch: 12, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.688 Vali Acc: 0.570 Test Loss: 0.688 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1836144924163818
Epoch: 13, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0611753463745117
Epoch: 14, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1388940811157227
Epoch: 15, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8634517192840576
Epoch: 16, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.739410638809204
Epoch: 17, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6777410507202148
Epoch: 18, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.602785587310791
Epoch: 19, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5032954216003418
Epoch: 20, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.75136137008667
Epoch: 21, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.777 Vali Acc: 0.580 Test Loss: 0.777 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 22 cost time: 1.9866416454315186
Epoch: 22, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.689 Vali Acc: 0.610 Test Loss: 0.689 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609993).  Saving model ...
Epoch: 23 cost time: 1.9823682308197021
Epoch: 23, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.899 Vali Acc: 0.560 Test Loss: 0.899 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9716651439666748
Epoch: 24, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6936230659484863
Epoch: 25, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6962776184082031
Epoch: 26, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.866 Vali Acc: 0.550 Test Loss: 0.866 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3023595809936523
Epoch: 27, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.588109016418457
Epoch: 28, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.819 Vali Acc: 0.610 Test Loss: 0.819 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5354945659637451
Epoch: 29, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4105792045593262
Epoch: 30, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3350005149841309
Epoch: 31, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.938 Vali Acc: 0.490 Test Loss: 0.938 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5940027236938477
Epoch: 32, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.913 Vali Acc: 0.540 Test Loss: 0.913 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22407938
model size : 100.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.228194952011108
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5705444812774658
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.7748494148254395
Epoch: 3, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.741 Vali Acc: 0.440 Test Loss: 0.741 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.55922532081604
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 2.2378146648406982
Epoch: 5, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 2.4242708683013916
Epoch: 6, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.211430072784424
Epoch: 7, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.666151762008667
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0734646320343018
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0425424575805664
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.676 Vali Acc: 0.580 Test Loss: 0.676 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 1.8707005977630615
Epoch: 11, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9817638397216797
Epoch: 12, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3418920040130615
Epoch: 13, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.708 Vali Acc: 0.570 Test Loss: 0.708 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.899327039718628
Epoch: 14, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.800 Vali Acc: 0.550 Test Loss: 0.800 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.284613609313965
Epoch: 15, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7023606300354004
Epoch: 16, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.133188009262085
Epoch: 17, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.726 Vali Acc: 0.590 Test Loss: 0.726 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 18 cost time: 1.9389793872833252
Epoch: 18, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.784 Vali Acc: 0.580 Test Loss: 0.784 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9951729774475098
Epoch: 19, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.888120412826538
Epoch: 20, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6386947631835938
Epoch: 21, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8150639533996582
Epoch: 22, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.732 Vali Acc: 0.560 Test Loss: 0.732 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1136536598205566
Epoch: 23, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.488624334335327
Epoch: 24, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.894 Vali Acc: 0.590 Test Loss: 0.894 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3027241230010986
Epoch: 25, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.886 Vali Acc: 0.580 Test Loss: 0.886 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.222013473510742
Epoch: 26, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.823 Vali Acc: 0.600 Test Loss: 0.823 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 27 cost time: 1.2733190059661865
Epoch: 27, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.802 Vali Acc: 0.510 Test Loss: 0.802 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5240371227264404
Epoch: 28, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.893 Vali Acc: 0.530 Test Loss: 0.893 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.871978759765625
Epoch: 29, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.941 Vali Acc: 0.560 Test Loss: 0.941 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.09267520904541
Epoch: 30, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.858 Vali Acc: 0.500 Test Loss: 0.858 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.7353875637054443
Epoch: 31, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.953 Vali Acc: 0.500 Test Loss: 0.953 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.6861214637756348
Epoch: 32, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.816 Vali Acc: 0.590 Test Loss: 0.816 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.301745653152466
Epoch: 33, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.943 Vali Acc: 0.570 Test Loss: 0.943 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.3288962841033936
Epoch: 34, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.930 Vali Acc: 0.530 Test Loss: 0.930 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0530171394348145
Epoch: 35, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.904 Vali Acc: 0.520 Test Loss: 0.904 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.31364369392395
Epoch: 36, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.843 Vali Acc: 0.540 Test Loss: 0.843 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22506242
model size : 100.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.170738220214844
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.666 Vali Acc: 0.620 Test Loss: 0.666 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 2.2618582248687744
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1835525035858154
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.090902328491211
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.650437831878662
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4076669216156006
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5098915100097656
Epoch: 7, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.515923500061035
Epoch: 8, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2089521884918213
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2146406173706055
Epoch: 10, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9938125610351562
Epoch: 11, Steps: 20 | Train Loss: 0.715 Vali Loss: 1.044 Vali Acc: 0.490 Test Loss: 1.044 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 22484738
model size : 100.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6412153244018555
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.708 Vali Acc: 0.440 Test Loss: 0.708 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.8203277587890625
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.9255754947662354
Epoch: 3, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.4811968803405762
Epoch: 4, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9964303970336914
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 1.5292701721191406
Epoch: 6, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1284112930297852
Epoch: 7, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.456721544265747
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.742 Vali Acc: 0.460 Test Loss: 0.742 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.994352102279663
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.834 Vali Acc: 0.490 Test Loss: 0.834 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.382918119430542
Epoch: 10, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 11 cost time: 1.75150728225708
Epoch: 11, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 12 cost time: 1.6272974014282227
Epoch: 12, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4001588821411133
Epoch: 13, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5087497234344482
Epoch: 14, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4088943004608154
Epoch: 15, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.963 Vali Acc: 0.550 Test Loss: 0.963 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549990).  Saving model ...
Epoch: 16 cost time: 1.654637098312378
Epoch: 16, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.936 Vali Acc: 0.570 Test Loss: 0.936 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569991).  Saving model ...
Epoch: 17 cost time: 1.7564496994018555
Epoch: 17, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.787 Vali Acc: 0.590 Test Loss: 0.787 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589992).  Saving model ...
Epoch: 18 cost time: 1.144618034362793
Epoch: 18, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.771 Vali Acc: 0.580 Test Loss: 0.771 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6244816780090332
Epoch: 19, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.328 Vali Acc: 0.510 Test Loss: 1.328 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.604109287261963
Epoch: 20, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.836 Vali Acc: 0.550 Test Loss: 0.836 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4650533199310303
Epoch: 21, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.067 Vali Acc: 0.580 Test Loss: 1.067 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6334519386291504
Epoch: 22, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.922 Vali Acc: 0.560 Test Loss: 0.922 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5085089206695557
Epoch: 23, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.998 Vali Acc: 0.480 Test Loss: 0.998 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.462981939315796
Epoch: 24, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.020 Vali Acc: 0.540 Test Loss: 1.020 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.654904842376709
Epoch: 25, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.986 Vali Acc: 0.540 Test Loss: 0.986 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.594933271408081
Epoch: 26, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.214 Vali Acc: 0.530 Test Loss: 1.214 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.800703763961792
Epoch: 27, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.999 Vali Acc: 0.510 Test Loss: 0.999 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 22466306
model size : 100.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.435826301574707
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.696 Vali Acc: 0.510 Test Loss: 0.696 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.74674391746521
Epoch: 2, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.683 Vali Acc: 0.510 Test Loss: 0.683 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.6409261226654053
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.55199933052063
Epoch: 4, Steps: 20 | Train Loss: 0.771 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4285006523132324
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.037458896636963
Epoch: 6, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.110413074493408
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 2.1189258098602295
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9040133953094482
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8068463802337646
Epoch: 10, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.791 Vali Acc: 0.570 Test Loss: 0.791 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.291597843170166
Epoch: 11, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.819 Vali Acc: 0.470 Test Loss: 0.819 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6458995342254639
Epoch: 12, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.690 Vali Acc: 0.570 Test Loss: 0.690 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 1.3013670444488525
Epoch: 13, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7255816459655762
Epoch: 14, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.806 Vali Acc: 0.530 Test Loss: 0.806 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.944312572479248
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.767 Vali Acc: 0.640 Test Loss: 0.767 Test Acc: 0.640
Validation loss decreased (-0.569993 --> -0.639992).  Saving model ...
Epoch: 16 cost time: 2.0203752517700195
Epoch: 16, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.651 Vali Acc: 0.600 Test Loss: 0.651 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8492348194122314
Epoch: 17, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.635 Vali Acc: 0.630 Test Loss: 0.635 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2163686752319336
Epoch: 18, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.762 Vali Acc: 0.580 Test Loss: 0.762 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.174980640411377
Epoch: 19, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.854 Vali Acc: 0.580 Test Loss: 0.854 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9480912685394287
Epoch: 20, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.817 Vali Acc: 0.650 Test Loss: 0.817 Test Acc: 0.650
Validation loss decreased (-0.639992 --> -0.649992).  Saving model ...
Epoch: 21 cost time: 2.142078161239624
Epoch: 21, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.842 Vali Acc: 0.590 Test Loss: 0.842 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9521307945251465
Epoch: 22, Steps: 20 | Train Loss: 0.827 Vali Loss: 1.423 Vali Acc: 0.540 Test Loss: 1.423 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.456129789352417
Epoch: 23, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.746382474899292
Epoch: 24, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7500717639923096
Epoch: 25, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.843 Vali Acc: 0.610 Test Loss: 0.843 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0168585777282715
Epoch: 26, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.875 Vali Acc: 0.540 Test Loss: 0.875 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.189603567123413
Epoch: 27, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.113 Vali Acc: 0.520 Test Loss: 1.113 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.042085647583008
Epoch: 28, Steps: 20 | Train Loss: 0.496 Vali Loss: 1.444 Vali Acc: 0.530 Test Loss: 1.444 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.040393829345703
Epoch: 29, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.168 Vali Acc: 0.540 Test Loss: 1.168 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9217352867126465
Epoch: 30, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.258 Vali Acc: 0.610 Test Loss: 1.258 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 22570754
model size : 100.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5122547149658203
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.1919281482696533
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.771 Vali Acc: 0.460 Test Loss: 0.771 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5337834358215332
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.7686998844146729
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6796884536743164
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6309494972229004
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.48667573928833
Epoch: 7, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.313619613647461
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.677 Vali Acc: 0.630 Test Loss: 0.677 Test Acc: 0.630
Validation loss decreased (-0.529993 --> -0.629993).  Saving model ...
Epoch: 9 cost time: 1.3556241989135742
Epoch: 9, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2195687294006348
Epoch: 10, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6677305698394775
Epoch: 11, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7812302112579346
Epoch: 12, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.691 Vali Acc: 0.580 Test Loss: 0.691 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6338245868682861
Epoch: 13, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.324190378189087
Epoch: 14, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5471360683441162
Epoch: 15, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.692 Vali Acc: 0.590 Test Loss: 0.692 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5879371166229248
Epoch: 16, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9027159214019775
Epoch: 17, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.920 Vali Acc: 0.510 Test Loss: 0.920 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7194316387176514
Epoch: 18, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.750 Vali Acc: 0.590 Test Loss: 0.750 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 22546178
model size : 100.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6533968448638916
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1755337715148926
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.721 Vali Acc: 0.460 Test Loss: 0.721 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.433180570602417
Epoch: 3, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5918703079223633
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.742 Vali Acc: 0.420 Test Loss: 0.742 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5823009014129639
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3130338191986084
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5579988956451416
Epoch: 7, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7145497798919678
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 1.7135262489318848
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.6232428550720215
Epoch: 10, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.779 Vali Acc: 0.480 Test Loss: 0.779 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7263734340667725
Epoch: 11, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.787623643875122
Epoch: 12, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4642038345336914
Epoch: 13, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.684851884841919
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.671 Vali Acc: 0.560 Test Loss: 0.671 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 1.3963077068328857
Epoch: 15, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.803 Vali Acc: 0.490 Test Loss: 0.803 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4619662761688232
Epoch: 16, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7929019927978516
Epoch: 17, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.716 Vali Acc: 0.600 Test Loss: 0.716 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 18 cost time: 1.4076244831085205
Epoch: 18, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.676 Vali Acc: 0.550 Test Loss: 0.676 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4713635444641113
Epoch: 19, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7306623458862305
Epoch: 20, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6199798583984375
Epoch: 21, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.810 Vali Acc: 0.580 Test Loss: 0.810 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8040335178375244
Epoch: 22, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4644064903259277
Epoch: 23, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.977 Vali Acc: 0.570 Test Loss: 0.977 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2528154850006104
Epoch: 24, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4334120750427246
Epoch: 25, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.783 Vali Acc: 0.630 Test Loss: 0.783 Test Acc: 0.630
Validation loss decreased (-0.599993 --> -0.629992).  Saving model ...
Epoch: 26 cost time: 1.3775758743286133
Epoch: 26, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.104 Vali Acc: 0.510 Test Loss: 1.104 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5344212055206299
Epoch: 27, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.921 Vali Acc: 0.520 Test Loss: 0.921 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.266587257385254
Epoch: 28, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.019 Vali Acc: 0.530 Test Loss: 1.019 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.371446132659912
Epoch: 29, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.260 Vali Acc: 0.540 Test Loss: 1.260 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6027164459228516
Epoch: 30, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.932 Vali Acc: 0.560 Test Loss: 0.932 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4514055252075195
Epoch: 31, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.596001386642456
Epoch: 32, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.354 Vali Acc: 0.580 Test Loss: 1.354 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.338869333267212
Epoch: 33, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.033 Vali Acc: 0.590 Test Loss: 1.033 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6434352397918701
Epoch: 34, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.266 Vali Acc: 0.510 Test Loss: 1.266 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4087092876434326
Epoch: 35, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.344 Vali Acc: 0.580 Test Loss: 1.344 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 22524674
model size : 100.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8656628131866455
Epoch: 1, Steps: 20 | Train Loss: 0.772 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.563030481338501
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.771 Vali Acc: 0.470 Test Loss: 0.771 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1828806400299072
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.738 Vali Acc: 0.450 Test Loss: 0.738 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2465615272521973
Epoch: 4, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0813112258911133
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 2.0500669479370117
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.716 Vali Acc: 0.470 Test Loss: 0.716 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8203604221343994
Epoch: 7, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 2.338390350341797
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 2.9625794887542725
Epoch: 9, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9742858409881592
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.0986647605895996
Epoch: 11, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.923966407775879
Epoch: 12, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.760 Vali Acc: 0.540 Test Loss: 0.760 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.154979944229126
Epoch: 13, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.692 Vali Acc: 0.550 Test Loss: 0.692 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 14 cost time: 2.3891220092773438
Epoch: 14, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.635864019393921
Epoch: 15, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9923264980316162
Epoch: 16, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.662325382232666
Epoch: 17, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.861 Vali Acc: 0.480 Test Loss: 0.861 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8485982418060303
Epoch: 18, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 19 cost time: 2.9068963527679443
Epoch: 19, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.862 Vali Acc: 0.540 Test Loss: 0.862 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6432716846466064
Epoch: 20, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.784 Vali Acc: 0.600 Test Loss: 0.784 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599992).  Saving model ...
Epoch: 21 cost time: 2.451911687850952
Epoch: 21, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.295624017715454
Epoch: 22, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.847 Vali Acc: 0.520 Test Loss: 0.847 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.479419708251953
Epoch: 23, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.367072582244873
Epoch: 24, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.044 Vali Acc: 0.560 Test Loss: 1.044 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6719088554382324
Epoch: 25, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.815 Vali Acc: 0.610 Test Loss: 0.815 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609992).  Saving model ...
Epoch: 26 cost time: 2.717174768447876
Epoch: 26, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.786 Vali Acc: 0.610 Test Loss: 0.786 Test Acc: 0.610
Validation loss decreased (-0.609992 --> -0.609992).  Saving model ...
Epoch: 27 cost time: 2.2937448024749756
Epoch: 27, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.837 Vali Acc: 0.550 Test Loss: 0.837 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9787018299102783
Epoch: 28, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.59224796295166
Epoch: 29, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.828 Vali Acc: 0.590 Test Loss: 0.828 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.641677141189575
Epoch: 30, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.096 Vali Acc: 0.630 Test Loss: 1.096 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629989).  Saving model ...
Epoch: 31 cost time: 2.7260162830352783
Epoch: 31, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.878 Vali Acc: 0.600 Test Loss: 0.878 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3043835163116455
Epoch: 32, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0279035568237305
Epoch: 33, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.207 Vali Acc: 0.530 Test Loss: 1.207 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0461039543151855
Epoch: 34, Steps: 20 | Train Loss: 0.684 Vali Loss: 1.126 Vali Acc: 0.630 Test Loss: 1.126 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.340449333190918
Epoch: 35, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.224 Vali Acc: 0.560 Test Loss: 1.224 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.609492540359497
Epoch: 36, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.247 Vali Acc: 0.550 Test Loss: 1.247 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8292410373687744
Epoch: 37, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.358 Vali Acc: 0.540 Test Loss: 1.358 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.461665391921997
Epoch: 38, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.181 Vali Acc: 0.560 Test Loss: 1.181 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6540770530700684
Epoch: 39, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.281 Vali Acc: 0.540 Test Loss: 1.281 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6893446445465088
Epoch: 40, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.452 Vali Acc: 0.600 Test Loss: 1.452 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 22632194
model size : 101.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5865986347198486
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.712 Vali Acc: 0.450 Test Loss: 0.712 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.6045315265655518
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.709 Vali Acc: 0.440 Test Loss: 0.709 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.583742618560791
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 1.454026699066162
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.752 Vali Acc: 0.440 Test Loss: 0.752 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5396363735198975
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7357850074768066
Epoch: 6, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.824 Vali Acc: 0.480 Test Loss: 0.824 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3618943691253662
Epoch: 7, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509993).  Saving model ...
Epoch: 8 cost time: 1.5347540378570557
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.969895839691162
Epoch: 9, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 1.3879334926605225
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.505262851715088
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.670 Vali Acc: 0.570 Test Loss: 0.670 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.6441211700439453
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.677 Vali Acc: 0.610 Test Loss: 0.677 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 13 cost time: 1.4537279605865479
Epoch: 13, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.681 Vali Acc: 0.620 Test Loss: 0.681 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619993).  Saving model ...
Epoch: 14 cost time: 1.5855469703674316
Epoch: 14, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0377449989318848
Epoch: 15, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.458113431930542
Epoch: 16, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3764054775238037
Epoch: 17, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.669 Vali Acc: 0.570 Test Loss: 0.669 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7850990295410156
Epoch: 18, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3025014400482178
Epoch: 19, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9244179725646973
Epoch: 20, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.662 Vali Acc: 0.620 Test Loss: 0.662 Test Acc: 0.620
Validation loss decreased (-0.619993 --> -0.619993).  Saving model ...
Epoch: 21 cost time: 1.9825093746185303
Epoch: 21, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.760 Vali Acc: 0.580 Test Loss: 0.760 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.975588321685791
Epoch: 22, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.931 Vali Acc: 0.510 Test Loss: 0.931 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.428205966949463
Epoch: 23, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.093 Vali Acc: 0.540 Test Loss: 1.093 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8690321445465088
Epoch: 24, Steps: 20 | Train Loss: 0.485 Vali Loss: 1.249 Vali Acc: 0.460 Test Loss: 1.249 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.158264636993408
Epoch: 25, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.032 Vali Acc: 0.560 Test Loss: 1.032 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0533223152160645
Epoch: 26, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.327 Vali Acc: 0.470 Test Loss: 1.327 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.459390163421631
Epoch: 27, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.013 Vali Acc: 0.550 Test Loss: 1.013 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8356759548187256
Epoch: 28, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9582767486572266
Epoch: 29, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.048 Vali Acc: 0.540 Test Loss: 1.048 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6415936946868896
Epoch: 30, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.956 Vali Acc: 0.570 Test Loss: 0.956 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 22598402
model size : 100.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.522512435913086
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.674 Vali Acc: 0.520 Test Loss: 0.674 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.7871816158294678
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.678 Vali Acc: 0.520 Test Loss: 0.678 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2962639331817627
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.683 Vali Acc: 0.510 Test Loss: 0.683 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3760366439819336
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3764336109161377
Epoch: 5, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1941900253295898
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.2252788543701172
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.357217788696289
Epoch: 8, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.670 Vali Acc: 0.570 Test Loss: 0.670 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 1.3254203796386719
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.074218511581421
Epoch: 10, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.689 Vali Acc: 0.540 Test Loss: 0.689 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4020578861236572
Epoch: 11, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.680 Vali Acc: 0.560 Test Loss: 0.680 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4469318389892578
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.345806360244751
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2149248123168945
Epoch: 14, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2317147254943848
Epoch: 15, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.896 Vali Acc: 0.480 Test Loss: 0.896 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1283674240112305
Epoch: 16, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4123289585113525
Epoch: 17, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.830 Vali Acc: 0.590 Test Loss: 0.830 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 18 cost time: 1.2572991847991943
Epoch: 18, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.762 Vali Acc: 0.590 Test Loss: 0.762 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589992).  Saving model ...
Epoch: 19 cost time: 1.2910065650939941
Epoch: 19, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.896 Vali Acc: 0.580 Test Loss: 0.896 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1868534088134766
Epoch: 20, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.852 Vali Acc: 0.550 Test Loss: 0.852 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2936251163482666
Epoch: 21, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3919415473937988
Epoch: 22, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.765 Vali Acc: 0.650 Test Loss: 0.765 Test Acc: 0.650
Validation loss decreased (-0.589992 --> -0.649992).  Saving model ...
Epoch: 23 cost time: 1.1545464992523193
Epoch: 23, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.817 Vali Acc: 0.520 Test Loss: 0.817 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0548698902130127
Epoch: 24, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.933 Vali Acc: 0.610 Test Loss: 0.933 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2175121307373047
Epoch: 25, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.919 Vali Acc: 0.590 Test Loss: 0.919 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0763840675354004
Epoch: 26, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.021 Vali Acc: 0.590 Test Loss: 1.021 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3743069171905518
Epoch: 27, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.904 Vali Acc: 0.640 Test Loss: 0.904 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2362384796142578
Epoch: 28, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.963 Vali Acc: 0.570 Test Loss: 0.963 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.114746332168579
Epoch: 29, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.023 Vali Acc: 0.580 Test Loss: 1.023 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9542994499206543
Epoch: 30, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.114 Vali Acc: 0.610 Test Loss: 1.114 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9898521900177002
Epoch: 31, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.142 Vali Acc: 0.570 Test Loss: 1.142 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9911255836486816
Epoch: 32, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.098 Vali Acc: 0.540 Test Loss: 1.098 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 22586114
model size : 100.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.051671028137207
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.4336745738983154
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.7930469512939453
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.414271593093872
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.869981050491333
Epoch: 5, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.675816774368286
Epoch: 6, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9310224056243896
Epoch: 7, Steps: 20 | Train Loss: 0.685 Vali Loss: 1.319 Vali Acc: 0.470 Test Loss: 1.319 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3644773960113525
Epoch: 8, Steps: 20 | Train Loss: 0.815 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 2.4945757389068604
Epoch: 9, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6589913368225098
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.661856174468994
Epoch: 11, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4680612087249756
Epoch: 12, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.669 Vali Acc: 0.580 Test Loss: 0.669 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 1.8654263019561768
Epoch: 13, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.663 Vali Acc: 0.570 Test Loss: 0.663 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6633896827697754
Epoch: 14, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.362481117248535
Epoch: 15, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.785 Vali Acc: 0.460 Test Loss: 0.785 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1521782875061035
Epoch: 16, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0098276138305664
Epoch: 17, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.882 Vali Acc: 0.560 Test Loss: 0.882 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2718472480773926
Epoch: 18, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.803 Vali Acc: 0.530 Test Loss: 0.803 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4619922637939453
Epoch: 19, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.812 Vali Acc: 0.480 Test Loss: 0.812 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.260812282562256
Epoch: 20, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.037 Vali Acc: 0.480 Test Loss: 1.037 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9816720485687256
Epoch: 21, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5457370281219482
Epoch: 22, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 22696706
model size : 101.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9634978771209717
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.2232117652893066
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.3846299648284912
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4368805885314941
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3067290782928467
Epoch: 5, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.511404037475586
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 1.4402165412902832
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3327200412750244
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7559216022491455
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 1.5362696647644043
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.514014720916748
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7694919109344482
Epoch: 12, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3919789791107178
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.814 Vali Acc: 0.510 Test Loss: 0.814 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2891180515289307
Epoch: 14, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.682 Vali Acc: 0.580 Test Loss: 0.682 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 15 cost time: 1.4606144428253174
Epoch: 15, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.724 Vali Acc: 0.600 Test Loss: 0.724 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 16 cost time: 1.8632607460021973
Epoch: 16, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.613097906112671
Epoch: 17, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.600623607635498
Epoch: 18, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5426349639892578
Epoch: 19, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8858976364135742
Epoch: 20, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8501408100128174
Epoch: 21, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.785 Vali Acc: 0.590 Test Loss: 0.785 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5308830738067627
Epoch: 22, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.857 Vali Acc: 0.520 Test Loss: 0.857 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8393633365631104
Epoch: 23, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.105 Vali Acc: 0.560 Test Loss: 1.105 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3443279266357422
Epoch: 24, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8657290935516357
Epoch: 25, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.053 Vali Acc: 0.530 Test Loss: 1.053 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22662914
model size : 101.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9216532707214355
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.696 Vali Acc: 0.460 Test Loss: 0.696 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.2646565437316895
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.704 Vali Acc: 0.490 Test Loss: 0.704 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.6368343830108643
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6163792610168457
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.6560709476470947
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.713 Vali Acc: 0.450 Test Loss: 0.713 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5168766975402832
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4435858726501465
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.682 Vali Acc: 0.580 Test Loss: 0.682 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 1.6671431064605713
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4941885471343994
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6101274490356445
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6646645069122314
Epoch: 11, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3075032234191895
Epoch: 12, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.401557445526123
Epoch: 13, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5053999423980713
Epoch: 14, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.860562801361084
Epoch: 15, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.755 Vali Acc: 0.610 Test Loss: 0.755 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 16 cost time: 1.645029067993164
Epoch: 16, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.440056324005127
Epoch: 17, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5615973472595215
Epoch: 18, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0443451404571533
Epoch: 19, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1724214553833008
Epoch: 20, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.779 Vali Acc: 0.610 Test Loss: 0.779 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3835644721984863
Epoch: 21, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.358133316040039
Epoch: 22, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.811 Vali Acc: 0.660 Test Loss: 0.811 Test Acc: 0.660
Validation loss decreased (-0.609992 --> -0.659992).  Saving model ...
Epoch: 23 cost time: 1.413867712020874
Epoch: 23, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.849 Vali Acc: 0.510 Test Loss: 0.849 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3279249668121338
Epoch: 24, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.819 Vali Acc: 0.540 Test Loss: 0.819 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4363081455230713
Epoch: 25, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.079 Vali Acc: 0.490 Test Loss: 1.079 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4326159954071045
Epoch: 26, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3116915225982666
Epoch: 27, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.083 Vali Acc: 0.610 Test Loss: 1.083 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1875431537628174
Epoch: 28, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.097 Vali Acc: 0.580 Test Loss: 1.097 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5163185596466064
Epoch: 29, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.207 Vali Acc: 0.510 Test Loss: 1.207 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6644625663757324
Epoch: 30, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.086 Vali Acc: 0.590 Test Loss: 1.086 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2838456630706787
Epoch: 31, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.099 Vali Acc: 0.580 Test Loss: 1.099 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4196431636810303
Epoch: 32, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.204 Vali Acc: 0.550 Test Loss: 1.204 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 22647554
model size : 101.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.576113700866699
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.7675557136535645
Epoch: 2, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.8482403755187988
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.700 Vali Acc: 0.470 Test Loss: 0.700 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7619285583496094
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.704 Vali Acc: 0.470 Test Loss: 0.704 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.74299955368042
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.681 Vali Acc: 0.550 Test Loss: 0.681 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.6016674041748047
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.685 Vali Acc: 0.550 Test Loss: 0.685 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.708897352218628
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.594888687133789
Epoch: 8, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3925700187683105
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4854028224945068
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.132063865661621
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2882320880889893
Epoch: 12, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.685 Vali Acc: 0.510 Test Loss: 0.685 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4030580520629883
Epoch: 13, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5330493450164795
Epoch: 14, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3181285858154297
Epoch: 15, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.692 Vali Acc: 0.600 Test Loss: 0.692 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 16 cost time: 1.4858534336090088
Epoch: 16, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4089949131011963
Epoch: 17, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3928298950195312
Epoch: 18, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.005 Vali Acc: 0.470 Test Loss: 1.005 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7554950714111328
Epoch: 19, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4942424297332764
Epoch: 20, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.870 Vali Acc: 0.580 Test Loss: 0.870 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6955358982086182
Epoch: 21, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.093 Vali Acc: 0.490 Test Loss: 1.093 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.641986608505249
Epoch: 22, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.860 Vali Acc: 0.560 Test Loss: 0.860 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8269016742706299
Epoch: 23, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.867 Vali Acc: 0.560 Test Loss: 0.867 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2394042015075684
Epoch: 24, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2260701656341553
Epoch: 25, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.080 Vali Acc: 0.530 Test Loss: 1.080 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22736642
model size : 101.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6689624786376953
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.452829122543335
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.696 Vali Acc: 0.470 Test Loss: 0.696 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.84751296043396
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.716 Vali Acc: 0.430 Test Loss: 0.716 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.572340726852417
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.686 Vali Acc: 0.530 Test Loss: 0.686 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.36238431930542
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.763611078262329
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.2696411609649658
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2481892108917236
Epoch: 8, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.692 Vali Acc: 0.550 Test Loss: 0.692 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.64365816116333
Epoch: 9, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2541844844818115
Epoch: 10, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7228751182556152
Epoch: 11, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.448643684387207
Epoch: 12, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.679 Vali Acc: 0.630 Test Loss: 0.679 Test Acc: 0.630
Validation loss decreased (-0.549993 --> -0.629993).  Saving model ...
Epoch: 13 cost time: 1.5529396533966064
Epoch: 13, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.788 Vali Acc: 0.560 Test Loss: 0.788 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9802494049072266
Epoch: 14, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5534579753875732
Epoch: 15, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4506797790527344
Epoch: 16, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.093 Vali Acc: 0.520 Test Loss: 1.093 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7127094268798828
Epoch: 17, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.731 Vali Acc: 0.620 Test Loss: 0.731 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6680104732513428
Epoch: 18, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.948 Vali Acc: 0.500 Test Loss: 0.948 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.018425464630127
Epoch: 19, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.864 Vali Acc: 0.520 Test Loss: 0.864 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6892504692077637
Epoch: 20, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9741888046264648
Epoch: 21, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.60793137550354
Epoch: 22, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.093 Vali Acc: 0.510 Test Loss: 1.093 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 22721282
model size : 101.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.777454137802124
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.3873941898345947
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2275457382202148
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4158380031585693
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2414474487304688
Epoch: 5, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.2347593307495117
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3558540344238281
Epoch: 7, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.420795202255249
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4154083728790283
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.491844892501831
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2091920375823975
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.673 Vali Acc: 0.570 Test Loss: 0.673 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.5974698066711426
Epoch: 12, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.684 Vali Acc: 0.610 Test Loss: 0.684 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 13 cost time: 1.3620991706848145
Epoch: 13, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.849 Vali Acc: 0.560 Test Loss: 0.849 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.468714714050293
Epoch: 14, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2007040977478027
Epoch: 15, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1405158042907715
Epoch: 16, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1019492149353027
Epoch: 17, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.256962537765503
Epoch: 18, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2117762565612793
Epoch: 19, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.978 Vali Acc: 0.540 Test Loss: 0.978 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.237001895904541
Epoch: 20, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.760 Vali Acc: 0.620 Test Loss: 0.760 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619992).  Saving model ...
Epoch: 21 cost time: 1.23838472366333
Epoch: 21, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2526931762695312
Epoch: 22, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.914 Vali Acc: 0.570 Test Loss: 0.914 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3120872974395752
Epoch: 23, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.026 Vali Acc: 0.520 Test Loss: 1.026 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6194703578948975
Epoch: 24, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.799 Vali Acc: 0.570 Test Loss: 0.799 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1687002182006836
Epoch: 25, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.878 Vali Acc: 0.550 Test Loss: 0.878 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.201582670211792
Epoch: 26, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.934 Vali Acc: 0.570 Test Loss: 0.934 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1951014995574951
Epoch: 27, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.003 Vali Acc: 0.500 Test Loss: 1.003 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3048815727233887
Epoch: 28, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.866 Vali Acc: 0.580 Test Loss: 0.866 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3769373893737793
Epoch: 29, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0316450595855713
Epoch: 30, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.042 Vali Acc: 0.550 Test Loss: 1.042 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 22708994
model size : 101.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0060181617736816
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.697561264038086
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.123856782913208
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.736 Vali Acc: 0.460 Test Loss: 0.736 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.491300344467163
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7662107944488525
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 2.078439712524414
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9904687404632568
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 2.340804100036621
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 2.210373640060425
Epoch: 9, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9865689277648926
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 2.0429415702819824
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.675 Vali Acc: 0.570 Test Loss: 0.675 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.8611159324645996
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1179943084716797
Epoch: 13, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.684 Vali Acc: 0.520 Test Loss: 0.684 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.147900104522705
Epoch: 14, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.803 Vali Acc: 0.480 Test Loss: 0.803 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9500160217285156
Epoch: 15, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.027 Vali Acc: 0.530 Test Loss: 1.027 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0560858249664307
Epoch: 16, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8925933837890625
Epoch: 17, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.844 Vali Acc: 0.550 Test Loss: 0.844 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6367058753967285
Epoch: 18, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.834 Vali Acc: 0.570 Test Loss: 0.834 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7980897426605225
Epoch: 19, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.792 Vali Acc: 0.570 Test Loss: 0.792 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0359222888946533
Epoch: 20, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.767 Vali Acc: 0.610 Test Loss: 0.767 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 21 cost time: 1.8519253730773926
Epoch: 21, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.516082525253296
Epoch: 22, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.582056999206543
Epoch: 23, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6002275943756104
Epoch: 24, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.058 Vali Acc: 0.570 Test Loss: 1.058 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6741905212402344
Epoch: 25, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.879 Vali Acc: 0.570 Test Loss: 0.879 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6313540935516357
Epoch: 26, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.790 Vali Acc: 0.570 Test Loss: 0.790 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4736607074737549
Epoch: 27, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.008 Vali Acc: 0.520 Test Loss: 1.008 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4596648216247559
Epoch: 28, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.010 Vali Acc: 0.610 Test Loss: 1.010 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.544785976409912
Epoch: 29, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.248 Vali Acc: 0.540 Test Loss: 1.248 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.529634952545166
Epoch: 30, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.060 Vali Acc: 0.640 Test Loss: 1.060 Test Acc: 0.640
Validation loss decreased (-0.609992 --> -0.639989).  Saving model ...
Epoch: 31 cost time: 1.3862440586090088
Epoch: 31, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.088 Vali Acc: 0.510 Test Loss: 1.088 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3743934631347656
Epoch: 32, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.043 Vali Acc: 0.560 Test Loss: 1.043 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5006980895996094
Epoch: 33, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.306 Vali Acc: 0.540 Test Loss: 1.306 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3997220993041992
Epoch: 34, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.220 Vali Acc: 0.540 Test Loss: 1.220 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5276997089385986
Epoch: 35, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2404401302337646
Epoch: 36, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.786 Vali Acc: 0.520 Test Loss: 1.786 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4313948154449463
Epoch: 37, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.210 Vali Acc: 0.560 Test Loss: 1.210 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4462218284606934
Epoch: 38, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.121 Vali Acc: 0.590 Test Loss: 1.121 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5696957111358643
Epoch: 39, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.371 Vali Acc: 0.550 Test Loss: 1.371 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5215785503387451
Epoch: 40, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.894 Vali Acc: 0.550 Test Loss: 1.894 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 22801154
model size : 101.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.478928565979004
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.700 Vali Acc: 0.460 Test Loss: 0.700 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.9820938110351562
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.467771053314209
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.3393118381500244
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.2829627990722656
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6557412147521973
Epoch: 6, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 1.5418899059295654
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.399064540863037
Epoch: 8, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.94230318069458
Epoch: 9, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7722773551940918
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.480222463607788
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6695992946624756
Epoch: 12, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1921393871307373
Epoch: 13, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.747 Vali Acc: 0.580 Test Loss: 0.747 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 1.7804725170135498
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.643326759338379
Epoch: 15, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7071151733398438
Epoch: 16, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.864 Vali Acc: 0.510 Test Loss: 0.864 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7045047283172607
Epoch: 17, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5015528202056885
Epoch: 18, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.706 Vali Acc: 0.570 Test Loss: 0.706 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6679236888885498
Epoch: 19, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.696 Vali Acc: 0.600 Test Loss: 0.696 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 20 cost time: 1.3570046424865723
Epoch: 20, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.839 Vali Acc: 0.580 Test Loss: 0.839 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5187642574310303
Epoch: 21, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.941 Vali Acc: 0.560 Test Loss: 0.941 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6924352645874023
Epoch: 22, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.974 Vali Acc: 0.540 Test Loss: 0.974 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6468141078948975
Epoch: 23, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.862 Vali Acc: 0.570 Test Loss: 0.862 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6218454837799072
Epoch: 24, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.952 Vali Acc: 0.580 Test Loss: 0.952 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3923900127410889
Epoch: 25, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.092 Vali Acc: 0.590 Test Loss: 1.092 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3187077045440674
Epoch: 26, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.952 Vali Acc: 0.550 Test Loss: 0.952 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5715916156768799
Epoch: 27, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.903 Vali Acc: 0.610 Test Loss: 0.903 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609991).  Saving model ...
Epoch: 28 cost time: 1.8199357986450195
Epoch: 28, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.902 Vali Acc: 0.570 Test Loss: 0.902 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8458526134490967
Epoch: 29, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.959 Vali Acc: 0.540 Test Loss: 0.959 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.580620527267456
Epoch: 30, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.015 Vali Acc: 0.590 Test Loss: 1.015 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2903950214385986
Epoch: 31, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.293 Vali Acc: 0.600 Test Loss: 1.293 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7202708721160889
Epoch: 32, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.210 Vali Acc: 0.530 Test Loss: 1.210 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.611940860748291
Epoch: 33, Steps: 20 | Train Loss: 0.324 Vali Loss: 1.163 Vali Acc: 0.530 Test Loss: 1.163 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6636972427368164
Epoch: 34, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.019 Vali Acc: 0.540 Test Loss: 1.019 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6664416790008545
Epoch: 35, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.128 Vali Acc: 0.590 Test Loss: 1.128 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.691072940826416
Epoch: 36, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.273 Vali Acc: 0.570 Test Loss: 1.273 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4506196975708008
Epoch: 37, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.237 Vali Acc: 0.610 Test Loss: 1.237 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22785794
model size : 101.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4730637073516846
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.3642680644989014
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.2866826057434082
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5321297645568848
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.395641565322876
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2498414516448975
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5605430603027344
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4617600440979004
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.5068731307983398
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.687143325805664
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4258592128753662
Epoch: 11, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7554798126220703
Epoch: 12, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.692 Vali Acc: 0.570 Test Loss: 0.692 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 1.5950915813446045
Epoch: 13, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3501310348510742
Epoch: 14, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3936121463775635
Epoch: 15, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2759218215942383
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4955780506134033
Epoch: 17, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.809 Vali Acc: 0.600 Test Loss: 0.809 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 18 cost time: 1.492096185684204
Epoch: 18, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2872319221496582
Epoch: 19, Steps: 20 | Train Loss: 0.553 Vali Loss: 1.135 Vali Acc: 0.460 Test Loss: 1.135 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0710563659667969
Epoch: 20, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3979129791259766
Epoch: 21, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4556705951690674
Epoch: 22, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.862 Vali Acc: 0.520 Test Loss: 0.862 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.348522424697876
Epoch: 23, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1699066162109375
Epoch: 24, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.976 Vali Acc: 0.550 Test Loss: 0.976 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5626628398895264
Epoch: 25, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.896 Vali Acc: 0.540 Test Loss: 0.896 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7159035205841064
Epoch: 26, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.985 Vali Acc: 0.530 Test Loss: 0.985 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2914392948150635
Epoch: 27, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.967 Vali Acc: 0.580 Test Loss: 0.967 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_GPT4TS_UEA_ftM_sl50_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22773506
model size : 101.54MB
