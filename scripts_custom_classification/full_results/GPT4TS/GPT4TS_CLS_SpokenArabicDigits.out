Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0185169
	speed: 0.1118s/iter; left time: 2298.4235s
	iters: 200, epoch: 1 | loss: 0.4067464
	speed: 0.2088s/iter; left time: 4269.7677s
	iters: 300, epoch: 1 | loss: 0.0060721
	speed: 0.2288s/iter; left time: 4655.3597s
	iters: 400, epoch: 1 | loss: 0.6456708
	speed: 0.2319s/iter; left time: 4695.5579s
Epoch: 1 cost time: 81.20259356498718
Epoch: 1, Steps: 413 | Train Loss: 0.586 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (inf --> -0.949975).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0017469
	speed: 0.5546s/iter; left time: 11169.4619s
	iters: 200, epoch: 2 | loss: 0.2723290
	speed: 0.1612s/iter; left time: 3229.2592s
	iters: 300, epoch: 2 | loss: 0.0000020
	speed: 0.1751s/iter; left time: 3490.5179s
	iters: 400, epoch: 2 | loss: 0.0158560
	speed: 0.1815s/iter; left time: 3600.8432s
Epoch: 2 cost time: 74.21117162704468
Epoch: 2, Steps: 413 | Train Loss: 0.216 Vali Loss: 0.306 Vali Acc: 0.965 Test Loss: 0.306 Test Acc: 0.965
Validation loss decreased (-0.949975 --> -0.964981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000022
	speed: 0.4373s/iter; left time: 8625.4921s
	iters: 200, epoch: 3 | loss: 0.0586770
	speed: 0.1325s/iter; left time: 2600.7278s
	iters: 300, epoch: 3 | loss: 0.0247423
	speed: 0.1203s/iter; left time: 2348.2277s
	iters: 400, epoch: 3 | loss: 0.0494485
	speed: 0.1397s/iter; left time: 2713.8053s
Epoch: 3 cost time: 57.71663737297058
Epoch: 3, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.253 Vali Acc: 0.976 Test Loss: 0.253 Test Acc: 0.976
Validation loss decreased (-0.964981 --> -0.975896).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5002905
	speed: 0.3893s/iter; left time: 7518.3916s
	iters: 200, epoch: 4 | loss: 0.0011264
	speed: 0.1343s/iter; left time: 2580.0729s
	iters: 300, epoch: 4 | loss: 0.0001458
	speed: 0.0905s/iter; left time: 1730.0818s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 1796.0594s
Epoch: 4 cost time: 49.74121022224426
Epoch: 4, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.3461s/iter; left time: 6541.5800s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.1615s/iter; left time: 3035.1554s
	iters: 300, epoch: 5 | loss: 0.2546752
	speed: 0.1687s/iter; left time: 3154.4800s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.1228s/iter; left time: 2284.3845s
Epoch: 5 cost time: 62.038370847702026
Epoch: 5, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.212 Vali Acc: 0.983 Test Loss: 0.212 Test Acc: 0.983
Validation loss decreased (-0.975896 --> -0.983172).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 1.1799s/iter; left time: 21812.4020s
	iters: 200, epoch: 6 | loss: 0.0006024
	speed: 0.1678s/iter; left time: 3085.8271s
	iters: 300, epoch: 6 | loss: 1.9164813
	speed: 0.1452s/iter; left time: 2655.7594s
	iters: 400, epoch: 6 | loss: 0.0835512
	speed: 0.1541s/iter; left time: 2802.0027s
Epoch: 6 cost time: 65.868816614151
Epoch: 6, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.249 Vali Acc: 0.981 Test Loss: 0.249 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3364s/iter; left time: 6079.2258s
	iters: 200, epoch: 7 | loss: 0.0000010
	speed: 0.1709s/iter; left time: 3071.9397s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1796s/iter; left time: 3210.8600s
	iters: 400, epoch: 7 | loss: 0.0000003
	speed: 0.1963s/iter; left time: 3488.9653s
Epoch: 7 cost time: 73.6020917892456
Epoch: 7, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.473 Vali Acc: 0.980 Test Loss: 0.473 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3905s/iter; left time: 6895.3791s
	iters: 200, epoch: 8 | loss: 0.3685699
	speed: 0.1839s/iter; left time: 3229.4807s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 1716.4073s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1679s/iter; left time: 2914.7589s
Epoch: 8 cost time: 62.516867876052856
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.327 Vali Acc: 0.980 Test Loss: 0.327 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.4375s/iter; left time: 7545.9218s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1718s/iter; left time: 2946.4872s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1732s/iter; left time: 2951.7477s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1807s/iter; left time: 3061.9465s
Epoch: 9 cost time: 73.1904730796814
Epoch: 9, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.269 Vali Acc: 0.985 Test Loss: 0.269 Test Acc: 0.985
Validation loss decreased (-0.983172 --> -0.985445).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0015726
	speed: 0.3901s/iter; left time: 6567.6863s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1191s/iter; left time: 1993.4361s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 1796.0607s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1119s/iter; left time: 1850.4135s
Epoch: 10 cost time: 48.16270661354065
Epoch: 10, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.550 Vali Acc: 0.977 Test Loss: 0.550 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3129s/iter; left time: 5138.7824s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.1307s/iter; left time: 2132.6455s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1295s/iter; left time: 2101.2813s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 1293.6770s
Epoch: 11 cost time: 48.62185287475586
Epoch: 11, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.101 Vali Acc: 0.994 Test Loss: 0.101 Test Acc: 0.994
Validation loss decreased (-0.985445 --> -0.993632).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000514
	speed: 0.3110s/iter; left time: 4978.7406s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1445s/iter; left time: 2298.8607s
	iters: 300, epoch: 12 | loss: 0.0178285
	speed: 0.1562s/iter; left time: 2468.6759s
	iters: 400, epoch: 12 | loss: 0.1087105
	speed: 0.1645s/iter; left time: 2584.0603s
Epoch: 12 cost time: 63.85016703605652
Epoch: 12, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.487 Vali Acc: 0.979 Test Loss: 0.487 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4555s/iter; left time: 7103.7974s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2154s/iter; left time: 3337.6632s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2433s/iter; left time: 3745.3265s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2229s/iter; left time: 3408.7688s
Epoch: 13 cost time: 91.10577607154846
Epoch: 13, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.373 Vali Acc: 0.980 Test Loss: 0.373 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.4553s/iter; left time: 6912.6364s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1857s/iter; left time: 2800.9688s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2037s/iter; left time: 3051.6674s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1326s/iter; left time: 1972.6292s
Epoch: 14 cost time: 70.42323851585388
Epoch: 14, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.248 Vali Acc: 0.990 Test Loss: 0.248 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2853s/iter; left time: 4214.0468s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1344s/iter; left time: 1971.2976s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1233s/iter; left time: 1796.1761s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1366s/iter; left time: 1976.3457s
Epoch: 15 cost time: 53.77935862541199
Epoch: 15, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.565 Vali Acc: 0.981 Test Loss: 0.565 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.3296s/iter; left time: 4731.0530s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1065s/iter; left time: 1518.2662s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1044s/iter; left time: 1478.1980s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1103s/iter; left time: 1549.9217s
Epoch: 16 cost time: 43.60165047645569
Epoch: 16, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.996 Vali Acc: 0.973 Test Loss: 0.996 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2834s/iter; left time: 3951.8153s
	iters: 200, epoch: 17 | loss: 0.0212422
	speed: 0.1187s/iter; left time: 1642.7549s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1183s/iter; left time: 1626.1467s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 1180.4160s
Epoch: 17 cost time: 45.44696760177612
Epoch: 17, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.611 Vali Acc: 0.983 Test Loss: 0.611 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2861s/iter; left time: 3870.8735s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1603s/iter; left time: 2152.4889s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1104s/iter; left time: 1471.1252s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1471s/iter; left time: 1946.3602s
Epoch: 18 cost time: 56.389304399490356
Epoch: 18, Steps: 413 | Train Loss: 0.095 Vali Loss: 1.050 Vali Acc: 0.969 Test Loss: 1.050 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3287s/iter; left time: 4311.6215s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1902s/iter; left time: 2475.7107s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1694s/iter; left time: 2188.3027s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1304s/iter; left time: 1671.8033s
Epoch: 19 cost time: 66.15173625946045
Epoch: 19, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.700 Vali Acc: 0.982 Test Loss: 0.700 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.4238s/iter; left time: 5384.1077s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1969s/iter; left time: 2482.1523s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1515s/iter; left time: 1894.0508s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1522s/iter; left time: 1887.6857s
Epoch: 20 cost time: 69.71550559997559
Epoch: 20, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.566 Vali Acc: 0.984 Test Loss: 0.566 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.3816s/iter; left time: 4690.6331s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 1068.9694s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1267s/iter; left time: 1532.5227s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1281s/iter; left time: 1535.7500s
Epoch: 21 cost time: 48.32663416862488
Epoch: 21, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.212 Vali Acc: 0.991 Test Loss: 0.212 Test Acc: 0.991
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9936334697589814
model parameter : 44332042
model size : 183.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6568234
	speed: 0.0600s/iter; left time: 1233.4430s
	iters: 200, epoch: 1 | loss: 0.5035284
	speed: 0.0495s/iter; left time: 1011.9959s
	iters: 300, epoch: 1 | loss: 0.0528467
	speed: 0.0725s/iter; left time: 1475.3020s
	iters: 400, epoch: 1 | loss: 0.0163120
	speed: 0.0952s/iter; left time: 1926.9644s
Epoch: 1 cost time: 29.07242703437805
Epoch: 1, Steps: 413 | Train Loss: 0.537 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2517172
	speed: 0.2598s/iter; left time: 5231.2908s
	iters: 200, epoch: 2 | loss: 0.0509768
	speed: 0.1098s/iter; left time: 2199.6454s
	iters: 300, epoch: 2 | loss: 0.0553125
	speed: 0.1132s/iter; left time: 2257.4676s
	iters: 400, epoch: 2 | loss: 0.0363868
	speed: 0.0867s/iter; left time: 1719.1327s
Epoch: 2 cost time: 41.63753962516785
Epoch: 2, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001819
	speed: 0.2061s/iter; left time: 4066.2638s
	iters: 200, epoch: 3 | loss: 0.0000192
	speed: 0.0876s/iter; left time: 1719.9418s
	iters: 300, epoch: 3 | loss: 0.1549981
	speed: 0.1145s/iter; left time: 2235.7247s
	iters: 400, epoch: 3 | loss: 0.0000431
	speed: 0.0850s/iter; left time: 1652.0012s
Epoch: 3 cost time: 36.829021692276
Epoch: 3, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.969076 --> -0.982264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000013
	speed: 0.2980s/iter; left time: 5755.7192s
	iters: 200, epoch: 4 | loss: 0.0000012
	speed: 0.0885s/iter; left time: 1699.6199s
	iters: 300, epoch: 4 | loss: 0.0001726
	speed: 0.0452s/iter; left time: 863.6609s
	iters: 400, epoch: 4 | loss: 0.0111574
	speed: 0.0985s/iter; left time: 1871.7602s
Epoch: 4 cost time: 33.96380543708801
Epoch: 4, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.235 Vali Acc: 0.973 Test Loss: 0.235 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000006
	speed: 0.2803s/iter; left time: 5298.2024s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.1144s/iter; left time: 2149.9247s
	iters: 300, epoch: 5 | loss: 0.0041462
	speed: 0.1137s/iter; left time: 2126.0817s
	iters: 400, epoch: 5 | loss: 0.0049031
	speed: 0.0594s/iter; left time: 1104.2152s
Epoch: 5 cost time: 40.49320697784424
Epoch: 5, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
Validation loss decreased (-0.982264 --> -0.984537).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0516296
	speed: 0.1900s/iter; left time: 3511.4691s
	iters: 200, epoch: 6 | loss: 0.0000009
	speed: 0.0427s/iter; left time: 784.4624s
	iters: 300, epoch: 6 | loss: 0.0000246
	speed: 0.0825s/iter; left time: 1508.3889s
	iters: 400, epoch: 6 | loss: 0.0000005
	speed: 0.0875s/iter; left time: 1591.2055s
Epoch: 6 cost time: 30.418840646743774
Epoch: 6, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.2198s/iter; left time: 3972.0099s
	iters: 200, epoch: 7 | loss: 0.6340182
	speed: 0.0738s/iter; left time: 1326.6029s
	iters: 300, epoch: 7 | loss: 0.0000058
	speed: 0.1091s/iter; left time: 1950.0112s
	iters: 400, epoch: 7 | loss: 0.0001434
	speed: 0.1267s/iter; left time: 2251.9824s
Epoch: 7 cost time: 42.4146294593811
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3414074
	speed: 0.2906s/iter; left time: 5131.6477s
	iters: 200, epoch: 8 | loss: 0.0185844
	speed: 0.0639s/iter; left time: 1121.5896s
	iters: 300, epoch: 8 | loss: 0.4923848
	speed: 0.0645s/iter; left time: 1125.6025s
	iters: 400, epoch: 8 | loss: 0.0000050
	speed: 0.0787s/iter; left time: 1366.2975s
Epoch: 8 cost time: 33.3263475894928
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.979 Test Loss: 0.138 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1599s/iter; left time: 2757.8270s
	iters: 200, epoch: 9 | loss: 0.0009451
	speed: 0.0718s/iter; left time: 1230.4841s
	iters: 300, epoch: 9 | loss: 0.5725830
	speed: 0.0621s/iter; left time: 1059.2134s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 1420.5419s
Epoch: 9 cost time: 28.70434832572937
Epoch: 9, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.1874s/iter; left time: 3154.8663s
	iters: 200, epoch: 10 | loss: 0.1275419
	speed: 0.0759s/iter; left time: 1270.3814s
	iters: 300, epoch: 10 | loss: 0.8046409
	speed: 0.0756s/iter; left time: 1258.2472s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0840s/iter; left time: 1389.5810s
Epoch: 10 cost time: 30.992784023284912
Epoch: 10, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.284 Vali Acc: 0.980 Test Loss: 0.284 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1759s/iter; left time: 2887.9503s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 1069.1062s
	iters: 300, epoch: 11 | loss: 0.0000669
	speed: 0.0629s/iter; left time: 1020.3519s
	iters: 400, epoch: 11 | loss: 0.0000065
	speed: 0.0700s/iter; left time: 1128.7465s
Epoch: 11 cost time: 27.558133363723755
Epoch: 11, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.337 Vali Acc: 0.970 Test Loss: 0.337 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1862s/iter; left time: 2981.2556s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 1149.9954s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 1516.7049s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 1565.9823s
Epoch: 12 cost time: 34.76382303237915
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.984 Test Loss: 0.191 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1868s/iter; left time: 2913.5710s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1190s/iter; left time: 1844.5531s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.1145s/iter; left time: 1762.8670s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1193s/iter; left time: 1825.1040s
Epoch: 13 cost time: 45.276833295822144
Epoch: 13, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.266 Vali Acc: 0.981 Test Loss: 0.266 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2208s/iter; left time: 3352.1895s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 875.8374s
	iters: 300, epoch: 14 | loss: 1.1545426
	speed: 0.0597s/iter; left time: 893.9777s
	iters: 400, epoch: 14 | loss: 0.1771766
	speed: 0.0792s/iter; left time: 1179.1821s
Epoch: 14 cost time: 28.058120727539062
Epoch: 14, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.187 Vali Acc: 0.986 Test Loss: 0.187 Test Acc: 0.986
Validation loss decreased (-0.984537 --> -0.985901).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001022
	speed: 0.2320s/iter; left time: 3426.1094s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 1062.1374s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1081s/iter; left time: 1575.2451s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0869s/iter; left time: 1256.7814s
Epoch: 15 cost time: 35.048495292663574
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.308 Vali Acc: 0.980 Test Loss: 0.308 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2190s/iter; left time: 3143.9529s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 1022.0885s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0757s/iter; left time: 1071.7321s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 1067.2461s
Epoch: 16 cost time: 32.323498487472534
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.990 Test Loss: 0.163 Test Acc: 0.990
Validation loss decreased (-0.985901 --> -0.990449).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2105s/iter; left time: 2935.0039s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 1104.5122s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 891.2748s
	iters: 400, epoch: 17 | loss: 0.0000291
	speed: 0.0522s/iter; left time: 711.9806s
Epoch: 17 cost time: 28.740598678588867
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.983 Test Loss: 0.207 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2078s/iter; left time: 2812.0846s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 1147.7544s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 1214.4932s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 1256.2023s
Epoch: 18 cost time: 37.65575313568115
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.296 Vali Acc: 0.981 Test Loss: 0.296 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2112s/iter; left time: 2770.2198s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 622.9559s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 591.2651s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 575.0517s
Epoch: 19 cost time: 21.832882165908813
Epoch: 19, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.119 Vali Acc: 0.988 Test Loss: 0.119 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0016166
	speed: 0.1587s/iter; left time: 2015.9622s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 973.4178s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 1024.1755s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 1156.8955s
Epoch: 20 cost time: 34.25407385826111
Epoch: 20, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.489 Vali Acc: 0.971 Test Loss: 0.489 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2549s/iter; left time: 3132.4737s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1062s/iter; left time: 1294.7900s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1017s/iter; left time: 1230.0678s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 996.2159s
Epoch: 21 cost time: 38.948384523391724
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.991 Test Loss: 0.120 Test Acc: 0.991
Validation loss decreased (-0.990449 --> -0.991359).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1817s/iter; left time: 2158.4101s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 553.8433s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 665.2443s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 956.7157s
Epoch: 22 cost time: 25.33921241760254
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.355 Vali Acc: 0.983 Test Loss: 0.355 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 2114.3398s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 460.4210s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 458.6694s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 537.2582s
Epoch: 23 cost time: 21.170068502426147
Epoch: 23, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.331 Vali Acc: 0.984 Test Loss: 0.331 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2237s/iter; left time: 2472.2898s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0938s/iter; left time: 1027.2665s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0970s/iter; left time: 1052.8063s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0715s/iter; left time: 768.4127s
Epoch: 24 cost time: 35.45043706893921
Epoch: 24, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.276 Vali Acc: 0.981 Test Loss: 0.276 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1778s/iter; left time: 1891.7671s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 772.8830s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 890.0957s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 994.3226s
Epoch: 25 cost time: 34.36749887466431
Epoch: 25, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.405 Vali Acc: 0.982 Test Loss: 0.405 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2440s/iter; left time: 2495.3710s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 877.7822s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 774.8666s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 484.1296s
Epoch: 26 cost time: 29.863309860229492
Epoch: 26, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.275 Vali Acc: 0.986 Test Loss: 0.275 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1751s/iter; left time: 1718.5633s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 981.2385s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 896.9143s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0956s/iter; left time: 909.2451s
Epoch: 27 cost time: 38.81083273887634
Epoch: 27, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.255 Vali Acc: 0.989 Test Loss: 0.255 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3192s/iter; left time: 3000.8763s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0671s/iter; left time: 624.0158s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 484.2076s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 460.8248s
Epoch: 28 cost time: 29.25135850906372
Epoch: 28, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.227 Vali Acc: 0.989 Test Loss: 0.227 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2868s/iter; left time: 2577.6028s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 854.5897s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 658.6399s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1161s/iter; left time: 1008.4341s
Epoch: 29 cost time: 42.34132218360901
Epoch: 29, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.994 Test Loss: 0.111 Test Acc: 0.994
Validation loss decreased (-0.991359 --> -0.993632).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000036
	speed: 0.2860s/iter; left time: 2452.4377s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1233s/iter; left time: 1044.4764s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.1022s/iter; left time: 855.4595s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.1116s/iter; left time: 923.5321s
Epoch: 30 cost time: 45.866544008255005
Epoch: 30, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.307 Vali Acc: 0.988 Test Loss: 0.307 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2699s/iter; left time: 2202.9555s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 651.0083s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.1029s/iter; left time: 819.3568s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 918.2026s
Epoch: 31 cost time: 41.8148410320282
Epoch: 31, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.436 Vali Acc: 0.983 Test Loss: 0.436 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.3363s/iter; left time: 2605.3925s
	iters: 200, epoch: 32 | loss: 0.0000306
	speed: 0.0836s/iter; left time: 639.6461s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 569.3473s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.1068s/iter; left time: 795.6353s
Epoch: 32 cost time: 41.036487340927124
Epoch: 32, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.373 Vali Acc: 0.983 Test Loss: 0.373 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2926s/iter; left time: 2146.4442s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 707.3464s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 743.7338s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 398.4166s
Epoch: 33 cost time: 37.813640832901
Epoch: 33, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.396 Vali Acc: 0.984 Test Loss: 0.396 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1873s/iter; left time: 1296.1744s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.1015s/iter; left time: 692.3751s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0845s/iter; left time: 568.1086s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.1056s/iter; left time: 699.4079s
Epoch: 34 cost time: 38.46659517288208
Epoch: 34, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.359 Vali Acc: 0.987 Test Loss: 0.359 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2976s/iter; left time: 1937.2429s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 510.7039s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 254.7912s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 462.2690s
Epoch: 35 cost time: 34.16249966621399
Epoch: 35, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.989 Test Loss: 0.266 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2480s/iter; left time: 1511.5477s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.1153s/iter; left time: 691.5369s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.1143s/iter; left time: 673.7320s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.1153s/iter; left time: 668.0607s
Epoch: 36 cost time: 47.20982837677002
Epoch: 36, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.990 Test Loss: 0.212 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1978s/iter; left time: 1124.1530s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 436.0521s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 464.4684s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 472.3119s
Epoch: 37 cost time: 35.53003931045532
Epoch: 37, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.988 Test Loss: 0.270 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1794s/iter; left time: 945.6633s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 508.2879s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0982s/iter; left time: 497.8560s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 434.4899s
Epoch: 38 cost time: 35.659064531326294
Epoch: 38, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.350 Vali Acc: 0.987 Test Loss: 0.350 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2105s/iter; left time: 1022.5560s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 453.9738s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 357.7873s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 308.9743s
Epoch: 39 cost time: 33.47362399101257
Epoch: 39, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.338 Vali Acc: 0.989 Test Loss: 0.338 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9936334697589814
model parameter : 43917322
model size : 182.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4140408
	speed: 0.0704s/iter; left time: 1446.6453s
	iters: 200, epoch: 1 | loss: 0.0887010
	speed: 0.0456s/iter; left time: 932.6940s
	iters: 300, epoch: 1 | loss: 1.0817238
	speed: 0.0440s/iter; left time: 895.0797s
	iters: 400, epoch: 1 | loss: 0.2456197
	speed: 0.0561s/iter; left time: 1135.1891s
Epoch: 1 cost time: 22.27381730079651
Epoch: 1, Steps: 413 | Train Loss: 0.526 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0207872
	speed: 0.1311s/iter; left time: 2639.8199s
	iters: 200, epoch: 2 | loss: 0.0297510
	speed: 0.0333s/iter; left time: 667.9841s
	iters: 300, epoch: 2 | loss: 0.1082925
	speed: 0.0302s/iter; left time: 602.1342s
	iters: 400, epoch: 2 | loss: 0.0001343
	speed: 0.0342s/iter; left time: 678.6256s
Epoch: 2 cost time: 15.531955480575562
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7253267
	speed: 0.0991s/iter; left time: 1955.6879s
	iters: 200, epoch: 3 | loss: 0.0979899
	speed: 0.0494s/iter; left time: 969.0787s
	iters: 300, epoch: 3 | loss: 0.0052733
	speed: 0.0712s/iter; left time: 1390.3618s
	iters: 400, epoch: 3 | loss: 0.0000255
	speed: 0.0691s/iter; left time: 1342.6262s
Epoch: 3 cost time: 24.959843397140503
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.975897 --> -0.977261).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0743735
	speed: 0.2578s/iter; left time: 4979.2931s
	iters: 200, epoch: 4 | loss: 0.0005044
	speed: 0.0816s/iter; left time: 1568.6366s
	iters: 300, epoch: 4 | loss: 0.0000583
	speed: 0.0796s/iter; left time: 1522.2371s
	iters: 400, epoch: 4 | loss: 0.4771509
	speed: 0.0837s/iter; left time: 1591.2372s
Epoch: 4 cost time: 33.9949266910553
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1947783
	speed: 0.1851s/iter; left time: 3499.0894s
	iters: 200, epoch: 5 | loss: 0.0000758
	speed: 0.0364s/iter; left time: 683.9705s
	iters: 300, epoch: 5 | loss: 0.5474154
	speed: 0.0255s/iter; left time: 477.1798s
	iters: 400, epoch: 5 | loss: 0.0012227
	speed: 0.0261s/iter; left time: 485.6874s
Epoch: 5 cost time: 15.70154857635498
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.968 Test Loss: 0.255 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1268s/iter; left time: 2344.1694s
	iters: 200, epoch: 6 | loss: 0.0335826
	speed: 0.0563s/iter; left time: 1034.2505s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 1144.1527s
	iters: 400, epoch: 6 | loss: 0.0026517
	speed: 0.0518s/iter; left time: 942.4147s
Epoch: 6 cost time: 23.39684796333313
Epoch: 6, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
Validation loss decreased (-0.977261 --> -0.979989).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000412
	speed: 0.3333s/iter; left time: 6024.0889s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 687.2907s
	iters: 300, epoch: 7 | loss: 0.0029806
	speed: 0.0308s/iter; left time: 550.7290s
	iters: 400, epoch: 7 | loss: 0.0412962
	speed: 0.0354s/iter; left time: 628.3159s
Epoch: 7 cost time: 14.753665208816528
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.970 Test Loss: 0.229 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000059
	speed: 0.1880s/iter; left time: 3319.2462s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.0720s/iter; left time: 1263.7003s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 1234.2710s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 827.4079s
Epoch: 8 cost time: 27.009645462036133
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
Validation loss decreased (-0.979989 --> -0.982718).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5938460
	speed: 0.2322s/iter; left time: 4004.2371s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0595s/iter; left time: 1020.7263s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0534s/iter; left time: 910.8445s
	iters: 400, epoch: 9 | loss: 0.0000382
	speed: 0.0393s/iter; left time: 665.4105s
Epoch: 9 cost time: 24.163649082183838
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.363 Vali Acc: 0.969 Test Loss: 0.363 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 1591.3234s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 460.2532s
	iters: 300, epoch: 10 | loss: 0.0000156
	speed: 0.0337s/iter; left time: 560.7075s
	iters: 400, epoch: 10 | loss: 0.0000017
	speed: 0.0362s/iter; left time: 598.6912s
Epoch: 10 cost time: 13.200626850128174
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.980 Test Loss: 0.235 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0022853
	speed: 0.0918s/iter; left time: 1507.4840s
	iters: 200, epoch: 11 | loss: 0.3758358
	speed: 0.0264s/iter; left time: 430.8376s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 600.2252s
	iters: 400, epoch: 11 | loss: 0.0012416
	speed: 0.0399s/iter; left time: 643.2347s
Epoch: 11 cost time: 14.031359910964966
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.231 Vali Acc: 0.982 Test Loss: 0.231 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000145
	speed: 0.1283s/iter; left time: 2053.0662s
	iters: 200, epoch: 12 | loss: 0.0000715
	speed: 0.0541s/iter; left time: 861.0558s
	iters: 300, epoch: 12 | loss: 0.0001308
	speed: 0.0543s/iter; left time: 857.7655s
	iters: 400, epoch: 12 | loss: 0.0176507
	speed: 0.0507s/iter; left time: 796.7217s
Epoch: 12 cost time: 22.465761423110962
Epoch: 12, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.984 Test Loss: 0.158 Test Acc: 0.984
Validation loss decreased (-0.982718 --> -0.983627).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2045s/iter; left time: 3189.5575s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 1544.8299s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 1314.5891s
	iters: 400, epoch: 13 | loss: 0.0004813
	speed: 0.0669s/iter; left time: 1022.9833s
Epoch: 13 cost time: 33.472291707992554
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.264 Vali Acc: 0.981 Test Loss: 0.264 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1650s/iter; left time: 2504.6837s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 689.4426s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 794.7556s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 610.1755s
Epoch: 14 cost time: 20.38030982017517
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.984 Test Loss: 0.227 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1255s/iter; left time: 1852.7858s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 731.0677s
	iters: 300, epoch: 15 | loss: 0.0662836
	speed: 0.0561s/iter; left time: 816.5963s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 1224.4644s
Epoch: 15 cost time: 24.916674613952637
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.990 Test Loss: 0.089 Test Acc: 0.990
Validation loss decreased (-0.983627 --> -0.989995).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2146s/iter; left time: 3081.3954s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 681.2808s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 969.4117s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1046s/iter; left time: 1470.7196s
Epoch: 16 cost time: 29.573437690734863
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.411 Vali Acc: 0.979 Test Loss: 0.411 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2404s/iter; left time: 3351.8633s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1035s/iter; left time: 1432.3835s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 819.3694s
	iters: 400, epoch: 17 | loss: 0.0000134
	speed: 0.0381s/iter; left time: 520.2072s
Epoch: 17 cost time: 31.504581212997437
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.289 Vali Acc: 0.979 Test Loss: 0.289 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1835517
	speed: 0.1672s/iter; left time: 2261.9059s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 658.0194s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 737.5571s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0522s/iter; left time: 690.3564s
Epoch: 18 cost time: 22.362099647521973
Epoch: 18, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.331 Vali Acc: 0.980 Test Loss: 0.331 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1932s/iter; left time: 2534.7785s
	iters: 200, epoch: 19 | loss: 0.8071405
	speed: 0.0661s/iter; left time: 860.1767s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 898.4616s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0590s/iter; left time: 755.8313s
Epoch: 19 cost time: 26.888837814331055
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.458 Vali Acc: 0.981 Test Loss: 0.458 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000011
	speed: 0.1833s/iter; left time: 2328.3220s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 560.8292s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 696.7281s
	iters: 400, epoch: 20 | loss: 0.1960682
	speed: 0.0685s/iter; left time: 849.3311s
Epoch: 20 cost time: 24.07350730895996
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.448 Vali Acc: 0.981 Test Loss: 0.448 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1924s/iter; left time: 2364.6581s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 1109.0529s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1062.7682s
	iters: 400, epoch: 21 | loss: 0.0000014
	speed: 0.0787s/iter; left time: 943.4268s
Epoch: 21 cost time: 32.52193284034729
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.287 Vali Acc: 0.986 Test Loss: 0.287 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1777s/iter; left time: 2110.8529s
	iters: 200, epoch: 22 | loss: 0.0001439
	speed: 0.0858s/iter; left time: 1010.0613s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 1020.1093s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 1005.5885s
Epoch: 22 cost time: 33.70877003669739
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.378 Vali Acc: 0.983 Test Loss: 0.378 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3160495
	speed: 0.1744s/iter; left time: 1999.0153s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 490.7280s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 373.4356s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 292.4128s
Epoch: 23 cost time: 15.912388324737549
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.339 Vali Acc: 0.980 Test Loss: 0.339 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1423s/iter; left time: 1572.9342s
	iters: 200, epoch: 24 | loss: 0.0028208
	speed: 0.0621s/iter; left time: 680.1248s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 641.4634s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 579.8133s
Epoch: 24 cost time: 24.38466763496399
Epoch: 24, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.182 Vali Acc: 0.990 Test Loss: 0.182 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1884s/iter; left time: 2004.6019s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 670.1331s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 387.7125s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 332.5247s
Epoch: 25 cost time: 21.97179365158081
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.987 Test Loss: 0.185 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 43714570
model size : 181.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3711860
	speed: 0.0856s/iter; left time: 1759.7482s
	iters: 200, epoch: 1 | loss: 0.1000227
	speed: 0.0982s/iter; left time: 2007.7365s
	iters: 300, epoch: 1 | loss: 0.3468116
	speed: 0.1023s/iter; left time: 2081.4003s
	iters: 400, epoch: 1 | loss: 0.1685605
	speed: 0.0874s/iter; left time: 1770.3033s
Epoch: 1 cost time: 38.53459429740906
Epoch: 1, Steps: 413 | Train Loss: 0.531 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0036926
	speed: 0.2511s/iter; left time: 5057.5477s
	iters: 200, epoch: 2 | loss: 0.1485574
	speed: 0.0950s/iter; left time: 1903.3084s
	iters: 300, epoch: 2 | loss: 0.0310749
	speed: 0.0700s/iter; left time: 1395.1808s
	iters: 400, epoch: 2 | loss: 0.7400213
	speed: 0.0423s/iter; left time: 838.8035s
Epoch: 2 cost time: 31.36113739013672
Epoch: 2, Steps: 413 | Train Loss: 0.155 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
Validation loss decreased (-0.962254 --> -0.963163).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0023180
	speed: 0.2638s/iter; left time: 5203.8156s
	iters: 200, epoch: 3 | loss: 0.0000088
	speed: 0.1022s/iter; left time: 2005.5548s
	iters: 300, epoch: 3 | loss: 0.0000868
	speed: 0.0815s/iter; left time: 1591.8538s
	iters: 400, epoch: 3 | loss: 0.0002644
	speed: 0.0842s/iter; left time: 1636.1230s
Epoch: 3 cost time: 38.49722146987915
Epoch: 3, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
Validation loss decreased (-0.963163 --> -0.967711).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000216
	speed: 0.3618s/iter; left time: 6986.4323s
	iters: 200, epoch: 4 | loss: 0.0000359
	speed: 0.0917s/iter; left time: 1762.2381s
	iters: 300, epoch: 4 | loss: 0.0000007
	speed: 0.0909s/iter; left time: 1737.9847s
	iters: 400, epoch: 4 | loss: 0.0000229
	speed: 0.0848s/iter; left time: 1612.3671s
Epoch: 4 cost time: 37.020405769348145
Epoch: 4, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
Validation loss decreased (-0.967711 --> -0.979535).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000002
	speed: 0.2752s/iter; left time: 5200.3445s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 1205.3618s
	iters: 300, epoch: 5 | loss: 0.0233981
	speed: 0.0728s/iter; left time: 1361.0991s
	iters: 400, epoch: 5 | loss: 0.0003226
	speed: 0.0943s/iter; left time: 1754.6601s
Epoch: 5 cost time: 32.98769783973694
Epoch: 5, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979989).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0027973
	speed: 0.2640s/iter; left time: 4881.0435s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0929s/iter; left time: 1708.6766s
	iters: 300, epoch: 6 | loss: 0.0000153
	speed: 0.1049s/iter; left time: 1918.7334s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 1490.1215s
Epoch: 6 cost time: 38.79372549057007
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.980 Test Loss: 0.227 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2268s/iter; left time: 4099.4266s
	iters: 200, epoch: 7 | loss: 0.0000578
	speed: 0.0694s/iter; left time: 1246.9521s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 1350.2284s
	iters: 400, epoch: 7 | loss: 0.1757914
	speed: 0.0660s/iter; left time: 1172.1422s
Epoch: 7 cost time: 31.14487648010254
Epoch: 7, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.183 Vali Acc: 0.983 Test Loss: 0.183 Test Acc: 0.983
Validation loss decreased (-0.979989 --> -0.983172).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.1790s/iter; left time: 3161.0499s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 1159.3827s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 1377.4405s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 1310.2971s
Epoch: 8 cost time: 29.425649404525757
Epoch: 8, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.167 Vali Acc: 0.981 Test Loss: 0.167 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2903057
	speed: 0.1904s/iter; left time: 3283.1339s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0568s/iter; left time: 974.5404s
	iters: 300, epoch: 9 | loss: 0.0000010
	speed: 0.0628s/iter; left time: 1070.7269s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 1449.1899s
Epoch: 9 cost time: 27.3513605594635
Epoch: 9, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.266 Vali Acc: 0.974 Test Loss: 0.266 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2173s/iter; left time: 3657.7075s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 1057.3773s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 1496.0777s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1265.3859s
Epoch: 10 cost time: 32.58922243118286
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.239 Vali Acc: 0.983 Test Loss: 0.239 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 3066.0808s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0995s/iter; left time: 1624.0081s
	iters: 300, epoch: 11 | loss: 0.0000362
	speed: 0.1004s/iter; left time: 1627.9784s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1002s/iter; left time: 1615.0146s
Epoch: 11 cost time: 38.91098761558533
Epoch: 11, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.185 Vali Acc: 0.985 Test Loss: 0.185 Test Acc: 0.985
Validation loss decreased (-0.983172 --> -0.985446).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2658s/iter; left time: 4255.4359s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 1427.6628s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 1465.2393s
	iters: 400, epoch: 12 | loss: 0.2244067
	speed: 0.0814s/iter; left time: 1278.0429s
Epoch: 12 cost time: 37.00143504142761
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.156 Vali Acc: 0.987 Test Loss: 0.156 Test Acc: 0.987
Validation loss decreased (-0.985446 --> -0.987265).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.2878s/iter; left time: 4488.4530s
	iters: 200, epoch: 13 | loss: 0.0000100
	speed: 0.0900s/iter; left time: 1395.2047s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 1215.9574s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 784.9780s
Epoch: 13 cost time: 27.794905424118042
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.990 Test Loss: 0.134 Test Acc: 0.990
Validation loss decreased (-0.987265 --> -0.989994).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2884s/iter; left time: 4378.4498s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 1476.9488s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 1199.2977s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0589s/iter; left time: 876.2419s
Epoch: 14 cost time: 35.13647794723511
Epoch: 14, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.204 Vali Acc: 0.986 Test Loss: 0.204 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2396s/iter; left time: 3538.1426s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 1438.2600s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0906s/iter; left time: 1319.9836s
	iters: 400, epoch: 15 | loss: 0.0000016
	speed: 0.1014s/iter; left time: 1466.8275s
Epoch: 15 cost time: 38.93062782287598
Epoch: 15, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.304 Vali Acc: 0.981 Test Loss: 0.304 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2209s/iter; left time: 3171.9079s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1104s/iter; left time: 1573.3852s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1070s/iter; left time: 1514.9526s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1109s/iter; left time: 1559.1104s
Epoch: 16 cost time: 42.643468379974365
Epoch: 16, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.989 Test Loss: 0.143 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000040
	speed: 0.2016s/iter; left time: 2810.6983s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 890.0593s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 981.3920s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 883.3623s
Epoch: 17 cost time: 27.578040599822998
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.285 Vali Acc: 0.986 Test Loss: 0.285 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 2126.5484s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0971s/iter; left time: 1304.3479s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 900.3733s
	iters: 400, epoch: 18 | loss: 0.0009088
	speed: 0.0478s/iter; left time: 632.4473s
Epoch: 18 cost time: 27.726340770721436
Epoch: 18, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.255 Vali Acc: 0.984 Test Loss: 0.255 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1887s/iter; left time: 2474.8644s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 1138.6826s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 955.5775s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 1298.7017s
Epoch: 19 cost time: 35.65262770652771
Epoch: 19, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.156 Vali Acc: 0.990 Test Loss: 0.156 Test Acc: 0.990
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0044226
	speed: 0.2139s/iter; left time: 2716.9969s
	iters: 200, epoch: 20 | loss: 0.0016527
	speed: 0.0556s/iter; left time: 700.3614s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 685.5262s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 970.6085s
Epoch: 20 cost time: 27.016547441482544
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.991 Test Loss: 0.192 Test Acc: 0.991
Validation loss decreased (-0.989994 --> -0.990903).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2460s/iter; left time: 3023.6493s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 760.8682s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 802.9941s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 726.5394s
Epoch: 21 cost time: 27.378856658935547
Epoch: 21, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.161 Vali Acc: 0.990 Test Loss: 0.161 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2171s/iter; left time: 2578.5221s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1034.7560s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 682.9920s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 856.6839s
Epoch: 22 cost time: 33.488943576812744
Epoch: 22, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.128 Vali Acc: 0.994 Test Loss: 0.128 Test Acc: 0.994
Validation loss decreased (-0.990903 --> -0.993632).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2364s/iter; left time: 2709.9000s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 1074.1750s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 1173.4053s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0967s/iter; left time: 1079.3217s
Epoch: 23 cost time: 38.5428307056427
Epoch: 23, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.294 Vali Acc: 0.988 Test Loss: 0.294 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2304s/iter; left time: 2545.8419s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 1037.7486s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 1067.6391s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 966.4900s
Epoch: 24 cost time: 38.9035427570343
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.992 Test Loss: 0.207 Test Acc: 0.992
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1786s/iter; left time: 1899.6248s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 724.4835s
	iters: 300, epoch: 25 | loss: 0.0469946
	speed: 0.0616s/iter; left time: 643.4231s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 604.2678s
Epoch: 25 cost time: 26.159765005111694
Epoch: 25, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.323 Vali Acc: 0.986 Test Loss: 0.323 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2289s/iter; left time: 2341.0646s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 974.4298s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 661.4419s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 601.7899s
Epoch: 26 cost time: 32.819581747055054
Epoch: 26, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.985 Test Loss: 0.224 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1486s/iter; left time: 1458.3345s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0770s/iter; left time: 748.1210s
	iters: 300, epoch: 27 | loss: 0.1375993
	speed: 0.1171s/iter; left time: 1126.1030s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1257s/iter; left time: 1195.7692s
Epoch: 27 cost time: 40.146047592163086
Epoch: 27, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.985 Test Loss: 0.225 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3048s/iter; left time: 2865.1153s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0952s/iter; left time: 885.4220s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 755.8038s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0954s/iter; left time: 868.0889s
Epoch: 28 cost time: 42.2626690864563
Epoch: 28, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.429 Vali Acc: 0.986 Test Loss: 0.429 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2662s/iter; left time: 2392.2414s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 705.4683s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 946.1234s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1180s/iter; left time: 1025.0668s
Epoch: 29 cost time: 40.59773063659668
Epoch: 29, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.502 Vali Acc: 0.979 Test Loss: 0.502 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2372s/iter; left time: 2033.3271s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0965s/iter; left time: 817.3563s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.1153s/iter; left time: 965.9395s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 807.5746s
Epoch: 30 cost time: 41.68854999542236
Epoch: 30, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.170 Vali Acc: 0.993 Test Loss: 0.170 Test Acc: 0.993
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1897s/iter; left time: 1548.0280s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 539.2857s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 486.5754s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 731.6316s
Epoch: 31 cost time: 29.726821660995483
Epoch: 31, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.994 Test Loss: 0.180 Test Acc: 0.994
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.3426261
	speed: 0.3009s/iter; left time: 2331.1783s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 631.2029s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 643.5115s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0895s/iter; left time: 666.2455s
Epoch: 32 cost time: 37.72806262969971
Epoch: 32, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.469 Vali Acc: 0.985 Test Loss: 0.469 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9936334697589814
model parameter : 43947274
model size : 182.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0427618
	speed: 0.1040s/iter; left time: 2138.2087s
	iters: 200, epoch: 1 | loss: 0.0316162
	speed: 0.1009s/iter; left time: 2062.6009s
	iters: 300, epoch: 1 | loss: 0.1361876
	speed: 0.0919s/iter; left time: 1870.3330s
	iters: 400, epoch: 1 | loss: 0.0830559
	speed: 0.0651s/iter; left time: 1319.1888s
Epoch: 1 cost time: 37.257691860198975
Epoch: 1, Steps: 413 | Train Loss: 0.511 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1016533
	speed: 0.1323s/iter; left time: 2663.7135s
	iters: 200, epoch: 2 | loss: 0.0030622
	speed: 0.0354s/iter; left time: 709.3093s
	iters: 300, epoch: 2 | loss: 0.0033743
	speed: 0.0334s/iter; left time: 666.2254s
	iters: 400, epoch: 2 | loss: 0.0005699
	speed: 0.0365s/iter; left time: 723.1548s
Epoch: 2 cost time: 14.650578260421753
Epoch: 2, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.969076 --> -0.976352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002017
	speed: 0.1510s/iter; left time: 2979.1008s
	iters: 200, epoch: 3 | loss: 0.0000265
	speed: 0.0473s/iter; left time: 928.7631s
	iters: 300, epoch: 3 | loss: 0.0228797
	speed: 0.0446s/iter; left time: 871.4406s
	iters: 400, epoch: 3 | loss: 0.0073956
	speed: 0.0507s/iter; left time: 985.7559s
Epoch: 3 cost time: 20.11667251586914
Epoch: 3, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0004833
	speed: 0.1563s/iter; left time: 3017.8133s
	iters: 200, epoch: 4 | loss: 0.0001099
	speed: 0.0475s/iter; left time: 913.4902s
	iters: 300, epoch: 4 | loss: 0.0000070
	speed: 0.0733s/iter; left time: 1400.0369s
	iters: 400, epoch: 4 | loss: 0.0000436
	speed: 0.0533s/iter; left time: 1012.9606s
Epoch: 4 cost time: 24.338789463043213
Epoch: 4, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
Validation loss decreased (-0.976352 --> -0.984083).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000057
	speed: 0.2407s/iter; left time: 4548.4021s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 1367.9637s
	iters: 300, epoch: 5 | loss: 0.3101380
	speed: 0.0721s/iter; left time: 1347.9286s
	iters: 400, epoch: 5 | loss: 0.0000013
	speed: 0.0744s/iter; left time: 1382.8693s
Epoch: 5 cost time: 31.624136686325073
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.337 Vali Acc: 0.965 Test Loss: 0.337 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002175
	speed: 0.1620s/iter; left time: 2995.0078s
	iters: 200, epoch: 6 | loss: 0.0003508
	speed: 0.0637s/iter; left time: 1171.3323s
	iters: 300, epoch: 6 | loss: 0.0000027
	speed: 0.0667s/iter; left time: 1219.8696s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 1392.8853s
Epoch: 6 cost time: 28.251930236816406
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.288 Vali Acc: 0.967 Test Loss: 0.288 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0320913
	speed: 0.1890s/iter; left time: 3416.0850s
	iters: 200, epoch: 7 | loss: 0.2345821
	speed: 0.0871s/iter; left time: 1565.9233s
	iters: 300, epoch: 7 | loss: 0.0277107
	speed: 0.0565s/iter; left time: 1009.6229s
	iters: 400, epoch: 7 | loss: 0.0004989
	speed: 0.0489s/iter; left time: 868.9639s
Epoch: 7 cost time: 27.61256504058838
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.984 Test Loss: 0.130 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000557
	speed: 0.1400s/iter; left time: 2472.1578s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 1440.0565s
	iters: 300, epoch: 8 | loss: 0.0000009
	speed: 0.0839s/iter; left time: 1464.4723s
	iters: 400, epoch: 8 | loss: 0.0000012
	speed: 0.0705s/iter; left time: 1223.6826s
Epoch: 8 cost time: 31.099294185638428
Epoch: 8, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.198 Vali Acc: 0.980 Test Loss: 0.198 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000082
	speed: 0.1904s/iter; left time: 3282.9695s
	iters: 200, epoch: 9 | loss: 0.0002322
	speed: 0.0392s/iter; left time: 672.7737s
	iters: 300, epoch: 9 | loss: 0.0000031
	speed: 0.0625s/iter; left time: 1065.6110s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 609.5723s
Epoch: 9 cost time: 21.05712056159973
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.242 Vali Acc: 0.974 Test Loss: 0.242 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1925s/iter; left time: 3240.0431s
	iters: 200, epoch: 10 | loss: 0.1178008
	speed: 0.0892s/iter; left time: 1493.3342s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 1546.7575s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 1494.7207s
Epoch: 10 cost time: 36.81036567687988
Epoch: 10, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.334 Vali Acc: 0.969 Test Loss: 0.334 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2041s/iter; left time: 3352.2467s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 1116.5338s
	iters: 300, epoch: 11 | loss: 0.0029202
	speed: 0.0695s/iter; left time: 1127.1480s
	iters: 400, epoch: 11 | loss: 0.5461469
	speed: 0.0736s/iter; left time: 1186.9487s
Epoch: 11 cost time: 28.114081859588623
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.982 Test Loss: 0.189 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0011893
	speed: 0.1710s/iter; left time: 2738.0809s
	iters: 200, epoch: 12 | loss: 0.0000116
	speed: 0.0499s/iter; left time: 793.2879s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0436s/iter; left time: 689.9440s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0581s/iter; left time: 913.1815s
Epoch: 12 cost time: 22.385287284851074
Epoch: 12, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.982 Test Loss: 0.238 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1581s/iter; left time: 2465.9966s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 567.9907s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 804.0629s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 903.5967s
Epoch: 13 cost time: 20.269935607910156
Epoch: 13, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.191 Vali Acc: 0.979 Test Loss: 0.191 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1862s/iter; left time: 2827.0386s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 953.0243s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 894.5728s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 908.8344s
Epoch: 14 cost time: 26.016504049301147
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.307 Vali Acc: 0.980 Test Loss: 0.307 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 43809034
model size : 181.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8236777
	speed: 0.0540s/iter; left time: 1110.7162s
	iters: 200, epoch: 1 | loss: 0.2294785
	speed: 0.0343s/iter; left time: 700.5189s
	iters: 300, epoch: 1 | loss: 0.9556837
	speed: 0.0332s/iter; left time: 675.2817s
	iters: 400, epoch: 1 | loss: 0.2585989
	speed: 0.0391s/iter; left time: 792.0720s
Epoch: 1 cost time: 16.5401930809021
Epoch: 1, Steps: 413 | Train Loss: 0.519 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0843395
	speed: 0.1604s/iter; left time: 3229.5254s
	iters: 200, epoch: 2 | loss: 0.0075797
	speed: 0.0517s/iter; left time: 1036.7800s
	iters: 300, epoch: 2 | loss: 0.0021468
	speed: 0.0702s/iter; left time: 1400.5323s
	iters: 400, epoch: 2 | loss: 0.0955629
	speed: 0.0367s/iter; left time: 727.7361s
Epoch: 2 cost time: 22.83902072906494
Epoch: 2, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0033623
	speed: 0.1760s/iter; left time: 3471.3400s
	iters: 200, epoch: 3 | loss: 0.0907592
	speed: 0.0705s/iter; left time: 1383.2984s
	iters: 300, epoch: 3 | loss: 0.0112174
	speed: 0.0500s/iter; left time: 975.6955s
	iters: 400, epoch: 3 | loss: 0.0000100
	speed: 0.0397s/iter; left time: 771.2843s
Epoch: 3 cost time: 23.855382204055786
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
Validation loss decreased (-0.959980 --> -0.970894).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002650
	speed: 0.2572s/iter; left time: 4966.1154s
	iters: 200, epoch: 4 | loss: 0.0234335
	speed: 0.0801s/iter; left time: 1539.7644s
	iters: 300, epoch: 4 | loss: 0.0189763
	speed: 0.0836s/iter; left time: 1598.2735s
	iters: 400, epoch: 4 | loss: 0.0000048
	speed: 0.0612s/iter; left time: 1163.2153s
Epoch: 4 cost time: 33.63788723945618
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.970894 --> -0.972713).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0004285
	speed: 0.1677s/iter; left time: 3170.0631s
	iters: 200, epoch: 5 | loss: 0.0011872
	speed: 0.0265s/iter; left time: 497.8777s
	iters: 300, epoch: 5 | loss: 0.0000916
	speed: 0.0440s/iter; left time: 822.8877s
	iters: 400, epoch: 5 | loss: 0.1098469
	speed: 0.0518s/iter; left time: 962.9730s
Epoch: 5 cost time: 17.527987957000732
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
Validation loss decreased (-0.972713 --> -0.980899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0040750
	speed: 0.1826s/iter; left time: 3376.3541s
	iters: 200, epoch: 6 | loss: 0.0010985
	speed: 0.0623s/iter; left time: 1144.6284s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0634s/iter; left time: 1158.7927s
	iters: 400, epoch: 6 | loss: 0.0000004
	speed: 0.0479s/iter; left time: 871.1537s
Epoch: 6 cost time: 25.467029571533203
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.297 Vali Acc: 0.964 Test Loss: 0.297 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.1375s/iter; left time: 2485.5596s
	iters: 200, epoch: 7 | loss: 0.0000167
	speed: 0.0446s/iter; left time: 802.2938s
	iters: 300, epoch: 7 | loss: 1.4711246
	speed: 0.0476s/iter; left time: 850.0235s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 855.3987s
Epoch: 7 cost time: 19.41864800453186
Epoch: 7, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000073
	speed: 0.1189s/iter; left time: 2099.2827s
	iters: 200, epoch: 8 | loss: 0.0000030
	speed: 0.0447s/iter; left time: 784.5661s
	iters: 300, epoch: 8 | loss: 0.0000782
	speed: 0.0466s/iter; left time: 814.4370s
	iters: 400, epoch: 8 | loss: 0.0000052
	speed: 0.0443s/iter; left time: 768.4552s
Epoch: 8 cost time: 18.132238388061523
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.066 Vali Acc: 0.989 Test Loss: 0.066 Test Acc: 0.989
Validation loss decreased (-0.980899 --> -0.989085).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1643s/iter; left time: 2832.9768s
	iters: 200, epoch: 9 | loss: 0.0315156
	speed: 0.0374s/iter; left time: 640.7089s
	iters: 300, epoch: 9 | loss: 0.0166618
	speed: 0.0542s/iter; left time: 924.1475s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 519.7461s
Epoch: 9 cost time: 18.22312092781067
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.980 Test Loss: 0.217 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 2305.2202s
	iters: 200, epoch: 10 | loss: 0.0000251
	speed: 0.0488s/iter; left time: 816.1417s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 528.4497s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 471.6662s
Epoch: 10 cost time: 16.114038467407227
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0008811
	speed: 0.1380s/iter; left time: 2265.3313s
	iters: 200, epoch: 11 | loss: 0.0001381
	speed: 0.0415s/iter; left time: 678.0003s
	iters: 300, epoch: 11 | loss: 0.0000669
	speed: 0.0265s/iter; left time: 430.5206s
	iters: 400, epoch: 11 | loss: 0.6000896
	speed: 0.0254s/iter; left time: 409.9347s
Epoch: 11 cost time: 16.43157720565796
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.989 Test Loss: 0.089 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1370s/iter; left time: 2193.1591s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 978.6829s
	iters: 300, epoch: 12 | loss: 0.0002236
	speed: 0.0755s/iter; left time: 1193.5923s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 1006.2779s
Epoch: 12 cost time: 25.400895357131958
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.988 Test Loss: 0.140 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1892s/iter; left time: 2950.0779s
	iters: 200, epoch: 13 | loss: 0.0000218
	speed: 0.0634s/iter; left time: 981.8940s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 938.5447s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 1150.9973s
Epoch: 13 cost time: 29.51603651046753
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.082 Vali Acc: 0.990 Test Loss: 0.082 Test Acc: 0.990
Validation loss decreased (-0.989085 --> -0.990449).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000225
	speed: 0.1922s/iter; left time: 2917.9389s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 708.3173s
	iters: 300, epoch: 14 | loss: 0.5639343
	speed: 0.0483s/iter; left time: 722.9719s
	iters: 400, epoch: 14 | loss: 0.0000013
	speed: 0.0270s/iter; left time: 401.3845s
Epoch: 14 cost time: 20.026649951934814
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.973 Test Loss: 0.231 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000067
	speed: 0.2142s/iter; left time: 3164.2541s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 1106.1305s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 1393.9449s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 1479.4815s
Epoch: 15 cost time: 39.98908805847168
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.267 Vali Acc: 0.976 Test Loss: 0.267 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2216s/iter; left time: 3180.8564s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0561s/iter; left time: 799.8430s
	iters: 300, epoch: 16 | loss: 0.0026808
	speed: 0.0599s/iter; left time: 847.9784s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 611.6136s
Epoch: 16 cost time: 23.98180079460144
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.198 Vali Acc: 0.985 Test Loss: 0.198 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.0963s/iter; left time: 1342.4540s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0250s/iter; left time: 346.4946s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0295s/iter; left time: 405.9545s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 562.6338s
Epoch: 17 cost time: 13.444709777832031
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.244 Vali Acc: 0.984 Test Loss: 0.244 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0024428
	speed: 0.1468s/iter; left time: 1985.8832s
	iters: 200, epoch: 18 | loss: 0.0002373
	speed: 0.0486s/iter; left time: 652.8698s
	iters: 300, epoch: 18 | loss: 0.0000036
	speed: 0.0544s/iter; left time: 725.6196s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 792.9870s
Epoch: 18 cost time: 22.25199055671692
Epoch: 18, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.991 Test Loss: 0.111 Test Acc: 0.991
Validation loss decreased (-0.990449 --> -0.990904).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1881s/iter; left time: 2467.2277s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 624.8332s
	iters: 300, epoch: 19 | loss: 0.3960896
	speed: 0.0837s/iter; left time: 1081.7731s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 1113.1585s
Epoch: 19 cost time: 26.252859354019165
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.163 Vali Acc: 0.985 Test Loss: 0.163 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1989s/iter; left time: 2526.2685s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 820.2129s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0614s/iter; left time: 768.1886s
	iters: 400, epoch: 20 | loss: 1.6695725
	speed: 0.0536s/iter; left time: 664.8222s
Epoch: 20 cost time: 25.166154861450195
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.458 Vali Acc: 0.981 Test Loss: 0.458 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0005346
	speed: 0.1582s/iter; left time: 1944.2244s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0514s/iter; left time: 626.6872s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 726.5128s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 673.5670s
Epoch: 21 cost time: 22.309149980545044
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.980 Test Loss: 0.244 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1828s/iter; left time: 2171.4189s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 492.0105s
	iters: 300, epoch: 22 | loss: 0.0009950
	speed: 0.0477s/iter; left time: 557.2312s
	iters: 400, epoch: 22 | loss: 0.1954681
	speed: 0.0506s/iter; left time: 586.0911s
Epoch: 22 cost time: 21.135144233703613
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.359 Vali Acc: 0.976 Test Loss: 0.359 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1476s/iter; left time: 1692.5758s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 509.6230s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 403.3433s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 331.6249s
Epoch: 23 cost time: 16.4794180393219
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.328 Vali Acc: 0.984 Test Loss: 0.328 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 871.5172s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 302.7810s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 542.9071s
	iters: 400, epoch: 24 | loss: 0.0001157
	speed: 0.0571s/iter; left time: 613.5548s
Epoch: 24 cost time: 17.407442331314087
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.277 Vali Acc: 0.983 Test Loss: 0.277 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1951s/iter; left time: 2075.8938s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 267.3567s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 514.1753s
	iters: 400, epoch: 25 | loss: 0.9012466
	speed: 0.0412s/iter; left time: 425.6738s
Epoch: 25 cost time: 20.580193996429443
Epoch: 25, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.426 Vali Acc: 0.983 Test Loss: 0.426 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2146s/iter; left time: 2194.4779s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 429.2514s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 865.1344s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 855.5455s
Epoch: 26 cost time: 31.43165946006775
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.983 Test Loss: 0.318 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2004s/iter; left time: 1966.8189s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 579.2183s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 603.9990s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 648.9615s
Epoch: 27 cost time: 26.698312044143677
Epoch: 27, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.266 Vali Acc: 0.985 Test Loss: 0.266 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1855s/iter; left time: 1743.5530s
	iters: 200, epoch: 28 | loss: 0.0000003
	speed: 0.0555s/iter; left time: 516.0982s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 603.5564s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0705s/iter; left time: 641.7260s
Epoch: 28 cost time: 26.134448766708374
Epoch: 28, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.986 Test Loss: 0.180 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 43698442
model size : 181.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3667055
	speed: 0.0993s/iter; left time: 2039.9637s
	iters: 200, epoch: 1 | loss: 0.1316708
	speed: 0.0793s/iter; left time: 1621.0906s
	iters: 300, epoch: 1 | loss: 0.7824167
	speed: 0.0715s/iter; left time: 1454.3093s
	iters: 400, epoch: 1 | loss: 0.1242037
	speed: 0.0638s/iter; left time: 1291.9374s
Epoch: 1 cost time: 32.283172369003296
Epoch: 1, Steps: 413 | Train Loss: 0.540 Vali Loss: 0.287 Vali Acc: 0.934 Test Loss: 0.287 Test Acc: 0.934
Validation loss decreased (inf --> -0.934058).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1875704
	speed: 0.1815s/iter; left time: 3655.3714s
	iters: 200, epoch: 2 | loss: 0.0010989
	speed: 0.1255s/iter; left time: 2513.8705s
	iters: 300, epoch: 2 | loss: 0.0105079
	speed: 0.0777s/iter; left time: 1548.8586s
	iters: 400, epoch: 2 | loss: 0.0235705
	speed: 0.0751s/iter; left time: 1490.0250s
Epoch: 2 cost time: 36.46666955947876
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
Validation loss decreased (-0.934058 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3538015
	speed: 0.3543s/iter; left time: 6989.4528s
	iters: 200, epoch: 3 | loss: 0.0000003
	speed: 0.1271s/iter; left time: 2494.4378s
	iters: 300, epoch: 3 | loss: 0.0005480
	speed: 0.1276s/iter; left time: 2491.4827s
	iters: 400, epoch: 3 | loss: 0.0000011
	speed: 0.1396s/iter; left time: 2711.1193s
Epoch: 3 cost time: 55.09643054008484
Epoch: 3, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0002565
	speed: 0.3180s/iter; left time: 6141.6471s
	iters: 200, epoch: 4 | loss: 0.0057933
	speed: 0.1132s/iter; left time: 2174.1382s
	iters: 300, epoch: 4 | loss: 0.8669632
	speed: 0.0935s/iter; left time: 1787.2668s
	iters: 400, epoch: 4 | loss: 0.0064393
	speed: 0.0842s/iter; left time: 1600.0938s
Epoch: 4 cost time: 41.268425941467285
Epoch: 4, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.265 Vali Acc: 0.966 Test Loss: 0.265 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0002266
	speed: 0.2666s/iter; left time: 5039.2413s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 1492.9470s
	iters: 300, epoch: 5 | loss: 0.0000528
	speed: 0.0899s/iter; left time: 1681.0118s
	iters: 400, epoch: 5 | loss: 0.0008476
	speed: 0.0771s/iter; left time: 1434.7387s
Epoch: 5 cost time: 35.396682024002075
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.983 Test Loss: 0.142 Test Acc: 0.983
Validation loss decreased (-0.968621 --> -0.983173).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0377848
	speed: 0.2891s/iter; left time: 5345.0222s
	iters: 200, epoch: 6 | loss: 0.0000195
	speed: 0.0902s/iter; left time: 1657.8724s
	iters: 300, epoch: 6 | loss: 0.3468665
	speed: 0.0692s/iter; left time: 1265.5449s
	iters: 400, epoch: 6 | loss: 0.0725573
	speed: 0.0497s/iter; left time: 904.2694s
Epoch: 6 cost time: 31.152572870254517
Epoch: 6, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.974 Test Loss: 0.208 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3591372
	speed: 0.1578s/iter; left time: 2852.0191s
	iters: 200, epoch: 7 | loss: 0.0399149
	speed: 0.0674s/iter; left time: 1211.7606s
	iters: 300, epoch: 7 | loss: 0.0339784
	speed: 0.0746s/iter; left time: 1333.4111s
	iters: 400, epoch: 7 | loss: 0.0080655
	speed: 0.0731s/iter; left time: 1299.5383s
Epoch: 7 cost time: 29.10262370109558
Epoch: 7, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.115 Vali Acc: 0.984 Test Loss: 0.115 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.983628).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2645s/iter; left time: 4671.8120s
	iters: 200, epoch: 8 | loss: 0.0000004
	speed: 0.0710s/iter; left time: 1246.9470s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 1539.1122s
	iters: 400, epoch: 8 | loss: 0.1232374
	speed: 0.0611s/iter; left time: 1061.3950s
Epoch: 8 cost time: 32.258530616760254
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.335 Vali Acc: 0.973 Test Loss: 0.335 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000058
	speed: 0.2221s/iter; left time: 3831.3790s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1053s/iter; left time: 1806.0001s
	iters: 300, epoch: 9 | loss: 0.0001808
	speed: 0.1335s/iter; left time: 2276.0317s
	iters: 400, epoch: 9 | loss: 0.0000071
	speed: 0.1263s/iter; left time: 2140.5383s
Epoch: 9 cost time: 46.526764154434204
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984992).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0009901
	speed: 0.3008s/iter; left time: 5064.3375s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 1499.4861s
	iters: 300, epoch: 10 | loss: 0.0341754
	speed: 0.1058s/iter; left time: 1759.9555s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1296s/iter; left time: 2143.4932s
Epoch: 10 cost time: 46.49395561218262
Epoch: 10, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.235 Vali Acc: 0.982 Test Loss: 0.235 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000459
	speed: 0.3077s/iter; left time: 5053.0962s
	iters: 200, epoch: 11 | loss: 0.0000094
	speed: 0.0723s/iter; left time: 1179.4017s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 1077.1266s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 1365.5168s
Epoch: 11 cost time: 35.230831146240234
Epoch: 11, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.309 Vali Acc: 0.979 Test Loss: 0.309 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2820s/iter; left time: 4514.0981s
	iters: 200, epoch: 12 | loss: 0.0000144
	speed: 0.1005s/iter; left time: 1598.1336s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 1261.2094s
	iters: 400, epoch: 12 | loss: 0.0000557
	speed: 0.0676s/iter; left time: 1061.2313s
Epoch: 12 cost time: 37.77650570869446
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.985 Test Loss: 0.207 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1880s/iter; left time: 2931.5878s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 1523.5293s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 1583.1955s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 1329.7355s
Epoch: 13 cost time: 36.188732862472534
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.984 Test Loss: 0.168 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1861s/iter; left time: 2825.9582s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 673.0002s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.0717s/iter; left time: 1073.4715s
	iters: 400, epoch: 14 | loss: 0.0034097
	speed: 0.0809s/iter; left time: 1203.6120s
Epoch: 14 cost time: 27.938913345336914
Epoch: 14, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.160 Vali Acc: 0.986 Test Loss: 0.160 Test Acc: 0.986
Validation loss decreased (-0.984992 --> -0.985901).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2559s/iter; left time: 3779.0734s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0923s/iter; left time: 1353.4915s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.1007s/iter; left time: 1467.2154s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 908.4071s
Epoch: 15 cost time: 35.43044090270996
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.982 Test Loss: 0.234 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2470s/iter; left time: 3545.6208s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1099s/iter; left time: 1566.4770s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 712.2415s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 1028.0576s
Epoch: 16 cost time: 34.37403416633606
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.984 Test Loss: 0.207 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7081020
	speed: 0.2958s/iter; left time: 4124.9551s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1471s/iter; left time: 2035.9656s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1532s/iter; left time: 2105.4108s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1152s/iter; left time: 1571.9902s
Epoch: 17 cost time: 59.22706961631775
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.273 Vali Acc: 0.984 Test Loss: 0.273 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3234s/iter; left time: 4376.2412s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1117s/iter; left time: 1500.7418s
	iters: 300, epoch: 18 | loss: 2.1542118
	speed: 0.1145s/iter; left time: 1526.1945s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0951s/iter; left time: 1258.5615s
Epoch: 18 cost time: 44.468698501586914
Epoch: 18, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.182 Vali Acc: 0.987 Test Loss: 0.182 Test Acc: 0.987
Validation loss decreased (-0.985901 --> -0.987265).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1826s/iter; left time: 2395.0235s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 934.4274s
	iters: 300, epoch: 19 | loss: 0.0046710
	speed: 0.0734s/iter; left time: 948.6265s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 819.8249s
Epoch: 19 cost time: 28.856891870498657
Epoch: 19, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.187 Vali Acc: 0.986 Test Loss: 0.187 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2384s/iter; left time: 3029.2489s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 679.5085s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 1086.6886s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 958.5027s
Epoch: 20 cost time: 33.4046630859375
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.988 Test Loss: 0.291 Test Acc: 0.988
Validation loss decreased (-0.987265 --> -0.987719).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2900s/iter; left time: 3563.7969s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 957.7366s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 729.1932s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 1067.6037s
Epoch: 21 cost time: 35.20078992843628
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.416 Vali Acc: 0.984 Test Loss: 0.416 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 0.1983s/iter; left time: 2355.7408s
	iters: 200, epoch: 22 | loss: 1.5069356
	speed: 0.1012s/iter; left time: 1192.4545s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1146s/iter; left time: 1337.7863s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0877s/iter; left time: 1014.8538s
Epoch: 22 cost time: 38.97820258140564
Epoch: 22, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.209 Vali Acc: 0.987 Test Loss: 0.209 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2490s/iter; left time: 2854.6259s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 838.1560s
	iters: 300, epoch: 23 | loss: 0.0004145
	speed: 0.0645s/iter; left time: 726.2850s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 699.4174s
Epoch: 23 cost time: 31.38255500793457
Epoch: 23, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.554 Vali Acc: 0.978 Test Loss: 0.554 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000055
	speed: 0.2649s/iter; left time: 2928.1981s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1196s/iter; left time: 1310.3144s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1029s/iter; left time: 1116.5067s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1124s/iter; left time: 1208.4329s
Epoch: 24 cost time: 45.54336953163147
Epoch: 24, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.433 Vali Acc: 0.983 Test Loss: 0.433 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2122s/iter; left time: 2257.6080s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1212s/iter; left time: 1277.6307s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1245s/iter; left time: 1299.3060s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1247s/iter; left time: 1288.9374s
Epoch: 25 cost time: 49.006831407547
Epoch: 25, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.320 Vali Acc: 0.988 Test Loss: 0.320 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2893s/iter; left time: 2958.5979s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 784.4998s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 872.7379s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1102s/iter; left time: 1094.0372s
Epoch: 26 cost time: 39.85692763328552
Epoch: 26, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.991 Test Loss: 0.149 Test Acc: 0.991
Validation loss decreased (-0.987719 --> -0.990903).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2198s/iter; left time: 2157.2161s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 655.8774s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0750s/iter; left time: 720.8707s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 700.0481s
Epoch: 27 cost time: 29.24320936203003
Epoch: 27, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.992 Test Loss: 0.126 Test Acc: 0.992
Validation loss decreased (-0.990903 --> -0.991813).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2433s/iter; left time: 2286.9915s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 666.0543s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 676.0356s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 684.7055s
Epoch: 28 cost time: 31.12770676612854
Epoch: 28, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.236 Vali Acc: 0.988 Test Loss: 0.236 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2315s/iter; left time: 2080.1621s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0975s/iter; left time: 866.3794s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 550.2223s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 406.9921s
Epoch: 29 cost time: 30.519431829452515
Epoch: 29, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.346 Vali Acc: 0.986 Test Loss: 0.346 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.3045s/iter; left time: 2610.8463s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1408s/iter; left time: 1193.1263s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.1256s/iter; left time: 1051.4407s
	iters: 400, epoch: 30 | loss: 0.0000220
	speed: 0.1139s/iter; left time: 942.7635s
Epoch: 30 cost time: 53.19492816925049
Epoch: 30, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.346 Vali Acc: 0.985 Test Loss: 0.346 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2627s/iter; left time: 2144.1092s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 739.1676s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.1240s/iter; left time: 987.5064s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.1152s/iter; left time: 905.8084s
Epoch: 31 cost time: 42.52136206626892
Epoch: 31, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.846 Vali Acc: 0.982 Test Loss: 0.846 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2950s/iter; left time: 2285.9218s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 838.0067s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.1030s/iter; left time: 777.2196s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 630.8034s
Epoch: 32 cost time: 41.200862646102905
Epoch: 32, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.688 Vali Acc: 0.981 Test Loss: 0.688 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1882s/iter; left time: 1380.7748s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 488.6733s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 551.4798s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 464.3235s
Epoch: 33 cost time: 28.257577180862427
Epoch: 33, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.342 Vali Acc: 0.990 Test Loss: 0.342 Test Acc: 0.990
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1764s/iter; left time: 1221.0796s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 382.4820s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 602.7290s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 536.8872s
Epoch: 34 cost time: 30.229557991027832
Epoch: 34, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.558 Vali Acc: 0.985 Test Loss: 0.558 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2380s/iter; left time: 1549.0605s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 394.6802s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 482.9746s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 471.1133s
Epoch: 35 cost time: 31.969904899597168
Epoch: 35, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.418 Vali Acc: 0.981 Test Loss: 0.418 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2085s/iter; left time: 1270.8006s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 531.2088s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 485.3279s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 406.0966s
Epoch: 36 cost time: 34.80322313308716
Epoch: 36, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.627 Vali Acc: 0.981 Test Loss: 0.627 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1924s/iter; left time: 1093.3493s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 409.0956s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 503.0061s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0926s/iter; left time: 498.6043s
Epoch: 37 cost time: 33.449517011642456
Epoch: 37, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.653 Vali Acc: 0.984 Test Loss: 0.653 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 43968010
model size : 182.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3008418
	speed: 0.0995s/iter; left time: 2043.8794s
	iters: 200, epoch: 1 | loss: 0.0796248
	speed: 0.0981s/iter; left time: 2005.4419s
	iters: 300, epoch: 1 | loss: 0.3750788
	speed: 0.0834s/iter; left time: 1697.4587s
	iters: 400, epoch: 1 | loss: 0.0024959
	speed: 0.1356s/iter; left time: 2745.0978s
Epoch: 1 cost time: 43.338693618774414
Epoch: 1, Steps: 413 | Train Loss: 0.515 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1330732
	speed: 0.2443s/iter; left time: 4918.7403s
	iters: 200, epoch: 2 | loss: 0.0012043
	speed: 0.0591s/iter; left time: 1184.3302s
	iters: 300, epoch: 2 | loss: 0.0153505
	speed: 0.0375s/iter; left time: 748.3697s
	iters: 400, epoch: 2 | loss: 0.0001198
	speed: 0.0521s/iter; left time: 1033.4366s
Epoch: 2 cost time: 24.531673431396484
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.963164 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0053894
	speed: 0.2010s/iter; left time: 3964.2221s
	iters: 200, epoch: 3 | loss: 0.0180874
	speed: 0.0804s/iter; left time: 1578.7755s
	iters: 300, epoch: 3 | loss: 0.0000279
	speed: 0.0792s/iter; left time: 1547.0567s
	iters: 400, epoch: 3 | loss: 0.0165933
	speed: 0.0580s/iter; left time: 1127.1780s
Epoch: 3 cost time: 31.130072832107544
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0001824
	speed: 0.2148s/iter; left time: 4147.3595s
	iters: 200, epoch: 4 | loss: 0.0005482
	speed: 0.0755s/iter; left time: 1451.4484s
	iters: 300, epoch: 4 | loss: 0.0020329
	speed: 0.0802s/iter; left time: 1532.0073s
	iters: 400, epoch: 4 | loss: 0.0000007
	speed: 0.0792s/iter; left time: 1505.4408s
Epoch: 4 cost time: 32.33088159561157
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
Validation loss decreased (-0.972259 --> -0.972713).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000041
	speed: 0.2307s/iter; left time: 4360.3958s
	iters: 200, epoch: 5 | loss: 0.0002202
	speed: 0.0581s/iter; left time: 1092.2404s
	iters: 300, epoch: 5 | loss: 0.0000467
	speed: 0.0330s/iter; left time: 617.3572s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 1066.1232s
Epoch: 5 cost time: 23.418468713760376
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
Validation loss decreased (-0.972713 --> -0.986811).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2093712
	speed: 0.2244s/iter; left time: 4147.8497s
	iters: 200, epoch: 6 | loss: 0.0004560
	speed: 0.0714s/iter; left time: 1311.8889s
	iters: 300, epoch: 6 | loss: 0.0000017
	speed: 0.0782s/iter; left time: 1430.0487s
	iters: 400, epoch: 6 | loss: 0.0002200
	speed: 0.0770s/iter; left time: 1400.6482s
Epoch: 6 cost time: 32.125656843185425
Epoch: 6, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000008
	speed: 0.1778s/iter; left time: 3213.0945s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0479s/iter; left time: 860.2568s
	iters: 300, epoch: 7 | loss: 0.0160753
	speed: 0.0415s/iter; left time: 741.9017s
	iters: 400, epoch: 7 | loss: 0.0001983
	speed: 0.0452s/iter; left time: 802.7078s
Epoch: 7 cost time: 19.36730980873108
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0443424
	speed: 0.1701s/iter; left time: 3003.2660s
	iters: 200, epoch: 8 | loss: 0.0000031
	speed: 0.0579s/iter; left time: 1016.7263s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 891.0014s
	iters: 400, epoch: 8 | loss: 0.0062223
	speed: 0.0477s/iter; left time: 828.6083s
Epoch: 8 cost time: 23.32663655281067
Epoch: 8, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.182 Vali Acc: 0.982 Test Loss: 0.182 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.1813s/iter; left time: 3126.4657s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 1307.5751s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 1091.6400s
	iters: 400, epoch: 9 | loss: 0.0011790
	speed: 0.0910s/iter; left time: 1542.2696s
Epoch: 9 cost time: 30.63396692276001
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1983s/iter; left time: 3338.8473s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1232.9606s
	iters: 300, epoch: 10 | loss: 1.1198838
	speed: 0.0470s/iter; left time: 781.4953s
	iters: 400, epoch: 10 | loss: 0.0000009
	speed: 0.0441s/iter; left time: 728.9690s
Epoch: 10 cost time: 23.210011959075928
Epoch: 10, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.976 Test Loss: 0.272 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000150
	speed: 0.1662s/iter; left time: 2729.0808s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 1240.4389s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 1026.9939s
	iters: 400, epoch: 11 | loss: 0.0000081
	speed: 0.0401s/iter; left time: 645.6799s
Epoch: 11 cost time: 25.968485116958618
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.267 Vali Acc: 0.979 Test Loss: 0.267 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2336s/iter; left time: 3739.4665s
	iters: 200, epoch: 12 | loss: 0.0053367
	speed: 0.0784s/iter; left time: 1247.6152s
	iters: 300, epoch: 12 | loss: 0.0000012
	speed: 0.0742s/iter; left time: 1173.1397s
	iters: 400, epoch: 12 | loss: 0.0003784
	speed: 0.0818s/iter; left time: 1284.2737s
Epoch: 12 cost time: 33.72821307182312
Epoch: 12, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.194 Vali Acc: 0.981 Test Loss: 0.194 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.2514s/iter; left time: 3920.6776s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0984s/iter; left time: 1524.0722s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0766s/iter; left time: 1179.1600s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 849.8594s
Epoch: 13 cost time: 34.02496862411499
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.979 Test Loss: 0.232 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000006
	speed: 0.1262s/iter; left time: 1915.5300s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 545.0185s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 562.0171s
	iters: 400, epoch: 14 | loss: 0.0001189
	speed: 0.0476s/iter; left time: 708.3767s
Epoch: 14 cost time: 17.928601264953613
Epoch: 14, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.370 Vali Acc: 0.972 Test Loss: 0.370 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1430s/iter; left time: 2111.5578s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0818s/iter; left time: 1199.4622s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 716.2925s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 705.5760s
Epoch: 15 cost time: 24.668664693832397
Epoch: 15, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.264 Vali Acc: 0.980 Test Loss: 0.264 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 43838986
model size : 181.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2218552
	speed: 0.0561s/iter; left time: 1152.7746s
	iters: 200, epoch: 1 | loss: 0.2248787
	speed: 0.0391s/iter; left time: 799.7433s
	iters: 300, epoch: 1 | loss: 0.2926106
	speed: 0.0388s/iter; left time: 790.3868s
	iters: 400, epoch: 1 | loss: 0.0973642
	speed: 0.0377s/iter; left time: 763.6473s
Epoch: 1 cost time: 18.03195285797119
Epoch: 1, Steps: 413 | Train Loss: 0.533 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1361375
	speed: 0.1250s/iter; left time: 2518.1829s
	iters: 200, epoch: 2 | loss: 0.0042147
	speed: 0.0353s/iter; left time: 707.6669s
	iters: 300, epoch: 2 | loss: 0.0002543
	speed: 0.0412s/iter; left time: 820.8078s
	iters: 400, epoch: 2 | loss: 0.0080089
	speed: 0.0476s/iter; left time: 943.8270s
Epoch: 2 cost time: 18.00093650817871
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0179615
	speed: 0.1796s/iter; left time: 3541.6874s
	iters: 200, epoch: 3 | loss: 0.1906374
	speed: 0.0534s/iter; left time: 1048.8481s
	iters: 300, epoch: 3 | loss: 0.0025494
	speed: 0.0529s/iter; left time: 1032.7664s
	iters: 400, epoch: 3 | loss: 0.0644998
	speed: 0.0578s/iter; left time: 1121.9382s
Epoch: 3 cost time: 23.280441284179688
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.207 Vali Acc: 0.960 Test Loss: 0.207 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000554
	speed: 0.1836s/iter; left time: 3546.4353s
	iters: 200, epoch: 4 | loss: 0.0012855
	speed: 0.0430s/iter; left time: 826.8318s
	iters: 300, epoch: 4 | loss: 0.0000198
	speed: 0.0381s/iter; left time: 728.4930s
	iters: 400, epoch: 4 | loss: 0.0790206
	speed: 0.0319s/iter; left time: 606.6821s
Epoch: 4 cost time: 18.2062087059021
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.973169 --> -0.979080).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000157
	speed: 0.1694s/iter; left time: 3201.2069s
	iters: 200, epoch: 5 | loss: 0.0067741
	speed: 0.0394s/iter; left time: 741.3915s
	iters: 300, epoch: 5 | loss: 0.0001436
	speed: 0.0448s/iter; left time: 837.3167s
	iters: 400, epoch: 5 | loss: 0.0010065
	speed: 0.0548s/iter; left time: 1019.9331s
Epoch: 5 cost time: 19.4458429813385
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.974 Test Loss: 0.184 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000357
	speed: 0.1917s/iter; left time: 3542.9006s
	iters: 200, epoch: 6 | loss: 0.0163929
	speed: 0.0611s/iter; left time: 1123.5158s
	iters: 300, epoch: 6 | loss: 0.0000025
	speed: 0.0593s/iter; left time: 1085.0176s
	iters: 400, epoch: 6 | loss: 0.0000350
	speed: 0.0458s/iter; left time: 832.2573s
Epoch: 6 cost time: 24.584073305130005
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0008005
	speed: 0.1567s/iter; left time: 2832.7257s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 703.1090s
	iters: 300, epoch: 7 | loss: 0.0000146
	speed: 0.0316s/iter; left time: 565.5726s
	iters: 400, epoch: 7 | loss: 0.0000206
	speed: 0.0442s/iter; left time: 785.3116s
Epoch: 7 cost time: 16.812894105911255
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.200 Vali Acc: 0.977 Test Loss: 0.200 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0022808
	speed: 0.1521s/iter; left time: 2686.4496s
	iters: 200, epoch: 8 | loss: 0.0004674
	speed: 0.0566s/iter; left time: 993.3203s
	iters: 300, epoch: 8 | loss: 0.0000370
	speed: 0.0414s/iter; left time: 723.5521s
	iters: 400, epoch: 8 | loss: 0.0001562
	speed: 0.0330s/iter; left time: 573.5880s
Epoch: 8 cost time: 19.739686965942383
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.279 Vali Acc: 0.969 Test Loss: 0.279 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0011780
	speed: 0.1510s/iter; left time: 2603.7680s
	iters: 200, epoch: 9 | loss: 0.0000307
	speed: 0.0562s/iter; left time: 964.0924s
	iters: 300, epoch: 9 | loss: 0.0001985
	speed: 0.0580s/iter; left time: 989.1406s
	iters: 400, epoch: 9 | loss: 0.0001001
	speed: 0.0443s/iter; left time: 751.2472s
Epoch: 9 cost time: 22.025986194610596
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000042
	speed: 0.1571s/iter; left time: 2644.1631s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 786.7045s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0449s/iter; left time: 747.5471s
	iters: 400, epoch: 10 | loss: 0.0167039
	speed: 0.0341s/iter; left time: 563.1884s
Epoch: 10 cost time: 17.06466054916382
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.253 Vali Acc: 0.977 Test Loss: 0.253 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1259s/iter; left time: 2066.9782s
	iters: 200, epoch: 11 | loss: 0.0012877
	speed: 0.0462s/iter; left time: 753.7203s
	iters: 300, epoch: 11 | loss: 0.3996061
	speed: 0.0487s/iter; left time: 789.3089s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.0502s/iter; left time: 808.7770s
Epoch: 11 cost time: 19.642298936843872
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.1557s/iter; left time: 2492.0016s
	iters: 200, epoch: 12 | loss: 0.0012225
	speed: 0.0450s/iter; left time: 716.0685s
	iters: 300, epoch: 12 | loss: 0.0063530
	speed: 0.0415s/iter; left time: 656.3019s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 615.3601s
Epoch: 12 cost time: 18.63034439086914
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
Validation loss decreased (-0.979080 --> -0.986356).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8240238
	speed: 0.1715s/iter; left time: 2674.1030s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 513.4840s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 528.8283s
	iters: 400, epoch: 13 | loss: 0.1195774
	speed: 0.0315s/iter; left time: 481.1114s
Epoch: 13 cost time: 14.07815670967102
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.985 Test Loss: 0.126 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1014s/iter; left time: 1539.5965s
	iters: 200, epoch: 14 | loss: 0.7105013
	speed: 0.0382s/iter; left time: 576.7710s
	iters: 300, epoch: 14 | loss: 0.0000049
	speed: 0.0521s/iter; left time: 781.2799s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 742.6304s
Epoch: 14 cost time: 18.018227577209473
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.986 Test Loss: 0.087 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.1275s/iter; left time: 1883.6558s
	iters: 200, epoch: 15 | loss: 0.0000082
	speed: 0.0497s/iter; left time: 729.0794s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0580s/iter; left time: 844.3340s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 831.2137s
Epoch: 15 cost time: 21.151935338974
Epoch: 15, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.981 Test Loss: 0.221 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0165136
	speed: 0.1663s/iter; left time: 2387.6167s
	iters: 200, epoch: 16 | loss: 0.0002115
	speed: 0.0502s/iter; left time: 715.4852s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 804.6114s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 642.3729s
Epoch: 16 cost time: 22.44846248626709
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.978 Test Loss: 0.234 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2021s/iter; left time: 2817.6677s
	iters: 200, epoch: 17 | loss: 0.0000202
	speed: 0.0711s/iter; left time: 984.4255s
	iters: 300, epoch: 17 | loss: 0.0018776
	speed: 0.0450s/iter; left time: 618.0463s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 627.2740s
Epoch: 17 cost time: 24.605345249176025
Epoch: 17, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.978 Test Loss: 0.220 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1336s/iter; left time: 1807.8222s
	iters: 200, epoch: 18 | loss: 0.0000032
	speed: 0.0562s/iter; left time: 755.0751s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 796.8093s
	iters: 400, epoch: 18 | loss: 0.0605559
	speed: 0.0676s/iter; left time: 893.6967s
Epoch: 18 cost time: 23.712419271469116
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.986 Test Loss: 0.164 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2041s/iter; left time: 2676.8826s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 831.4445s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 667.8469s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 828.4761s
Epoch: 19 cost time: 26.10895824432373
Epoch: 19, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.980 Test Loss: 0.159 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000210
	speed: 0.1638s/iter; left time: 2080.4816s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.0409s/iter; left time: 515.2863s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 507.0224s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 566.2865s
Epoch: 20 cost time: 18.5686936378479
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.317 Vali Acc: 0.973 Test Loss: 0.317 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000159
	speed: 0.1678s/iter; left time: 2062.7889s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 645.7031s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 516.6624s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 485.0975s
Epoch: 21 cost time: 19.897890329360962
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.983 Test Loss: 0.201 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1254s/iter; left time: 1488.9955s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 530.1587s
	iters: 300, epoch: 22 | loss: 0.0000003
	speed: 0.0412s/iter; left time: 481.3240s
	iters: 400, epoch: 22 | loss: 0.0000045
	speed: 0.0345s/iter; left time: 399.8631s
Epoch: 22 cost time: 17.866247415542603
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.982 Test Loss: 0.179 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 43700746
model size : 181.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4163252
	speed: 0.1019s/iter; left time: 2093.4042s
	iters: 200, epoch: 1 | loss: 0.4123464
	speed: 0.0858s/iter; left time: 1755.6761s
	iters: 300, epoch: 1 | loss: 0.0882219
	speed: 0.0833s/iter; left time: 1694.5029s
	iters: 400, epoch: 1 | loss: 0.0551221
	speed: 0.0960s/iter; left time: 1943.5332s
Epoch: 1 cost time: 37.42690873146057
Epoch: 1, Steps: 413 | Train Loss: 0.523 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (inf --> -0.943609).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4159872
	speed: 0.1746s/iter; left time: 3516.8385s
	iters: 200, epoch: 2 | loss: 0.0045582
	speed: 0.0828s/iter; left time: 1659.5194s
	iters: 300, epoch: 2 | loss: 0.0000759
	speed: 0.0880s/iter; left time: 1755.3473s
	iters: 400, epoch: 2 | loss: 0.0001246
	speed: 0.1004s/iter; left time: 1991.0474s
Epoch: 2 cost time: 35.7457709312439
Epoch: 2, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.943609 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0088919
	speed: 0.3200s/iter; left time: 6312.0648s
	iters: 200, epoch: 3 | loss: 0.1665052
	speed: 0.1068s/iter; left time: 2096.7111s
	iters: 300, epoch: 3 | loss: 0.0006920
	speed: 0.1150s/iter; left time: 2244.6075s
	iters: 400, epoch: 3 | loss: 0.0004989
	speed: 0.0744s/iter; left time: 1444.7482s
Epoch: 3 cost time: 42.41572427749634
Epoch: 3, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001926
	speed: 0.2900s/iter; left time: 5599.6264s
	iters: 200, epoch: 4 | loss: 0.0131448
	speed: 0.1422s/iter; left time: 2732.4296s
	iters: 300, epoch: 4 | loss: 0.0133962
	speed: 0.1272s/iter; left time: 2431.7103s
	iters: 400, epoch: 4 | loss: 0.0003822
	speed: 0.1411s/iter; left time: 2681.6519s
Epoch: 4 cost time: 54.149396896362305
Epoch: 4, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000307
	speed: 0.1972s/iter; left time: 3726.9918s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 1690.4420s
	iters: 300, epoch: 5 | loss: 0.0438212
	speed: 0.0459s/iter; left time: 858.8653s
	iters: 400, epoch: 5 | loss: 0.0002890
	speed: 0.1072s/iter; left time: 1994.5392s
Epoch: 5 cost time: 33.139949798583984
Epoch: 5, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.976 Test Loss: 0.173 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000065
	speed: 0.2324s/iter; left time: 4296.3236s
	iters: 200, epoch: 6 | loss: 0.0000003
	speed: 0.0961s/iter; left time: 1766.8794s
	iters: 300, epoch: 6 | loss: 0.0113809
	speed: 0.0791s/iter; left time: 1445.8131s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 1611.4672s
Epoch: 6 cost time: 37.640162229537964
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.985 Test Loss: 0.149 Test Acc: 0.985
Validation loss decreased (-0.979535 --> -0.985446).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3196s/iter; left time: 5775.6203s
	iters: 200, epoch: 7 | loss: 0.5329655
	speed: 0.1133s/iter; left time: 2036.9957s
	iters: 300, epoch: 7 | loss: 0.0239041
	speed: 0.1129s/iter; left time: 2018.2380s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.1274s/iter; left time: 2264.2800s
Epoch: 7 cost time: 48.29674673080444
Epoch: 7, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.104 Vali Acc: 0.986 Test Loss: 0.104 Test Acc: 0.986
Validation loss decreased (-0.985446 --> -0.985902).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000003
	speed: 0.2067s/iter; left time: 3649.4799s
	iters: 200, epoch: 8 | loss: 0.4060203
	speed: 0.0593s/iter; left time: 1041.0883s
	iters: 300, epoch: 8 | loss: 0.0133836
	speed: 0.0778s/iter; left time: 1358.9630s
	iters: 400, epoch: 8 | loss: 0.0004013
	speed: 0.0855s/iter; left time: 1484.7089s
Epoch: 8 cost time: 28.41400933265686
Epoch: 8, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.067 Vali Acc: 0.992 Test Loss: 0.067 Test Acc: 0.992
Validation loss decreased (-0.985902 --> -0.991814).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0036818
	speed: 0.2748s/iter; left time: 4739.2882s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1280s/iter; left time: 2194.3913s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1163s/iter; left time: 1983.3796s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1016s/iter; left time: 1721.1965s
Epoch: 9 cost time: 45.992711544036865
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.163 Vali Acc: 0.983 Test Loss: 0.163 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000018
	speed: 0.2378s/iter; left time: 4003.2231s
	iters: 200, epoch: 10 | loss: 0.0000218
	speed: 0.0963s/iter; left time: 1610.9241s
	iters: 300, epoch: 10 | loss: 0.2966753
	speed: 0.1044s/iter; left time: 1736.1272s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 1606.3606s
Epoch: 10 cost time: 38.34201121330261
Epoch: 10, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.217 Vali Acc: 0.979 Test Loss: 0.217 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2592s/iter; left time: 4255.9195s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 1429.7869s
	iters: 300, epoch: 11 | loss: 0.0000008
	speed: 0.0898s/iter; left time: 1457.0744s
	iters: 400, epoch: 11 | loss: 0.0002795
	speed: 0.1310s/iter; left time: 2111.8586s
Epoch: 11 cost time: 43.86882042884827
Epoch: 11, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.145 Vali Acc: 0.986 Test Loss: 0.145 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.2813s/iter; left time: 4503.5253s
	iters: 200, epoch: 12 | loss: 0.0000010
	speed: 0.0638s/iter; left time: 1015.6714s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 1043.3548s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 902.6079s
Epoch: 12 cost time: 28.375380754470825
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.984 Test Loss: 0.229 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0001236
	speed: 0.1931s/iter; left time: 3011.9298s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 1334.7677s
	iters: 300, epoch: 13 | loss: 0.0023035
	speed: 0.0884s/iter; left time: 1360.7231s
	iters: 400, epoch: 13 | loss: 0.4196842
	speed: 0.1221s/iter; left time: 1867.7475s
Epoch: 13 cost time: 38.52243494987488
Epoch: 13, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.278 Vali Acc: 0.976 Test Loss: 0.278 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2843s/iter; left time: 4316.8797s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0919s/iter; left time: 1385.9058s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 1294.6570s
	iters: 400, epoch: 14 | loss: 0.0131244
	speed: 0.0722s/iter; left time: 1074.2145s
Epoch: 14 cost time: 36.52184438705444
Epoch: 14, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.257 Vali Acc: 0.980 Test Loss: 0.257 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.2135s/iter; left time: 3152.9496s
	iters: 200, epoch: 15 | loss: 0.0000025
	speed: 0.1170s/iter; left time: 1716.3240s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 1099.9319s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 1415.7963s
Epoch: 15 cost time: 37.415024280548096
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.991 Test Loss: 0.105 Test Acc: 0.991
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 2.3996339
	speed: 0.2361s/iter; left time: 3389.3345s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0963s/iter; left time: 1372.3867s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 1319.1038s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1184s/iter; left time: 1664.7383s
Epoch: 16 cost time: 40.548099994659424
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.189 Vali Acc: 0.985 Test Loss: 0.189 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0005311
	speed: 0.2011s/iter; left time: 2804.4998s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 1005.6518s
	iters: 300, epoch: 17 | loss: 0.0000020
	speed: 0.0863s/iter; left time: 1186.4311s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1021s/iter; left time: 1393.3033s
Epoch: 17 cost time: 34.112833738327026
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.985 Test Loss: 0.202 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2587s/iter; left time: 3500.4844s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 1450.7033s
	iters: 300, epoch: 18 | loss: 1.8068125
	speed: 0.1044s/iter; left time: 1391.2710s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1105s/iter; left time: 1461.4536s
Epoch: 18 cost time: 44.3412389755249
Epoch: 18, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.176 Vali Acc: 0.987 Test Loss: 0.176 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 43997962
model size : 182.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2150564
	speed: 0.0476s/iter; left time: 978.7975s
	iters: 200, epoch: 1 | loss: 0.5232046
	speed: 0.0671s/iter; left time: 1372.5495s
	iters: 300, epoch: 1 | loss: 0.3307965
	speed: 0.0688s/iter; left time: 1400.2872s
	iters: 400, epoch: 1 | loss: 0.0067282
	speed: 0.0691s/iter; left time: 1399.9682s
Epoch: 1 cost time: 26.207501649856567
Epoch: 1, Steps: 413 | Train Loss: 0.512 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (inf --> -0.957706).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0492127
	speed: 0.2396s/iter; left time: 4824.2039s
	iters: 200, epoch: 2 | loss: 0.0077445
	speed: 0.0652s/iter; left time: 1305.8283s
	iters: 300, epoch: 2 | loss: 0.4899742
	speed: 0.0553s/iter; left time: 1103.0352s
	iters: 400, epoch: 2 | loss: 0.0015061
	speed: 0.0639s/iter; left time: 1268.1666s
Epoch: 2 cost time: 30.197420120239258
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.218 Vali Acc: 0.957 Test Loss: 0.218 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000619
	speed: 0.1998s/iter; left time: 3941.9017s
	iters: 200, epoch: 3 | loss: 0.0000153
	speed: 0.0666s/iter; left time: 1306.3973s
	iters: 300, epoch: 3 | loss: 0.1762294
	speed: 0.0555s/iter; left time: 1082.6906s
	iters: 400, epoch: 3 | loss: 0.1849076
	speed: 0.0379s/iter; left time: 735.7056s
Epoch: 3 cost time: 24.36389923095703
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
Validation loss decreased (-0.957706 --> -0.971349).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5480934
	speed: 0.1535s/iter; left time: 2964.7623s
	iters: 200, epoch: 4 | loss: 0.0014360
	speed: 0.0429s/iter; left time: 824.3898s
	iters: 300, epoch: 4 | loss: 0.0005968
	speed: 0.0350s/iter; left time: 669.4104s
	iters: 400, epoch: 4 | loss: 0.2371310
	speed: 0.0333s/iter; left time: 633.3094s
Epoch: 4 cost time: 16.289808988571167
Epoch: 4, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.971349 --> -0.983173).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000004
	speed: 0.1335s/iter; left time: 2523.9359s
	iters: 200, epoch: 5 | loss: 0.0001163
	speed: 0.0920s/iter; left time: 1729.3328s
	iters: 300, epoch: 5 | loss: 0.2135053
	speed: 0.0536s/iter; left time: 1002.3204s
	iters: 400, epoch: 5 | loss: 0.0230332
	speed: 0.0275s/iter; left time: 511.1961s
Epoch: 5 cost time: 22.108669757843018
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.1856s/iter; left time: 3431.3404s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 668.3884s
	iters: 300, epoch: 6 | loss: 0.0001000
	speed: 0.0842s/iter; left time: 1539.6116s
	iters: 400, epoch: 6 | loss: 0.1705474
	speed: 0.0721s/iter; left time: 1311.8471s
Epoch: 6 cost time: 27.907514572143555
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000002
	speed: 0.2339s/iter; left time: 4227.3830s
	iters: 200, epoch: 7 | loss: 0.0053526
	speed: 0.0409s/iter; left time: 735.5619s
	iters: 300, epoch: 7 | loss: 0.0000935
	speed: 0.0565s/iter; left time: 1009.5581s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 870.1868s
Epoch: 7 cost time: 23.836087465286255
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2670245
	speed: 0.1910s/iter; left time: 3372.4644s
	iters: 200, epoch: 8 | loss: 0.1836140
	speed: 0.0686s/iter; left time: 1204.3800s
	iters: 300, epoch: 8 | loss: 0.0000204
	speed: 0.0779s/iter; left time: 1359.9241s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0701s/iter; left time: 1216.8474s
Epoch: 8 cost time: 30.16132378578186
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000006
	speed: 0.1716s/iter; left time: 2959.1214s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 630.1454s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 554.9716s
	iters: 400, epoch: 9 | loss: 0.0000003
	speed: 0.0358s/iter; left time: 606.7335s
Epoch: 9 cost time: 17.372828245162964
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1251s/iter; left time: 2106.3587s
	iters: 200, epoch: 10 | loss: 0.0000287
	speed: 0.0384s/iter; left time: 642.0449s
	iters: 300, epoch: 10 | loss: 0.0000011
	speed: 0.0410s/iter; left time: 681.4661s
	iters: 400, epoch: 10 | loss: 0.0022148
	speed: 0.0633s/iter; left time: 1046.7628s
Epoch: 10 cost time: 19.057530641555786
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.984083).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000980
	speed: 0.1979s/iter; left time: 3250.5286s
	iters: 200, epoch: 11 | loss: 0.0000022
	speed: 0.0593s/iter; left time: 968.0635s
	iters: 300, epoch: 11 | loss: 0.0000004
	speed: 0.0408s/iter; left time: 661.7128s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 1245.5099s
Epoch: 11 cost time: 26.146205186843872
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.080 Vali Acc: 0.988 Test Loss: 0.080 Test Acc: 0.988
Validation loss decreased (-0.984083 --> -0.988176).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001963
	speed: 0.2025s/iter; left time: 3241.1687s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 1179.4951s
	iters: 300, epoch: 12 | loss: 0.0125475
	speed: 0.0519s/iter; left time: 820.0737s
	iters: 400, epoch: 12 | loss: 0.0000131
	speed: 0.0690s/iter; left time: 1084.4099s
Epoch: 12 cost time: 25.78552222251892
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.976 Test Loss: 0.236 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001212
	speed: 0.1753s/iter; left time: 2733.0631s
	iters: 200, epoch: 13 | loss: 0.0000235
	speed: 0.0551s/iter; left time: 853.1171s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 1658.6176s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 1543.3875s
Epoch: 13 cost time: 34.69903492927551
Epoch: 13, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.343 Vali Acc: 0.973 Test Loss: 0.343 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0168483
	speed: 0.2333s/iter; left time: 3541.9042s
	iters: 200, epoch: 14 | loss: 0.0000034
	speed: 0.0400s/iter; left time: 603.7668s
	iters: 300, epoch: 14 | loss: 0.0000005
	speed: 0.0581s/iter; left time: 869.8441s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0683s/iter; left time: 1016.5596s
Epoch: 14 cost time: 25.114179134368896
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.286 Vali Acc: 0.974 Test Loss: 0.286 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000781
	speed: 0.1861s/iter; left time: 2749.2324s
	iters: 200, epoch: 15 | loss: 0.0013422
	speed: 0.0716s/iter; left time: 1050.6568s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 1007.0044s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 1131.2987s
Epoch: 15 cost time: 29.31823420524597
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.985 Test Loss: 0.140 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1413s/iter; left time: 2027.8490s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 723.4762s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0625s/iter; left time: 884.4649s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 1179.7020s
Epoch: 16 cost time: 25.223799467086792
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.395 Vali Acc: 0.970 Test Loss: 0.395 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000008
	speed: 0.2017s/iter; left time: 2812.6365s
	iters: 200, epoch: 17 | loss: 0.0016592
	speed: 0.0823s/iter; left time: 1139.6344s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 1001.3144s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 924.3540s
Epoch: 17 cost time: 31.95307159423828
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.980 Test Loss: 0.203 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1415s/iter; left time: 1914.9735s
	iters: 200, epoch: 18 | loss: 0.0000052
	speed: 0.0372s/iter; left time: 500.0445s
	iters: 300, epoch: 18 | loss: 0.0000165
	speed: 0.0463s/iter; left time: 617.6916s
	iters: 400, epoch: 18 | loss: 0.0158351
	speed: 0.0446s/iter; left time: 590.3885s
Epoch: 18 cost time: 17.82159948348999
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.985 Test Loss: 0.165 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.1606s/iter; left time: 2105.9829s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 717.8109s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 888.4927s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 824.7225s
Epoch: 19 cost time: 25.97898554801941
Epoch: 19, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.986 Test Loss: 0.125 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0315113
	speed: 0.1782s/iter; left time: 2263.6198s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 467.8200s
	iters: 300, epoch: 20 | loss: 0.0000006
	speed: 0.0599s/iter; left time: 748.7621s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 527.8453s
Epoch: 20 cost time: 22.64198088645935
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.987 Test Loss: 0.148 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1425s/iter; left time: 1751.8077s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 482.5660s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 824.7038s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 873.6407s
Epoch: 21 cost time: 22.296491146087646
Epoch: 21, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.268 Vali Acc: 0.980 Test Loss: 0.268 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 43795210
model size : 181.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7149031
	speed: 0.0649s/iter; left time: 1334.6138s
	iters: 200, epoch: 1 | loss: 0.0366195
	speed: 0.0399s/iter; left time: 816.4566s
	iters: 300, epoch: 1 | loss: 0.1274509
	speed: 0.0460s/iter; left time: 936.2782s
	iters: 400, epoch: 1 | loss: 0.0650440
	speed: 0.0440s/iter; left time: 890.1937s
Epoch: 1 cost time: 20.246906042099
Epoch: 1, Steps: 413 | Train Loss: 0.557 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0212528
	speed: 0.1545s/iter; left time: 3111.6002s
	iters: 200, epoch: 2 | loss: 0.0139803
	speed: 0.0479s/iter; left time: 958.8279s
	iters: 300, epoch: 2 | loss: 0.0141722
	speed: 0.0516s/iter; left time: 1029.7551s
	iters: 400, epoch: 2 | loss: 0.0094700
	speed: 0.0653s/iter; left time: 1294.9739s
Epoch: 2 cost time: 22.969854593276978
Epoch: 2, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.967712 --> -0.973623).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0021949
	speed: 0.2148s/iter; left time: 4237.6001s
	iters: 200, epoch: 3 | loss: 0.2980296
	speed: 0.0603s/iter; left time: 1182.9635s
	iters: 300, epoch: 3 | loss: 0.0672437
	speed: 0.0660s/iter; left time: 1287.7675s
	iters: 400, epoch: 3 | loss: 0.0075716
	speed: 0.0498s/iter; left time: 966.6989s
Epoch: 3 cost time: 25.098804473876953
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.973623 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1234251
	speed: 0.1892s/iter; left time: 3654.4265s
	iters: 200, epoch: 4 | loss: 0.0000713
	speed: 0.0360s/iter; left time: 692.0356s
	iters: 300, epoch: 4 | loss: 0.0000094
	speed: 0.0335s/iter; left time: 639.6777s
	iters: 400, epoch: 4 | loss: 0.0000297
	speed: 0.0321s/iter; left time: 610.7236s
Epoch: 4 cost time: 16.77618956565857
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.980445 --> -0.986812).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0174765
	speed: 0.1569s/iter; left time: 2966.0812s
	iters: 200, epoch: 5 | loss: 0.0362756
	speed: 0.0322s/iter; left time: 605.2744s
	iters: 300, epoch: 5 | loss: 0.0000225
	speed: 0.0321s/iter; left time: 599.7654s
	iters: 400, epoch: 5 | loss: 0.0003974
	speed: 0.0436s/iter; left time: 811.3761s
Epoch: 5 cost time: 15.866817712783813
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0475746
	speed: 0.1409s/iter; left time: 2604.8029s
	iters: 200, epoch: 6 | loss: 0.0000769
	speed: 0.0316s/iter; left time: 581.3504s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 931.1437s
	iters: 400, epoch: 6 | loss: 0.0002396
	speed: 0.0326s/iter; left time: 592.2182s
Epoch: 6 cost time: 15.724581003189087
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.042 Vali Acc: 0.989 Test Loss: 0.042 Test Acc: 0.989
Validation loss decreased (-0.986812 --> -0.988631).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0025800
	speed: 0.1523s/iter; left time: 2751.9298s
	iters: 200, epoch: 7 | loss: 0.0225676
	speed: 0.0462s/iter; left time: 830.4933s
	iters: 300, epoch: 7 | loss: 0.0011564
	speed: 0.0339s/iter; left time: 605.4383s
	iters: 400, epoch: 7 | loss: 0.0478183
	speed: 0.0313s/iter; left time: 555.5373s
Epoch: 7 cost time: 16.520130157470703
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1803412
	speed: 0.1023s/iter; left time: 1807.3674s
	iters: 200, epoch: 8 | loss: 0.0389356
	speed: 0.0302s/iter; left time: 529.4551s
	iters: 300, epoch: 8 | loss: 0.0000037
	speed: 0.0348s/iter; left time: 607.8767s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0305s/iter; left time: 528.6991s
Epoch: 8 cost time: 14.898033142089844
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1467s/iter; left time: 2530.3749s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 612.4918s
	iters: 300, epoch: 9 | loss: 0.0006167
	speed: 0.0416s/iter; left time: 709.0074s
	iters: 400, epoch: 9 | loss: 0.0000865
	speed: 0.0460s/iter; left time: 780.0551s
Epoch: 9 cost time: 18.441833019256592
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.984 Test Loss: 0.107 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001007
	speed: 0.1675s/iter; left time: 2820.0585s
	iters: 200, epoch: 10 | loss: 0.2189959
	speed: 0.0640s/iter; left time: 1071.4542s
	iters: 300, epoch: 10 | loss: 0.0000886
	speed: 0.0408s/iter; left time: 679.0106s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0594s/iter; left time: 981.7635s
Epoch: 10 cost time: 23.050421476364136
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1619s/iter; left time: 2658.4699s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 786.2847s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 852.7531s
	iters: 400, epoch: 11 | loss: 0.0251234
	speed: 0.0451s/iter; left time: 726.9561s
Epoch: 11 cost time: 20.789591789245605
Epoch: 11, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.325 Vali Acc: 0.960 Test Loss: 0.325 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1112s/iter; left time: 1779.8831s
	iters: 200, epoch: 12 | loss: 0.0000102
	speed: 0.0436s/iter; left time: 693.1780s
	iters: 300, epoch: 12 | loss: 0.0000643
	speed: 0.0388s/iter; left time: 613.0471s
	iters: 400, epoch: 12 | loss: 0.3338429
	speed: 0.0318s/iter; left time: 499.6190s
Epoch: 12 cost time: 15.072173595428467
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000120
	speed: 0.1474s/iter; left time: 2299.3466s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 788.0832s
	iters: 300, epoch: 13 | loss: 0.6037139
	speed: 0.0439s/iter; left time: 675.5253s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 891.6022s
Epoch: 13 cost time: 21.569785118103027
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1437s/iter; left time: 2181.2140s
	iters: 200, epoch: 14 | loss: 0.0000014
	speed: 0.0496s/iter; left time: 748.5283s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0565s/iter; left time: 845.9896s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0356s/iter; left time: 530.4182s
Epoch: 14 cost time: 19.272387504577637
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.977 Test Loss: 0.202 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.1492s/iter; left time: 2204.2412s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 907.4232s
	iters: 300, epoch: 15 | loss: 0.0000010
	speed: 0.0487s/iter; left time: 710.0380s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0470s/iter; left time: 679.7788s
Epoch: 15 cost time: 21.941163063049316
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.984 Test Loss: 0.136 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1607s/iter; left time: 2306.9349s
	iters: 200, epoch: 16 | loss: 0.0000012
	speed: 0.0404s/iter; left time: 576.5940s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 703.8299s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0403s/iter; left time: 566.4023s
Epoch: 16 cost time: 18.542476415634155
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.979 Test Loss: 0.188 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 43712266
model size : 181.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1380680
	speed: 0.0928s/iter; left time: 1907.8345s
	iters: 200, epoch: 1 | loss: 0.0408868
	speed: 0.0719s/iter; left time: 1471.3467s
	iters: 300, epoch: 1 | loss: 0.2968790
	speed: 0.0534s/iter; left time: 1087.4331s
	iters: 400, epoch: 1 | loss: 0.4694071
	speed: 0.0847s/iter; left time: 1715.9946s
Epoch: 1 cost time: 31.896166563034058
Epoch: 1, Steps: 413 | Train Loss: 0.517 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0093750
	speed: 0.1763s/iter; left time: 3551.2050s
	iters: 200, epoch: 2 | loss: 0.0005426
	speed: 0.1009s/iter; left time: 2020.8444s
	iters: 300, epoch: 2 | loss: 0.0000086
	speed: 0.1065s/iter; left time: 2122.8625s
	iters: 400, epoch: 2 | loss: 0.0097623
	speed: 0.0765s/iter; left time: 1517.2654s
Epoch: 2 cost time: 36.12312078475952
Epoch: 2, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.959071 --> -0.983173).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0256143
	speed: 0.2612s/iter; left time: 5153.1047s
	iters: 200, epoch: 3 | loss: 0.0028244
	speed: 0.1005s/iter; left time: 1973.2549s
	iters: 300, epoch: 3 | loss: 0.8513392
	speed: 0.1014s/iter; left time: 1979.0897s
	iters: 400, epoch: 3 | loss: 0.0105006
	speed: 0.1240s/iter; left time: 2408.2707s
Epoch: 3 cost time: 44.05752229690552
Epoch: 3, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000016
	speed: 0.2564s/iter; left time: 4951.1517s
	iters: 200, epoch: 4 | loss: 0.0005137
	speed: 0.0978s/iter; left time: 1879.3057s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0836s/iter; left time: 1597.1519s
	iters: 400, epoch: 4 | loss: 0.0129117
	speed: 0.0875s/iter; left time: 1664.0390s
Epoch: 4 cost time: 38.18004322052002
Epoch: 4, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000105
	speed: 0.1423s/iter; left time: 2689.5506s
	iters: 200, epoch: 5 | loss: 0.0008262
	speed: 0.0493s/iter; left time: 927.0740s
	iters: 300, epoch: 5 | loss: 0.0004286
	speed: 0.0528s/iter; left time: 986.9732s
	iters: 400, epoch: 5 | loss: 0.0000003
	speed: 0.0709s/iter; left time: 1318.6870s
Epoch: 5 cost time: 23.79209876060486
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0003128
	speed: 0.1937s/iter; left time: 3580.7294s
	iters: 200, epoch: 6 | loss: 0.5919248
	speed: 0.0873s/iter; left time: 1604.2213s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0946s/iter; left time: 1730.3770s
	iters: 400, epoch: 6 | loss: 0.0000179
	speed: 0.0923s/iter; left time: 1678.0811s
Epoch: 6 cost time: 33.29284858703613
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000364
	speed: 0.2499s/iter; left time: 4516.6994s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.1338s/iter; left time: 2405.3561s
	iters: 300, epoch: 7 | loss: 0.0006035
	speed: 0.1130s/iter; left time: 2019.7542s
	iters: 400, epoch: 7 | loss: 0.0205359
	speed: 0.1343s/iter; left time: 2386.4518s
Epoch: 7 cost time: 49.1332323551178
Epoch: 7, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.215 Vali Acc: 0.971 Test Loss: 0.215 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000505
	speed: 0.4071s/iter; left time: 7188.9102s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1706s/iter; left time: 2995.8231s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1356s/iter; left time: 2367.6877s
	iters: 400, epoch: 8 | loss: 0.0002273
	speed: 0.1087s/iter; left time: 1887.5224s
Epoch: 8 cost time: 59.31385684013367
Epoch: 8, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3094s/iter; left time: 5336.7428s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1179s/iter; left time: 2021.3927s
	iters: 300, epoch: 9 | loss: 0.0768071
	speed: 0.1344s/iter; left time: 2291.4576s
	iters: 400, epoch: 9 | loss: 0.0000010
	speed: 0.1232s/iter; left time: 2087.1957s
Epoch: 9 cost time: 49.76994204521179
Epoch: 9, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.121 Vali Acc: 0.984 Test Loss: 0.121 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.983628).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000027
	speed: 0.3881s/iter; left time: 6533.7288s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1140s/iter; left time: 1908.4544s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1416s/iter; left time: 2355.8263s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1131s/iter; left time: 1870.5272s
Epoch: 10 cost time: 48.819363594055176
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.205 Vali Acc: 0.978 Test Loss: 0.205 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2509s/iter; left time: 4120.2398s
	iters: 200, epoch: 11 | loss: 0.0008725
	speed: 0.1163s/iter; left time: 1898.6059s
	iters: 300, epoch: 11 | loss: 0.1001837
	speed: 0.1228s/iter; left time: 1991.8128s
	iters: 400, epoch: 11 | loss: 0.5119714
	speed: 0.1240s/iter; left time: 1998.2395s
Epoch: 11 cost time: 46.601414918899536
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.189 Vali Acc: 0.982 Test Loss: 0.189 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1611s/iter; left time: 2579.0169s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0642s/iter; left time: 1020.7559s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 995.9174s
	iters: 400, epoch: 12 | loss: 0.0019298
	speed: 0.0559s/iter; left time: 877.8322s
Epoch: 12 cost time: 25.762938737869263
Epoch: 12, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.203 Vali Acc: 0.984 Test Loss: 0.203 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2270s/iter; left time: 3539.4273s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 1158.3495s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 1520.1984s
	iters: 400, epoch: 13 | loss: 0.8069739
	speed: 0.1268s/iter; left time: 1938.9348s
Epoch: 13 cost time: 36.1816520690918
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.293 Vali Acc: 0.977 Test Loss: 0.293 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000109
	speed: 0.3323s/iter; left time: 5045.7204s
	iters: 200, epoch: 14 | loss: 0.0000013
	speed: 0.1326s/iter; left time: 2000.0615s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1315s/iter; left time: 1970.1618s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1218s/iter; left time: 1813.0946s
Epoch: 14 cost time: 56.03317403793335
Epoch: 14, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.126 Vali Acc: 0.990 Test Loss: 0.126 Test Acc: 0.990
Validation loss decreased (-0.983628 --> -0.989539).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3414s/iter; left time: 5042.7296s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1046s/iter; left time: 1534.4483s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 2290.3165s
	iters: 400, epoch: 15 | loss: 0.0004923
	speed: 0.0944s/iter; left time: 1365.4294s
Epoch: 15 cost time: 50.93466830253601
Epoch: 15, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.333 Vali Acc: 0.977 Test Loss: 0.333 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000155
	speed: 0.2997s/iter; left time: 4302.6779s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 1193.4732s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1187s/iter; left time: 1680.5796s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1200s/iter; left time: 1686.4776s
Epoch: 16 cost time: 43.54027056694031
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.150 Vali Acc: 0.986 Test Loss: 0.150 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2935s/iter; left time: 4092.7202s
	iters: 200, epoch: 17 | loss: 0.7181110
	speed: 0.0580s/iter; left time: 802.9229s
	iters: 300, epoch: 17 | loss: 0.0016436
	speed: 0.0523s/iter; left time: 718.8120s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 688.0559s
Epoch: 17 cost time: 28.3703773021698
Epoch: 17, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.152 Vali Acc: 0.987 Test Loss: 0.152 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2319s/iter; left time: 3137.0768s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1072s/iter; left time: 1440.2888s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1272s/iter; left time: 1695.3983s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1078s/iter; left time: 1426.8420s
Epoch: 18 cost time: 43.94952917098999
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.990 Test Loss: 0.204 Test Acc: 0.990
Validation loss decreased (-0.989539 --> -0.989993).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3177s/iter; left time: 4166.7431s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1183s/iter; left time: 1539.8397s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1043s/iter; left time: 1347.1939s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 718.1817s
Epoch: 19 cost time: 40.98605227470398
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.443 Vali Acc: 0.976 Test Loss: 0.443 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2858s/iter; left time: 3630.5439s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 829.2159s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 1220.1529s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 1159.9706s
Epoch: 20 cost time: 39.41833257675171
Epoch: 20, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.984 Test Loss: 0.232 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2600s/iter; left time: 3195.6336s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0988s/iter; left time: 1203.9991s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1167s/iter; left time: 1410.6399s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1102s/iter; left time: 1321.7897s
Epoch: 21 cost time: 45.8977313041687
Epoch: 21, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.384 Vali Acc: 0.982 Test Loss: 0.384 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2079s/iter; left time: 2469.7862s
	iters: 200, epoch: 22 | loss: 1.0067234
	speed: 0.0771s/iter; left time: 907.9607s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 943.6594s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 1168.1931s
Epoch: 22 cost time: 33.05456018447876
Epoch: 22, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.347 Vali Acc: 0.985 Test Loss: 0.347 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2542s/iter; left time: 2914.5669s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 1262.7794s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1187s/iter; left time: 1337.4932s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 1240.2555s
Epoch: 23 cost time: 44.443875312805176
Epoch: 23, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.469 Vali Acc: 0.977 Test Loss: 0.469 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1842s/iter; left time: 2036.0928s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 903.5583s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 675.4189s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 956.0057s
Epoch: 24 cost time: 33.00492978096008
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.392 Vali Acc: 0.984 Test Loss: 0.392 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2009s/iter; left time: 2137.8039s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1010s/iter; left time: 1064.1838s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1034s/iter; left time: 1079.5656s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1175s/iter; left time: 1214.5537s
Epoch: 25 cost time: 39.102670669555664
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.476 Vali Acc: 0.984 Test Loss: 0.476 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2273s/iter; left time: 2324.4355s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 669.4240s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 748.9521s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 773.0538s
Epoch: 26 cost time: 31.518634557724
Epoch: 26, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.371 Vali Acc: 0.985 Test Loss: 0.371 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.7969940
	speed: 0.2398s/iter; left time: 2352.7766s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 757.3037s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 710.8735s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 540.8002s
Epoch: 27 cost time: 32.42241668701172
Epoch: 27, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.391 Vali Acc: 0.985 Test Loss: 0.391 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1626s/iter; left time: 1528.8730s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 606.8188s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 709.0757s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 711.5184s
Epoch: 28 cost time: 29.952390909194946
Epoch: 28, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.262 Vali Acc: 0.985 Test Loss: 0.262 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 44018698
model size : 182.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2933978
	speed: 0.0733s/iter; left time: 1505.6070s
	iters: 200, epoch: 1 | loss: 0.2617085
	speed: 0.0545s/iter; left time: 1114.7171s
	iters: 300, epoch: 1 | loss: 0.7066943
	speed: 0.0594s/iter; left time: 1209.1971s
	iters: 400, epoch: 1 | loss: 0.0534712
	speed: 0.0450s/iter; left time: 910.6985s
Epoch: 1 cost time: 23.88480281829834
Epoch: 1, Steps: 413 | Train Loss: 0.507 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0157100
	speed: 0.1332s/iter; left time: 2682.0705s
	iters: 200, epoch: 2 | loss: 0.1018575
	speed: 0.0315s/iter; left time: 630.7534s
	iters: 300, epoch: 2 | loss: 0.0670833
	speed: 0.0406s/iter; left time: 810.4032s
	iters: 400, epoch: 2 | loss: 0.0033765
	speed: 0.0451s/iter; left time: 894.6306s
Epoch: 2 cost time: 16.941375255584717
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.973169 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0257466
	speed: 0.2499s/iter; left time: 4928.9916s
	iters: 200, epoch: 3 | loss: 0.0290875
	speed: 0.0796s/iter; left time: 1561.6568s
	iters: 300, epoch: 3 | loss: 0.0000006
	speed: 0.0691s/iter; left time: 1348.7658s
	iters: 400, epoch: 3 | loss: 0.1854380
	speed: 0.0632s/iter; left time: 1228.4444s
Epoch: 3 cost time: 31.240681409835815
Epoch: 3, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.232 Vali Acc: 0.965 Test Loss: 0.232 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000099
	speed: 0.1645s/iter; left time: 3177.1521s
	iters: 200, epoch: 4 | loss: 0.0000672
	speed: 0.0558s/iter; left time: 1071.0764s
	iters: 300, epoch: 4 | loss: 0.0676000
	speed: 0.0688s/iter; left time: 1315.7702s
	iters: 400, epoch: 4 | loss: 0.0050404
	speed: 0.0750s/iter; left time: 1425.0642s
Epoch: 4 cost time: 26.473912715911865
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000077
	speed: 0.1415s/iter; left time: 2674.1284s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0424s/iter; left time: 797.6777s
	iters: 300, epoch: 5 | loss: 0.0000005
	speed: 0.0467s/iter; left time: 872.5222s
	iters: 400, epoch: 5 | loss: 0.0052330
	speed: 0.0436s/iter; left time: 810.7469s
Epoch: 5 cost time: 18.798250913619995
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
Validation loss decreased (-0.976807 --> -0.983628).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0004531
	speed: 0.1702s/iter; left time: 3147.0809s
	iters: 200, epoch: 6 | loss: 0.0459752
	speed: 0.0454s/iter; left time: 833.8380s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 1074.0450s
	iters: 400, epoch: 6 | loss: 0.1111901
	speed: 0.0581s/iter; left time: 1055.7280s
Epoch: 6 cost time: 23.076245307922363
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000004
	speed: 0.1495s/iter; left time: 2701.4897s
	iters: 200, epoch: 7 | loss: 0.0000019
	speed: 0.0435s/iter; left time: 781.0082s
	iters: 300, epoch: 7 | loss: 0.0000014
	speed: 0.0485s/iter; left time: 867.1346s
	iters: 400, epoch: 7 | loss: 0.2708097
	speed: 0.0550s/iter; left time: 977.6124s
Epoch: 7 cost time: 20.57070255279541
Epoch: 7, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.270 Vali Acc: 0.972 Test Loss: 0.270 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1485s/iter; left time: 2621.7984s
	iters: 200, epoch: 8 | loss: 0.0000139
	speed: 0.0615s/iter; left time: 1080.6118s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 1050.1538s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 984.8066s
Epoch: 8 cost time: 24.62433409690857
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.985447).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000102
	speed: 0.1232s/iter; left time: 2124.6721s
	iters: 200, epoch: 9 | loss: 0.0000041
	speed: 0.0322s/iter; left time: 552.4899s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0356s/iter; left time: 607.2556s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 587.9294s
Epoch: 9 cost time: 14.506557703018188
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002802
	speed: 0.1280s/iter; left time: 2153.9338s
	iters: 200, epoch: 10 | loss: 0.0000030
	speed: 0.0640s/iter; left time: 1071.5692s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 1211.6679s
	iters: 400, epoch: 10 | loss: 0.0000006
	speed: 0.0561s/iter; left time: 926.8132s
Epoch: 10 cost time: 24.376912117004395
Epoch: 10, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.185 Vali Acc: 0.981 Test Loss: 0.185 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1808s/iter; left time: 2968.9791s
	iters: 200, epoch: 11 | loss: 0.0565819
	speed: 0.0769s/iter; left time: 1254.5177s
	iters: 300, epoch: 11 | loss: 0.0155771
	speed: 0.0750s/iter; left time: 1215.8461s
	iters: 400, epoch: 11 | loss: 0.0000048
	speed: 0.0653s/iter; left time: 1053.1502s
Epoch: 11 cost time: 30.647960901260376
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1487s/iter; left time: 2380.1503s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0567s/iter; left time: 901.2446s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 1108.7077s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 1170.7006s
Epoch: 12 cost time: 25.92287850379944
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.316 Vali Acc: 0.974 Test Loss: 0.316 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1664s/iter; left time: 2595.5399s
	iters: 200, epoch: 13 | loss: 0.0000150
	speed: 0.0555s/iter; left time: 859.5175s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 966.1890s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0691s/iter; left time: 1057.1801s
Epoch: 13 cost time: 24.89133381843567
Epoch: 13, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.291 Vali Acc: 0.974 Test Loss: 0.291 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0049056
	speed: 0.2003s/iter; left time: 3040.5872s
	iters: 200, epoch: 14 | loss: 0.0000161
	speed: 0.0473s/iter; left time: 713.4916s
	iters: 300, epoch: 14 | loss: 0.0000062
	speed: 0.0479s/iter; left time: 718.1081s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0454s/iter; left time: 675.4144s
Epoch: 14 cost time: 22.573407411575317
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.431 Vali Acc: 0.973 Test Loss: 0.431 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1158s/iter; left time: 1710.2835s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 905.3205s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 686.4490s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 570.6128s
Epoch: 15 cost time: 19.59293794631958
Epoch: 15, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.986 Test Loss: 0.150 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.986356).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1223s/iter; left time: 1755.7386s
	iters: 200, epoch: 16 | loss: 0.0000237
	speed: 0.0458s/iter; left time: 653.3982s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 720.7674s
	iters: 400, epoch: 16 | loss: 0.0000006
	speed: 0.0528s/iter; left time: 742.5592s
Epoch: 16 cost time: 19.542808771133423
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.985 Test Loss: 0.224 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 1506.4017s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 401.1299s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 346.9155s
	iters: 400, epoch: 17 | loss: 0.0000130
	speed: 0.0253s/iter; left time: 345.3046s
Epoch: 17 cost time: 12.941686153411865
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.982 Test Loss: 0.256 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.1383s/iter; left time: 1871.7489s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 703.0601s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 687.9651s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 518.2436s
Epoch: 18 cost time: 20.136781692504883
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.987 Test Loss: 0.151 Test Acc: 0.987
Validation loss decreased (-0.986356 --> -0.987265).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1390s/iter; left time: 1822.7821s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 629.1633s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 833.6269s
	iters: 400, epoch: 19 | loss: 1.1035895
	speed: 0.0490s/iter; left time: 627.8196s
Epoch: 19 cost time: 21.645827293395996
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.325 Vali Acc: 0.974 Test Loss: 0.325 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.4517681
	speed: 0.1697s/iter; left time: 2156.4220s
	iters: 200, epoch: 20 | loss: 0.0000005
	speed: 0.0627s/iter; left time: 789.8248s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0483s/iter; left time: 603.6837s
	iters: 400, epoch: 20 | loss: 0.1240682
	speed: 0.0481s/iter; left time: 596.5135s
Epoch: 20 cost time: 23.207966089248657
Epoch: 20, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.204 Vali Acc: 0.979 Test Loss: 0.204 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000126
	speed: 0.1276s/iter; left time: 1567.7873s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 366.3819s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 468.8574s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 498.8800s
Epoch: 21 cost time: 15.88122034072876
Epoch: 21, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.176 Vali Acc: 0.985 Test Loss: 0.176 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0995s/iter; left time: 1182.2804s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 447.7133s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 418.6630s
	iters: 400, epoch: 22 | loss: 0.0530075
	speed: 0.0561s/iter; left time: 649.5248s
Epoch: 22 cost time: 17.51138138771057
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.269 Vali Acc: 0.983 Test Loss: 0.269 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1530s/iter; left time: 1754.2797s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 559.5287s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 560.7845s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 508.1081s
Epoch: 23 cost time: 20.53610324859619
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.985 Test Loss: 0.273 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1148s/iter; left time: 1268.4633s
	iters: 200, epoch: 24 | loss: 0.0000410
	speed: 0.0324s/iter; left time: 355.1153s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 485.7312s
	iters: 400, epoch: 24 | loss: 0.0156479
	speed: 0.0487s/iter; left time: 523.8506s
Epoch: 24 cost time: 18.020837545394897
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.351 Vali Acc: 0.980 Test Loss: 0.351 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1329s/iter; left time: 1414.3158s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 467.6180s
	iters: 300, epoch: 25 | loss: 0.0005561
	speed: 0.0591s/iter; left time: 617.0709s
	iters: 400, epoch: 25 | loss: 0.0000006
	speed: 0.0544s/iter; left time: 562.7325s
Epoch: 25 cost time: 21.389824151992798
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.301 Vali Acc: 0.983 Test Loss: 0.301 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1578s/iter; left time: 1613.7906s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 504.6966s
	iters: 300, epoch: 26 | loss: 0.0000200
	speed: 0.0409s/iter; left time: 409.7872s
	iters: 400, epoch: 26 | loss: 0.0000209
	speed: 0.0399s/iter; left time: 395.6610s
Epoch: 26 cost time: 19.195781707763672
Epoch: 26, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.317 Vali Acc: 0.981 Test Loss: 0.317 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1163s/iter; left time: 1141.1361s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 642.6123s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 778.2083s
	iters: 400, epoch: 27 | loss: 0.0000209
	speed: 0.0753s/iter; left time: 716.1671s
Epoch: 27 cost time: 27.800740718841553
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.987 Test Loss: 0.244 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1865s/iter; left time: 1753.3208s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 639.8657s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 450.1455s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 656.8404s
Epoch: 28 cost time: 27.36413598060608
Epoch: 28, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.322 Vali Acc: 0.984 Test Loss: 0.322 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 43825162
model size : 181.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8001024
	speed: 0.0599s/iter; left time: 1231.4722s
	iters: 200, epoch: 1 | loss: 0.2751739
	speed: 0.0359s/iter; left time: 734.4500s
	iters: 300, epoch: 1 | loss: 0.3012429
	speed: 0.0438s/iter; left time: 890.6794s
	iters: 400, epoch: 1 | loss: 0.0220127
	speed: 0.0408s/iter; left time: 826.3321s
Epoch: 1 cost time: 18.747365474700928
Epoch: 1, Steps: 413 | Train Loss: 0.558 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0193994
	speed: 0.1262s/iter; left time: 2540.8071s
	iters: 200, epoch: 2 | loss: 0.0814286
	speed: 0.0377s/iter; left time: 755.9412s
	iters: 300, epoch: 2 | loss: 0.0010680
	speed: 0.0277s/iter; left time: 552.7230s
	iters: 400, epoch: 2 | loss: 0.0933261
	speed: 0.0440s/iter; left time: 872.9716s
Epoch: 2 cost time: 16.364189386367798
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.964983 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008973
	speed: 0.1348s/iter; left time: 2658.0779s
	iters: 200, epoch: 3 | loss: 0.0318672
	speed: 0.0485s/iter; left time: 951.5983s
	iters: 300, epoch: 3 | loss: 0.2221233
	speed: 0.0478s/iter; left time: 932.7811s
	iters: 400, epoch: 3 | loss: 0.0002038
	speed: 0.0426s/iter; left time: 827.2364s
Epoch: 3 cost time: 19.40678334236145
Epoch: 3, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5038366
	speed: 0.1179s/iter; left time: 2276.0634s
	iters: 200, epoch: 4 | loss: 0.0005698
	speed: 0.0235s/iter; left time: 450.6454s
	iters: 300, epoch: 4 | loss: 0.0496315
	speed: 0.0280s/iter; left time: 534.1806s
	iters: 400, epoch: 4 | loss: 0.0003512
	speed: 0.0348s/iter; left time: 661.9321s
Epoch: 4 cost time: 12.618555307388306
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.970440 --> -0.985447).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0115767
	speed: 0.1766s/iter; left time: 3337.9585s
	iters: 200, epoch: 5 | loss: 0.0022903
	speed: 0.0556s/iter; left time: 1045.6081s
	iters: 300, epoch: 5 | loss: 0.0273320
	speed: 0.0539s/iter; left time: 1007.1321s
	iters: 400, epoch: 5 | loss: 0.0004175
	speed: 0.0563s/iter; left time: 1046.9217s
Epoch: 5 cost time: 23.088001251220703
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000088
	speed: 0.1403s/iter; left time: 2594.3568s
	iters: 200, epoch: 6 | loss: 0.0032475
	speed: 0.0367s/iter; left time: 675.1590s
	iters: 300, epoch: 6 | loss: 0.0000627
	speed: 0.0402s/iter; left time: 734.6273s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0316s/iter; left time: 574.7203s
Epoch: 6 cost time: 16.448521375656128
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1173108
	speed: 0.1402s/iter; left time: 2534.7142s
	iters: 200, epoch: 7 | loss: 0.0000005
	speed: 0.0424s/iter; left time: 761.2290s
	iters: 300, epoch: 7 | loss: 0.1675861
	speed: 0.0418s/iter; left time: 746.4691s
	iters: 400, epoch: 7 | loss: 0.0000041
	speed: 0.0446s/iter; left time: 792.9640s
Epoch: 7 cost time: 17.88512897491455
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000003
	speed: 0.1319s/iter; left time: 2328.7745s
	iters: 200, epoch: 8 | loss: 0.0004145
	speed: 0.0571s/iter; left time: 1002.1404s
	iters: 300, epoch: 8 | loss: 0.0002253
	speed: 0.0648s/iter; left time: 1130.5481s
	iters: 400, epoch: 8 | loss: 0.0000559
	speed: 0.0592s/iter; left time: 1027.5959s
Epoch: 8 cost time: 24.451728343963623
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.255 Vali Acc: 0.970 Test Loss: 0.255 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5139349
	speed: 0.1586s/iter; left time: 2734.9972s
	iters: 200, epoch: 9 | loss: 0.0034576
	speed: 0.0558s/iter; left time: 956.6725s
	iters: 300, epoch: 9 | loss: 0.0015661
	speed: 0.0336s/iter; left time: 572.0817s
	iters: 400, epoch: 9 | loss: 0.0000035
	speed: 0.0344s/iter; left time: 582.7518s
Epoch: 9 cost time: 17.751896858215332
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0001262
	speed: 0.0905s/iter; left time: 1522.8059s
	iters: 200, epoch: 10 | loss: 0.1405223
	speed: 0.0302s/iter; left time: 505.6503s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0311s/iter; left time: 516.6707s
	iters: 400, epoch: 10 | loss: 0.0000018
	speed: 0.0314s/iter; left time: 518.5238s
Epoch: 10 cost time: 13.425768613815308
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0015492
	speed: 0.1250s/iter; left time: 2052.1916s
	iters: 200, epoch: 11 | loss: 0.0000840
	speed: 0.0303s/iter; left time: 495.1520s
	iters: 300, epoch: 11 | loss: 0.0000027
	speed: 0.0372s/iter; left time: 603.4500s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 558.5891s
Epoch: 11 cost time: 15.002150535583496
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.225 Vali Acc: 0.973 Test Loss: 0.225 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1348s/iter; left time: 2157.4512s
	iters: 200, epoch: 12 | loss: 0.0000167
	speed: 0.0383s/iter; left time: 608.9542s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 888.7261s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 771.7585s
Epoch: 12 cost time: 18.395379066467285
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.985 Test Loss: 0.124 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3425131
	speed: 0.1830s/iter; left time: 2853.1713s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 763.9102s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 522.0207s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 446.9100s
Epoch: 13 cost time: 18.20671272277832
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0622739
	speed: 0.1095s/iter; left time: 1661.7990s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 708.9796s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 663.1710s
	iters: 400, epoch: 14 | loss: 0.0001199
	speed: 0.0480s/iter; left time: 714.2146s
Epoch: 14 cost time: 18.950135231018066
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 43723786
model size : 181.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3757837
	speed: 0.0786s/iter; left time: 1615.1342s
	iters: 200, epoch: 1 | loss: 0.6828558
	speed: 0.0500s/iter; left time: 1022.0710s
	iters: 300, epoch: 1 | loss: 0.0159841
	speed: 0.0435s/iter; left time: 885.8668s
	iters: 400, epoch: 1 | loss: 0.0013717
	speed: 0.0456s/iter; left time: 923.5306s
Epoch: 1 cost time: 22.328249216079712
Epoch: 1, Steps: 413 | Train Loss: 0.488 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (inf --> -0.980445).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0064454
	speed: 0.1437s/iter; left time: 2893.6611s
	iters: 200, epoch: 2 | loss: 0.1580213
	speed: 0.0656s/iter; left time: 1314.7556s
	iters: 300, epoch: 2 | loss: 0.0756030
	speed: 0.0411s/iter; left time: 818.8042s
	iters: 400, epoch: 2 | loss: 0.0053761
	speed: 0.0442s/iter; left time: 877.3337s
Epoch: 2 cost time: 21.655121564865112
Epoch: 2, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0136025
	speed: 0.1743s/iter; left time: 3437.1852s
	iters: 200, epoch: 3 | loss: 0.0002762
	speed: 0.0858s/iter; left time: 1684.3890s
	iters: 300, epoch: 3 | loss: 0.0029811
	speed: 0.0953s/iter; left time: 1861.4184s
	iters: 400, epoch: 3 | loss: 0.1253456
	speed: 0.1274s/iter; left time: 2475.1969s
Epoch: 3 cost time: 41.35292458534241
Epoch: 3, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0011522
	speed: 0.2718s/iter; left time: 5249.0882s
	iters: 200, epoch: 4 | loss: 0.0031342
	speed: 0.0704s/iter; left time: 1353.3130s
	iters: 300, epoch: 4 | loss: 0.0973371
	speed: 0.0611s/iter; left time: 1167.2557s
	iters: 400, epoch: 4 | loss: 0.0004545
	speed: 0.0685s/iter; left time: 1302.9647s
Epoch: 4 cost time: 32.776971101760864
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.980445 --> -0.982264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0010435
	speed: 0.2387s/iter; left time: 4511.5624s
	iters: 200, epoch: 5 | loss: 0.0000124
	speed: 0.0676s/iter; left time: 1271.2283s
	iters: 300, epoch: 5 | loss: 0.0133372
	speed: 0.0678s/iter; left time: 1267.0956s
	iters: 400, epoch: 5 | loss: 0.0001504
	speed: 0.0784s/iter; left time: 1459.0353s
Epoch: 5 cost time: 30.8853497505188
Epoch: 5, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.156 Vali Acc: 0.984 Test Loss: 0.156 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.983627).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000089
	speed: 0.1677s/iter; left time: 3099.9840s
	iters: 200, epoch: 6 | loss: 0.0090571
	speed: 0.0468s/iter; left time: 860.3443s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0496s/iter; left time: 906.5856s
	iters: 400, epoch: 6 | loss: 0.0000005
	speed: 0.0552s/iter; left time: 1004.6487s
Epoch: 6 cost time: 22.059460401535034
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000015
	speed: 0.1559s/iter; left time: 2817.0123s
	iters: 200, epoch: 7 | loss: 0.4774565
	speed: 0.0508s/iter; left time: 913.5599s
	iters: 300, epoch: 7 | loss: 0.0000021
	speed: 0.0565s/iter; left time: 1009.7969s
	iters: 400, epoch: 7 | loss: 0.0000036
	speed: 0.0428s/iter; left time: 761.0037s
Epoch: 7 cost time: 21.630541563034058
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000380
	speed: 0.1134s/iter; left time: 2002.7103s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0733s/iter; left time: 1286.5625s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 1318.0474s
	iters: 400, epoch: 8 | loss: 0.1008620
	speed: 0.0812s/iter; left time: 1410.2894s
Epoch: 8 cost time: 28.186468362808228
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.268 Vali Acc: 0.973 Test Loss: 0.268 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0869452
	speed: 0.2064s/iter; left time: 3559.6632s
	iters: 200, epoch: 9 | loss: 0.5171031
	speed: 0.0879s/iter; left time: 1507.8433s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 1338.4197s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 1120.3673s
Epoch: 9 cost time: 32.17875075340271
Epoch: 9, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000022
	speed: 0.2202s/iter; left time: 3706.6606s
	iters: 200, epoch: 10 | loss: 0.0177492
	speed: 0.0839s/iter; left time: 1403.9254s
	iters: 300, epoch: 10 | loss: 0.3420036
	speed: 0.0805s/iter; left time: 1339.6490s
	iters: 400, epoch: 10 | loss: 0.0000092
	speed: 0.0586s/iter; left time: 968.5888s
Epoch: 10 cost time: 33.817822217941284
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.334 Vali Acc: 0.971 Test Loss: 0.334 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0065225
	speed: 0.1950s/iter; left time: 3202.8245s
	iters: 200, epoch: 11 | loss: 0.1486526
	speed: 0.0747s/iter; left time: 1219.7604s
	iters: 300, epoch: 11 | loss: 0.0090568
	speed: 0.1041s/iter; left time: 1687.9202s
	iters: 400, epoch: 11 | loss: 0.1982825
	speed: 0.1065s/iter; left time: 1716.4096s
Epoch: 11 cost time: 37.43875050544739
Epoch: 11, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
Validation loss decreased (-0.983627 --> -0.985447).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2708s/iter; left time: 4334.4820s
	iters: 200, epoch: 12 | loss: 0.2525926
	speed: 0.0777s/iter; left time: 1235.3380s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 966.9324s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 703.8241s
Epoch: 12 cost time: 27.46022367477417
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.359 Vali Acc: 0.975 Test Loss: 0.359 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0566927
	speed: 0.1669s/iter; left time: 2602.3251s
	iters: 200, epoch: 13 | loss: 0.0035945
	speed: 0.0751s/iter; left time: 1163.5315s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 1255.7696s
	iters: 400, epoch: 13 | loss: 0.0010269
	speed: 0.0573s/iter; left time: 876.3450s
Epoch: 13 cost time: 29.119407653808594
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.983 Test Loss: 0.158 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1539s/iter; left time: 2337.1488s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 1183.4371s
	iters: 300, epoch: 14 | loss: 0.0000097
	speed: 0.0633s/iter; left time: 948.8122s
	iters: 400, epoch: 14 | loss: 0.0000017
	speed: 0.0636s/iter; left time: 946.5869s
Epoch: 14 cost time: 28.22685718536377
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.985 Test Loss: 0.139 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1920s/iter; left time: 2835.8690s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 645.4225s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 749.8802s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 739.3375s
Epoch: 15 cost time: 23.94250750541687
Epoch: 15, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.985 Test Loss: 0.140 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000557
	speed: 0.1987s/iter; left time: 2853.2321s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0873s/iter; left time: 1244.6942s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 1177.2003s
	iters: 400, epoch: 16 | loss: 0.0000007
	speed: 0.0968s/iter; left time: 1360.9489s
Epoch: 16 cost time: 35.882962465286255
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.980 Test Loss: 0.254 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1773s/iter; left time: 2472.2947s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0539s/iter; left time: 746.2359s
	iters: 300, epoch: 17 | loss: 0.0000029
	speed: 0.0602s/iter; left time: 826.7593s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 1248.0366s
Epoch: 17 cost time: 27.558547258377075
Epoch: 17, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.183 Vali Acc: 0.987 Test Loss: 0.183 Test Acc: 0.987
Validation loss decreased (-0.985447 --> -0.987265).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2445459
	speed: 0.1630s/iter; left time: 2205.2471s
	iters: 200, epoch: 18 | loss: 0.0000300
	speed: 0.0687s/iter; left time: 922.3233s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 905.0521s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 1060.3024s
Epoch: 18 cost time: 28.35892629623413
Epoch: 18, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.201 Vali Acc: 0.983 Test Loss: 0.201 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1736s/iter; left time: 2277.3411s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 1015.4776s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 919.7604s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 855.5718s
Epoch: 19 cost time: 29.420946836471558
Epoch: 19, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.989 Test Loss: 0.197 Test Acc: 0.989
Validation loss decreased (-0.987265 --> -0.989084).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1440s/iter; left time: 1829.9573s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 579.8189s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 985.1319s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 838.1543s
Epoch: 20 cost time: 23.64782190322876
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.989 Test Loss: 0.154 Test Acc: 0.989
Validation loss decreased (-0.989084 --> -0.989084).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2194s/iter; left time: 2697.0313s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0656s/iter; left time: 799.6024s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 932.5184s
	iters: 400, epoch: 21 | loss: 0.1948174
	speed: 0.0929s/iter; left time: 1114.5398s
Epoch: 21 cost time: 31.92589259147644
Epoch: 21, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.986 Test Loss: 0.227 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1423s/iter; left time: 1690.0583s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 655.6661s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 728.6075s
	iters: 400, epoch: 22 | loss: 0.0000059
	speed: 0.0781s/iter; left time: 904.3968s
Epoch: 22 cost time: 25.77315092086792
Epoch: 22, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.920 Vali Acc: 0.967 Test Loss: 0.920 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1954s/iter; left time: 2240.5434s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0524s/iter; left time: 595.9740s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 760.5812s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 852.3001s
Epoch: 23 cost time: 28.5781192779541
Epoch: 23, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.427 Vali Acc: 0.970 Test Loss: 0.427 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2213s/iter; left time: 2446.0335s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0716s/iter; left time: 784.5141s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0804s/iter; left time: 872.6062s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 619.4109s
Epoch: 24 cost time: 29.48896813392639
Epoch: 24, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.294 Vali Acc: 0.988 Test Loss: 0.294 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1236s/iter; left time: 1315.4085s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 451.4990s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 480.0250s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 490.6505s
Epoch: 25 cost time: 18.449070692062378
Epoch: 25, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.434 Vali Acc: 0.986 Test Loss: 0.434 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1491s/iter; left time: 1524.4901s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 754.0465s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0625s/iter; left time: 626.6065s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0698s/iter; left time: 693.1294s
Epoch: 26 cost time: 27.17407512664795
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.991 Test Loss: 0.150 Test Acc: 0.991
Validation loss decreased (-0.989084 --> -0.990903).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1613s/iter; left time: 1582.5563s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 487.0875s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 598.7876s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 515.3993s
Epoch: 27 cost time: 22.497539043426514
Epoch: 27, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.990 Test Loss: 0.171 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1617s/iter; left time: 1520.1439s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 611.1752s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 680.9634s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0821s/iter; left time: 746.9088s
Epoch: 28 cost time: 29.08154034614563
Epoch: 28, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.241 Vali Acc: 0.990 Test Loss: 0.241 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2114s/iter; left time: 1899.7605s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0993s/iter; left time: 882.6704s
	iters: 300, epoch: 29 | loss: 0.4522512
	speed: 0.0821s/iter; left time: 721.0114s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 664.4699s
Epoch: 29 cost time: 35.54707860946655
Epoch: 29, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.388 Vali Acc: 0.981 Test Loss: 0.388 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2137s/iter; left time: 1832.3175s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 792.7017s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 803.1008s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 630.1173s
Epoch: 30 cost time: 36.064358949661255
Epoch: 30, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.225 Vali Acc: 0.988 Test Loss: 0.225 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0143228
	speed: 0.1699s/iter; left time: 1386.4266s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.0623s/iter; left time: 501.9859s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 428.7423s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 404.5423s
Epoch: 31 cost time: 23.390498876571655
Epoch: 31, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.289 Vali Acc: 0.985 Test Loss: 0.289 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1406s/iter; left time: 1089.0629s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 343.2249s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 333.4370s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 476.3881s
Epoch: 32 cost time: 22.25810194015503
Epoch: 32, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.513 Vali Acc: 0.980 Test Loss: 0.513 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1780s/iter; left time: 1305.4719s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 430.0616s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 475.2457s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 369.9817s
Epoch: 33 cost time: 25.05947494506836
Epoch: 33, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.990 Test Loss: 0.205 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0117086
	speed: 0.1386s/iter; left time: 959.4662s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 292.3218s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 367.2481s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 349.8924s
Epoch: 34 cost time: 20.70100474357605
Epoch: 34, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.988 Test Loss: 0.225 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1800s/iter; left time: 1171.5163s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 419.7068s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 323.2795s
	iters: 400, epoch: 35 | loss: 0.0000003
	speed: 0.0687s/iter; left time: 426.3344s
Epoch: 35 cost time: 26.820695638656616
Epoch: 35, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.985 Test Loss: 0.239 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1488s/iter; left time: 906.8730s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 387.6198s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 408.4716s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 353.3665s
Epoch: 36 cost time: 25.959967136383057
Epoch: 36, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.324 Vali Acc: 0.980 Test Loss: 0.324 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 43919626
model size : 182.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3879890
	speed: 0.0663s/iter; left time: 1363.1434s
	iters: 200, epoch: 1 | loss: 0.4036923
	speed: 0.0461s/iter; left time: 942.8660s
	iters: 300, epoch: 1 | loss: 0.0231677
	speed: 0.0775s/iter; left time: 1576.9951s
	iters: 400, epoch: 1 | loss: 0.1109334
	speed: 0.0547s/iter; left time: 1107.5225s
Epoch: 1 cost time: 25.06097912788391
Epoch: 1, Steps: 413 | Train Loss: 0.515 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8973712
	speed: 0.1490s/iter; left time: 3000.1648s
	iters: 200, epoch: 2 | loss: 0.0071519
	speed: 0.0385s/iter; left time: 772.4139s
	iters: 300, epoch: 2 | loss: 0.0016742
	speed: 0.0387s/iter; left time: 772.5781s
	iters: 400, epoch: 2 | loss: 0.0000635
	speed: 0.0395s/iter; left time: 783.1465s
Epoch: 2 cost time: 17.906970262527466
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.963164 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0468742
	speed: 0.1400s/iter; left time: 2760.6958s
	iters: 200, epoch: 3 | loss: 0.0752799
	speed: 0.0351s/iter; left time: 687.9840s
	iters: 300, epoch: 3 | loss: 0.0297449
	speed: 0.0381s/iter; left time: 743.1476s
	iters: 400, epoch: 3 | loss: 0.0006598
	speed: 0.0480s/iter; left time: 932.2976s
Epoch: 3 cost time: 16.477315664291382
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
Validation loss decreased (-0.970440 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000266
	speed: 0.1639s/iter; left time: 3164.9537s
	iters: 200, epoch: 4 | loss: 0.0000049
	speed: 0.0351s/iter; left time: 674.2014s
	iters: 300, epoch: 4 | loss: 0.0010135
	speed: 0.0310s/iter; left time: 592.8503s
	iters: 400, epoch: 4 | loss: 0.0931082
	speed: 0.0414s/iter; left time: 787.6020s
Epoch: 4 cost time: 15.970129489898682
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.957 Test Loss: 0.234 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000018
	speed: 0.1395s/iter; left time: 2635.9207s
	iters: 200, epoch: 5 | loss: 0.0006244
	speed: 0.0438s/iter; left time: 823.0485s
	iters: 300, epoch: 5 | loss: 0.0000542
	speed: 0.0466s/iter; left time: 870.5082s
	iters: 400, epoch: 5 | loss: 0.0072346
	speed: 0.0396s/iter; left time: 736.4636s
Epoch: 5 cost time: 19.346256256103516
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.972259 --> -0.984993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000048
	speed: 0.1405s/iter; left time: 2597.8757s
	iters: 200, epoch: 6 | loss: 0.0070726
	speed: 0.0323s/iter; left time: 594.4577s
	iters: 300, epoch: 6 | loss: 0.0005429
	speed: 0.0544s/iter; left time: 994.4875s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0504s/iter; left time: 917.4327s
Epoch: 6 cost time: 18.29993724822998
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000075
	speed: 0.1418s/iter; left time: 2563.5500s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0393s/iter; left time: 706.1558s
	iters: 300, epoch: 7 | loss: 0.2789714
	speed: 0.0395s/iter; left time: 706.7076s
	iters: 400, epoch: 7 | loss: 0.0000191
	speed: 0.0371s/iter; left time: 659.0789s
Epoch: 7 cost time: 16.836392879486084
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.078 Vali Acc: 0.986 Test Loss: 0.078 Test Acc: 0.986
Validation loss decreased (-0.984993 --> -0.985902).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1352434
	speed: 0.1179s/iter; left time: 2082.3861s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 752.8121s
	iters: 300, epoch: 8 | loss: 0.0000004
	speed: 0.0336s/iter; left time: 586.9080s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0418s/iter; left time: 726.3710s
Epoch: 8 cost time: 16.43362808227539
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.986811).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4631319
	speed: 0.1341s/iter; left time: 2313.6000s
	iters: 200, epoch: 9 | loss: 0.0000203
	speed: 0.0317s/iter; left time: 542.7039s
	iters: 300, epoch: 9 | loss: 0.0000341
	speed: 0.0440s/iter; left time: 749.7674s
	iters: 400, epoch: 9 | loss: 0.0000225
	speed: 0.0378s/iter; left time: 641.2271s
Epoch: 9 cost time: 15.983820915222168
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.063 Vali Acc: 0.990 Test Loss: 0.063 Test Acc: 0.990
Validation loss decreased (-0.986811 --> -0.989540).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000045
	speed: 0.1612s/iter; left time: 2712.8322s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 1029.8322s
	iters: 300, epoch: 10 | loss: 0.0000035
	speed: 0.0541s/iter; left time: 900.0375s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0483s/iter; left time: 798.2141s
Epoch: 10 cost time: 23.464110374450684
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1871s/iter; left time: 3072.3646s
	iters: 200, epoch: 11 | loss: 0.0000748
	speed: 0.0504s/iter; left time: 823.2724s
	iters: 300, epoch: 11 | loss: 0.0001523
	speed: 0.0561s/iter; left time: 910.2825s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 981.3730s
Epoch: 11 cost time: 24.891031980514526
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.979 Test Loss: 0.164 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1419s/iter; left time: 2271.9163s
	iters: 200, epoch: 12 | loss: 0.3037555
	speed: 0.0419s/iter; left time: 666.8816s
	iters: 300, epoch: 12 | loss: 0.0000176
	speed: 0.0536s/iter; left time: 847.3322s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0482s/iter; left time: 757.7491s
Epoch: 12 cost time: 19.833508729934692
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1269s/iter; left time: 1979.0299s
	iters: 200, epoch: 13 | loss: 0.0000013
	speed: 0.0606s/iter; left time: 938.5833s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 913.0489s
	iters: 400, epoch: 13 | loss: 0.0000018
	speed: 0.0616s/iter; left time: 942.8664s
Epoch: 13 cost time: 23.270172595977783
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.370 Vali Acc: 0.976 Test Loss: 0.370 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000335
	speed: 0.1462s/iter; left time: 2219.8201s
	iters: 200, epoch: 14 | loss: 0.0000040
	speed: 0.0488s/iter; left time: 735.3017s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0514s/iter; left time: 769.7637s
	iters: 400, epoch: 14 | loss: 0.0000168
	speed: 0.0465s/iter; left time: 691.3761s
Epoch: 14 cost time: 20.38072919845581
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.983 Test Loss: 0.200 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1154s/iter; left time: 1704.1422s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 835.7684s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 566.9492s
	iters: 400, epoch: 15 | loss: 0.0139157
	speed: 0.0562s/iter; left time: 813.0287s
Epoch: 15 cost time: 21.575799703598022
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.984 Test Loss: 0.196 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1610s/iter; left time: 2310.6757s
	iters: 200, epoch: 16 | loss: 0.0017099
	speed: 0.0790s/iter; left time: 1126.4027s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 1109.5848s
	iters: 400, epoch: 16 | loss: 0.0000139
	speed: 0.0852s/iter; left time: 1197.0230s
Epoch: 16 cost time: 32.29846930503845
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.987 Test Loss: 0.127 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1264s/iter; left time: 1762.4159s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 418.7130s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 441.4267s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0292s/iter; left time: 397.8339s
Epoch: 17 cost time: 14.521159410476685
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.987 Test Loss: 0.129 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1133s/iter; left time: 1532.2937s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 603.1598s
	iters: 300, epoch: 18 | loss: 0.0000004
	speed: 0.0672s/iter; left time: 896.2373s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 710.2818s
Epoch: 18 cost time: 22.278966188430786
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.987 Test Loss: 0.134 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1269s/iter; left time: 1664.0006s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 616.2500s
	iters: 300, epoch: 19 | loss: 0.0111944
	speed: 0.0627s/iter; left time: 809.3562s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 508.1220s
Epoch: 19 cost time: 21.195085763931274
Epoch: 19, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.457 Vali Acc: 0.970 Test Loss: 0.457 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 43809034
model size : 181.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5385304
	speed: 0.0553s/iter; left time: 1136.4543s
	iters: 200, epoch: 1 | loss: 0.1268281
	speed: 0.0351s/iter; left time: 717.6904s
	iters: 300, epoch: 1 | loss: 0.3106599
	speed: 0.0320s/iter; left time: 650.9242s
	iters: 400, epoch: 1 | loss: 0.0726202
	speed: 0.0355s/iter; left time: 719.8960s
Epoch: 1 cost time: 16.357136011123657
Epoch: 1, Steps: 413 | Train Loss: 0.553 Vali Loss: 0.107 Vali Acc: 0.964 Test Loss: 0.107 Test Acc: 0.964
Validation loss decreased (inf --> -0.964074).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0307086
	speed: 0.1451s/iter; left time: 2921.0718s
	iters: 200, epoch: 2 | loss: 0.1386384
	speed: 0.0490s/iter; left time: 980.9137s
	iters: 300, epoch: 2 | loss: 0.0041667
	speed: 0.0460s/iter; left time: 917.0149s
	iters: 400, epoch: 2 | loss: 0.3898479
	speed: 0.0386s/iter; left time: 765.6338s
Epoch: 2 cost time: 18.945655345916748
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.964074 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000756
	speed: 0.1052s/iter; left time: 2075.6941s
	iters: 200, epoch: 3 | loss: 0.0076350
	speed: 0.0293s/iter; left time: 575.9139s
	iters: 300, epoch: 3 | loss: 0.0134398
	speed: 0.0300s/iter; left time: 585.9080s
	iters: 400, epoch: 3 | loss: 0.2233040
	speed: 0.0281s/iter; left time: 545.5227s
Epoch: 3 cost time: 12.426076412200928
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0089409
	speed: 0.0812s/iter; left time: 1568.0310s
	iters: 200, epoch: 4 | loss: 0.0008918
	speed: 0.0263s/iter; left time: 505.3067s
	iters: 300, epoch: 4 | loss: 0.0001199
	speed: 0.0284s/iter; left time: 543.0746s
	iters: 400, epoch: 4 | loss: 0.0093809
	speed: 0.0423s/iter; left time: 804.2397s
Epoch: 4 cost time: 13.349141120910645
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0973225
	speed: 0.1050s/iter; left time: 1985.2272s
	iters: 200, epoch: 5 | loss: 0.0027057
	speed: 0.0301s/iter; left time: 566.3907s
	iters: 300, epoch: 5 | loss: 0.0036982
	speed: 0.0333s/iter; left time: 622.7094s
	iters: 400, epoch: 5 | loss: 0.0001674
	speed: 0.0247s/iter; left time: 460.2217s
Epoch: 5 cost time: 12.835981369018555
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.979535).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000760
	speed: 0.1189s/iter; left time: 2198.4195s
	iters: 200, epoch: 6 | loss: 0.0000091
	speed: 0.0416s/iter; left time: 765.2022s
	iters: 300, epoch: 6 | loss: 0.0000013
	speed: 0.0407s/iter; left time: 743.9997s
	iters: 400, epoch: 6 | loss: 0.0024861
	speed: 0.0303s/iter; left time: 550.2276s
Epoch: 6 cost time: 15.644423007965088
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000036
	speed: 0.0930s/iter; left time: 1680.9149s
	iters: 200, epoch: 7 | loss: 0.0000024
	speed: 0.0351s/iter; left time: 631.5600s
	iters: 300, epoch: 7 | loss: 0.1811103
	speed: 0.0375s/iter; left time: 670.7569s
	iters: 400, epoch: 7 | loss: 0.0000426
	speed: 0.0327s/iter; left time: 581.3663s
Epoch: 7 cost time: 15.277322769165039
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000360
	speed: 0.1152s/iter; left time: 2034.3866s
	iters: 200, epoch: 8 | loss: 0.0014389
	speed: 0.0390s/iter; left time: 685.1608s
	iters: 300, epoch: 8 | loss: 0.0000004
	speed: 0.0325s/iter; left time: 566.6348s
	iters: 400, epoch: 8 | loss: 0.0000076
	speed: 0.0430s/iter; left time: 747.2001s
Epoch: 8 cost time: 16.371548414230347
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.979535 --> -0.982718).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0012530
	speed: 0.1055s/iter; left time: 1819.4331s
	iters: 200, epoch: 9 | loss: 0.0015649
	speed: 0.0234s/iter; left time: 400.8165s
	iters: 300, epoch: 9 | loss: 0.0088741
	speed: 0.0264s/iter; left time: 449.2677s
	iters: 400, epoch: 9 | loss: 0.0123442
	speed: 0.0303s/iter; left time: 513.5252s
Epoch: 9 cost time: 11.518091917037964
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1258s/iter; left time: 2118.0105s
	iters: 200, epoch: 10 | loss: 0.0000336
	speed: 0.0572s/iter; left time: 957.2010s
	iters: 300, epoch: 10 | loss: 0.0000190
	speed: 0.0286s/iter; left time: 475.4775s
	iters: 400, epoch: 10 | loss: 0.0047249
	speed: 0.0472s/iter; left time: 779.8076s
Epoch: 10 cost time: 19.01189160346985
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1150s/iter; left time: 1888.9005s
	iters: 200, epoch: 11 | loss: 0.0002066
	speed: 0.0408s/iter; left time: 665.6766s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0408s/iter; left time: 661.4822s
	iters: 400, epoch: 11 | loss: 0.0022303
	speed: 0.0320s/iter; left time: 515.7317s
Epoch: 11 cost time: 16.552674055099487
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.312 Vali Acc: 0.973 Test Loss: 0.312 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0008624
	speed: 0.1223s/iter; left time: 1958.3763s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 480.3195s
	iters: 300, epoch: 12 | loss: 0.3260240
	speed: 0.0332s/iter; left time: 525.0227s
	iters: 400, epoch: 12 | loss: 0.0007430
	speed: 0.0305s/iter; left time: 479.5925s
Epoch: 12 cost time: 15.16711688041687
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.982718 --> -0.983173).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 1835.0920s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 630.5756s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 557.6167s
	iters: 400, epoch: 13 | loss: 0.0000027
	speed: 0.0380s/iter; left time: 581.9479s
Epoch: 13 cost time: 14.926354169845581
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.976 Test Loss: 0.171 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.0809s/iter; left time: 1227.6889s
	iters: 200, epoch: 14 | loss: 0.0000842
	speed: 0.0366s/iter; left time: 551.3094s
	iters: 300, epoch: 14 | loss: 0.0020237
	speed: 0.0419s/iter; left time: 627.6779s
	iters: 400, epoch: 14 | loss: 0.0000028
	speed: 0.0327s/iter; left time: 486.4443s
Epoch: 14 cost time: 15.327792406082153
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.1163s/iter; left time: 1716.9620s
	iters: 200, epoch: 15 | loss: 0.0000006
	speed: 0.0447s/iter; left time: 655.0963s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 446.4825s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 629.7621s
Epoch: 15 cost time: 15.877615213394165
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
Validation loss decreased (-0.983173 --> -0.985447).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.1423s/iter; left time: 2042.7645s
	iters: 200, epoch: 16 | loss: 0.0000135
	speed: 0.0427s/iter; left time: 608.9999s
	iters: 300, epoch: 16 | loss: 0.0000049
	speed: 0.0467s/iter; left time: 660.6097s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 414.0947s
Epoch: 16 cost time: 17.19716167449951
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.983 Test Loss: 0.152 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000052
	speed: 0.1064s/iter; left time: 1483.8935s
	iters: 200, epoch: 17 | loss: 0.1148815
	speed: 0.0397s/iter; left time: 549.3146s
	iters: 300, epoch: 17 | loss: 0.0000015
	speed: 0.0364s/iter; left time: 499.7406s
	iters: 400, epoch: 17 | loss: 0.3133027
	speed: 0.0294s/iter; left time: 401.2533s
Epoch: 17 cost time: 14.836158275604248
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.233 Vali Acc: 0.976 Test Loss: 0.233 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1095s/iter; left time: 1481.7583s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 527.6355s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 561.1266s
	iters: 400, epoch: 18 | loss: 0.0000007
	speed: 0.0414s/iter; left time: 547.4938s
Epoch: 18 cost time: 16.48833465576172
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.403 Vali Acc: 0.965 Test Loss: 0.403 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2794014
	speed: 0.0969s/iter; left time: 1271.6788s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 324.4968s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 365.4713s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 347.5905s
Epoch: 19 cost time: 11.917847394943237
Epoch: 19, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.981 Test Loss: 0.232 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0007748
	speed: 0.0843s/iter; left time: 1070.9320s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 552.9721s
	iters: 300, epoch: 20 | loss: 0.0000013
	speed: 0.0421s/iter; left time: 526.7735s
	iters: 400, epoch: 20 | loss: 0.0000010
	speed: 0.0321s/iter; left time: 397.6970s
Epoch: 20 cost time: 15.25319766998291
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.293 Vali Acc: 0.976 Test Loss: 0.293 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 1311.3415s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 374.3971s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 443.3917s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 516.7967s
Epoch: 21 cost time: 15.50104808807373
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.982 Test Loss: 0.142 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1186s/iter; left time: 1408.4260s
	iters: 200, epoch: 22 | loss: 0.0000024
	speed: 0.0259s/iter; left time: 305.5432s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0353s/iter; left time: 411.6694s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 412.8246s
Epoch: 22 cost time: 14.663842916488647
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.260 Vali Acc: 0.974 Test Loss: 0.260 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0005375
	speed: 0.1146s/iter; left time: 1313.6020s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 479.1040s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 431.1700s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 373.4098s
Epoch: 23 cost time: 16.886992692947388
Epoch: 23, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.982 Test Loss: 0.205 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000003
	speed: 0.1286s/iter; left time: 1420.9828s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 426.2951s
	iters: 300, epoch: 24 | loss: 0.0000016
	speed: 0.0374s/iter; left time: 406.3010s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 414.3144s
Epoch: 24 cost time: 16.603047132492065
Epoch: 24, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.503 Vali Acc: 0.961 Test Loss: 0.503 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1274s/iter; left time: 1355.7574s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 443.7662s
	iters: 300, epoch: 25 | loss: 0.0666799
	speed: 0.0438s/iter; left time: 457.3139s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 467.1512s
Epoch: 25 cost time: 17.497776746749878
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 43744522
model size : 181.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2290891
	speed: 0.0599s/iter; left time: 1230.0707s
	iters: 200, epoch: 1 | loss: 0.5114214
	speed: 0.0503s/iter; left time: 1028.5693s
	iters: 300, epoch: 1 | loss: 0.0792511
	speed: 0.0516s/iter; left time: 1049.5677s
	iters: 400, epoch: 1 | loss: 0.0701840
	speed: 0.0507s/iter; left time: 1027.5951s
Epoch: 1 cost time: 22.53335428237915
Epoch: 1, Steps: 413 | Train Loss: 0.495 Vali Loss: 0.065 Vali Acc: 0.973 Test Loss: 0.065 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2539981
	speed: 0.1473s/iter; left time: 2966.4075s
	iters: 200, epoch: 2 | loss: 0.2498643
	speed: 0.0377s/iter; left time: 756.3477s
	iters: 300, epoch: 2 | loss: 0.0012883
	speed: 0.0459s/iter; left time: 914.7670s
	iters: 400, epoch: 2 | loss: 0.0007668
	speed: 0.0514s/iter; left time: 1020.4788s
Epoch: 2 cost time: 18.30942702293396
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0979973
	speed: 0.1353s/iter; left time: 2668.0723s
	iters: 200, epoch: 3 | loss: 0.0876185
	speed: 0.0575s/iter; left time: 1127.6422s
	iters: 300, epoch: 3 | loss: 0.0053744
	speed: 0.0564s/iter; left time: 1101.5209s
	iters: 400, epoch: 3 | loss: 0.0894754
	speed: 0.0625s/iter; left time: 1213.5752s
Epoch: 3 cost time: 24.097925424575806
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.973169 --> -0.981354).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6486638
	speed: 0.2219s/iter; left time: 4286.1418s
	iters: 200, epoch: 4 | loss: 0.0000832
	speed: 0.0686s/iter; left time: 1318.8399s
	iters: 300, epoch: 4 | loss: 0.4156738
	speed: 0.0527s/iter; left time: 1007.4841s
	iters: 400, epoch: 4 | loss: 0.0000025
	speed: 0.0550s/iter; left time: 1045.2065s
Epoch: 4 cost time: 25.130321264266968
Epoch: 4, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000650
	speed: 0.1309s/iter; left time: 2474.0402s
	iters: 200, epoch: 5 | loss: 0.0000014
	speed: 0.0506s/iter; left time: 951.2715s
	iters: 300, epoch: 5 | loss: 0.0019976
	speed: 0.0397s/iter; left time: 742.9970s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1050.4050s
Epoch: 5 cost time: 20.89510440826416
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1878127
	speed: 0.1380s/iter; left time: 2550.8610s
	iters: 200, epoch: 6 | loss: 0.5110251
	speed: 0.0512s/iter; left time: 942.0932s
	iters: 300, epoch: 6 | loss: 0.0000044
	speed: 0.0494s/iter; left time: 904.1439s
	iters: 400, epoch: 6 | loss: 0.0000532
	speed: 0.0523s/iter; left time: 951.5823s
Epoch: 6 cost time: 21.746022701263428
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.982263).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000027
	speed: 0.1671s/iter; left time: 3020.4834s
	iters: 200, epoch: 7 | loss: 0.0000002
	speed: 0.0900s/iter; left time: 1617.0408s
	iters: 300, epoch: 7 | loss: 0.0000003
	speed: 0.0752s/iter; left time: 1344.1905s
	iters: 400, epoch: 7 | loss: 0.0000025
	speed: 0.0827s/iter; left time: 1469.9460s
Epoch: 7 cost time: 33.121567487716675
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4230113
	speed: 0.1470s/iter; left time: 2596.8800s
	iters: 200, epoch: 8 | loss: 0.0147065
	speed: 0.0489s/iter; left time: 859.1580s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0526s/iter; left time: 919.0524s
	iters: 400, epoch: 8 | loss: 0.0000003
	speed: 0.0513s/iter; left time: 891.1457s
Epoch: 8 cost time: 20.37443733215332
Epoch: 8, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1881s/iter; left time: 3243.8685s
	iters: 200, epoch: 9 | loss: 0.1926879
	speed: 0.0610s/iter; left time: 1046.2460s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0378s/iter; left time: 645.1600s
	iters: 400, epoch: 9 | loss: 0.0971363
	speed: 0.0392s/iter; left time: 664.0498s
Epoch: 9 cost time: 23.068506717681885
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.986 Test Loss: 0.110 Test Acc: 0.986
Validation loss decreased (-0.982263 --> -0.985902).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001304
	speed: 0.1960s/iter; left time: 3299.2792s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 1323.8655s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 1595.0953s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1265.5628s
Epoch: 10 cost time: 32.66988396644592
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.985 Test Loss: 0.135 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1641s/iter; left time: 2694.8013s
	iters: 200, epoch: 11 | loss: 0.0005013
	speed: 0.0655s/iter; left time: 1069.5506s
	iters: 300, epoch: 11 | loss: 0.0013337
	speed: 0.0661s/iter; left time: 1072.2360s
	iters: 400, epoch: 11 | loss: 0.0000023
	speed: 0.0695s/iter; left time: 1119.7510s
Epoch: 11 cost time: 27.806310892105103
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.987266).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1986s/iter; left time: 3179.5945s
	iters: 200, epoch: 12 | loss: 0.0000020
	speed: 0.0585s/iter; left time: 931.0648s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.0529s/iter; left time: 836.1496s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 833.2973s
Epoch: 12 cost time: 24.364476919174194
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.983 Test Loss: 0.140 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000725
	speed: 0.1649s/iter; left time: 2572.1119s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0884s/iter; left time: 1369.5031s
	iters: 300, epoch: 13 | loss: 0.0015623
	speed: 0.0865s/iter; left time: 1332.0886s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 886.5079s
Epoch: 13 cost time: 30.129948139190674
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.986 Test Loss: 0.129 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1478s/iter; left time: 2243.4929s
	iters: 200, epoch: 14 | loss: 0.0000045
	speed: 0.0485s/iter; left time: 731.9337s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 794.7782s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 801.1566s
Epoch: 14 cost time: 21.80830693244934
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.985 Test Loss: 0.152 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1788s/iter; left time: 2640.8475s
	iters: 200, epoch: 15 | loss: 0.4029636
	speed: 0.0488s/iter; left time: 716.2366s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 499.9294s
	iters: 400, epoch: 15 | loss: 0.0000090
	speed: 0.0564s/iter; left time: 815.3912s
Epoch: 15 cost time: 19.743332386016846
Epoch: 15, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.240 Vali Acc: 0.979 Test Loss: 0.240 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.1923s/iter; left time: 2760.1600s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 826.5465s
	iters: 300, epoch: 16 | loss: 0.0186675
	speed: 0.0658s/iter; left time: 931.5229s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 756.7473s
Epoch: 16 cost time: 25.886462450027466
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.281 Vali Acc: 0.976 Test Loss: 0.281 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0007529
	speed: 0.1466s/iter; left time: 2043.7226s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 918.6061s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 927.6344s
	iters: 400, epoch: 17 | loss: 0.0000049
	speed: 0.0659s/iter; left time: 899.0142s
Epoch: 17 cost time: 27.049846172332764
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.357 Vali Acc: 0.978 Test Loss: 0.357 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0008481
	speed: 0.1838s/iter; left time: 2487.2534s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 787.2397s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 581.9100s
	iters: 400, epoch: 18 | loss: 0.1018937
	speed: 0.0413s/iter; left time: 545.7607s
Epoch: 18 cost time: 22.68119978904724
Epoch: 18, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.344 Vali Acc: 0.979 Test Loss: 0.344 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1516s/iter; left time: 1988.5628s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0637s/iter; left time: 828.7126s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 783.4137s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 576.0027s
Epoch: 19 cost time: 23.486499071121216
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.248 Vali Acc: 0.985 Test Loss: 0.248 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000071
	speed: 0.1112s/iter; left time: 1412.6987s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0345s/iter; left time: 434.8219s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 513.8199s
	iters: 400, epoch: 20 | loss: 0.0000011
	speed: 0.0412s/iter; left time: 510.6881s
Epoch: 20 cost time: 15.92544174194336
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.266 Vali Acc: 0.980 Test Loss: 0.266 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1134s/iter; left time: 1393.6071s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 670.9669s
	iters: 300, epoch: 21 | loss: 0.0000077
	speed: 0.0862s/iter; left time: 1041.7750s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0826s/iter; left time: 990.1035s
Epoch: 21 cost time: 27.69023299217224
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.387 Vali Acc: 0.979 Test Loss: 0.387 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 43940362
model size : 182.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3817079
	speed: 0.0923s/iter; left time: 1896.8622s
	iters: 200, epoch: 1 | loss: 0.7580127
	speed: 0.0557s/iter; left time: 1138.7830s
	iters: 300, epoch: 1 | loss: 0.0652130
	speed: 0.0740s/iter; left time: 1505.4488s
	iters: 400, epoch: 1 | loss: 0.1191022
	speed: 0.0740s/iter; left time: 1498.4987s
Epoch: 1 cost time: 30.576950311660767
Epoch: 1, Steps: 413 | Train Loss: 0.527 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2413332
	speed: 0.1814s/iter; left time: 3653.4834s
	iters: 200, epoch: 2 | loss: 0.0027927
	speed: 0.0475s/iter; left time: 952.2179s
	iters: 300, epoch: 2 | loss: 0.0241270
	speed: 0.0490s/iter; left time: 976.0187s
	iters: 400, epoch: 2 | loss: 0.0050322
	speed: 0.0563s/iter; left time: 1117.5854s
Epoch: 2 cost time: 22.282777309417725
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.059 Vali Acc: 0.981 Test Loss: 0.059 Test Acc: 0.981
Validation loss decreased (-0.951340 --> -0.980900).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0014797
	speed: 0.1558s/iter; left time: 3072.4604s
	iters: 200, epoch: 3 | loss: 0.0015975
	speed: 0.0618s/iter; left time: 1212.6293s
	iters: 300, epoch: 3 | loss: 0.0022033
	speed: 0.0627s/iter; left time: 1223.8281s
	iters: 400, epoch: 3 | loss: 0.5990878
	speed: 0.0492s/iter; left time: 955.4427s
Epoch: 3 cost time: 23.365463972091675
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0122290
	speed: 0.1582s/iter; left time: 3055.6272s
	iters: 200, epoch: 4 | loss: 0.0000051
	speed: 0.0569s/iter; left time: 1093.6832s
	iters: 300, epoch: 4 | loss: 0.0028858
	speed: 0.0563s/iter; left time: 1075.7496s
	iters: 400, epoch: 4 | loss: 0.0082619
	speed: 0.0542s/iter; left time: 1030.8785s
Epoch: 4 cost time: 24.082982063293457
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
Validation loss decreased (-0.980900 --> -0.983628).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0010403
	speed: 0.1619s/iter; left time: 3059.6508s
	iters: 200, epoch: 5 | loss: 0.0001635
	speed: 0.0349s/iter; left time: 655.9120s
	iters: 300, epoch: 5 | loss: 0.0001990
	speed: 0.0308s/iter; left time: 575.2270s
	iters: 400, epoch: 5 | loss: 0.0010636
	speed: 0.0306s/iter; left time: 569.4374s
Epoch: 5 cost time: 14.525511503219604
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000038
	speed: 0.0905s/iter; left time: 1672.7533s
	iters: 200, epoch: 6 | loss: 0.0000058
	speed: 0.0272s/iter; left time: 500.2452s
	iters: 300, epoch: 6 | loss: 0.0000088
	speed: 0.0277s/iter; left time: 507.0894s
	iters: 400, epoch: 6 | loss: 0.0000766
	speed: 0.0280s/iter; left time: 509.6778s
Epoch: 6 cost time: 11.998230934143066
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0254716
	speed: 0.0977s/iter; left time: 1765.3352s
	iters: 200, epoch: 7 | loss: 0.0000013
	speed: 0.0492s/iter; left time: 883.6582s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 587.8827s
	iters: 400, epoch: 7 | loss: 0.0000306
	speed: 0.0477s/iter; left time: 847.1625s
Epoch: 7 cost time: 18.12772297859192
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.989 Test Loss: 0.075 Test Acc: 0.989
Validation loss decreased (-0.983628 --> -0.988630).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0023951
	speed: 0.1265s/iter; left time: 2234.7480s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0263s/iter; left time: 460.9759s
	iters: 300, epoch: 8 | loss: 0.0501093
	speed: 0.0531s/iter; left time: 927.2850s
	iters: 400, epoch: 8 | loss: 0.0000123
	speed: 0.0660s/iter; left time: 1146.1570s
Epoch: 8 cost time: 19.18144989013672
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.080 Vali Acc: 0.986 Test Loss: 0.080 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0889224
	speed: 0.1574s/iter; left time: 2714.0354s
	iters: 200, epoch: 9 | loss: 0.0025228
	speed: 0.0632s/iter; left time: 1083.6577s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 1148.7290s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0371s/iter; left time: 629.0393s
Epoch: 9 cost time: 22.55025815963745
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.985 Test Loss: 0.108 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000528
	speed: 0.1138s/iter; left time: 1915.9400s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 632.0709s
	iters: 300, epoch: 10 | loss: 0.7688004
	speed: 0.0479s/iter; left time: 797.0910s
	iters: 400, epoch: 10 | loss: 0.0002548
	speed: 0.0417s/iter; left time: 688.7464s
Epoch: 10 cost time: 18.06571316719055
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1478s/iter; left time: 2427.0603s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.0614s/iter; left time: 1001.8285s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 902.2681s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 596.4053s
Epoch: 11 cost time: 22.79144048690796
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1709s/iter; left time: 2735.1048s
	iters: 200, epoch: 12 | loss: 0.0000017
	speed: 0.0646s/iter; left time: 1027.0205s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 937.3535s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 812.0384s
Epoch: 12 cost time: 24.682621955871582
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.988 Test Loss: 0.106 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0783038
	speed: 0.1376s/iter; left time: 2146.6469s
	iters: 200, epoch: 13 | loss: 0.0000003
	speed: 0.0575s/iter; left time: 891.3771s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 713.5934s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 733.1624s
Epoch: 13 cost time: 21.48576521873474
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.982 Test Loss: 0.169 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1238s/iter; left time: 1879.3142s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 733.1620s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 763.7894s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 741.2647s
Epoch: 14 cost time: 20.46465516090393
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.973 Test Loss: 0.204 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1349s/iter; left time: 1992.9410s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 638.4458s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 660.8255s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0486s/iter; left time: 703.3059s
Epoch: 15 cost time: 19.86975908279419
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.989 Test Loss: 0.124 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.4244784
	speed: 0.1251s/iter; left time: 1795.8803s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 623.3569s
	iters: 300, epoch: 16 | loss: 0.0005061
	speed: 0.0340s/iter; left time: 481.6337s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 629.6928s
Epoch: 16 cost time: 17.635329008102417
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.222 Vali Acc: 0.985 Test Loss: 0.222 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1372761
	speed: 0.1597s/iter; left time: 2226.3369s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0385s/iter; left time: 533.3195s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 747.5058s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 653.2926s
Epoch: 17 cost time: 21.78640055656433
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.982 Test Loss: 0.273 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 43838986
model size : 181.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7614070
	speed: 0.0406s/iter; left time: 835.2544s
	iters: 200, epoch: 1 | loss: 0.1916162
	speed: 0.0242s/iter; left time: 494.5950s
	iters: 300, epoch: 1 | loss: 0.0497334
	speed: 0.0364s/iter; left time: 740.6912s
	iters: 400, epoch: 1 | loss: 0.0054254
	speed: 0.0254s/iter; left time: 514.8324s
Epoch: 1 cost time: 13.139431476593018
Epoch: 1, Steps: 413 | Train Loss: 0.563 Vali Loss: 0.082 Vali Acc: 0.971 Test Loss: 0.082 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3203778
	speed: 0.1024s/iter; left time: 2062.5626s
	iters: 200, epoch: 2 | loss: 0.0448908
	speed: 0.0337s/iter; left time: 675.4927s
	iters: 300, epoch: 2 | loss: 0.0024109
	speed: 0.0364s/iter; left time: 725.4007s
	iters: 400, epoch: 2 | loss: 0.0638251
	speed: 0.0327s/iter; left time: 649.4014s
Epoch: 2 cost time: 14.671344518661499
Epoch: 2, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0004534
	speed: 0.1224s/iter; left time: 2414.2007s
	iters: 200, epoch: 3 | loss: 0.0006727
	speed: 0.0303s/iter; left time: 594.4825s
	iters: 300, epoch: 3 | loss: 0.0803668
	speed: 0.0256s/iter; left time: 499.1368s
	iters: 400, epoch: 3 | loss: 0.0302835
	speed: 0.0386s/iter; left time: 749.2506s
Epoch: 3 cost time: 14.058822631835938
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0009125
	speed: 0.0970s/iter; left time: 1873.4069s
	iters: 200, epoch: 4 | loss: 0.0269309
	speed: 0.0242s/iter; left time: 465.4094s
	iters: 300, epoch: 4 | loss: 0.0225480
	speed: 0.0326s/iter; left time: 623.6664s
	iters: 400, epoch: 4 | loss: 0.0021573
	speed: 0.0285s/iter; left time: 542.0813s
Epoch: 4 cost time: 12.624781847000122
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0019594
	speed: 0.0833s/iter; left time: 1574.8260s
	iters: 200, epoch: 5 | loss: 0.0038824
	speed: 0.0366s/iter; left time: 687.3842s
	iters: 300, epoch: 5 | loss: 0.0033942
	speed: 0.0330s/iter; left time: 616.1906s
	iters: 400, epoch: 5 | loss: 0.0000031
	speed: 0.0364s/iter; left time: 677.5492s
Epoch: 5 cost time: 14.05124020576477
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0098889
	speed: 0.0997s/iter; left time: 1843.1251s
	iters: 200, epoch: 6 | loss: 0.0025610
	speed: 0.0276s/iter; left time: 507.2424s
	iters: 300, epoch: 6 | loss: 0.0000047
	speed: 0.0265s/iter; left time: 484.9112s
	iters: 400, epoch: 6 | loss: 0.1409234
	speed: 0.0259s/iter; left time: 471.2942s
Epoch: 6 cost time: 12.268158674240112
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0246021
	speed: 0.0776s/iter; left time: 1403.2736s
	iters: 200, epoch: 7 | loss: 0.0000822
	speed: 0.0281s/iter; left time: 505.6427s
	iters: 300, epoch: 7 | loss: 0.0000008
	speed: 0.0276s/iter; left time: 493.3073s
	iters: 400, epoch: 7 | loss: 0.0000024
	speed: 0.0301s/iter; left time: 535.1459s
Epoch: 7 cost time: 11.783729076385498
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
Validation loss decreased (-0.974078 --> -0.978625).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0443630
	speed: 0.1066s/iter; left time: 1882.4184s
	iters: 200, epoch: 8 | loss: 0.0001721
	speed: 0.0311s/iter; left time: 545.4150s
	iters: 300, epoch: 8 | loss: 1.1444677
	speed: 0.0319s/iter; left time: 557.7920s
	iters: 400, epoch: 8 | loss: 0.0000516
	speed: 0.0325s/iter; left time: 564.3072s
Epoch: 8 cost time: 13.336252689361572
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000016
	speed: 0.1200s/iter; left time: 2070.4872s
	iters: 200, epoch: 9 | loss: 0.0332613
	speed: 0.0300s/iter; left time: 514.8149s
	iters: 300, epoch: 9 | loss: 0.0000005
	speed: 0.0447s/iter; left time: 762.7902s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 515.7555s
Epoch: 9 cost time: 15.14635157585144
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.978 Test Loss: 0.154 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0038084
	speed: 0.1017s/iter; left time: 1712.1936s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 660.9147s
	iters: 300, epoch: 10 | loss: 0.0000019
	speed: 0.0334s/iter; left time: 555.1840s
	iters: 400, epoch: 10 | loss: 0.0000145
	speed: 0.0326s/iter; left time: 538.4461s
Epoch: 10 cost time: 14.14442229270935
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.978625 --> -0.980444).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1140s/iter; left time: 1872.6671s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 380.0711s
	iters: 300, epoch: 11 | loss: 0.0000787
	speed: 0.0266s/iter; left time: 430.7856s
	iters: 400, epoch: 11 | loss: 0.0000003
	speed: 0.0288s/iter; left time: 464.9624s
Epoch: 11 cost time: 11.889776229858398
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0665187
	speed: 0.0930s/iter; left time: 1488.3472s
	iters: 200, epoch: 12 | loss: 0.0000013
	speed: 0.0389s/iter; left time: 618.3172s
	iters: 300, epoch: 12 | loss: 0.0000232
	speed: 0.0360s/iter; left time: 569.1879s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 516.1059s
Epoch: 12 cost time: 14.343123197555542
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.308 Vali Acc: 0.957 Test Loss: 0.308 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0002718
	speed: 0.0912s/iter; left time: 1421.7259s
	iters: 200, epoch: 13 | loss: 0.1914468
	speed: 0.0394s/iter; left time: 610.8530s
	iters: 300, epoch: 13 | loss: 0.0001054
	speed: 0.0272s/iter; left time: 418.5379s
	iters: 400, epoch: 13 | loss: 0.2654356
	speed: 0.0312s/iter; left time: 476.8533s
Epoch: 13 cost time: 13.273998260498047
Epoch: 13, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.968 Test Loss: 0.202 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1009s/iter; left time: 1532.5920s
	iters: 200, epoch: 14 | loss: 0.0000167
	speed: 0.0318s/iter; left time: 479.3106s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 531.2764s
	iters: 400, epoch: 14 | loss: 0.0000007
	speed: 0.0378s/iter; left time: 562.3761s
Epoch: 14 cost time: 14.092421054840088
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.979 Test Loss: 0.165 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.0996s/iter; left time: 1471.0973s
	iters: 200, epoch: 15 | loss: 0.0000128
	speed: 0.0244s/iter; left time: 357.5134s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 457.7429s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0242s/iter; left time: 349.5227s
Epoch: 15 cost time: 12.028971433639526
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.0901s/iter; left time: 1293.0766s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 491.3797s
	iters: 300, epoch: 16 | loss: 0.0000006
	speed: 0.0285s/iter; left time: 403.6073s
	iters: 400, epoch: 16 | loss: 0.0000529
	speed: 0.0347s/iter; left time: 487.8889s
Epoch: 16 cost time: 13.268478393554688
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0398718
	speed: 0.0888s/iter; left time: 1238.2779s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 322.7349s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 377.7640s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 338.2809s
Epoch: 17 cost time: 10.695805072784424
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.181 Vali Acc: 0.980 Test Loss: 0.181 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0011330
	speed: 0.0733s/iter; left time: 991.4098s
	iters: 200, epoch: 18 | loss: 0.0082538
	speed: 0.0246s/iter; left time: 329.9123s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 310.3824s
	iters: 400, epoch: 18 | loss: 0.0000053
	speed: 0.0246s/iter; left time: 326.1150s
Epoch: 18 cost time: 10.491653203964233
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.982 Test Loss: 0.166 Test Acc: 0.982
Validation loss decreased (-0.980444 --> -0.982263).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.0993s/iter; left time: 1301.9106s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 324.6708s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 379.5318s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0256s/iter; left time: 328.4226s
Epoch: 19 cost time: 11.326630353927612
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.981 Test Loss: 0.174 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0928s/iter; left time: 1178.7781s
	iters: 200, epoch: 20 | loss: 0.0302787
	speed: 0.0408s/iter; left time: 514.5580s
	iters: 300, epoch: 20 | loss: 0.0000231
	speed: 0.0412s/iter; left time: 515.0001s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 420.3681s
Epoch: 20 cost time: 15.323134660720825
Epoch: 20, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.979 Test Loss: 0.209 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1178s/iter; left time: 1447.7398s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 401.6420s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 544.6700s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 457.2260s
Epoch: 21 cost time: 16.837091207504272
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000020
	speed: 0.1069s/iter; left time: 1270.1605s
	iters: 200, epoch: 22 | loss: 0.0000004
	speed: 0.0322s/iter; left time: 379.1267s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0259s/iter; left time: 301.9115s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 406.5959s
Epoch: 22 cost time: 14.691081047058105
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.977 Test Loss: 0.208 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000272
	speed: 0.1077s/iter; left time: 1235.3120s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 406.9003s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 346.3957s
	iters: 400, epoch: 23 | loss: 0.0000140
	speed: 0.0363s/iter; left time: 405.3554s
Epoch: 23 cost time: 14.78279972076416
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.977 Test Loss: 0.229 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0982s/iter; left time: 1085.1524s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 380.0100s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 335.3673s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 418.6281s
Epoch: 24 cost time: 13.920815467834473
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1090s/iter; left time: 1159.3028s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 335.6170s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 400.7296s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 364.4174s
Epoch: 25 cost time: 15.22408127784729
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.982 Test Loss: 0.181 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 1016.3520s
	iters: 200, epoch: 26 | loss: 0.0000103
	speed: 0.0403s/iter; left time: 407.6570s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 309.9126s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 322.1753s
Epoch: 26 cost time: 14.390533208847046
Epoch: 26, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.980 Test Loss: 0.231 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0002370
	speed: 0.0857s/iter; left time: 841.0597s
	iters: 200, epoch: 27 | loss: 0.0035078
	speed: 0.0318s/iter; left time: 308.7504s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 306.8447s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0249s/iter; left time: 236.9936s
Epoch: 27 cost time: 13.164427757263184
Epoch: 27, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1047s/iter; left time: 983.7635s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 309.9419s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 290.8355s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 304.4034s
Epoch: 28 cost time: 14.176538467407227
Epoch: 28, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.974 Test Loss: 0.301 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 43765258
model size : 181.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5669529
	speed: 0.0564s/iter; left time: 1158.7677s
	iters: 200, epoch: 1 | loss: 1.5470204
	speed: 0.0485s/iter; left time: 991.1891s
	iters: 300, epoch: 1 | loss: 0.0073584
	speed: 0.0327s/iter; left time: 666.1926s
	iters: 400, epoch: 1 | loss: 0.0006334
	speed: 0.0319s/iter; left time: 645.3715s
Epoch: 1 cost time: 17.444547176361084
Epoch: 1, Steps: 413 | Train Loss: 0.476 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1085545
	speed: 0.1200s/iter; left time: 2416.4385s
	iters: 200, epoch: 2 | loss: 0.0000803
	speed: 0.0424s/iter; left time: 849.2156s
	iters: 300, epoch: 2 | loss: 0.0070790
	speed: 0.0439s/iter; left time: 875.4760s
	iters: 400, epoch: 2 | loss: 0.0015834
	speed: 0.0457s/iter; left time: 906.8003s
Epoch: 2 cost time: 18.298712968826294
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0728150
	speed: 0.1545s/iter; left time: 3047.9315s
	iters: 200, epoch: 3 | loss: 0.0009344
	speed: 0.0633s/iter; left time: 1241.6970s
	iters: 300, epoch: 3 | loss: 0.0000230
	speed: 0.0609s/iter; left time: 1188.6088s
	iters: 400, epoch: 3 | loss: 0.7694935
	speed: 0.0382s/iter; left time: 742.1993s
Epoch: 3 cost time: 21.788755178451538
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.967257 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0019741
	speed: 0.1585s/iter; left time: 3060.0997s
	iters: 200, epoch: 4 | loss: 0.1085359
	speed: 0.0609s/iter; left time: 1170.3923s
	iters: 300, epoch: 4 | loss: 0.0000384
	speed: 0.0555s/iter; left time: 1061.4374s
	iters: 400, epoch: 4 | loss: 0.0005593
	speed: 0.0579s/iter; left time: 1099.8949s
Epoch: 4 cost time: 24.044236660003662
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.976352 --> -0.982718).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0072774
	speed: 0.1645s/iter; left time: 3108.4543s
	iters: 200, epoch: 5 | loss: 0.0002439
	speed: 0.0566s/iter; left time: 1063.8468s
	iters: 300, epoch: 5 | loss: 0.0006716
	speed: 0.0645s/iter; left time: 1206.4002s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 1223.1670s
Epoch: 5 cost time: 25.305532932281494
Epoch: 5, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1418s/iter; left time: 2620.9007s
	iters: 200, epoch: 6 | loss: 0.0006684
	speed: 0.0506s/iter; left time: 930.8757s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 946.3746s
	iters: 400, epoch: 6 | loss: 0.0538865
	speed: 0.0574s/iter; left time: 1044.7506s
Epoch: 6 cost time: 21.96427893638611
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.241 Vali Acc: 0.972 Test Loss: 0.241 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000028
	speed: 0.1455s/iter; left time: 2630.2442s
	iters: 200, epoch: 7 | loss: 0.0014560
	speed: 0.0493s/iter; left time: 885.3659s
	iters: 300, epoch: 7 | loss: 0.6191809
	speed: 0.0486s/iter; left time: 868.1748s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 677.1584s
Epoch: 7 cost time: 19.16347026824951
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.074 Vali Acc: 0.989 Test Loss: 0.074 Test Acc: 0.989
Validation loss decreased (-0.982718 --> -0.988630).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0425950
	speed: 0.1165s/iter; left time: 2056.6226s
	iters: 200, epoch: 8 | loss: 0.0000488
	speed: 0.0354s/iter; left time: 621.3396s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0421s/iter; left time: 734.2640s
	iters: 400, epoch: 8 | loss: 0.0016718
	speed: 0.0468s/iter; left time: 811.8090s
Epoch: 8 cost time: 16.602377891540527
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0006730
	speed: 0.1317s/iter; left time: 2271.6569s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 1048.7110s
	iters: 300, epoch: 9 | loss: 0.4619088
	speed: 0.0445s/iter; left time: 759.3900s
	iters: 400, epoch: 9 | loss: 0.0000036
	speed: 0.0624s/iter; left time: 1057.0090s
Epoch: 9 cost time: 23.832873582839966
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.064 Vali Acc: 0.992 Test Loss: 0.064 Test Acc: 0.992
Validation loss decreased (-0.988630 --> -0.992269).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0003640
	speed: 0.1536s/iter; left time: 2585.1112s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 754.6479s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 830.8249s
	iters: 400, epoch: 10 | loss: 0.0000013
	speed: 0.0437s/iter; left time: 722.1427s
Epoch: 10 cost time: 19.725834608078003
Epoch: 10, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.236 Vali Acc: 0.981 Test Loss: 0.236 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1444s/iter; left time: 2371.3568s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0562s/iter; left time: 917.1282s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 801.0854s
	iters: 400, epoch: 11 | loss: 0.2400382
	speed: 0.0449s/iter; left time: 723.4466s
Epoch: 11 cost time: 20.92197060585022
Epoch: 11, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1557s/iter; left time: 2493.1778s
	iters: 200, epoch: 12 | loss: 0.7939372
	speed: 0.0537s/iter; left time: 854.2575s
	iters: 300, epoch: 12 | loss: 0.0000082
	speed: 0.0502s/iter; left time: 793.6045s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 712.8576s
Epoch: 12 cost time: 21.03295636177063
Epoch: 12, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.982 Test Loss: 0.185 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0019840
	speed: 0.1320s/iter; left time: 2058.0616s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 551.7408s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 524.9995s
	iters: 400, epoch: 13 | loss: 0.0957606
	speed: 0.0377s/iter; left time: 575.9612s
Epoch: 13 cost time: 16.350826263427734
Epoch: 13, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.060 Vali Acc: 0.992 Test Loss: 0.060 Test Acc: 0.992
Validation loss decreased (-0.992269 --> -0.992269).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1255s/iter; left time: 1905.1282s
	iters: 200, epoch: 14 | loss: 0.8589444
	speed: 0.0379s/iter; left time: 571.0579s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 556.7617s
	iters: 400, epoch: 14 | loss: 0.0006173
	speed: 0.0357s/iter; left time: 530.7939s
Epoch: 14 cost time: 15.302563905715942
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.989 Test Loss: 0.126 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1173s/iter; left time: 1732.9433s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 677.1441s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0514s/iter; left time: 749.1482s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 469.3462s
Epoch: 15 cost time: 18.085477352142334
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.989 Test Loss: 0.132 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1388s/iter; left time: 1992.3034s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0724s/iter; left time: 1032.0214s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 955.8796s
	iters: 400, epoch: 16 | loss: 0.0000013
	speed: 0.0641s/iter; left time: 901.6703s
Epoch: 16 cost time: 26.901216506958008
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.079 Vali Acc: 0.993 Test Loss: 0.079 Test Acc: 0.993
Validation loss decreased (-0.992269 --> -0.992723).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1565s/iter; left time: 2181.6881s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 669.7885s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 650.2256s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 832.3827s
Epoch: 17 cost time: 20.84470558166504
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.988 Test Loss: 0.153 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1564s/iter; left time: 2116.5723s
	iters: 200, epoch: 18 | loss: 0.4292931
	speed: 0.0692s/iter; left time: 929.3237s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 854.9225s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 765.2362s
Epoch: 18 cost time: 27.04567813873291
Epoch: 18, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.238 Vali Acc: 0.979 Test Loss: 0.238 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1778s/iter; left time: 2331.7418s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 574.2983s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 841.5397s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 698.2535s
Epoch: 19 cost time: 24.339694023132324
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.987 Test Loss: 0.193 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 1738.5697s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 713.5905s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 680.4016s
	iters: 400, epoch: 20 | loss: 0.0000274
	speed: 0.0589s/iter; left time: 730.1932s
Epoch: 20 cost time: 21.937475442886353
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.988 Test Loss: 0.176 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1599s/iter; left time: 1964.8906s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 503.5632s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 426.3695s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 392.7604s
Epoch: 21 cost time: 17.76688838005066
Epoch: 21, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.197 Vali Acc: 0.986 Test Loss: 0.197 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 1030.2526s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 393.3668s
	iters: 300, epoch: 22 | loss: 0.1673618
	speed: 0.0323s/iter; left time: 377.4147s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 405.4988s
Epoch: 22 cost time: 13.875844240188599
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.066 Vali Acc: 0.993 Test Loss: 0.066 Test Acc: 0.993
Validation loss decreased (-0.992723 --> -0.993178).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1397s/iter; left time: 1601.1255s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 544.5485s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 740.7067s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 651.7831s
Epoch: 23 cost time: 22.531367540359497
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.991 Test Loss: 0.116 Test Acc: 0.991
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1460s/iter; left time: 1613.1448s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 477.8192s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 701.0333s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 467.9156s
Epoch: 24 cost time: 21.965845823287964
Epoch: 24, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.206 Vali Acc: 0.986 Test Loss: 0.206 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1427s/iter; left time: 1517.9306s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 324.2757s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 513.6567s
	iters: 400, epoch: 25 | loss: 0.0000527
	speed: 0.0332s/iter; left time: 343.3640s
Epoch: 25 cost time: 17.297267198562622
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.516 Vali Acc: 0.975 Test Loss: 0.516 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1523s/iter; left time: 1557.7103s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 645.4987s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 582.6587s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 388.7795s
Epoch: 26 cost time: 23.109286308288574
Epoch: 26, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.180 Vali Acc: 0.986 Test Loss: 0.180 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1376s/iter; left time: 1350.6878s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 322.4599s
	iters: 300, epoch: 27 | loss: 0.0088848
	speed: 0.0569s/iter; left time: 547.3559s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 526.5247s
Epoch: 27 cost time: 20.95880389213562
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.979 Test Loss: 0.266 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1577s/iter; left time: 1482.1258s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 580.6447s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 540.3991s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 566.9505s
Epoch: 28 cost time: 25.311305046081543
Epoch: 28, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.978 Test Loss: 0.300 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1651s/iter; left time: 1484.0563s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 333.9665s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 318.5264s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 351.8994s
Epoch: 29 cost time: 17.919617176055908
Epoch: 29, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.981 Test Loss: 0.302 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1232s/iter; left time: 1056.2192s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 309.5461s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 333.3735s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 340.4569s
Epoch: 30 cost time: 17.128701210021973
Epoch: 30, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.324 Vali Acc: 0.978 Test Loss: 0.324 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1311s/iter; left time: 1070.1804s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 542.2394s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 432.9293s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 483.4065s
Epoch: 31 cost time: 25.065057516098022
Epoch: 31, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.984 Test Loss: 0.291 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1447s/iter; left time: 1120.7926s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 377.3637s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 358.2230s
	iters: 400, epoch: 32 | loss: 0.0000003
	speed: 0.0572s/iter; left time: 426.2850s
Epoch: 32 cost time: 20.746296167373657
Epoch: 32, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.323 Vali Acc: 0.982 Test Loss: 0.323 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9931787175989086
model parameter : 43970314
model size : 182.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4986681
	speed: 0.0556s/iter; left time: 1142.1380s
	iters: 200, epoch: 1 | loss: 0.4269973
	speed: 0.0398s/iter; left time: 813.3446s
	iters: 300, epoch: 1 | loss: 0.0096131
	speed: 0.0312s/iter; left time: 635.7801s
	iters: 400, epoch: 1 | loss: 0.0402417
	speed: 0.0404s/iter; left time: 817.5178s
Epoch: 1 cost time: 17.26722002029419
Epoch: 1, Steps: 413 | Train Loss: 0.515 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0235878
	speed: 0.1256s/iter; left time: 2528.3288s
	iters: 200, epoch: 2 | loss: 0.0510599
	speed: 0.0424s/iter; left time: 850.1041s
	iters: 300, epoch: 2 | loss: 0.0009138
	speed: 0.0436s/iter; left time: 869.5238s
	iters: 400, epoch: 2 | loss: 0.0001148
	speed: 0.0351s/iter; left time: 695.9761s
Epoch: 2 cost time: 16.6377375125885
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.980445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0184681
	speed: 0.1415s/iter; left time: 2790.3158s
	iters: 200, epoch: 3 | loss: 0.1816843
	speed: 0.0299s/iter; left time: 585.8184s
	iters: 300, epoch: 3 | loss: 0.0003107
	speed: 0.0312s/iter; left time: 610.0061s
	iters: 400, epoch: 3 | loss: 0.1892636
	speed: 0.0311s/iter; left time: 604.8953s
Epoch: 3 cost time: 13.540853500366211
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1662629
	speed: 0.0940s/iter; left time: 1815.1687s
	iters: 200, epoch: 4 | loss: 0.0007206
	speed: 0.0291s/iter; left time: 559.8453s
	iters: 300, epoch: 4 | loss: 0.0012886
	speed: 0.0311s/iter; left time: 594.2403s
	iters: 400, epoch: 4 | loss: 0.0445934
	speed: 0.0290s/iter; left time: 551.8501s
Epoch: 4 cost time: 12.691807508468628
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0639537
	speed: 0.0887s/iter; left time: 1676.4500s
	iters: 200, epoch: 5 | loss: 0.0000004
	speed: 0.0312s/iter; left time: 585.6810s
	iters: 300, epoch: 5 | loss: 0.1163252
	speed: 0.0294s/iter; left time: 550.3545s
	iters: 400, epoch: 5 | loss: 0.1290443
	speed: 0.0322s/iter; left time: 598.5495s
Epoch: 5 cost time: 12.76879334449768
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4012058
	speed: 0.1299s/iter; left time: 2400.8789s
	iters: 200, epoch: 6 | loss: 0.0000630
	speed: 0.0376s/iter; left time: 691.0058s
	iters: 300, epoch: 6 | loss: 0.0000025
	speed: 0.0303s/iter; left time: 554.3636s
	iters: 400, epoch: 6 | loss: 0.0000004
	speed: 0.0438s/iter; left time: 797.0957s
Epoch: 6 cost time: 16.761962175369263
Epoch: 6, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.980445 --> -0.982718).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0003574
	speed: 0.1445s/iter; left time: 2612.3356s
	iters: 200, epoch: 7 | loss: 0.0000156
	speed: 0.0418s/iter; left time: 751.5172s
	iters: 300, epoch: 7 | loss: 0.0000384
	speed: 0.0452s/iter; left time: 807.1277s
	iters: 400, epoch: 7 | loss: 0.0001940
	speed: 0.0348s/iter; left time: 617.8677s
Epoch: 7 cost time: 16.452254056930542
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001325
	speed: 0.1204s/iter; left time: 2126.5671s
	iters: 200, epoch: 8 | loss: 0.0001153
	speed: 0.0433s/iter; left time: 760.4382s
	iters: 300, epoch: 8 | loss: 0.1850314
	speed: 0.0495s/iter; left time: 863.9954s
	iters: 400, epoch: 8 | loss: 0.0006198
	speed: 0.0321s/iter; left time: 557.8059s
Epoch: 8 cost time: 17.60145902633667
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.967 Test Loss: 0.218 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000139
	speed: 0.0960s/iter; left time: 1654.9887s
	iters: 200, epoch: 9 | loss: 0.0144065
	speed: 0.0488s/iter; left time: 836.2888s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0413s/iter; left time: 703.2808s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0393s/iter; left time: 665.8359s
Epoch: 9 cost time: 16.362996339797974
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000071
	speed: 0.1266s/iter; left time: 2131.6922s
	iters: 200, epoch: 10 | loss: 0.0015437
	speed: 0.0383s/iter; left time: 640.3210s
	iters: 300, epoch: 10 | loss: 0.0000006
	speed: 0.0329s/iter; left time: 547.5262s
	iters: 400, epoch: 10 | loss: 0.0311978
	speed: 0.0411s/iter; left time: 680.3510s
Epoch: 10 cost time: 16.281089782714844
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.320 Vali Acc: 0.967 Test Loss: 0.320 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3124030
	speed: 0.1072s/iter; left time: 1759.7326s
	iters: 200, epoch: 11 | loss: 0.1849851
	speed: 0.0366s/iter; left time: 597.5276s
	iters: 300, epoch: 11 | loss: 0.0270050
	speed: 0.0245s/iter; left time: 397.4249s
	iters: 400, epoch: 11 | loss: 0.0000103
	speed: 0.0289s/iter; left time: 466.5502s
Epoch: 11 cost time: 14.01063847541809
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.167 Vali Acc: 0.979 Test Loss: 0.167 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0433963
	speed: 0.1220s/iter; left time: 1953.0748s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 718.7501s
	iters: 300, epoch: 12 | loss: 0.5068319
	speed: 0.0367s/iter; left time: 579.4968s
	iters: 400, epoch: 12 | loss: 0.0001081
	speed: 0.0405s/iter; left time: 635.4491s
Epoch: 12 cost time: 16.200227975845337
Epoch: 12, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.282 Vali Acc: 0.973 Test Loss: 0.282 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0661556
	speed: 0.1074s/iter; left time: 1674.7170s
	iters: 200, epoch: 13 | loss: 0.0001910
	speed: 0.0452s/iter; left time: 700.9103s
	iters: 300, epoch: 13 | loss: 0.3696193
	speed: 0.0328s/iter; left time: 505.1973s
	iters: 400, epoch: 13 | loss: 0.0016186
	speed: 0.0438s/iter; left time: 670.6465s
Epoch: 13 cost time: 15.613402366638184
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0005354
	speed: 0.1019s/iter; left time: 1547.6120s
	iters: 200, epoch: 14 | loss: 0.0001203
	speed: 0.0373s/iter; left time: 562.4955s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 417.2273s
	iters: 400, epoch: 14 | loss: 0.0000032
	speed: 0.0376s/iter; left time: 559.3531s
Epoch: 14 cost time: 14.426906108856201
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.976 Test Loss: 0.241 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1266s/iter; left time: 1869.9809s
	iters: 200, epoch: 15 | loss: 0.0000549
	speed: 0.0356s/iter; left time: 521.7553s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0488s/iter; left time: 711.4177s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 570.9340s
Epoch: 15 cost time: 17.914134979248047
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.981 Test Loss: 0.199 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1238s/iter; left time: 1777.3282s
	iters: 200, epoch: 16 | loss: 0.0326137
	speed: 0.0309s/iter; left time: 440.8925s
	iters: 300, epoch: 16 | loss: 0.0014411
	speed: 0.0427s/iter; left time: 604.5908s
	iters: 400, epoch: 16 | loss: 0.0000264
	speed: 0.0301s/iter; left time: 423.3285s
Epoch: 16 cost time: 14.722206115722656
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 43841290
model size : 181.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9051329
	speed: 0.0493s/iter; left time: 1012.6231s
	iters: 200, epoch: 1 | loss: 0.0380029
	speed: 0.0430s/iter; left time: 879.8818s
	iters: 300, epoch: 1 | loss: 0.1927786
	speed: 0.0354s/iter; left time: 720.8887s
	iters: 400, epoch: 1 | loss: 0.0436335
	speed: 0.0425s/iter; left time: 860.0411s
Epoch: 1 cost time: 17.48997688293457
Epoch: 1, Steps: 413 | Train Loss: 0.561 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1882240
	speed: 0.1051s/iter; left time: 2117.4411s
	iters: 200, epoch: 2 | loss: 0.0115746
	speed: 0.0376s/iter; left time: 752.6046s
	iters: 300, epoch: 2 | loss: 0.0031658
	speed: 0.0269s/iter; left time: 535.7176s
	iters: 400, epoch: 2 | loss: 0.0004226
	speed: 0.0258s/iter; left time: 511.2894s
Epoch: 2 cost time: 13.026776313781738
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0031721
	speed: 0.0854s/iter; left time: 1684.8652s
	iters: 200, epoch: 3 | loss: 0.0006480
	speed: 0.0282s/iter; left time: 552.9516s
	iters: 300, epoch: 3 | loss: 0.0057609
	speed: 0.0298s/iter; left time: 582.1950s
	iters: 400, epoch: 3 | loss: 0.0030360
	speed: 0.0296s/iter; left time: 574.9941s
Epoch: 3 cost time: 12.267661809921265
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0011140
	speed: 0.0881s/iter; left time: 1700.4436s
	iters: 200, epoch: 4 | loss: 0.0283453
	speed: 0.0258s/iter; left time: 496.2125s
	iters: 300, epoch: 4 | loss: 0.1543436
	speed: 0.0258s/iter; left time: 492.5865s
	iters: 400, epoch: 4 | loss: 0.0001343
	speed: 0.0226s/iter; left time: 429.2901s
Epoch: 4 cost time: 10.684025049209595
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000155
	speed: 0.0728s/iter; left time: 1375.5818s
	iters: 200, epoch: 5 | loss: 0.1863224
	speed: 0.0352s/iter; left time: 662.0553s
	iters: 300, epoch: 5 | loss: 0.0099860
	speed: 0.0267s/iter; left time: 499.1741s
	iters: 400, epoch: 5 | loss: 0.0017947
	speed: 0.0352s/iter; left time: 653.9662s
Epoch: 5 cost time: 13.16588282585144
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000109
	speed: 0.0796s/iter; left time: 1471.6953s
	iters: 200, epoch: 6 | loss: 0.0440332
	speed: 0.0417s/iter; left time: 767.5198s
	iters: 300, epoch: 6 | loss: 0.0002086
	speed: 0.0272s/iter; left time: 497.2016s
	iters: 400, epoch: 6 | loss: 0.0002933
	speed: 0.0245s/iter; left time: 444.7495s
Epoch: 6 cost time: 12.985755443572998
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0436956
	speed: 0.0899s/iter; left time: 1624.1358s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0377s/iter; left time: 677.0730s
	iters: 300, epoch: 7 | loss: 0.0000120
	speed: 0.0403s/iter; left time: 719.6428s
	iters: 400, epoch: 7 | loss: 0.0070280
	speed: 0.0402s/iter; left time: 713.8242s
Epoch: 7 cost time: 17.339783191680908
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.1078s/iter; left time: 1904.4188s
	iters: 200, epoch: 8 | loss: 0.0000005
	speed: 0.0292s/iter; left time: 512.1291s
	iters: 300, epoch: 8 | loss: 0.0002575
	speed: 0.0392s/iter; left time: 685.0602s
	iters: 400, epoch: 8 | loss: 0.0001326
	speed: 0.0306s/iter; left time: 531.5661s
Epoch: 8 cost time: 14.120195865631104
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.968 Test Loss: 0.185 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.0945s/iter; left time: 1630.2321s
	iters: 200, epoch: 9 | loss: 0.0010259
	speed: 0.0405s/iter; left time: 694.3998s
	iters: 300, epoch: 9 | loss: 0.0001117
	speed: 0.0292s/iter; left time: 497.2308s
	iters: 400, epoch: 9 | loss: 0.4980625
	speed: 0.0373s/iter; left time: 631.5757s
Epoch: 9 cost time: 14.435101509094238
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000134
	speed: 0.1011s/iter; left time: 1701.6280s
	iters: 200, epoch: 10 | loss: 0.0000268
	speed: 0.0345s/iter; left time: 577.8253s
	iters: 300, epoch: 10 | loss: 0.1413048
	speed: 0.0398s/iter; left time: 662.0877s
	iters: 400, epoch: 10 | loss: 0.0000045
	speed: 0.0318s/iter; left time: 525.8658s
Epoch: 10 cost time: 14.776160478591919
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.977 Test Loss: 0.219 Test Acc: 0.977
Validation loss decreased (-0.975897 --> -0.976805).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4701913
	speed: 0.1321s/iter; left time: 2169.5141s
	iters: 200, epoch: 11 | loss: 0.0000267
	speed: 0.0289s/iter; left time: 470.8965s
	iters: 300, epoch: 11 | loss: 0.0002520
	speed: 0.0422s/iter; left time: 683.8471s
	iters: 400, epoch: 11 | loss: 0.0027472
	speed: 0.0263s/iter; left time: 424.2472s
Epoch: 11 cost time: 14.877163410186768
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.978 Test Loss: 0.201 Test Acc: 0.978
Validation loss decreased (-0.976805 --> -0.977715).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000024
	speed: 0.1263s/iter; left time: 2021.5808s
	iters: 200, epoch: 12 | loss: 0.0053738
	speed: 0.0279s/iter; left time: 444.1550s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0387s/iter; left time: 611.2816s
	iters: 400, epoch: 12 | loss: 0.0060821
	speed: 0.0272s/iter; left time: 426.8966s
Epoch: 12 cost time: 13.831990718841553
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.223 Vali Acc: 0.971 Test Loss: 0.223 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.0992s/iter; left time: 1547.6731s
	iters: 200, epoch: 13 | loss: 0.0000014
	speed: 0.0290s/iter; left time: 449.3024s
	iters: 300, epoch: 13 | loss: 0.0004365
	speed: 0.0322s/iter; left time: 495.1939s
	iters: 400, epoch: 13 | loss: 0.0000019
	speed: 0.0387s/iter; left time: 592.1639s
Epoch: 13 cost time: 14.601860046386719
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980899).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.1188s/iter; left time: 1803.5935s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0431s/iter; left time: 650.3157s
	iters: 300, epoch: 14 | loss: 0.0002713
	speed: 0.0345s/iter; left time: 516.6040s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 605.6530s
Epoch: 14 cost time: 15.737080812454224
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.160 Vali Acc: 0.980 Test Loss: 0.160 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0282142
	speed: 0.1052s/iter; left time: 1554.2041s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0329s/iter; left time: 482.2350s
	iters: 300, epoch: 15 | loss: 0.0002834
	speed: 0.0332s/iter; left time: 483.5605s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0335s/iter; left time: 484.8077s
Epoch: 15 cost time: 14.073429822921753
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.977 Test Loss: 0.176 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000060
	speed: 0.0972s/iter; left time: 1395.4341s
	iters: 200, epoch: 16 | loss: 0.0056875
	speed: 0.0310s/iter; left time: 441.4503s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0280s/iter; left time: 396.2161s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 385.3165s
Epoch: 16 cost time: 12.574404001235962
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.984 Test Loss: 0.155 Test Acc: 0.984
Validation loss decreased (-0.980899 --> -0.983627).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1012s/iter; left time: 1410.9228s
	iters: 200, epoch: 17 | loss: 0.0000045
	speed: 0.0263s/iter; left time: 363.4369s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 369.3397s
	iters: 400, epoch: 17 | loss: 0.0000130
	speed: 0.0254s/iter; left time: 346.3781s
Epoch: 17 cost time: 11.46153974533081
Epoch: 17, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.977 Test Loss: 0.175 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 1080.8562s
	iters: 200, epoch: 18 | loss: 0.0003228
	speed: 0.0288s/iter; left time: 387.1363s
	iters: 300, epoch: 18 | loss: 0.0000005
	speed: 0.0445s/iter; left time: 592.6537s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 387.7563s
Epoch: 18 cost time: 13.712049961090088
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000085
	speed: 0.1135s/iter; left time: 1488.6760s
	iters: 200, epoch: 19 | loss: 0.0015295
	speed: 0.0380s/iter; left time: 494.5426s
	iters: 300, epoch: 19 | loss: 0.0000438
	speed: 0.0388s/iter; left time: 500.8984s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 427.3693s
Epoch: 19 cost time: 15.393354892730713
Epoch: 19, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0941s/iter; left time: 1195.6861s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0352s/iter; left time: 443.1151s
	iters: 300, epoch: 20 | loss: 0.0000641
	speed: 0.0294s/iter; left time: 367.4637s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 441.9347s
Epoch: 20 cost time: 13.640871047973633
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.403 Vali Acc: 0.968 Test Loss: 0.403 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 1182.0689s
	iters: 200, epoch: 21 | loss: 0.0000005
	speed: 0.0277s/iter; left time: 337.2196s
	iters: 300, epoch: 21 | loss: 0.0046032
	speed: 0.0241s/iter; left time: 291.4901s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 432.6479s
Epoch: 21 cost time: 13.979182481765747
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0001072
	speed: 0.1172s/iter; left time: 1391.7203s
	iters: 200, epoch: 22 | loss: 0.0000003
	speed: 0.0347s/iter; left time: 408.4604s
	iters: 300, epoch: 22 | loss: 0.0806164
	speed: 0.0395s/iter; left time: 461.3755s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 360.4075s
Epoch: 22 cost time: 14.989502906799316
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.986 Test Loss: 0.126 Test Acc: 0.986
Validation loss decreased (-0.983627 --> -0.985901).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1239s/iter; left time: 1420.4136s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 398.9392s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0319s/iter; left time: 359.8077s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 354.2488s
Epoch: 23 cost time: 13.700376272201538
Epoch: 23, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.978 Test Loss: 0.188 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000008
	speed: 0.1257s/iter; left time: 1389.4789s
	iters: 200, epoch: 24 | loss: 0.0000004
	speed: 0.0310s/iter; left time: 339.3842s
	iters: 300, epoch: 24 | loss: 0.0119152
	speed: 0.0317s/iter; left time: 344.5496s
	iters: 400, epoch: 24 | loss: 0.0000829
	speed: 0.0281s/iter; left time: 302.4639s
Epoch: 24 cost time: 14.945093154907227
Epoch: 24, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.981 Test Loss: 0.178 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1032s/iter; left time: 1097.4213s
	iters: 200, epoch: 25 | loss: 0.0000002
	speed: 0.0326s/iter; left time: 343.0811s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 308.1106s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 342.2955s
Epoch: 25 cost time: 13.443973541259766
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.980 Test Loss: 0.190 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 969.4146s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0280s/iter; left time: 283.1048s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0281s/iter; left time: 281.7192s
	iters: 400, epoch: 26 | loss: 0.0000002
	speed: 0.0261s/iter; left time: 258.7076s
Epoch: 26 cost time: 11.896317958831787
Epoch: 26, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.981 Test Loss: 0.200 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000004
	speed: 0.0902s/iter; left time: 884.7617s
	iters: 200, epoch: 27 | loss: 0.0183839
	speed: 0.0260s/iter; left time: 252.2855s
	iters: 300, epoch: 27 | loss: 0.0000098
	speed: 0.0253s/iter; left time: 243.6322s
	iters: 400, epoch: 27 | loss: 0.0061152
	speed: 0.0333s/iter; left time: 317.1620s
Epoch: 27 cost time: 12.32996153831482
Epoch: 27, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.204 Vali Acc: 0.980 Test Loss: 0.204 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000045
	speed: 0.0975s/iter; left time: 916.1725s
	iters: 200, epoch: 28 | loss: 0.0000003
	speed: 0.0278s/iter; left time: 258.8539s
	iters: 300, epoch: 28 | loss: 0.0065512
	speed: 0.0337s/iter; left time: 310.2437s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 309.9366s
Epoch: 28 cost time: 13.43065071105957
Epoch: 28, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.984 Test Loss: 0.187 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.0929s/iter; left time: 834.8146s
	iters: 200, epoch: 29 | loss: 0.0008853
	speed: 0.0297s/iter; left time: 263.9832s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 233.4837s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0263s/iter; left time: 228.1361s
Epoch: 29 cost time: 12.92665433883667
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.976 Test Loss: 0.281 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1162s/iter; left time: 996.5428s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 274.4999s
	iters: 300, epoch: 30 | loss: 0.0000007
	speed: 0.0401s/iter; left time: 336.1048s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 283.5811s
Epoch: 30 cost time: 15.844569444656372
Epoch: 30, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0969s/iter; left time: 791.2082s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0237s/iter; left time: 190.9775s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 185.4035s
	iters: 400, epoch: 31 | loss: 0.0006157
	speed: 0.0378s/iter; left time: 297.4541s
Epoch: 31 cost time: 12.042763471603394
Epoch: 31, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.987 Test Loss: 0.110 Test Acc: 0.987
Validation loss decreased (-0.985901 --> -0.987266).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1286s/iter; left time: 996.0855s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0279s/iter; left time: 213.7583s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 279.2950s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 254.9210s
Epoch: 32 cost time: 14.404267072677612
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.983 Test Loss: 0.208 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1060s/iter; left time: 777.1594s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 244.5589s
	iters: 300, epoch: 33 | loss: 0.0000039
	speed: 0.0344s/iter; left time: 245.4731s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 243.5146s
Epoch: 33 cost time: 14.782789468765259
Epoch: 33, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.980 Test Loss: 0.215 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 647.4103s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 223.6710s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 195.6920s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 225.9243s
Epoch: 34 cost time: 13.362561464309692
Epoch: 34, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.355 Vali Acc: 0.978 Test Loss: 0.355 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 527.2222s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 184.9720s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 166.6170s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 176.8032s
Epoch: 35 cost time: 11.58877968788147
Epoch: 35, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.977 Test Loss: 0.298 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.1944046
	speed: 0.0859s/iter; left time: 523.4055s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 169.9173s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 182.5773s
	iters: 400, epoch: 36 | loss: 0.0000006
	speed: 0.0286s/iter; left time: 165.6924s
Epoch: 36 cost time: 12.246632099151611
Epoch: 36, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.982 Test Loss: 0.201 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 501.0055s
	iters: 200, epoch: 37 | loss: 0.0034007
	speed: 0.0251s/iter; left time: 140.2549s
	iters: 300, epoch: 37 | loss: 0.0008769
	speed: 0.0269s/iter; left time: 147.5677s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 153.8260s
Epoch: 37 cost time: 11.461455345153809
Epoch: 37, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.980 Test Loss: 0.241 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 478.8215s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 132.9759s
	iters: 300, epoch: 38 | loss: 0.0000001
	speed: 0.0306s/iter; left time: 155.1697s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 164.7315s
Epoch: 38 cost time: 12.414836406707764
Epoch: 38, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.989 Test Loss: 0.130 Test Acc: 0.989
Validation loss decreased (-0.987266 --> -0.989085).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0000001
	speed: 0.1104s/iter; left time: 536.3778s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 176.2368s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 121.9373s
	iters: 400, epoch: 39 | loss: 0.0006146
	speed: 0.0238s/iter; left time: 108.6584s
Epoch: 39 cost time: 11.974932670593262
Epoch: 39, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.987 Test Loss: 0.141 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.0940s/iter; left time: 417.7783s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 99.0641s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 139.2352s
	iters: 400, epoch: 40 | loss: 0.0000001
	speed: 0.0348s/iter; left time: 144.1837s
Epoch: 40 cost time: 12.524038076400757
Epoch: 40, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.985 Test Loss: 0.164 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0004561
	speed: 0.0892s/iter; left time: 359.6602s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 104.3839s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0244s/iter; left time: 93.5640s
	iters: 400, epoch: 41 | loss: 0.3928332
	speed: 0.0392s/iter; left time: 146.1407s
Epoch: 41 cost time: 13.476002931594849
Epoch: 41, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.984 Test Loss: 0.196 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1006s/iter; left time: 363.9245s
	iters: 200, epoch: 42 | loss: 0.0000019
	speed: 0.0354s/iter; left time: 124.6449s
	iters: 300, epoch: 42 | loss: 0.0000411
	speed: 0.0331s/iter; left time: 113.1024s
	iters: 400, epoch: 42 | loss: 0.0023908
	speed: 0.0305s/iter; left time: 101.2956s
Epoch: 42 cost time: 14.424073934555054
Epoch: 42, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.978 Test Loss: 0.318 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.1074s/iter; left time: 344.2417s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 91.5231s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 118.8147s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 92.5042s
Epoch: 43 cost time: 15.252338409423828
Epoch: 43, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.980 Test Loss: 0.328 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 286.8842s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 98.8845s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 73.2738s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 61.0315s
Epoch: 44 cost time: 13.016239166259766
Epoch: 44, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.982 Test Loss: 0.259 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 177.8733s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0242s/iter; left time: 55.0585s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 49.8927s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0236s/iter; left time: 49.0385s
Epoch: 45 cost time: 10.188068151473999
Epoch: 45, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.982 Test Loss: 0.298 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.3148301
	speed: 0.0778s/iter; left time: 153.0476s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 42.6895s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 38.8651s
	iters: 400, epoch: 46 | loss: 0.0000008
	speed: 0.0236s/iter; left time: 39.2693s
Epoch: 46 cost time: 9.98257851600647
Epoch: 46, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.983 Test Loss: 0.205 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 108.7241s
	iters: 200, epoch: 47 | loss: 0.0000000
	speed: 0.0226s/iter; left time: 32.8253s
	iters: 300, epoch: 47 | loss: 0.0000000
	speed: 0.0228s/iter; left time: 30.8672s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 33.8750s
Epoch: 47 cost time: 10.466838836669922
Epoch: 47, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.987 Test Loss: 0.203 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.0000000
	speed: 0.1073s/iter; left time: 122.3274s
	iters: 200, epoch: 48 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 28.9590s
	iters: 300, epoch: 48 | loss: 0.0000000
	speed: 0.0229s/iter; left time: 21.4992s
	iters: 400, epoch: 48 | loss: 0.0000000
	speed: 0.0214s/iter; left time: 18.0089s
Epoch: 48 cost time: 12.038470268249512
Epoch: 48, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.985 Test Loss: 0.164 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 43785994
model size : 181.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6310065
	speed: 0.0806s/iter; left time: 1656.6784s
	iters: 200, epoch: 1 | loss: 0.1480064
	speed: 0.0593s/iter; left time: 1213.0162s
	iters: 300, epoch: 1 | loss: 0.0357362
	speed: 0.0470s/iter; left time: 955.7202s
	iters: 400, epoch: 1 | loss: 0.0586815
	speed: 0.0468s/iter; left time: 948.3349s
Epoch: 1 cost time: 23.86647081375122
Epoch: 1, Steps: 413 | Train Loss: 0.507 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1545206
	speed: 0.1587s/iter; left time: 3196.8569s
	iters: 200, epoch: 2 | loss: 0.0745430
	speed: 0.0669s/iter; left time: 1339.9651s
	iters: 300, epoch: 2 | loss: 0.1143066
	speed: 0.0411s/iter; left time: 819.3350s
	iters: 400, epoch: 2 | loss: 0.0004915
	speed: 0.0342s/iter; left time: 678.3523s
Epoch: 2 cost time: 22.414562225341797
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.959980 --> -0.983174).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008315
	speed: 0.1796s/iter; left time: 3543.3063s
	iters: 200, epoch: 3 | loss: 0.0051205
	speed: 0.0677s/iter; left time: 1329.2097s
	iters: 300, epoch: 3 | loss: 0.0030464
	speed: 0.0626s/iter; left time: 1222.7328s
	iters: 400, epoch: 3 | loss: 0.0019569
	speed: 0.0689s/iter; left time: 1338.4389s
Epoch: 3 cost time: 27.960801362991333
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3655295
	speed: 0.1402s/iter; left time: 2707.6910s
	iters: 200, epoch: 4 | loss: 0.0000007
	speed: 0.0498s/iter; left time: 956.2712s
	iters: 300, epoch: 4 | loss: 0.0000132
	speed: 0.0598s/iter; left time: 1142.4215s
	iters: 400, epoch: 4 | loss: 0.0000594
	speed: 0.0594s/iter; left time: 1128.7254s
Epoch: 4 cost time: 20.958226203918457
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0062284
	speed: 0.1577s/iter; left time: 2980.3188s
	iters: 200, epoch: 5 | loss: 0.0000003
	speed: 0.0610s/iter; left time: 1147.5780s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 1041.3214s
	iters: 400, epoch: 5 | loss: 0.0000484
	speed: 0.0545s/iter; left time: 1013.8859s
Epoch: 5 cost time: 24.27849817276001
Epoch: 5, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000004
	speed: 0.1490s/iter; left time: 2754.1695s
	iters: 200, epoch: 6 | loss: 0.0000064
	speed: 0.0368s/iter; left time: 676.2742s
	iters: 300, epoch: 6 | loss: 0.0000092
	speed: 0.0370s/iter; left time: 675.8940s
	iters: 400, epoch: 6 | loss: 0.3537581
	speed: 0.0377s/iter; left time: 685.6342s
Epoch: 6 cost time: 16.49079465866089
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.385 Vali Acc: 0.951 Test Loss: 0.385 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0126418
	speed: 0.1197s/iter; left time: 2162.5746s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 688.3125s
	iters: 300, epoch: 7 | loss: 0.0000043
	speed: 0.0395s/iter; left time: 705.7541s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 689.6559s
Epoch: 7 cost time: 16.45872712135315
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.981 Test Loss: 0.153 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0002411
	speed: 0.1015s/iter; left time: 1792.6719s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 524.7951s
	iters: 300, epoch: 8 | loss: 0.0000023
	speed: 0.0290s/iter; left time: 505.6428s
	iters: 400, epoch: 8 | loss: 0.0000195
	speed: 0.0292s/iter; left time: 506.8249s
Epoch: 8 cost time: 12.854400157928467
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000203
	speed: 0.0898s/iter; left time: 1548.7693s
	iters: 200, epoch: 9 | loss: 0.0000003
	speed: 0.0348s/iter; left time: 596.2347s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0404s/iter; left time: 688.4410s
	iters: 400, epoch: 9 | loss: 0.0000004
	speed: 0.0798s/iter; left time: 1352.1746s
Epoch: 9 cost time: 19.50934886932373
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.169 Vali Acc: 0.983 Test Loss: 0.169 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1941s/iter; left time: 3267.5952s
	iters: 200, epoch: 10 | loss: 0.1367763
	speed: 0.0771s/iter; left time: 1290.7524s
	iters: 300, epoch: 10 | loss: 0.0000201
	speed: 0.0433s/iter; left time: 720.7466s
	iters: 400, epoch: 10 | loss: 0.0030934
	speed: 0.0709s/iter; left time: 1172.3552s
Epoch: 10 cost time: 28.396756649017334
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.177 Vali Acc: 0.983 Test Loss: 0.177 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1829s/iter; left time: 3004.1154s
	iters: 200, epoch: 11 | loss: 0.0004037
	speed: 0.0744s/iter; left time: 1213.4825s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 922.9913s
	iters: 400, epoch: 11 | loss: 0.0000399
	speed: 0.0374s/iter; left time: 603.0420s
Epoch: 11 cost time: 25.44314193725586
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.987 Test Loss: 0.157 Test Acc: 0.987
Validation loss decreased (-0.983174 --> -0.986811).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001559
	speed: 0.1716s/iter; left time: 2746.5048s
	iters: 200, epoch: 12 | loss: 0.0000830
	speed: 0.0650s/iter; left time: 1033.5489s
	iters: 300, epoch: 12 | loss: 0.0019159
	speed: 0.0645s/iter; left time: 1018.9210s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0661s/iter; left time: 1038.6067s
Epoch: 12 cost time: 27.1885027885437
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.231 Vali Acc: 0.978 Test Loss: 0.231 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0016347
	speed: 0.1580s/iter; left time: 2463.7830s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 1041.7479s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 901.9054s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 853.5747s
Epoch: 13 cost time: 26.304789543151855
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.275 Vali Acc: 0.978 Test Loss: 0.275 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0002177
	speed: 0.1570s/iter; left time: 2383.7493s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 532.7165s
	iters: 300, epoch: 14 | loss: 0.0000011
	speed: 0.0349s/iter; left time: 523.0907s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 478.9675s
Epoch: 14 cost time: 15.053647994995117
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.179 Vali Acc: 0.982 Test Loss: 0.179 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.0873s/iter; left time: 1289.5533s
	iters: 200, epoch: 15 | loss: 0.8500909
	speed: 0.0284s/iter; left time: 416.2125s
	iters: 300, epoch: 15 | loss: 1.4297996
	speed: 0.0325s/iter; left time: 473.5814s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 456.5358s
Epoch: 15 cost time: 12.765472173690796
Epoch: 15, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.201 Vali Acc: 0.985 Test Loss: 0.201 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 1310.1701s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 433.9206s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 454.6290s
	iters: 400, epoch: 16 | loss: 0.0000338
	speed: 0.0596s/iter; left time: 837.5894s
Epoch: 16 cost time: 16.123268604278564
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.989 Test Loss: 0.110 Test Acc: 0.989
Validation loss decreased (-0.986811 --> -0.989085).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0007972
	speed: 0.1391s/iter; left time: 1939.7165s
	iters: 200, epoch: 17 | loss: 0.0005174
	speed: 0.0604s/iter; left time: 836.7727s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 501.2425s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 443.9074s
Epoch: 17 cost time: 16.856627702713013
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.986 Test Loss: 0.199 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1270s/iter; left time: 1718.0367s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 783.2697s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 762.7307s
	iters: 400, epoch: 18 | loss: 0.0000024
	speed: 0.0526s/iter; left time: 695.7730s
Epoch: 18 cost time: 21.68753719329834
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.250 Vali Acc: 0.977 Test Loss: 0.250 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1126s/iter; left time: 1476.8615s
	iters: 200, epoch: 19 | loss: 0.0000040
	speed: 0.0712s/iter; left time: 927.1886s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 484.8003s
	iters: 400, epoch: 19 | loss: 0.0000004
	speed: 0.0539s/iter; left time: 690.9234s
Epoch: 19 cost time: 21.281967401504517
Epoch: 19, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.263 Vali Acc: 0.981 Test Loss: 0.263 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.1877s/iter; left time: 2384.3819s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 542.3152s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 361.6740s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 714.2997s
Epoch: 20 cost time: 20.989676475524902
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.985 Test Loss: 0.163 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1520s/iter; left time: 1868.5693s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 768.8331s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 570.8175s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 674.4152s
Epoch: 21 cost time: 23.949277877807617
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.984 Test Loss: 0.236 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1250s/iter; left time: 1485.1359s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 796.5803s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 799.1876s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 795.2151s
Epoch: 22 cost time: 27.29551410675049
Epoch: 22, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.230 Vali Acc: 0.982 Test Loss: 0.230 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1455s/iter; left time: 1668.1873s
	iters: 200, epoch: 23 | loss: 0.0000008
	speed: 0.0442s/iter; left time: 502.1480s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 620.4368s
	iters: 400, epoch: 23 | loss: 0.0085505
	speed: 0.0619s/iter; left time: 691.1685s
Epoch: 23 cost time: 22.694149255752563
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.630 Vali Acc: 0.969 Test Loss: 0.630 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1448s/iter; left time: 1599.8106s
	iters: 200, epoch: 24 | loss: 0.0022966
	speed: 0.0330s/iter; left time: 361.0062s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 362.3313s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 340.7178s
Epoch: 24 cost time: 16.91214108467102
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.986 Test Loss: 0.280 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.0989s/iter; left time: 1051.9219s
	iters: 200, epoch: 25 | loss: 0.0032057
	speed: 0.0334s/iter; left time: 352.0960s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 339.2575s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 322.0454s
Epoch: 25 cost time: 13.748759269714355
Epoch: 25, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.237 Vali Acc: 0.987 Test Loss: 0.237 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 923.6744s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 293.9610s
	iters: 300, epoch: 26 | loss: 0.0000009
	speed: 0.0288s/iter; left time: 288.5272s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 285.9670s
Epoch: 26 cost time: 12.30450439453125
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.681 Vali Acc: 0.979 Test Loss: 0.681 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 44000266
model size : 182.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7597815
	speed: 0.0509s/iter; left time: 1045.1313s
	iters: 200, epoch: 1 | loss: 0.1388287
	speed: 0.0306s/iter; left time: 625.4853s
	iters: 300, epoch: 1 | loss: 0.0510225
	speed: 0.0551s/iter; left time: 1121.4587s
	iters: 400, epoch: 1 | loss: 0.1990259
	speed: 0.0318s/iter; left time: 644.0598s
Epoch: 1 cost time: 17.279082775115967
Epoch: 1, Steps: 413 | Train Loss: 0.524 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0373902
	speed: 0.1157s/iter; left time: 2329.5049s
	iters: 200, epoch: 2 | loss: 0.1571714
	speed: 0.0289s/iter; left time: 579.6492s
	iters: 300, epoch: 2 | loss: 0.0017966
	speed: 0.0442s/iter; left time: 881.6180s
	iters: 400, epoch: 2 | loss: 0.0284861
	speed: 0.0251s/iter; left time: 498.5151s
Epoch: 2 cost time: 13.455603122711182
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.055 Vali Acc: 0.981 Test Loss: 0.055 Test Acc: 0.981
Validation loss decreased (-0.971350 --> -0.980900).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000236
	speed: 0.1530s/iter; left time: 3017.7537s
	iters: 200, epoch: 3 | loss: 0.0935485
	speed: 0.0263s/iter; left time: 516.7610s
	iters: 300, epoch: 3 | loss: 0.0934271
	speed: 0.0259s/iter; left time: 504.8563s
	iters: 400, epoch: 3 | loss: 0.0028300
	speed: 0.0520s/iter; left time: 1009.4573s
Epoch: 3 cost time: 16.025043725967407
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1971080
	speed: 0.1286s/iter; left time: 2483.5194s
	iters: 200, epoch: 4 | loss: 0.0043208
	speed: 0.0353s/iter; left time: 677.5252s
	iters: 300, epoch: 4 | loss: 0.0000114
	speed: 0.0520s/iter; left time: 994.2427s
	iters: 400, epoch: 4 | loss: 0.0000032
	speed: 0.0328s/iter; left time: 624.4789s
Epoch: 4 cost time: 17.62664771080017
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000315
	speed: 0.1431s/iter; left time: 2704.4819s
	iters: 200, epoch: 5 | loss: 0.0057035
	speed: 0.0310s/iter; left time: 582.9663s
	iters: 300, epoch: 5 | loss: 0.0000084
	speed: 0.0461s/iter; left time: 861.4109s
	iters: 400, epoch: 5 | loss: 0.0077004
	speed: 0.0293s/iter; left time: 545.0117s
Epoch: 5 cost time: 15.6597740650177
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0010522
	speed: 0.0954s/iter; left time: 1764.0046s
	iters: 200, epoch: 6 | loss: 1.0496604
	speed: 0.0482s/iter; left time: 886.9737s
	iters: 300, epoch: 6 | loss: 0.0000321
	speed: 0.0272s/iter; left time: 496.5103s
	iters: 400, epoch: 6 | loss: 0.0000248
	speed: 0.0248s/iter; left time: 451.3895s
Epoch: 6 cost time: 13.18658709526062
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0006326
	speed: 0.1221s/iter; left time: 2206.6516s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0336s/iter; left time: 603.3891s
	iters: 300, epoch: 7 | loss: 0.0000016
	speed: 0.0458s/iter; left time: 817.9113s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0348s/iter; left time: 618.5864s
Epoch: 7 cost time: 17.44264316558838
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000023
	speed: 0.1151s/iter; left time: 2032.7886s
	iters: 200, epoch: 8 | loss: 0.0027712
	speed: 0.0509s/iter; left time: 893.5137s
	iters: 300, epoch: 8 | loss: 0.0000129
	speed: 0.0315s/iter; left time: 549.5633s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 815.1838s
Epoch: 8 cost time: 16.928155660629272
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.1118s/iter; left time: 1927.7831s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 596.5330s
	iters: 300, epoch: 9 | loss: 0.0002869
	speed: 0.0540s/iter; left time: 920.0401s
	iters: 400, epoch: 9 | loss: 0.0978878
	speed: 0.0288s/iter; left time: 488.4297s
Epoch: 9 cost time: 16.622782468795776
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.984083).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000011
	speed: 0.1000s/iter; left time: 1683.0305s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0275s/iter; left time: 460.9550s
	iters: 300, epoch: 10 | loss: 0.0000045
	speed: 0.0267s/iter; left time: 444.2300s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0277s/iter; left time: 458.4858s
Epoch: 10 cost time: 11.590508460998535
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.402 Vali Acc: 0.968 Test Loss: 0.402 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000076
	speed: 0.0782s/iter; left time: 1284.2439s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0271s/iter; left time: 442.4146s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 469.4366s
	iters: 400, epoch: 11 | loss: 0.0000119
	speed: 0.0253s/iter; left time: 407.1805s
Epoch: 11 cost time: 11.520715713500977
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000061
	speed: 0.0784s/iter; left time: 1254.6130s
	iters: 200, epoch: 12 | loss: 0.0000126
	speed: 0.0245s/iter; left time: 390.1263s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 392.5114s
	iters: 400, epoch: 12 | loss: 0.8908946
	speed: 0.0252s/iter; left time: 396.4746s
Epoch: 12 cost time: 10.601160049438477
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.982 Test Loss: 0.173 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000079
	speed: 0.0902s/iter; left time: 1407.3228s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 503.0313s
	iters: 300, epoch: 13 | loss: 0.0000006
	speed: 0.0346s/iter; left time: 532.8462s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 456.0119s
Epoch: 13 cost time: 14.036351442337036
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 1516.8461s
	iters: 200, epoch: 14 | loss: 0.0000605
	speed: 0.0329s/iter; left time: 496.2173s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 490.0176s
	iters: 400, epoch: 14 | loss: 0.0000004
	speed: 0.0356s/iter; left time: 529.0622s
Epoch: 14 cost time: 14.449128150939941
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.985447).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1300s/iter; left time: 1920.0812s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 466.6838s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 488.7746s
	iters: 400, epoch: 15 | loss: 0.0000493
	speed: 0.0310s/iter; left time: 448.4469s
Epoch: 15 cost time: 14.25093698501587
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.989 Test Loss: 0.101 Test Acc: 0.989
Validation loss decreased (-0.985447 --> -0.989085).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1157s/iter; left time: 1660.2758s
	iters: 200, epoch: 16 | loss: 0.0000012
	speed: 0.0304s/iter; left time: 433.2144s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 495.8306s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 495.3079s
Epoch: 16 cost time: 14.310674905776978
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0006703
	speed: 0.1000s/iter; left time: 1394.0019s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 371.4400s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0340s/iter; left time: 467.8098s
	iters: 400, epoch: 17 | loss: 0.0000011
	speed: 0.0340s/iter; left time: 464.3465s
Epoch: 17 cost time: 13.737074613571167
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.981 Test Loss: 0.197 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1012s/iter; left time: 1368.8822s
	iters: 200, epoch: 18 | loss: 0.0000041
	speed: 0.0280s/iter; left time: 376.6333s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0248s/iter; left time: 330.8959s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 349.5905s
Epoch: 18 cost time: 12.181703567504883
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.991 Test Loss: 0.074 Test Acc: 0.991
Validation loss decreased (-0.989085 --> -0.990904).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000021
	speed: 0.1055s/iter; left time: 1383.4896s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0245s/iter; left time: 319.2079s
	iters: 300, epoch: 19 | loss: 0.0000524
	speed: 0.0272s/iter; left time: 351.2369s
	iters: 400, epoch: 19 | loss: 0.0000157
	speed: 0.0250s/iter; left time: 320.0871s
Epoch: 19 cost time: 10.772656440734863
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.144 Vali Acc: 0.982 Test Loss: 0.144 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.0782s/iter; left time: 992.8639s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 391.8053s
	iters: 300, epoch: 20 | loss: 0.0006672
	speed: 0.0364s/iter; left time: 455.5950s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 374.7988s
Epoch: 20 cost time: 13.75744891166687
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.0982s/iter; left time: 1206.6599s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 423.3427s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 460.3937s
	iters: 400, epoch: 21 | loss: 0.3243866
	speed: 0.0353s/iter; left time: 423.0560s
Epoch: 21 cost time: 14.534650564193726
Epoch: 21, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.988 Test Loss: 0.096 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0001414
	speed: 0.0955s/iter; left time: 1134.3184s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0352s/iter; left time: 415.0801s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 430.0732s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 374.9861s
Epoch: 22 cost time: 14.5178701877594
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.987 Test Loss: 0.148 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0985s/iter; left time: 1129.8285s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 424.8525s
	iters: 300, epoch: 23 | loss: 0.0000005
	speed: 0.0363s/iter; left time: 408.5238s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 414.5752s
Epoch: 23 cost time: 14.746438026428223
Epoch: 23, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.986 Test Loss: 0.111 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1053s/iter; left time: 1163.6714s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 376.2997s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 343.0984s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 344.2110s
Epoch: 24 cost time: 13.7970609664917
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.991 Test Loss: 0.113 Test Acc: 0.991
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000112
	speed: 0.0929s/iter; left time: 988.6049s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0258s/iter; left time: 271.7295s
	iters: 300, epoch: 25 | loss: 0.0000009
	speed: 0.0250s/iter; left time: 261.2451s
	iters: 400, epoch: 25 | loss: 0.0000052
	speed: 0.0246s/iter; left time: 253.9121s
Epoch: 25 cost time: 11.261118412017822
Epoch: 25, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.983 Test Loss: 0.169 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 775.8147s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 256.3640s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0241s/iter; left time: 241.6221s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0235s/iter; left time: 233.4445s
Epoch: 26 cost time: 10.701731443405151
Epoch: 26, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.982 Test Loss: 0.224 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000003
	speed: 0.1082s/iter; left time: 1062.1527s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 478.8952s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 473.9507s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 538.5632s
Epoch: 27 cost time: 21.255711555480957
Epoch: 27, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.983 Test Loss: 0.169 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1790s/iter; left time: 1682.7743s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 439.1689s
	iters: 300, epoch: 28 | loss: 0.0000003
	speed: 0.0586s/iter; left time: 538.8066s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 470.1889s
Epoch: 28 cost time: 22.77808666229248
Epoch: 28, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.988 Test Loss: 0.090 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 43871242
model size : 182.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7571515
	speed: 0.0605s/iter; left time: 1242.8378s
	iters: 200, epoch: 1 | loss: 0.0584983
	speed: 0.0378s/iter; left time: 773.9773s
	iters: 300, epoch: 1 | loss: 0.0199929
	speed: 0.0346s/iter; left time: 703.4169s
	iters: 400, epoch: 1 | loss: 0.8445999
	speed: 0.0431s/iter; left time: 872.4923s
Epoch: 1 cost time: 18.160640239715576
Epoch: 1, Steps: 413 | Train Loss: 0.561 Vali Loss: 0.197 Vali Acc: 0.934 Test Loss: 0.197 Test Acc: 0.934
Validation loss decreased (inf --> -0.934059).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0154157
	speed: 0.1200s/iter; left time: 2416.0004s
	iters: 200, epoch: 2 | loss: 0.0464330
	speed: 0.0376s/iter; left time: 752.5252s
	iters: 300, epoch: 2 | loss: 0.1376392
	speed: 0.0338s/iter; left time: 673.7715s
	iters: 400, epoch: 2 | loss: 0.2428181
	speed: 0.0349s/iter; left time: 691.4635s
Epoch: 2 cost time: 15.394420146942139
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.934059 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0042385
	speed: 0.1318s/iter; left time: 2600.1870s
	iters: 200, epoch: 3 | loss: 0.0274275
	speed: 0.0337s/iter; left time: 660.5059s
	iters: 300, epoch: 3 | loss: 0.0003869
	speed: 0.0333s/iter; left time: 649.9146s
	iters: 400, epoch: 3 | loss: 0.0011312
	speed: 0.0352s/iter; left time: 684.4080s
Epoch: 3 cost time: 14.687093257904053
Epoch: 3, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.968166 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0006313
	speed: 0.1417s/iter; left time: 2737.4628s
	iters: 200, epoch: 4 | loss: 0.0004879
	speed: 0.0425s/iter; left time: 816.6771s
	iters: 300, epoch: 4 | loss: 0.0112326
	speed: 0.0420s/iter; left time: 803.1371s
	iters: 400, epoch: 4 | loss: 0.0007471
	speed: 0.0440s/iter; left time: 836.6031s
Epoch: 4 cost time: 17.749475955963135
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0015460
	speed: 0.1177s/iter; left time: 2224.8450s
	iters: 200, epoch: 5 | loss: 0.0000090
	speed: 0.0422s/iter; left time: 794.0897s
	iters: 300, epoch: 5 | loss: 0.0016472
	speed: 0.0547s/iter; left time: 1023.7202s
	iters: 400, epoch: 5 | loss: 0.0252462
	speed: 0.0552s/iter; left time: 1025.8702s
Epoch: 5 cost time: 19.88075828552246
Epoch: 5, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0051194
	speed: 0.1487s/iter; left time: 2749.3883s
	iters: 200, epoch: 6 | loss: 0.0013177
	speed: 0.0576s/iter; left time: 1059.8930s
	iters: 300, epoch: 6 | loss: 0.0001721
	speed: 0.0494s/iter; left time: 902.7205s
	iters: 400, epoch: 6 | loss: 0.0026943
	speed: 0.0580s/iter; left time: 1054.4725s
Epoch: 6 cost time: 23.15272307395935
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2409170
	speed: 0.1411s/iter; left time: 2550.7640s
	iters: 200, epoch: 7 | loss: 0.0000021
	speed: 0.0509s/iter; left time: 914.6561s
	iters: 300, epoch: 7 | loss: 0.0001033
	speed: 0.0571s/iter; left time: 1020.5016s
	iters: 400, epoch: 7 | loss: 0.0129892
	speed: 0.0584s/iter; left time: 1037.2316s
Epoch: 7 cost time: 22.42998719215393
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.198 Vali Acc: 0.974 Test Loss: 0.198 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0003275
	speed: 0.1595s/iter; left time: 2817.4064s
	iters: 200, epoch: 8 | loss: 0.0010929
	speed: 0.0455s/iter; left time: 799.0117s
	iters: 300, epoch: 8 | loss: 0.0000018
	speed: 0.0511s/iter; left time: 891.8729s
	iters: 400, epoch: 8 | loss: 0.0000021
	speed: 0.0450s/iter; left time: 781.7243s
Epoch: 8 cost time: 21.212822675704956
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000332
	speed: 0.1463s/iter; left time: 2523.8333s
	iters: 200, epoch: 9 | loss: 0.0002547
	speed: 0.0500s/iter; left time: 857.3548s
	iters: 300, epoch: 9 | loss: 0.0000360
	speed: 0.0515s/iter; left time: 877.1057s
	iters: 400, epoch: 9 | loss: 0.0003281
	speed: 0.0527s/iter; left time: 893.2347s
Epoch: 9 cost time: 21.379533052444458
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0042316
	speed: 0.1449s/iter; left time: 2438.6686s
	iters: 200, epoch: 10 | loss: 0.0000011
	speed: 0.0538s/iter; left time: 900.4303s
	iters: 300, epoch: 10 | loss: 0.0003142
	speed: 0.0526s/iter; left time: 874.8086s
	iters: 400, epoch: 10 | loss: 0.0000042
	speed: 0.0556s/iter; left time: 918.9690s
Epoch: 10 cost time: 22.70961022377014
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
Validation loss decreased (-0.976807 --> -0.978625).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000044
	speed: 0.1566s/iter; left time: 2571.3824s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0537s/iter; left time: 877.1593s
	iters: 300, epoch: 11 | loss: 0.0000058
	speed: 0.0454s/iter; left time: 736.9660s
	iters: 400, epoch: 11 | loss: 0.0030577
	speed: 0.0413s/iter; left time: 666.3132s
Epoch: 11 cost time: 19.978028059005737
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.966 Test Loss: 0.248 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000218
	speed: 0.1289s/iter; left time: 2062.9265s
	iters: 200, epoch: 12 | loss: 0.0000027
	speed: 0.0394s/iter; left time: 627.3854s
	iters: 300, epoch: 12 | loss: 0.0000180
	speed: 0.0387s/iter; left time: 611.9242s
	iters: 400, epoch: 12 | loss: 0.0000027
	speed: 0.0423s/iter; left time: 663.9207s
Epoch: 12 cost time: 17.04527258872986
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.978625 --> -0.980445).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0674079
	speed: 0.1496s/iter; left time: 2332.2744s
	iters: 200, epoch: 13 | loss: 0.0016159
	speed: 0.0401s/iter; left time: 621.1076s
	iters: 300, epoch: 13 | loss: 0.0000037
	speed: 0.0408s/iter; left time: 627.7619s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0416s/iter; left time: 636.8030s
Epoch: 13 cost time: 17.413808822631836
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.963 Test Loss: 0.295 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002388
	speed: 0.1328s/iter; left time: 2015.9094s
	iters: 200, epoch: 14 | loss: 0.0005906
	speed: 0.0416s/iter; left time: 627.1053s
	iters: 300, epoch: 14 | loss: 0.0011036
	speed: 0.0512s/iter; left time: 767.3729s
	iters: 400, epoch: 14 | loss: 0.0027468
	speed: 0.0520s/iter; left time: 773.5270s
Epoch: 14 cost time: 19.99566149711609
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1400s/iter; left time: 2067.5533s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0489s/iter; left time: 717.1871s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 741.0378s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 741.0758s
Epoch: 15 cost time: 20.579723834991455
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.1454s/iter; left time: 2087.5499s
	iters: 200, epoch: 16 | loss: 0.0000055
	speed: 0.0517s/iter; left time: 737.3609s
	iters: 300, epoch: 16 | loss: 0.0000208
	speed: 0.0511s/iter; left time: 722.6850s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 671.8228s
Epoch: 16 cost time: 21.38982582092285
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.1425s/iter; left time: 1986.2244s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 679.5130s
	iters: 300, epoch: 17 | loss: 0.0000005
	speed: 0.0519s/iter; left time: 712.6997s
	iters: 400, epoch: 17 | loss: 0.0025779
	speed: 0.0525s/iter; left time: 716.3870s
Epoch: 17 cost time: 21.203439235687256
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.397 Vali Acc: 0.955 Test Loss: 0.397 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000109
	speed: 0.1510s/iter; left time: 2042.7619s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 763.5498s
	iters: 300, epoch: 18 | loss: 0.3982190
	speed: 0.0552s/iter; left time: 735.6515s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.0539s/iter; left time: 713.4160s
Epoch: 18 cost time: 23.427905321121216
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.979 Test Loss: 0.149 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1447s/iter; left time: 1897.8539s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 708.8367s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 645.4263s
	iters: 400, epoch: 19 | loss: 0.0000072
	speed: 0.0570s/iter; left time: 729.9379s
Epoch: 19 cost time: 22.035666942596436
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0001265
	speed: 0.1413s/iter; left time: 1795.4036s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0458s/iter; left time: 577.2959s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 531.0973s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 571.3484s
Epoch: 20 cost time: 19.272964000701904
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1224s/iter; left time: 1504.8467s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 489.2594s
	iters: 300, epoch: 21 | loss: 0.0000145
	speed: 0.0403s/iter; left time: 487.3041s
	iters: 400, epoch: 21 | loss: 0.0000010
	speed: 0.0405s/iter; left time: 485.2042s
Epoch: 21 cost time: 17.18376612663269
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1326s/iter; left time: 1574.6461s
	iters: 200, epoch: 22 | loss: 0.0000608
	speed: 0.0468s/iter; left time: 551.7732s
	iters: 300, epoch: 22 | loss: 0.0000136
	speed: 0.0474s/iter; left time: 553.1231s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 563.6402s
Epoch: 22 cost time: 19.302971601486206
Epoch: 22, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 43806730
model size : 181.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1728884
	speed: 0.1074s/iter; left time: 2206.2986s
	iters: 200, epoch: 1 | loss: 0.2622611
	speed: 0.0927s/iter; left time: 1895.9471s
	iters: 300, epoch: 1 | loss: 0.1478072
	speed: 0.0789s/iter; left time: 1606.6748s
	iters: 400, epoch: 1 | loss: 0.0419939
	speed: 0.1015s/iter; left time: 2056.2848s
Epoch: 1 cost time: 39.63479495048523
Epoch: 1, Steps: 413 | Train Loss: 0.496 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0270388
	speed: 0.2260s/iter; left time: 4552.0702s
	iters: 200, epoch: 2 | loss: 0.0954050
	speed: 0.0996s/iter; left time: 1996.6491s
	iters: 300, epoch: 2 | loss: 0.0029849
	speed: 0.0995s/iter; left time: 1983.4548s
	iters: 400, epoch: 2 | loss: 0.0001621
	speed: 0.0727s/iter; left time: 1442.1089s
Epoch: 2 cost time: 36.67163610458374
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0173802
	speed: 0.2561s/iter; left time: 5052.0205s
	iters: 200, epoch: 3 | loss: 0.0025472
	speed: 0.1029s/iter; left time: 2018.8229s
	iters: 300, epoch: 3 | loss: 0.2215863
	speed: 0.1135s/iter; left time: 2216.2205s
	iters: 400, epoch: 3 | loss: 0.0000324
	speed: 0.1023s/iter; left time: 1987.6484s
Epoch: 3 cost time: 43.958898067474365
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003642
	speed: 0.2828s/iter; left time: 5462.0745s
	iters: 200, epoch: 4 | loss: 0.0000085
	speed: 0.1199s/iter; left time: 2304.2805s
	iters: 300, epoch: 4 | loss: 0.0000514
	speed: 0.0869s/iter; left time: 1661.4973s
	iters: 400, epoch: 4 | loss: 0.0107098
	speed: 0.0921s/iter; left time: 1750.3356s
Epoch: 4 cost time: 42.55042290687561
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2478920
	speed: 0.2348s/iter; left time: 4437.6552s
	iters: 200, epoch: 5 | loss: 0.0000072
	speed: 0.0886s/iter; left time: 1665.4930s
	iters: 300, epoch: 5 | loss: 0.0000059
	speed: 0.0795s/iter; left time: 1486.5800s
	iters: 400, epoch: 5 | loss: 0.0000553
	speed: 0.0795s/iter; left time: 1478.5684s
Epoch: 5 cost time: 35.708738803863525
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003978
	speed: 0.2661s/iter; left time: 4918.8210s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.1022s/iter; left time: 1878.6700s
	iters: 300, epoch: 6 | loss: 0.0000038
	speed: 0.1056s/iter; left time: 1931.8976s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.1115s/iter; left time: 2028.1210s
Epoch: 6 cost time: 44.179290533065796
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001340
	speed: 0.3215s/iter; left time: 5811.3527s
	iters: 200, epoch: 7 | loss: 0.0557549
	speed: 0.1373s/iter; left time: 2467.1723s
	iters: 300, epoch: 7 | loss: 0.1904212
	speed: 0.1379s/iter; left time: 2463.8099s
	iters: 400, epoch: 7 | loss: 0.0016988
	speed: 0.1368s/iter; left time: 2431.9444s
Epoch: 7 cost time: 56.6652135848999
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001188
	speed: 0.2975s/iter; left time: 5254.4216s
	iters: 200, epoch: 8 | loss: 0.0000160
	speed: 0.1143s/iter; left time: 2007.8882s
	iters: 300, epoch: 8 | loss: 0.0131184
	speed: 0.1416s/iter; left time: 2471.8341s
	iters: 400, epoch: 8 | loss: 0.0000006
	speed: 0.1212s/iter; left time: 2104.3706s
Epoch: 8 cost time: 51.44965744018555
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.979 Test Loss: 0.190 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000148
	speed: 0.3095s/iter; left time: 5337.5400s
	iters: 200, epoch: 9 | loss: 0.0001013
	speed: 0.1247s/iter; left time: 2139.0004s
	iters: 300, epoch: 9 | loss: 0.0000011
	speed: 0.1306s/iter; left time: 2227.1509s
	iters: 400, epoch: 9 | loss: 0.0001558
	speed: 0.1385s/iter; left time: 2347.7649s
Epoch: 9 cost time: 53.8514289855957
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3287s/iter; left time: 5533.5083s
	iters: 200, epoch: 10 | loss: 0.0924980
	speed: 0.1555s/iter; left time: 2601.7274s
	iters: 300, epoch: 10 | loss: 0.0011275
	speed: 0.1171s/iter; left time: 1948.2889s
	iters: 400, epoch: 10 | loss: 0.1383927
	speed: 0.1141s/iter; left time: 1885.9187s
Epoch: 10 cost time: 53.88349533081055
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.213 Vali Acc: 0.980 Test Loss: 0.213 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2700s/iter; left time: 4433.2103s
	iters: 200, epoch: 11 | loss: 0.0378174
	speed: 0.1092s/iter; left time: 1781.5964s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1186s/iter; left time: 1924.4698s
	iters: 400, epoch: 11 | loss: 0.0772129
	speed: 0.1219s/iter; left time: 1964.6758s
Epoch: 11 cost time: 48.52059507369995
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.986 Test Loss: 0.086 Test Acc: 0.986
Validation loss decreased (-0.979535 --> -0.986357).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004757
	speed: 0.3219s/iter; left time: 5153.1083s
	iters: 200, epoch: 12 | loss: 0.0039549
	speed: 0.1105s/iter; left time: 1758.4899s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 2084.5901s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1243s/iter; left time: 1953.2883s
Epoch: 12 cost time: 50.11758065223694
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.979 Test Loss: 0.197 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000189
	speed: 0.3150s/iter; left time: 4912.9669s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1215s/iter; left time: 1883.1170s
	iters: 300, epoch: 13 | loss: 0.2534435
	speed: 0.1074s/iter; left time: 1654.0361s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1163s/iter; left time: 1779.5238s
Epoch: 13 cost time: 49.690356731414795
Epoch: 13, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.985 Test Loss: 0.149 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000295
	speed: 0.3094s/iter; left time: 4697.7263s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1349s/iter; left time: 2034.2997s
	iters: 300, epoch: 14 | loss: 0.0013408
	speed: 0.1099s/iter; left time: 1646.6675s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 1568.6706s
Epoch: 14 cost time: 49.53818893432617
Epoch: 14, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.235 Vali Acc: 0.976 Test Loss: 0.235 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2744s/iter; left time: 4052.1713s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1150s/iter; left time: 1687.5723s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 1475.2920s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1137s/iter; left time: 1645.7880s
Epoch: 15 cost time: 47.08047676086426
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.983 Test Loss: 0.176 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.2785998
	speed: 0.2840s/iter; left time: 4077.4749s
	iters: 200, epoch: 16 | loss: 0.0000083
	speed: 0.1319s/iter; left time: 1880.7841s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1252s/iter; left time: 1772.9391s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1283s/iter; left time: 1803.6101s
Epoch: 16 cost time: 51.51232981681824
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.981 Test Loss: 0.199 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000061
	speed: 0.3137s/iter; left time: 4373.7406s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.1265s/iter; left time: 1750.8003s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1076s/iter; left time: 1479.3501s
	iters: 400, epoch: 17 | loss: 0.0158767
	speed: 0.1226s/iter; left time: 1673.2177s
Epoch: 17 cost time: 51.212183713912964
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.980 Test Loss: 0.209 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000008
	speed: 0.2948s/iter; left time: 3989.2748s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1110s/iter; left time: 1490.8797s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1103s/iter; left time: 1470.2527s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1084s/iter; left time: 1434.4510s
Epoch: 18 cost time: 46.00454545021057
Epoch: 18, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.986 Test Loss: 0.130 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2567s/iter; left time: 3367.7558s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 1029.7081s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1268s/iter; left time: 1638.0553s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 1148.7524s
Epoch: 19 cost time: 41.434879779815674
Epoch: 19, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.981 Test Loss: 0.190 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000103
	speed: 0.2091s/iter; left time: 2656.3388s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 948.9394s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1311s/iter; left time: 1639.2884s
	iters: 400, epoch: 20 | loss: 0.0000194
	speed: 0.1281s/iter; left time: 1588.8648s
Epoch: 20 cost time: 45.157794713974
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.420 Vali Acc: 0.972 Test Loss: 0.420 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.5317969
	speed: 0.2752s/iter; left time: 3382.0429s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1203s/iter; left time: 1466.2156s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.1207s/iter; left time: 1459.1387s
	iters: 400, epoch: 21 | loss: 0.0000060
	speed: 0.1215s/iter; left time: 1456.5792s
Epoch: 21 cost time: 49.46711564064026
Epoch: 21, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.986 Test Loss: 0.181 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 43986442
model size : 182.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5324159
	speed: 0.0840s/iter; left time: 1725.3184s
	iters: 200, epoch: 1 | loss: 0.1603040
	speed: 0.0566s/iter; left time: 1156.7290s
	iters: 300, epoch: 1 | loss: 0.0615138
	speed: 0.0576s/iter; left time: 1171.9683s
	iters: 400, epoch: 1 | loss: 0.1703323
	speed: 0.0593s/iter; left time: 1200.2824s
Epoch: 1 cost time: 26.56984233856201
Epoch: 1, Steps: 413 | Train Loss: 0.533 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0040831
	speed: 0.1935s/iter; left time: 3896.8781s
	iters: 200, epoch: 2 | loss: 0.0043594
	speed: 0.0687s/iter; left time: 1376.7705s
	iters: 300, epoch: 2 | loss: 0.0004170
	speed: 0.0706s/iter; left time: 1408.4752s
	iters: 400, epoch: 2 | loss: 0.0166357
	speed: 0.0771s/iter; left time: 1529.4504s
Epoch: 2 cost time: 29.293102979660034
Epoch: 2, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0317774
	speed: 0.2242s/iter; left time: 4422.9930s
	iters: 200, epoch: 3 | loss: 0.0003901
	speed: 0.0829s/iter; left time: 1627.0692s
	iters: 300, epoch: 3 | loss: 0.0113128
	speed: 0.0775s/iter; left time: 1513.0794s
	iters: 400, epoch: 3 | loss: 0.1532229
	speed: 0.0793s/iter; left time: 1540.4400s
Epoch: 3 cost time: 31.15699863433838
Epoch: 3, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
Validation loss decreased (-0.965438 --> -0.982264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000318
	speed: 0.2471s/iter; left time: 4771.9088s
	iters: 200, epoch: 4 | loss: 0.0022585
	speed: 0.0675s/iter; left time: 1297.2598s
	iters: 300, epoch: 4 | loss: 0.0000363
	speed: 0.0648s/iter; left time: 1239.0054s
	iters: 400, epoch: 4 | loss: 0.0002480
	speed: 0.0703s/iter; left time: 1336.6834s
Epoch: 4 cost time: 27.97289252281189
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0722453
	speed: 0.2295s/iter; left time: 4336.6057s
	iters: 200, epoch: 5 | loss: 0.0000122
	speed: 0.0770s/iter; left time: 1446.8274s
	iters: 300, epoch: 5 | loss: 0.0100206
	speed: 0.0703s/iter; left time: 1315.0311s
	iters: 400, epoch: 5 | loss: 0.0032447
	speed: 0.0714s/iter; left time: 1327.1127s
Epoch: 5 cost time: 30.303783655166626
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0022754
	speed: 0.2289s/iter; left time: 4230.6185s
	iters: 200, epoch: 6 | loss: 0.0000546
	speed: 0.0744s/iter; left time: 1367.4386s
	iters: 300, epoch: 6 | loss: 0.0003473
	speed: 0.0662s/iter; left time: 1209.8246s
	iters: 400, epoch: 6 | loss: 0.0041392
	speed: 0.0644s/iter; left time: 1170.9736s
Epoch: 6 cost time: 28.439748525619507
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.974 Test Loss: 0.152 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000011
	speed: 0.2159s/iter; left time: 3902.7286s
	iters: 200, epoch: 7 | loss: 0.0003266
	speed: 0.0614s/iter; left time: 1104.4293s
	iters: 300, epoch: 7 | loss: 0.3043592
	speed: 0.0619s/iter; left time: 1106.2366s
	iters: 400, epoch: 7 | loss: 0.0000482
	speed: 0.0511s/iter; left time: 908.1511s
Epoch: 7 cost time: 25.241581439971924
Epoch: 7, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0045443
	speed: 0.2314s/iter; left time: 4087.0199s
	iters: 200, epoch: 8 | loss: 0.7513151
	speed: 0.0587s/iter; left time: 1030.6916s
	iters: 300, epoch: 8 | loss: 0.3076942
	speed: 0.0527s/iter; left time: 920.5033s
	iters: 400, epoch: 8 | loss: 0.0000623
	speed: 0.0515s/iter; left time: 893.2846s
Epoch: 8 cost time: 25.021957635879517
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.971 Test Loss: 0.181 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000201
	speed: 0.1863s/iter; left time: 3212.7296s
	iters: 200, epoch: 9 | loss: 0.0000415
	speed: 0.0616s/iter; left time: 1056.6564s
	iters: 300, epoch: 9 | loss: 0.0000063
	speed: 0.0534s/iter; left time: 911.0882s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 911.1339s
Epoch: 9 cost time: 23.84906244277954
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000294
	speed: 0.1859s/iter; left time: 3128.6978s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1095.2175s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0645s/iter; left time: 1073.5656s
	iters: 400, epoch: 10 | loss: 0.0036862
	speed: 0.0608s/iter; left time: 1004.5911s
Epoch: 10 cost time: 26.45693802833557
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0002101
	speed: 0.2152s/iter; left time: 3533.9041s
	iters: 200, epoch: 11 | loss: 0.1744699
	speed: 0.0766s/iter; left time: 1250.7121s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 1054.1245s
	iters: 400, epoch: 11 | loss: 0.0000041
	speed: 0.0725s/iter; left time: 1168.5595s
Epoch: 11 cost time: 29.30907678604126
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000011
	speed: 0.2081s/iter; left time: 3331.1383s
	iters: 200, epoch: 12 | loss: 0.0059236
	speed: 0.0643s/iter; left time: 1022.5105s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 1226.4921s
	iters: 400, epoch: 12 | loss: 0.0000179
	speed: 0.0713s/iter; left time: 1120.5914s
Epoch: 12 cost time: 28.726898193359375
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.986 Test Loss: 0.095 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.985902).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000018
	speed: 0.2157s/iter; left time: 3364.4514s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 675.1665s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 973.8856s
	iters: 400, epoch: 13 | loss: 0.0000006
	speed: 0.0766s/iter; left time: 1172.0785s
Epoch: 13 cost time: 26.240151405334473
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.301 Vali Acc: 0.974 Test Loss: 0.301 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000038
	speed: 0.2310s/iter; left time: 3506.6434s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 933.3173s
	iters: 300, epoch: 14 | loss: 0.0000007
	speed: 0.0609s/iter; left time: 912.8788s
	iters: 400, epoch: 14 | loss: 0.0000037
	speed: 0.0591s/iter; left time: 880.0897s
Epoch: 14 cost time: 26.263707160949707
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.259 Vali Acc: 0.978 Test Loss: 0.259 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2041s/iter; left time: 3014.1915s
	iters: 200, epoch: 15 | loss: 0.0000041
	speed: 0.0534s/iter; left time: 782.6054s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 838.5048s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 808.3371s
Epoch: 15 cost time: 23.728477716445923
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.193 Vali Acc: 0.978 Test Loss: 0.193 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1775s/iter; left time: 2548.6172s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 644.7723s
	iters: 300, epoch: 16 | loss: 0.0000049
	speed: 0.0582s/iter; left time: 823.5655s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 872.0733s
Epoch: 16 cost time: 23.1997971534729
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2187s/iter; left time: 3049.6306s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 765.7855s
	iters: 300, epoch: 17 | loss: 0.0000004
	speed: 0.0642s/iter; left time: 882.6419s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0657s/iter; left time: 896.0914s
Epoch: 17 cost time: 25.828474521636963
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2289s/iter; left time: 3097.6428s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 801.7179s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 939.0253s
	iters: 400, epoch: 18 | loss: 0.0000019
	speed: 0.0644s/iter; left time: 851.6378s
Epoch: 18 cost time: 27.920219659805298
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.983 Test Loss: 0.164 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0002875
	speed: 0.2110s/iter; left time: 2767.1397s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 957.0430s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 1005.6578s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0733s/iter; left time: 940.0891s
Epoch: 19 cost time: 30.307185649871826
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.981 Test Loss: 0.184 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2084s/iter; left time: 2647.8149s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 869.2028s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 778.2145s
	iters: 400, epoch: 20 | loss: 0.0000165
	speed: 0.0707s/iter; left time: 877.4654s
Epoch: 20 cost time: 28.058290243148804
Epoch: 20, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.980 Test Loss: 0.160 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3302078
	speed: 0.2281s/iter; left time: 2803.0537s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 880.7716s
	iters: 300, epoch: 21 | loss: 0.8657932
	speed: 0.0753s/iter; left time: 910.9045s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 874.2068s
Epoch: 21 cost time: 30.59876585006714
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.989 Test Loss: 0.136 Test Acc: 0.989
Validation loss decreased (-0.985902 --> -0.989085).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2482s/iter; left time: 2947.7126s
	iters: 200, epoch: 22 | loss: 0.0011522
	speed: 0.0607s/iter; left time: 714.8022s
	iters: 300, epoch: 22 | loss: 0.0000009
	speed: 0.0584s/iter; left time: 682.0983s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 679.4009s
Epoch: 22 cost time: 25.897995710372925
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.981 Test Loss: 0.224 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1754s/iter; left time: 2011.2490s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 650.2741s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 694.3784s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 810.3009s
Epoch: 23 cost time: 25.695263385772705
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.267 Vali Acc: 0.971 Test Loss: 0.267 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.2094s/iter; left time: 2313.7665s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 597.5534s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 764.1746s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 697.3430s
Epoch: 24 cost time: 26.731852054595947
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.976 Test Loss: 0.232 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2175s/iter; left time: 2313.6813s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 729.9167s
	iters: 300, epoch: 25 | loss: 0.0000014
	speed: 0.0680s/iter; left time: 709.7741s
	iters: 400, epoch: 25 | loss: 0.1407702
	speed: 0.0700s/iter; left time: 724.0527s
Epoch: 25 cost time: 28.774091958999634
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.976 Test Loss: 0.215 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000068
	speed: 0.2007s/iter; left time: 2051.9342s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 683.4554s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 707.5044s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 750.2888s
Epoch: 26 cost time: 29.45165181159973
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.219 Vali Acc: 0.981 Test Loss: 0.219 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2183s/iter; left time: 2142.2892s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 708.0218s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 631.0060s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 624.6666s
Epoch: 27 cost time: 28.69501280784607
Epoch: 27, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.377 Vali Acc: 0.971 Test Loss: 0.377 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1963s/iter; left time: 1844.7757s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 681.7311s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 637.7341s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 620.4038s
Epoch: 28 cost time: 28.78108048439026
Epoch: 28, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.386 Vali Acc: 0.975 Test Loss: 0.386 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2244s/iter; left time: 2016.2611s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 687.3447s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 651.0255s
	iters: 400, epoch: 29 | loss: 0.0000035
	speed: 0.0679s/iter; left time: 589.7051s
Epoch: 29 cost time: 30.460367918014526
Epoch: 29, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 1601.0323s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 498.6714s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 498.8501s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 501.5225s
Epoch: 30 cost time: 24.52336287498474
Epoch: 30, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.268 Vali Acc: 0.978 Test Loss: 0.268 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1868s/iter; left time: 1524.2796s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 539.4863s
	iters: 300, epoch: 31 | loss: 0.0000001
	speed: 0.0707s/iter; left time: 562.6673s
	iters: 400, epoch: 31 | loss: 0.0000001
	speed: 0.0727s/iter; left time: 571.6007s
Epoch: 31 cost time: 27.957757711410522
Epoch: 31, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.973 Test Loss: 0.443 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 43912714
model size : 182.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8173738
	speed: 0.0693s/iter; left time: 1424.5620s
	iters: 200, epoch: 1 | loss: 0.1337058
	speed: 0.0430s/iter; left time: 879.4357s
	iters: 300, epoch: 1 | loss: 0.1473992
	speed: 0.0523s/iter; left time: 1065.0525s
	iters: 400, epoch: 1 | loss: 0.0225886
	speed: 0.0561s/iter; left time: 1136.2254s
Epoch: 1 cost time: 22.778056859970093
Epoch: 1, Steps: 413 | Train Loss: 0.594 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0016194
	speed: 0.1592s/iter; left time: 3206.3967s
	iters: 200, epoch: 2 | loss: 0.0510358
	speed: 0.0434s/iter; left time: 870.0720s
	iters: 300, epoch: 2 | loss: 0.0422751
	speed: 0.0477s/iter; left time: 950.4752s
	iters: 400, epoch: 2 | loss: 0.1550398
	speed: 0.0515s/iter; left time: 1022.3828s
Epoch: 2 cost time: 20.478031158447266
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (-0.964983 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0115946
	speed: 0.1693s/iter; left time: 3340.0067s
	iters: 200, epoch: 3 | loss: 0.0378565
	speed: 0.0523s/iter; left time: 1025.9217s
	iters: 300, epoch: 3 | loss: 0.0350792
	speed: 0.0533s/iter; left time: 1040.7581s
	iters: 400, epoch: 3 | loss: 0.0418379
	speed: 0.0538s/iter; left time: 1045.8246s
Epoch: 3 cost time: 21.96804165840149
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.058 Vali Acc: 0.982 Test Loss: 0.058 Test Acc: 0.982
Validation loss decreased (-0.969076 --> -0.981809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0076977
	speed: 0.1606s/iter; left time: 3100.9164s
	iters: 200, epoch: 4 | loss: 0.0192830
	speed: 0.0519s/iter; left time: 996.3797s
	iters: 300, epoch: 4 | loss: 0.2395095
	speed: 0.0456s/iter; left time: 870.5530s
	iters: 400, epoch: 4 | loss: 0.0035832
	speed: 0.0428s/iter; left time: 813.6865s
Epoch: 4 cost time: 20.0164897441864
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0009079
	speed: 0.1279s/iter; left time: 2417.1566s
	iters: 200, epoch: 5 | loss: 0.0007549
	speed: 0.0436s/iter; left time: 820.0304s
	iters: 300, epoch: 5 | loss: 0.0016907
	speed: 0.0421s/iter; left time: 787.8149s
	iters: 400, epoch: 5 | loss: 0.0000927
	speed: 0.0382s/iter; left time: 709.6100s
Epoch: 5 cost time: 17.481288194656372
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.266 Vali Acc: 0.957 Test Loss: 0.266 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001679
	speed: 0.1165s/iter; left time: 2154.2544s
	iters: 200, epoch: 6 | loss: 0.0110520
	speed: 0.0521s/iter; left time: 958.5851s
	iters: 300, epoch: 6 | loss: 0.0000136
	speed: 0.0464s/iter; left time: 849.2880s
	iters: 400, epoch: 6 | loss: 0.0000325
	speed: 0.0498s/iter; left time: 906.4210s
Epoch: 6 cost time: 19.876492023468018
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001105
	speed: 0.1312s/iter; left time: 2371.0005s
	iters: 200, epoch: 7 | loss: 0.0000208
	speed: 0.0566s/iter; left time: 1016.7450s
	iters: 300, epoch: 7 | loss: 0.0000157
	speed: 0.0429s/iter; left time: 766.9285s
	iters: 400, epoch: 7 | loss: 0.0000422
	speed: 0.0522s/iter; left time: 927.5987s
Epoch: 7 cost time: 20.72500729560852
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.251 Vali Acc: 0.963 Test Loss: 0.251 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0124158
	speed: 0.1421s/iter; left time: 2509.7660s
	iters: 200, epoch: 8 | loss: 0.0004630
	speed: 0.0486s/iter; left time: 852.9426s
	iters: 300, epoch: 8 | loss: 0.0005265
	speed: 0.0440s/iter; left time: 767.7583s
	iters: 400, epoch: 8 | loss: 0.0000398
	speed: 0.0484s/iter; left time: 840.8279s
Epoch: 8 cost time: 19.474043369293213
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000116
	speed: 0.1503s/iter; left time: 2592.8847s
	iters: 200, epoch: 9 | loss: 0.0009442
	speed: 0.0470s/iter; left time: 805.8111s
	iters: 300, epoch: 9 | loss: 0.0019010
	speed: 0.0504s/iter; left time: 859.3209s
	iters: 400, epoch: 9 | loss: 0.0006498
	speed: 0.0411s/iter; left time: 696.8668s
Epoch: 9 cost time: 20.161174058914185
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001200
	speed: 0.1574s/iter; left time: 2648.8558s
	iters: 200, epoch: 10 | loss: 0.0435266
	speed: 0.0550s/iter; left time: 920.5730s
	iters: 300, epoch: 10 | loss: 0.0025340
	speed: 0.0444s/iter; left time: 738.0688s
	iters: 400, epoch: 10 | loss: 0.0000605
	speed: 0.0534s/iter; left time: 883.4012s
Epoch: 10 cost time: 21.853902578353882
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000037
	speed: 0.1443s/iter; left time: 2370.1794s
	iters: 200, epoch: 11 | loss: 0.0000155
	speed: 0.0444s/iter; left time: 724.3550s
	iters: 300, epoch: 11 | loss: 0.0000106
	speed: 0.0389s/iter; left time: 631.1577s
	iters: 400, epoch: 11 | loss: 0.1371598
	speed: 0.0468s/iter; left time: 755.2685s
Epoch: 11 cost time: 18.230825901031494
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1495s/iter; left time: 2393.6300s
	iters: 200, epoch: 12 | loss: 0.0000130
	speed: 0.0438s/iter; left time: 696.9601s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.0420s/iter; left time: 664.1703s
	iters: 400, epoch: 12 | loss: 0.0006746
	speed: 0.0408s/iter; left time: 641.2110s
Epoch: 12 cost time: 18.962380409240723
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000105
	speed: 0.1173s/iter; left time: 1829.2858s
	iters: 200, epoch: 13 | loss: 0.0000058
	speed: 0.0387s/iter; left time: 599.6003s
	iters: 300, epoch: 13 | loss: 0.0019297
	speed: 0.0380s/iter; left time: 585.6512s
	iters: 400, epoch: 13 | loss: 0.0000261
	speed: 0.0363s/iter; left time: 555.8258s
Epoch: 13 cost time: 15.72384524345398
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.964 Test Loss: 0.258 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 43857418
model size : 181.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2409265
	speed: 0.1175s/iter; left time: 2415.1773s
	iters: 200, epoch: 1 | loss: 0.1162297
	speed: 0.0939s/iter; left time: 1920.3758s
	iters: 300, epoch: 1 | loss: 0.0735253
	speed: 0.1025s/iter; left time: 2086.7976s
	iters: 400, epoch: 1 | loss: 0.0876656
	speed: 0.0988s/iter; left time: 2000.4197s
Epoch: 1 cost time: 43.01176571846008
Epoch: 1, Steps: 413 | Train Loss: 0.490 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (inf --> -0.969985).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0020529
	speed: 0.2462s/iter; left time: 4957.2320s
	iters: 200, epoch: 2 | loss: 0.0006969
	speed: 0.0976s/iter; left time: 1955.3819s
	iters: 300, epoch: 2 | loss: 0.0326153
	speed: 0.0949s/iter; left time: 1892.5138s
	iters: 400, epoch: 2 | loss: 0.0079308
	speed: 0.0897s/iter; left time: 1778.6535s
Epoch: 2 cost time: 39.40768575668335
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0322305
	speed: 0.2438s/iter; left time: 4808.2082s
	iters: 200, epoch: 3 | loss: 0.0010675
	speed: 0.0969s/iter; left time: 1901.2211s
	iters: 300, epoch: 3 | loss: 0.0029541
	speed: 0.0921s/iter; left time: 1797.4238s
	iters: 400, epoch: 3 | loss: 0.0004267
	speed: 0.1009s/iter; left time: 1959.0129s
Epoch: 3 cost time: 41.430362939834595
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0127587
	speed: 0.2642s/iter; left time: 5101.9187s
	iters: 200, epoch: 4 | loss: 0.0025616
	speed: 0.1100s/iter; left time: 2112.7407s
	iters: 300, epoch: 4 | loss: 0.6912609
	speed: 0.0965s/iter; left time: 1845.1777s
	iters: 400, epoch: 4 | loss: 0.2872319
	speed: 0.0855s/iter; left time: 1626.4538s
Epoch: 4 cost time: 40.61095571517944
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.974987 --> -0.978171).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000089
	speed: 0.2653s/iter; left time: 5013.1664s
	iters: 200, epoch: 5 | loss: 0.0955617
	speed: 0.0893s/iter; left time: 1678.9849s
	iters: 300, epoch: 5 | loss: 0.1737147
	speed: 0.0939s/iter; left time: 1755.6446s
	iters: 400, epoch: 5 | loss: 0.0000947
	speed: 0.1036s/iter; left time: 1926.9831s
Epoch: 5 cost time: 39.910237073898315
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.303 Vali Acc: 0.966 Test Loss: 0.303 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000121
	speed: 0.1912s/iter; left time: 3534.5506s
	iters: 200, epoch: 6 | loss: 0.0001450
	speed: 0.0796s/iter; left time: 1463.2790s
	iters: 300, epoch: 6 | loss: 0.0000321
	speed: 0.0900s/iter; left time: 1645.8597s
	iters: 400, epoch: 6 | loss: 0.0003202
	speed: 0.0771s/iter; left time: 1401.6224s
Epoch: 6 cost time: 33.39865732192993
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.985 Test Loss: 0.125 Test Acc: 0.985
Validation loss decreased (-0.978171 --> -0.984992).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000008
	speed: 0.2697s/iter; left time: 4873.6546s
	iters: 200, epoch: 7 | loss: 0.0000103
	speed: 0.0918s/iter; left time: 1650.7247s
	iters: 300, epoch: 7 | loss: 0.0000006
	speed: 0.1023s/iter; left time: 1828.9308s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.1131s/iter; left time: 2010.7825s
Epoch: 7 cost time: 42.65384387969971
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.972 Test Loss: 0.237 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000013
	speed: 0.2409s/iter; left time: 4254.3248s
	iters: 200, epoch: 8 | loss: 0.0000009
	speed: 0.1123s/iter; left time: 1972.4661s
	iters: 300, epoch: 8 | loss: 0.0000242
	speed: 0.1044s/iter; left time: 1823.0636s
	iters: 400, epoch: 8 | loss: 0.4153821
	speed: 0.1015s/iter; left time: 1761.4441s
Epoch: 8 cost time: 43.87053179740906
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
Validation loss decreased (-0.984992 --> -0.984992).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000108
	speed: 0.2521s/iter; left time: 4348.6672s
	iters: 200, epoch: 9 | loss: 0.1748914
	speed: 0.0797s/iter; left time: 1366.5893s
	iters: 300, epoch: 9 | loss: 0.0008093
	speed: 0.0848s/iter; left time: 1445.8142s
	iters: 400, epoch: 9 | loss: 0.0000839
	speed: 0.0751s/iter; left time: 1273.1227s
Epoch: 9 cost time: 32.12865447998047
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.985 Test Loss: 0.146 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1871s/iter; left time: 3149.0165s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 1526.3843s
	iters: 300, epoch: 10 | loss: 0.0502786
	speed: 0.1023s/iter; left time: 1700.9222s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0893s/iter; left time: 1475.9758s
Epoch: 10 cost time: 38.47958827018738
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.984 Test Loss: 0.154 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0002179
	speed: 0.2550s/iter; left time: 4187.3416s
	iters: 200, epoch: 11 | loss: 0.1616977
	speed: 0.1086s/iter; left time: 1772.5542s
	iters: 300, epoch: 11 | loss: 0.1241276
	speed: 0.1037s/iter; left time: 1682.5354s
	iters: 400, epoch: 11 | loss: 0.0092930
	speed: 0.0985s/iter; left time: 1587.3340s
Epoch: 11 cost time: 42.589744091033936
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.983 Test Loss: 0.153 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2637s/iter; left time: 4221.4202s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.1069s/iter; left time: 1700.9311s
	iters: 300, epoch: 12 | loss: 0.0002708
	speed: 0.0972s/iter; left time: 1537.1309s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1128s/iter; left time: 1771.2373s
Epoch: 12 cost time: 45.284038066864014
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.223 Vali Acc: 0.979 Test Loss: 0.223 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2552s/iter; left time: 3979.7424s
	iters: 200, epoch: 13 | loss: 0.0000003
	speed: 0.1055s/iter; left time: 1634.7094s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1162s/iter; left time: 1789.2214s
	iters: 400, epoch: 13 | loss: 0.0106919
	speed: 0.0946s/iter; left time: 1446.3268s
Epoch: 13 cost time: 42.580177545547485
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.969 Test Loss: 0.461 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2170s/iter; left time: 3294.2402s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 1048.1654s
	iters: 300, epoch: 14 | loss: 0.0001162
	speed: 0.0683s/iter; left time: 1022.8111s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 1255.3983s
Epoch: 14 cost time: 32.50473189353943
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.156 Vali Acc: 0.987 Test Loss: 0.156 Test Acc: 0.987
Validation loss decreased (-0.984992 --> -0.987265).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000016
	speed: 0.2562s/iter; left time: 3784.0166s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 1528.8679s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.1079s/iter; left time: 1572.6984s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 1253.8517s
Epoch: 15 cost time: 40.07773518562317
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.993 Test Loss: 0.069 Test Acc: 0.993
Validation loss decreased (-0.987265 --> -0.992723).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 3882.5108s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1117s/iter; left time: 1592.1631s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1138s/iter; left time: 1610.7730s
	iters: 400, epoch: 16 | loss: 0.0014791
	speed: 0.1079s/iter; left time: 1517.0247s
Epoch: 16 cost time: 44.57723069190979
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.976 Test Loss: 0.245 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2546s/iter; left time: 3549.4961s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 1458.9948s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0979s/iter; left time: 1345.8050s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1074s/iter; left time: 1465.9124s
Epoch: 17 cost time: 44.082125425338745
Epoch: 17, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.242 Vali Acc: 0.985 Test Loss: 0.242 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2097s/iter; left time: 2836.9872s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0963s/iter; left time: 1292.9848s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1052s/iter; left time: 1402.0881s
	iters: 400, epoch: 18 | loss: 0.7647706
	speed: 0.0939s/iter; left time: 1242.4048s
Epoch: 18 cost time: 39.682899951934814
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.285 Vali Acc: 0.978 Test Loss: 0.285 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2927s/iter; left time: 3839.9848s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1246s/iter; left time: 1622.2548s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1207s/iter; left time: 1558.9531s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1121s/iter; left time: 1436.1934s
Epoch: 19 cost time: 50.296446800231934
Epoch: 19, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.986 Test Loss: 0.144 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2694s/iter; left time: 3422.9519s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1117s/iter; left time: 1408.1509s
	iters: 300, epoch: 20 | loss: 0.0051814
	speed: 0.1220s/iter; left time: 1525.7398s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1218s/iter; left time: 1510.9645s
Epoch: 20 cost time: 48.776190519332886
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.986 Test Loss: 0.204 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2906s/iter; left time: 3571.2605s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1018s/iter; left time: 1241.4860s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0934s/iter; left time: 1129.1619s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1051s/iter; left time: 1260.0426s
Epoch: 21 cost time: 42.723716497421265
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.988 Test Loss: 0.160 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2355s/iter; left time: 2797.8474s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1103s/iter; left time: 1298.6507s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1225s/iter; left time: 1430.8270s
	iters: 400, epoch: 22 | loss: 0.2852992
	speed: 0.1251s/iter; left time: 1448.8375s
Epoch: 22 cost time: 47.29088377952576
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.420 Vali Acc: 0.970 Test Loss: 0.420 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.3195s/iter; left time: 3663.1816s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1093s/iter; left time: 1241.9033s
	iters: 300, epoch: 23 | loss: 0.0000065
	speed: 0.0889s/iter; left time: 1001.1327s
	iters: 400, epoch: 23 | loss: 0.0000123
	speed: 0.0753s/iter; left time: 840.7736s
Epoch: 23 cost time: 41.290802001953125
Epoch: 23, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.159 Vali Acc: 0.984 Test Loss: 0.159 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2326s/iter; left time: 2571.2144s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 967.1632s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 977.3610s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 995.0449s
Epoch: 24 cost time: 37.46986103057861
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.388 Vali Acc: 0.979 Test Loss: 0.388 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2862s/iter; left time: 3044.3709s
	iters: 200, epoch: 25 | loss: 0.0000018
	speed: 0.1032s/iter; left time: 1087.7090s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 870.6004s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 897.9948s
Epoch: 25 cost time: 39.939401388168335
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.986 Test Loss: 0.206 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9927239654388358
model parameter : 44046346
model size : 182.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4051999
	speed: 0.0718s/iter; left time: 1475.4005s
	iters: 200, epoch: 1 | loss: 0.1262573
	speed: 0.0449s/iter; left time: 918.8622s
	iters: 300, epoch: 1 | loss: 0.0152134
	speed: 0.0472s/iter; left time: 959.9996s
	iters: 400, epoch: 1 | loss: 0.0259833
	speed: 0.0430s/iter; left time: 871.4811s
Epoch: 1 cost time: 21.430177927017212
Epoch: 1, Steps: 413 | Train Loss: 0.524 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0759134
	speed: 0.2023s/iter; left time: 4074.6461s
	iters: 200, epoch: 2 | loss: 0.0014943
	speed: 0.0626s/iter; left time: 1254.1066s
	iters: 300, epoch: 2 | loss: 0.2751693
	speed: 0.0507s/iter; left time: 1011.8008s
	iters: 400, epoch: 2 | loss: 0.1784550
	speed: 0.0597s/iter; left time: 1184.9482s
Epoch: 2 cost time: 24.638084411621094
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.957252 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0060482
	speed: 0.2307s/iter; left time: 4550.5673s
	iters: 200, epoch: 3 | loss: 0.0017755
	speed: 0.0556s/iter; left time: 1090.4280s
	iters: 300, epoch: 3 | loss: 0.0091005
	speed: 0.0643s/iter; left time: 1255.3833s
	iters: 400, epoch: 3 | loss: 0.0004385
	speed: 0.0716s/iter; left time: 1391.7139s
Epoch: 3 cost time: 26.83850908279419
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.964983 --> -0.973168).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0701339
	speed: 0.2171s/iter; left time: 4193.5060s
	iters: 200, epoch: 4 | loss: 0.0001854
	speed: 0.0511s/iter; left time: 982.4297s
	iters: 300, epoch: 4 | loss: 0.0023306
	speed: 0.0679s/iter; left time: 1297.2906s
	iters: 400, epoch: 4 | loss: 0.0786319
	speed: 0.0739s/iter; left time: 1404.3981s
Epoch: 4 cost time: 26.362529277801514
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.973168 --> -0.981354).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000141
	speed: 0.2619s/iter; left time: 4949.5680s
	iters: 200, epoch: 5 | loss: 0.0000597
	speed: 0.0694s/iter; left time: 1304.5194s
	iters: 300, epoch: 5 | loss: 0.0002298
	speed: 0.0721s/iter; left time: 1349.1169s
	iters: 400, epoch: 5 | loss: 0.0000026
	speed: 0.0726s/iter; left time: 1350.7237s
Epoch: 5 cost time: 30.376973390579224
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0008012
	speed: 0.2021s/iter; left time: 3736.4781s
	iters: 200, epoch: 6 | loss: 0.3888820
	speed: 0.0625s/iter; left time: 1149.9279s
	iters: 300, epoch: 6 | loss: 0.0966446
	speed: 0.0586s/iter; left time: 1072.3103s
	iters: 400, epoch: 6 | loss: 0.3936955
	speed: 0.0608s/iter; left time: 1106.0955s
Epoch: 6 cost time: 24.4176664352417
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000555
	speed: 0.1738s/iter; left time: 3141.0809s
	iters: 200, epoch: 7 | loss: 0.0000554
	speed: 0.0461s/iter; left time: 828.3168s
	iters: 300, epoch: 7 | loss: 0.0000722
	speed: 0.0516s/iter; left time: 922.4313s
	iters: 400, epoch: 7 | loss: 0.0042890
	speed: 0.0477s/iter; left time: 848.0503s
Epoch: 7 cost time: 20.741674184799194
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000010
	speed: 0.1848s/iter; left time: 3262.6982s
	iters: 200, epoch: 8 | loss: 0.0004036
	speed: 0.0539s/iter; left time: 945.8874s
	iters: 300, epoch: 8 | loss: 0.0000003
	speed: 0.0647s/iter; left time: 1130.0720s
	iters: 400, epoch: 8 | loss: 0.1155514
	speed: 0.0560s/iter; left time: 971.6602s
Epoch: 8 cost time: 24.82890820503235
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.978 Test Loss: 0.192 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4645433
	speed: 0.1941s/iter; left time: 3348.4996s
	iters: 200, epoch: 9 | loss: 0.0163358
	speed: 0.0665s/iter; left time: 1140.1792s
	iters: 300, epoch: 9 | loss: 0.0004871
	speed: 0.0662s/iter; left time: 1129.3343s
	iters: 400, epoch: 9 | loss: 0.0004509
	speed: 0.0564s/iter; left time: 955.8646s
Epoch: 9 cost time: 25.738118648529053
Epoch: 9, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.2108s/iter; left time: 3549.2865s
	iters: 200, epoch: 10 | loss: 0.0000014
	speed: 0.0570s/iter; left time: 954.1374s
	iters: 300, epoch: 10 | loss: 0.0000034
	speed: 0.0579s/iter; left time: 963.6152s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0655s/iter; left time: 1082.5360s
Epoch: 10 cost time: 25.672463178634644
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.973 Test Loss: 0.193 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001036
	speed: 0.2003s/iter; left time: 3288.9676s
	iters: 200, epoch: 11 | loss: 0.0000284
	speed: 0.0538s/iter; left time: 878.8565s
	iters: 300, epoch: 11 | loss: 0.0000057
	speed: 0.0672s/iter; left time: 1090.4589s
	iters: 400, epoch: 11 | loss: 0.0484571
	speed: 0.0700s/iter; left time: 1129.0236s
Epoch: 11 cost time: 27.57019281387329
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.283 Vali Acc: 0.974 Test Loss: 0.283 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0003067
	speed: 0.2309s/iter; left time: 3697.0403s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0800s/iter; left time: 1272.0343s
	iters: 300, epoch: 12 | loss: 0.0000069
	speed: 0.0563s/iter; left time: 889.5903s
	iters: 400, epoch: 12 | loss: 0.0002376
	speed: 0.0434s/iter; left time: 681.3094s
Epoch: 12 cost time: 26.81906247138977
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.984 Test Loss: 0.117 Test Acc: 0.984
Validation loss decreased (-0.981354 --> -0.983628).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1443448
	speed: 0.1932s/iter; left time: 3012.2103s
	iters: 200, epoch: 13 | loss: 0.0000723
	speed: 0.0494s/iter; left time: 765.2431s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 759.1844s
	iters: 400, epoch: 13 | loss: 0.0001773
	speed: 0.0449s/iter; left time: 686.7253s
Epoch: 13 cost time: 21.52535891532898
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.1738s/iter; left time: 2639.0404s
	iters: 200, epoch: 14 | loss: 0.0000040
	speed: 0.0493s/iter; left time: 743.7830s
	iters: 300, epoch: 14 | loss: 0.0000460
	speed: 0.0495s/iter; left time: 740.8943s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0459s/iter; left time: 683.1788s
Epoch: 14 cost time: 20.000449180603027
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.984 Test Loss: 0.117 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.984083).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1703s/iter; left time: 2515.4026s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 702.1599s
	iters: 300, epoch: 15 | loss: 0.0267132
	speed: 0.0398s/iter; left time: 580.0368s
	iters: 400, epoch: 15 | loss: 0.0000028
	speed: 0.0593s/iter; left time: 858.6367s
Epoch: 15 cost time: 20.323014736175537
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001318
	speed: 0.1874s/iter; left time: 2690.0555s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 674.6681s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 806.7151s
	iters: 400, epoch: 16 | loss: 0.0000394
	speed: 0.0468s/iter; left time: 657.7913s
Epoch: 16 cost time: 22.065740823745728
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0007216
	speed: 0.1610s/iter; left time: 2245.4056s
	iters: 200, epoch: 17 | loss: 0.0000017
	speed: 0.0720s/iter; left time: 996.6853s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 932.1995s
	iters: 400, epoch: 17 | loss: 0.0001795
	speed: 0.0524s/iter; left time: 714.3373s
Epoch: 17 cost time: 24.51005220413208
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.978 Test Loss: 0.188 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2216s/iter; left time: 2997.7712s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 794.6113s
	iters: 300, epoch: 18 | loss: 0.0452368
	speed: 0.0666s/iter; left time: 887.5498s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 878.6219s
Epoch: 18 cost time: 27.263527393341064
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.979 Test Loss: 0.200 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2017s/iter; left time: 2645.1438s
	iters: 200, epoch: 19 | loss: 0.0075636
	speed: 0.0625s/iter; left time: 813.7021s
	iters: 300, epoch: 19 | loss: 0.0000324
	speed: 0.0601s/iter; left time: 776.6009s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 607.1806s
Epoch: 19 cost time: 23.52320432662964
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.237 Vali Acc: 0.976 Test Loss: 0.237 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0283136
	speed: 0.2063s/iter; left time: 2621.4105s
	iters: 200, epoch: 20 | loss: 0.0167334
	speed: 0.0509s/iter; left time: 642.1359s
	iters: 300, epoch: 20 | loss: 0.0004069
	speed: 0.0491s/iter; left time: 613.4017s
	iters: 400, epoch: 20 | loss: 0.0000008
	speed: 0.0545s/iter; left time: 676.3283s
Epoch: 20 cost time: 22.78918957710266
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.984992).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0036307
	speed: 0.2166s/iter; left time: 2661.8348s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 585.4883s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 504.5166s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 500.0906s
Epoch: 21 cost time: 20.374089241027832
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.981 Test Loss: 0.178 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1544s/iter; left time: 1833.6245s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 412.4222s
	iters: 300, epoch: 22 | loss: 0.0223237
	speed: 0.0430s/iter; left time: 502.5279s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0439s/iter; left time: 508.4548s
Epoch: 22 cost time: 17.290260553359985
Epoch: 22, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.980 Test Loss: 0.190 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.1578s/iter; left time: 1809.2242s
	iters: 200, epoch: 23 | loss: 0.0000089
	speed: 0.0389s/iter; left time: 442.5512s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 460.5469s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 412.5903s
Epoch: 23 cost time: 16.923576831817627
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.307 Vali Acc: 0.974 Test Loss: 0.307 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1548s/iter; left time: 1711.1634s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 557.1536s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 501.6602s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 513.4127s
Epoch: 24 cost time: 20.882935762405396
Epoch: 24, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.291 Vali Acc: 0.972 Test Loss: 0.291 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.1754s/iter; left time: 1866.2152s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 695.5030s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 564.0632s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 658.5631s
Epoch: 25 cost time: 25.606064081192017
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.973 Test Loss: 0.308 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1920s/iter; left time: 1963.7779s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 548.3195s
	iters: 300, epoch: 26 | loss: 0.0004029
	speed: 0.0460s/iter; left time: 460.7745s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 487.7132s
Epoch: 26 cost time: 21.56604504585266
Epoch: 26, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.976 Test Loss: 0.269 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0014767
	speed: 0.1860s/iter; left time: 1825.4384s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 493.5167s
	iters: 300, epoch: 27 | loss: 0.0000004
	speed: 0.0486s/iter; left time: 466.7227s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 551.7143s
Epoch: 27 cost time: 21.989834308624268
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 1754.7302s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 548.7403s
	iters: 300, epoch: 28 | loss: 0.0000048
	speed: 0.0557s/iter; left time: 512.6838s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 451.1824s
Epoch: 28 cost time: 23.945571899414062
Epoch: 28, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.271 Vali Acc: 0.979 Test Loss: 0.271 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1805s/iter; left time: 1622.4882s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 535.1779s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 395.4751s
	iters: 400, epoch: 29 | loss: 0.0000029
	speed: 0.0611s/iter; left time: 530.5745s
Epoch: 29 cost time: 22.129820585250854
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.985 Test Loss: 0.204 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1886s/iter; left time: 1616.7424s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 499.4242s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 507.6464s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 568.4628s
Epoch: 30 cost time: 24.932900190353394
Epoch: 30, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.977 Test Loss: 0.241 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 43954186
model size : 182.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6786783
	speed: 0.0610s/iter; left time: 1253.5036s
	iters: 200, epoch: 1 | loss: 0.3241302
	speed: 0.0323s/iter; left time: 661.5462s
	iters: 300, epoch: 1 | loss: 0.0632140
	speed: 0.0394s/iter; left time: 802.7577s
	iters: 400, epoch: 1 | loss: 0.0094297
	speed: 0.0394s/iter; left time: 797.9896s
Epoch: 1 cost time: 17.839161157608032
Epoch: 1, Steps: 413 | Train Loss: 0.570 Vali Loss: 0.126 Vali Acc: 0.956 Test Loss: 0.126 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0286422
	speed: 0.1327s/iter; left time: 2672.9584s
	iters: 200, epoch: 2 | loss: 0.0192374
	speed: 0.0387s/iter; left time: 775.0757s
	iters: 300, epoch: 2 | loss: 0.0048384
	speed: 0.0388s/iter; left time: 774.5110s
	iters: 400, epoch: 2 | loss: 0.1610759
	speed: 0.0369s/iter; left time: 732.8360s
Epoch: 2 cost time: 16.386905670166016
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.955888 --> -0.979990).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0105262
	speed: 0.1516s/iter; left time: 2990.6922s
	iters: 200, epoch: 3 | loss: 0.0009567
	speed: 0.0385s/iter; left time: 754.9825s
	iters: 300, epoch: 3 | loss: 0.1223374
	speed: 0.0385s/iter; left time: 750.8015s
	iters: 400, epoch: 3 | loss: 0.0208870
	speed: 0.0408s/iter; left time: 791.7524s
Epoch: 3 cost time: 16.752928018569946
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0046471
	speed: 0.1370s/iter; left time: 2645.3825s
	iters: 200, epoch: 4 | loss: 0.0000907
	speed: 0.0374s/iter; left time: 719.1573s
	iters: 300, epoch: 4 | loss: 0.0034014
	speed: 0.0493s/iter; left time: 941.5733s
	iters: 400, epoch: 4 | loss: 0.0119440
	speed: 0.0506s/iter; left time: 961.2499s
Epoch: 4 cost time: 18.646818161010742
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3523023
	speed: 0.1437s/iter; left time: 2715.5155s
	iters: 200, epoch: 5 | loss: 0.0515199
	speed: 0.0484s/iter; left time: 909.8179s
	iters: 300, epoch: 5 | loss: 0.0000281
	speed: 0.0398s/iter; left time: 743.7805s
	iters: 400, epoch: 5 | loss: 0.0002108
	speed: 0.0505s/iter; left time: 939.2147s
Epoch: 5 cost time: 19.02187967300415
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0673749
	speed: 0.1531s/iter; left time: 2830.1578s
	iters: 200, epoch: 6 | loss: 0.0162841
	speed: 0.0473s/iter; left time: 869.8119s
	iters: 300, epoch: 6 | loss: 0.0221791
	speed: 0.0422s/iter; left time: 772.3759s
	iters: 400, epoch: 6 | loss: 0.0040532
	speed: 0.0443s/iter; left time: 805.4613s
Epoch: 6 cost time: 19.387956142425537
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0051199
	speed: 0.1486s/iter; left time: 2685.9736s
	iters: 200, epoch: 7 | loss: 0.1476572
	speed: 0.0548s/iter; left time: 985.5741s
	iters: 300, epoch: 7 | loss: 0.0003367
	speed: 0.0528s/iter; left time: 943.6421s
	iters: 400, epoch: 7 | loss: 0.0000048
	speed: 0.0494s/iter; left time: 877.3384s
Epoch: 7 cost time: 21.673951148986816
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.249 Vali Acc: 0.964 Test Loss: 0.249 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000028
	speed: 0.1431s/iter; left time: 2527.1525s
	iters: 200, epoch: 8 | loss: 0.5733277
	speed: 0.0526s/iter; left time: 924.3135s
	iters: 300, epoch: 8 | loss: 0.0007917
	speed: 0.0528s/iter; left time: 921.3573s
	iters: 400, epoch: 8 | loss: 0.0000809
	speed: 0.0501s/iter; left time: 870.2502s
Epoch: 8 cost time: 20.82135796546936
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000106
	speed: 0.1598s/iter; left time: 2756.8782s
	iters: 200, epoch: 9 | loss: 0.0000027
	speed: 0.0486s/iter; left time: 833.4327s
	iters: 300, epoch: 9 | loss: 0.0082292
	speed: 0.0435s/iter; left time: 741.0371s
	iters: 400, epoch: 9 | loss: 0.0453187
	speed: 0.0527s/iter; left time: 892.3814s
Epoch: 9 cost time: 20.716647148132324
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000078
	speed: 0.1527s/iter; left time: 2570.5000s
	iters: 200, epoch: 10 | loss: 0.0000048
	speed: 0.0452s/iter; left time: 755.7266s
	iters: 300, epoch: 10 | loss: 0.0000114
	speed: 0.0392s/iter; left time: 651.6489s
	iters: 400, epoch: 10 | loss: 0.0000004
	speed: 0.0366s/iter; left time: 605.2039s
Epoch: 10 cost time: 17.149364471435547
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.981354).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000046
	speed: 0.1546s/iter; left time: 2538.4315s
	iters: 200, epoch: 11 | loss: 0.0000077
	speed: 0.0388s/iter; left time: 633.3867s
	iters: 300, epoch: 11 | loss: 0.1948303
	speed: 0.0367s/iter; left time: 596.0663s
	iters: 400, epoch: 11 | loss: 0.0000020
	speed: 0.0374s/iter; left time: 602.6494s
Epoch: 11 cost time: 16.114816904067993
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000021
	speed: 0.1398s/iter; left time: 2237.2422s
	iters: 200, epoch: 12 | loss: 0.0000995
	speed: 0.0459s/iter; left time: 730.8805s
	iters: 300, epoch: 12 | loss: 0.0079830
	speed: 0.0394s/iter; left time: 623.3246s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 686.8029s
Epoch: 12 cost time: 18.664398431777954
Epoch: 12, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.1356s/iter; left time: 2115.1938s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 759.0549s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 687.2580s
	iters: 400, epoch: 13 | loss: 0.0831619
	speed: 0.0431s/iter; left time: 659.0933s
Epoch: 13 cost time: 18.214553833007812
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0005799
	speed: 0.1415s/iter; left time: 2148.0337s
	iters: 200, epoch: 14 | loss: 0.0000019
	speed: 0.0391s/iter; left time: 589.2247s
	iters: 300, epoch: 14 | loss: 0.0524965
	speed: 0.0475s/iter; left time: 711.6635s
	iters: 400, epoch: 14 | loss: 0.0001372
	speed: 0.0450s/iter; left time: 669.4184s
Epoch: 14 cost time: 19.350133657455444
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.971 Test Loss: 0.199 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1486s/iter; left time: 2194.5399s
	iters: 200, epoch: 15 | loss: 0.0010371
	speed: 0.0518s/iter; left time: 759.1391s
	iters: 300, epoch: 15 | loss: 0.0000040
	speed: 0.0541s/iter; left time: 787.7581s
	iters: 400, epoch: 15 | loss: 0.0000243
	speed: 0.0495s/iter; left time: 715.6179s
Epoch: 15 cost time: 21.726673126220703
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.970 Test Loss: 0.220 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1516s/iter; left time: 2176.9511s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 709.0558s
	iters: 300, epoch: 16 | loss: 0.0311455
	speed: 0.0537s/iter; left time: 759.5366s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 719.1016s
Epoch: 16 cost time: 21.422534465789795
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1514s/iter; left time: 2110.6759s
	iters: 200, epoch: 17 | loss: 0.0000130
	speed: 0.0452s/iter; left time: 625.2265s
	iters: 300, epoch: 17 | loss: 0.0013900
	speed: 0.0417s/iter; left time: 573.2699s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 464.6496s
Epoch: 17 cost time: 17.709448099136353
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.978 Test Loss: 0.152 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0008007
	speed: 0.1178s/iter; left time: 1593.5016s
	iters: 200, epoch: 18 | loss: 0.0002140
	speed: 0.0338s/iter; left time: 453.4288s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 436.4071s
	iters: 400, epoch: 18 | loss: 0.0000037
	speed: 0.0305s/iter; left time: 403.9138s
Epoch: 18 cost time: 13.775704860687256
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.981354 --> -0.981354).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1585s/iter; left time: 2079.1076s
	iters: 200, epoch: 19 | loss: 0.0000139
	speed: 0.0425s/iter; left time: 552.8476s
	iters: 300, epoch: 19 | loss: 0.0002219
	speed: 0.0371s/iter; left time: 478.8534s
	iters: 400, epoch: 19 | loss: 0.0000007
	speed: 0.0415s/iter; left time: 532.2723s
Epoch: 19 cost time: 17.197856187820435
Epoch: 19, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.978 Test Loss: 0.180 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1937058
	speed: 0.1331s/iter; left time: 1691.2565s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 480.1360s
	iters: 300, epoch: 20 | loss: 0.0000028
	speed: 0.0413s/iter; left time: 516.7329s
	iters: 400, epoch: 20 | loss: 0.0000006
	speed: 0.0448s/iter; left time: 555.1104s
Epoch: 20 cost time: 17.217632293701172
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.1458s/iter; left time: 1792.5741s
	iters: 200, epoch: 21 | loss: 0.0000006
	speed: 0.0441s/iter; left time: 537.3289s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 458.7910s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0421s/iter; left time: 504.7186s
Epoch: 21 cost time: 16.822612285614014
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.974 Test Loss: 0.178 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1573s/iter; left time: 1867.9649s
	iters: 200, epoch: 22 | loss: 0.0000094
	speed: 0.0368s/iter; left time: 432.8540s
	iters: 300, epoch: 22 | loss: 0.0000016
	speed: 0.0450s/iter; left time: 525.0255s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 496.3309s
Epoch: 22 cost time: 18.39751410484314
Epoch: 22, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1362s/iter; left time: 1561.0278s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 515.9197s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 521.2894s
	iters: 400, epoch: 23 | loss: 0.0005881
	speed: 0.0428s/iter; left time: 477.7046s
Epoch: 23 cost time: 19.012896299362183
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.985 Test Loss: 0.109 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.984992).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.1679s/iter; left time: 1855.2450s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 508.6002s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0427s/iter; left time: 462.8646s
	iters: 400, epoch: 24 | loss: 0.3146145
	speed: 0.0458s/iter; left time: 492.0763s
Epoch: 24 cost time: 19.56098508834839
Epoch: 24, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.372 Vali Acc: 0.964 Test Loss: 0.372 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0036513
	speed: 0.1299s/iter; left time: 1382.4546s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 380.8245s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 372.1022s
	iters: 400, epoch: 25 | loss: 0.0000032
	speed: 0.0358s/iter; left time: 369.6868s
Epoch: 25 cost time: 15.151402711868286
Epoch: 25, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000053
	speed: 0.1386s/iter; left time: 1416.8459s
	iters: 200, epoch: 26 | loss: 0.0145698
	speed: 0.0349s/iter; left time: 353.6819s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0410s/iter; left time: 411.5045s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 360.7703s
Epoch: 26 cost time: 16.717081546783447
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.979 Test Loss: 0.158 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1418s/iter; left time: 1391.1340s
	iters: 200, epoch: 27 | loss: 0.0000003
	speed: 0.0436s/iter; left time: 423.0986s
	iters: 300, epoch: 27 | loss: 0.0000110
	speed: 0.0421s/iter; left time: 405.1406s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 355.7542s
Epoch: 27 cost time: 17.23075771331787
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.146 Vali Acc: 0.982 Test Loss: 0.146 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1293s/iter; left time: 1215.1710s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 393.0465s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 417.8498s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 389.2299s
Epoch: 28 cost time: 18.11677122116089
Epoch: 28, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0048360
	speed: 0.1369s/iter; left time: 1229.9016s
	iters: 200, epoch: 29 | loss: 0.0000007
	speed: 0.0460s/iter; left time: 408.8317s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 421.6276s
	iters: 400, epoch: 29 | loss: 0.0012336
	speed: 0.0491s/iter; left time: 426.3752s
Epoch: 29 cost time: 19.59124255180359
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.973 Test Loss: 0.242 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.1316s/iter; left time: 1128.2425s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 325.1001s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 300.6340s
	iters: 400, epoch: 30 | loss: 0.0001148
	speed: 0.0378s/iter; left time: 313.0976s
Epoch: 30 cost time: 16.011640071868896
Epoch: 30, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.980 Test Loss: 0.190 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1230s/iter; left time: 1004.0052s
	iters: 200, epoch: 31 | loss: 0.0000006
	speed: 0.0492s/iter; left time: 396.9971s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 354.8450s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 359.4284s
Epoch: 31 cost time: 19.093563556671143
Epoch: 31, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.974 Test Loss: 0.220 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1429s/iter; left time: 1107.1263s
	iters: 200, epoch: 32 | loss: 0.0001095
	speed: 0.0448s/iter; left time: 342.3321s
	iters: 300, epoch: 32 | loss: 0.0000574
	speed: 0.0368s/iter; left time: 278.0966s
	iters: 400, epoch: 32 | loss: 0.0001255
	speed: 0.0332s/iter; left time: 247.6183s
Epoch: 32 cost time: 16.560059309005737
Epoch: 32, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.255 Vali Acc: 0.971 Test Loss: 0.255 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1441s/iter; left time: 1057.2850s
	iters: 200, epoch: 33 | loss: 0.0000534
	speed: 0.0473s/iter; left time: 341.9887s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 245.7446s
	iters: 400, epoch: 33 | loss: 0.0000020
	speed: 0.0388s/iter; left time: 273.0604s
Epoch: 33 cost time: 17.2861487865448
Epoch: 33, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.979 Test Loss: 0.166 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 43908106
model size : 182.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3724718
	speed: 0.0869s/iter; left time: 1785.6924s
	iters: 200, epoch: 1 | loss: 0.4366520
	speed: 0.0475s/iter; left time: 972.0057s
	iters: 300, epoch: 1 | loss: 0.0389985
	speed: 0.0551s/iter; left time: 1121.7564s
	iters: 400, epoch: 1 | loss: 0.0014849
	speed: 0.0483s/iter; left time: 978.9848s
Epoch: 1 cost time: 24.81928539276123
Epoch: 1, Steps: 413 | Train Loss: 0.482 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2195476
	speed: 0.2001s/iter; left time: 4029.7290s
	iters: 200, epoch: 2 | loss: 0.0063467
	speed: 0.0584s/iter; left time: 1170.9277s
	iters: 300, epoch: 2 | loss: 0.0804470
	speed: 0.0607s/iter; left time: 1209.7981s
	iters: 400, epoch: 2 | loss: 0.3669348
	speed: 0.0530s/iter; left time: 1051.7297s
Epoch: 2 cost time: 24.824390649795532
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.966802 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008827
	speed: 0.2237s/iter; left time: 4412.7950s
	iters: 200, epoch: 3 | loss: 0.0000818
	speed: 0.0615s/iter; left time: 1206.6433s
	iters: 300, epoch: 3 | loss: 0.0028609
	speed: 0.0472s/iter; left time: 920.6770s
	iters: 400, epoch: 3 | loss: 0.0193784
	speed: 0.0451s/iter; left time: 876.1058s
Epoch: 3 cost time: 22.539088010787964
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0026855
	speed: 0.1707s/iter; left time: 3296.4842s
	iters: 200, epoch: 4 | loss: 0.4922570
	speed: 0.0633s/iter; left time: 1215.1629s
	iters: 300, epoch: 4 | loss: 0.0000272
	speed: 0.0543s/iter; left time: 1036.9091s
	iters: 400, epoch: 4 | loss: 0.0123637
	speed: 0.0612s/iter; left time: 1163.2147s
Epoch: 4 cost time: 23.776651859283447
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.975897 --> -0.979990).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000089
	speed: 0.1955s/iter; left time: 3695.6308s
	iters: 200, epoch: 5 | loss: 0.0000009
	speed: 0.0596s/iter; left time: 1121.1595s
	iters: 300, epoch: 5 | loss: 0.0001471
	speed: 0.0519s/iter; left time: 970.2827s
	iters: 400, epoch: 5 | loss: 0.0000006
	speed: 0.0553s/iter; left time: 1028.7178s
Epoch: 5 cost time: 22.52340078353882
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000019
	speed: 0.1837s/iter; left time: 3396.1595s
	iters: 200, epoch: 6 | loss: 0.0000008
	speed: 0.0643s/iter; left time: 1182.0043s
	iters: 300, epoch: 6 | loss: 0.0000125
	speed: 0.0624s/iter; left time: 1141.7596s
	iters: 400, epoch: 6 | loss: 0.0074106
	speed: 0.0572s/iter; left time: 1039.8493s
Epoch: 6 cost time: 25.67214608192444
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.978 Test Loss: 0.199 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0482685
	speed: 0.1868s/iter; left time: 3376.4592s
	iters: 200, epoch: 7 | loss: 0.0005437
	speed: 0.0626s/iter; left time: 1124.3401s
	iters: 300, epoch: 7 | loss: 0.0000254
	speed: 0.0621s/iter; left time: 1110.7001s
	iters: 400, epoch: 7 | loss: 0.4731976
	speed: 0.0439s/iter; left time: 780.2024s
Epoch: 7 cost time: 23.17088794708252
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
Validation loss decreased (-0.979990 --> -0.984537).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000475
	speed: 0.2113s/iter; left time: 3731.9501s
	iters: 200, epoch: 8 | loss: 0.0010886
	speed: 0.0618s/iter; left time: 1085.4986s
	iters: 300, epoch: 8 | loss: 0.0225562
	speed: 0.0596s/iter; left time: 1041.4629s
	iters: 400, epoch: 8 | loss: 0.2715912
	speed: 0.0590s/iter; left time: 1024.4151s
Epoch: 8 cost time: 25.84678077697754
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.308 Vali Acc: 0.968 Test Loss: 0.308 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2180s/iter; left time: 3760.4702s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1120.9532s
	iters: 300, epoch: 9 | loss: 0.0000185
	speed: 0.0634s/iter; left time: 1081.5411s
	iters: 400, epoch: 9 | loss: 0.1486053
	speed: 0.0617s/iter; left time: 1045.5799s
Epoch: 9 cost time: 27.631165742874146
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.984992).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1853s/iter; left time: 3120.0252s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0453s/iter; left time: 758.7793s
	iters: 300, epoch: 10 | loss: 0.0036449
	speed: 0.0446s/iter; left time: 741.0960s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 1083.8768s
Epoch: 10 cost time: 21.437991857528687
Epoch: 10, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.980 Test Loss: 0.190 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001015
	speed: 0.1783s/iter; left time: 2927.3266s
	iters: 200, epoch: 11 | loss: 0.0000044
	speed: 0.0603s/iter; left time: 984.7945s
	iters: 300, epoch: 11 | loss: 0.0000060
	speed: 0.0422s/iter; left time: 685.3246s
	iters: 400, epoch: 11 | loss: 0.0000989
	speed: 0.0633s/iter; left time: 1020.8991s
Epoch: 11 cost time: 23.758477926254272
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.190 Vali Acc: 0.980 Test Loss: 0.190 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0017720
	speed: 0.2016s/iter; left time: 3227.7633s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.0424s/iter; left time: 674.0703s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 987.1674s
	iters: 400, epoch: 12 | loss: 0.0071292
	speed: 0.0612s/iter; left time: 961.1382s
Epoch: 12 cost time: 23.934734344482422
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2032s/iter; left time: 3168.4864s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 936.8328s
	iters: 300, epoch: 13 | loss: 1.6648215
	speed: 0.0580s/iter; left time: 893.4696s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 906.6074s
Epoch: 13 cost time: 25.622323989868164
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.986 Test Loss: 0.114 Test Acc: 0.986
Validation loss decreased (-0.984992 --> -0.986356).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000031
	speed: 0.2020s/iter; left time: 3067.4840s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 665.9629s
	iters: 300, epoch: 14 | loss: 0.4191014
	speed: 0.0461s/iter; left time: 691.1830s
	iters: 400, epoch: 14 | loss: 0.4062697
	speed: 0.0491s/iter; left time: 731.3157s
Epoch: 14 cost time: 19.5798819065094
Epoch: 14, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.984 Test Loss: 0.150 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0001984
	speed: 0.1798s/iter; left time: 2654.8784s
	iters: 200, epoch: 15 | loss: 0.0007156
	speed: 0.0674s/iter; left time: 988.1981s
	iters: 300, epoch: 15 | loss: 0.0000024
	speed: 0.0616s/iter; left time: 898.0978s
	iters: 400, epoch: 15 | loss: 0.0000006
	speed: 0.0630s/iter; left time: 911.9306s
Epoch: 15 cost time: 25.851709604263306
Epoch: 15, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2038s/iter; left time: 2925.3534s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0540s/iter; left time: 769.8444s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 983.0430s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0681s/iter; left time: 957.1692s
Epoch: 16 cost time: 27.39196014404297
Epoch: 16, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.981 Test Loss: 0.164 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0001236
	speed: 0.1862s/iter; left time: 2595.9282s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 778.9514s
	iters: 300, epoch: 17 | loss: 0.0000060
	speed: 0.0593s/iter; left time: 815.4342s
	iters: 400, epoch: 17 | loss: 0.0000204
	speed: 0.0506s/iter; left time: 689.9918s
Epoch: 17 cost time: 24.06222629547119
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.981 Test Loss: 0.171 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0006118
	speed: 0.1904s/iter; left time: 2575.8021s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 747.8245s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 857.2025s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 790.9175s
Epoch: 18 cost time: 24.840827703475952
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.345 Vali Acc: 0.973 Test Loss: 0.345 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.2039s/iter; left time: 2674.4025s
	iters: 200, epoch: 19 | loss: 0.0000111
	speed: 0.0491s/iter; left time: 638.6788s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 706.5772s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 644.3666s
Epoch: 19 cost time: 22.736146688461304
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.237 Vali Acc: 0.982 Test Loss: 0.237 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1980s/iter; left time: 2515.8667s
	iters: 200, epoch: 20 | loss: 0.0000016
	speed: 0.0572s/iter; left time: 720.5143s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0625s/iter; left time: 781.0361s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 753.9671s
Epoch: 20 cost time: 25.111391067504883
Epoch: 20, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.581 Vali Acc: 0.964 Test Loss: 0.581 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2008s/iter; left time: 2468.1544s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 696.1361s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 672.1671s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0514s/iter; left time: 616.6081s
Epoch: 21 cost time: 23.628321647644043
Epoch: 21, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.982 Test Loss: 0.194 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2119s/iter; left time: 2517.1610s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 684.4174s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 624.3480s
	iters: 400, epoch: 22 | loss: 0.0000004
	speed: 0.0576s/iter; left time: 666.9844s
Epoch: 22 cost time: 24.707688093185425
Epoch: 22, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.982 Test Loss: 0.223 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2340s/iter; left time: 2682.8680s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 679.9796s
	iters: 300, epoch: 23 | loss: 0.0000067
	speed: 0.0727s/iter; left time: 818.5341s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 643.6711s
Epoch: 23 cost time: 26.6894793510437
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.363 Vali Acc: 0.965 Test Loss: 0.363 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 44090122
model size : 182.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6274027
	speed: 0.0763s/iter; left time: 1568.6760s
	iters: 200, epoch: 1 | loss: 0.1822416
	speed: 0.0593s/iter; left time: 1213.6631s
	iters: 300, epoch: 1 | loss: 0.2663963
	speed: 0.0469s/iter; left time: 953.8101s
	iters: 400, epoch: 1 | loss: 0.1588269
	speed: 0.0609s/iter; left time: 1232.9555s
Epoch: 1 cost time: 25.11745023727417
Epoch: 1, Steps: 413 | Train Loss: 0.533 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0196579
	speed: 0.1742s/iter; left time: 3507.4916s
	iters: 200, epoch: 2 | loss: 0.0185907
	speed: 0.0556s/iter; left time: 1113.6068s
	iters: 300, epoch: 2 | loss: 0.0304763
	speed: 0.0460s/iter; left time: 917.3193s
	iters: 400, epoch: 2 | loss: 0.0014672
	speed: 0.0567s/iter; left time: 1125.5894s
Epoch: 2 cost time: 22.28634762763977
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (-0.972714 --> -0.973624).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1414101
	speed: 0.1550s/iter; left time: 3058.3585s
	iters: 200, epoch: 3 | loss: 0.0056090
	speed: 0.0612s/iter; left time: 1201.6267s
	iters: 300, epoch: 3 | loss: 0.0004661
	speed: 0.0569s/iter; left time: 1110.3630s
	iters: 400, epoch: 3 | loss: 0.4186253
	speed: 0.0615s/iter; left time: 1193.7082s
Epoch: 3 cost time: 24.281965732574463
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0006675
	speed: 0.1651s/iter; left time: 3188.2648s
	iters: 200, epoch: 4 | loss: 0.0011964
	speed: 0.0433s/iter; left time: 832.4625s
	iters: 300, epoch: 4 | loss: 0.0006821
	speed: 0.0467s/iter; left time: 892.3680s
	iters: 400, epoch: 4 | loss: 0.0755212
	speed: 0.0492s/iter; left time: 935.0204s
Epoch: 4 cost time: 19.594088315963745
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0031929
	speed: 0.1601s/iter; left time: 3026.2061s
	iters: 200, epoch: 5 | loss: 0.0043222
	speed: 0.0517s/iter; left time: 972.6670s
	iters: 300, epoch: 5 | loss: 0.0331486
	speed: 0.0572s/iter; left time: 1069.3176s
	iters: 400, epoch: 5 | loss: 0.0000382
	speed: 0.0609s/iter; left time: 1132.3926s
Epoch: 5 cost time: 24.364110469818115
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.973624 --> -0.975442).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0052254
	speed: 0.1727s/iter; left time: 3192.7956s
	iters: 200, epoch: 6 | loss: 0.0002985
	speed: 0.0678s/iter; left time: 1246.1348s
	iters: 300, epoch: 6 | loss: 0.0000841
	speed: 0.0469s/iter; left time: 857.8927s
	iters: 400, epoch: 6 | loss: 0.0096399
	speed: 0.0643s/iter; left time: 1168.6269s
Epoch: 6 cost time: 25.57074475288391
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000041
	speed: 0.1514s/iter; left time: 2736.7974s
	iters: 200, epoch: 7 | loss: 0.0006476
	speed: 0.0450s/iter; left time: 809.3469s
	iters: 300, epoch: 7 | loss: 0.2726118
	speed: 0.0622s/iter; left time: 1111.7548s
	iters: 400, epoch: 7 | loss: 0.0128025
	speed: 0.0567s/iter; left time: 1007.2314s
Epoch: 7 cost time: 23.75602889060974
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
Validation loss decreased (-0.975442 --> -0.985447).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0005282
	speed: 0.1527s/iter; left time: 2695.9181s
	iters: 200, epoch: 8 | loss: 0.0000636
	speed: 0.0643s/iter; left time: 1128.4690s
	iters: 300, epoch: 8 | loss: 0.2871850
	speed: 0.0595s/iter; left time: 1039.0662s
	iters: 400, epoch: 8 | loss: 0.0000298
	speed: 0.0506s/iter; left time: 878.7004s
Epoch: 8 cost time: 24.154846906661987
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0009683
	speed: 0.1651s/iter; left time: 2846.8044s
	iters: 200, epoch: 9 | loss: 0.0000469
	speed: 0.0561s/iter; left time: 961.4391s
	iters: 300, epoch: 9 | loss: 0.0002111
	speed: 0.0567s/iter; left time: 967.0263s
	iters: 400, epoch: 9 | loss: 0.0002089
	speed: 0.0599s/iter; left time: 1015.2026s
Epoch: 9 cost time: 23.893696546554565
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000009
	speed: 0.1615s/iter; left time: 2719.0981s
	iters: 200, epoch: 10 | loss: 0.0000138
	speed: 0.0417s/iter; left time: 698.1613s
	iters: 300, epoch: 10 | loss: 0.0176366
	speed: 0.0408s/iter; left time: 678.5242s
	iters: 400, epoch: 10 | loss: 0.0000205
	speed: 0.0399s/iter; left time: 659.4568s
Epoch: 10 cost time: 19.516514778137207
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000147
	speed: 0.1248s/iter; left time: 2048.9486s
	iters: 200, epoch: 11 | loss: 0.0000124
	speed: 0.0370s/iter; left time: 603.9976s
	iters: 300, epoch: 11 | loss: 0.0529595
	speed: 0.0493s/iter; left time: 799.5475s
	iters: 400, epoch: 11 | loss: 0.0063396
	speed: 0.0566s/iter; left time: 913.0556s
Epoch: 11 cost time: 19.65252161026001
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.1568s/iter; left time: 2510.7687s
	iters: 200, epoch: 12 | loss: 0.0000787
	speed: 0.0547s/iter; left time: 870.8518s
	iters: 300, epoch: 12 | loss: 0.0000032
	speed: 0.0471s/iter; left time: 744.2153s
	iters: 400, epoch: 12 | loss: 0.0000060
	speed: 0.0596s/iter; left time: 935.5545s
Epoch: 12 cost time: 22.660598278045654
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000047
	speed: 0.1543s/iter; left time: 2406.8090s
	iters: 200, epoch: 13 | loss: 0.0000906
	speed: 0.0512s/iter; left time: 794.0172s
	iters: 300, epoch: 13 | loss: 0.0000050
	speed: 0.0360s/iter; left time: 554.0460s
	iters: 400, epoch: 13 | loss: 0.0170458
	speed: 0.0460s/iter; left time: 703.1148s
Epoch: 13 cost time: 19.914175748825073
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1260s/iter; left time: 1913.1023s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0487s/iter; left time: 735.1750s
	iters: 300, epoch: 14 | loss: 0.0000016
	speed: 0.0590s/iter; left time: 883.3639s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0648s/iter; left time: 963.6998s
Epoch: 14 cost time: 23.23762083053589
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000061
	speed: 0.1530s/iter; left time: 2259.6415s
	iters: 200, epoch: 15 | loss: 0.0000636
	speed: 0.0618s/iter; left time: 906.2898s
	iters: 300, epoch: 15 | loss: 0.0050766
	speed: 0.0572s/iter; left time: 833.3794s
	iters: 400, epoch: 15 | loss: 0.0000011
	speed: 0.0626s/iter; left time: 905.6243s
Epoch: 15 cost time: 23.68824553489685
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0006093
	speed: 0.1656s/iter; left time: 2377.2732s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 849.1142s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 801.3802s
	iters: 400, epoch: 16 | loss: 0.1938698
	speed: 0.0659s/iter; left time: 926.0242s
Epoch: 16 cost time: 25.46730327606201
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.978 Test Loss: 0.165 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1604s/iter; left time: 2236.4296s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 717.9789s
	iters: 300, epoch: 17 | loss: 0.0000019
	speed: 0.0592s/iter; left time: 814.2711s
	iters: 400, epoch: 17 | loss: 0.0000760
	speed: 0.0635s/iter; left time: 865.7126s
Epoch: 17 cost time: 24.80988097190857
Epoch: 17, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.976 Test Loss: 0.175 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 44025610
model size : 182.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8475313
	speed: 0.0703s/iter; left time: 1445.3667s
	iters: 200, epoch: 1 | loss: 0.3644223
	speed: 0.0457s/iter; left time: 935.1712s
	iters: 300, epoch: 1 | loss: 0.1375480
	speed: 0.0558s/iter; left time: 1135.5864s
	iters: 400, epoch: 1 | loss: 0.3130066
	speed: 0.0425s/iter; left time: 861.4026s
Epoch: 1 cost time: 22.04086685180664
Epoch: 1, Steps: 413 | Train Loss: 0.574 Vali Loss: 0.090 Vali Acc: 0.967 Test Loss: 0.090 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1872381
	speed: 0.1385s/iter; left time: 2788.6001s
	iters: 200, epoch: 2 | loss: 0.0247041
	speed: 0.0536s/iter; left time: 1073.1264s
	iters: 300, epoch: 2 | loss: 0.0053913
	speed: 0.0374s/iter; left time: 746.4253s
	iters: 400, epoch: 2 | loss: 0.0838109
	speed: 0.0583s/iter; left time: 1156.0742s
Epoch: 2 cost time: 21.009405374526978
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0039067
	speed: 0.1505s/iter; left time: 2968.2341s
	iters: 200, epoch: 3 | loss: 0.0025276
	speed: 0.0506s/iter; left time: 992.9296s
	iters: 300, epoch: 3 | loss: 0.0076170
	speed: 0.0476s/iter; left time: 929.6483s
	iters: 400, epoch: 3 | loss: 0.0003796
	speed: 0.0557s/iter; left time: 1081.1583s
Epoch: 3 cost time: 21.80748176574707
Epoch: 3, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.966802 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0208987
	speed: 0.1686s/iter; left time: 3255.1554s
	iters: 200, epoch: 4 | loss: 0.0039487
	speed: 0.0505s/iter; left time: 969.4127s
	iters: 300, epoch: 4 | loss: 0.0003270
	speed: 0.0549s/iter; left time: 1049.8341s
	iters: 400, epoch: 4 | loss: 0.0018596
	speed: 0.0479s/iter; left time: 910.8084s
Epoch: 4 cost time: 22.372708082199097
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0015071
	speed: 0.1474s/iter; left time: 2786.1525s
	iters: 200, epoch: 5 | loss: 0.0000038
	speed: 0.0413s/iter; left time: 776.1403s
	iters: 300, epoch: 5 | loss: 0.0014388
	speed: 0.0480s/iter; left time: 898.0013s
	iters: 400, epoch: 5 | loss: 0.0981363
	speed: 0.0539s/iter; left time: 1001.5695s
Epoch: 5 cost time: 21.126498460769653
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0025964
	speed: 0.1497s/iter; left time: 2768.2267s
	iters: 200, epoch: 6 | loss: 0.0004512
	speed: 0.0476s/iter; left time: 875.7516s
	iters: 300, epoch: 6 | loss: 0.0003817
	speed: 0.0645s/iter; left time: 1179.4856s
	iters: 400, epoch: 6 | loss: 0.0669522
	speed: 0.0488s/iter; left time: 887.7848s
Epoch: 6 cost time: 22.70742130279541
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0010133
	speed: 0.1622s/iter; left time: 2931.6540s
	iters: 200, epoch: 7 | loss: 0.0354255
	speed: 0.0638s/iter; left time: 1147.1668s
	iters: 300, epoch: 7 | loss: 0.0002323
	speed: 0.0593s/iter; left time: 1060.4266s
	iters: 400, epoch: 7 | loss: 0.0016192
	speed: 0.0630s/iter; left time: 1119.9604s
Epoch: 7 cost time: 25.852802515029907
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0185190
	speed: 0.1731s/iter; left time: 3057.8176s
	iters: 200, epoch: 8 | loss: 0.0006109
	speed: 0.0668s/iter; left time: 1173.8667s
	iters: 300, epoch: 8 | loss: 0.0038047
	speed: 0.0604s/iter; left time: 1054.5106s
	iters: 400, epoch: 8 | loss: 0.0001476
	speed: 0.0625s/iter; left time: 1085.1877s
Epoch: 8 cost time: 26.704120635986328
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.961 Test Loss: 0.207 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000763
	speed: 0.1650s/iter; left time: 2845.7859s
	iters: 200, epoch: 9 | loss: 0.0047376
	speed: 0.0531s/iter; left time: 911.0300s
	iters: 300, epoch: 9 | loss: 0.0041759
	speed: 0.0473s/iter; left time: 806.3679s
	iters: 400, epoch: 9 | loss: 0.0000051
	speed: 0.0463s/iter; left time: 785.2959s
Epoch: 9 cost time: 22.582038640975952
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000195
	speed: 0.1529s/iter; left time: 2573.1716s
	iters: 200, epoch: 10 | loss: 0.0014093
	speed: 0.0636s/iter; left time: 1064.8687s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 1079.6172s
	iters: 400, epoch: 10 | loss: 0.0000052
	speed: 0.0463s/iter; left time: 765.8755s
Epoch: 10 cost time: 25.483159065246582
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0009366
	speed: 0.1579s/iter; left time: 2593.2151s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 1002.7043s
	iters: 300, epoch: 11 | loss: 0.0000019
	speed: 0.0657s/iter; left time: 1066.3744s
	iters: 400, epoch: 11 | loss: 0.0000038
	speed: 0.0471s/iter; left time: 758.8337s
Epoch: 11 cost time: 23.987630605697632
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0005100
	speed: 0.1398s/iter; left time: 2238.2061s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0589s/iter; left time: 936.4439s
	iters: 300, epoch: 12 | loss: 0.0000082
	speed: 0.0549s/iter; left time: 868.3599s
	iters: 400, epoch: 12 | loss: 0.0000524
	speed: 0.0596s/iter; left time: 936.1842s
Epoch: 12 cost time: 22.140331745147705
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1518s/iter; left time: 2367.3321s
	iters: 200, epoch: 13 | loss: 0.0000106
	speed: 0.0482s/iter; left time: 747.3251s
	iters: 300, epoch: 13 | loss: 0.0000005
	speed: 0.0594s/iter; left time: 913.8877s
	iters: 400, epoch: 13 | loss: 0.0000823
	speed: 0.0627s/iter; left time: 959.6839s
Epoch: 13 cost time: 23.995537042617798
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980445).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1862s/iter; left time: 2826.9396s
	iters: 200, epoch: 14 | loss: 0.0000004
	speed: 0.0630s/iter; left time: 949.7788s
	iters: 300, epoch: 14 | loss: 0.0019638
	speed: 0.0613s/iter; left time: 918.4898s
	iters: 400, epoch: 14 | loss: 0.0000130
	speed: 0.0639s/iter; left time: 950.7875s
Epoch: 14 cost time: 26.528794288635254
Epoch: 14, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.1658s/iter; left time: 2448.4698s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0666s/iter; left time: 977.4332s
	iters: 300, epoch: 15 | loss: 0.0044415
	speed: 0.0628s/iter; left time: 915.0363s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0541s/iter; left time: 782.2260s
Epoch: 15 cost time: 25.374866485595703
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000109
	speed: 0.1532s/iter; left time: 2199.6628s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0594s/iter; left time: 847.3788s
	iters: 300, epoch: 16 | loss: 0.0000021
	speed: 0.0588s/iter; left time: 832.6227s
	iters: 400, epoch: 16 | loss: 0.0000006
	speed: 0.0558s/iter; left time: 784.8972s
Epoch: 16 cost time: 24.39236855506897
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.1584s/iter; left time: 2208.2740s
	iters: 200, epoch: 17 | loss: 0.0005527
	speed: 0.0656s/iter; left time: 907.9854s
	iters: 300, epoch: 17 | loss: 0.0008299
	speed: 0.0776s/iter; left time: 1066.7396s
	iters: 400, epoch: 17 | loss: 0.0078092
	speed: 0.0632s/iter; left time: 862.2094s
Epoch: 17 cost time: 27.696210145950317
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.974 Test Loss: 0.231 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0133328
	speed: 0.1778s/iter; left time: 2405.4452s
	iters: 200, epoch: 18 | loss: 0.0000008
	speed: 0.0808s/iter; left time: 1084.5948s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 839.2330s
	iters: 400, epoch: 18 | loss: 0.0000261
	speed: 0.0672s/iter; left time: 889.1186s
Epoch: 18 cost time: 28.095807790756226
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1795s/iter; left time: 2354.8043s
	iters: 200, epoch: 19 | loss: 0.0000670
	speed: 0.0699s/iter; left time: 909.7049s
	iters: 300, epoch: 19 | loss: 0.0000006
	speed: 0.0704s/iter; left time: 909.0870s
	iters: 400, epoch: 19 | loss: 0.0003827
	speed: 0.0790s/iter; left time: 1012.3298s
Epoch: 19 cost time: 30.310365915298462
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0005254
	speed: 0.1955s/iter; left time: 2483.7345s
	iters: 200, epoch: 20 | loss: 0.0000004
	speed: 0.0739s/iter; left time: 931.3501s
	iters: 300, epoch: 20 | loss: 0.0000444
	speed: 0.0597s/iter; left time: 746.3355s
	iters: 400, epoch: 20 | loss: 0.0000414
	speed: 0.0820s/iter; left time: 1016.7527s
Epoch: 20 cost time: 30.179972410202026
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000084
	speed: 0.1926s/iter; left time: 2367.0876s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.0728s/iter; left time: 887.0851s
	iters: 300, epoch: 21 | loss: 0.0000003
	speed: 0.0757s/iter; left time: 915.7668s
	iters: 400, epoch: 21 | loss: 0.0003157
	speed: 0.0647s/iter; left time: 775.5080s
Epoch: 21 cost time: 30.687673807144165
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.969 Test Loss: 0.252 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000008
	speed: 0.2086s/iter; left time: 2477.7013s
	iters: 200, epoch: 22 | loss: 0.0000164
	speed: 0.0649s/iter; left time: 764.5479s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0785s/iter; left time: 916.3604s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0645s/iter; left time: 747.2275s
Epoch: 22 cost time: 29.44387650489807
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000076
	speed: 0.1745s/iter; left time: 2000.4360s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 891.1856s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 812.2148s
	iters: 400, epoch: 23 | loss: 0.0000014
	speed: 0.0830s/iter; left time: 926.4609s
Epoch: 23 cost time: 31.33123755455017
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 43988746
model size : 182.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3404925
	speed: 0.2562s/iter; left time: 5265.3220s
	iters: 200, epoch: 1 | loss: 0.0809718
	speed: 0.2256s/iter; left time: 4613.6638s
	iters: 300, epoch: 1 | loss: 0.6054131
	speed: 0.2514s/iter; left time: 5115.7865s
	iters: 400, epoch: 1 | loss: 0.3929838
	speed: 0.2086s/iter; left time: 4223.7879s
Epoch: 1 cost time: 96.27520275115967
Epoch: 1, Steps: 413 | Train Loss: 0.584 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (inf --> -0.965437).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0069516
	speed: 0.5159s/iter; left time: 10389.5175s
	iters: 200, epoch: 2 | loss: 0.0003089
	speed: 0.2318s/iter; left time: 4644.2253s
	iters: 300, epoch: 2 | loss: 0.0077050
	speed: 0.2192s/iter; left time: 4369.4977s
	iters: 400, epoch: 2 | loss: 0.0840932
	speed: 0.2420s/iter; left time: 4799.8635s
Epoch: 2 cost time: 94.32566785812378
Epoch: 2, Steps: 413 | Train Loss: 0.258 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
Validation loss decreased (-0.965437 --> -0.973622).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000105
	speed: 0.5615s/iter; left time: 11075.3466s
	iters: 200, epoch: 3 | loss: 0.3955548
	speed: 0.2099s/iter; left time: 4118.8640s
	iters: 300, epoch: 3 | loss: 0.0012591
	speed: 0.2297s/iter; left time: 4485.2199s
	iters: 400, epoch: 3 | loss: 0.0000579
	speed: 0.2281s/iter; left time: 4431.3976s
Epoch: 3 cost time: 90.48564004898071
Epoch: 3, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.255 Vali Acc: 0.968 Test Loss: 0.255 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4910769
	speed: 0.5835s/iter; left time: 11268.1315s
	iters: 200, epoch: 4 | loss: 0.1382096
	speed: 0.2441s/iter; left time: 4689.3269s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.2369s/iter; left time: 4527.4649s
	iters: 400, epoch: 4 | loss: 0.0000014
	speed: 0.2410s/iter; left time: 4582.7145s
Epoch: 4 cost time: 98.41093349456787
Epoch: 4, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.180 Vali Acc: 0.984 Test Loss: 0.180 Test Acc: 0.984
Validation loss decreased (-0.973622 --> -0.983627).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.5889s/iter; left time: 11129.0273s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.2157s/iter; left time: 4054.5469s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.2248s/iter; left time: 4202.8416s
	iters: 400, epoch: 5 | loss: 0.6438485
	speed: 0.2289s/iter; left time: 4257.4193s
Epoch: 5 cost time: 92.08196949958801
Epoch: 5, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.253 Vali Acc: 0.979 Test Loss: 0.253 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000004
	speed: 0.5353s/iter; left time: 9896.3296s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.1839s/iter; left time: 3381.6907s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.2086s/iter; left time: 3814.4468s
	iters: 400, epoch: 6 | loss: 1.2319337
	speed: 0.2131s/iter; left time: 3876.1880s
Epoch: 6 cost time: 80.94178938865662
Epoch: 6, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.362 Vali Acc: 0.967 Test Loss: 0.362 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9276466
	speed: 0.5220s/iter; left time: 9434.8389s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.2062s/iter; left time: 3706.1460s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.1989s/iter; left time: 3555.0641s
	iters: 400, epoch: 7 | loss: 0.0000024
	speed: 0.2174s/iter; left time: 3863.3786s
Epoch: 7 cost time: 85.88491797447205
Epoch: 7, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.245 Vali Acc: 0.985 Test Loss: 0.245 Test Acc: 0.985
Validation loss decreased (-0.983627 --> -0.984536).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.5718s/iter; left time: 10098.5292s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.2285s/iter; left time: 4012.5343s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2002s/iter; left time: 3494.9657s
	iters: 400, epoch: 8 | loss: 0.0000083
	speed: 0.1725s/iter; left time: 2994.0314s
Epoch: 8 cost time: 84.01173949241638
Epoch: 8, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.408 Vali Acc: 0.980 Test Loss: 0.408 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000645
	speed: 0.4229s/iter; left time: 7294.2365s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1766s/iter; left time: 3028.8550s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1729s/iter; left time: 2947.8413s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1781s/iter; left time: 3018.7623s
Epoch: 9 cost time: 71.37823247909546
Epoch: 9, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.233 Vali Acc: 0.985 Test Loss: 0.233 Test Acc: 0.985
Validation loss decreased (-0.984536 --> -0.985446).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.4833s/iter; left time: 8135.5693s
	iters: 200, epoch: 10 | loss: 0.0000145
	speed: 0.1878s/iter; left time: 3143.3927s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1820s/iter; left time: 3027.6797s
	iters: 400, epoch: 10 | loss: 0.8016434
	speed: 0.1912s/iter; left time: 3161.3413s
Epoch: 10 cost time: 77.28073859214783
Epoch: 10, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.444 Vali Acc: 0.976 Test Loss: 0.444 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.4715s/iter; left time: 7741.9172s
	iters: 200, epoch: 11 | loss: 0.0000289
	speed: 0.1672s/iter; left time: 2729.3928s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1615s/iter; left time: 2620.3131s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1580s/iter; left time: 2546.7790s
Epoch: 11 cost time: 69.86656188964844
Epoch: 11, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.547 Vali Acc: 0.974 Test Loss: 0.547 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.4234s/iter; left time: 6777.8327s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1711s/iter; left time: 2721.3236s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1750s/iter; left time: 2766.4651s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1660s/iter; left time: 2608.1762s
Epoch: 12 cost time: 70.1301441192627
Epoch: 12, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.620 Vali Acc: 0.970 Test Loss: 0.620 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.4724s/iter; left time: 7367.3232s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1938s/iter; left time: 3002.8907s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1863s/iter; left time: 2868.3291s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1728s/iter; left time: 2642.8334s
Epoch: 13 cost time: 76.84047651290894
Epoch: 13, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.518 Vali Acc: 0.979 Test Loss: 0.518 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.4037s/iter; left time: 6129.2989s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1489s/iter; left time: 2246.3178s
	iters: 300, epoch: 14 | loss: 0.0011131
	speed: 0.1521s/iter; left time: 2279.3019s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1648s/iter; left time: 2452.8298s
Epoch: 14 cost time: 64.01009726524353
Epoch: 14, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.510 Vali Acc: 0.975 Test Loss: 0.510 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4411s/iter; left time: 6514.4500s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1758s/iter; left time: 2578.3731s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1770s/iter; left time: 2578.1859s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1790s/iter; left time: 2589.3844s
Epoch: 15 cost time: 73.16620516777039
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.647 Vali Acc: 0.976 Test Loss: 0.647 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.4534s/iter; left time: 6508.7446s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1850s/iter; left time: 2636.8644s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 2225.4335s
	iters: 400, epoch: 16 | loss: 0.0000401
	speed: 0.1538s/iter; left time: 2161.1951s
Epoch: 16 cost time: 69.3568844795227
Epoch: 16, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.613 Vali Acc: 0.978 Test Loss: 0.613 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3733s/iter; left time: 5204.2384s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1732s/iter; left time: 2397.7437s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1612s/iter; left time: 2215.1473s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1378s/iter; left time: 1880.3087s
Epoch: 17 cost time: 62.307737588882446
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.733 Vali Acc: 0.978 Test Loss: 0.733 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3687s/iter; left time: 4988.0760s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1693s/iter; left time: 2273.2704s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1833s/iter; left time: 2443.0148s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1767s/iter; left time: 2337.4634s
Epoch: 18 cost time: 68.97350311279297
Epoch: 18, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.608 Vali Acc: 0.979 Test Loss: 0.608 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.4614s/iter; left time: 6052.0167s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1717s/iter; left time: 2234.4747s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1583s/iter; left time: 2044.7765s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1712s/iter; left time: 2193.9211s
Epoch: 19 cost time: 70.61266088485718
Epoch: 19, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.484 Vali Acc: 0.985 Test Loss: 0.484 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 37244170
model size : 156.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6770747
	speed: 0.1469s/iter; left time: 3019.0703s
	iters: 200, epoch: 1 | loss: 0.5332627
	speed: 0.1353s/iter; left time: 2767.1916s
	iters: 300, epoch: 1 | loss: 0.2512659
	speed: 0.1345s/iter; left time: 2738.1463s
	iters: 400, epoch: 1 | loss: 0.0007699
	speed: 0.1369s/iter; left time: 2771.8854s
Epoch: 1 cost time: 56.93432354927063
Epoch: 1, Steps: 413 | Train Loss: 0.538 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0028337
	speed: 0.3187s/iter; left time: 6418.6853s
	iters: 200, epoch: 2 | loss: 0.0101291
	speed: 0.1213s/iter; left time: 2431.5476s
	iters: 300, epoch: 2 | loss: 0.0002973
	speed: 0.1209s/iter; left time: 2411.4898s
	iters: 400, epoch: 2 | loss: 0.0000089
	speed: 0.1274s/iter; left time: 2526.7269s
Epoch: 2 cost time: 50.925562143325806
Epoch: 2, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.966802 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000002
	speed: 0.2855s/iter; left time: 5631.2442s
	iters: 200, epoch: 3 | loss: 0.0000022
	speed: 0.1041s/iter; left time: 2043.4997s
	iters: 300, epoch: 3 | loss: 0.6204638
	speed: 0.1353s/iter; left time: 2642.3587s
	iters: 400, epoch: 3 | loss: 0.0002109
	speed: 0.1317s/iter; left time: 2558.7656s
Epoch: 3 cost time: 49.49184584617615
Epoch: 3, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.974533 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.3415s/iter; left time: 6595.5152s
	iters: 200, epoch: 4 | loss: 0.0001237
	speed: 0.1425s/iter; left time: 2737.3579s
	iters: 300, epoch: 4 | loss: 0.0000002
	speed: 0.1380s/iter; left time: 2636.6136s
	iters: 400, epoch: 4 | loss: 0.6106511
	speed: 0.1228s/iter; left time: 2335.5472s
Epoch: 4 cost time: 55.881672620773315
Epoch: 4, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001816
	speed: 0.3441s/iter; left time: 6503.0527s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.1355s/iter; left time: 2547.1795s
	iters: 300, epoch: 5 | loss: 0.0000078
	speed: 0.1328s/iter; left time: 2484.0340s
	iters: 400, epoch: 5 | loss: 0.0000020
	speed: 0.1358s/iter; left time: 2526.2352s
Epoch: 5 cost time: 55.91023302078247
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000040
	speed: 0.3292s/iter; left time: 6085.8994s
	iters: 200, epoch: 6 | loss: 0.0000247
	speed: 0.1166s/iter; left time: 2144.4762s
	iters: 300, epoch: 6 | loss: 0.0000030
	speed: 0.1383s/iter; left time: 2529.3434s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1337s/iter; left time: 2432.2361s
Epoch: 6 cost time: 51.56055021286011
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.973 Test Loss: 0.245 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3580s/iter; left time: 6470.7325s
	iters: 200, epoch: 7 | loss: 0.0000121
	speed: 0.1206s/iter; left time: 2168.2340s
	iters: 300, epoch: 7 | loss: 0.0008093
	speed: 0.1358s/iter; left time: 2427.4437s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.1257s/iter; left time: 2234.2535s
Epoch: 7 cost time: 54.6175754070282
Epoch: 7, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000173
	speed: 0.3582s/iter; left time: 6326.0063s
	iters: 200, epoch: 8 | loss: 0.0032446
	speed: 0.1423s/iter; left time: 2499.3377s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1292s/iter; left time: 2255.2456s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1440s/iter; left time: 2499.3549s
Epoch: 8 cost time: 57.44781470298767
Epoch: 8, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.175 Vali Acc: 0.982 Test Loss: 0.175 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.981808).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000088
	speed: 0.3504s/iter; left time: 6042.5940s
	iters: 200, epoch: 9 | loss: 0.0014350
	speed: 0.1117s/iter; left time: 1915.1674s
	iters: 300, epoch: 9 | loss: 0.2878977
	speed: 0.1476s/iter; left time: 2515.9385s
	iters: 400, epoch: 9 | loss: 0.0000022
	speed: 0.1519s/iter; left time: 2574.1962s
Epoch: 9 cost time: 54.67007803916931
Epoch: 9, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.313 Vali Acc: 0.965 Test Loss: 0.313 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0001165
	speed: 0.3544s/iter; left time: 5965.8634s
	iters: 200, epoch: 10 | loss: 0.0000090
	speed: 0.1224s/iter; left time: 2047.6429s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.1152s/iter; left time: 1915.6176s
	iters: 400, epoch: 10 | loss: 0.0024112
	speed: 0.1136s/iter; left time: 1877.5508s
Epoch: 10 cost time: 49.52266788482666
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.158 Vali Acc: 0.982 Test Loss: 0.158 Test Acc: 0.982
Validation loss decreased (-0.981808 --> -0.981808).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3028s/iter; left time: 4971.5308s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1179s/iter; left time: 1923.6436s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1093s/iter; left time: 1772.5004s
	iters: 400, epoch: 11 | loss: 0.0095299
	speed: 0.1112s/iter; left time: 1792.4608s
Epoch: 11 cost time: 46.613855838775635
Epoch: 11, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.422 Vali Acc: 0.972 Test Loss: 0.422 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3206s/iter; left time: 5131.4796s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 2098.7703s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1511s/iter; left time: 2388.6149s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1394s/iter; left time: 2189.0723s
Epoch: 12 cost time: 56.28421139717102
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.302 Vali Acc: 0.980 Test Loss: 0.302 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3014s/iter; left time: 4701.0561s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.1300s/iter; left time: 2014.4360s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1331s/iter; left time: 2048.6873s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1206s/iter; left time: 1844.6242s
Epoch: 13 cost time: 51.003973960876465
Epoch: 13, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.246 Vali Acc: 0.984 Test Loss: 0.246 Test Acc: 0.984
Validation loss decreased (-0.981808 --> -0.984081).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.3280s/iter; left time: 4979.8244s
	iters: 200, epoch: 14 | loss: 0.2300028
	speed: 0.1082s/iter; left time: 1631.7147s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 1063.3101s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 1365.1141s
Epoch: 14 cost time: 40.00325584411621
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.986 Test Loss: 0.204 Test Acc: 0.986
Validation loss decreased (-0.984081 --> -0.986355).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2330s/iter; left time: 3440.6566s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0608s/iter; left time: 892.2073s
	iters: 300, epoch: 15 | loss: 0.0000006
	speed: 0.1092s/iter; left time: 1591.4835s
	iters: 400, epoch: 15 | loss: 1.3713006
	speed: 0.1061s/iter; left time: 1535.5058s
Epoch: 15 cost time: 35.266568183898926
Epoch: 15, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.174 Vali Acc: 0.985 Test Loss: 0.174 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000926
	speed: 0.3271s/iter; left time: 4695.6981s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 1880.2979s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1316s/iter; left time: 1863.0627s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1152s/iter; left time: 1618.7575s
Epoch: 16 cost time: 52.181654930114746
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.985 Test Loss: 0.217 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3160s/iter; left time: 4405.6706s
	iters: 200, epoch: 17 | loss: 0.7830689
	speed: 0.0977s/iter; left time: 1351.9005s
	iters: 300, epoch: 17 | loss: 0.0000136
	speed: 0.1128s/iter; left time: 1550.1462s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1238s/iter; left time: 1689.2790s
Epoch: 17 cost time: 46.98000383377075
Epoch: 17, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.313 Vali Acc: 0.985 Test Loss: 0.313 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2802s/iter; left time: 3791.7027s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 1357.9130s
	iters: 300, epoch: 18 | loss: 0.0000157
	speed: 0.1210s/iter; left time: 1612.6115s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1318s/iter; left time: 1743.2638s
Epoch: 18 cost time: 46.467761278152466
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.987 Test Loss: 0.183 Test Acc: 0.987
Validation loss decreased (-0.986355 --> -0.986810).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3633s/iter; left time: 4765.7499s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1114s/iter; left time: 1449.6516s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1252s/iter; left time: 1617.8286s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1102s/iter; left time: 1413.0008s
Epoch: 19 cost time: 49.67331290245056
Epoch: 19, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.393 Vali Acc: 0.980 Test Loss: 0.393 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3072s/iter; left time: 3902.3618s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1074s/iter; left time: 1353.3400s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 1389.3604s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 1449.2905s
Epoch: 20 cost time: 47.25608730316162
Epoch: 20, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.488 Vali Acc: 0.985 Test Loss: 0.488 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2808s/iter; left time: 3450.8766s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1248s/iter; left time: 1521.7386s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.1214s/iter; left time: 1468.0986s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1221s/iter; left time: 1463.7638s
Epoch: 21 cost time: 49.11706066131592
Epoch: 21, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.256 Vali Acc: 0.984 Test Loss: 0.256 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3307s/iter; left time: 3927.8842s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1263s/iter; left time: 1487.3634s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1138s/iter; left time: 1328.3982s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 1003.7273s
Epoch: 22 cost time: 46.729671478271484
Epoch: 22, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.717 Vali Acc: 0.970 Test Loss: 0.717 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.3375s/iter; left time: 3869.0427s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 1183.8171s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1134s/iter; left time: 1277.2765s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1467s/iter; left time: 1637.4608s
Epoch: 23 cost time: 52.415762186050415
Epoch: 23, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.225 Vali Acc: 0.986 Test Loss: 0.225 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.3787s/iter; left time: 4184.9167s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 1722.1608s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1628s/iter; left time: 1766.7611s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1655s/iter; left time: 1779.2048s
Epoch: 24 cost time: 66.1335346698761
Epoch: 24, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.447 Vali Acc: 0.981 Test Loss: 0.447 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.4117s/iter; left time: 4380.0283s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1696s/iter; left time: 1787.2886s
	iters: 300, epoch: 25 | loss: 0.0585383
	speed: 0.1554s/iter; left time: 1622.2494s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1550s/iter; left time: 1602.7667s
Epoch: 25 cost time: 67.49536991119385
Epoch: 25, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.390 Vali Acc: 0.979 Test Loss: 0.390 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.3306s/iter; left time: 3380.4238s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1360s/iter; left time: 1377.5829s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1408s/iter; left time: 1411.5774s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1292s/iter; left time: 1282.4241s
Epoch: 26 cost time: 53.29163479804993
Epoch: 26, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.347 Vali Acc: 0.985 Test Loss: 0.347 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3821s/iter; left time: 3749.3317s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1632s/iter; left time: 1585.1264s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1663s/iter; left time: 1599.0044s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1588s/iter; left time: 1510.5693s
Epoch: 27 cost time: 66.86259770393372
Epoch: 27, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.325 Vali Acc: 0.986 Test Loss: 0.325 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3275s/iter; left time: 3078.2110s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1109s/iter; left time: 1031.0646s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1341s/iter; left time: 1233.3497s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1258s/iter; left time: 1144.8829s
Epoch: 28 cost time: 51.199450731277466
Epoch: 28, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.325 Vali Acc: 0.986 Test Loss: 0.325 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 36829450
model size : 155.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3882871
	speed: 0.1434s/iter; left time: 2947.4665s
	iters: 200, epoch: 1 | loss: 0.0494395
	speed: 0.1125s/iter; left time: 2301.0128s
	iters: 300, epoch: 1 | loss: 0.6019640
	speed: 0.1120s/iter; left time: 2278.3169s
	iters: 400, epoch: 1 | loss: 0.1559793
	speed: 0.1312s/iter; left time: 2657.8024s
Epoch: 1 cost time: 52.08377146720886
Epoch: 1, Steps: 413 | Train Loss: 0.534 Vali Loss: 0.281 Vali Acc: 0.927 Test Loss: 0.281 Test Acc: 0.927
Validation loss decreased (inf --> -0.927237).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0061305
	speed: 0.3038s/iter; left time: 6117.2648s
	iters: 200, epoch: 2 | loss: 0.0501858
	speed: 0.1475s/iter; left time: 2955.3686s
	iters: 300, epoch: 2 | loss: 0.4804048
	speed: 0.1428s/iter; left time: 2847.7347s
	iters: 400, epoch: 2 | loss: 0.0000105
	speed: 0.1364s/iter; left time: 2705.0496s
Epoch: 2 cost time: 58.080897092819214
Epoch: 2, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.927237 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4132682
	speed: 0.2868s/iter; left time: 5656.5277s
	iters: 200, epoch: 3 | loss: 0.0052997
	speed: 0.0874s/iter; left time: 1715.0000s
	iters: 300, epoch: 3 | loss: 0.0839977
	speed: 0.1147s/iter; left time: 2239.8157s
	iters: 400, epoch: 3 | loss: 0.0000174
	speed: 0.1266s/iter; left time: 2458.8043s
Epoch: 3 cost time: 43.9069402217865
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.970440 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0315800
	speed: 0.3237s/iter; left time: 6250.8982s
	iters: 200, epoch: 4 | loss: 0.0057543
	speed: 0.1348s/iter; left time: 2589.5647s
	iters: 300, epoch: 4 | loss: 0.0003364
	speed: 0.1354s/iter; left time: 2586.8254s
	iters: 400, epoch: 4 | loss: 0.4123720
	speed: 0.1369s/iter; left time: 2602.3561s
Epoch: 4 cost time: 54.92948651313782
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000019
	speed: 0.3147s/iter; left time: 5947.7490s
	iters: 200, epoch: 5 | loss: 0.0002638
	speed: 0.1383s/iter; left time: 2599.9782s
	iters: 300, epoch: 5 | loss: 0.1538758
	speed: 0.1405s/iter; left time: 2627.6700s
	iters: 400, epoch: 5 | loss: 0.0005991
	speed: 0.1389s/iter; left time: 2583.0954s
Epoch: 5 cost time: 57.07921504974365
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.978171).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0001128
	speed: 0.3568s/iter; left time: 6596.7065s
	iters: 200, epoch: 6 | loss: 0.0001409
	speed: 0.1333s/iter; left time: 2450.2385s
	iters: 300, epoch: 6 | loss: 0.0189212
	speed: 0.1194s/iter; left time: 2184.0586s
	iters: 400, epoch: 6 | loss: 0.0001097
	speed: 0.1209s/iter; left time: 2198.2170s
Epoch: 6 cost time: 53.91124415397644
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3134s/iter; left time: 5664.2038s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1249s/iter; left time: 2244.3253s
	iters: 300, epoch: 7 | loss: 0.0000021
	speed: 0.1293s/iter; left time: 2310.1150s
	iters: 400, epoch: 7 | loss: 0.4949902
	speed: 0.1251s/iter; left time: 2224.0282s
Epoch: 7 cost time: 52.988369941711426
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979535).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000005
	speed: 0.2970s/iter; left time: 5245.4757s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1119s/iter; left time: 1965.0585s
	iters: 300, epoch: 8 | loss: 0.0031132
	speed: 0.1054s/iter; left time: 1840.7392s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.1120s/iter; left time: 1944.3538s
Epoch: 8 cost time: 45.03188419342041
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.225 Vali Acc: 0.972 Test Loss: 0.225 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000064
	speed: 0.3177s/iter; left time: 5478.7103s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 2261.3689s
	iters: 300, epoch: 9 | loss: 0.0000005
	speed: 0.1351s/iter; left time: 2303.3865s
	iters: 400, epoch: 9 | loss: 0.0000019
	speed: 0.1235s/iter; left time: 2093.4338s
Epoch: 9 cost time: 53.89678120613098
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.983 Test Loss: 0.181 Test Acc: 0.983
Validation loss decreased (-0.979535 --> -0.983172).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2963s/iter; left time: 4988.1022s
	iters: 200, epoch: 10 | loss: 0.0000827
	speed: 0.1160s/iter; left time: 1941.7470s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1272s/iter; left time: 2116.1092s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1223s/iter; left time: 2022.4929s
Epoch: 10 cost time: 50.0865638256073
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.286 Vali Acc: 0.976 Test Loss: 0.286 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.2958s/iter; left time: 4857.0814s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1249s/iter; left time: 2038.2178s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1237s/iter; left time: 2006.4980s
	iters: 400, epoch: 11 | loss: 0.0000039
	speed: 0.1275s/iter; left time: 2055.0437s
Epoch: 11 cost time: 50.92204546928406
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.984 Test Loss: 0.186 Test Acc: 0.984
Validation loss decreased (-0.983172 --> -0.984082).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2964s/iter; left time: 4744.4990s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1155s/iter; left time: 1837.4362s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.1185s/iter; left time: 1873.1004s
	iters: 400, epoch: 12 | loss: 0.0111226
	speed: 0.1381s/iter; left time: 2168.5799s
Epoch: 12 cost time: 50.684757709503174
Epoch: 12, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.150 Vali Acc: 0.985 Test Loss: 0.150 Test Acc: 0.985
Validation loss decreased (-0.984082 --> -0.984537).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3306s/iter; left time: 5156.0383s
	iters: 200, epoch: 13 | loss: 0.0147803
	speed: 0.1283s/iter; left time: 1988.6770s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.1139s/iter; left time: 1753.4508s
	iters: 400, epoch: 13 | loss: 0.0000317
	speed: 0.1182s/iter; left time: 1807.6666s
Epoch: 13 cost time: 50.02141451835632
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.990 Test Loss: 0.092 Test Acc: 0.990
Validation loss decreased (-0.984537 --> -0.989995).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2898s/iter; left time: 4398.9910s
	iters: 200, epoch: 14 | loss: 0.0000007
	speed: 0.1265s/iter; left time: 1907.6706s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 1396.4388s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 1080.8302s
Epoch: 14 cost time: 41.23665523529053
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.173 Vali Acc: 0.989 Test Loss: 0.173 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2320s/iter; left time: 3427.0063s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1053s/iter; left time: 1544.8717s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 1442.4220s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1203s/iter; left time: 1740.3077s
Epoch: 15 cost time: 44.802783250808716
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.243 Vali Acc: 0.981 Test Loss: 0.243 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000008
	speed: 0.3082s/iter; left time: 4424.0300s
	iters: 200, epoch: 16 | loss: 0.1030322
	speed: 0.1185s/iter; left time: 1689.2523s
	iters: 300, epoch: 16 | loss: 0.0000221
	speed: 0.1196s/iter; left time: 1692.9566s
	iters: 400, epoch: 16 | loss: 0.0000653
	speed: 0.1050s/iter; left time: 1475.9858s
Epoch: 16 cost time: 48.792691707611084
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.987 Test Loss: 0.155 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2607s/iter; left time: 3634.4912s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.0842s/iter; left time: 1166.1741s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1125s/iter; left time: 1545.7415s
	iters: 400, epoch: 17 | loss: 0.0024553
	speed: 0.1149s/iter; left time: 1567.7635s
Epoch: 17 cost time: 43.69820713996887
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.985 Test Loss: 0.183 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0008889
	speed: 0.2930s/iter; left time: 3964.4783s
	iters: 200, epoch: 18 | loss: 0.0000040
	speed: 0.1095s/iter; left time: 1470.5232s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.1182s/iter; left time: 1575.0884s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1260s/iter; left time: 1667.6127s
Epoch: 18 cost time: 48.898911237716675
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.983 Test Loss: 0.228 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000004
	speed: 0.3004s/iter; left time: 3940.5855s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1219s/iter; left time: 1587.3978s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1298s/iter; left time: 1676.7566s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1319s/iter; left time: 1691.1874s
Epoch: 19 cost time: 51.850791215896606
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.453 Vali Acc: 0.968 Test Loss: 0.453 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3018s/iter; left time: 3834.1845s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1074s/iter; left time: 1353.3649s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 1122.0165s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 1099.8069s
Epoch: 20 cost time: 41.37611532211304
Epoch: 20, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.287 Vali Acc: 0.979 Test Loss: 0.287 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.2448s/iter; left time: 3008.4467s
	iters: 200, epoch: 21 | loss: 0.0000356
	speed: 0.1031s/iter; left time: 1257.2936s
	iters: 300, epoch: 21 | loss: 0.0000003
	speed: 0.1051s/iter; left time: 1270.6038s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 1295.1875s
Epoch: 21 cost time: 43.244985818862915
Epoch: 21, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.193 Vali Acc: 0.985 Test Loss: 0.193 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0001103
	speed: 0.2861s/iter; left time: 3398.1992s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1257s/iter; left time: 1480.0898s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.1179s/iter; left time: 1376.7597s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1262s/iter; left time: 1461.4624s
Epoch: 22 cost time: 50.85205578804016
Epoch: 22, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.426 Vali Acc: 0.972 Test Loss: 0.426 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000021
	speed: 0.3174s/iter; left time: 3639.1945s
	iters: 200, epoch: 23 | loss: 0.0004795
	speed: 0.1239s/iter; left time: 1408.3258s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1172s/iter; left time: 1320.0906s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 1191.6616s
Epoch: 23 cost time: 49.9693968296051
Epoch: 23, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.614 Vali Acc: 0.975 Test Loss: 0.614 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 36626698
model size : 154.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1814897
	speed: 0.1520s/iter; left time: 3123.7068s
	iters: 200, epoch: 1 | loss: 0.0362576
	speed: 0.1368s/iter; left time: 2797.5523s
	iters: 300, epoch: 1 | loss: 0.0877094
	speed: 0.1145s/iter; left time: 2330.0307s
	iters: 400, epoch: 1 | loss: 0.2980481
	speed: 0.1192s/iter; left time: 2414.4476s
Epoch: 1 cost time: 53.91621208190918
Epoch: 1, Steps: 413 | Train Loss: 0.520 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000589
	speed: 0.3670s/iter; left time: 7391.1995s
	iters: 200, epoch: 2 | loss: 0.4967450
	speed: 0.1543s/iter; left time: 3092.1338s
	iters: 300, epoch: 2 | loss: 0.3519075
	speed: 0.1431s/iter; left time: 2852.9523s
	iters: 400, epoch: 2 | loss: 0.0000261
	speed: 0.1543s/iter; left time: 3061.7904s
Epoch: 2 cost time: 61.95448541641235
Epoch: 2, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.968166 --> -0.973623).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0003570
	speed: 0.4174s/iter; left time: 8232.5528s
	iters: 200, epoch: 3 | loss: 0.0000568
	speed: 0.1423s/iter; left time: 2792.9742s
	iters: 300, epoch: 3 | loss: 0.0000001
	speed: 0.1514s/iter; left time: 2955.6635s
	iters: 400, epoch: 3 | loss: 0.0586662
	speed: 0.1471s/iter; left time: 2856.8313s
Epoch: 3 cost time: 60.22530555725098
Epoch: 3, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
Validation loss decreased (-0.973623 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0114421
	speed: 0.3829s/iter; left time: 7395.1636s
	iters: 200, epoch: 4 | loss: 0.2230089
	speed: 0.1249s/iter; left time: 2398.6274s
	iters: 300, epoch: 4 | loss: 0.0000130
	speed: 0.1404s/iter; left time: 2682.7939s
	iters: 400, epoch: 4 | loss: 0.0003453
	speed: 0.1576s/iter; left time: 2997.2384s
Epoch: 4 cost time: 57.3387451171875
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
Validation loss decreased (-0.977716 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0773585
	speed: 0.4205s/iter; left time: 7946.8668s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.1545s/iter; left time: 2904.0737s
	iters: 300, epoch: 5 | loss: 0.0009439
	speed: 0.1615s/iter; left time: 3019.9948s
	iters: 400, epoch: 5 | loss: 0.0119130
	speed: 0.1685s/iter; left time: 3134.2974s
Epoch: 5 cost time: 67.35724902153015
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0184889
	speed: 0.3967s/iter; left time: 7334.1796s
	iters: 200, epoch: 6 | loss: 0.0048263
	speed: 0.1529s/iter; left time: 2811.2060s
	iters: 300, epoch: 6 | loss: 0.0003484
	speed: 0.1469s/iter; left time: 2685.8994s
	iters: 400, epoch: 6 | loss: 0.0000009
	speed: 0.1337s/iter; left time: 2430.6643s
Epoch: 6 cost time: 60.650022983551025
Epoch: 6, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3065s/iter; left time: 5538.7574s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 1341.0398s
	iters: 300, epoch: 7 | loss: 0.6366312
	speed: 0.0778s/iter; left time: 1389.9199s
	iters: 400, epoch: 7 | loss: 0.0002962
	speed: 0.1315s/iter; left time: 2337.4483s
Epoch: 7 cost time: 38.33415961265564
Epoch: 7, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.187 Vali Acc: 0.978 Test Loss: 0.187 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3929s/iter; left time: 6937.9313s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1471s/iter; left time: 2583.5898s
	iters: 300, epoch: 8 | loss: 0.0000003
	speed: 0.1512s/iter; left time: 2639.4727s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1489s/iter; left time: 2584.9579s
Epoch: 8 cost time: 62.539743185043335
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.329 Vali Acc: 0.965 Test Loss: 0.329 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3608s/iter; left time: 6222.7828s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 2347.1016s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1314s/iter; left time: 2239.9538s
	iters: 400, epoch: 9 | loss: 0.0023609
	speed: 0.1292s/iter; left time: 2190.2930s
Epoch: 9 cost time: 56.111539363861084
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.311 Vali Acc: 0.971 Test Loss: 0.311 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000212
	speed: 0.3323s/iter; left time: 5593.9110s
	iters: 200, epoch: 10 | loss: 0.0000236
	speed: 0.1059s/iter; left time: 1771.7906s
	iters: 300, epoch: 10 | loss: 0.0001421
	speed: 0.1197s/iter; left time: 1991.8258s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1379s/iter; left time: 2279.3822s
Epoch: 10 cost time: 50.23137164115906
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.988 Test Loss: 0.087 Test Acc: 0.988
Validation loss decreased (-0.981809 --> -0.987721).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3753s/iter; left time: 6162.6650s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 1604.2972s
	iters: 300, epoch: 11 | loss: 0.0895924
	speed: 0.1138s/iter; left time: 1846.6656s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1232s/iter; left time: 1985.9920s
Epoch: 11 cost time: 47.43994379043579
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.153 Vali Acc: 0.985 Test Loss: 0.153 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3999s/iter; left time: 6401.6937s
	iters: 200, epoch: 12 | loss: 0.0000363
	speed: 0.1588s/iter; left time: 2525.6055s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.1443s/iter; left time: 2281.0559s
	iters: 400, epoch: 12 | loss: 0.7428543
	speed: 0.1413s/iter; left time: 2219.5635s
Epoch: 12 cost time: 62.24806809425354
Epoch: 12, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.345 Vali Acc: 0.970 Test Loss: 0.345 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000010
	speed: 0.3095s/iter; left time: 4826.2749s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1377s/iter; left time: 2134.3999s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1313s/iter; left time: 2021.4398s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1175s/iter; left time: 1796.8405s
Epoch: 13 cost time: 52.54576325416565
Epoch: 13, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.353 Vali Acc: 0.978 Test Loss: 0.353 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3585s/iter; left time: 5442.6891s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1237s/iter; left time: 1865.5033s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1564s/iter; left time: 2343.2038s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1609s/iter; left time: 2394.5591s
Epoch: 14 cost time: 60.44940900802612
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.990 Test Loss: 0.104 Test Acc: 0.990
Validation loss decreased (-0.987721 --> -0.990449).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4241s/iter; left time: 6263.3919s
	iters: 200, epoch: 15 | loss: 0.0016217
	speed: 0.1479s/iter; left time: 2169.6067s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1605s/iter; left time: 2338.2804s
	iters: 400, epoch: 15 | loss: 0.0028675
	speed: 0.1186s/iter; left time: 1716.2138s
Epoch: 15 cost time: 61.14252161979675
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.984 Test Loss: 0.181 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3599s/iter; left time: 5166.6928s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1253s/iter; left time: 1786.4879s
	iters: 300, epoch: 16 | loss: 2.5199862
	speed: 0.1321s/iter; left time: 1869.9213s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1347s/iter; left time: 1893.7025s
Epoch: 16 cost time: 55.16511154174805
Epoch: 16, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.225 Vali Acc: 0.984 Test Loss: 0.225 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3885s/iter; left time: 5417.2336s
	iters: 200, epoch: 17 | loss: 0.0000449
	speed: 0.1189s/iter; left time: 1646.3271s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1192s/iter; left time: 1637.5250s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1174s/iter; left time: 1602.1340s
Epoch: 17 cost time: 54.204018115997314
Epoch: 17, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.375 Vali Acc: 0.975 Test Loss: 0.375 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3794s/iter; left time: 5133.5388s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1392s/iter; left time: 1869.2828s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1306s/iter; left time: 1741.1239s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1230s/iter; left time: 1627.6621s
Epoch: 18 cost time: 55.321802854537964
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.250 Vali Acc: 0.985 Test Loss: 0.250 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.3567s/iter; left time: 4679.4249s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1206s/iter; left time: 1569.7910s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1262s/iter; left time: 1629.9112s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 1350.4979s
Epoch: 19 cost time: 51.36264181137085
Epoch: 19, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.992 Test Loss: 0.129 Test Acc: 0.992
Validation loss decreased (-0.990449 --> -0.992268).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.4237s/iter; left time: 5382.6635s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1292s/iter; left time: 1628.7666s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1245s/iter; left time: 1556.6215s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1463s/iter; left time: 1815.0903s
Epoch: 20 cost time: 57.52380633354187
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.325 Vali Acc: 0.986 Test Loss: 0.325 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2582s/iter; left time: 3173.8968s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 987.0951s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 964.3871s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0970s/iter; left time: 1163.6515s
Epoch: 21 cost time: 35.2897310256958
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.993 Test Loss: 0.130 Test Acc: 0.993
Validation loss decreased (-0.992268 --> -0.993177).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.2685s/iter; left time: 3189.2498s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1238s/iter; left time: 1458.0987s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1100s/iter; left time: 1284.0357s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1244s/iter; left time: 1439.9426s
Epoch: 22 cost time: 50.20181393623352
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.283 Vali Acc: 0.986 Test Loss: 0.283 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.3654s/iter; left time: 4189.8051s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1342s/iter; left time: 1524.7691s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1384s/iter; left time: 1558.5655s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1561s/iter; left time: 1742.7075s
Epoch: 23 cost time: 59.52974557876587
Epoch: 23, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.453 Vali Acc: 0.981 Test Loss: 0.453 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2508s/iter; left time: 2771.3687s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 974.0550s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1304s/iter; left time: 1415.0094s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1087s/iter; left time: 1169.2736s
Epoch: 24 cost time: 41.21188759803772
Epoch: 24, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.988 Test Loss: 0.198 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0044379
	speed: 0.2901s/iter; left time: 3086.2007s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1240s/iter; left time: 1306.7800s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1295s/iter; left time: 1351.8744s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1176s/iter; left time: 1215.4059s
Epoch: 25 cost time: 51.36410093307495
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.990 Test Loss: 0.164 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.3743s/iter; left time: 3827.7881s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1278s/iter; left time: 1293.8936s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1128s/iter; left time: 1130.6845s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1489s/iter; left time: 1477.6844s
Epoch: 26 cost time: 55.84199619293213
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.992 Test Loss: 0.151 Test Acc: 0.992
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3470s/iter; left time: 3404.9114s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1232s/iter; left time: 1196.7861s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1317s/iter; left time: 1265.5656s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1397s/iter; left time: 1329.2241s
Epoch: 27 cost time: 54.422202825546265
Epoch: 27, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.383 Vali Acc: 0.985 Test Loss: 0.383 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2894s/iter; left time: 2720.1817s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1198s/iter; left time: 1113.6782s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1250s/iter; left time: 1150.0510s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1367s/iter; left time: 1244.2361s
Epoch: 28 cost time: 50.005677938461304
Epoch: 28, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.437 Vali Acc: 0.986 Test Loss: 0.437 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.3683s/iter; left time: 3309.5577s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.1457s/iter; left time: 1294.7224s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1209s/iter; left time: 1062.2908s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 827.7472s
Epoch: 29 cost time: 53.13323640823364
Epoch: 29, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.403 Vali Acc: 0.985 Test Loss: 0.403 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2923s/iter; left time: 2505.9852s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 866.9107s
	iters: 300, epoch: 30 | loss: 0.0000024
	speed: 0.1104s/iter; left time: 924.5811s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.1292s/iter; left time: 1068.7324s
Epoch: 30 cost time: 46.14064955711365
Epoch: 30, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.343 Vali Acc: 0.985 Test Loss: 0.343 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000006
	speed: 0.3392s/iter; left time: 2768.1825s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.1361s/iter; left time: 1096.8404s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 765.5067s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 764.0153s
Epoch: 31 cost time: 47.850605964660645
Epoch: 31, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.494 Vali Acc: 0.983 Test Loss: 0.494 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9931787175989086
model parameter : 36859402
model size : 155.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0607763
	speed: 0.0963s/iter; left time: 1978.2861s
	iters: 200, epoch: 1 | loss: 0.0456150
	speed: 0.0725s/iter; left time: 1482.8145s
	iters: 300, epoch: 1 | loss: 0.0155984
	speed: 0.0819s/iter; left time: 1667.1199s
	iters: 400, epoch: 1 | loss: 0.1414932
	speed: 0.0907s/iter; left time: 1836.6794s
Epoch: 1 cost time: 35.42798113822937
Epoch: 1, Steps: 413 | Train Loss: 0.505 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0017564
	speed: 0.2562s/iter; left time: 5159.3583s
	iters: 200, epoch: 2 | loss: 0.0074280
	speed: 0.0887s/iter; left time: 1777.4539s
	iters: 300, epoch: 2 | loss: 0.0040899
	speed: 0.0768s/iter; left time: 1530.8540s
	iters: 400, epoch: 2 | loss: 0.0353197
	speed: 0.0895s/iter; left time: 1776.4252s
Epoch: 2 cost time: 37.010149002075195
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0071970
	speed: 0.2851s/iter; left time: 5622.7485s
	iters: 200, epoch: 3 | loss: 0.0000029
	speed: 0.1204s/iter; left time: 2362.6577s
	iters: 300, epoch: 3 | loss: 0.1131907
	speed: 0.1285s/iter; left time: 2508.8549s
	iters: 400, epoch: 3 | loss: 0.1827043
	speed: 0.1275s/iter; left time: 2476.5407s
Epoch: 3 cost time: 51.68724989891052
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
Validation loss decreased (-0.973169 --> -0.976351).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5898277
	speed: 0.2855s/iter; left time: 5514.4152s
	iters: 200, epoch: 4 | loss: 0.0110625
	speed: 0.0892s/iter; left time: 1713.6070s
	iters: 300, epoch: 4 | loss: 0.0000026
	speed: 0.1015s/iter; left time: 1940.4459s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.1183s/iter; left time: 2248.4508s
Epoch: 4 cost time: 40.84431290626526
Epoch: 4, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
Validation loss decreased (-0.976351 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0220954
	speed: 0.2569s/iter; left time: 4855.1858s
	iters: 200, epoch: 5 | loss: 0.0000309
	speed: 0.0938s/iter; left time: 1763.2313s
	iters: 300, epoch: 5 | loss: 0.0000465
	speed: 0.1112s/iter; left time: 2079.1008s
	iters: 400, epoch: 5 | loss: 0.0000067
	speed: 0.1109s/iter; left time: 2061.7858s
Epoch: 5 cost time: 42.41633367538452
Epoch: 5, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.961 Test Loss: 0.276 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2983s/iter; left time: 5513.6998s
	iters: 200, epoch: 6 | loss: 0.0070524
	speed: 0.1093s/iter; left time: 2008.9194s
	iters: 300, epoch: 6 | loss: 0.0003761
	speed: 0.1230s/iter; left time: 2248.4173s
	iters: 400, epoch: 6 | loss: 0.2877342
	speed: 0.1156s/iter; left time: 2102.5663s
Epoch: 6 cost time: 48.291006326675415
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.139 Vali Acc: 0.985 Test Loss: 0.139 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.984992).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000009
	speed: 0.3195s/iter; left time: 5775.0270s
	iters: 200, epoch: 7 | loss: 0.0103902
	speed: 0.1007s/iter; left time: 1810.6194s
	iters: 300, epoch: 7 | loss: 0.0086781
	speed: 0.0998s/iter; left time: 1784.6171s
	iters: 400, epoch: 7 | loss: 0.0000245
	speed: 0.1041s/iter; left time: 1849.4546s
Epoch: 7 cost time: 44.98643445968628
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.2516s/iter; left time: 4442.6654s
	iters: 200, epoch: 8 | loss: 0.0000025
	speed: 0.0740s/iter; left time: 1298.5881s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 1311.0676s
	iters: 400, epoch: 8 | loss: 0.0247787
	speed: 0.0764s/iter; left time: 1326.5144s
Epoch: 8 cost time: 33.03781700134277
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.973 Test Loss: 0.239 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2210s/iter; left time: 3812.0731s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1061s/iter; left time: 1819.5252s
	iters: 300, epoch: 9 | loss: 0.5191367
	speed: 0.1110s/iter; left time: 1891.8827s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1136s/iter; left time: 1924.9372s
Epoch: 9 cost time: 45.168747901916504
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.205 Vali Acc: 0.981 Test Loss: 0.205 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2869s/iter; left time: 4828.9365s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.1212s/iter; left time: 2027.8674s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1230s/iter; left time: 2045.8257s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1070s/iter; left time: 1768.3541s
Epoch: 10 cost time: 48.26647877693176
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.986 Test Loss: 0.131 Test Acc: 0.986
Validation loss decreased (-0.984992 --> -0.986356).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2803s/iter; left time: 4602.3633s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0931s/iter; left time: 1519.5982s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 1560.4536s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 1596.3272s
Epoch: 11 cost time: 39.720266819000244
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.317 Vali Acc: 0.977 Test Loss: 0.317 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2486s/iter; left time: 3979.1453s
	iters: 200, epoch: 12 | loss: 0.0000956
	speed: 0.0969s/iter; left time: 1541.1719s
	iters: 300, epoch: 12 | loss: 0.0000137
	speed: 0.1260s/iter; left time: 1991.0928s
	iters: 400, epoch: 12 | loss: 0.0000018
	speed: 0.1187s/iter; left time: 1865.0832s
Epoch: 12 cost time: 45.89102578163147
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.985 Test Loss: 0.153 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000163
	speed: 0.3204s/iter; left time: 4995.9314s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1142s/iter; left time: 1770.1557s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 1622.6684s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0837s/iter; left time: 1280.6275s
Epoch: 13 cost time: 45.23794150352478
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.429 Vali Acc: 0.976 Test Loss: 0.429 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2131s/iter; left time: 3235.8579s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1154.0077s
	iters: 300, epoch: 14 | loss: 0.0029375
	speed: 0.0790s/iter; left time: 1184.0037s
	iters: 400, epoch: 14 | loss: 0.0000073
	speed: 0.0712s/iter; left time: 1059.1755s
Epoch: 14 cost time: 31.461166858673096
Epoch: 14, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.252 Vali Acc: 0.989 Test Loss: 0.252 Test Acc: 0.989
Validation loss decreased (-0.986356 --> -0.988629).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2179s/iter; left time: 3217.5032s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 1207.8223s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 1213.2979s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1114s/iter; left time: 1612.5422s
Epoch: 15 cost time: 36.50992679595947
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.288 Vali Acc: 0.985 Test Loss: 0.288 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0011370
	speed: 0.2776s/iter; left time: 3985.9309s
	iters: 200, epoch: 16 | loss: 0.0839399
	speed: 0.1233s/iter; left time: 1758.0628s
	iters: 300, epoch: 16 | loss: 0.0001232
	speed: 0.1089s/iter; left time: 1541.7837s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.1112s/iter; left time: 1563.2706s
Epoch: 16 cost time: 47.09617567062378
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.987 Test Loss: 0.221 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2773s/iter; left time: 3865.8725s
	iters: 200, epoch: 17 | loss: 0.0000048
	speed: 0.1020s/iter; left time: 1411.5203s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 1225.8453s
	iters: 400, epoch: 17 | loss: 0.0000003
	speed: 0.0957s/iter; left time: 1305.8347s
Epoch: 17 cost time: 42.028265953063965
Epoch: 17, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.254 Vali Acc: 0.986 Test Loss: 0.254 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0809416
	speed: 0.1858s/iter; left time: 2514.4357s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 507.3163s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 1072.6605s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 1174.8299s
Epoch: 18 cost time: 27.887053966522217
Epoch: 18, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.405 Vali Acc: 0.981 Test Loss: 0.405 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2323s/iter; left time: 3046.4983s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0907s/iter; left time: 1180.3302s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1192s/iter; left time: 1539.6852s
	iters: 400, epoch: 19 | loss: 0.1411109
	speed: 0.1256s/iter; left time: 1610.0150s
Epoch: 19 cost time: 44.20253849029541
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.982 Test Loss: 0.220 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2817s/iter; left time: 3578.3433s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0908s/iter; left time: 1144.4934s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 1152.7168s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0907s/iter; left time: 1124.5414s
Epoch: 20 cost time: 39.477428674697876
Epoch: 20, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.247 Vali Acc: 0.983 Test Loss: 0.247 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2390s/iter; left time: 2938.0823s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 969.3211s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0971s/iter; left time: 1173.6722s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1026s/iter; left time: 1230.2294s
Epoch: 21 cost time: 38.70471715927124
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.247 Vali Acc: 0.984 Test Loss: 0.247 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2769s/iter; left time: 3289.4132s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 1386.0457s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1119s/iter; left time: 1306.4746s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 1250.3388s
Epoch: 22 cost time: 47.51306676864624
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.988 Test Loss: 0.271 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2539s/iter; left time: 2910.3933s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1266s/iter; left time: 1439.3279s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1276s/iter; left time: 1436.8993s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1183s/iter; left time: 1320.3013s
Epoch: 23 cost time: 47.57976508140564
Epoch: 23, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.316 Vali Acc: 0.985 Test Loss: 0.316 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.3032s/iter; left time: 3351.1315s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0994s/iter; left time: 1088.5653s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1211s/iter; left time: 1314.1805s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1180s/iter; left time: 1268.7634s
Epoch: 24 cost time: 48.03691744804382
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.381 Vali Acc: 0.980 Test Loss: 0.381 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 36721162
model size : 154.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7676294
	speed: 0.0968s/iter; left time: 1988.3995s
	iters: 200, epoch: 1 | loss: 0.0748814
	speed: 0.0804s/iter; left time: 1644.9668s
	iters: 300, epoch: 1 | loss: 0.3877421
	speed: 0.0809s/iter; left time: 1646.8971s
	iters: 400, epoch: 1 | loss: 0.2218043
	speed: 0.0769s/iter; left time: 1556.7195s
Epoch: 1 cost time: 34.57108807563782
Epoch: 1, Steps: 413 | Train Loss: 0.522 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0186041
	speed: 0.2016s/iter; left time: 4059.3308s
	iters: 200, epoch: 2 | loss: 0.0099076
	speed: 0.0769s/iter; left time: 1541.3264s
	iters: 300, epoch: 2 | loss: 0.4882548
	speed: 0.1025s/iter; left time: 2044.4833s
	iters: 400, epoch: 2 | loss: 0.4265549
	speed: 0.1001s/iter; left time: 1986.7175s
Epoch: 2 cost time: 37.45131802558899
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.960435 --> -0.973168).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0003157
	speed: 0.2656s/iter; left time: 5238.9146s
	iters: 200, epoch: 3 | loss: 0.0001717
	speed: 0.0985s/iter; left time: 1932.7999s
	iters: 300, epoch: 3 | loss: 0.2240843
	speed: 0.0958s/iter; left time: 1871.3526s
	iters: 400, epoch: 3 | loss: 0.0002810
	speed: 0.0924s/iter; left time: 1795.3509s
Epoch: 3 cost time: 40.11765694618225
Epoch: 3, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000396
	speed: 0.2502s/iter; left time: 4831.1286s
	iters: 200, epoch: 4 | loss: 0.0018584
	speed: 0.0988s/iter; left time: 1897.4321s
	iters: 300, epoch: 4 | loss: 0.0001431
	speed: 0.1043s/iter; left time: 1992.6628s
	iters: 400, epoch: 4 | loss: 0.0000325
	speed: 0.0995s/iter; left time: 1891.2135s
Epoch: 4 cost time: 43.05595660209656
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000040
	speed: 0.2820s/iter; left time: 5329.7449s
	iters: 200, epoch: 5 | loss: 0.0031832
	speed: 0.1159s/iter; left time: 2177.9118s
	iters: 300, epoch: 5 | loss: 0.0153759
	speed: 0.1206s/iter; left time: 2254.6767s
	iters: 400, epoch: 5 | loss: 0.0034668
	speed: 0.1305s/iter; left time: 2427.2952s
Epoch: 5 cost time: 50.24635195732117
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.275 Vali Acc: 0.964 Test Loss: 0.275 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0009136
	speed: 0.2745s/iter; left time: 5073.8652s
	iters: 200, epoch: 6 | loss: 0.0023120
	speed: 0.0964s/iter; left time: 1771.5370s
	iters: 300, epoch: 6 | loss: 0.0000569
	speed: 0.1047s/iter; left time: 1914.9049s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.1019s/iter; left time: 1852.4400s
Epoch: 6 cost time: 43.35061812400818
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.973168 --> -0.974532).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000021
	speed: 0.2699s/iter; left time: 4878.4312s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 1820.4346s
	iters: 300, epoch: 7 | loss: 0.0003233
	speed: 0.1009s/iter; left time: 1803.9807s
	iters: 400, epoch: 7 | loss: 0.0027607
	speed: 0.1068s/iter; left time: 1898.4125s
Epoch: 7 cost time: 42.151878356933594
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
Validation loss decreased (-0.974532 --> -0.977716).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008574
	speed: 0.2958s/iter; left time: 5223.9204s
	iters: 200, epoch: 8 | loss: 0.0010696
	speed: 0.1189s/iter; left time: 2088.3981s
	iters: 300, epoch: 8 | loss: 0.0001263
	speed: 0.1183s/iter; left time: 2065.8719s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.1197s/iter; left time: 2077.7472s
Epoch: 8 cost time: 49.19702172279358
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.983 Test Loss: 0.159 Test Acc: 0.983
Validation loss decreased (-0.977716 --> -0.982718).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000262
	speed: 0.2626s/iter; left time: 4529.9072s
	iters: 200, epoch: 9 | loss: 0.0000024
	speed: 0.0838s/iter; left time: 1437.0774s
	iters: 300, epoch: 9 | loss: 0.0000509
	speed: 0.0708s/iter; left time: 1206.8368s
	iters: 400, epoch: 9 | loss: 0.0190442
	speed: 0.0713s/iter; left time: 1208.4708s
Epoch: 9 cost time: 32.62640190124512
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.111 Vali Acc: 0.988 Test Loss: 0.111 Test Acc: 0.988
Validation loss decreased (-0.982718 --> -0.987721).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000270
	speed: 0.2479s/iter; left time: 4173.6042s
	iters: 200, epoch: 10 | loss: 0.0000198
	speed: 0.0837s/iter; left time: 1400.8709s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0920s/iter; left time: 1530.3022s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 1280.5286s
Epoch: 10 cost time: 38.579490184783936
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.977 Test Loss: 0.279 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2287s/iter; left time: 3755.3808s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 1271.0393s
	iters: 300, epoch: 11 | loss: 0.0011245
	speed: 0.0894s/iter; left time: 1449.9515s
	iters: 400, epoch: 11 | loss: 0.0000094
	speed: 0.0912s/iter; left time: 1469.5974s
Epoch: 11 cost time: 35.586583852767944
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.293 Vali Acc: 0.980 Test Loss: 0.293 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2701s/iter; left time: 4324.4669s
	iters: 200, epoch: 12 | loss: 0.0002223
	speed: 0.1228s/iter; left time: 1954.0489s
	iters: 300, epoch: 12 | loss: 0.0000032
	speed: 0.1030s/iter; left time: 1628.6326s
	iters: 400, epoch: 12 | loss: 0.0000033
	speed: 0.1027s/iter; left time: 1612.8286s
Epoch: 12 cost time: 47.78573036193848
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2753s/iter; left time: 4292.7349s
	iters: 200, epoch: 13 | loss: 0.0007060
	speed: 0.1196s/iter; left time: 1852.4863s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.0969s/iter; left time: 1491.9023s
	iters: 400, epoch: 13 | loss: 0.0004355
	speed: 0.0447s/iter; left time: 683.5163s
Epoch: 13 cost time: 38.603068828582764
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.983 Test Loss: 0.190 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1977s/iter; left time: 3002.1086s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0726s/iter; left time: 1095.3852s
	iters: 300, epoch: 14 | loss: 0.3003143
	speed: 0.0580s/iter; left time: 868.6120s
	iters: 400, epoch: 14 | loss: 0.0000025
	speed: 0.0674s/iter; left time: 1003.1488s
Epoch: 14 cost time: 28.925873517990112
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.976 Test Loss: 0.221 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1933s/iter; left time: 2854.9177s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 1254.7560s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 1110.3258s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 1068.6392s
Epoch: 15 cost time: 32.75163698196411
Epoch: 15, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.986 Test Loss: 0.127 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000014
	speed: 0.2601s/iter; left time: 3733.4455s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0941s/iter; left time: 1342.1053s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1050s/iter; left time: 1486.6237s
	iters: 400, epoch: 16 | loss: 0.0000086
	speed: 0.0918s/iter; left time: 1289.9789s
Epoch: 16 cost time: 40.24128007888794
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.983 Test Loss: 0.170 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2341s/iter; left time: 3264.3367s
	iters: 200, epoch: 17 | loss: 0.0000246
	speed: 0.1014s/iter; left time: 1403.5320s
	iters: 300, epoch: 17 | loss: 0.0000576
	speed: 0.0846s/iter; left time: 1163.1070s
	iters: 400, epoch: 17 | loss: 0.0000005
	speed: 0.0815s/iter; left time: 1112.0795s
Epoch: 17 cost time: 37.14702272415161
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.311 Vali Acc: 0.979 Test Loss: 0.311 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2260s/iter; left time: 3058.1791s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0959s/iter; left time: 1288.1174s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 1134.1570s
	iters: 400, epoch: 18 | loss: 0.0000013
	speed: 0.0530s/iter; left time: 700.6963s
Epoch: 18 cost time: 33.749544620513916
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.139 Vali Acc: 0.989 Test Loss: 0.139 Test Acc: 0.989
Validation loss decreased (-0.987721 --> -0.989085).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2590s/iter; left time: 3397.9116s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.1165s/iter; left time: 1516.8524s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 729.8497s
	iters: 400, epoch: 19 | loss: 0.0467871
	speed: 0.0625s/iter; left time: 801.5999s
Epoch: 19 cost time: 37.490570306777954
Epoch: 19, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.985 Test Loss: 0.283 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2274s/iter; left time: 2888.6747s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1051s/iter; left time: 1325.2763s
	iters: 300, epoch: 20 | loss: 0.3413395
	speed: 0.0920s/iter; left time: 1150.2315s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 806.0998s
Epoch: 20 cost time: 36.698267221450806
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.977 Test Loss: 0.243 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000002
	speed: 0.2125s/iter; left time: 2611.3540s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0778s/iter; left time: 948.1434s
	iters: 300, epoch: 21 | loss: 0.0000007
	speed: 0.0699s/iter; left time: 845.1706s
	iters: 400, epoch: 21 | loss: 0.8669187
	speed: 0.0681s/iter; left time: 817.1368s
Epoch: 21 cost time: 31.57412624359131
Epoch: 21, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.141 Vali Acc: 0.986 Test Loss: 0.141 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2368s/iter; left time: 2812.3088s
	iters: 200, epoch: 22 | loss: 0.0453387
	speed: 0.0976s/iter; left time: 1149.5512s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 982.0663s
	iters: 400, epoch: 22 | loss: 0.0000320
	speed: 0.0558s/iter; left time: 645.9387s
Epoch: 22 cost time: 34.75245690345764
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.233 Vali Acc: 0.983 Test Loss: 0.233 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2534s/iter; left time: 2905.3050s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 1076.9812s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0860s/iter; left time: 968.7480s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 990.3884s
Epoch: 23 cost time: 38.03266143798828
Epoch: 23, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.988 Test Loss: 0.115 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2539s/iter; left time: 2805.5572s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.1076s/iter; left time: 1178.2327s
	iters: 300, epoch: 24 | loss: 0.0015522
	speed: 0.1024s/iter; left time: 1111.2476s
	iters: 400, epoch: 24 | loss: 0.6633955
	speed: 0.1102s/iter; left time: 1184.4525s
Epoch: 24 cost time: 45.00686740875244
Epoch: 24, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.987 Test Loss: 0.142 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1908s/iter; left time: 2029.8786s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 607.2700s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 562.0704s
	iters: 400, epoch: 25 | loss: 0.0000200
	speed: 0.0526s/iter; left time: 544.3176s
Epoch: 25 cost time: 23.184571027755737
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.984 Test Loss: 0.200 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1386s/iter; left time: 1417.6497s
	iters: 200, epoch: 26 | loss: 0.0000003
	speed: 0.0764s/iter; left time: 773.8757s
	iters: 300, epoch: 26 | loss: 0.0000338
	speed: 0.0721s/iter; left time: 722.6521s
	iters: 400, epoch: 26 | loss: 0.0000236
	speed: 0.0694s/iter; left time: 689.0722s
Epoch: 26 cost time: 28.628089427947998
Epoch: 26, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.394 Vali Acc: 0.980 Test Loss: 0.394 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0595178
	speed: 0.2535s/iter; left time: 2487.3848s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 821.5783s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 476.1419s
	iters: 400, epoch: 27 | loss: 0.0000025
	speed: 0.0351s/iter; left time: 334.3619s
Epoch: 27 cost time: 27.838515996932983
Epoch: 27, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.990 Test Loss: 0.154 Test Acc: 0.990
Validation loss decreased (-0.989085 --> -0.989539).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2859s/iter; left time: 2687.2181s
	iters: 200, epoch: 28 | loss: 0.0000077
	speed: 0.1137s/iter; left time: 1056.9991s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 840.6509s
	iters: 400, epoch: 28 | loss: 0.0000187
	speed: 0.1070s/iter; left time: 973.4709s
Epoch: 28 cost time: 43.98280692100525
Epoch: 28, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.228 Vali Acc: 0.987 Test Loss: 0.228 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2493s/iter; left time: 2240.4870s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.0974s/iter; left time: 865.7800s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 759.1734s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 888.8350s
Epoch: 29 cost time: 40.28447341918945
Epoch: 29, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.284 Vali Acc: 0.985 Test Loss: 0.284 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2377s/iter; left time: 2037.7784s
	iters: 200, epoch: 30 | loss: 0.0000025
	speed: 0.0880s/iter; left time: 745.3833s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 506.2176s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 610.6146s
Epoch: 30 cost time: 32.49253439903259
Epoch: 30, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.982 Test Loss: 0.303 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.4975779
	speed: 0.1856s/iter; left time: 1514.5301s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 742.0684s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 754.8105s
	iters: 400, epoch: 31 | loss: 0.0000004
	speed: 0.0889s/iter; left time: 698.6861s
Epoch: 31 cost time: 35.799171447753906
Epoch: 31, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.372 Vali Acc: 0.979 Test Loss: 0.372 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2605s/iter; left time: 2018.7069s
	iters: 200, epoch: 32 | loss: 0.0000032
	speed: 0.1054s/iter; left time: 806.0270s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.1071s/iter; left time: 808.1068s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.1093s/iter; left time: 814.1856s
Epoch: 32 cost time: 43.07156491279602
Epoch: 32, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.989 Test Loss: 0.166 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2579s/iter; left time: 1891.8897s
	iters: 200, epoch: 33 | loss: 0.0200740
	speed: 0.1035s/iter; left time: 748.5448s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.1086s/iter; left time: 774.6071s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0950s/iter; left time: 668.6653s
Epoch: 33 cost time: 43.12218713760376
Epoch: 33, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.180 Vali Acc: 0.987 Test Loss: 0.180 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2508s/iter; left time: 1736.2669s
	iters: 200, epoch: 34 | loss: 0.0000277
	speed: 0.1021s/iter; left time: 696.1870s
	iters: 300, epoch: 34 | loss: 0.0000040
	speed: 0.1028s/iter; left time: 690.6958s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0671s/iter; left time: 444.5908s
Epoch: 34 cost time: 37.09339427947998
Epoch: 34, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.193 Vali Acc: 0.986 Test Loss: 0.193 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1980s/iter; left time: 1288.8739s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.1083s/iter; left time: 694.1020s
	iters: 300, epoch: 35 | loss: 0.5292768
	speed: 0.1096s/iter; left time: 691.3547s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.1027s/iter; left time: 637.6296s
Epoch: 35 cost time: 41.802016258239746
Epoch: 35, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.988 Test Loss: 0.177 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2617s/iter; left time: 1595.2777s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 502.3849s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 594.6491s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 458.0972s
Epoch: 36 cost time: 38.05155301094055
Epoch: 36, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.989 Test Loss: 0.244 Test Acc: 0.989
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2589s/iter; left time: 1471.2548s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.1069s/iter; left time: 596.5597s
	iters: 300, epoch: 37 | loss: 0.0144316
	speed: 0.0763s/iter; left time: 418.1574s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 537.9771s
Epoch: 37 cost time: 39.04972195625305
Epoch: 37, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.393 Vali Acc: 0.984 Test Loss: 0.393 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 36610570
model size : 154.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4215608
	speed: 0.1859s/iter; left time: 3821.2684s
	iters: 200, epoch: 1 | loss: 0.1362603
	speed: 0.1645s/iter; left time: 3363.9563s
	iters: 300, epoch: 1 | loss: 0.3211866
	speed: 0.1515s/iter; left time: 3083.1495s
	iters: 400, epoch: 1 | loss: 0.2159485
	speed: 0.1117s/iter; left time: 2261.0266s
Epoch: 1 cost time: 63.01355338096619
Epoch: 1, Steps: 413 | Train Loss: 0.531 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
Validation loss decreased (inf --> -0.937241).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0001675
	speed: 0.3198s/iter; left time: 6439.4427s
	iters: 200, epoch: 2 | loss: 0.0632147
	speed: 0.1175s/iter; left time: 2354.5535s
	iters: 300, epoch: 2 | loss: 0.0007153
	speed: 0.0971s/iter; left time: 1935.8062s
	iters: 400, epoch: 2 | loss: 0.0083399
	speed: 0.1040s/iter; left time: 2063.9726s
Epoch: 2 cost time: 45.78018236160278
Epoch: 2, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.937241 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0020816
	speed: 0.4087s/iter; left time: 8062.1597s
	iters: 200, epoch: 3 | loss: 0.0004692
	speed: 0.1413s/iter; left time: 2773.3097s
	iters: 300, epoch: 3 | loss: 0.0002007
	speed: 0.1541s/iter; left time: 3009.4928s
	iters: 400, epoch: 3 | loss: 0.0013963
	speed: 0.1282s/iter; left time: 2491.1739s
Epoch: 3 cost time: 59.25246286392212
Epoch: 3, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000058
	speed: 0.3917s/iter; left time: 7564.6497s
	iters: 200, epoch: 4 | loss: 0.0013629
	speed: 0.1451s/iter; left time: 2787.2576s
	iters: 300, epoch: 4 | loss: 0.0014419
	speed: 0.1436s/iter; left time: 2744.3515s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.1041s/iter; left time: 1979.6591s
Epoch: 4 cost time: 54.08573293685913
Epoch: 4, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.042 Vali Acc: 0.990 Test Loss: 0.042 Test Acc: 0.990
Validation loss decreased (-0.979081 --> -0.990450).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001147
	speed: 0.2431s/iter; left time: 4595.1686s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0921s/iter; left time: 1730.9906s
	iters: 300, epoch: 5 | loss: 0.0000600
	speed: 0.0834s/iter; left time: 1560.2891s
	iters: 400, epoch: 5 | loss: 0.0059033
	speed: 0.0743s/iter; left time: 1381.9891s
Epoch: 5 cost time: 34.79344177246094
Epoch: 5, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.123 Vali Acc: 0.984 Test Loss: 0.123 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2032s/iter; left time: 3756.6413s
	iters: 200, epoch: 6 | loss: 0.0000450
	speed: 0.0747s/iter; left time: 1372.8927s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.1022s/iter; left time: 1869.2485s
	iters: 400, epoch: 6 | loss: 0.0003019
	speed: 0.0927s/iter; left time: 1685.1912s
Epoch: 6 cost time: 35.28675031661987
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000140
	speed: 0.3086s/iter; left time: 5576.6266s
	iters: 200, epoch: 7 | loss: 1.2393192
	speed: 0.1285s/iter; left time: 2308.7446s
	iters: 300, epoch: 7 | loss: 0.0710616
	speed: 0.1184s/iter; left time: 2116.7914s
	iters: 400, epoch: 7 | loss: 0.0000022
	speed: 0.1035s/iter; left time: 1839.2332s
Epoch: 7 cost time: 48.45562267303467
Epoch: 7, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.162 Vali Acc: 0.984 Test Loss: 0.162 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 4994.6985s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1161s/iter; left time: 2038.2023s
	iters: 300, epoch: 8 | loss: 0.0012971
	speed: 0.0974s/iter; left time: 1700.7803s
	iters: 400, epoch: 8 | loss: 0.0344942
	speed: 0.0824s/iter; left time: 1430.0896s
Epoch: 8 cost time: 42.593140602111816
Epoch: 8, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.267 Vali Acc: 0.978 Test Loss: 0.267 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000021
	speed: 0.2424s/iter; left time: 4181.1132s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 1878.5498s
	iters: 300, epoch: 9 | loss: 0.0504390
	speed: 0.1153s/iter; left time: 1965.6314s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1101s/iter; left time: 1866.5767s
Epoch: 9 cost time: 45.27881860733032
Epoch: 9, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.207 Vali Acc: 0.980 Test Loss: 0.207 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0001585
	speed: 0.2962s/iter; left time: 4985.7083s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.1208s/iter; left time: 2021.8474s
	iters: 300, epoch: 10 | loss: 0.7626500
	speed: 0.1104s/iter; left time: 1836.5160s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 1487.1056s
Epoch: 10 cost time: 45.02920722961426
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.168 Vali Acc: 0.984 Test Loss: 0.168 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2633s/iter; left time: 4323.3983s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1058s/iter; left time: 1726.7580s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 1559.9037s
	iters: 400, epoch: 11 | loss: 0.0000012
	speed: 0.0869s/iter; left time: 1401.5370s
Epoch: 11 cost time: 41.13656234741211
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.983 Test Loss: 0.229 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4229606
	speed: 0.2705s/iter; left time: 4330.4094s
	iters: 200, epoch: 12 | loss: 0.0034200
	speed: 0.1128s/iter; left time: 1795.1366s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1094s/iter; left time: 1730.0626s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 1468.5807s
Epoch: 12 cost time: 43.99137210845947
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.173 Vali Acc: 0.984 Test Loss: 0.173 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000590
	speed: 0.3050s/iter; left time: 4757.2016s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1098s/iter; left time: 1701.8985s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1097s/iter; left time: 1689.4579s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 1421.9619s
Epoch: 13 cost time: 44.611791133880615
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.988 Test Loss: 0.131 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2853s/iter; left time: 4331.8609s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0991s/iter; left time: 1495.3669s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0957s/iter; left time: 1433.3129s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 1338.6257s
Epoch: 14 cost time: 40.11034393310547
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.981 Test Loss: 0.231 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 36880138
model size : 155.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3846172
	speed: 0.1099s/iter; left time: 2257.6411s
	iters: 200, epoch: 1 | loss: 0.3511561
	speed: 0.0924s/iter; left time: 1889.0447s
	iters: 300, epoch: 1 | loss: 0.8572737
	speed: 0.0925s/iter; left time: 1881.6772s
	iters: 400, epoch: 1 | loss: 0.0110715
	speed: 0.0808s/iter; left time: 1635.4737s
Epoch: 1 cost time: 38.83192586898804
Epoch: 1, Steps: 413 | Train Loss: 0.507 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0134622
	speed: 0.2341s/iter; left time: 4713.3591s
	iters: 200, epoch: 2 | loss: 0.0132623
	speed: 0.0899s/iter; left time: 1801.5503s
	iters: 300, epoch: 2 | loss: 0.0042262
	speed: 0.0829s/iter; left time: 1652.3653s
	iters: 400, epoch: 2 | loss: 0.0039406
	speed: 0.0746s/iter; left time: 1480.5021s
Epoch: 2 cost time: 34.76237440109253
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.971804 --> -0.977261).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0048628
	speed: 0.2243s/iter; left time: 4423.4524s
	iters: 200, epoch: 3 | loss: 0.0028036
	speed: 0.0660s/iter; left time: 1296.1146s
	iters: 300, epoch: 3 | loss: 0.0025686
	speed: 0.0722s/iter; left time: 1410.1240s
	iters: 400, epoch: 3 | loss: 0.0000016
	speed: 0.0806s/iter; left time: 1565.3082s
Epoch: 3 cost time: 30.69750213623047
Epoch: 3, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
Validation loss decreased (-0.977261 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000239
	speed: 0.2201s/iter; left time: 4251.1632s
	iters: 200, epoch: 4 | loss: 0.1095400
	speed: 0.0731s/iter; left time: 1403.9577s
	iters: 300, epoch: 4 | loss: 0.0000007
	speed: 0.0740s/iter; left time: 1413.4690s
	iters: 400, epoch: 4 | loss: 0.0000610
	speed: 0.0902s/iter; left time: 1714.5463s
Epoch: 4 cost time: 32.059338331222534
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4568147
	speed: 0.2242s/iter; left time: 4237.1663s
	iters: 200, epoch: 5 | loss: 0.0062090
	speed: 0.0683s/iter; left time: 1284.8071s
	iters: 300, epoch: 5 | loss: 0.0000511
	speed: 0.0802s/iter; left time: 1499.1532s
	iters: 400, epoch: 5 | loss: 0.0000320
	speed: 0.0628s/iter; left time: 1168.1641s
Epoch: 5 cost time: 30.528578996658325
Epoch: 5, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0007945
	speed: 0.1984s/iter; left time: 3668.0805s
	iters: 200, epoch: 6 | loss: 0.0000298
	speed: 0.0522s/iter; left time: 960.6445s
	iters: 300, epoch: 6 | loss: 0.0001421
	speed: 0.0475s/iter; left time: 868.6647s
	iters: 400, epoch: 6 | loss: 0.4990387
	speed: 0.0449s/iter; left time: 815.8943s
Epoch: 6 cost time: 22.042298793792725
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.985447).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.2097s/iter; left time: 3790.3137s
	iters: 200, epoch: 7 | loss: 0.0000019
	speed: 0.0534s/iter; left time: 959.3481s
	iters: 300, epoch: 7 | loss: 0.0000002
	speed: 0.0530s/iter; left time: 946.8856s
	iters: 400, epoch: 7 | loss: 0.0007974
	speed: 0.0651s/iter; left time: 1157.1581s
Epoch: 7 cost time: 25.120265245437622
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.988 Test Loss: 0.085 Test Acc: 0.988
Validation loss decreased (-0.985447 --> -0.987721).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2382s/iter; left time: 4206.9609s
	iters: 200, epoch: 8 | loss: 0.0075984
	speed: 0.0724s/iter; left time: 1271.7545s
	iters: 300, epoch: 8 | loss: 0.0072378
	speed: 0.0586s/iter; left time: 1022.5853s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 1217.7945s
Epoch: 8 cost time: 29.4234938621521
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.176 Vali Acc: 0.981 Test Loss: 0.176 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2326s/iter; left time: 4012.5028s
	iters: 200, epoch: 9 | loss: 0.0000010
	speed: 0.0865s/iter; left time: 1482.7005s
	iters: 300, epoch: 9 | loss: 0.0002722
	speed: 0.0858s/iter; left time: 1462.6542s
	iters: 400, epoch: 9 | loss: 0.0004789
	speed: 0.0831s/iter; left time: 1407.9099s
Epoch: 9 cost time: 35.2955207824707
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000015
	speed: 0.2171s/iter; left time: 3653.8260s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 1347.7307s
	iters: 300, epoch: 10 | loss: 0.0000033
	speed: 0.0763s/iter; left time: 1269.4812s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0832s/iter; left time: 1375.5393s
Epoch: 10 cost time: 32.57276248931885
Epoch: 10, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1994s/iter; left time: 3273.5361s
	iters: 200, epoch: 11 | loss: 0.0000012
	speed: 0.0628s/iter; left time: 1025.2711s
	iters: 300, epoch: 11 | loss: 0.0011093
	speed: 0.0795s/iter; left time: 1289.6397s
	iters: 400, epoch: 11 | loss: 0.0001679
	speed: 0.0868s/iter; left time: 1399.8963s
Epoch: 11 cost time: 31.105647802352905
Epoch: 11, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.145 Vali Acc: 0.983 Test Loss: 0.145 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0010248
	speed: 0.2046s/iter; left time: 3274.7105s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 896.2889s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 981.8252s
	iters: 400, epoch: 12 | loss: 0.0000124
	speed: 0.0855s/iter; left time: 1343.1107s
Epoch: 12 cost time: 27.56398057937622
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.227 Vali Acc: 0.981 Test Loss: 0.227 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.2136s/iter; left time: 3330.7765s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 1087.0634s
	iters: 300, epoch: 13 | loss: 0.0000039
	speed: 0.0758s/iter; left time: 1167.2546s
	iters: 400, epoch: 13 | loss: 0.0008961
	speed: 0.0857s/iter; left time: 1310.5461s
Epoch: 13 cost time: 31.609175205230713
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.047 Vali Acc: 0.992 Test Loss: 0.047 Test Acc: 0.992
Validation loss decreased (-0.987721 --> -0.992269).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2417s/iter; left time: 3670.0608s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0704s/iter; left time: 1061.4704s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 998.0044s
	iters: 400, epoch: 14 | loss: 0.0006457
	speed: 0.0735s/iter; left time: 1094.5437s
Epoch: 14 cost time: 29.08884859085083
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.303 Vali Acc: 0.980 Test Loss: 0.303 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1721s/iter; left time: 2541.3631s
	iters: 200, epoch: 15 | loss: 0.0091945
	speed: 0.0420s/iter; left time: 616.6524s
	iters: 300, epoch: 15 | loss: 0.0021338
	speed: 0.0404s/iter; left time: 588.5366s
	iters: 400, epoch: 15 | loss: 0.0610760
	speed: 0.0437s/iter; left time: 632.4598s
Epoch: 15 cost time: 17.80677366256714
Epoch: 15, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.198 Vali Acc: 0.983 Test Loss: 0.198 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.1856s/iter; left time: 2664.0645s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 872.7407s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 741.5011s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 797.5811s
Epoch: 16 cost time: 25.431333780288696
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.985 Test Loss: 0.180 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2117s/iter; left time: 2952.1796s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 1028.8397s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1013.1829s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 1053.6701s
Epoch: 17 cost time: 31.155248880386353
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.990 Test Loss: 0.088 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.2250s/iter; left time: 3043.9617s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 929.3412s
	iters: 300, epoch: 18 | loss: 0.0000248
	speed: 0.0723s/iter; left time: 963.2509s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 663.1871s
Epoch: 18 cost time: 28.59528636932373
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.310 Vali Acc: 0.983 Test Loss: 0.310 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1470s/iter; left time: 1928.4095s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 687.0750s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 671.2356s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 759.9143s
Epoch: 19 cost time: 22.20141887664795
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.983 Test Loss: 0.243 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000034
	speed: 0.1587s/iter; left time: 2015.8847s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 449.6185s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 696.7978s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 682.4820s
Epoch: 20 cost time: 19.606732606887817
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.135 Vali Acc: 0.990 Test Loss: 0.135 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1677s/iter; left time: 2061.2321s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 685.2485s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 687.0302s
	iters: 400, epoch: 21 | loss: 0.0052158
	speed: 0.0463s/iter; left time: 554.9077s
Epoch: 21 cost time: 22.113682508468628
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.988 Test Loss: 0.191 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1816s/iter; left time: 2157.1980s
	iters: 200, epoch: 22 | loss: 0.0003261
	speed: 0.0676s/iter; left time: 796.3521s
	iters: 300, epoch: 22 | loss: 0.0002172
	speed: 0.0627s/iter; left time: 732.6845s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 699.9257s
Epoch: 22 cost time: 26.47861123085022
Epoch: 22, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.174 Vali Acc: 0.985 Test Loss: 0.174 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1837s/iter; left time: 2106.4052s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0671s/iter; left time: 762.2597s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 575.8320s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 549.8573s
Epoch: 23 cost time: 25.063755750656128
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.061 Vali Acc: 0.995 Test Loss: 0.061 Test Acc: 0.995
Validation loss decreased (-0.992269 --> -0.994542).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2801s/iter; left time: 3095.3722s
	iters: 200, epoch: 24 | loss: 0.0000003
	speed: 0.0628s/iter; left time: 687.3424s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 583.3700s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 643.3516s
Epoch: 24 cost time: 26.553346633911133
Epoch: 24, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.163 Vali Acc: 0.990 Test Loss: 0.163 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2227s/iter; left time: 2369.3594s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 800.6241s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 761.2553s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 716.7398s
Epoch: 25 cost time: 31.074426651000977
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.989 Test Loss: 0.197 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2358s/iter; left time: 2411.6302s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0886s/iter; left time: 897.2551s
	iters: 300, epoch: 26 | loss: 0.0025231
	speed: 0.0927s/iter; left time: 929.6247s
	iters: 400, epoch: 26 | loss: 3.1209278
	speed: 0.0927s/iter; left time: 919.6547s
Epoch: 26 cost time: 37.56827664375305
Epoch: 26, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.202 Vali Acc: 0.990 Test Loss: 0.202 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2284s/iter; left time: 2240.9880s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 814.7364s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 793.4830s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 710.6426s
Epoch: 27 cost time: 32.60312628746033
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.384 Vali Acc: 0.980 Test Loss: 0.384 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2159s/iter; left time: 2029.8583s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 669.4593s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 614.9698s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 535.8717s
Epoch: 28 cost time: 27.597867727279663
Epoch: 28, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.291 Vali Acc: 0.987 Test Loss: 0.291 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.1935545
	speed: 0.2310s/iter; left time: 2076.3803s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 538.9088s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 392.6099s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 436.7520s
Epoch: 29 cost time: 25.565059423446655
Epoch: 29, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.993 Test Loss: 0.070 Test Acc: 0.993
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1628s/iter; left time: 1395.9957s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 506.2299s
	iters: 300, epoch: 30 | loss: 2.4445829
	speed: 0.0792s/iter; left time: 663.5491s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 672.1193s
Epoch: 30 cost time: 28.843864679336548
Epoch: 30, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.989 Test Loss: 0.178 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2104s/iter; left time: 1717.2693s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 445.1234s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 457.8653s
	iters: 400, epoch: 31 | loss: 0.1149299
	speed: 0.0634s/iter; left time: 498.2642s
Epoch: 31 cost time: 25.824243545532227
Epoch: 31, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.995 Test Loss: 0.100 Test Acc: 0.995
Validation loss decreased (-0.994542 --> -0.995451).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1885s/iter; left time: 1460.7768s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 349.1704s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 331.6120s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 327.5139s
Epoch: 32 cost time: 19.213016986846924
Epoch: 32, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.986 Test Loss: 0.285 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1761s/iter; left time: 1291.6408s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 418.2926s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 371.8295s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 345.4574s
Epoch: 33 cost time: 23.36784815788269
Epoch: 33, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.154 Vali Acc: 0.990 Test Loss: 0.154 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1594s/iter; left time: 1103.5391s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 419.8651s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0866s/iter; left time: 581.8642s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 628.7320s
Epoch: 34 cost time: 30.694305658340454
Epoch: 34, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.985 Test Loss: 0.302 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2164s/iter; left time: 1408.8722s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 534.0352s
	iters: 300, epoch: 35 | loss: 1.7242446
	speed: 0.0782s/iter; left time: 493.2529s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 500.1279s
Epoch: 35 cost time: 32.909404277801514
Epoch: 35, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.990 Test Loss: 0.226 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2258s/iter; left time: 1376.3565s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 307.3814s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.0621s/iter; left time: 366.3539s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 325.4121s
Epoch: 36 cost time: 26.769386053085327
Epoch: 36, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.991 Test Loss: 0.143 Test Acc: 0.991
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.3781596
	speed: 0.2199s/iter; left time: 1249.9531s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 369.5466s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 379.4772s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 361.8078s
Epoch: 37 cost time: 28.74477195739746
Epoch: 37, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.076 Vali Acc: 0.994 Test Loss: 0.076 Test Acc: 0.994
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1959s/iter; left time: 1032.5660s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 213.2140s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 274.9599s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 370.4380s
Epoch: 38 cost time: 24.584715604782104
Epoch: 38, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.189 Vali Acc: 0.986 Test Loss: 0.189 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1870s/iter; left time: 908.4750s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 325.6473s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 290.7649s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 263.8670s
Epoch: 39 cost time: 24.753915786743164
Epoch: 39, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.069 Vali Acc: 0.994 Test Loss: 0.069 Test Acc: 0.994
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1884s/iter; left time: 837.1405s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 251.8779s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 189.4428s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 192.3780s
Epoch: 40 cost time: 23.140901803970337
Epoch: 40, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.278 Vali Acc: 0.987 Test Loss: 0.278 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1634s/iter; left time: 658.6028s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 189.6155s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 181.7166s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 176.1864s
Epoch: 41 cost time: 20.217019081115723
Epoch: 41, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.988 Test Loss: 0.419 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9954524783992724
model parameter : 36751114
model size : 154.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1929886
	speed: 0.0693s/iter; left time: 1423.5471s
	iters: 200, epoch: 1 | loss: 0.1808603
	speed: 0.0377s/iter; left time: 770.5821s
	iters: 300, epoch: 1 | loss: 0.3074435
	speed: 0.0392s/iter; left time: 798.0092s
	iters: 400, epoch: 1 | loss: 0.0093786
	speed: 0.0383s/iter; left time: 775.1588s
Epoch: 1 cost time: 19.043113231658936
Epoch: 1, Steps: 413 | Train Loss: 0.521 Vali Loss: 0.083 Vali Acc: 0.969 Test Loss: 0.083 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0073873
	speed: 0.1673s/iter; left time: 3370.0227s
	iters: 200, epoch: 2 | loss: 0.0029287
	speed: 0.0512s/iter; left time: 1025.2668s
	iters: 300, epoch: 2 | loss: 0.0076434
	speed: 0.0522s/iter; left time: 1040.0827s
	iters: 400, epoch: 2 | loss: 0.0099522
	speed: 0.0530s/iter; left time: 1051.8388s
Epoch: 2 cost time: 22.02628469467163
Epoch: 2, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969076 --> -0.969530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0534547
	speed: 0.1817s/iter; left time: 3584.2556s
	iters: 200, epoch: 3 | loss: 0.1630042
	speed: 0.0423s/iter; left time: 830.1259s
	iters: 300, epoch: 3 | loss: 0.1345107
	speed: 0.0546s/iter; left time: 1065.8072s
	iters: 400, epoch: 3 | loss: 0.1370438
	speed: 0.0594s/iter; left time: 1153.1776s
Epoch: 3 cost time: 21.490988731384277
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0008286
	speed: 0.1713s/iter; left time: 3308.8128s
	iters: 200, epoch: 4 | loss: 0.1676454
	speed: 0.0409s/iter; left time: 785.2288s
	iters: 300, epoch: 4 | loss: 0.0000992
	speed: 0.0405s/iter; left time: 774.6375s
	iters: 400, epoch: 4 | loss: 0.0232003
	speed: 0.0471s/iter; left time: 895.4771s
Epoch: 4 cost time: 17.82572603225708
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969530 --> -0.970440).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0005122
	speed: 0.1844s/iter; left time: 3485.5151s
	iters: 200, epoch: 5 | loss: 0.0000261
	speed: 0.0423s/iter; left time: 795.5772s
	iters: 300, epoch: 5 | loss: 0.0007946
	speed: 0.0424s/iter; left time: 792.9989s
	iters: 400, epoch: 5 | loss: 0.0002248
	speed: 0.0459s/iter; left time: 853.7108s
Epoch: 5 cost time: 18.638615369796753
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.076 Vali Acc: 0.986 Test Loss: 0.076 Test Acc: 0.986
Validation loss decreased (-0.970440 --> -0.985902).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000257
	speed: 0.1729s/iter; left time: 3196.6401s
	iters: 200, epoch: 6 | loss: 0.0000497
	speed: 0.0433s/iter; left time: 795.4265s
	iters: 300, epoch: 6 | loss: 0.0000306
	speed: 0.0534s/iter; left time: 976.0636s
	iters: 400, epoch: 6 | loss: 0.1550211
	speed: 0.0532s/iter; left time: 968.0222s
Epoch: 6 cost time: 20.728500366210938
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1458s/iter; left time: 2634.5925s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 644.6626s
	iters: 300, epoch: 7 | loss: 0.0024923
	speed: 0.0489s/iter; left time: 874.3721s
	iters: 400, epoch: 7 | loss: 0.0002081
	speed: 0.0584s/iter; left time: 1038.3752s
Epoch: 7 cost time: 19.50624990463257
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000026
	speed: 0.1806s/iter; left time: 3189.9133s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.0451s/iter; left time: 791.1672s
	iters: 300, epoch: 8 | loss: 0.0020042
	speed: 0.0494s/iter; left time: 862.3739s
	iters: 400, epoch: 8 | loss: 0.6415194
	speed: 0.0501s/iter; left time: 870.1739s
Epoch: 8 cost time: 19.752634525299072
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.969 Test Loss: 0.210 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1715s/iter; left time: 2958.5901s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0537s/iter; left time: 920.5482s
	iters: 300, epoch: 9 | loss: 0.0000059
	speed: 0.0595s/iter; left time: 1014.0085s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 828.0210s
Epoch: 9 cost time: 22.526246070861816
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.979 Test Loss: 0.155 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1374s/iter; left time: 2313.1070s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 645.0775s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 891.5809s
	iters: 400, epoch: 10 | loss: 0.0000015
	speed: 0.0536s/iter; left time: 886.1476s
Epoch: 10 cost time: 19.60595941543579
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1576s/iter; left time: 2588.3080s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0402s/iter; left time: 656.2037s
	iters: 300, epoch: 11 | loss: 0.0767165
	speed: 0.0404s/iter; left time: 654.6493s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 757.5197s
Epoch: 11 cost time: 17.914469957351685
Epoch: 11, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.444 Vali Acc: 0.955 Test Loss: 0.444 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1668s/iter; left time: 2669.3867s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 734.8427s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 774.4979s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 694.4452s
Epoch: 12 cost time: 19.951059579849243
Epoch: 12, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.990 Test Loss: 0.080 Test Acc: 0.990
Validation loss decreased (-0.985902 --> -0.989540).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1692s/iter; left time: 2639.3211s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0552s/iter; left time: 855.0508s
	iters: 300, epoch: 13 | loss: 0.0000039
	speed: 0.0581s/iter; left time: 894.1441s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 832.0761s
Epoch: 13 cost time: 21.025121927261353
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1640s/iter; left time: 2490.1917s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0436s/iter; left time: 657.5945s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 768.1707s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 713.2668s
Epoch: 14 cost time: 19.857792615890503
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 2723.2668s
	iters: 200, epoch: 15 | loss: 0.0005699
	speed: 0.0505s/iter; left time: 740.4605s
	iters: 300, epoch: 15 | loss: 0.3659478
	speed: 0.0506s/iter; left time: 737.3917s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 667.0563s
Epoch: 15 cost time: 21.002986907958984
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.267 Vali Acc: 0.974 Test Loss: 0.267 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0004435
	speed: 0.1549s/iter; left time: 2223.9500s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 621.9830s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 723.2458s
	iters: 400, epoch: 16 | loss: 0.0000003
	speed: 0.0399s/iter; left time: 560.7730s
Epoch: 16 cost time: 19.109389543533325
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.376 Vali Acc: 0.972 Test Loss: 0.376 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.1283s/iter; left time: 1788.9257s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0330s/iter; left time: 456.4742s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 497.0607s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 534.8350s
Epoch: 17 cost time: 14.987293481826782
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.293 Vali Acc: 0.976 Test Loss: 0.293 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000251
	speed: 0.1732s/iter; left time: 2343.8672s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0481s/iter; left time: 645.7837s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 662.4908s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 544.0730s
Epoch: 18 cost time: 20.09532403945923
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.982 Test Loss: 0.189 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1076040
	speed: 0.1336s/iter; left time: 1752.3877s
	iters: 200, epoch: 19 | loss: 0.0006369
	speed: 0.0383s/iter; left time: 498.5556s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 570.1821s
	iters: 400, epoch: 19 | loss: 0.0000059
	speed: 0.0470s/iter; left time: 602.5963s
Epoch: 19 cost time: 17.123136281967163
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.985 Test Loss: 0.125 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1624s/iter; left time: 2063.6965s
	iters: 200, epoch: 20 | loss: 0.0000066
	speed: 0.0438s/iter; left time: 551.9124s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 505.8930s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 540.5735s
Epoch: 20 cost time: 17.947087049484253
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.988 Test Loss: 0.124 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 0.1673s/iter; left time: 2055.9647s
	iters: 200, epoch: 21 | loss: 0.0000088
	speed: 0.0460s/iter; left time: 561.1316s
	iters: 300, epoch: 21 | loss: 0.5843083
	speed: 0.0464s/iter; left time: 560.4806s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.0466s/iter; left time: 558.4463s
Epoch: 21 cost time: 19.737918376922607
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.233 Vali Acc: 0.976 Test Loss: 0.233 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1427s/iter; left time: 1694.4935s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 456.8016s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0367s/iter; left time: 428.7021s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 375.5346s
Epoch: 22 cost time: 15.582410097122192
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.184 Vali Acc: 0.985 Test Loss: 0.184 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 36612874
model size : 154.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3001822
	speed: 0.0898s/iter; left time: 1845.5431s
	iters: 200, epoch: 1 | loss: 0.1731211
	speed: 0.0616s/iter; left time: 1259.2988s
	iters: 300, epoch: 1 | loss: 0.0413171
	speed: 0.0654s/iter; left time: 1330.3547s
	iters: 400, epoch: 1 | loss: 0.0629498
	speed: 0.0594s/iter; left time: 1202.3724s
Epoch: 1 cost time: 28.62962508201599
Epoch: 1, Steps: 413 | Train Loss: 0.518 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0019621
	speed: 0.2459s/iter; left time: 4952.4782s
	iters: 200, epoch: 2 | loss: 0.0018596
	speed: 0.0831s/iter; left time: 1665.7555s
	iters: 300, epoch: 2 | loss: 0.0003749
	speed: 0.0809s/iter; left time: 1612.2509s
	iters: 400, epoch: 2 | loss: 0.3649417
	speed: 0.0847s/iter; left time: 1680.0849s
Epoch: 2 cost time: 35.05268955230713
Epoch: 2, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.964983 --> -0.984083).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0722776
	speed: 0.3020s/iter; left time: 5956.7561s
	iters: 200, epoch: 3 | loss: 0.0053525
	speed: 0.0836s/iter; left time: 1641.5648s
	iters: 300, epoch: 3 | loss: 0.0000059
	speed: 0.0779s/iter; left time: 1521.4335s
	iters: 400, epoch: 3 | loss: 0.9541363
	speed: 0.0800s/iter; left time: 1554.3936s
Epoch: 3 cost time: 36.46158289909363
Epoch: 3, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.223 Vali Acc: 0.970 Test Loss: 0.223 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000144
	speed: 0.2714s/iter; left time: 5240.4500s
	iters: 200, epoch: 4 | loss: 0.0863007
	speed: 0.0792s/iter; left time: 1521.1864s
	iters: 300, epoch: 4 | loss: 0.0000947
	speed: 0.0937s/iter; left time: 1790.5610s
	iters: 400, epoch: 4 | loss: 0.0012325
	speed: 0.0972s/iter; left time: 1847.1631s
Epoch: 4 cost time: 36.73399257659912
Epoch: 4, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2930s/iter; left time: 5538.2851s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.1119s/iter; left time: 2103.3919s
	iters: 300, epoch: 5 | loss: 0.0121371
	speed: 0.0990s/iter; left time: 1850.5410s
	iters: 400, epoch: 5 | loss: 0.0446245
	speed: 0.1101s/iter; left time: 2048.2948s
Epoch: 5 cost time: 45.405304193496704
Epoch: 5, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.298 Vali Acc: 0.967 Test Loss: 0.298 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9017773
	speed: 0.3058s/iter; left time: 5653.2211s
	iters: 200, epoch: 6 | loss: 0.0001713
	speed: 0.1018s/iter; left time: 1872.0166s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0988s/iter; left time: 1807.3706s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.1025s/iter; left time: 1864.9054s
Epoch: 6 cost time: 41.99169683456421
Epoch: 6, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000011
	speed: 0.2717s/iter; left time: 4911.3246s
	iters: 200, epoch: 7 | loss: 0.0002241
	speed: 0.0859s/iter; left time: 1543.7136s
	iters: 300, epoch: 7 | loss: 0.0000007
	speed: 0.0802s/iter; left time: 1432.6884s
	iters: 400, epoch: 7 | loss: 0.0000042
	speed: 0.1047s/iter; left time: 1860.9317s
Epoch: 7 cost time: 38.87000894546509
Epoch: 7, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0032254
	speed: 0.2595s/iter; left time: 4582.4512s
	iters: 200, epoch: 8 | loss: 0.0000051
	speed: 0.0764s/iter; left time: 1341.6819s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1068s/iter; left time: 1865.4363s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1213s/iter; left time: 2105.7304s
Epoch: 8 cost time: 39.8751859664917
Epoch: 8, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.139 Vali Acc: 0.987 Test Loss: 0.139 Test Acc: 0.987
Validation loss decreased (-0.984083 --> -0.987266).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3345s/iter; left time: 5769.9678s
	iters: 200, epoch: 9 | loss: 0.0002587
	speed: 0.1121s/iter; left time: 1921.7641s
	iters: 300, epoch: 9 | loss: 0.0000008
	speed: 0.1069s/iter; left time: 1822.9034s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 1831.0295s
Epoch: 9 cost time: 46.36764907836914
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.986 Test Loss: 0.213 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000025
	speed: 0.2496s/iter; left time: 4202.5528s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0970s/iter; left time: 1623.9867s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.1092s/iter; left time: 1816.8722s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 1512.8676s
Epoch: 10 cost time: 38.6814866065979
Epoch: 10, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2507s/iter; left time: 4116.7495s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1112s/iter; left time: 1814.3315s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 1539.6452s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 1360.6437s
Epoch: 11 cost time: 40.146451234817505
Epoch: 11, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.233 Vali Acc: 0.980 Test Loss: 0.233 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000013
	speed: 0.3000s/iter; left time: 4802.0672s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1145s/iter; left time: 1821.9319s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1260s/iter; left time: 1991.1814s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 1606.3350s
Epoch: 12 cost time: 45.95335650444031
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.185 Vali Acc: 0.989 Test Loss: 0.185 Test Acc: 0.989
Validation loss decreased (-0.987266 --> -0.989084).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2834s/iter; left time: 4419.3510s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1019s/iter; left time: 1578.2399s
	iters: 300, epoch: 13 | loss: 1.0984956
	speed: 0.0828s/iter; left time: 1275.1877s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 1224.8071s
Epoch: 13 cost time: 39.227659940719604
Epoch: 13, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.275 Vali Acc: 0.979 Test Loss: 0.275 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2706s/iter; left time: 4107.6774s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 1406.5608s
	iters: 300, epoch: 14 | loss: 0.0110788
	speed: 0.0987s/iter; left time: 1478.4866s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0941s/iter; left time: 1400.0189s
Epoch: 14 cost time: 38.9105122089386
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.349 Vali Acc: 0.981 Test Loss: 0.349 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000388
	speed: 0.2375s/iter; left time: 3508.3534s
	iters: 200, epoch: 15 | loss: 0.0040453
	speed: 0.1190s/iter; left time: 1745.6552s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0928s/iter; left time: 1351.8399s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 1257.1999s
Epoch: 15 cost time: 41.59891438484192
Epoch: 15, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.446 Vali Acc: 0.976 Test Loss: 0.446 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000099
	speed: 0.2340s/iter; left time: 3359.7200s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0929s/iter; left time: 1324.1920s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 1117.0979s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 1019.3398s
Epoch: 16 cost time: 35.02496957778931
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.866 Vali Acc: 0.964 Test Loss: 0.866 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2074s/iter; left time: 2891.5174s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 1069.8681s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 836.3948s
	iters: 400, epoch: 17 | loss: 0.0000060
	speed: 0.0575s/iter; left time: 785.0262s
Epoch: 17 cost time: 28.92172360420227
Epoch: 17, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.264 Vali Acc: 0.982 Test Loss: 0.264 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2140s/iter; left time: 2895.9940s
	iters: 200, epoch: 18 | loss: 0.0000014
	speed: 0.0815s/iter; left time: 1094.7551s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 914.9062s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0659s/iter; left time: 872.2412s
Epoch: 18 cost time: 31.08901286125183
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.987 Test Loss: 0.218 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2948s/iter; left time: 3866.7249s
	iters: 200, epoch: 19 | loss: 0.0125346
	speed: 0.1151s/iter; left time: 1498.5957s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1102s/iter; left time: 1423.6664s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1088s/iter; left time: 1395.0169s
Epoch: 19 cost time: 46.876983404159546
Epoch: 19, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.988 Test Loss: 0.210 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3085s/iter; left time: 3919.2019s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1234s/iter; left time: 1555.8469s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 1157.1670s
	iters: 400, epoch: 20 | loss: 0.0000003
	speed: 0.0880s/iter; left time: 1091.6491s
Epoch: 20 cost time: 44.09963297843933
Epoch: 20, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.332 Vali Acc: 0.979 Test Loss: 0.332 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2660s/iter; left time: 3269.9426s
	iters: 200, epoch: 21 | loss: 0.3858692
	speed: 0.1117s/iter; left time: 1361.9982s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 1183.0295s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 1018.5399s
Epoch: 21 cost time: 42.221797704696655
Epoch: 21, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.461 Vali Acc: 0.986 Test Loss: 0.461 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2712s/iter; left time: 3221.7630s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1053s/iter; left time: 1240.6271s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1101s/iter; left time: 1286.0945s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1091s/iter; left time: 1263.3269s
Epoch: 22 cost time: 44.83793497085571
Epoch: 22, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.517 Vali Acc: 0.973 Test Loss: 0.517 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 36910090
model size : 155.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4229715
	speed: 0.1046s/iter; left time: 2149.6347s
	iters: 200, epoch: 1 | loss: 0.2532182
	speed: 0.0772s/iter; left time: 1579.0038s
	iters: 300, epoch: 1 | loss: 0.4164048
	speed: 0.0692s/iter; left time: 1408.3993s
	iters: 400, epoch: 1 | loss: 0.1275351
	speed: 0.0724s/iter; left time: 1466.1302s
Epoch: 1 cost time: 33.45545506477356
Epoch: 1, Steps: 413 | Train Loss: 0.521 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0678235
	speed: 0.2154s/iter; left time: 4337.8857s
	iters: 200, epoch: 2 | loss: 0.0558270
	speed: 0.0695s/iter; left time: 1392.0361s
	iters: 300, epoch: 2 | loss: 0.1330427
	speed: 0.0719s/iter; left time: 1432.9698s
	iters: 400, epoch: 2 | loss: 0.0001945
	speed: 0.0654s/iter; left time: 1296.7138s
Epoch: 2 cost time: 29.55813431739807
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
Validation loss decreased (-0.953614 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001668
	speed: 0.2227s/iter; left time: 4392.1310s
	iters: 200, epoch: 3 | loss: 0.0000491
	speed: 0.0717s/iter; left time: 1407.9012s
	iters: 300, epoch: 3 | loss: 0.0122891
	speed: 0.0719s/iter; left time: 1403.9847s
	iters: 400, epoch: 3 | loss: 0.0036873
	speed: 0.0706s/iter; left time: 1371.2459s
Epoch: 3 cost time: 28.633067846298218
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.965892 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3929226
	speed: 0.2382s/iter; left time: 4599.7124s
	iters: 200, epoch: 4 | loss: 0.0004601
	speed: 0.0760s/iter; left time: 1460.0374s
	iters: 300, epoch: 4 | loss: 0.0000016
	speed: 0.0708s/iter; left time: 1352.4992s
	iters: 400, epoch: 4 | loss: 0.3768624
	speed: 0.0828s/iter; left time: 1574.0130s
Epoch: 4 cost time: 32.51150059700012
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000059
	speed: 0.2426s/iter; left time: 4585.3509s
	iters: 200, epoch: 5 | loss: 0.0000100
	speed: 0.0885s/iter; left time: 1664.1970s
	iters: 300, epoch: 5 | loss: 0.0031774
	speed: 0.0683s/iter; left time: 1276.9621s
	iters: 400, epoch: 5 | loss: 0.4419525
	speed: 0.0789s/iter; left time: 1466.5924s
Epoch: 5 cost time: 34.56312322616577
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000819
	speed: 0.2300s/iter; left time: 4250.9470s
	iters: 200, epoch: 6 | loss: 0.0120865
	speed: 0.0808s/iter; left time: 1485.0182s
	iters: 300, epoch: 6 | loss: 0.0000076
	speed: 0.0757s/iter; left time: 1384.1095s
	iters: 400, epoch: 6 | loss: 0.0216427
	speed: 0.0643s/iter; left time: 1169.7141s
Epoch: 6 cost time: 31.77479386329651
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.313 Vali Acc: 0.955 Test Loss: 0.313 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0006752
	speed: 0.1885s/iter; left time: 3406.8391s
	iters: 200, epoch: 7 | loss: 0.5122309
	speed: 0.0763s/iter; left time: 1371.4363s
	iters: 300, epoch: 7 | loss: 0.0000378
	speed: 0.0703s/iter; left time: 1256.2587s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 934.9215s
Epoch: 7 cost time: 27.70125722885132
Epoch: 7, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1432s/iter; left time: 2528.4840s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 1197.1003s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 1390.4158s
	iters: 400, epoch: 8 | loss: 0.0000016
	speed: 0.0790s/iter; left time: 1371.1375s
Epoch: 8 cost time: 28.339433908462524
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.156 Vali Acc: 0.979 Test Loss: 0.156 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0308505
	speed: 0.2200s/iter; left time: 3794.2727s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0768s/iter; left time: 1316.9092s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 1146.1499s
	iters: 400, epoch: 9 | loss: 0.0000019
	speed: 0.0734s/iter; left time: 1244.2559s
Epoch: 9 cost time: 30.99522566795349
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.987 Test Loss: 0.107 Test Acc: 0.987
Validation loss decreased (-0.980899 --> -0.986811).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000003
	speed: 0.2218s/iter; left time: 3734.1969s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 1201.5480s
	iters: 300, epoch: 10 | loss: 0.0000008
	speed: 0.0610s/iter; left time: 1015.3412s
	iters: 400, epoch: 10 | loss: 0.0001216
	speed: 0.0509s/iter; left time: 841.7706s
Epoch: 10 cost time: 26.848938941955566
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.984 Test Loss: 0.135 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000021
	speed: 0.1877s/iter; left time: 3082.2829s
	iters: 200, epoch: 11 | loss: 0.3120925
	speed: 0.0698s/iter; left time: 1138.5605s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 1109.6651s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0681s/iter; left time: 1098.1420s
Epoch: 11 cost time: 28.25814700126648
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1966s/iter; left time: 3146.8913s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 844.2464s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0568s/iter; left time: 897.7633s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 667.8475s
Epoch: 12 cost time: 22.97123885154724
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.985 Test Loss: 0.159 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1900s/iter; left time: 2962.9003s
	iters: 200, epoch: 13 | loss: 0.0087668
	speed: 0.0535s/iter; left time: 829.1279s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 817.6664s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 783.2637s
Epoch: 13 cost time: 22.955494165420532
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1647s/iter; left time: 2500.5358s
	iters: 200, epoch: 14 | loss: 0.0068504
	speed: 0.0503s/iter; left time: 758.4765s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 778.3806s
	iters: 400, epoch: 14 | loss: 0.0020528
	speed: 0.0472s/iter; left time: 701.9560s
Epoch: 14 cost time: 22.06691265106201
Epoch: 14, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.197 Vali Acc: 0.981 Test Loss: 0.197 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0309831
	speed: 0.1483s/iter; left time: 2190.0834s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 600.3239s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 606.6067s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 606.0299s
Epoch: 15 cost time: 17.74421000480652
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.985 Test Loss: 0.140 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2651031
	speed: 0.1427s/iter; left time: 2049.2112s
	iters: 200, epoch: 16 | loss: 0.0000034
	speed: 0.0416s/iter; left time: 593.5632s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 606.3853s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 555.9522s
Epoch: 16 cost time: 18.34591507911682
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.170 Vali Acc: 0.982 Test Loss: 0.170 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2003s/iter; left time: 2792.1725s
	iters: 200, epoch: 17 | loss: 0.3405039
	speed: 0.0691s/iter; left time: 956.4236s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 658.2475s
	iters: 400, epoch: 17 | loss: 0.0000947
	speed: 0.0517s/iter; left time: 705.7285s
Epoch: 17 cost time: 25.509148836135864
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.980 Test Loss: 0.185 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1754s/iter; left time: 2372.7123s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 993.7798s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0845s/iter; left time: 1126.6472s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 898.5167s
Epoch: 18 cost time: 29.754629850387573
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0002531
	speed: 0.1563s/iter; left time: 2050.5227s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 665.6714s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 739.0907s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 796.5627s
Epoch: 19 cost time: 21.878761291503906
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.248 Vali Acc: 0.983 Test Loss: 0.248 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 36707338
model size : 154.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6886124
	speed: 0.0547s/iter; left time: 1124.4755s
	iters: 200, epoch: 1 | loss: 0.0213768
	speed: 0.0342s/iter; left time: 698.5017s
	iters: 300, epoch: 1 | loss: 0.1105093
	speed: 0.0322s/iter; left time: 655.3077s
	iters: 400, epoch: 1 | loss: 0.2295204
	speed: 0.0345s/iter; left time: 698.0080s
Epoch: 1 cost time: 16.100730419158936
Epoch: 1, Steps: 413 | Train Loss: 0.545 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0025228
	speed: 0.1444s/iter; left time: 2908.1538s
	iters: 200, epoch: 2 | loss: 0.1110312
	speed: 0.0407s/iter; left time: 816.3799s
	iters: 300, epoch: 2 | loss: 0.0005954
	speed: 0.0502s/iter; left time: 1001.0960s
	iters: 400, epoch: 2 | loss: 0.1579985
	speed: 0.0408s/iter; left time: 809.0000s
Epoch: 2 cost time: 18.44149112701416
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0068221
	speed: 0.1779s/iter; left time: 3509.4324s
	iters: 200, epoch: 3 | loss: 0.0397674
	speed: 0.0524s/iter; left time: 1028.7493s
	iters: 300, epoch: 3 | loss: 0.5134103
	speed: 0.0499s/iter; left time: 974.0250s
	iters: 400, epoch: 3 | loss: 0.0000747
	speed: 0.0519s/iter; left time: 1007.7713s
Epoch: 3 cost time: 21.025766611099243
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0304875
	speed: 0.1852s/iter; left time: 3575.6287s
	iters: 200, epoch: 4 | loss: 0.0005779
	speed: 0.0450s/iter; left time: 864.5689s
	iters: 300, epoch: 4 | loss: 0.0001182
	speed: 0.0443s/iter; left time: 846.2491s
	iters: 400, epoch: 4 | loss: 0.0082766
	speed: 0.0388s/iter; left time: 738.2149s
Epoch: 4 cost time: 18.139676094055176
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.978626 --> -0.984083).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1853510
	speed: 0.1832s/iter; left time: 3462.2829s
	iters: 200, epoch: 5 | loss: 0.2923082
	speed: 0.0390s/iter; left time: 732.5275s
	iters: 300, epoch: 5 | loss: 0.0000069
	speed: 0.0404s/iter; left time: 755.2726s
	iters: 400, epoch: 5 | loss: 0.0025319
	speed: 0.0357s/iter; left time: 663.7461s
Epoch: 5 cost time: 16.78305697441101
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000279
	speed: 0.1534s/iter; left time: 2835.3952s
	iters: 200, epoch: 6 | loss: 0.0033958
	speed: 0.0364s/iter; left time: 669.4454s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0365s/iter; left time: 668.2115s
	iters: 400, epoch: 6 | loss: 0.0000010
	speed: 0.0336s/iter; left time: 610.9078s
Epoch: 6 cost time: 16.04292917251587
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0088801
	speed: 0.1247s/iter; left time: 2253.8545s
	iters: 200, epoch: 7 | loss: 0.0061036
	speed: 0.0307s/iter; left time: 551.0130s
	iters: 300, epoch: 7 | loss: 0.0330062
	speed: 0.0346s/iter; left time: 617.5331s
	iters: 400, epoch: 7 | loss: 0.0000157
	speed: 0.0469s/iter; left time: 833.3210s
Epoch: 7 cost time: 15.623218774795532
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000005
	speed: 0.1557s/iter; left time: 2750.4299s
	iters: 200, epoch: 8 | loss: 0.0002184
	speed: 0.0402s/iter; left time: 706.4025s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0381s/iter; left time: 664.4787s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0438s/iter; left time: 759.6791s
Epoch: 8 cost time: 16.945414066314697
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1633s/iter; left time: 2816.6358s
	iters: 200, epoch: 9 | loss: 0.0000624
	speed: 0.0482s/iter; left time: 826.7530s
	iters: 300, epoch: 9 | loss: 0.0003462
	speed: 0.0475s/iter; left time: 808.8867s
	iters: 400, epoch: 9 | loss: 0.0000009
	speed: 0.0397s/iter; left time: 672.7275s
Epoch: 9 cost time: 19.402387619018555
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.985 Test Loss: 0.122 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.984992).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000019
	speed: 0.1611s/iter; left time: 2712.4756s
	iters: 200, epoch: 10 | loss: 0.0000013
	speed: 0.0399s/iter; left time: 667.8272s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 685.7210s
	iters: 400, epoch: 10 | loss: 0.0000021
	speed: 0.0412s/iter; left time: 681.9961s
Epoch: 10 cost time: 16.860323667526245
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.981 Test Loss: 0.156 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000061
	speed: 0.1531s/iter; left time: 2514.7071s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 582.6771s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0360s/iter; left time: 584.2079s
	iters: 400, epoch: 11 | loss: 0.0010538
	speed: 0.0342s/iter; left time: 550.5810s
Epoch: 11 cost time: 15.17854356765747
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1542s/iter; left time: 2468.6572s
	iters: 200, epoch: 12 | loss: 0.0000339
	speed: 0.0409s/iter; left time: 651.3567s
	iters: 300, epoch: 12 | loss: 0.0000014
	speed: 0.0353s/iter; left time: 557.9188s
	iters: 400, epoch: 12 | loss: 0.0000107
	speed: 0.0365s/iter; left time: 573.7519s
Epoch: 12 cost time: 16.484721899032593
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000042
	speed: 0.1387s/iter; left time: 2163.4493s
	iters: 200, epoch: 13 | loss: 0.0114908
	speed: 0.0310s/iter; left time: 479.6828s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0325s/iter; left time: 500.6520s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 501.6357s
Epoch: 13 cost time: 14.156916856765747
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.982 Test Loss: 0.203 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0002966
	speed: 0.1298s/iter; left time: 1971.3218s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 525.2788s
	iters: 300, epoch: 14 | loss: 0.0786211
	speed: 0.0352s/iter; left time: 527.8275s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.0359s/iter; left time: 533.6622s
Epoch: 14 cost time: 14.998175621032715
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.162 Vali Acc: 0.981 Test Loss: 0.162 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000101
	speed: 0.1405s/iter; left time: 2074.5879s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 483.7432s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 492.9964s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 485.2077s
Epoch: 15 cost time: 15.037892818450928
Epoch: 15, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.978 Test Loss: 0.230 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1321s/iter; left time: 1896.1501s
	iters: 200, epoch: 16 | loss: 0.3056559
	speed: 0.0365s/iter; left time: 520.7967s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0316s/iter; left time: 447.3395s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 511.4213s
Epoch: 16 cost time: 15.014873266220093
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.182 Vali Acc: 0.984 Test Loss: 0.182 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0291740
	speed: 0.1250s/iter; left time: 1742.1864s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0339s/iter; left time: 469.3851s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 461.5114s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 426.1976s
Epoch: 17 cost time: 14.039862632751465
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.987 Test Loss: 0.156 Test Acc: 0.987
Validation loss decreased (-0.984992 --> -0.987265).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000793
	speed: 0.1454s/iter; left time: 1967.5473s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 426.6358s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0307s/iter; left time: 409.5828s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 428.8004s
Epoch: 18 cost time: 13.674576044082642
Epoch: 18, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.987 Test Loss: 0.205 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1277s/iter; left time: 1675.3460s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0336s/iter; left time: 437.8120s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0343s/iter; left time: 443.6641s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 573.9177s
Epoch: 19 cost time: 15.732249021530151
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.206 Vali Acc: 0.979 Test Loss: 0.206 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1619s/iter; left time: 2056.4868s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 492.5599s
	iters: 300, epoch: 20 | loss: 0.0001867
	speed: 0.0366s/iter; left time: 457.9759s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 546.2576s
Epoch: 20 cost time: 17.056998014450073
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.987 Test Loss: 0.120 Test Acc: 0.987
Validation loss decreased (-0.987265 --> -0.987266).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1817s/iter; left time: 2232.8143s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 450.5784s
	iters: 300, epoch: 21 | loss: 0.0000205
	speed: 0.0386s/iter; left time: 467.0909s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 437.6906s
Epoch: 21 cost time: 16.20572328567505
Epoch: 21, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.298 Vali Acc: 0.976 Test Loss: 0.298 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1574s/iter; left time: 1869.6150s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 382.1011s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 395.3171s
	iters: 400, epoch: 22 | loss: 0.0000004
	speed: 0.0327s/iter; left time: 378.0220s
Epoch: 22 cost time: 14.720979452133179
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.983 Test Loss: 0.216 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000019
	speed: 0.1495s/iter; left time: 1713.5502s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 470.6737s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 384.6160s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 404.7133s
Epoch: 23 cost time: 16.269498109817505
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.214 Vali Acc: 0.983 Test Loss: 0.214 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1367s/iter; left time: 1510.4885s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 426.2050s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 423.5346s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 418.3040s
Epoch: 24 cost time: 16.43345308303833
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.271 Vali Acc: 0.985 Test Loss: 0.271 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1299s/iter; left time: 1381.8331s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 340.0814s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 351.2599s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 402.1065s
Epoch: 25 cost time: 14.598843097686768
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.327 Vali Acc: 0.982 Test Loss: 0.327 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1287s/iter; left time: 1315.9183s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 458.0197s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 502.2666s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 505.7235s
Epoch: 26 cost time: 19.164177894592285
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.985 Test Loss: 0.197 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1854s/iter; left time: 1819.2851s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 468.4993s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 398.9174s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 406.2482s
Epoch: 27 cost time: 19.245192050933838
Epoch: 27, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.985 Test Loss: 0.341 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1699s/iter; left time: 1597.0966s
	iters: 200, epoch: 28 | loss: 0.0000015
	speed: 0.0457s/iter; left time: 425.3979s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 392.7397s
	iters: 400, epoch: 28 | loss: 0.0029767
	speed: 0.0352s/iter; left time: 320.5047s
Epoch: 28 cost time: 18.455175161361694
Epoch: 28, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.977 Test Loss: 0.328 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1502s/iter; left time: 1350.0531s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 386.0531s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 355.8873s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 416.2855s
Epoch: 29 cost time: 18.613353729248047
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.303 Vali Acc: 0.981 Test Loss: 0.303 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1116707
	speed: 0.1551s/iter; left time: 1329.8844s
	iters: 200, epoch: 30 | loss: 0.0730962
	speed: 0.0438s/iter; left time: 370.9293s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 339.3154s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 363.4095s
Epoch: 30 cost time: 17.801307201385498
Epoch: 30, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.986 Test Loss: 0.215 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 36624394
model size : 154.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1546150
	speed: 0.1167s/iter; left time: 2398.1728s
	iters: 200, epoch: 1 | loss: 0.0056780
	speed: 0.0824s/iter; left time: 1684.5806s
	iters: 300, epoch: 1 | loss: 0.3391875
	speed: 0.0931s/iter; left time: 1894.3538s
	iters: 400, epoch: 1 | loss: 0.6461074
	speed: 0.1049s/iter; left time: 2123.4617s
Epoch: 1 cost time: 41.31714105606079
Epoch: 1, Steps: 413 | Train Loss: 0.512 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (inf --> -0.958161).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0131519
	speed: 0.2313s/iter; left time: 4657.2176s
	iters: 200, epoch: 2 | loss: 0.0035942
	speed: 0.0598s/iter; left time: 1198.8738s
	iters: 300, epoch: 2 | loss: 0.0014228
	speed: 0.0782s/iter; left time: 1559.0705s
	iters: 400, epoch: 2 | loss: 0.0631628
	speed: 0.0526s/iter; left time: 1042.5552s
Epoch: 2 cost time: 27.37733817100525
Epoch: 2, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
Validation loss decreased (-0.958161 --> -0.964073).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001192
	speed: 0.2353s/iter; left time: 4640.5167s
	iters: 200, epoch: 3 | loss: 0.0000699
	speed: 0.0578s/iter; left time: 1134.6721s
	iters: 300, epoch: 3 | loss: 0.0911742
	speed: 0.0637s/iter; left time: 1243.1321s
	iters: 400, epoch: 3 | loss: 0.0566973
	speed: 0.0665s/iter; left time: 1291.4600s
Epoch: 3 cost time: 26.51320457458496
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
Validation loss decreased (-0.964073 --> -0.967256).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000858
	speed: 0.2407s/iter; left time: 4649.3000s
	iters: 200, epoch: 4 | loss: 0.0000567
	speed: 0.0766s/iter; left time: 1471.8219s
	iters: 300, epoch: 4 | loss: 0.0003878
	speed: 0.0775s/iter; left time: 1480.3204s
	iters: 400, epoch: 4 | loss: 0.1275626
	speed: 0.0893s/iter; left time: 1696.9367s
Epoch: 4 cost time: 33.22063612937927
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.967256 --> -0.979535).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0072390
	speed: 0.2459s/iter; left time: 4646.9905s
	iters: 200, epoch: 5 | loss: 0.1223269
	speed: 0.0845s/iter; left time: 1588.2710s
	iters: 300, epoch: 5 | loss: 0.0048782
	speed: 0.1011s/iter; left time: 1891.1846s
	iters: 400, epoch: 5 | loss: 0.0000002
	speed: 0.1016s/iter; left time: 1889.6474s
Epoch: 5 cost time: 37.59405755996704
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000526
	speed: 0.2502s/iter; left time: 4624.7424s
	iters: 200, epoch: 6 | loss: 0.0005895
	speed: 0.0780s/iter; left time: 1433.2978s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0938s/iter; left time: 1714.4809s
	iters: 400, epoch: 6 | loss: 0.0000007
	speed: 0.1008s/iter; left time: 1832.7040s
Epoch: 6 cost time: 36.93161916732788
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0002621
	speed: 0.2467s/iter; left time: 4458.5734s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0921s/iter; left time: 1655.4892s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 1770.2336s
	iters: 400, epoch: 7 | loss: 0.0000008
	speed: 0.1157s/iter; left time: 2056.7260s
Epoch: 7 cost time: 40.4969048500061
Epoch: 7, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.109 Vali Acc: 0.990 Test Loss: 0.109 Test Acc: 0.990
Validation loss decreased (-0.979535 --> -0.989994).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008232
	speed: 0.3191s/iter; left time: 5635.3335s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1004s/iter; left time: 1763.0914s
	iters: 300, epoch: 8 | loss: 0.3285773
	speed: 0.1055s/iter; left time: 1841.6264s
	iters: 400, epoch: 8 | loss: 0.4782393
	speed: 0.1016s/iter; left time: 1763.1768s
Epoch: 8 cost time: 42.24505257606506
Epoch: 8, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.154 Vali Acc: 0.984 Test Loss: 0.154 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2405s/iter; left time: 4147.5133s
	iters: 200, epoch: 9 | loss: 0.0000005
	speed: 0.0712s/iter; left time: 1221.4796s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 1585.6183s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1025s/iter; left time: 1737.6253s
Epoch: 9 cost time: 36.090131998062134
Epoch: 9, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.357 Vali Acc: 0.970 Test Loss: 0.357 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2492s/iter; left time: 4194.2671s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 1336.1490s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1045s/iter; left time: 1738.5628s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1150s/iter; left time: 1900.6650s
Epoch: 10 cost time: 39.79260039329529
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.980 Test Loss: 0.220 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2895s/iter; left time: 4753.1828s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 1653.0397s
	iters: 300, epoch: 11 | loss: 0.0000043
	speed: 0.1111s/iter; left time: 1801.7037s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1097s/iter; left time: 1768.1704s
Epoch: 11 cost time: 43.22208762168884
Epoch: 11, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2544s/iter; left time: 4072.6809s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0949s/iter; left time: 1509.0395s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0974s/iter; left time: 1539.7195s
	iters: 400, epoch: 12 | loss: 0.0229356
	speed: 0.0880s/iter; left time: 1382.7838s
Epoch: 12 cost time: 37.528422117233276
Epoch: 12, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.135 Vali Acc: 0.988 Test Loss: 0.135 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000420
	speed: 0.2544s/iter; left time: 3967.9730s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 1368.6930s
	iters: 300, epoch: 13 | loss: 0.0076638
	speed: 0.0919s/iter; left time: 1414.8252s
	iters: 400, epoch: 13 | loss: 0.1703214
	speed: 0.0996s/iter; left time: 1523.6748s
Epoch: 13 cost time: 37.64055037498474
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.268 Vali Acc: 0.984 Test Loss: 0.268 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2890s/iter; left time: 4388.2367s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.1064s/iter; left time: 1604.0635s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1060s/iter; left time: 1587.6039s
	iters: 400, epoch: 14 | loss: 0.0003241
	speed: 0.1069s/iter; left time: 1591.2304s
Epoch: 14 cost time: 43.7972469329834
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.990 Test Loss: 0.126 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2780s/iter; left time: 4105.0485s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 1371.8359s
	iters: 300, epoch: 15 | loss: 0.2066035
	speed: 0.0836s/iter; left time: 1218.5619s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 1307.5521s
Epoch: 15 cost time: 37.777393102645874
Epoch: 15, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.399 Vali Acc: 0.976 Test Loss: 0.399 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0261543
	speed: 0.2689s/iter; left time: 3859.8131s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0919s/iter; left time: 1310.5810s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 1097.8012s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1235.0372s
Epoch: 16 cost time: 36.66946244239807
Epoch: 16, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.988 Test Loss: 0.206 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2918s/iter; left time: 4068.1273s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1080s/iter; left time: 1495.4792s
	iters: 300, epoch: 17 | loss: 0.6152613
	speed: 0.0960s/iter; left time: 1319.0757s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 1396.8284s
Epoch: 17 cost time: 43.329530477523804
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.235 Vali Acc: 0.983 Test Loss: 0.235 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 36930826
model size : 155.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1873735
	speed: 0.0912s/iter; left time: 1874.9474s
	iters: 200, epoch: 1 | loss: 0.3124915
	speed: 0.0689s/iter; left time: 1409.7093s
	iters: 300, epoch: 1 | loss: 1.0027381
	speed: 0.0763s/iter; left time: 1552.8013s
	iters: 400, epoch: 1 | loss: 0.0861648
	speed: 0.0725s/iter; left time: 1467.2141s
Epoch: 1 cost time: 31.99135732650757
Epoch: 1, Steps: 413 | Train Loss: 0.504 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
Validation loss decreased (inf --> -0.958161).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3178606
	speed: 0.1747s/iter; left time: 3517.4991s
	iters: 200, epoch: 2 | loss: 0.0002524
	speed: 0.0570s/iter; left time: 1142.3008s
	iters: 300, epoch: 2 | loss: 0.0283207
	speed: 0.0636s/iter; left time: 1268.7126s
	iters: 400, epoch: 2 | loss: 0.0004673
	speed: 0.0750s/iter; left time: 1486.8599s
Epoch: 2 cost time: 25.958388090133667
Epoch: 2, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.958161 --> -0.966801).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000130
	speed: 0.2121s/iter; left time: 4183.4033s
	iters: 200, epoch: 3 | loss: 0.5249392
	speed: 0.0620s/iter; left time: 1216.5975s
	iters: 300, epoch: 3 | loss: 0.0004407
	speed: 0.0669s/iter; left time: 1306.6715s
	iters: 400, epoch: 3 | loss: 0.0144244
	speed: 0.0505s/iter; left time: 981.1669s
Epoch: 3 cost time: 25.869410514831543
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000018
	speed: 0.2014s/iter; left time: 3889.6136s
	iters: 200, epoch: 4 | loss: 0.0000034
	speed: 0.0518s/iter; left time: 995.9694s
	iters: 300, epoch: 4 | loss: 0.0000080
	speed: 0.0556s/iter; left time: 1061.9419s
	iters: 400, epoch: 4 | loss: 0.0006850
	speed: 0.0510s/iter; left time: 969.0873s
Epoch: 4 cost time: 23.684372186660767
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.961 Test Loss: 0.252 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0006804
	speed: 0.1681s/iter; left time: 3177.2654s
	iters: 200, epoch: 5 | loss: 0.0000434
	speed: 0.0549s/iter; left time: 1031.6877s
	iters: 300, epoch: 5 | loss: 0.0000925
	speed: 0.0442s/iter; left time: 826.3246s
	iters: 400, epoch: 5 | loss: 0.0002106
	speed: 0.0461s/iter; left time: 856.9670s
Epoch: 5 cost time: 21.246646404266357
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.966801 --> -0.983174).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000260
	speed: 0.2169s/iter; left time: 4009.7660s
	iters: 200, epoch: 6 | loss: 0.0000414
	speed: 0.0640s/iter; left time: 1177.4449s
	iters: 300, epoch: 6 | loss: 0.1901765
	speed: 0.0645s/iter; left time: 1179.5707s
	iters: 400, epoch: 6 | loss: 0.0000032
	speed: 0.0517s/iter; left time: 940.5923s
Epoch: 6 cost time: 26.618627309799194
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.177 Vali Acc: 0.976 Test Loss: 0.177 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000032
	speed: 0.1900s/iter; left time: 3433.7004s
	iters: 200, epoch: 7 | loss: 0.0006865
	speed: 0.0656s/iter; left time: 1179.1029s
	iters: 300, epoch: 7 | loss: 0.0008280
	speed: 0.0644s/iter; left time: 1150.7026s
	iters: 400, epoch: 7 | loss: 0.1509075
	speed: 0.0758s/iter; left time: 1346.6293s
Epoch: 7 cost time: 28.90776038169861
Epoch: 7, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0117024
	speed: 0.2118s/iter; left time: 3740.9209s
	iters: 200, epoch: 8 | loss: 0.0000023
	speed: 0.0750s/iter; left time: 1317.1231s
	iters: 300, epoch: 8 | loss: 0.0000285
	speed: 0.0616s/iter; left time: 1074.9507s
	iters: 400, epoch: 8 | loss: 0.4875508
	speed: 0.0773s/iter; left time: 1342.2530s
Epoch: 8 cost time: 30.654945135116577
Epoch: 8, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000063
	speed: 0.2138s/iter; left time: 3687.0774s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0691s/iter; left time: 1184.3694s
	iters: 300, epoch: 9 | loss: 0.0000005
	speed: 0.0559s/iter; left time: 953.6450s
	iters: 400, epoch: 9 | loss: 0.0000253
	speed: 0.0495s/iter; left time: 838.8002s
Epoch: 9 cost time: 27.00703001022339
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.977 Test Loss: 0.205 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.1895s/iter; left time: 3190.5713s
	iters: 200, epoch: 10 | loss: 0.0000025
	speed: 0.0644s/iter; left time: 1077.1882s
	iters: 300, epoch: 10 | loss: 0.0005882
	speed: 0.0633s/iter; left time: 1052.6234s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 977.1831s
Epoch: 10 cost time: 26.30370783805847
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.976 Test Loss: 0.206 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0294848
	speed: 0.1826s/iter; left time: 2998.1194s
	iters: 200, epoch: 11 | loss: 0.0091247
	speed: 0.0718s/iter; left time: 1171.7868s
	iters: 300, epoch: 11 | loss: 0.0000056
	speed: 0.0677s/iter; left time: 1098.6040s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 982.3094s
Epoch: 11 cost time: 27.781113147735596
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0005139
	speed: 0.1796s/iter; left time: 2875.5861s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0806s/iter; left time: 1282.1197s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 1247.8232s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 1206.8775s
Epoch: 12 cost time: 31.023892164230347
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.979 Test Loss: 0.202 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1574s/iter; left time: 2454.2320s
	iters: 200, epoch: 13 | loss: 0.0001634
	speed: 0.0540s/iter; left time: 836.4970s
	iters: 300, epoch: 13 | loss: 0.0028704
	speed: 0.0657s/iter; left time: 1010.9701s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 893.5702s
Epoch: 13 cost time: 23.74945306777954
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000004
	speed: 0.1576s/iter; left time: 2392.3834s
	iters: 200, epoch: 14 | loss: 0.0000022
	speed: 0.0432s/iter; left time: 652.1919s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 864.8505s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0883s/iter; left time: 1314.0675s
Epoch: 14 cost time: 25.07731819152832
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.166 Vali Acc: 0.985 Test Loss: 0.166 Test Acc: 0.985
Validation loss decreased (-0.983174 --> -0.985446).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2012s/iter; left time: 2971.5443s
	iters: 200, epoch: 15 | loss: 0.0002304
	speed: 0.0610s/iter; left time: 894.9334s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 874.1716s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0803s/iter; left time: 1161.7499s
Epoch: 15 cost time: 27.0102961063385
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.985 Test Loss: 0.219 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1467s/iter; left time: 2106.3950s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 537.6544s
	iters: 300, epoch: 16 | loss: 0.0001045
	speed: 0.0337s/iter; left time: 477.1372s
	iters: 400, epoch: 16 | loss: 0.0000044
	speed: 0.0546s/iter; left time: 767.4329s
Epoch: 16 cost time: 18.187134265899658
Epoch: 16, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1712s/iter; left time: 2387.5317s
	iters: 200, epoch: 17 | loss: 0.0000219
	speed: 0.0590s/iter; left time: 816.2834s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 567.6948s
	iters: 400, epoch: 17 | loss: 0.0000973
	speed: 0.0531s/iter; left time: 723.9562s
Epoch: 17 cost time: 22.2327823638916
Epoch: 17, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.227 Vali Acc: 0.980 Test Loss: 0.227 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1523s/iter; left time: 2060.9434s
	iters: 200, epoch: 18 | loss: 0.3121169
	speed: 0.0405s/iter; left time: 543.3413s
	iters: 300, epoch: 18 | loss: 1.2999756
	speed: 0.0348s/iter; left time: 463.3995s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0296s/iter; left time: 391.8033s
Epoch: 18 cost time: 16.19345498085022
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1297s/iter; left time: 1701.4578s
	iters: 200, epoch: 19 | loss: 0.0000007
	speed: 0.0398s/iter; left time: 517.9008s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 476.2905s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 578.4867s
Epoch: 19 cost time: 17.08838653564453
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.989 Test Loss: 0.141 Test Acc: 0.989
Validation loss decreased (-0.985446 --> -0.988630).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1572s/iter; left time: 1997.0400s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 612.3576s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 578.8884s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 579.3661s
Epoch: 20 cost time: 19.989054679870605
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.988 Test Loss: 0.166 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0001464
	speed: 0.1533s/iter; left time: 1884.5978s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 598.4801s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 469.1009s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 469.1353s
Epoch: 21 cost time: 19.0724139213562
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.454 Vali Acc: 0.979 Test Loss: 0.454 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1784s/iter; left time: 2118.7398s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 516.8736s
	iters: 300, epoch: 22 | loss: 0.0000005
	speed: 0.0439s/iter; left time: 512.1367s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 509.5059s
Epoch: 22 cost time: 20.4701566696167
Epoch: 22, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.990 Test Loss: 0.109 Test Acc: 0.990
Validation loss decreased (-0.988630 --> -0.990449).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1871s/iter; left time: 2144.9260s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 521.6601s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 488.0556s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 463.3326s
Epoch: 23 cost time: 19.14543652534485
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.988 Test Loss: 0.123 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1774s/iter; left time: 1960.9156s
	iters: 200, epoch: 24 | loss: 0.0000004
	speed: 0.0465s/iter; left time: 509.1513s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 397.1663s
	iters: 400, epoch: 24 | loss: 0.8338889
	speed: 0.0557s/iter; left time: 598.5905s
Epoch: 24 cost time: 20.588749647140503
Epoch: 24, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.186 Vali Acc: 0.985 Test Loss: 0.186 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1865s/iter; left time: 1984.6900s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 606.3044s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 577.5012s
	iters: 400, epoch: 25 | loss: 0.0834802
	speed: 0.0552s/iter; left time: 570.4031s
Epoch: 25 cost time: 25.316033840179443
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.989 Test Loss: 0.200 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1975s/iter; left time: 2019.3506s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 577.9325s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 488.7685s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 501.5680s
Epoch: 26 cost time: 24.213177919387817
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.987 Test Loss: 0.187 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1692s/iter; left time: 1660.2887s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 440.0677s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 446.3936s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 458.0004s
Epoch: 27 cost time: 20.735413789749146
Epoch: 27, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.276 Vali Acc: 0.981 Test Loss: 0.276 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1709s/iter; left time: 1606.7395s
	iters: 200, epoch: 28 | loss: 0.8008765
	speed: 0.0467s/iter; left time: 434.1226s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 419.7709s
	iters: 400, epoch: 28 | loss: 0.7761054
	speed: 0.0480s/iter; left time: 437.0026s
Epoch: 28 cost time: 20.777844429016113
Epoch: 28, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.242 Vali Acc: 0.985 Test Loss: 0.242 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1770s/iter; left time: 1590.3499s
	iters: 200, epoch: 29 | loss: 0.1779158
	speed: 0.0440s/iter; left time: 390.8709s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 522.3573s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 671.9591s
Epoch: 29 cost time: 25.09393572807312
Epoch: 29, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.385 Vali Acc: 0.979 Test Loss: 0.385 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1899s/iter; left time: 1627.8326s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 473.8761s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 628.8495s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 611.2766s
Epoch: 30 cost time: 28.458298206329346
Epoch: 30, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.986 Test Loss: 0.166 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1703s/iter; left time: 1389.5219s
	iters: 200, epoch: 31 | loss: 0.0000285
	speed: 0.0533s/iter; left time: 429.9372s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0627s/iter; left time: 498.8814s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 484.9772s
Epoch: 31 cost time: 23.779815673828125
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.985 Test Loss: 0.184 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1608s/iter; left time: 1246.1422s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 439.2260s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 464.3859s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 467.4477s
Epoch: 32 cost time: 24.025071144104004
Epoch: 32, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.273 Vali Acc: 0.984 Test Loss: 0.273 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 36737290
model size : 154.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7477188
	speed: 0.0569s/iter; left time: 1169.4546s
	iters: 200, epoch: 1 | loss: 0.3292732
	speed: 0.0377s/iter; left time: 770.1256s
	iters: 300, epoch: 1 | loss: 0.2389593
	speed: 0.0385s/iter; left time: 783.5866s
	iters: 400, epoch: 1 | loss: 0.0075411
	speed: 0.0349s/iter; left time: 706.9198s
Epoch: 1 cost time: 17.411272525787354
Epoch: 1, Steps: 413 | Train Loss: 0.554 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1892122
	speed: 0.1413s/iter; left time: 2845.1932s
	iters: 200, epoch: 2 | loss: 0.4042619
	speed: 0.0332s/iter; left time: 664.4670s
	iters: 300, epoch: 2 | loss: 0.0059800
	speed: 0.0356s/iter; left time: 710.0487s
	iters: 400, epoch: 2 | loss: 0.0208209
	speed: 0.0336s/iter; left time: 667.1133s
Epoch: 2 cost time: 15.295937538146973
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.965438 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0333438
	speed: 0.1487s/iter; left time: 2932.4531s
	iters: 200, epoch: 3 | loss: 0.0024220
	speed: 0.0357s/iter; left time: 700.2157s
	iters: 300, epoch: 3 | loss: 0.1131804
	speed: 0.0356s/iter; left time: 695.8167s
	iters: 400, epoch: 3 | loss: 0.0032335
	speed: 0.0331s/iter; left time: 642.0831s
Epoch: 3 cost time: 14.95089340209961
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0023287
	speed: 0.1238s/iter; left time: 2390.8675s
	iters: 200, epoch: 4 | loss: 0.0158819
	speed: 0.0265s/iter; left time: 509.1092s
	iters: 300, epoch: 4 | loss: 0.0000642
	speed: 0.0271s/iter; left time: 518.7861s
	iters: 400, epoch: 4 | loss: 0.0007003
	speed: 0.0292s/iter; left time: 555.3082s
Epoch: 4 cost time: 12.95378041267395
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.974533 --> -0.979535).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0010885
	speed: 0.1305s/iter; left time: 2465.6660s
	iters: 200, epoch: 5 | loss: 0.0039074
	speed: 0.0273s/iter; left time: 513.4536s
	iters: 300, epoch: 5 | loss: 0.0019532
	speed: 0.0274s/iter; left time: 512.7854s
	iters: 400, epoch: 5 | loss: 0.0050700
	speed: 0.0287s/iter; left time: 534.0320s
Epoch: 5 cost time: 12.232642412185669
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.269 Vali Acc: 0.958 Test Loss: 0.269 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0323428
	speed: 0.1107s/iter; left time: 2046.3215s
	iters: 200, epoch: 6 | loss: 0.0000131
	speed: 0.0318s/iter; left time: 585.0258s
	iters: 300, epoch: 6 | loss: 0.0028489
	speed: 0.0323s/iter; left time: 590.2773s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0301s/iter; left time: 546.8124s
Epoch: 6 cost time: 13.396831750869751
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0148581
	speed: 0.1288s/iter; left time: 2326.9258s
	iters: 200, epoch: 7 | loss: 0.0000033
	speed: 0.0436s/iter; left time: 784.0922s
	iters: 300, epoch: 7 | loss: 0.0106693
	speed: 0.0429s/iter; left time: 767.1144s
	iters: 400, epoch: 7 | loss: 0.0167270
	speed: 0.0413s/iter; left time: 734.6036s
Epoch: 7 cost time: 18.2035391330719
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000013
	speed: 0.1484s/iter; left time: 2621.5214s
	iters: 200, epoch: 8 | loss: 0.0000004
	speed: 0.0423s/iter; left time: 742.2666s
	iters: 300, epoch: 8 | loss: 0.2441484
	speed: 0.0375s/iter; left time: 655.0356s
	iters: 400, epoch: 8 | loss: 0.0000031
	speed: 0.0392s/iter; left time: 680.3155s
Epoch: 8 cost time: 17.14202642440796
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.038 Vali Acc: 0.990 Test Loss: 0.038 Test Acc: 0.990
Validation loss decreased (-0.979535 --> -0.990450).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000066
	speed: 0.1673s/iter; left time: 2884.8211s
	iters: 200, epoch: 9 | loss: 0.1377367
	speed: 0.0405s/iter; left time: 694.3208s
	iters: 300, epoch: 9 | loss: 0.0039398
	speed: 0.0394s/iter; left time: 671.7885s
	iters: 400, epoch: 9 | loss: 0.0007965
	speed: 0.0385s/iter; left time: 653.3052s
Epoch: 9 cost time: 17.59765601158142
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003384
	speed: 0.1543s/iter; left time: 2596.8969s
	iters: 200, epoch: 10 | loss: 0.0001361
	speed: 0.0386s/iter; left time: 645.7358s
	iters: 300, epoch: 10 | loss: 0.0000006
	speed: 0.0307s/iter; left time: 510.1440s
	iters: 400, epoch: 10 | loss: 0.0000296
	speed: 0.0354s/iter; left time: 585.3733s
Epoch: 10 cost time: 15.506330728530884
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000105
	speed: 0.1415s/iter; left time: 2322.7510s
	iters: 200, epoch: 11 | loss: 0.1516466
	speed: 0.0418s/iter; left time: 682.2168s
	iters: 300, epoch: 11 | loss: 0.0000073
	speed: 0.0388s/iter; left time: 629.0632s
	iters: 400, epoch: 11 | loss: 0.0000281
	speed: 0.0370s/iter; left time: 596.1271s
Epoch: 11 cost time: 17.01899743080139
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000108
	speed: 0.1416s/iter; left time: 2266.6844s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 603.8531s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 596.1075s
	iters: 400, epoch: 12 | loss: 0.0635216
	speed: 0.0390s/iter; left time: 612.5385s
Epoch: 12 cost time: 16.204107522964478
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0002020
	speed: 0.1536s/iter; left time: 2395.9527s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 629.6315s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 641.7043s
	iters: 400, epoch: 13 | loss: 0.0000203
	speed: 0.0376s/iter; left time: 575.2266s
Epoch: 13 cost time: 17.573206424713135
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2647895
	speed: 0.1534s/iter; left time: 2328.9343s
	iters: 200, epoch: 14 | loss: 0.1204765
	speed: 0.0473s/iter; left time: 714.0553s
	iters: 300, epoch: 14 | loss: 0.0000007
	speed: 0.0415s/iter; left time: 622.1880s
	iters: 400, epoch: 14 | loss: 0.3171085
	speed: 0.0419s/iter; left time: 622.9206s
Epoch: 14 cost time: 18.73707389831543
Epoch: 14, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.211 Vali Acc: 0.974 Test Loss: 0.211 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000925
	speed: 0.1422s/iter; left time: 2100.3834s
	iters: 200, epoch: 15 | loss: 0.1865080
	speed: 0.0405s/iter; left time: 593.5320s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 517.7696s
	iters: 400, epoch: 15 | loss: 0.0000079
	speed: 0.0365s/iter; left time: 528.5877s
Epoch: 15 cost time: 16.75631093978882
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.346 Vali Acc: 0.961 Test Loss: 0.346 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0175489
	speed: 0.1439s/iter; left time: 2065.5181s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 528.8579s
	iters: 300, epoch: 16 | loss: 0.0000107
	speed: 0.0367s/iter; left time: 519.4245s
	iters: 400, epoch: 16 | loss: 0.0000275
	speed: 0.0368s/iter; left time: 516.6847s
Epoch: 16 cost time: 16.214693784713745
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.986 Test Loss: 0.113 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1350s/iter; left time: 1882.4771s
	iters: 200, epoch: 17 | loss: 0.0114415
	speed: 0.0374s/iter; left time: 517.5596s
	iters: 300, epoch: 17 | loss: 0.0000006
	speed: 0.0387s/iter; left time: 531.8021s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 517.6763s
Epoch: 17 cost time: 15.68789029121399
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.984 Test Loss: 0.173 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1463s/iter; left time: 1979.7261s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 539.3006s
	iters: 300, epoch: 18 | loss: 0.0001052
	speed: 0.0342s/iter; left time: 455.9527s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0352s/iter; left time: 466.0436s
Epoch: 18 cost time: 15.617074489593506
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.987 Test Loss: 0.124 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 36635914
model size : 154.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5710701
	speed: 0.0930s/iter; left time: 1911.5153s
	iters: 200, epoch: 1 | loss: 0.5989236
	speed: 0.0612s/iter; left time: 1251.1854s
	iters: 300, epoch: 1 | loss: 0.0104044
	speed: 0.0705s/iter; left time: 1435.0003s
	iters: 400, epoch: 1 | loss: 0.0000947
	speed: 0.0715s/iter; left time: 1447.9123s
Epoch: 1 cost time: 30.77608585357666
Epoch: 1, Steps: 413 | Train Loss: 0.489 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0208169
	speed: 0.1869s/iter; left time: 3764.0791s
	iters: 200, epoch: 2 | loss: 0.0012627
	speed: 0.0512s/iter; left time: 1025.5957s
	iters: 300, epoch: 2 | loss: 0.0735777
	speed: 0.0506s/iter; left time: 1009.6190s
	iters: 400, epoch: 2 | loss: 0.0848813
	speed: 0.0625s/iter; left time: 1239.2473s
Epoch: 2 cost time: 22.25130295753479
Epoch: 2, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.966347 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001936
	speed: 0.1964s/iter; left time: 3873.4864s
	iters: 200, epoch: 3 | loss: 0.0004237
	speed: 0.0639s/iter; left time: 1254.6702s
	iters: 300, epoch: 3 | loss: 0.0000989
	speed: 0.0550s/iter; left time: 1073.2097s
	iters: 400, epoch: 3 | loss: 0.2164157
	speed: 0.0478s/iter; left time: 929.2902s
Epoch: 3 cost time: 23.627861976623535
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.973169 --> -0.987266).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0063637
	speed: 0.1983s/iter; left time: 3829.7800s
	iters: 200, epoch: 4 | loss: 0.0000390
	speed: 0.0581s/iter; left time: 1115.7239s
	iters: 300, epoch: 4 | loss: 0.1169832
	speed: 0.0598s/iter; left time: 1142.4907s
	iters: 400, epoch: 4 | loss: 0.0194641
	speed: 0.0509s/iter; left time: 966.9925s
Epoch: 4 cost time: 25.246047496795654
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000150
	speed: 0.1811s/iter; left time: 3422.6977s
	iters: 200, epoch: 5 | loss: 0.0000029
	speed: 0.0710s/iter; left time: 1335.4462s
	iters: 300, epoch: 5 | loss: 0.0000003
	speed: 0.0774s/iter; left time: 1447.1937s
	iters: 400, epoch: 5 | loss: 0.0020005
	speed: 0.0734s/iter; left time: 1364.7660s
Epoch: 5 cost time: 29.039876461029053
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.141 Vali Acc: 0.982 Test Loss: 0.141 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000002
	speed: 0.1865s/iter; left time: 3447.4355s
	iters: 200, epoch: 6 | loss: 0.0000684
	speed: 0.0729s/iter; left time: 1340.1389s
	iters: 300, epoch: 6 | loss: 0.2815733
	speed: 0.0568s/iter; left time: 1038.4220s
	iters: 400, epoch: 6 | loss: 0.0000015
	speed: 0.0582s/iter; left time: 1057.9483s
Epoch: 6 cost time: 26.957852363586426
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0031185
	speed: 0.1787s/iter; left time: 3230.5381s
	iters: 200, epoch: 7 | loss: 0.2615147
	speed: 0.0491s/iter; left time: 882.2154s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0487s/iter; left time: 869.7967s
	iters: 400, epoch: 7 | loss: 0.0000143
	speed: 0.0551s/iter; left time: 978.4804s
Epoch: 7 cost time: 22.3773353099823
Epoch: 7, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.194 Vali Acc: 0.979 Test Loss: 0.194 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0026525
	speed: 0.1767s/iter; left time: 3121.0163s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 1031.6294s
	iters: 300, epoch: 8 | loss: 0.0000003
	speed: 0.0566s/iter; left time: 988.6637s
	iters: 400, epoch: 8 | loss: 0.4437839
	speed: 0.0636s/iter; left time: 1104.1577s
Epoch: 8 cost time: 25.036083221435547
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.245 Vali Acc: 0.981 Test Loss: 0.245 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000008
	speed: 0.1633s/iter; left time: 2816.3611s
	iters: 200, epoch: 9 | loss: 0.0236386
	speed: 0.0808s/iter; left time: 1385.8230s
	iters: 300, epoch: 9 | loss: 0.0000311
	speed: 0.0752s/iter; left time: 1281.6941s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0695s/iter; left time: 1178.2410s
Epoch: 9 cost time: 29.254462480545044
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.197 Vali Acc: 0.978 Test Loss: 0.197 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2376802
	speed: 0.1912s/iter; left time: 3218.1232s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 1008.3945s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 1057.5664s
	iters: 400, epoch: 10 | loss: 0.0001331
	speed: 0.0726s/iter; left time: 1200.4753s
Epoch: 10 cost time: 27.817328929901123
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.987 Test Loss: 0.166 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1787s/iter; left time: 2934.4893s
	iters: 200, epoch: 11 | loss: 0.0000616
	speed: 0.0495s/iter; left time: 808.1424s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 841.6736s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0631s/iter; left time: 1016.5733s
Epoch: 11 cost time: 22.35137414932251
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.298 Vali Acc: 0.973 Test Loss: 0.298 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.0816419
	speed: 0.1508s/iter; left time: 2414.4826s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 688.1593s
	iters: 300, epoch: 12 | loss: 0.0011519
	speed: 0.0453s/iter; left time: 716.2989s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 614.5255s
Epoch: 12 cost time: 17.54317593574524
Epoch: 12, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.150 Vali Acc: 0.983 Test Loss: 0.150 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1468s/iter; left time: 2288.6054s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 670.6600s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 605.4589s
	iters: 400, epoch: 13 | loss: 0.0000441
	speed: 0.0386s/iter; left time: 590.2065s
Epoch: 13 cost time: 18.157001733779907
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.356 Vali Acc: 0.978 Test Loss: 0.356 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 36831754
model size : 155.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2833612
	speed: 0.0647s/iter; left time: 1329.4223s
	iters: 200, epoch: 1 | loss: 0.3168716
	speed: 0.0501s/iter; left time: 1024.5155s
	iters: 300, epoch: 1 | loss: 0.0304270
	speed: 0.0368s/iter; left time: 748.5285s
	iters: 400, epoch: 1 | loss: 0.3443394
	speed: 0.0376s/iter; left time: 761.3195s
Epoch: 1 cost time: 19.428396701812744
Epoch: 1, Steps: 413 | Train Loss: 0.516 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
Validation loss decreased (inf --> -0.965892).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0964913
	speed: 0.1659s/iter; left time: 3340.8683s
	iters: 200, epoch: 2 | loss: 0.0006201
	speed: 0.0295s/iter; left time: 590.6998s
	iters: 300, epoch: 2 | loss: 0.1116792
	speed: 0.0314s/iter; left time: 626.4492s
	iters: 400, epoch: 2 | loss: 0.0163877
	speed: 0.0301s/iter; left time: 596.6580s
Epoch: 2 cost time: 15.143025875091553
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.965892 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002756
	speed: 0.1476s/iter; left time: 2911.8351s
	iters: 200, epoch: 3 | loss: 0.0002176
	speed: 0.0379s/iter; left time: 744.6897s
	iters: 300, epoch: 3 | loss: 0.0254516
	speed: 0.0326s/iter; left time: 635.9290s
	iters: 400, epoch: 3 | loss: 0.0007159
	speed: 0.0330s/iter; left time: 640.5269s
Epoch: 3 cost time: 15.256436824798584
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.969076 --> -0.982719).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001506
	speed: 0.1892s/iter; left time: 3653.5534s
	iters: 200, epoch: 4 | loss: 0.0000017
	speed: 0.0649s/iter; left time: 1247.0191s
	iters: 300, epoch: 4 | loss: 0.0000288
	speed: 0.0604s/iter; left time: 1153.7389s
	iters: 400, epoch: 4 | loss: 0.0000199
	speed: 0.0513s/iter; left time: 975.2209s
Epoch: 4 cost time: 23.96873164176941
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000496
	speed: 0.1936s/iter; left time: 3658.3249s
	iters: 200, epoch: 5 | loss: 0.0000060
	speed: 0.0878s/iter; left time: 1650.9976s
	iters: 300, epoch: 5 | loss: 0.0073833
	speed: 0.0710s/iter; left time: 1327.8593s
	iters: 400, epoch: 5 | loss: 0.0000170
	speed: 0.0560s/iter; left time: 1041.2406s
Epoch: 5 cost time: 30.049609422683716
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.2027s/iter; left time: 3746.8426s
	iters: 200, epoch: 6 | loss: 0.0000426
	speed: 0.0812s/iter; left time: 1493.2856s
	iters: 300, epoch: 6 | loss: 0.0000006
	speed: 0.0621s/iter; left time: 1136.3909s
	iters: 400, epoch: 6 | loss: 0.0059240
	speed: 0.0589s/iter; left time: 1070.4962s
Epoch: 6 cost time: 30.394412994384766
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001204
	speed: 0.1898s/iter; left time: 3430.6681s
	iters: 200, epoch: 7 | loss: 0.0004309
	speed: 0.0676s/iter; left time: 1214.9060s
	iters: 300, epoch: 7 | loss: 0.0000017
	speed: 0.0455s/iter; left time: 813.8098s
	iters: 400, epoch: 7 | loss: 0.0001278
	speed: 0.0451s/iter; left time: 802.3191s
Epoch: 7 cost time: 24.74394917488098
Epoch: 7, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000011
	speed: 0.1781s/iter; left time: 3145.1000s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.0722s/iter; left time: 1267.7167s
	iters: 300, epoch: 8 | loss: 0.0050643
	speed: 0.0561s/iter; left time: 979.1999s
	iters: 400, epoch: 8 | loss: 0.0000079
	speed: 0.0441s/iter; left time: 765.8280s
Epoch: 8 cost time: 25.343780279159546
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.3115437
	speed: 0.1838s/iter; left time: 3169.1874s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 1250.8653s
	iters: 300, epoch: 9 | loss: 0.0000189
	speed: 0.0593s/iter; left time: 1011.1934s
	iters: 400, epoch: 9 | loss: 0.0000020
	speed: 0.0536s/iter; left time: 907.7358s
Epoch: 9 cost time: 26.409265518188477
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.984537).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000040
	speed: 0.2115s/iter; left time: 3560.1342s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 1277.3140s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 1099.4681s
	iters: 400, epoch: 10 | loss: 0.0000129
	speed: 0.0536s/iter; left time: 886.8693s
Epoch: 10 cost time: 27.89762258529663
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.970 Test Loss: 0.327 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.1974s/iter; left time: 3242.0296s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 995.8281s
	iters: 300, epoch: 11 | loss: 0.0000016
	speed: 0.0558s/iter; left time: 904.8126s
	iters: 400, epoch: 11 | loss: 0.0063032
	speed: 0.0557s/iter; left time: 897.3784s
Epoch: 11 cost time: 24.706751585006714
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.965 Test Loss: 0.273 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000019
	speed: 0.1820s/iter; left time: 2912.9775s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 914.7879s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 957.7373s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0580s/iter; left time: 910.7302s
Epoch: 12 cost time: 25.59555196762085
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.983 Test Loss: 0.148 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1797s/iter; left time: 2802.3629s
	iters: 200, epoch: 13 | loss: 0.0012472
	speed: 0.0510s/iter; left time: 790.1834s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 876.0151s
	iters: 400, epoch: 13 | loss: 0.0000043
	speed: 0.0573s/iter; left time: 875.8848s
Epoch: 13 cost time: 24.26132297515869
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.982 Test Loss: 0.195 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1427s/iter; left time: 2166.3546s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 936.5829s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0576s/iter; left time: 862.9947s
	iters: 400, epoch: 14 | loss: 0.0000775
	speed: 0.0598s/iter; left time: 890.5322s
Epoch: 14 cost time: 23.057522296905518
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.985 Test Loss: 0.151 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.985446).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0006735
	speed: 0.1763s/iter; left time: 2604.0143s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0479s/iter; left time: 702.9369s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 868.2192s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 846.3866s
Epoch: 15 cost time: 23.09500503540039
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.990 Test Loss: 0.087 Test Acc: 0.990
Validation loss decreased (-0.985446 --> -0.989995).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1590s/iter; left time: 2282.9278s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 578.0601s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 714.8950s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 707.7019s
Epoch: 16 cost time: 19.592206239700317
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.984 Test Loss: 0.218 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1485s/iter; left time: 2069.8935s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 592.0109s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 390.5416s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 682.4372s
Epoch: 17 cost time: 16.97014570236206
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.260 Vali Acc: 0.982 Test Loss: 0.260 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000004
	speed: 0.1512s/iter; left time: 2045.8980s
	iters: 200, epoch: 18 | loss: 0.3557792
	speed: 0.0400s/iter; left time: 537.4553s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 705.0629s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 835.8661s
Epoch: 18 cost time: 21.41285490989685
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.981 Test Loss: 0.172 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1626s/iter; left time: 2132.5193s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 526.7556s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 490.5427s
	iters: 400, epoch: 19 | loss: 0.4355119
	speed: 0.0501s/iter; left time: 642.7072s
Epoch: 19 cost time: 17.999555587768555
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.300 Vali Acc: 0.983 Test Loss: 0.300 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1881s/iter; left time: 2389.5211s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 619.0664s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 622.7916s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 638.5996s
Epoch: 20 cost time: 22.411638259887695
Epoch: 20, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.983 Test Loss: 0.220 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1612s/iter; left time: 1981.8769s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 499.4911s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 482.5371s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 550.5599s
Epoch: 21 cost time: 18.936845779418945
Epoch: 21, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.985 Test Loss: 0.140 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1618s/iter; left time: 1921.3901s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 570.1506s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 469.3133s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 565.5437s
Epoch: 22 cost time: 19.828924655914307
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.983 Test Loss: 0.265 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0002675
	speed: 0.1590s/iter; left time: 1823.4270s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 557.9565s
	iters: 300, epoch: 23 | loss: 0.0000239
	speed: 0.0433s/iter; left time: 487.4546s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 514.6331s
Epoch: 23 cost time: 20.058109045028687
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.292 Vali Acc: 0.980 Test Loss: 0.292 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1607s/iter; left time: 1776.4102s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 543.7709s
	iters: 300, epoch: 24 | loss: 0.0002107
	speed: 0.0498s/iter; left time: 540.5801s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 457.1475s
Epoch: 24 cost time: 20.440816402435303
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.986 Test Loss: 0.205 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1546s/iter; left time: 1644.7920s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 514.9190s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 526.2884s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 568.3474s
Epoch: 25 cost time: 21.309272527694702
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.488 Vali Acc: 0.975 Test Loss: 0.488 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 36721162
model size : 154.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4314801
	speed: 0.0675s/iter; left time: 1387.1111s
	iters: 200, epoch: 1 | loss: 0.2260039
	speed: 0.0458s/iter; left time: 936.4377s
	iters: 300, epoch: 1 | loss: 0.3283094
	speed: 0.0460s/iter; left time: 936.8636s
	iters: 400, epoch: 1 | loss: 0.1041344
	speed: 0.0559s/iter; left time: 1131.8873s
Epoch: 1 cost time: 22.369913339614868
Epoch: 1, Steps: 413 | Train Loss: 0.556 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0058476
	speed: 0.1685s/iter; left time: 3393.2185s
	iters: 200, epoch: 2 | loss: 0.1319725
	speed: 0.0415s/iter; left time: 831.2756s
	iters: 300, epoch: 2 | loss: 0.0239664
	speed: 0.0388s/iter; left time: 773.0325s
	iters: 400, epoch: 2 | loss: 0.1301723
	speed: 0.0410s/iter; left time: 813.5475s
Epoch: 2 cost time: 17.4423086643219
Epoch: 2, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.957252 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012706
	speed: 0.1627s/iter; left time: 3208.6632s
	iters: 200, epoch: 3 | loss: 0.0013192
	speed: 0.0343s/iter; left time: 672.2131s
	iters: 300, epoch: 3 | loss: 0.0014888
	speed: 0.0283s/iter; left time: 552.4732s
	iters: 400, epoch: 3 | loss: 0.0147786
	speed: 0.0320s/iter; left time: 622.1332s
Epoch: 3 cost time: 14.088319778442383
Epoch: 3, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0005416
	speed: 0.1349s/iter; left time: 2604.9900s
	iters: 200, epoch: 4 | loss: 0.0633081
	speed: 0.0332s/iter; left time: 637.2779s
	iters: 300, epoch: 4 | loss: 0.0001279
	speed: 0.0282s/iter; left time: 539.2974s
	iters: 400, epoch: 4 | loss: 0.0806945
	speed: 0.0303s/iter; left time: 576.4145s
Epoch: 4 cost time: 13.268438577651978
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0766388
	speed: 0.1125s/iter; left time: 2125.4653s
	iters: 200, epoch: 5 | loss: 0.0000085
	speed: 0.0407s/iter; left time: 764.4078s
	iters: 300, epoch: 5 | loss: 0.0013161
	speed: 0.0378s/iter; left time: 707.4031s
	iters: 400, epoch: 5 | loss: 0.0001456
	speed: 0.0372s/iter; left time: 691.5704s
Epoch: 5 cost time: 15.610497951507568
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.979081 --> -0.984083).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0046025
	speed: 0.1484s/iter; left time: 2743.6195s
	iters: 200, epoch: 6 | loss: 0.0000049
	speed: 0.0370s/iter; left time: 680.9051s
	iters: 300, epoch: 6 | loss: 0.0000717
	speed: 0.0399s/iter; left time: 729.3481s
	iters: 400, epoch: 6 | loss: 0.0007597
	speed: 0.0381s/iter; left time: 693.6326s
Epoch: 6 cost time: 16.174642086029053
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000197
	speed: 0.1324s/iter; left time: 2393.1126s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0373s/iter; left time: 669.5136s
	iters: 300, epoch: 7 | loss: 0.2157152
	speed: 0.0315s/iter; left time: 562.8345s
	iters: 400, epoch: 7 | loss: 0.0022689
	speed: 0.0398s/iter; left time: 706.5859s
Epoch: 7 cost time: 15.38984203338623
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000396
	speed: 0.1325s/iter; left time: 2339.3776s
	iters: 200, epoch: 8 | loss: 0.0000131
	speed: 0.0310s/iter; left time: 543.7740s
	iters: 300, epoch: 8 | loss: 0.0009903
	speed: 0.0335s/iter; left time: 584.2061s
	iters: 400, epoch: 8 | loss: 0.0002813
	speed: 0.0288s/iter; left time: 499.7593s
Epoch: 8 cost time: 13.5664541721344
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0018603
	speed: 0.1279s/iter; left time: 2205.2492s
	iters: 200, epoch: 9 | loss: 0.0051371
	speed: 0.0384s/iter; left time: 657.6659s
	iters: 300, epoch: 9 | loss: 0.0065936
	speed: 0.0368s/iter; left time: 626.8031s
	iters: 400, epoch: 9 | loss: 0.0735984
	speed: 0.0318s/iter; left time: 539.2836s
Epoch: 9 cost time: 15.150036096572876
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.289 Vali Acc: 0.963 Test Loss: 0.289 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0013414
	speed: 0.1264s/iter; left time: 2127.3368s
	iters: 200, epoch: 10 | loss: 0.0000180
	speed: 0.0369s/iter; left time: 617.7193s
	iters: 300, epoch: 10 | loss: 0.0092676
	speed: 0.0438s/iter; left time: 727.9230s
	iters: 400, epoch: 10 | loss: 0.0099108
	speed: 0.0441s/iter; left time: 729.9520s
Epoch: 10 cost time: 17.131178379058838
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.977 Test Loss: 0.237 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.1523s/iter; left time: 2501.2684s
	iters: 200, epoch: 11 | loss: 0.0004816
	speed: 0.0353s/iter; left time: 576.5970s
	iters: 300, epoch: 11 | loss: 0.0312454
	speed: 0.0347s/iter; left time: 563.3289s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 680.9949s
Epoch: 11 cost time: 15.980286598205566
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1779348
	speed: 0.1721s/iter; left time: 2754.9794s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0519s/iter; left time: 826.1297s
	iters: 300, epoch: 12 | loss: 0.0577900
	speed: 0.0515s/iter; left time: 814.1484s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0430s/iter; left time: 675.9142s
Epoch: 12 cost time: 20.95941472053528
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2533961
	speed: 0.1590s/iter; left time: 2480.3034s
	iters: 200, epoch: 13 | loss: 0.0000449
	speed: 0.0381s/iter; left time: 589.6600s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 810.7285s
	iters: 400, epoch: 13 | loss: 0.0008964
	speed: 0.0524s/iter; left time: 800.9798s
Epoch: 13 cost time: 19.8553786277771
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.362 Vali Acc: 0.968 Test Loss: 0.362 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1584s/iter; left time: 2404.7273s
	iters: 200, epoch: 14 | loss: 0.0000004
	speed: 0.0412s/iter; left time: 621.6322s
	iters: 300, epoch: 14 | loss: 0.0002342
	speed: 0.0365s/iter; left time: 546.1007s
	iters: 400, epoch: 14 | loss: 0.0000078
	speed: 0.0396s/iter; left time: 589.7937s
Epoch: 14 cost time: 16.47172212600708
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1542s/iter; left time: 2278.0739s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.0452s/iter; left time: 662.5584s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0450s/iter; left time: 656.1896s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 541.5333s
Epoch: 15 cost time: 18.490249633789062
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 36656650
model size : 154.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0851809
	speed: 0.0802s/iter; left time: 1647.2289s
	iters: 200, epoch: 1 | loss: 0.1573897
	speed: 0.0832s/iter; left time: 1702.2622s
	iters: 300, epoch: 1 | loss: 0.1110925
	speed: 0.0892s/iter; left time: 1814.5029s
	iters: 400, epoch: 1 | loss: 0.0143573
	speed: 0.0913s/iter; left time: 1848.3459s
Epoch: 1 cost time: 35.5400288105011
Epoch: 1, Steps: 413 | Train Loss: 0.497 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0152074
	speed: 0.2053s/iter; left time: 4134.7298s
	iters: 200, epoch: 2 | loss: 0.0400715
	speed: 0.0747s/iter; left time: 1497.4966s
	iters: 300, epoch: 2 | loss: 0.0008618
	speed: 0.0887s/iter; left time: 1768.0637s
	iters: 400, epoch: 2 | loss: 0.0001396
	speed: 0.0886s/iter; left time: 1758.2222s
Epoch: 2 cost time: 33.43303823471069
Epoch: 2, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.965438 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0340303
	speed: 0.2175s/iter; left time: 4290.8142s
	iters: 200, epoch: 3 | loss: 0.0046621
	speed: 0.0575s/iter; left time: 1127.7772s
	iters: 300, epoch: 3 | loss: 0.0000366
	speed: 0.0689s/iter; left time: 1345.7489s
	iters: 400, epoch: 3 | loss: 0.0036828
	speed: 0.0697s/iter; left time: 1353.1273s
Epoch: 3 cost time: 27.104536771774292
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.972714 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001051
	speed: 0.2009s/iter; left time: 3879.7057s
	iters: 200, epoch: 4 | loss: 0.0001301
	speed: 0.0546s/iter; left time: 1049.7467s
	iters: 300, epoch: 4 | loss: 0.1068783
	speed: 0.0603s/iter; left time: 1152.9008s
	iters: 400, epoch: 4 | loss: 0.0000001
	speed: 0.0732s/iter; left time: 1391.2713s
Epoch: 4 cost time: 25.654057264328003
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.159 Vali Acc: 0.976 Test Loss: 0.159 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.1873s/iter; left time: 3540.1919s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 935.5687s
	iters: 300, epoch: 5 | loss: 0.0002903
	speed: 0.0507s/iter; left time: 947.4684s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1371.4371s
Epoch: 5 cost time: 24.404693603515625
Epoch: 5, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.089 Vali Acc: 0.989 Test Loss: 0.089 Test Acc: 0.989
Validation loss decreased (-0.976807 --> -0.988630).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0110832
	speed: 0.2085s/iter; left time: 3854.6788s
	iters: 200, epoch: 6 | loss: 0.0000274
	speed: 0.0598s/iter; left time: 1100.3676s
	iters: 300, epoch: 6 | loss: 0.0000046
	speed: 0.0793s/iter; left time: 1450.3095s
	iters: 400, epoch: 6 | loss: 0.0000012
	speed: 0.0686s/iter; left time: 1248.4364s
Epoch: 6 cost time: 28.275798082351685
Epoch: 6, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.979 Test Loss: 0.179 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000023
	speed: 0.2405s/iter; left time: 4347.2769s
	iters: 200, epoch: 7 | loss: 0.0596537
	speed: 0.0596s/iter; left time: 1071.1528s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 905.2652s
	iters: 400, epoch: 7 | loss: 0.0000002
	speed: 0.0468s/iter; left time: 831.8348s
Epoch: 7 cost time: 26.352476358413696
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000026
	speed: 0.1893s/iter; left time: 3343.1842s
	iters: 200, epoch: 8 | loss: 0.0003026
	speed: 0.0680s/iter; left time: 1194.5474s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 981.1430s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.0491s/iter; left time: 851.9484s
Epoch: 8 cost time: 25.802186489105225
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.988 Test Loss: 0.119 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.1586s/iter; left time: 2734.5152s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 987.8335s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 687.0808s
	iters: 400, epoch: 9 | loss: 0.0001371
	speed: 0.0478s/iter; left time: 809.6723s
Epoch: 9 cost time: 20.145511150360107
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.982 Test Loss: 0.204 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1330s/iter; left time: 2238.3453s
	iters: 200, epoch: 10 | loss: 0.0103173
	speed: 0.0457s/iter; left time: 765.3173s
	iters: 300, epoch: 10 | loss: 0.2615566
	speed: 0.0637s/iter; left time: 1060.2311s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 863.5154s
Epoch: 10 cost time: 20.847987174987793
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.985 Test Loss: 0.259 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1663s/iter; left time: 2730.5690s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 1089.0923s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 874.0475s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 1174.2199s
Epoch: 11 cost time: 26.35342049598694
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.985 Test Loss: 0.158 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2191s/iter; left time: 3507.2895s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0485s/iter; left time: 771.6092s
	iters: 300, epoch: 12 | loss: 0.0000040
	speed: 0.0455s/iter; left time: 718.7110s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 1076.6292s
Epoch: 12 cost time: 24.368844747543335
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.234 Vali Acc: 0.976 Test Loss: 0.234 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0008266
	speed: 0.1821s/iter; left time: 2840.3100s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 709.1586s
	iters: 300, epoch: 13 | loss: 0.0182091
	speed: 0.0452s/iter; left time: 695.8513s
	iters: 400, epoch: 13 | loss: 0.0000008
	speed: 0.0507s/iter; left time: 775.2534s
Epoch: 13 cost time: 20.69836139678955
Epoch: 13, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.281 Vali Acc: 0.981 Test Loss: 0.281 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0066607
	speed: 0.1886s/iter; left time: 2863.9019s
	iters: 200, epoch: 14 | loss: 0.0000058
	speed: 0.0455s/iter; left time: 686.0938s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 782.9795s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1138.4407s
Epoch: 14 cost time: 24.00404381752014
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.983 Test Loss: 0.208 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1735s/iter; left time: 2562.6617s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 1004.2242s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 1305.4456s
	iters: 400, epoch: 15 | loss: 0.0000003
	speed: 0.0880s/iter; left time: 1273.3895s
Epoch: 15 cost time: 30.59105610847473
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.170 Vali Acc: 0.986 Test Loss: 0.170 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 36852490
model size : 155.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4293332
	speed: 0.0802s/iter; left time: 1647.5929s
	iters: 200, epoch: 1 | loss: 0.6413327
	speed: 0.0589s/iter; left time: 1204.0378s
	iters: 300, epoch: 1 | loss: 0.0520602
	speed: 0.0713s/iter; left time: 1450.7964s
	iters: 400, epoch: 1 | loss: 0.0354284
	speed: 0.0617s/iter; left time: 1249.2606s
Epoch: 1 cost time: 27.973769426345825
Epoch: 1, Steps: 413 | Train Loss: 0.520 Vali Loss: 0.425 Vali Acc: 0.894 Test Loss: 0.425 Test Acc: 0.894
Validation loss decreased (inf --> -0.893584).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1494044
	speed: 0.1649s/iter; left time: 3321.3269s
	iters: 200, epoch: 2 | loss: 0.0001223
	speed: 0.0658s/iter; left time: 1317.5123s
	iters: 300, epoch: 2 | loss: 0.0131090
	speed: 0.0606s/iter; left time: 1207.8278s
	iters: 400, epoch: 2 | loss: 0.0088329
	speed: 0.0489s/iter; left time: 969.8784s
Epoch: 2 cost time: 23.720385789871216
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.893584 --> -0.975442).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0880315
	speed: 0.1772s/iter; left time: 3494.3098s
	iters: 200, epoch: 3 | loss: 0.0869642
	speed: 0.0590s/iter; left time: 1158.3580s
	iters: 300, epoch: 3 | loss: 0.0041067
	speed: 0.0630s/iter; left time: 1230.9385s
	iters: 400, epoch: 3 | loss: 0.0508882
	speed: 0.0457s/iter; left time: 888.4866s
Epoch: 3 cost time: 22.923676013946533
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0041827
	speed: 0.1703s/iter; left time: 3289.0840s
	iters: 200, epoch: 4 | loss: 0.0000062
	speed: 0.0796s/iter; left time: 1529.9207s
	iters: 300, epoch: 4 | loss: 0.0000770
	speed: 0.0816s/iter; left time: 1559.4265s
	iters: 400, epoch: 4 | loss: 0.0002582
	speed: 0.0664s/iter; left time: 1262.7907s
Epoch: 4 cost time: 30.149330139160156
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
Validation loss decreased (-0.975442 --> -0.985902).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0019095
	speed: 0.2223s/iter; left time: 4201.2653s
	iters: 200, epoch: 5 | loss: 0.4207931
	speed: 0.0767s/iter; left time: 1441.4225s
	iters: 300, epoch: 5 | loss: 0.0000038
	speed: 0.0563s/iter; left time: 1052.3237s
	iters: 400, epoch: 5 | loss: 0.0000037
	speed: 0.0582s/iter; left time: 1082.3727s
Epoch: 5 cost time: 28.722495079040527
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000335
	speed: 0.1788s/iter; left time: 3304.9623s
	iters: 200, epoch: 6 | loss: 0.0002492
	speed: 0.0476s/iter; left time: 874.3363s
	iters: 300, epoch: 6 | loss: 0.0010791
	speed: 0.0412s/iter; left time: 752.6432s
	iters: 400, epoch: 6 | loss: 0.0000597
	speed: 0.0416s/iter; left time: 756.7844s
Epoch: 6 cost time: 20.355045318603516
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000014
	speed: 0.1709s/iter; left time: 3088.2425s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 957.8059s
	iters: 300, epoch: 7 | loss: 0.0000010
	speed: 0.0409s/iter; left time: 730.9807s
	iters: 400, epoch: 7 | loss: 0.0007007
	speed: 0.0400s/iter; left time: 711.6025s
Epoch: 7 cost time: 20.09656071662903
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.1549s/iter; left time: 2735.4516s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 997.6977s
	iters: 300, epoch: 8 | loss: 0.0000097
	speed: 0.0565s/iter; left time: 985.8432s
	iters: 400, epoch: 8 | loss: 0.0043343
	speed: 0.0443s/iter; left time: 768.9591s
Epoch: 8 cost time: 22.45080852508545
Epoch: 8, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.233 Vali Acc: 0.977 Test Loss: 0.233 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0004703
	speed: 0.1640s/iter; left time: 2827.6745s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 1249.2027s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0806s/iter; left time: 1374.5034s
	iters: 400, epoch: 9 | loss: 0.0000021
	speed: 0.0673s/iter; left time: 1140.0879s
Epoch: 9 cost time: 29.277099132537842
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.984 Test Loss: 0.121 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0007381
	speed: 0.1832s/iter; left time: 3084.5907s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0841s/iter; left time: 1407.5516s
	iters: 300, epoch: 10 | loss: 0.0006232
	speed: 0.0707s/iter; left time: 1175.3979s
	iters: 400, epoch: 10 | loss: 0.2473219
	speed: 0.0562s/iter; left time: 928.5277s
Epoch: 10 cost time: 29.49734377861023
Epoch: 10, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 3066.5126s
	iters: 200, epoch: 11 | loss: 0.0000004
	speed: 0.0625s/iter; left time: 1019.7763s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 729.0368s
	iters: 400, epoch: 11 | loss: 0.0000003
	speed: 0.0413s/iter; left time: 665.2595s
Epoch: 11 cost time: 23.351149559020996
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.1677s/iter; left time: 2684.2350s
	iters: 200, epoch: 12 | loss: 0.0011206
	speed: 0.0601s/iter; left time: 955.6152s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 810.9302s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 621.1383s
Epoch: 12 cost time: 22.82221484184265
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.987 Test Loss: 0.111 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.987266).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1768s/iter; left time: 2756.4623s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 912.8976s
	iters: 300, epoch: 13 | loss: 0.0000216
	speed: 0.0578s/iter; left time: 890.5628s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 694.8839s
Epoch: 13 cost time: 22.417551279067993
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.981 Test Loss: 0.182 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1503s/iter; left time: 2281.8159s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 1062.4899s
	iters: 300, epoch: 14 | loss: 0.0002551
	speed: 0.0781s/iter; left time: 1169.3461s
	iters: 400, epoch: 14 | loss: 0.0000694
	speed: 0.0759s/iter; left time: 1129.8940s
Epoch: 14 cost time: 28.67498755455017
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1736s/iter; left time: 2564.0173s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 1176.9113s
	iters: 300, epoch: 15 | loss: 0.0224587
	speed: 0.0886s/iter; left time: 1290.4316s
	iters: 400, epoch: 15 | loss: 0.0087370
	speed: 0.0532s/iter; left time: 769.6807s
Epoch: 15 cost time: 28.737178087234497
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.984 Test Loss: 0.131 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1477s/iter; left time: 2120.0721s
	iters: 200, epoch: 16 | loss: 0.0000548
	speed: 0.0472s/iter; left time: 672.5502s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0294s/iter; left time: 415.7941s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 417.1186s
Epoch: 16 cost time: 15.404298782348633
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.325 Vali Acc: 0.978 Test Loss: 0.325 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000173
	speed: 0.1249s/iter; left time: 1741.8133s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0304s/iter; left time: 420.8268s
	iters: 300, epoch: 17 | loss: 0.0000003
	speed: 0.0497s/iter; left time: 683.5891s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 723.9980s
Epoch: 17 cost time: 18.05182933807373
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2278276
	speed: 0.1431s/iter; left time: 1935.6850s
	iters: 200, epoch: 18 | loss: 0.0000015
	speed: 0.0467s/iter; left time: 627.6238s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 803.6562s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 1010.5483s
Epoch: 18 cost time: 24.06646990776062
Epoch: 18, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.985 Test Loss: 0.166 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1698s/iter; left time: 2226.7452s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.0477s/iter; left time: 620.4430s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0909s/iter; left time: 1173.9940s
	iters: 400, epoch: 19 | loss: 0.8985055
	speed: 0.0825s/iter; left time: 1057.3864s
Epoch: 19 cost time: 28.476125478744507
Epoch: 19, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.455 Vali Acc: 0.975 Test Loss: 0.455 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2134s/iter; left time: 2711.0475s
	iters: 200, epoch: 20 | loss: 0.0000007
	speed: 0.0889s/iter; left time: 1120.2823s
	iters: 300, epoch: 20 | loss: 0.0000005
	speed: 0.0751s/iter; left time: 938.7937s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 726.3318s
Epoch: 20 cost time: 31.595080375671387
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.985 Test Loss: 0.191 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2256s/iter; left time: 2772.7856s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 643.3870s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 609.2743s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 556.2711s
Epoch: 21 cost time: 24.55816078186035
Epoch: 21, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.985 Test Loss: 0.215 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1998s/iter; left time: 2372.9068s
	iters: 200, epoch: 22 | loss: 0.0012202
	speed: 0.0619s/iter; left time: 729.3079s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 558.7937s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 557.6519s
Epoch: 22 cost time: 24.66754674911499
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.984 Test Loss: 0.279 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 36751114
model size : 154.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6588765
	speed: 0.0666s/iter; left time: 1369.5246s
	iters: 200, epoch: 1 | loss: 0.1742796
	speed: 0.0413s/iter; left time: 844.0209s
	iters: 300, epoch: 1 | loss: 0.0942301
	speed: 0.0388s/iter; left time: 790.4332s
	iters: 400, epoch: 1 | loss: 0.0065898
	speed: 0.0430s/iter; left time: 869.8404s
Epoch: 1 cost time: 19.785473823547363
Epoch: 1, Steps: 413 | Train Loss: 0.558 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0551100
	speed: 0.1518s/iter; left time: 3057.9067s
	iters: 200, epoch: 2 | loss: 0.0102592
	speed: 0.0448s/iter; left time: 896.9301s
	iters: 300, epoch: 2 | loss: 0.0054319
	speed: 0.0460s/iter; left time: 916.7878s
	iters: 400, epoch: 2 | loss: 0.0032335
	speed: 0.0435s/iter; left time: 862.9036s
Epoch: 2 cost time: 18.35684871673584
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0026170
	speed: 0.1537s/iter; left time: 3032.7118s
	iters: 200, epoch: 3 | loss: 0.0086447
	speed: 0.0407s/iter; left time: 797.7935s
	iters: 300, epoch: 3 | loss: 0.3670181
	speed: 0.0398s/iter; left time: 776.3483s
	iters: 400, epoch: 3 | loss: 0.0579710
	speed: 0.0450s/iter; left time: 874.9201s
Epoch: 3 cost time: 17.885757207870483
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.974533 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002629
	speed: 0.1664s/iter; left time: 3213.3197s
	iters: 200, epoch: 4 | loss: 0.0325343
	speed: 0.0425s/iter; left time: 817.0091s
	iters: 300, epoch: 4 | loss: 0.0609665
	speed: 0.0375s/iter; left time: 716.5626s
	iters: 400, epoch: 4 | loss: 0.0481308
	speed: 0.0396s/iter; left time: 752.5638s
Epoch: 4 cost time: 17.320692777633667
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000056
	speed: 0.1463s/iter; left time: 2764.8471s
	iters: 200, epoch: 5 | loss: 0.0008852
	speed: 0.0394s/iter; left time: 740.0248s
	iters: 300, epoch: 5 | loss: 0.0001053
	speed: 0.0436s/iter; left time: 814.7378s
	iters: 400, epoch: 5 | loss: 0.0000040
	speed: 0.0396s/iter; left time: 736.3406s
Epoch: 5 cost time: 17.559231996536255
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.984538).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0011121
	speed: 0.1860s/iter; left time: 3438.4854s
	iters: 200, epoch: 6 | loss: 0.0016133
	speed: 0.0402s/iter; left time: 738.9014s
	iters: 300, epoch: 6 | loss: 0.0012815
	speed: 0.0427s/iter; left time: 781.5884s
	iters: 400, epoch: 6 | loss: 0.0005132
	speed: 0.0416s/iter; left time: 757.2142s
Epoch: 6 cost time: 17.649970769882202
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0003817
	speed: 0.1377s/iter; left time: 2487.7582s
	iters: 200, epoch: 7 | loss: 0.0035765
	speed: 0.0397s/iter; left time: 713.9328s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0397s/iter; left time: 709.1017s
	iters: 400, epoch: 7 | loss: 0.0044848
	speed: 0.0426s/iter; left time: 756.3921s
Epoch: 7 cost time: 17.17584729194641
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000948
	speed: 0.1372s/iter; left time: 2422.9087s
	iters: 200, epoch: 8 | loss: 0.0103987
	speed: 0.0347s/iter; left time: 609.5919s
	iters: 300, epoch: 8 | loss: 0.1245658
	speed: 0.0403s/iter; left time: 702.9973s
	iters: 400, epoch: 8 | loss: 0.0000054
	speed: 0.0429s/iter; left time: 744.0085s
Epoch: 8 cost time: 16.50735378265381
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.966 Test Loss: 0.217 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3090805
	speed: 0.1597s/iter; left time: 2753.8975s
	iters: 200, epoch: 9 | loss: 0.0017900
	speed: 0.0399s/iter; left time: 684.9302s
	iters: 300, epoch: 9 | loss: 0.0000806
	speed: 0.0386s/iter; left time: 658.4951s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 695.0846s
Epoch: 9 cost time: 17.36091184616089
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.984992).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0297905
	speed: 0.1641s/iter; left time: 2761.6910s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 784.9688s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0409s/iter; left time: 680.0733s
	iters: 400, epoch: 10 | loss: 0.3868983
	speed: 0.0385s/iter; left time: 636.9274s
Epoch: 10 cost time: 18.040335178375244
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.969 Test Loss: 0.221 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000005
	speed: 0.1395s/iter; left time: 2290.2504s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.0456s/iter; left time: 744.7042s
	iters: 300, epoch: 11 | loss: 0.0000094
	speed: 0.0393s/iter; left time: 636.8054s
	iters: 400, epoch: 11 | loss: 0.0000910
	speed: 0.0426s/iter; left time: 686.4054s
Epoch: 11 cost time: 18.230449199676514
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.965 Test Loss: 0.273 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000725
	speed: 0.1305s/iter; left time: 2089.4729s
	iters: 200, epoch: 12 | loss: 0.0003693
	speed: 0.0366s/iter; left time: 582.3865s
	iters: 300, epoch: 12 | loss: 0.0000400
	speed: 0.0414s/iter; left time: 654.6090s
	iters: 400, epoch: 12 | loss: 0.0000021
	speed: 0.0422s/iter; left time: 662.8473s
Epoch: 12 cost time: 17.013696432113647
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.1371s/iter; left time: 2137.4057s
	iters: 200, epoch: 13 | loss: 0.0012599
	speed: 0.0354s/iter; left time: 548.6240s
	iters: 300, epoch: 13 | loss: 0.0002343
	speed: 0.0366s/iter; left time: 563.8945s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 567.4201s
Epoch: 13 cost time: 15.651753902435303
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.982 Test Loss: 0.139 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1435s/iter; left time: 2178.6006s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.0413s/iter; left time: 622.7820s
	iters: 300, epoch: 14 | loss: 0.0000007
	speed: 0.0372s/iter; left time: 556.8333s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0378s/iter; left time: 562.0760s
Epoch: 14 cost time: 16.94630742073059
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1531s/iter; left time: 2260.5775s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 566.3219s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0430s/iter; left time: 625.8879s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 685.1058s
Epoch: 15 cost time: 18.21853542327881
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.985 Test Loss: 0.156 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1281s/iter; left time: 1838.6996s
	iters: 200, epoch: 16 | loss: 0.1729776
	speed: 0.0323s/iter; left time: 461.0107s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 496.2712s
	iters: 400, epoch: 16 | loss: 0.0036389
	speed: 0.0383s/iter; left time: 538.7973s
Epoch: 16 cost time: 14.889927864074707
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000319
	speed: 0.1507s/iter; left time: 2101.4194s
	iters: 200, epoch: 17 | loss: 0.0000077
	speed: 0.0378s/iter; left time: 523.7679s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 515.4173s
	iters: 400, epoch: 17 | loss: 0.0000309
	speed: 0.0385s/iter; left time: 525.6303s
Epoch: 17 cost time: 16.115030527114868
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.266 Vali Acc: 0.978 Test Loss: 0.266 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0004087
	speed: 0.1524s/iter; left time: 2061.5595s
	iters: 200, epoch: 18 | loss: 0.1044497
	speed: 0.0356s/iter; left time: 477.9084s
	iters: 300, epoch: 18 | loss: 0.0000423
	speed: 0.0395s/iter; left time: 526.1106s
	iters: 400, epoch: 18 | loss: 0.0000021
	speed: 0.0367s/iter; left time: 485.4323s
Epoch: 18 cost time: 16.866633653640747
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.982 Test Loss: 0.141 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1450s/iter; left time: 1901.3773s
	iters: 200, epoch: 19 | loss: 0.0000005
	speed: 0.0381s/iter; left time: 495.9319s
	iters: 300, epoch: 19 | loss: 0.0000557
	speed: 0.0425s/iter; left time: 548.9274s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 516.0249s
Epoch: 19 cost time: 17.044113636016846
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 36677386
model size : 154.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5689691
	speed: 0.0758s/iter; left time: 1556.9507s
	iters: 200, epoch: 1 | loss: 1.5660293
	speed: 0.0434s/iter; left time: 887.3352s
	iters: 300, epoch: 1 | loss: 0.1072251
	speed: 0.0715s/iter; left time: 1455.5729s
	iters: 400, epoch: 1 | loss: 0.0967754
	speed: 0.0753s/iter; left time: 1524.2401s
Epoch: 1 cost time: 27.47804045677185
Epoch: 1, Steps: 413 | Train Loss: 0.473 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (inf --> -0.976352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3420487
	speed: 0.2062s/iter; left time: 4153.3445s
	iters: 200, epoch: 2 | loss: 0.0300574
	speed: 0.0867s/iter; left time: 1736.4226s
	iters: 300, epoch: 2 | loss: 0.0474800
	speed: 0.0861s/iter; left time: 1715.9805s
	iters: 400, epoch: 2 | loss: 0.0023065
	speed: 0.0685s/iter; left time: 1359.4679s
Epoch: 2 cost time: 32.7665228843689
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.976352 --> -0.980900).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000542
	speed: 0.2367s/iter; left time: 4669.6782s
	iters: 200, epoch: 3 | loss: 0.0000558
	speed: 0.0770s/iter; left time: 1511.8276s
	iters: 300, epoch: 3 | loss: 0.0006593
	speed: 0.0613s/iter; left time: 1196.8131s
	iters: 400, epoch: 3 | loss: 0.0017802
	speed: 0.0515s/iter; left time: 1000.3731s
Epoch: 3 cost time: 28.53024411201477
Epoch: 3, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.185 Vali Acc: 0.968 Test Loss: 0.185 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0050779
	speed: 0.1930s/iter; left time: 3727.5978s
	iters: 200, epoch: 4 | loss: 0.0002462
	speed: 0.0572s/iter; left time: 1099.0829s
	iters: 300, epoch: 4 | loss: 0.0006279
	speed: 0.0533s/iter; left time: 1017.8334s
	iters: 400, epoch: 4 | loss: 0.0000059
	speed: 0.0532s/iter; left time: 1011.7215s
Epoch: 4 cost time: 23.687292337417603
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0003321
	speed: 0.1588s/iter; left time: 3002.0915s
	iters: 200, epoch: 5 | loss: 0.0002231
	speed: 0.0477s/iter; left time: 895.8100s
	iters: 300, epoch: 5 | loss: 0.0000008
	speed: 0.0476s/iter; left time: 889.9873s
	iters: 400, epoch: 5 | loss: 0.0000177
	speed: 0.0455s/iter; left time: 845.5261s
Epoch: 5 cost time: 20.187658548355103
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.212 Vali Acc: 0.963 Test Loss: 0.212 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001421
	speed: 0.1523s/iter; left time: 2815.1004s
	iters: 200, epoch: 6 | loss: 0.2710265
	speed: 0.0488s/iter; left time: 897.3895s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 742.1837s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0474s/iter; left time: 862.3626s
Epoch: 6 cost time: 20.15759778022766
Epoch: 6, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.270 Vali Acc: 0.972 Test Loss: 0.270 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0003344
	speed: 0.1789s/iter; left time: 3232.5199s
	iters: 200, epoch: 7 | loss: 0.0253631
	speed: 0.0458s/iter; left time: 822.5545s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0364s/iter; left time: 651.0594s
	iters: 400, epoch: 7 | loss: 0.3176792
	speed: 0.0354s/iter; left time: 628.5618s
Epoch: 7 cost time: 18.793787479400635
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000133
	speed: 0.1741s/iter; left time: 3074.7146s
	iters: 200, epoch: 8 | loss: 0.0000135
	speed: 0.0674s/iter; left time: 1182.6684s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0663s/iter; left time: 1157.2800s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.0622s/iter; left time: 1079.7607s
Epoch: 8 cost time: 27.65012001991272
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.171 Vali Acc: 0.978 Test Loss: 0.171 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0004572
	speed: 0.1770s/iter; left time: 3052.7019s
	iters: 200, epoch: 9 | loss: 0.4167558
	speed: 0.0553s/iter; left time: 948.7427s
	iters: 300, epoch: 9 | loss: 0.0001599
	speed: 0.0494s/iter; left time: 841.3059s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 1144.7274s
Epoch: 9 cost time: 23.78010869026184
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2397s/iter; left time: 4034.9272s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0885s/iter; left time: 1481.4462s
	iters: 300, epoch: 10 | loss: 0.0000032
	speed: 0.0757s/iter; left time: 1259.0383s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 1358.5588s
Epoch: 10 cost time: 34.9969916343689
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
Validation loss decreased (-0.980900 --> -0.982718).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0051635
	speed: 0.2450s/iter; left time: 4023.0876s
	iters: 200, epoch: 11 | loss: 1.3640418
	speed: 0.0902s/iter; left time: 1472.2169s
	iters: 300, epoch: 11 | loss: 0.0352631
	speed: 0.0890s/iter; left time: 1444.2848s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 1180.4754s
Epoch: 11 cost time: 34.930638790130615
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.191 Vali Acc: 0.983 Test Loss: 0.191 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2134s/iter; left time: 3415.5640s
	iters: 200, epoch: 12 | loss: 1.1403451
	speed: 0.0678s/iter; left time: 1079.0805s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.0675s/iter; left time: 1067.6824s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 1055.3219s
Epoch: 12 cost time: 28.63796067237854
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.285 Vali Acc: 0.973 Test Loss: 0.285 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2153s/iter; left time: 3357.2366s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 1224.5649s
	iters: 300, epoch: 13 | loss: 0.0000451
	speed: 0.0594s/iter; left time: 915.0379s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 935.4378s
Epoch: 13 cost time: 29.116708040237427
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
Validation loss decreased (-0.982718 --> -0.984992).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000149
	speed: 0.2289s/iter; left time: 3474.5515s
	iters: 200, epoch: 14 | loss: 0.5403779
	speed: 0.0864s/iter; left time: 1303.4740s
	iters: 300, epoch: 14 | loss: 0.0026302
	speed: 0.0882s/iter; left time: 1321.3014s
	iters: 400, epoch: 14 | loss: 0.0000026
	speed: 0.0882s/iter; left time: 1311.9657s
Epoch: 14 cost time: 36.25919008255005
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.235 Vali Acc: 0.980 Test Loss: 0.235 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2341s/iter; left time: 3457.6899s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 1045.7932s
	iters: 300, epoch: 15 | loss: 0.0000049
	speed: 0.0746s/iter; left time: 1086.9363s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0642s/iter; left time: 929.0387s
Epoch: 15 cost time: 30.572259187698364
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.983 Test Loss: 0.251 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000698
	speed: 0.2191s/iter; left time: 3145.2540s
	iters: 200, epoch: 16 | loss: 0.0000129
	speed: 0.0739s/iter; left time: 1052.8611s
	iters: 300, epoch: 16 | loss: 0.0000020
	speed: 0.0785s/iter; left time: 1110.6057s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 871.2378s
Epoch: 16 cost time: 30.187385082244873
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.258 Vali Acc: 0.979 Test Loss: 0.258 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1905s/iter; left time: 2655.6444s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 913.0773s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0800s/iter; left time: 1099.2319s
	iters: 400, epoch: 17 | loss: 0.0291968
	speed: 0.0770s/iter; left time: 1050.5134s
Epoch: 17 cost time: 29.89186930656433
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.983 Test Loss: 0.274 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000025
	speed: 0.2045s/iter; left time: 2766.6205s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 1119.3606s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 991.9538s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 1033.8284s
Epoch: 18 cost time: 31.07783341407776
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.343 Vali Acc: 0.977 Test Loss: 0.343 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.2392s/iter; left time: 3137.1404s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 1169.8370s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 1123.3360s
	iters: 400, epoch: 19 | loss: 0.0000605
	speed: 0.0838s/iter; left time: 1073.8120s
Epoch: 19 cost time: 36.47155952453613
Epoch: 19, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.310 Vali Acc: 0.980 Test Loss: 0.310 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2092s/iter; left time: 2658.1545s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 777.9790s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 773.6352s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 918.2403s
Epoch: 20 cost time: 27.918020963668823
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.988 Test Loss: 0.190 Test Acc: 0.988
Validation loss decreased (-0.984992 --> -0.987720).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2436s/iter; left time: 2993.6849s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 728.0649s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 738.3449s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 731.4844s
Epoch: 21 cost time: 27.27037477493286
Epoch: 21, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.985 Test Loss: 0.214 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2145s/iter; left time: 2548.3758s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 879.0561s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0830s/iter; left time: 969.6892s
	iters: 400, epoch: 22 | loss: 0.6419717
	speed: 0.0915s/iter; left time: 1059.6178s
Epoch: 22 cost time: 34.32883262634277
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.985 Test Loss: 0.201 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2178s/iter; left time: 2496.9325s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 755.6840s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 945.1955s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 928.1128s
Epoch: 23 cost time: 32.64213490486145
Epoch: 23, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.282 Vali Acc: 0.985 Test Loss: 0.282 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2359s/iter; left time: 2606.8829s
	iters: 200, epoch: 24 | loss: 0.0000289
	speed: 0.0754s/iter; left time: 825.5741s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 745.3456s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 703.6203s
Epoch: 24 cost time: 30.628355264663696
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.237 Vali Acc: 0.985 Test Loss: 0.237 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1952s/iter; left time: 2077.1389s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 806.7633s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 797.8354s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 768.9750s
Epoch: 25 cost time: 29.39865732192993
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.439 Vali Acc: 0.980 Test Loss: 0.439 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2102s/iter; left time: 2149.0927s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 681.2452s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 602.7828s
	iters: 400, epoch: 26 | loss: 0.0008626
	speed: 0.0654s/iter; left time: 649.5473s
Epoch: 26 cost time: 26.721315622329712
Epoch: 26, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.394 Vali Acc: 0.985 Test Loss: 0.394 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2297s/iter; left time: 2254.0316s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 887.6453s
	iters: 300, epoch: 27 | loss: 0.1603262
	speed: 0.0876s/iter; left time: 841.7097s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 739.8258s
Epoch: 27 cost time: 36.41887092590332
Epoch: 27, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.986 Test Loss: 0.251 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000042
	speed: 0.2259s/iter; left time: 2123.4418s
	iters: 200, epoch: 28 | loss: 0.0002072
	speed: 0.0735s/iter; left time: 683.8706s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 680.4854s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 710.7682s
Epoch: 28 cost time: 32.23448824882507
Epoch: 28, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.312 Vali Acc: 0.985 Test Loss: 0.312 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2164s/iter; left time: 1945.0376s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 547.9331s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 571.0938s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 505.0266s
Epoch: 29 cost time: 27.065088748931885
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.361 Vali Acc: 0.981 Test Loss: 0.361 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2172s/iter; left time: 1862.0474s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0762s/iter; left time: 645.3100s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 630.0701s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 658.8038s
Epoch: 30 cost time: 32.23004221916199
Epoch: 30, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.285 Vali Acc: 0.990 Test Loss: 0.285 Test Acc: 0.990
Validation loss decreased (-0.987720 --> -0.989538).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.3363669
	speed: 0.2323s/iter; left time: 1895.8529s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 623.5105s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 626.4871s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 701.5537s
Epoch: 31 cost time: 32.83439826965332
Epoch: 31, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.352 Vali Acc: 0.984 Test Loss: 0.352 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2488s/iter; left time: 1927.7311s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 664.3191s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 611.4952s
	iters: 400, epoch: 32 | loss: 0.0000001
	speed: 0.0705s/iter; left time: 524.9279s
Epoch: 32 cost time: 33.8913848400116
Epoch: 32, Steps: 413 | Train Loss: 0.021 Vali Loss: 1.011 Vali Acc: 0.965 Test Loss: 1.011 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2051s/iter; left time: 1504.1125s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 466.0439s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 450.9443s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 438.9138s
Epoch: 33 cost time: 27.462929487228394
Epoch: 33, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.390 Vali Acc: 0.982 Test Loss: 0.390 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1906s/iter; left time: 1319.1641s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 368.0593s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 412.8528s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 383.9723s
Epoch: 34 cost time: 24.843902111053467
Epoch: 34, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.985 Test Loss: 0.442 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2102s/iter; left time: 1368.0912s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 440.7822s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 506.5613s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 485.6616s
Epoch: 35 cost time: 31.276474475860596
Epoch: 35, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.589 Vali Acc: 0.975 Test Loss: 0.589 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2036s/iter; left time: 1240.9279s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0889s/iter; left time: 533.1555s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 511.1943s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 456.3379s
Epoch: 36 cost time: 33.493901014328
Epoch: 36, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.569 Vali Acc: 0.977 Test Loss: 0.569 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2211s/iter; left time: 1256.6353s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 323.2799s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 267.9887s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 310.7741s
Epoch: 37 cost time: 25.705164194107056
Epoch: 37, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.288 Vali Acc: 0.985 Test Loss: 0.288 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2135s/iter; left time: 1125.0896s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 353.9127s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 358.1741s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 384.3942s
Epoch: 38 cost time: 30.273732662200928
Epoch: 38, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.992 Test Loss: 0.247 Test Acc: 0.992
Validation loss decreased (-0.989538 --> -0.991812).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2171s/iter; left time: 1054.6884s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 248.9839s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 346.6316s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 338.1063s
Epoch: 39 cost time: 27.723241806030273
Epoch: 39, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.459 Vali Acc: 0.984 Test Loss: 0.459 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0000002
	speed: 0.2403s/iter; left time: 1068.0613s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 312.8860s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 303.9113s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 261.3112s
Epoch: 40 cost time: 31.525431394577026
Epoch: 40, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.382 Vali Acc: 0.990 Test Loss: 0.382 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2240s/iter; left time: 902.9853s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 317.6794s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0842s/iter; left time: 322.7124s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 311.1320s
Epoch: 41 cost time: 34.577457427978516
Epoch: 41, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.473 Vali Acc: 0.985 Test Loss: 0.473 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1744s/iter; left time: 630.9636s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 247.8062s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 216.1650s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 212.0705s
Epoch: 42 cost time: 26.09884262084961
Epoch: 42, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.330 Vali Acc: 0.990 Test Loss: 0.330 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.2203s/iter; left time: 706.0160s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 218.2234s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 143.4610s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 175.2801s
Epoch: 43 cost time: 27.205647468566895
Epoch: 43, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.489 Vali Acc: 0.983 Test Loss: 0.489 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.1761s/iter; left time: 491.5662s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 157.1658s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 211.1403s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 143.8604s
Epoch: 44 cost time: 25.429913997650146
Epoch: 44, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.406 Vali Acc: 0.989 Test Loss: 0.406 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.1582s/iter; left time: 376.3454s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 121.0440s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 153.0348s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 142.4175s
Epoch: 45 cost time: 25.2065646648407
Epoch: 45, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.988 Test Loss: 0.426 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.2098s/iter; left time: 412.4768s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 85.3469s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 91.2695s
	iters: 400, epoch: 46 | loss: 0.6555045
	speed: 0.0505s/iter; left time: 84.1684s
Epoch: 46 cost time: 23.821470499038696
Epoch: 46, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.502 Vali Acc: 0.988 Test Loss: 0.502 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.1775s/iter; left time: 275.7113s
	iters: 200, epoch: 47 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 69.9268s
	iters: 300, epoch: 47 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 61.9442s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 56.3317s
Epoch: 47 cost time: 19.881295919418335
Epoch: 47, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.677 Vali Acc: 0.982 Test Loss: 0.677 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.0000000
	speed: 0.1548s/iter; left time: 176.4989s
	iters: 200, epoch: 48 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 55.6522s
	iters: 300, epoch: 48 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 45.6810s
	iters: 400, epoch: 48 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 61.8010s
Epoch: 48 cost time: 24.23871111869812
Epoch: 48, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.604 Vali Acc: 0.984 Test Loss: 0.604 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 36882442
model size : 155.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3913517
	speed: 0.0775s/iter; left time: 1591.7470s
	iters: 200, epoch: 1 | loss: 0.3600972
	speed: 0.0545s/iter; left time: 1114.7570s
	iters: 300, epoch: 1 | loss: 0.0351336
	speed: 0.0491s/iter; left time: 999.0528s
	iters: 400, epoch: 1 | loss: 0.0562804
	speed: 0.0548s/iter; left time: 1108.9988s
Epoch: 1 cost time: 24.51886248588562
Epoch: 1, Steps: 413 | Train Loss: 0.519 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1169697
	speed: 0.1843s/iter; left time: 3711.9029s
	iters: 200, epoch: 2 | loss: 0.0358644
	speed: 0.0545s/iter; left time: 1091.7308s
	iters: 300, epoch: 2 | loss: 0.0002401
	speed: 0.0511s/iter; left time: 1017.9536s
	iters: 400, epoch: 2 | loss: 0.0042787
	speed: 0.0530s/iter; left time: 1051.6766s
Epoch: 2 cost time: 21.505393743515015
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.964073 --> -0.974987).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0004966
	speed: 0.1898s/iter; left time: 3742.9038s
	iters: 200, epoch: 3 | loss: 0.0010958
	speed: 0.0506s/iter; left time: 993.5609s
	iters: 300, epoch: 3 | loss: 0.0000947
	speed: 0.0469s/iter; left time: 916.2504s
	iters: 400, epoch: 3 | loss: 0.0047631
	speed: 0.0452s/iter; left time: 878.6976s
Epoch: 3 cost time: 20.215866804122925
Epoch: 3, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
Validation loss decreased (-0.974987 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1742561
	speed: 0.1891s/iter; left time: 3652.1237s
	iters: 200, epoch: 4 | loss: 0.0012595
	speed: 0.0464s/iter; left time: 891.1891s
	iters: 300, epoch: 4 | loss: 0.0006596
	speed: 0.0430s/iter; left time: 821.0998s
	iters: 400, epoch: 4 | loss: 0.0054944
	speed: 0.0504s/iter; left time: 958.7536s
Epoch: 4 cost time: 19.88854169845581
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.980899).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0011411
	speed: 0.1740s/iter; left time: 3287.5822s
	iters: 200, epoch: 5 | loss: 0.0958663
	speed: 0.0490s/iter; left time: 921.2863s
	iters: 300, epoch: 5 | loss: 0.1344815
	speed: 0.0457s/iter; left time: 854.4851s
	iters: 400, epoch: 5 | loss: 0.1864249
	speed: 0.0416s/iter; left time: 774.2988s
Epoch: 5 cost time: 19.519618272781372
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
Validation loss decreased (-0.980899 --> -0.984992).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1930194
	speed: 0.1995s/iter; left time: 3687.6637s
	iters: 200, epoch: 6 | loss: 0.0003305
	speed: 0.0562s/iter; left time: 1032.5581s
	iters: 300, epoch: 6 | loss: 0.0003831
	speed: 0.0555s/iter; left time: 1015.4320s
	iters: 400, epoch: 6 | loss: 0.0000034
	speed: 0.0557s/iter; left time: 1013.7696s
Epoch: 6 cost time: 23.587982892990112
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.984 Test Loss: 0.106 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0504242
	speed: 0.1827s/iter; left time: 3302.2113s
	iters: 200, epoch: 7 | loss: 0.0007647
	speed: 0.0529s/iter; left time: 950.9303s
	iters: 300, epoch: 7 | loss: 0.4770223
	speed: 0.0503s/iter; left time: 899.1360s
	iters: 400, epoch: 7 | loss: 0.0000006
	speed: 0.0556s/iter; left time: 988.2659s
Epoch: 7 cost time: 22.641717433929443
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.060 Vali Acc: 0.990 Test Loss: 0.060 Test Acc: 0.990
Validation loss decreased (-0.984992 --> -0.990450).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000037
	speed: 0.2045s/iter; left time: 3610.8312s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0475s/iter; left time: 834.5364s
	iters: 300, epoch: 8 | loss: 0.3861166
	speed: 0.0446s/iter; left time: 779.0614s
	iters: 400, epoch: 8 | loss: 0.0054560
	speed: 0.0453s/iter; left time: 785.9257s
Epoch: 8 cost time: 19.690370798110962
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000806
	speed: 0.1776s/iter; left time: 3063.3508s
	iters: 200, epoch: 9 | loss: 0.0000205
	speed: 0.0488s/iter; left time: 836.4269s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 832.9025s
	iters: 400, epoch: 9 | loss: 0.1961128
	speed: 0.0492s/iter; left time: 834.2224s
Epoch: 9 cost time: 20.84494376182556
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000011
	speed: 0.1652s/iter; left time: 2780.3452s
	iters: 200, epoch: 10 | loss: 0.0000152
	speed: 0.0486s/iter; left time: 812.4711s
	iters: 300, epoch: 10 | loss: 0.0000005
	speed: 0.0506s/iter; left time: 840.9057s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 831.4199s
Epoch: 10 cost time: 21.350672960281372
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.988 Test Loss: 0.077 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0051624
	speed: 0.1823s/iter; left time: 2993.7215s
	iters: 200, epoch: 11 | loss: 0.0336715
	speed: 0.0455s/iter; left time: 742.5281s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0524s/iter; left time: 850.1299s
	iters: 400, epoch: 11 | loss: 0.0220683
	speed: 0.0528s/iter; left time: 851.0061s
Epoch: 11 cost time: 21.08686661720276
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.982 Test Loss: 0.126 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.1952s/iter; left time: 3125.4379s
	iters: 200, epoch: 12 | loss: 0.0000006
	speed: 0.0553s/iter; left time: 880.0854s
	iters: 300, epoch: 12 | loss: 0.0000739
	speed: 0.0523s/iter; left time: 827.2738s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0504s/iter; left time: 791.0490s
Epoch: 12 cost time: 22.5528507232666
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.981 Test Loss: 0.160 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2130917
	speed: 0.1920s/iter; left time: 2994.7101s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 851.0866s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 797.7645s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 836.7758s
Epoch: 13 cost time: 22.510084867477417
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.979 Test Loss: 0.199 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000105
	speed: 0.1777s/iter; left time: 2698.2562s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 694.5176s
	iters: 300, epoch: 14 | loss: 0.0000018
	speed: 0.0488s/iter; left time: 730.6546s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 688.3980s
Epoch: 14 cost time: 19.847283124923706
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.983 Test Loss: 0.151 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1772s/iter; left time: 2616.5707s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 704.2338s
	iters: 300, epoch: 15 | loss: 0.0010939
	speed: 0.0416s/iter; left time: 605.8229s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 717.4586s
Epoch: 15 cost time: 20.019415140151978
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.976 Test Loss: 0.240 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0001264
	speed: 0.1704s/iter; left time: 2446.0170s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 674.2243s
	iters: 300, epoch: 16 | loss: 0.0007863
	speed: 0.0499s/iter; left time: 706.6956s
	iters: 400, epoch: 16 | loss: 0.0000731
	speed: 0.0501s/iter; left time: 704.3156s
Epoch: 16 cost time: 20.40887451171875
Epoch: 16, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.191 Vali Acc: 0.981 Test Loss: 0.191 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1816s/iter; left time: 2532.0407s
	iters: 200, epoch: 17 | loss: 0.2445838
	speed: 0.0512s/iter; left time: 708.7385s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 734.9804s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0502s/iter; left time: 685.0067s
Epoch: 17 cost time: 22.137043476104736
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.984 Test Loss: 0.137 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 36753418
model size : 154.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9570064
	speed: 0.0696s/iter; left time: 1429.6848s
	iters: 200, epoch: 1 | loss: 0.1360156
	speed: 0.0369s/iter; left time: 754.1644s
	iters: 300, epoch: 1 | loss: 0.0993645
	speed: 0.0368s/iter; left time: 748.0669s
	iters: 400, epoch: 1 | loss: 0.1091033
	speed: 0.0363s/iter; left time: 735.6636s
Epoch: 1 cost time: 18.571870803833008
Epoch: 1, Steps: 413 | Train Loss: 0.578 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (inf --> -0.977716).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0857321
	speed: 0.1414s/iter; left time: 2847.8518s
	iters: 200, epoch: 2 | loss: 0.0265262
	speed: 0.0392s/iter; left time: 786.2016s
	iters: 300, epoch: 2 | loss: 0.0032254
	speed: 0.0366s/iter; left time: 729.4605s
	iters: 400, epoch: 2 | loss: 0.0003068
	speed: 0.0361s/iter; left time: 716.7368s
Epoch: 2 cost time: 16.391737699508667
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.977716 --> -0.981809).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031199
	speed: 0.1305s/iter; left time: 2574.0403s
	iters: 200, epoch: 3 | loss: 0.0004169
	speed: 0.0324s/iter; left time: 636.4409s
	iters: 300, epoch: 3 | loss: 0.0066347
	speed: 0.0340s/iter; left time: 663.4421s
	iters: 400, epoch: 3 | loss: 0.4117806
	speed: 0.0361s/iter; left time: 702.1237s
Epoch: 3 cost time: 14.10352897644043
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0122614
	speed: 0.1242s/iter; left time: 2399.3459s
	iters: 200, epoch: 4 | loss: 0.0013035
	speed: 0.0310s/iter; left time: 596.1425s
	iters: 300, epoch: 4 | loss: 0.0565548
	speed: 0.0317s/iter; left time: 605.7125s
	iters: 400, epoch: 4 | loss: 0.0000532
	speed: 0.0364s/iter; left time: 692.7397s
Epoch: 4 cost time: 14.145018100738525
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0019517
	speed: 0.1239s/iter; left time: 2342.0521s
	iters: 200, epoch: 5 | loss: 0.0022582
	speed: 0.0335s/iter; left time: 630.2258s
	iters: 300, epoch: 5 | loss: 0.0083721
	speed: 0.0380s/iter; left time: 710.1563s
	iters: 400, epoch: 5 | loss: 0.0208104
	speed: 0.0374s/iter; left time: 696.0205s
Epoch: 5 cost time: 15.204417705535889
Epoch: 5, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000190
	speed: 0.1295s/iter; left time: 2394.1113s
	iters: 200, epoch: 6 | loss: 0.0006945
	speed: 0.0377s/iter; left time: 693.6576s
	iters: 300, epoch: 6 | loss: 0.0003528
	speed: 0.0391s/iter; left time: 714.0822s
	iters: 400, epoch: 6 | loss: 0.0771643
	speed: 0.0378s/iter; left time: 687.4988s
Epoch: 6 cost time: 15.57381558418274
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2617665
	speed: 0.1496s/iter; left time: 2703.4410s
	iters: 200, epoch: 7 | loss: 0.0001973
	speed: 0.0409s/iter; left time: 735.9428s
	iters: 300, epoch: 7 | loss: 0.0081808
	speed: 0.0377s/iter; left time: 673.9107s
	iters: 400, epoch: 7 | loss: 0.0001195
	speed: 0.0361s/iter; left time: 642.2424s
Epoch: 7 cost time: 16.2411208152771
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0148701
	speed: 0.1317s/iter; left time: 2325.6040s
	iters: 200, epoch: 8 | loss: 0.0009162
	speed: 0.0346s/iter; left time: 607.9842s
	iters: 300, epoch: 8 | loss: 0.0000976
	speed: 0.0352s/iter; left time: 614.9603s
	iters: 400, epoch: 8 | loss: 0.0000003
	speed: 0.0348s/iter; left time: 603.6107s
Epoch: 8 cost time: 15.126699209213257
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000068
	speed: 0.1601s/iter; left time: 2761.7161s
	iters: 200, epoch: 9 | loss: 0.0000014
	speed: 0.0361s/iter; left time: 619.5822s
	iters: 300, epoch: 9 | loss: 0.0000093
	speed: 0.0387s/iter; left time: 660.3887s
	iters: 400, epoch: 9 | loss: 0.0422307
	speed: 0.0309s/iter; left time: 523.7930s
Epoch: 9 cost time: 15.436201333999634
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000192
	speed: 0.1536s/iter; left time: 2585.5584s
	iters: 200, epoch: 10 | loss: 0.0003334
	speed: 0.0415s/iter; left time: 693.6687s
	iters: 300, epoch: 10 | loss: 0.0000054
	speed: 0.0383s/iter; left time: 636.7209s
	iters: 400, epoch: 10 | loss: 0.0012026
	speed: 0.0367s/iter; left time: 606.1222s
Epoch: 10 cost time: 16.6186261177063
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.978 Test Loss: 0.171 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1385s/iter; left time: 2274.5339s
	iters: 200, epoch: 11 | loss: 0.0000219
	speed: 0.0357s/iter; left time: 582.9157s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0341s/iter; left time: 553.2749s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0383s/iter; left time: 617.2480s
Epoch: 11 cost time: 15.456108570098877
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000048
	speed: 0.1267s/iter; left time: 2027.8750s
	iters: 200, epoch: 12 | loss: 0.0000141
	speed: 0.0383s/iter; left time: 609.2404s
	iters: 300, epoch: 12 | loss: 0.0007140
	speed: 0.0369s/iter; left time: 583.0846s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 548.0595s
Epoch: 12 cost time: 15.619114637374878
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 36698122
model size : 154.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4942132
	speed: 0.0947s/iter; left time: 1945.3009s
	iters: 200, epoch: 1 | loss: 0.0472594
	speed: 0.0625s/iter; left time: 1279.1294s
	iters: 300, epoch: 1 | loss: 0.2270700
	speed: 0.0548s/iter; left time: 1114.6273s
	iters: 400, epoch: 1 | loss: 0.0012709
	speed: 0.0567s/iter; left time: 1148.7160s
Epoch: 1 cost time: 27.806061267852783
Epoch: 1, Steps: 413 | Train Loss: 0.489 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0697213
	speed: 0.1962s/iter; left time: 3951.7389s
	iters: 200, epoch: 2 | loss: 0.0846032
	speed: 0.0528s/iter; left time: 1058.9505s
	iters: 300, epoch: 2 | loss: 0.2140597
	speed: 0.0536s/iter; left time: 1068.9181s
	iters: 400, epoch: 2 | loss: 0.0104489
	speed: 0.0476s/iter; left time: 944.9735s
Epoch: 2 cost time: 22.73684549331665
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.182 Vali Acc: 0.961 Test Loss: 0.182 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0005865
	speed: 0.1891s/iter; left time: 3730.0822s
	iters: 200, epoch: 3 | loss: 0.0000941
	speed: 0.0563s/iter; left time: 1105.7140s
	iters: 300, epoch: 3 | loss: 0.0042526
	speed: 0.0507s/iter; left time: 989.0847s
	iters: 400, epoch: 3 | loss: 0.7106240
	speed: 0.0522s/iter; left time: 1014.8502s
Epoch: 3 cost time: 23.85540461540222
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0001070
	speed: 0.1830s/iter; left time: 3534.6098s
	iters: 200, epoch: 4 | loss: 0.0001088
	speed: 0.0541s/iter; left time: 1039.6465s
	iters: 300, epoch: 4 | loss: 0.0004396
	speed: 0.0495s/iter; left time: 945.3870s
	iters: 400, epoch: 4 | loss: 0.0000003
	speed: 0.0660s/iter; left time: 1255.3014s
Epoch: 4 cost time: 23.562868118286133
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000243
	speed: 0.2025s/iter; left time: 3827.8588s
	iters: 200, epoch: 5 | loss: 0.0636802
	speed: 0.0518s/iter; left time: 973.1069s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 980.0566s
	iters: 400, epoch: 5 | loss: 0.0000916
	speed: 0.0415s/iter; left time: 771.0708s
Epoch: 5 cost time: 22.744377374649048
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.986 Test Loss: 0.108 Test Acc: 0.986
Validation loss decreased (-0.972259 --> -0.985902).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000500
	speed: 0.1981s/iter; left time: 3661.8960s
	iters: 200, epoch: 6 | loss: 0.0024064
	speed: 0.0543s/iter; left time: 998.7418s
	iters: 300, epoch: 6 | loss: 0.0000002
	speed: 0.0553s/iter; left time: 1010.4076s
	iters: 400, epoch: 6 | loss: 0.0000194
	speed: 0.0543s/iter; left time: 987.1529s
Epoch: 6 cost time: 22.596883535385132
Epoch: 6, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.202 Vali Acc: 0.977 Test Loss: 0.202 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000007
	speed: 0.1712s/iter; left time: 3093.9018s
	iters: 200, epoch: 7 | loss: 0.1062656
	speed: 0.0541s/iter; left time: 971.4945s
	iters: 300, epoch: 7 | loss: 0.4347106
	speed: 0.0576s/iter; left time: 1029.9431s
	iters: 400, epoch: 7 | loss: 0.0000004
	speed: 0.0553s/iter; left time: 982.9739s
Epoch: 7 cost time: 22.31110715866089
Epoch: 7, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.258 Vali Acc: 0.970 Test Loss: 0.258 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000573
	speed: 0.1569s/iter; left time: 2771.6446s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 924.9811s
	iters: 300, epoch: 8 | loss: 0.0000216
	speed: 0.0782s/iter; left time: 1365.4624s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 1249.9622s
Epoch: 8 cost time: 26.232962131500244
Epoch: 8, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.983 Test Loss: 0.138 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2035s/iter; left time: 3509.3982s
	iters: 200, epoch: 9 | loss: 0.0000745
	speed: 0.0727s/iter; left time: 1245.9921s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 1194.5468s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 1249.8965s
Epoch: 9 cost time: 29.620567798614502
Epoch: 9, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.979 Test Loss: 0.231 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1941s/iter; left time: 3267.3285s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 953.3528s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 839.4333s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 980.6880s
Epoch: 10 cost time: 24.300354480743408
Epoch: 10, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.358 Vali Acc: 0.973 Test Loss: 0.358 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1860s/iter; left time: 3053.7464s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0541s/iter; left time: 882.4821s
	iters: 300, epoch: 11 | loss: 0.1828569
	speed: 0.0504s/iter; left time: 818.2666s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0483s/iter; left time: 778.6597s
Epoch: 11 cost time: 22.600586891174316
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.333 Vali Acc: 0.973 Test Loss: 0.333 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.1955s/iter; left time: 3129.4386s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 823.8036s
	iters: 300, epoch: 12 | loss: 0.0000024
	speed: 0.0513s/iter; left time: 811.3741s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 811.7678s
Epoch: 12 cost time: 23.360311031341553
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.228 Vali Acc: 0.981 Test Loss: 0.228 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0001074
	speed: 0.1997s/iter; left time: 3115.0494s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 1107.1163s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 975.5671s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0679s/iter; left time: 1038.9912s
Epoch: 13 cost time: 29.440178871154785
Epoch: 13, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.985 Test Loss: 0.164 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6229067
	speed: 0.1878s/iter; left time: 2850.7571s
	iters: 200, epoch: 14 | loss: 0.0000325
	speed: 0.0505s/iter; left time: 761.9080s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 656.1739s
	iters: 400, epoch: 14 | loss: 0.0000318
	speed: 0.0542s/iter; left time: 806.0679s
Epoch: 14 cost time: 21.774672269821167
Epoch: 14, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.985 Test Loss: 0.113 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.1435s/iter; left time: 2118.7102s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 612.4462s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 634.9085s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 616.6473s
Epoch: 15 cost time: 18.53132700920105
Epoch: 15, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 36912394
model size : 155.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7601247
	speed: 0.0745s/iter; left time: 1531.8147s
	iters: 200, epoch: 1 | loss: 0.3179876
	speed: 0.0453s/iter; left time: 925.5317s
	iters: 300, epoch: 1 | loss: 0.1351984
	speed: 0.0420s/iter; left time: 855.4360s
	iters: 400, epoch: 1 | loss: 0.0174770
	speed: 0.0443s/iter; left time: 897.0545s
Epoch: 1 cost time: 21.374732732772827
Epoch: 1, Steps: 413 | Train Loss: 0.508 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3306150
	speed: 0.1702s/iter; left time: 3426.6206s
	iters: 200, epoch: 2 | loss: 0.1728434
	speed: 0.0450s/iter; left time: 901.7796s
	iters: 300, epoch: 2 | loss: 0.0004333
	speed: 0.0528s/iter; left time: 1052.4585s
	iters: 400, epoch: 2 | loss: 0.0410606
	speed: 0.0532s/iter; left time: 1055.6512s
Epoch: 2 cost time: 21.139544010162354
Epoch: 2, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.969531 --> -0.977262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018664
	speed: 0.2024s/iter; left time: 3992.7388s
	iters: 200, epoch: 3 | loss: 0.1872278
	speed: 0.0516s/iter; left time: 1012.7785s
	iters: 300, epoch: 3 | loss: 0.0003986
	speed: 0.0488s/iter; left time: 953.0218s
	iters: 400, epoch: 3 | loss: 0.0000847
	speed: 0.0461s/iter; left time: 894.8332s
Epoch: 3 cost time: 21.16327714920044
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0036282
	speed: 0.1710s/iter; left time: 3302.5400s
	iters: 200, epoch: 4 | loss: 0.0000010
	speed: 0.0483s/iter; left time: 927.0456s
	iters: 300, epoch: 4 | loss: 0.0000046
	speed: 0.0482s/iter; left time: 921.7354s
	iters: 400, epoch: 4 | loss: 0.0000664
	speed: 0.0454s/iter; left time: 862.6017s
Epoch: 4 cost time: 20.270999431610107
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000678
	speed: 0.1631s/iter; left time: 3081.8726s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0483s/iter; left time: 907.5089s
	iters: 300, epoch: 5 | loss: 0.0001943
	speed: 0.0456s/iter; left time: 852.2119s
	iters: 400, epoch: 5 | loss: 0.0000875
	speed: 0.0447s/iter; left time: 831.6294s
Epoch: 5 cost time: 19.121931791305542
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000047
	speed: 0.1570s/iter; left time: 2902.0833s
	iters: 200, epoch: 6 | loss: 0.0000025
	speed: 0.0437s/iter; left time: 802.6943s
	iters: 300, epoch: 6 | loss: 0.0000011
	speed: 0.0358s/iter; left time: 654.0065s
	iters: 400, epoch: 6 | loss: 0.0000012
	speed: 0.0503s/iter; left time: 914.4924s
Epoch: 6 cost time: 18.30070471763611
Epoch: 6, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.965 Test Loss: 0.236 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000125
	speed: 0.1681s/iter; left time: 3038.3858s
	iters: 200, epoch: 7 | loss: 0.0000012
	speed: 0.0453s/iter; left time: 814.4238s
	iters: 300, epoch: 7 | loss: 0.0000009
	speed: 0.0475s/iter; left time: 849.4544s
	iters: 400, epoch: 7 | loss: 0.0009451
	speed: 0.0416s/iter; left time: 738.9032s
Epoch: 7 cost time: 19.161660194396973
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.1670s/iter; left time: 2949.8421s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 883.2514s
	iters: 300, epoch: 8 | loss: 0.0001431
	speed: 0.0457s/iter; left time: 797.0824s
	iters: 400, epoch: 8 | loss: 0.0005305
	speed: 0.0397s/iter; left time: 689.7820s
Epoch: 8 cost time: 19.3890700340271
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.184 Vali Acc: 0.976 Test Loss: 0.184 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1801s/iter; left time: 3106.3395s
	iters: 200, epoch: 9 | loss: 0.0000194
	speed: 0.0539s/iter; left time: 923.8328s
	iters: 300, epoch: 9 | loss: 0.0024881
	speed: 0.0516s/iter; left time: 879.4454s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 880.3933s
Epoch: 9 cost time: 22.334752559661865
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.977 Test Loss: 0.188 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2844498
	speed: 0.1702s/iter; left time: 2865.7126s
	iters: 200, epoch: 10 | loss: 0.0002668
	speed: 0.0469s/iter; left time: 785.1243s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0498s/iter; left time: 828.4132s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 687.1355s
Epoch: 10 cost time: 19.94713544845581
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000013
	speed: 0.1598s/iter; left time: 2624.4063s
	iters: 200, epoch: 11 | loss: 0.4610085
	speed: 0.0459s/iter; left time: 748.6889s
	iters: 300, epoch: 11 | loss: 0.0000643
	speed: 0.0485s/iter; left time: 787.2011s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0486s/iter; left time: 783.2507s
Epoch: 11 cost time: 20.11666750907898
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.048 Vali Acc: 0.989 Test Loss: 0.048 Test Acc: 0.989
Validation loss decreased (-0.977262 --> -0.988631).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0112242
	speed: 0.1655s/iter; left time: 2650.0479s
	iters: 200, epoch: 12 | loss: 0.0000066
	speed: 0.0400s/iter; left time: 636.3201s
	iters: 300, epoch: 12 | loss: 0.0000052
	speed: 0.0427s/iter; left time: 674.8740s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 702.1273s
Epoch: 12 cost time: 17.82104992866516
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.982 Test Loss: 0.144 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1629s/iter; left time: 2541.1358s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 739.2427s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 727.3063s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0465s/iter; left time: 711.2425s
Epoch: 13 cost time: 19.77051854133606
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1642s/iter; left time: 2493.4141s
	iters: 200, epoch: 14 | loss: 0.0000010
	speed: 0.0430s/iter; left time: 648.3858s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.0471s/iter; left time: 705.9030s
	iters: 400, epoch: 14 | loss: 0.0005376
	speed: 0.0491s/iter; left time: 731.4145s
Epoch: 14 cost time: 19.845174074172974
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.980 Test Loss: 0.200 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000010
	speed: 0.1964s/iter; left time: 2899.8958s
	iters: 200, epoch: 15 | loss: 0.0141487
	speed: 0.0529s/iter; left time: 775.4451s
	iters: 300, epoch: 15 | loss: 0.2136191
	speed: 0.0520s/iter; left time: 757.1421s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 771.2591s
Epoch: 15 cost time: 22.430495023727417
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.989 Test Loss: 0.097 Test Acc: 0.989
Validation loss decreased (-0.988631 --> -0.989085).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0048322
	speed: 0.1987s/iter; left time: 2852.4892s
	iters: 200, epoch: 16 | loss: 0.0010989
	speed: 0.0405s/iter; left time: 577.4444s
	iters: 300, epoch: 16 | loss: 0.0000010
	speed: 0.0439s/iter; left time: 620.8237s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 609.6476s
Epoch: 16 cost time: 18.576318979263306
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.986 Test Loss: 0.147 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000049
	speed: 0.1809s/iter; left time: 2521.9034s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0512s/iter; left time: 708.1688s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 560.5690s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 522.5422s
Epoch: 17 cost time: 18.596610069274902
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.985 Test Loss: 0.145 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0007592
	speed: 0.1413s/iter; left time: 1911.8271s
	iters: 200, epoch: 18 | loss: 0.0000029
	speed: 0.0429s/iter; left time: 575.7806s
	iters: 300, epoch: 18 | loss: 0.6645705
	speed: 0.0457s/iter; left time: 609.7452s
	iters: 400, epoch: 18 | loss: 0.0007598
	speed: 0.0422s/iter; left time: 558.8592s
Epoch: 18 cost time: 18.12908387184143
Epoch: 18, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.237 Vali Acc: 0.976 Test Loss: 0.237 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1659s/iter; left time: 2175.8418s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 625.9450s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0481s/iter; left time: 621.9478s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 549.2435s
Epoch: 19 cost time: 19.790736198425293
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.208 Vali Acc: 0.982 Test Loss: 0.208 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000110
	speed: 0.1573s/iter; left time: 1998.3270s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 614.0668s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 621.1207s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 628.8129s
Epoch: 20 cost time: 19.988779544830322
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.978 Test Loss: 0.207 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000104
	speed: 0.1729s/iter; left time: 2125.6061s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 651.0611s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 663.5187s
	iters: 400, epoch: 21 | loss: 0.0003589
	speed: 0.0516s/iter; left time: 618.6030s
Epoch: 21 cost time: 21.886976718902588
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.980 Test Loss: 0.208 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1436s/iter; left time: 1705.1901s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 528.9805s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 523.4838s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 446.0008s
Epoch: 22 cost time: 17.42283606529236
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.984 Test Loss: 0.168 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1584s/iter; left time: 1816.0358s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 535.9971s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 541.8908s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 495.0059s
Epoch: 23 cost time: 19.043883323669434
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.983 Test Loss: 0.199 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1444s/iter; left time: 1596.0322s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 476.4080s
	iters: 300, epoch: 24 | loss: 0.0006915
	speed: 0.0416s/iter; left time: 451.6991s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 344.6379s
Epoch: 24 cost time: 16.430948734283447
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.983 Test Loss: 0.200 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1569s/iter; left time: 1669.1800s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 504.3499s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 467.1218s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 503.5625s
Epoch: 25 cost time: 19.56347417831421
Epoch: 25, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.159 Vali Acc: 0.982 Test Loss: 0.159 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 36783370
model size : 154.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5419628
	speed: 0.0614s/iter; left time: 1262.5285s
	iters: 200, epoch: 1 | loss: 0.0768939
	speed: 0.0398s/iter; left time: 813.9186s
	iters: 300, epoch: 1 | loss: 0.0171779
	speed: 0.0417s/iter; left time: 848.4500s
	iters: 400, epoch: 1 | loss: 0.8388940
	speed: 0.0407s/iter; left time: 823.3410s
Epoch: 1 cost time: 19.000415563583374
Epoch: 1, Steps: 413 | Train Loss: 0.559 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0691455
	speed: 0.1335s/iter; left time: 2688.9711s
	iters: 200, epoch: 2 | loss: 0.0273792
	speed: 0.0362s/iter; left time: 725.3679s
	iters: 300, epoch: 2 | loss: 0.1210188
	speed: 0.0350s/iter; left time: 697.9904s
	iters: 400, epoch: 2 | loss: 0.0159943
	speed: 0.0375s/iter; left time: 744.3699s
Epoch: 2 cost time: 15.300340414047241
Epoch: 2, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.956797 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012396
	speed: 0.1504s/iter; left time: 2966.9047s
	iters: 200, epoch: 3 | loss: 0.0017318
	speed: 0.0364s/iter; left time: 713.7966s
	iters: 300, epoch: 3 | loss: 0.0009279
	speed: 0.0374s/iter; left time: 730.4100s
	iters: 400, epoch: 3 | loss: 0.0026469
	speed: 0.0418s/iter; left time: 811.0699s
Epoch: 3 cost time: 16.209807634353638
Epoch: 3, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.973169 --> -0.983174).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000681
	speed: 0.1526s/iter; left time: 2946.3245s
	iters: 200, epoch: 4 | loss: 0.0006201
	speed: 0.0329s/iter; left time: 632.1643s
	iters: 300, epoch: 4 | loss: 0.0471308
	speed: 0.0365s/iter; left time: 697.1878s
	iters: 400, epoch: 4 | loss: 0.0033579
	speed: 0.0369s/iter; left time: 701.2957s
Epoch: 4 cost time: 14.942228555679321
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0008603
	speed: 0.1323s/iter; left time: 2499.5872s
	iters: 200, epoch: 5 | loss: 0.0000241
	speed: 0.0356s/iter; left time: 668.4035s
	iters: 300, epoch: 5 | loss: 0.0002142
	speed: 0.0367s/iter; left time: 687.0892s
	iters: 400, epoch: 5 | loss: 0.0057139
	speed: 0.0367s/iter; left time: 683.1951s
Epoch: 5 cost time: 15.364949703216553
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7939906
	speed: 0.1377s/iter; left time: 2544.8347s
	iters: 200, epoch: 6 | loss: 0.0012394
	speed: 0.0339s/iter; left time: 622.6424s
	iters: 300, epoch: 6 | loss: 0.0000857
	speed: 0.0352s/iter; left time: 643.5566s
	iters: 400, epoch: 6 | loss: 0.0000792
	speed: 0.0346s/iter; left time: 628.6675s
Epoch: 6 cost time: 15.103080749511719
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0003008
	speed: 0.1356s/iter; left time: 2450.4323s
	iters: 200, epoch: 7 | loss: 0.0001905
	speed: 0.0374s/iter; left time: 673.0352s
	iters: 300, epoch: 7 | loss: 0.0002608
	speed: 0.0384s/iter; left time: 686.2950s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0382s/iter; left time: 679.0914s
Epoch: 7 cost time: 16.13275909423828
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000018
	speed: 0.1401s/iter; left time: 2474.9842s
	iters: 200, epoch: 8 | loss: 0.0090902
	speed: 0.0397s/iter; left time: 697.7618s
	iters: 300, epoch: 8 | loss: 0.0000004
	speed: 0.0394s/iter; left time: 688.1320s
	iters: 400, epoch: 8 | loss: 0.0001783
	speed: 0.0400s/iter; left time: 693.7552s
Epoch: 8 cost time: 16.919766187667847
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0694985
	speed: 0.1262s/iter; left time: 2177.0931s
	iters: 200, epoch: 9 | loss: 0.0000115
	speed: 0.0349s/iter; left time: 597.8972s
	iters: 300, epoch: 9 | loss: 0.0000571
	speed: 0.0350s/iter; left time: 596.5900s
	iters: 400, epoch: 9 | loss: 0.0000761
	speed: 0.0342s/iter; left time: 579.8014s
Epoch: 9 cost time: 15.011399745941162
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.962 Test Loss: 0.257 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0035162
	speed: 0.1309s/iter; left time: 2203.0595s
	iters: 200, epoch: 10 | loss: 0.0000075
	speed: 0.0345s/iter; left time: 576.7309s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 615.0739s
	iters: 400, epoch: 10 | loss: 0.0000153
	speed: 0.0371s/iter; left time: 613.5290s
Epoch: 10 cost time: 15.467507362365723
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000010
	speed: 0.1294s/iter; left time: 2124.8183s
	iters: 200, epoch: 11 | loss: 0.0000125
	speed: 0.0338s/iter; left time: 552.2075s
	iters: 300, epoch: 11 | loss: 0.0001248
	speed: 0.0314s/iter; left time: 509.1246s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0328s/iter; left time: 528.9779s
Epoch: 11 cost time: 14.212460041046143
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.978 Test Loss: 0.201 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.1337s/iter; left time: 2139.6470s
	iters: 200, epoch: 12 | loss: 0.0255730
	speed: 0.0337s/iter; left time: 536.5826s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 544.5066s
	iters: 400, epoch: 12 | loss: 0.0001258
	speed: 0.0334s/iter; left time: 525.2867s
Epoch: 12 cost time: 14.521973133087158
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.224 Vali Acc: 0.973 Test Loss: 0.224 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0381481
	speed: 0.1260s/iter; left time: 1965.5949s
	iters: 200, epoch: 13 | loss: 0.0008864
	speed: 0.0343s/iter; left time: 532.1944s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0333s/iter; left time: 512.0086s
	iters: 400, epoch: 13 | loss: 0.0000233
	speed: 0.0353s/iter; left time: 540.1074s
Epoch: 13 cost time: 14.733854293823242
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.979 Test Loss: 0.189 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 36718858
model size : 154.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0763548
	speed: 0.1070s/iter; left time: 2199.8576s
	iters: 200, epoch: 1 | loss: 0.1665468
	speed: 0.0820s/iter; left time: 1677.9548s
	iters: 300, epoch: 1 | loss: 0.5244330
	speed: 0.0625s/iter; left time: 1272.7876s
	iters: 400, epoch: 1 | loss: 0.0100333
	speed: 0.0564s/iter; left time: 1142.7152s
Epoch: 1 cost time: 31.77183198928833
Epoch: 1, Steps: 413 | Train Loss: 0.494 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0292098
	speed: 0.1761s/iter; left time: 3546.8567s
	iters: 200, epoch: 2 | loss: 0.0328397
	speed: 0.0333s/iter; left time: 668.0174s
	iters: 300, epoch: 2 | loss: 0.0044520
	speed: 0.0614s/iter; left time: 1223.4925s
	iters: 400, epoch: 2 | loss: 0.0006545
	speed: 0.0629s/iter; left time: 1247.5847s
Epoch: 2 cost time: 22.497997283935547
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.968621 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0147573
	speed: 0.2122s/iter; left time: 4186.4030s
	iters: 200, epoch: 3 | loss: 0.0023318
	speed: 0.0499s/iter; left time: 978.7450s
	iters: 300, epoch: 3 | loss: 0.0044217
	speed: 0.0426s/iter; left time: 831.1912s
	iters: 400, epoch: 3 | loss: 0.0000449
	speed: 0.0565s/iter; left time: 1096.5804s
Epoch: 3 cost time: 20.839982748031616
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.973169 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0153745
	speed: 0.1886s/iter; left time: 3641.3974s
	iters: 200, epoch: 4 | loss: 0.1039048
	speed: 0.0641s/iter; left time: 1232.2724s
	iters: 300, epoch: 4 | loss: 0.0003949
	speed: 0.0799s/iter; left time: 1527.6872s
	iters: 400, epoch: 4 | loss: 0.1937596
	speed: 0.0779s/iter; left time: 1481.1455s
Epoch: 4 cost time: 29.11740279197693
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002357
	speed: 0.2139s/iter; left time: 4042.6203s
	iters: 200, epoch: 5 | loss: 0.0005924
	speed: 0.0781s/iter; left time: 1468.5090s
	iters: 300, epoch: 5 | loss: 0.3205218
	speed: 0.0926s/iter; left time: 1731.4618s
	iters: 400, epoch: 5 | loss: 0.0133587
	speed: 0.0881s/iter; left time: 1638.3366s
Epoch: 5 cost time: 35.17479848861694
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2131368
	speed: 0.2265s/iter; left time: 4186.5897s
	iters: 200, epoch: 6 | loss: 0.0898400
	speed: 0.0810s/iter; left time: 1490.0093s
	iters: 300, epoch: 6 | loss: 0.2118100
	speed: 0.0697s/iter; left time: 1274.9138s
	iters: 400, epoch: 6 | loss: 0.0001080
	speed: 0.0571s/iter; left time: 1037.9172s
Epoch: 6 cost time: 29.908019065856934
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0006130
	speed: 0.1780s/iter; left time: 3216.5148s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 1456.3865s
	iters: 300, epoch: 7 | loss: 0.0045768
	speed: 0.0800s/iter; left time: 1430.2489s
	iters: 400, epoch: 7 | loss: 0.0000003
	speed: 0.0719s/iter; left time: 1278.0827s
Epoch: 7 cost time: 31.360103130340576
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.986 Test Loss: 0.110 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.986356).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2317917
	speed: 0.2046s/iter; left time: 3613.6515s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 1223.8528s
	iters: 300, epoch: 8 | loss: 0.0000019
	speed: 0.0672s/iter; left time: 1173.9928s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 1189.3361s
Epoch: 8 cost time: 27.64336133003235
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.052 Vali Acc: 0.990 Test Loss: 0.052 Test Acc: 0.990
Validation loss decreased (-0.986356 --> -0.989995).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0001280
	speed: 0.2469s/iter; left time: 4257.8222s
	iters: 200, epoch: 9 | loss: 0.1397062
	speed: 0.0847s/iter; left time: 1452.0664s
	iters: 300, epoch: 9 | loss: 0.0000410
	speed: 0.0681s/iter; left time: 1160.6746s
	iters: 400, epoch: 9 | loss: 0.0000020
	speed: 0.0632s/iter; left time: 1070.4344s
Epoch: 9 cost time: 31.55998420715332
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1893869
	speed: 0.2192s/iter; left time: 3689.4715s
	iters: 200, epoch: 10 | loss: 0.0000227
	speed: 0.0925s/iter; left time: 1547.8612s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 1475.5121s
	iters: 400, epoch: 10 | loss: 0.0000320
	speed: 0.0810s/iter; left time: 1338.9937s
Epoch: 10 cost time: 35.965723752975464
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000003
	speed: 0.2010s/iter; left time: 3300.9080s
	iters: 200, epoch: 11 | loss: 0.0000493
	speed: 0.0669s/iter; left time: 1092.5521s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0594s/iter; left time: 963.6456s
	iters: 400, epoch: 11 | loss: 0.7924719
	speed: 0.0567s/iter; left time: 913.3920s
Epoch: 11 cost time: 27.026715993881226
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.152 Vali Acc: 0.983 Test Loss: 0.152 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0439610
	speed: 0.2094s/iter; left time: 3352.5643s
	iters: 200, epoch: 12 | loss: 0.0000071
	speed: 0.0801s/iter; left time: 1274.7786s
	iters: 300, epoch: 12 | loss: 0.0000457
	speed: 0.0646s/iter; left time: 1021.1705s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 1030.9764s
Epoch: 12 cost time: 30.39785099029541
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.091 Vali Acc: 0.989 Test Loss: 0.091 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0003461
	speed: 0.1931s/iter; left time: 3011.0517s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0753s/iter; left time: 1167.1683s
	iters: 300, epoch: 13 | loss: 0.0000478
	speed: 0.0841s/iter; left time: 1293.9951s
	iters: 400, epoch: 13 | loss: 0.0033696
	speed: 0.0813s/iter; left time: 1242.9009s
Epoch: 13 cost time: 32.28219938278198
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.409 Vali Acc: 0.973 Test Loss: 0.409 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000063
	speed: 0.2304s/iter; left time: 3498.3354s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 1177.6987s
	iters: 300, epoch: 14 | loss: 0.0057452
	speed: 0.0707s/iter; left time: 1059.3931s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 1080.0015s
Epoch: 14 cost time: 32.09754681587219
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.2182s/iter; left time: 3222.8135s
	iters: 200, epoch: 15 | loss: 0.0000031
	speed: 0.0764s/iter; left time: 1120.0490s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0723s/iter; left time: 1052.8183s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 1027.5591s
Epoch: 15 cost time: 31.417865991592407
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.984 Test Loss: 0.130 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1983s/iter; left time: 2846.1215s
	iters: 200, epoch: 16 | loss: 0.0000338
	speed: 0.0614s/iter; left time: 874.6678s
	iters: 300, epoch: 16 | loss: 0.0001659
	speed: 0.0591s/iter; left time: 836.3632s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 1040.9493s
Epoch: 16 cost time: 27.611446857452393
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.335 Vali Acc: 0.970 Test Loss: 0.335 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2230s/iter; left time: 3109.2170s
	iters: 200, epoch: 17 | loss: 0.1086942
	speed: 0.0665s/iter; left time: 920.0315s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 725.1114s
	iters: 400, epoch: 17 | loss: 0.3725342
	speed: 0.0682s/iter; left time: 930.3445s
Epoch: 17 cost time: 28.30706214904785
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.974 Test Loss: 0.301 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0585285
	speed: 0.2260s/iter; left time: 3057.2025s
	iters: 200, epoch: 18 | loss: 0.0040460
	speed: 0.0845s/iter; left time: 1134.7303s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 1156.1579s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0874s/iter; left time: 1156.5277s
Epoch: 18 cost time: 35.65696978569031
Epoch: 18, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 36898570
model size : 155.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5597131
	speed: 0.0755s/iter; left time: 1550.5950s
	iters: 200, epoch: 1 | loss: 0.2509646
	speed: 0.0499s/iter; left time: 1019.7817s
	iters: 300, epoch: 1 | loss: 0.2161569
	speed: 0.0485s/iter; left time: 986.4859s
	iters: 400, epoch: 1 | loss: 0.4309325
	speed: 0.0486s/iter; left time: 984.8741s
Epoch: 1 cost time: 22.975820779800415
Epoch: 1, Steps: 413 | Train Loss: 0.532 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0305367
	speed: 0.1720s/iter; left time: 3464.1929s
	iters: 200, epoch: 2 | loss: 0.0154951
	speed: 0.0493s/iter; left time: 988.7443s
	iters: 300, epoch: 2 | loss: 0.0010675
	speed: 0.0478s/iter; left time: 953.4032s
	iters: 400, epoch: 2 | loss: 0.0007275
	speed: 0.0447s/iter; left time: 886.1714s
Epoch: 2 cost time: 19.538254976272583
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.957252 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1382304
	speed: 0.1938s/iter; left time: 3823.6477s
	iters: 200, epoch: 3 | loss: 0.0008975
	speed: 0.0485s/iter; left time: 951.5607s
	iters: 300, epoch: 3 | loss: 0.0000809
	speed: 0.0496s/iter; left time: 968.9485s
	iters: 400, epoch: 3 | loss: 0.0072521
	speed: 0.0543s/iter; left time: 1055.3270s
Epoch: 3 cost time: 21.53479504585266
Epoch: 3, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.966802 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0036192
	speed: 0.1967s/iter; left time: 3798.3761s
	iters: 200, epoch: 4 | loss: 0.0004098
	speed: 0.0558s/iter; left time: 1071.4145s
	iters: 300, epoch: 4 | loss: 0.0046672
	speed: 0.0524s/iter; left time: 1000.9279s
	iters: 400, epoch: 4 | loss: 0.0937260
	speed: 0.0508s/iter; left time: 965.7136s
Epoch: 4 cost time: 22.291496753692627
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000019
	speed: 0.1952s/iter; left time: 3688.9877s
	iters: 200, epoch: 5 | loss: 0.0000996
	speed: 0.0573s/iter; left time: 1076.8742s
	iters: 300, epoch: 5 | loss: 0.0000669
	speed: 0.0570s/iter; left time: 1065.0078s
	iters: 400, epoch: 5 | loss: 0.0014360
	speed: 0.0573s/iter; left time: 1065.3163s
Epoch: 5 cost time: 23.939128875732422
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0010032
	speed: 0.1606s/iter; left time: 2969.4483s
	iters: 200, epoch: 6 | loss: 0.0072969
	speed: 0.0418s/iter; left time: 768.9793s
	iters: 300, epoch: 6 | loss: 0.0002552
	speed: 0.0502s/iter; left time: 917.1367s
	iters: 400, epoch: 6 | loss: 0.0000086
	speed: 0.0406s/iter; left time: 737.8769s
Epoch: 6 cost time: 18.583930015563965
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001003
	speed: 0.1439s/iter; left time: 2601.0338s
	iters: 200, epoch: 7 | loss: 0.0001048
	speed: 0.0383s/iter; left time: 689.0694s
	iters: 300, epoch: 7 | loss: 0.0000945
	speed: 0.0383s/iter; left time: 683.8142s
	iters: 400, epoch: 7 | loss: 0.1098818
	speed: 0.0358s/iter; left time: 636.7431s
Epoch: 7 cost time: 15.885011672973633
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0011602
	speed: 0.1453s/iter; left time: 2566.4703s
	iters: 200, epoch: 8 | loss: 0.1119156
	speed: 0.0421s/iter; left time: 738.8598s
	iters: 300, epoch: 8 | loss: 0.0005898
	speed: 0.0409s/iter; left time: 713.6606s
	iters: 400, epoch: 8 | loss: 0.0115493
	speed: 0.0390s/iter; left time: 676.7323s
Epoch: 8 cost time: 17.208313941955566
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.302 Vali Acc: 0.963 Test Loss: 0.302 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6179073
	speed: 0.1633s/iter; left time: 2816.7852s
	iters: 200, epoch: 9 | loss: 0.0046725
	speed: 0.0485s/iter; left time: 831.4764s
	iters: 300, epoch: 9 | loss: 0.0000033
	speed: 0.0511s/iter; left time: 870.4088s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 834.3085s
Epoch: 9 cost time: 20.659934520721436
Epoch: 9, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.982 Test Loss: 0.133 Test Acc: 0.982
Validation loss decreased (-0.976807 --> -0.982263).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000104
	speed: 0.1676s/iter; left time: 2822.1681s
	iters: 200, epoch: 10 | loss: 0.0000016
	speed: 0.0493s/iter; left time: 825.4687s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 815.5926s
	iters: 400, epoch: 10 | loss: 0.0000066
	speed: 0.0478s/iter; left time: 791.0511s
Epoch: 10 cost time: 19.902978658676147
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000222
	speed: 0.1843s/iter; left time: 3026.5905s
	iters: 200, epoch: 11 | loss: 0.0000054
	speed: 0.0468s/iter; left time: 763.3605s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0504s/iter; left time: 817.6501s
	iters: 400, epoch: 11 | loss: 0.0000339
	speed: 0.0495s/iter; left time: 797.5435s
Epoch: 11 cost time: 20.75516390800476
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1557s/iter; left time: 2492.2752s
	iters: 200, epoch: 12 | loss: 0.0000035
	speed: 0.0417s/iter; left time: 662.8904s
	iters: 300, epoch: 12 | loss: 0.0002562
	speed: 0.0367s/iter; left time: 580.3597s
	iters: 400, epoch: 12 | loss: 0.0140966
	speed: 0.0336s/iter; left time: 527.8145s
Epoch: 12 cost time: 16.220013856887817
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000031
	speed: 0.1508s/iter; left time: 2352.2984s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0305s/iter; left time: 471.9600s
	iters: 300, epoch: 13 | loss: 0.0572460
	speed: 0.0329s/iter; left time: 506.3010s
	iters: 400, epoch: 13 | loss: 0.0000010
	speed: 0.0294s/iter; left time: 449.1827s
Epoch: 13 cost time: 13.896610021591187
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0228410
	speed: 0.1227s/iter; left time: 1862.7618s
	iters: 200, epoch: 14 | loss: 0.0001485
	speed: 0.0309s/iter; left time: 466.1263s
	iters: 300, epoch: 14 | loss: 0.0684724
	speed: 0.0318s/iter; left time: 476.4499s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0345s/iter; left time: 513.6934s
Epoch: 14 cost time: 13.6829354763031
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.983 Test Loss: 0.143 Test Acc: 0.983
Validation loss decreased (-0.982263 --> -0.983173).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1420s/iter; left time: 2096.9779s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 526.8269s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 552.6328s
	iters: 400, epoch: 15 | loss: 0.1522761
	speed: 0.0398s/iter; left time: 575.6617s
Epoch: 15 cost time: 15.620876550674438
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.257 Vali Acc: 0.973 Test Loss: 0.257 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1672s/iter; left time: 2400.4159s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0407s/iter; left time: 580.8800s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 632.7921s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 538.7275s
Epoch: 16 cost time: 18.276880025863647
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.328 Vali Acc: 0.970 Test Loss: 0.328 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1651s/iter; left time: 2301.4113s
	iters: 200, epoch: 17 | loss: 0.0000010
	speed: 0.0467s/iter; left time: 647.0358s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 636.3677s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0473s/iter; left time: 645.9421s
Epoch: 17 cost time: 19.96793842315674
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.970 Test Loss: 0.329 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.1576s/iter; left time: 2132.0986s
	iters: 200, epoch: 18 | loss: 0.0011561
	speed: 0.0400s/iter; left time: 537.6736s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 543.3784s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 408.7986s
Epoch: 18 cost time: 16.016510248184204
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.974 Test Loss: 0.221 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1537s/iter; left time: 2015.8815s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 562.4170s
	iters: 300, epoch: 19 | loss: 0.0003813
	speed: 0.0431s/iter; left time: 556.1489s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 474.2878s
Epoch: 19 cost time: 17.538543701171875
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.973 Test Loss: 0.238 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1410s/iter; left time: 1791.6056s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 522.7792s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 529.3976s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 533.8101s
Epoch: 20 cost time: 17.302887439727783
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.248 Vali Acc: 0.979 Test Loss: 0.248 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000011
	speed: 0.1531s/iter; left time: 1882.2211s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0394s/iter; left time: 479.7993s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 456.2977s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 437.4084s
Epoch: 21 cost time: 16.441317319869995
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.981 Test Loss: 0.185 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000455
	speed: 0.1476s/iter; left time: 1752.9333s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 553.1296s
	iters: 300, epoch: 22 | loss: 0.3160332
	speed: 0.0455s/iter; left time: 531.7175s
	iters: 400, epoch: 22 | loss: 0.0000047
	speed: 0.0410s/iter; left time: 474.1871s
Epoch: 22 cost time: 18.913381576538086
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.976 Test Loss: 0.221 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1466s/iter; left time: 1681.3165s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 359.1986s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 420.7160s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 408.4892s
Epoch: 23 cost time: 15.177221059799194
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.979 Test Loss: 0.275 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1447s/iter; left time: 1599.1416s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 382.4919s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 385.2690s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 383.1080s
Epoch: 24 cost time: 15.079111337661743
Epoch: 24, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.980 Test Loss: 0.197 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 36824842
model size : 155.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9249243
	speed: 0.0640s/iter; left time: 1314.9575s
	iters: 200, epoch: 1 | loss: 0.1035613
	speed: 0.0411s/iter; left time: 839.7546s
	iters: 300, epoch: 1 | loss: 0.1312843
	speed: 0.0393s/iter; left time: 799.3142s
	iters: 400, epoch: 1 | loss: 0.0076666
	speed: 0.0402s/iter; left time: 814.0680s
Epoch: 1 cost time: 19.146456718444824
Epoch: 1, Steps: 413 | Train Loss: 0.588 Vali Loss: 0.091 Vali Acc: 0.969 Test Loss: 0.091 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0051468
	speed: 0.1428s/iter; left time: 2876.3356s
	iters: 200, epoch: 2 | loss: 0.0292457
	speed: 0.0378s/iter; left time: 757.4743s
	iters: 300, epoch: 2 | loss: 0.0322364
	speed: 0.0373s/iter; left time: 744.6245s
	iters: 400, epoch: 2 | loss: 0.2161858
	speed: 0.0358s/iter; left time: 710.8463s
Epoch: 2 cost time: 15.638560771942139
Epoch: 2, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0114237
	speed: 0.1350s/iter; left time: 2662.4209s
	iters: 200, epoch: 3 | loss: 0.3227401
	speed: 0.0374s/iter; left time: 733.9262s
	iters: 300, epoch: 3 | loss: 0.0007979
	speed: 0.0367s/iter; left time: 717.3676s
	iters: 400, epoch: 3 | loss: 0.0070144
	speed: 0.0367s/iter; left time: 712.9993s
Epoch: 3 cost time: 15.647520542144775
Epoch: 3, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0626356
	speed: 0.1343s/iter; left time: 2593.5927s
	iters: 200, epoch: 4 | loss: 0.0003358
	speed: 0.0357s/iter; left time: 686.0319s
	iters: 300, epoch: 4 | loss: 0.0240168
	speed: 0.0357s/iter; left time: 681.3590s
	iters: 400, epoch: 4 | loss: 0.0026759
	speed: 0.0355s/iter; left time: 674.9601s
Epoch: 4 cost time: 15.18008041381836
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
Validation loss decreased (-0.969076 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0020411
	speed: 0.1562s/iter; left time: 2952.6073s
	iters: 200, epoch: 5 | loss: 0.1586360
	speed: 0.0365s/iter; left time: 686.4027s
	iters: 300, epoch: 5 | loss: 0.0007493
	speed: 0.0358s/iter; left time: 669.3239s
	iters: 400, epoch: 5 | loss: 0.0000379
	speed: 0.0363s/iter; left time: 675.1582s
Epoch: 5 cost time: 15.729352951049805
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.972259 --> -0.979081).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0009522
	speed: 0.1500s/iter; left time: 2772.4449s
	iters: 200, epoch: 6 | loss: 0.0000321
	speed: 0.0402s/iter; left time: 739.1478s
	iters: 300, epoch: 6 | loss: 0.1465021
	speed: 0.0395s/iter; left time: 722.4519s
	iters: 400, epoch: 6 | loss: 0.0062321
	speed: 0.0399s/iter; left time: 725.8426s
Epoch: 6 cost time: 16.822068691253662
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0061910
	speed: 0.1416s/iter; left time: 2559.2220s
	iters: 200, epoch: 7 | loss: 0.0002083
	speed: 0.0386s/iter; left time: 694.0983s
	iters: 300, epoch: 7 | loss: 0.0012538
	speed: 0.0406s/iter; left time: 726.4934s
	iters: 400, epoch: 7 | loss: 0.0056264
	speed: 0.0390s/iter; left time: 693.1119s
Epoch: 7 cost time: 16.91201424598694
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.984 Test Loss: 0.092 Test Acc: 0.984
Validation loss decreased (-0.979081 --> -0.984083).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000056
	speed: 0.1493s/iter; left time: 2637.1671s
	iters: 200, epoch: 8 | loss: 0.0042634
	speed: 0.0402s/iter; left time: 705.1974s
	iters: 300, epoch: 8 | loss: 0.0024304
	speed: 0.0402s/iter; left time: 702.3594s
	iters: 400, epoch: 8 | loss: 0.0000150
	speed: 0.0383s/iter; left time: 664.0695s
Epoch: 8 cost time: 16.893153190612793
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0384757
	speed: 0.1323s/iter; left time: 2281.6153s
	iters: 200, epoch: 9 | loss: 0.0216252
	speed: 0.0368s/iter; left time: 630.6940s
	iters: 300, epoch: 9 | loss: 0.0000120
	speed: 0.0356s/iter; left time: 606.8308s
	iters: 400, epoch: 9 | loss: 0.0005480
	speed: 0.0371s/iter; left time: 628.2497s
Epoch: 9 cost time: 15.547546625137329
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0672486
	speed: 0.1347s/iter; left time: 2267.8382s
	iters: 200, epoch: 10 | loss: 0.0000492
	speed: 0.0298s/iter; left time: 498.0957s
	iters: 300, epoch: 10 | loss: 0.0000090
	speed: 0.0323s/iter; left time: 537.5593s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.0285s/iter; left time: 470.9624s
Epoch: 10 cost time: 13.406102180480957
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0043581
	speed: 0.1177s/iter; left time: 1933.0749s
	iters: 200, epoch: 11 | loss: 0.0000082
	speed: 0.0313s/iter; left time: 510.9020s
	iters: 300, epoch: 11 | loss: 0.0000007
	speed: 0.0309s/iter; left time: 500.9865s
	iters: 400, epoch: 11 | loss: 0.0000136
	speed: 0.0304s/iter; left time: 489.3076s
Epoch: 11 cost time: 13.23132848739624
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000089
	speed: 0.1187s/iter; left time: 1899.4007s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 583.4620s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.0350s/iter; left time: 552.9908s
	iters: 400, epoch: 12 | loss: 0.0969739
	speed: 0.0365s/iter; left time: 573.3780s
Epoch: 12 cost time: 15.408040523529053
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.252 Vali Acc: 0.966 Test Loss: 0.252 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0004313
	speed: 0.1278s/iter; left time: 1992.3772s
	iters: 200, epoch: 13 | loss: 0.0000026
	speed: 0.0329s/iter; left time: 509.6389s
	iters: 300, epoch: 13 | loss: 0.0000018
	speed: 0.0296s/iter; left time: 456.3848s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 480.5224s
Epoch: 13 cost time: 13.505831480026245
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000006
	speed: 0.1257s/iter; left time: 1909.0563s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 490.1940s
	iters: 300, epoch: 14 | loss: 0.0000472
	speed: 0.0317s/iter; left time: 475.4349s
	iters: 400, epoch: 14 | loss: 0.0000005
	speed: 0.0294s/iter; left time: 437.6454s
Epoch: 14 cost time: 13.709488153457642
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000024
	speed: 0.1209s/iter; left time: 1786.2806s
	iters: 200, epoch: 15 | loss: 0.0000632
	speed: 0.0425s/iter; left time: 624.1012s
	iters: 300, epoch: 15 | loss: 0.0000039
	speed: 0.0410s/iter; left time: 597.0638s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 565.0366s
Epoch: 15 cost time: 17.499545335769653
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.1197s/iter; left time: 1717.7718s
	iters: 200, epoch: 16 | loss: 0.0028565
	speed: 0.0354s/iter; left time: 504.1170s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 458.7778s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 507.6058s
Epoch: 16 cost time: 14.675453662872314
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.970 Test Loss: 0.239 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7330112
	speed: 0.1191s/iter; left time: 1660.3475s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 473.7327s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 438.8976s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 448.4654s
Epoch: 17 cost time: 13.715061902999878
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 36769546
model size : 154.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2355924
	speed: 0.0838s/iter; left time: 1722.9378s
	iters: 200, epoch: 1 | loss: 0.1026967
	speed: 0.0749s/iter; left time: 1532.3471s
	iters: 300, epoch: 1 | loss: 0.0084369
	speed: 0.0524s/iter; left time: 1066.0349s
	iters: 400, epoch: 1 | loss: 0.1023772
	speed: 0.0599s/iter; left time: 1212.2859s
Epoch: 1 cost time: 27.927048921585083
Epoch: 1, Steps: 413 | Train Loss: 0.478 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0002579
	speed: 0.2042s/iter; left time: 4112.8591s
	iters: 200, epoch: 2 | loss: 0.0008912
	speed: 0.0710s/iter; left time: 1422.4583s
	iters: 300, epoch: 2 | loss: 0.0591667
	speed: 0.0649s/iter; left time: 1293.1824s
	iters: 400, epoch: 2 | loss: 0.0672200
	speed: 0.0667s/iter; left time: 1322.8024s
Epoch: 2 cost time: 29.340822219848633
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.967257 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0039594
	speed: 0.2283s/iter; left time: 4503.5430s
	iters: 200, epoch: 3 | loss: 0.0046898
	speed: 0.0531s/iter; left time: 1042.3734s
	iters: 300, epoch: 3 | loss: 0.0003591
	speed: 0.0478s/iter; left time: 932.9268s
	iters: 400, epoch: 3 | loss: 0.0646870
	speed: 0.0439s/iter; left time: 852.6557s
Epoch: 3 cost time: 24.11599564552307
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.970895 --> -0.972713).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004818
	speed: 0.2129s/iter; left time: 4111.3730s
	iters: 200, epoch: 4 | loss: 0.0003045
	speed: 0.0520s/iter; left time: 999.4278s
	iters: 300, epoch: 4 | loss: 0.0002379
	speed: 0.0532s/iter; left time: 1017.3184s
	iters: 400, epoch: 4 | loss: 0.0059812
	speed: 0.0506s/iter; left time: 962.1835s
Epoch: 4 cost time: 22.98550319671631
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.972713 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0140351
	speed: 0.1920s/iter; left time: 3628.5543s
	iters: 200, epoch: 5 | loss: 0.0000106
	speed: 0.0529s/iter; left time: 994.5171s
	iters: 300, epoch: 5 | loss: 0.0000021
	speed: 0.0455s/iter; left time: 850.3912s
	iters: 400, epoch: 5 | loss: 0.5488537
	speed: 0.0427s/iter; left time: 794.7101s
Epoch: 5 cost time: 21.151956796646118
Epoch: 5, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
Validation loss decreased (-0.974533 --> -0.979080).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000003
	speed: 0.2050s/iter; left time: 3790.3564s
	iters: 200, epoch: 6 | loss: 0.5523853
	speed: 0.0597s/iter; left time: 1096.7865s
	iters: 300, epoch: 6 | loss: 0.0000002
	speed: 0.0601s/iter; left time: 1098.4054s
	iters: 400, epoch: 6 | loss: 0.1657752
	speed: 0.0678s/iter; left time: 1233.2513s
Epoch: 6 cost time: 27.279104948043823
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0005742
	speed: 0.2143s/iter; left time: 3873.4853s
	iters: 200, epoch: 7 | loss: 0.4986352
	speed: 0.0662s/iter; left time: 1190.6231s
	iters: 300, epoch: 7 | loss: 0.0000023
	speed: 0.0563s/iter; left time: 1006.4420s
	iters: 400, epoch: 7 | loss: 0.0006719
	speed: 0.0594s/iter; left time: 1056.2724s
Epoch: 7 cost time: 27.36702823638916
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.979080 --> -0.983173).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000028
	speed: 0.1709s/iter; left time: 3017.7060s
	iters: 200, epoch: 8 | loss: 0.0019448
	speed: 0.0363s/iter; left time: 636.5752s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 652.7612s
	iters: 400, epoch: 8 | loss: 0.0000671
	speed: 0.0341s/iter; left time: 592.1769s
Epoch: 8 cost time: 15.616400241851807
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001106
	speed: 0.1362s/iter; left time: 2348.5383s
	iters: 200, epoch: 9 | loss: 0.0110838
	speed: 0.0359s/iter; left time: 615.2507s
	iters: 300, epoch: 9 | loss: 0.0000073
	speed: 0.0352s/iter; left time: 600.6237s
	iters: 400, epoch: 9 | loss: 0.0000661
	speed: 0.0384s/iter; left time: 650.3489s
Epoch: 9 cost time: 15.616204261779785
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1328s/iter; left time: 2235.4215s
	iters: 200, epoch: 10 | loss: 0.0001072
	speed: 0.0362s/iter; left time: 605.8682s
	iters: 300, epoch: 10 | loss: 0.0245324
	speed: 0.0391s/iter; left time: 650.2818s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.0552s/iter; left time: 913.0406s
Epoch: 10 cost time: 17.968395709991455
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.219 Vali Acc: 0.979 Test Loss: 0.219 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0006955
	speed: 0.1843s/iter; left time: 3026.6069s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 860.9964s
	iters: 300, epoch: 11 | loss: 0.0000036
	speed: 0.0566s/iter; left time: 917.9582s
	iters: 400, epoch: 11 | loss: 0.0000267
	speed: 0.0660s/iter; left time: 1063.7498s
Epoch: 11 cost time: 23.8907573223114
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.115 Vali Acc: 0.987 Test Loss: 0.115 Test Acc: 0.987
Validation loss decreased (-0.983173 --> -0.986811).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2268s/iter; left time: 3629.9140s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.0756s/iter; left time: 1202.0527s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 1101.0459s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 1086.0410s
Epoch: 12 cost time: 30.431764841079712
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.981 Test Loss: 0.223 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2127s/iter; left time: 3317.6634s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 1004.6983s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0625s/iter; left time: 961.7369s
	iters: 400, epoch: 13 | loss: 0.0100986
	speed: 0.0504s/iter; left time: 770.4459s
Epoch: 13 cost time: 27.44984745979309
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.314 Vali Acc: 0.970 Test Loss: 0.314 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000054
	speed: 0.1537s/iter; left time: 2332.7562s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0600s/iter; left time: 905.5309s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 1106.9537s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 825.2832s
Epoch: 14 cost time: 24.0102276802063
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.976 Test Loss: 0.273 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000008
	speed: 0.1727s/iter; left time: 2550.5535s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 829.8200s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.0366s/iter; left time: 533.3165s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 722.3674s
Epoch: 15 cost time: 20.76845407485962
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.252 Vali Acc: 0.978 Test Loss: 0.252 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1721s/iter; left time: 2470.9822s
	iters: 200, epoch: 16 | loss: 0.0000137
	speed: 0.0491s/iter; left time: 699.7748s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 696.0508s
	iters: 400, epoch: 16 | loss: 0.1481282
	speed: 0.0590s/iter; left time: 829.4994s
Epoch: 16 cost time: 21.483437299728394
Epoch: 16, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.166 Vali Acc: 0.989 Test Loss: 0.166 Test Acc: 0.989
Validation loss decreased (-0.986811 --> -0.988630).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2216s/iter; left time: 3089.4781s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0849s/iter; left time: 1175.7671s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 1019.6431s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0642s/iter; left time: 875.7777s
Epoch: 17 cost time: 32.644047260284424
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.084 Vali Acc: 0.990 Test Loss: 0.084 Test Acc: 0.990
Validation loss decreased (-0.988630 --> -0.989995).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2245s/iter; left time: 3037.4837s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 907.4975s
	iters: 300, epoch: 18 | loss: 0.0001052
	speed: 0.0582s/iter; left time: 775.6564s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 667.2614s
Epoch: 18 cost time: 26.120855569839478
Epoch: 18, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1769s/iter; left time: 2320.1706s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 933.1657s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 823.2546s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 829.0875s
Epoch: 19 cost time: 27.748480319976807
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.304 Vali Acc: 0.980 Test Loss: 0.304 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0035162
	speed: 0.1839s/iter; left time: 2336.1569s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0659s/iter; left time: 830.2014s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0659s/iter; left time: 823.9422s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 850.8044s
Epoch: 20 cost time: 28.17418122291565
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.982 Test Loss: 0.187 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2038s/iter; left time: 2504.5760s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0838s/iter; left time: 1021.7345s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 860.7837s
	iters: 400, epoch: 21 | loss: 0.0000015
	speed: 0.0816s/iter; left time: 978.2543s
Epoch: 21 cost time: 33.26442909240723
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.300 Vali Acc: 0.974 Test Loss: 0.300 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2289s/iter; left time: 2719.3273s
	iters: 200, epoch: 22 | loss: 0.0000007
	speed: 0.0776s/iter; left time: 914.1312s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 888.4899s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 858.6032s
Epoch: 22 cost time: 32.29309940338135
Epoch: 22, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2037s/iter; left time: 2335.5224s
	iters: 200, epoch: 23 | loss: 0.0000014
	speed: 0.0481s/iter; left time: 546.5296s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 611.7179s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 566.2454s
Epoch: 23 cost time: 23.79615831375122
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.989 Test Loss: 0.139 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1888s/iter; left time: 2086.1803s
	iters: 200, epoch: 24 | loss: 0.8554826
	speed: 0.0729s/iter; left time: 798.0137s
	iters: 300, epoch: 24 | loss: 0.0000006
	speed: 0.0646s/iter; left time: 700.5109s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 626.6310s
Epoch: 24 cost time: 28.03015971183777
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.246 Vali Acc: 0.981 Test Loss: 0.246 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1935s/iter; left time: 2058.7006s
	iters: 200, epoch: 25 | loss: 0.0011141
	speed: 0.0664s/iter; left time: 699.2862s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 837.2657s
	iters: 400, epoch: 25 | loss: 0.6845734
	speed: 0.0829s/iter; left time: 857.0835s
Epoch: 25 cost time: 31.39081907272339
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.990 Test Loss: 0.085 Test Acc: 0.990
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2155s/iter; left time: 2203.2993s
	iters: 200, epoch: 26 | loss: 0.0006988
	speed: 0.0712s/iter; left time: 721.1960s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 837.1815s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 774.0914s
Epoch: 26 cost time: 32.245062589645386
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.984 Test Loss: 0.190 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.2088s/iter; left time: 2049.1532s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 495.7154s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 525.8452s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 564.0219s
Epoch: 27 cost time: 23.96377468109131
Epoch: 27, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.982 Test Loss: 0.205 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 36958474
model size : 155.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2525433
	speed: 0.0699s/iter; left time: 1436.2899s
	iters: 200, epoch: 1 | loss: 0.0574614
	speed: 0.0455s/iter; left time: 929.5637s
	iters: 300, epoch: 1 | loss: 0.0672338
	speed: 0.0460s/iter; left time: 936.5215s
	iters: 400, epoch: 1 | loss: 0.0271523
	speed: 0.0434s/iter; left time: 878.9037s
Epoch: 1 cost time: 21.084765195846558
Epoch: 1, Steps: 413 | Train Loss: 0.515 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0121849
	speed: 0.1701s/iter; left time: 3425.2430s
	iters: 200, epoch: 2 | loss: 0.0076269
	speed: 0.0486s/iter; left time: 973.5246s
	iters: 300, epoch: 2 | loss: 0.1483285
	speed: 0.0525s/iter; left time: 1045.9312s
	iters: 400, epoch: 2 | loss: 0.0232041
	speed: 0.0536s/iter; left time: 1062.5235s
Epoch: 2 cost time: 21.628843545913696
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.055 Vali Acc: 0.981 Test Loss: 0.055 Test Acc: 0.981
Validation loss decreased (-0.969531 --> -0.981355).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0007953
	speed: 0.1948s/iter; left time: 3842.5479s
	iters: 200, epoch: 3 | loss: 0.0029718
	speed: 0.0505s/iter; left time: 990.3465s
	iters: 300, epoch: 3 | loss: 0.0213464
	speed: 0.0514s/iter; left time: 1003.1634s
	iters: 400, epoch: 3 | loss: 0.0034074
	speed: 0.0491s/iter; left time: 953.0157s
Epoch: 3 cost time: 21.411652326583862
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0061526
	speed: 0.1787s/iter; left time: 3451.5577s
	iters: 200, epoch: 4 | loss: 0.0045507
	speed: 0.0516s/iter; left time: 990.7202s
	iters: 300, epoch: 4 | loss: 0.0015087
	speed: 0.0482s/iter; left time: 921.7646s
	iters: 400, epoch: 4 | loss: 0.0035901
	speed: 0.0469s/iter; left time: 891.2812s
Epoch: 4 cost time: 21.320898294448853
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0001384
	speed: 0.1748s/iter; left time: 3303.7377s
	iters: 200, epoch: 5 | loss: 0.0000143
	speed: 0.0445s/iter; left time: 837.3199s
	iters: 300, epoch: 5 | loss: 0.0057399
	speed: 0.0472s/iter; left time: 882.3543s
	iters: 400, epoch: 5 | loss: 0.0002348
	speed: 0.0482s/iter; left time: 896.7175s
Epoch: 5 cost time: 20.12439513206482
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.981355 --> -0.983628).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000828
	speed: 0.2052s/iter; left time: 3793.7929s
	iters: 200, epoch: 6 | loss: 0.0037647
	speed: 0.0405s/iter; left time: 743.8543s
	iters: 300, epoch: 6 | loss: 0.0001485
	speed: 0.0453s/iter; left time: 828.1063s
	iters: 400, epoch: 6 | loss: 0.0000060
	speed: 0.0441s/iter; left time: 802.3404s
Epoch: 6 cost time: 18.63182544708252
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000016
	speed: 0.1885s/iter; left time: 3407.3131s
	iters: 200, epoch: 7 | loss: 0.0000116
	speed: 0.0517s/iter; left time: 929.5875s
	iters: 300, epoch: 7 | loss: 0.0000011
	speed: 0.0512s/iter; left time: 914.2874s
	iters: 400, epoch: 7 | loss: 0.1337034
	speed: 0.0547s/iter; left time: 972.4901s
Epoch: 7 cost time: 21.502612352371216
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3289916
	speed: 0.1909s/iter; left time: 3371.7935s
	iters: 200, epoch: 8 | loss: 0.0000006
	speed: 0.0529s/iter; left time: 929.1183s
	iters: 300, epoch: 8 | loss: 0.0000498
	speed: 0.0544s/iter; left time: 950.0496s
	iters: 400, epoch: 8 | loss: 0.0000127
	speed: 0.0537s/iter; left time: 932.1311s
Epoch: 8 cost time: 22.837280988693237
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.176 Vali Acc: 0.978 Test Loss: 0.176 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0284257
	speed: 0.1813s/iter; left time: 3127.5366s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 886.6677s
	iters: 300, epoch: 9 | loss: 0.0004724
	speed: 0.0429s/iter; left time: 731.9720s
	iters: 400, epoch: 9 | loss: 0.0000381
	speed: 0.0450s/iter; left time: 762.1623s
Epoch: 9 cost time: 19.91719627380371
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1694s/iter; left time: 2852.1168s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0464s/iter; left time: 777.2548s
	iters: 300, epoch: 10 | loss: 0.0000383
	speed: 0.0452s/iter; left time: 752.2659s
	iters: 400, epoch: 10 | loss: 0.0000119
	speed: 0.0421s/iter; left time: 696.2544s
Epoch: 10 cost time: 19.2578182220459
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0057704
	speed: 0.1642s/iter; left time: 2696.1487s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0490s/iter; left time: 800.5011s
	iters: 300, epoch: 11 | loss: 0.0000050
	speed: 0.0443s/iter; left time: 718.1153s
	iters: 400, epoch: 11 | loss: 0.2518057
	speed: 0.0475s/iter; left time: 765.9768s
Epoch: 11 cost time: 20.229379415512085
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1687s/iter; left time: 2700.9770s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0506s/iter; left time: 805.2867s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 672.3233s
	iters: 400, epoch: 12 | loss: 0.0009029
	speed: 0.0537s/iter; left time: 844.2370s
Epoch: 12 cost time: 20.342384576797485
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0243197
	speed: 0.1585s/iter; left time: 2471.1742s
	iters: 200, epoch: 13 | loss: 0.0000004
	speed: 0.0416s/iter; left time: 644.5161s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 645.3875s
	iters: 400, epoch: 13 | loss: 0.0007692
	speed: 0.0412s/iter; left time: 630.8843s
Epoch: 13 cost time: 18.007922649383545
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.257 Vali Acc: 0.972 Test Loss: 0.257 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1443s/iter; left time: 2191.2647s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 624.6656s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 563.4088s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 606.0203s
Epoch: 14 cost time: 17.1216983795166
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0005671
	speed: 0.1504s/iter; left time: 2221.7349s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 621.3836s
	iters: 300, epoch: 15 | loss: 0.0043251
	speed: 0.0442s/iter; left time: 643.4207s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0422s/iter; left time: 610.2375s
Epoch: 15 cost time: 18.41244387626648
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.968 Test Loss: 0.248 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 36866314
model size : 155.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7226035
	speed: 0.0577s/iter; left time: 1185.6092s
	iters: 200, epoch: 1 | loss: 0.4005968
	speed: 0.0348s/iter; left time: 712.3223s
	iters: 300, epoch: 1 | loss: 0.1080591
	speed: 0.0340s/iter; left time: 692.0178s
	iters: 400, epoch: 1 | loss: 0.0441498
	speed: 0.0364s/iter; left time: 736.8787s
Epoch: 1 cost time: 16.925535678863525
Epoch: 1, Steps: 413 | Train Loss: 0.575 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0379847
	speed: 0.1302s/iter; left time: 2622.0371s
	iters: 200, epoch: 2 | loss: 0.0395189
	speed: 0.0356s/iter; left time: 713.2821s
	iters: 300, epoch: 2 | loss: 0.0107907
	speed: 0.0339s/iter; left time: 675.7336s
	iters: 400, epoch: 2 | loss: 0.1581095
	speed: 0.0381s/iter; left time: 756.3511s
Epoch: 2 cost time: 14.727562665939331
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.967712 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0037974
	speed: 0.1466s/iter; left time: 2892.2333s
	iters: 200, epoch: 3 | loss: 0.0064281
	speed: 0.0359s/iter; left time: 703.8948s
	iters: 300, epoch: 3 | loss: 0.0004886
	speed: 0.0396s/iter; left time: 772.8291s
	iters: 400, epoch: 3 | loss: 0.0007588
	speed: 0.0386s/iter; left time: 750.6596s
Epoch: 3 cost time: 16.13130259513855
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000414
	speed: 0.1412s/iter; left time: 2727.0368s
	iters: 200, epoch: 4 | loss: 0.0535175
	speed: 0.0392s/iter; left time: 753.4963s
	iters: 300, epoch: 4 | loss: 0.0180980
	speed: 0.0400s/iter; left time: 765.3351s
	iters: 400, epoch: 4 | loss: 0.0789211
	speed: 0.0402s/iter; left time: 764.8309s
Epoch: 4 cost time: 16.7709321975708
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1269683
	speed: 0.1259s/iter; left time: 2378.7210s
	iters: 200, epoch: 5 | loss: 0.0102937
	speed: 0.0388s/iter; left time: 729.1453s
	iters: 300, epoch: 5 | loss: 0.0003442
	speed: 0.0345s/iter; left time: 645.9226s
	iters: 400, epoch: 5 | loss: 0.0010656
	speed: 0.0358s/iter; left time: 665.0098s
Epoch: 5 cost time: 15.527719020843506
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001914
	speed: 0.1221s/iter; left time: 2258.0347s
	iters: 200, epoch: 6 | loss: 0.0003012
	speed: 0.0363s/iter; left time: 666.9455s
	iters: 300, epoch: 6 | loss: 0.0093980
	speed: 0.0362s/iter; left time: 661.1956s
	iters: 400, epoch: 6 | loss: 0.0056844
	speed: 0.0352s/iter; left time: 639.3644s
Epoch: 6 cost time: 15.167874574661255
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.961 Test Loss: 0.213 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0003354
	speed: 0.1298s/iter; left time: 2346.6269s
	iters: 200, epoch: 7 | loss: 0.0070565
	speed: 0.0360s/iter; left time: 647.4112s
	iters: 300, epoch: 7 | loss: 0.1546986
	speed: 0.0336s/iter; left time: 601.2251s
	iters: 400, epoch: 7 | loss: 0.0000051
	speed: 0.0339s/iter; left time: 602.7179s
Epoch: 7 cost time: 14.788098812103271
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000178
	speed: 0.1267s/iter; left time: 2237.4574s
	iters: 200, epoch: 8 | loss: 0.0003065
	speed: 0.0356s/iter; left time: 624.3573s
	iters: 300, epoch: 8 | loss: 0.0012249
	speed: 0.0354s/iter; left time: 618.0899s
	iters: 400, epoch: 8 | loss: 0.0028097
	speed: 0.0352s/iter; left time: 611.1797s
Epoch: 8 cost time: 15.093185901641846
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0019364
	speed: 0.1264s/iter; left time: 2180.6261s
	iters: 200, epoch: 9 | loss: 0.0000758
	speed: 0.0365s/iter; left time: 625.2256s
	iters: 300, epoch: 9 | loss: 0.0000777
	speed: 0.0299s/iter; left time: 509.6895s
	iters: 400, epoch: 9 | loss: 0.0071861
	speed: 0.0413s/iter; left time: 699.6073s
Epoch: 9 cost time: 15.232871770858765
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000986
	speed: 0.1214s/iter; left time: 2044.2639s
	iters: 200, epoch: 10 | loss: 0.0000005
	speed: 0.0309s/iter; left time: 516.6825s
	iters: 300, epoch: 10 | loss: 0.5311697
	speed: 0.0282s/iter; left time: 468.9481s
	iters: 400, epoch: 10 | loss: 0.0029124
	speed: 0.0314s/iter; left time: 519.0444s
Epoch: 10 cost time: 13.096039772033691
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0190898
	speed: 0.1298s/iter; left time: 2130.7319s
	iters: 200, epoch: 11 | loss: 0.0009568
	speed: 0.0343s/iter; left time: 560.3781s
	iters: 300, epoch: 11 | loss: 0.0000079
	speed: 0.0372s/iter; left time: 603.1084s
	iters: 400, epoch: 11 | loss: 0.0000042
	speed: 0.0364s/iter; left time: 586.2057s
Epoch: 11 cost time: 15.528203964233398
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0001480
	speed: 0.1350s/iter; left time: 2161.3212s
	iters: 200, epoch: 12 | loss: 0.0000436
	speed: 0.0374s/iter; left time: 595.5464s
	iters: 300, epoch: 12 | loss: 0.0000017
	speed: 0.0387s/iter; left time: 611.6046s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0398s/iter; left time: 624.4084s
Epoch: 12 cost time: 16.34774374961853
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000017
	speed: 0.1187s/iter; left time: 1850.4445s
	iters: 200, epoch: 13 | loss: 0.0000009
	speed: 0.0356s/iter; left time: 552.3126s
	iters: 300, epoch: 13 | loss: 0.0000005
	speed: 0.0354s/iter; left time: 545.2460s
	iters: 400, epoch: 13 | loss: 0.0000015
	speed: 0.0352s/iter; left time: 539.1195s
Epoch: 13 cost time: 14.16893982887268
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 36820234
model size : 155.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3303214
	speed: 0.0679s/iter; left time: 1395.2721s
	iters: 200, epoch: 1 | loss: 0.5955676
	speed: 0.0430s/iter; left time: 880.0258s
	iters: 300, epoch: 1 | loss: 0.0546170
	speed: 0.0389s/iter; left time: 792.3420s
	iters: 400, epoch: 1 | loss: 0.0052211
	speed: 0.0396s/iter; left time: 801.4126s
Epoch: 1 cost time: 19.67180061340332
Epoch: 1, Steps: 413 | Train Loss: 0.483 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (inf --> -0.950430).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2396862
	speed: 0.1553s/iter; left time: 3127.3653s
	iters: 200, epoch: 2 | loss: 0.0461139
	speed: 0.0414s/iter; left time: 829.2488s
	iters: 300, epoch: 2 | loss: 0.2885366
	speed: 0.0471s/iter; left time: 939.3785s
	iters: 400, epoch: 2 | loss: 0.1325520
	speed: 0.0538s/iter; left time: 1067.9839s
Epoch: 2 cost time: 19.173298835754395
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
Validation loss decreased (-0.950430 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0148463
	speed: 0.1864s/iter; left time: 3676.7650s
	iters: 200, epoch: 3 | loss: 0.0002377
	speed: 0.0443s/iter; left time: 870.2257s
	iters: 300, epoch: 3 | loss: 0.1487757
	speed: 0.0471s/iter; left time: 919.9371s
	iters: 400, epoch: 3 | loss: 0.0312214
	speed: 0.0503s/iter; left time: 977.9766s
Epoch: 3 cost time: 19.70819592475891
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0001845
	speed: 0.1637s/iter; left time: 3160.7946s
	iters: 200, epoch: 4 | loss: 0.0022660
	speed: 0.0491s/iter; left time: 943.5769s
	iters: 300, epoch: 4 | loss: 0.0004821
	speed: 0.0443s/iter; left time: 847.0230s
	iters: 400, epoch: 4 | loss: 0.0135996
	speed: 0.0522s/iter; left time: 991.5666s
Epoch: 4 cost time: 20.338504791259766
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974532).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000163
	speed: 0.1577s/iter; left time: 2980.5757s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0427s/iter; left time: 803.5163s
	iters: 300, epoch: 5 | loss: 0.0038729
	speed: 0.0441s/iter; left time: 824.6755s
	iters: 400, epoch: 5 | loss: 0.0000005
	speed: 0.0485s/iter; left time: 902.5004s
Epoch: 5 cost time: 18.44583010673523
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002404
	speed: 0.1488s/iter; left time: 2750.2052s
	iters: 200, epoch: 6 | loss: 0.0000031
	speed: 0.0411s/iter; left time: 756.5516s
	iters: 300, epoch: 6 | loss: 0.0002192
	speed: 0.0404s/iter; left time: 738.5978s
	iters: 400, epoch: 6 | loss: 0.3758154
	speed: 0.0445s/iter; left time: 809.8520s
Epoch: 6 cost time: 17.60715889930725
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0003493
	speed: 0.1556s/iter; left time: 2812.7043s
	iters: 200, epoch: 7 | loss: 0.0000335
	speed: 0.0420s/iter; left time: 754.5099s
	iters: 300, epoch: 7 | loss: 0.0000025
	speed: 0.0420s/iter; left time: 750.8311s
	iters: 400, epoch: 7 | loss: 0.0038129
	speed: 0.0462s/iter; left time: 820.7707s
Epoch: 7 cost time: 18.293498039245605
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.167 Vali Acc: 0.984 Test Loss: 0.167 Test Acc: 0.984
Validation loss decreased (-0.974532 --> -0.983627).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000258
	speed: 0.1628s/iter; left time: 2874.3345s
	iters: 200, epoch: 8 | loss: 0.0419541
	speed: 0.0504s/iter; left time: 884.4201s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0541s/iter; left time: 944.9819s
	iters: 400, epoch: 8 | loss: 0.0002446
	speed: 0.0527s/iter; left time: 915.2039s
Epoch: 8 cost time: 20.767469882965088
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0007880
	speed: 0.1455s/iter; left time: 2508.6440s
	iters: 200, epoch: 9 | loss: 0.0000113
	speed: 0.0358s/iter; left time: 613.3460s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0374s/iter; left time: 637.5677s
	iters: 400, epoch: 9 | loss: 0.0000315
	speed: 0.0342s/iter; left time: 580.4222s
Epoch: 9 cost time: 14.938863515853882
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000433
	speed: 0.1294s/iter; left time: 2178.4543s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0263s/iter; left time: 440.6000s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 600.9057s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 571.3675s
Epoch: 10 cost time: 13.960222721099854
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.280 Vali Acc: 0.966 Test Loss: 0.280 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000147
	speed: 0.1452s/iter; left time: 2384.0187s
	iters: 200, epoch: 11 | loss: 0.0000065
	speed: 0.0464s/iter; left time: 756.5303s
	iters: 300, epoch: 11 | loss: 0.0043191
	speed: 0.0515s/iter; left time: 835.9021s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0518s/iter; left time: 835.7803s
Epoch: 11 cost time: 20.694888591766357
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1548s/iter; left time: 2478.3048s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 715.3786s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0488s/iter; left time: 770.8192s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 813.0039s
Epoch: 12 cost time: 19.862820863723755
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000081
	speed: 0.1626s/iter; left time: 2535.0786s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 694.2898s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 654.1786s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0439s/iter; left time: 672.0816s
Epoch: 13 cost time: 18.841153383255005
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1442s/iter; left time: 2188.8375s
	iters: 200, epoch: 14 | loss: 0.0000007
	speed: 0.0359s/iter; left time: 542.1729s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 481.4823s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0357s/iter; left time: 530.7398s
Epoch: 14 cost time: 15.130137920379639
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.976 Test Loss: 0.219 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1422s/iter; left time: 2100.3116s
	iters: 200, epoch: 15 | loss: 0.0004188
	speed: 0.0354s/iter; left time: 519.4856s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 486.1908s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 542.4710s
Epoch: 15 cost time: 15.433875799179077
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.978 Test Loss: 0.238 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000011
	speed: 0.1366s/iter; left time: 1961.2486s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 439.0592s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 485.5374s
	iters: 400, epoch: 16 | loss: 0.0000165
	speed: 0.0352s/iter; left time: 494.6601s
Epoch: 16 cost time: 14.557920217514038
Epoch: 16, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.428 Vali Acc: 0.967 Test Loss: 0.428 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1397s/iter; left time: 1948.3562s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 544.0008s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 723.8671s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 704.4972s
Epoch: 17 cost time: 19.531509160995483
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 37002250
model size : 155.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5405433
	speed: 0.0607s/iter; left time: 1246.8756s
	iters: 200, epoch: 1 | loss: 0.1966038
	speed: 0.0346s/iter; left time: 707.4063s
	iters: 300, epoch: 1 | loss: 0.1919947
	speed: 0.0354s/iter; left time: 719.8853s
	iters: 400, epoch: 1 | loss: 0.0448919
	speed: 0.0327s/iter; left time: 663.0400s
Epoch: 1 cost time: 16.94308829307556
Epoch: 1, Steps: 413 | Train Loss: 0.527 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0098725
	speed: 0.1298s/iter; left time: 2614.8539s
	iters: 200, epoch: 2 | loss: 0.0329085
	speed: 0.0355s/iter; left time: 711.2789s
	iters: 300, epoch: 2 | loss: 0.0761502
	speed: 0.0342s/iter; left time: 682.8513s
	iters: 400, epoch: 2 | loss: 0.0007766
	speed: 0.0342s/iter; left time: 679.2900s
Epoch: 2 cost time: 14.741249322891235
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.972259 --> -0.976352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0097973
	speed: 0.1376s/iter; left time: 2714.0364s
	iters: 200, epoch: 3 | loss: 0.0154180
	speed: 0.0282s/iter; left time: 554.1914s
	iters: 300, epoch: 3 | loss: 0.0007959
	speed: 0.0327s/iter; left time: 639.4130s
	iters: 400, epoch: 3 | loss: 0.1099127
	speed: 0.0299s/iter; left time: 580.6178s
Epoch: 3 cost time: 13.161607503890991
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0343452
	speed: 0.1257s/iter; left time: 2427.6966s
	iters: 200, epoch: 4 | loss: 0.0003333
	speed: 0.0348s/iter; left time: 669.2819s
	iters: 300, epoch: 4 | loss: 0.0009234
	speed: 0.0308s/iter; left time: 589.5185s
	iters: 400, epoch: 4 | loss: 0.0016153
	speed: 0.0321s/iter; left time: 611.2316s
Epoch: 4 cost time: 14.204347133636475
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0007581
	speed: 0.1237s/iter; left time: 2336.9271s
	iters: 200, epoch: 5 | loss: 0.0001887
	speed: 0.0334s/iter; left time: 628.5070s
	iters: 300, epoch: 5 | loss: 0.0001286
	speed: 0.0353s/iter; left time: 660.0454s
	iters: 400, epoch: 5 | loss: 0.0000037
	speed: 0.0339s/iter; left time: 631.3264s
Epoch: 5 cost time: 15.052006483078003
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976807).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003068
	speed: 0.1438s/iter; left time: 2657.9693s
	iters: 200, epoch: 6 | loss: 0.0045887
	speed: 0.0403s/iter; left time: 740.7549s
	iters: 300, epoch: 6 | loss: 0.0072837
	speed: 0.0395s/iter; left time: 722.0019s
	iters: 400, epoch: 6 | loss: 0.0002085
	speed: 0.0379s/iter; left time: 688.7472s
Epoch: 6 cost time: 16.458921194076538
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976807 --> -0.979535).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000252
	speed: 0.1413s/iter; left time: 2553.6168s
	iters: 200, epoch: 7 | loss: 0.0688107
	speed: 0.0379s/iter; left time: 681.1087s
	iters: 300, epoch: 7 | loss: 0.0190307
	speed: 0.0334s/iter; left time: 596.1639s
	iters: 400, epoch: 7 | loss: 0.5024307
	speed: 0.0365s/iter; left time: 648.6766s
Epoch: 7 cost time: 15.515955209732056
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0016723
	speed: 0.1320s/iter; left time: 2330.8545s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0327s/iter; left time: 574.9447s
	iters: 300, epoch: 8 | loss: 0.0000634
	speed: 0.0343s/iter; left time: 598.5025s
	iters: 400, epoch: 8 | loss: 0.0000003
	speed: 0.0326s/iter; left time: 566.4404s
Epoch: 8 cost time: 14.62253737449646
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000077
	speed: 0.1345s/iter; left time: 2320.5526s
	iters: 200, epoch: 9 | loss: 0.0000134
	speed: 0.0378s/iter; left time: 648.7053s
	iters: 300, epoch: 9 | loss: 0.0001064
	speed: 0.0375s/iter; left time: 639.0423s
	iters: 400, epoch: 9 | loss: 0.0111699
	speed: 0.0375s/iter; left time: 635.2892s
Epoch: 9 cost time: 15.740021705627441
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0158914
	speed: 0.1310s/iter; left time: 2205.2922s
	iters: 200, epoch: 10 | loss: 0.0000331
	speed: 0.0314s/iter; left time: 524.7902s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0375s/iter; left time: 624.2398s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 627.7731s
Epoch: 10 cost time: 15.279099225997925
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0044590
	speed: 0.1263s/iter; left time: 2074.0847s
	iters: 200, epoch: 11 | loss: 0.0000478
	speed: 0.0316s/iter; left time: 516.1078s
	iters: 300, epoch: 11 | loss: 0.8569961
	speed: 0.0269s/iter; left time: 436.7831s
	iters: 400, epoch: 11 | loss: 0.0000922
	speed: 0.0323s/iter; left time: 520.1936s
Epoch: 11 cost time: 13.2273108959198
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.981354).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000854
	speed: 0.1425s/iter; left time: 2281.1908s
	iters: 200, epoch: 12 | loss: 0.0000843
	speed: 0.0315s/iter; left time: 501.3129s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.0343s/iter; left time: 542.9680s
	iters: 400, epoch: 12 | loss: 0.0000030
	speed: 0.0346s/iter; left time: 543.9570s
Epoch: 12 cost time: 14.483888626098633
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.972 Test Loss: 0.224 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000056
	speed: 0.1332s/iter; left time: 2077.5437s
	iters: 200, epoch: 13 | loss: 0.3166821
	speed: 0.0388s/iter; left time: 600.5323s
	iters: 300, epoch: 13 | loss: 0.0000048
	speed: 0.0371s/iter; left time: 570.8174s
	iters: 400, epoch: 13 | loss: 0.1659880
	speed: 0.0386s/iter; left time: 590.2988s
Epoch: 13 cost time: 16.27092480659485
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1261s/iter; left time: 1914.4826s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 505.1862s
	iters: 300, epoch: 14 | loss: 0.0000119
	speed: 0.0355s/iter; left time: 532.3651s
	iters: 400, epoch: 14 | loss: 0.0000984
	speed: 0.0344s/iter; left time: 512.5395s
Epoch: 14 cost time: 14.645472049713135
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.979 Test Loss: 0.149 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.1315s/iter; left time: 1942.4979s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 520.9704s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0338s/iter; left time: 491.7047s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 531.7984s
Epoch: 15 cost time: 15.59395170211792
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.979 Test Loss: 0.174 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1302s/iter; left time: 1868.4410s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0370s/iter; left time: 527.6695s
	iters: 300, epoch: 16 | loss: 0.1254801
	speed: 0.0369s/iter; left time: 522.3059s
	iters: 400, epoch: 16 | loss: 0.0000286
	speed: 0.0343s/iter; left time: 481.5385s
Epoch: 16 cost time: 15.517237186431885
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.980 Test Loss: 0.184 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000009
	speed: 0.1274s/iter; left time: 1776.0354s
	iters: 200, epoch: 17 | loss: 0.0002207
	speed: 0.0326s/iter; left time: 450.7558s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0323s/iter; left time: 444.4804s
	iters: 400, epoch: 17 | loss: 0.0000728
	speed: 0.0310s/iter; left time: 422.7252s
Epoch: 17 cost time: 13.586362838745117
Epoch: 17, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1251s/iter; left time: 1693.2370s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0294s/iter; left time: 395.1796s
	iters: 300, epoch: 18 | loss: 0.0000007
	speed: 0.0298s/iter; left time: 397.2905s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0282s/iter; left time: 373.5030s
Epoch: 18 cost time: 12.596875667572021
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000130
	speed: 0.1168s/iter; left time: 1532.2678s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 375.6796s
	iters: 300, epoch: 19 | loss: 0.0000199
	speed: 0.0327s/iter; left time: 422.2089s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0318s/iter; left time: 407.8922s
Epoch: 19 cost time: 13.412281274795532
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.985447).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000007
	speed: 0.1296s/iter; left time: 1646.6915s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 422.5022s
	iters: 300, epoch: 20 | loss: 0.0000003
	speed: 0.0338s/iter; left time: 422.5086s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 414.6560s
Epoch: 20 cost time: 14.3302481174469
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.976 Test Loss: 0.208 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000052
	speed: 0.1160s/iter; left time: 1425.4351s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 381.3705s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 411.5977s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 425.1627s
Epoch: 21 cost time: 14.317673921585083
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.970 Test Loss: 0.294 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1397s/iter; left time: 1658.9302s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0359s/iter; left time: 423.1194s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 400.2701s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 368.9313s
Epoch: 22 cost time: 14.590142011642456
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.233 Vali Acc: 0.977 Test Loss: 0.233 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000104
	speed: 0.1310s/iter; left time: 1501.8957s
	iters: 200, epoch: 23 | loss: 0.0520426
	speed: 0.0314s/iter; left time: 356.4534s
	iters: 300, epoch: 23 | loss: 0.0000634
	speed: 0.0287s/iter; left time: 323.5418s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0311s/iter; left time: 347.3515s
Epoch: 23 cost time: 13.521167993545532
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.332 Vali Acc: 0.964 Test Loss: 0.332 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000003
	speed: 0.1301s/iter; left time: 1438.0517s
	iters: 200, epoch: 24 | loss: 0.0000003
	speed: 0.0361s/iter; left time: 395.6443s
	iters: 300, epoch: 24 | loss: 0.0000003
	speed: 0.0341s/iter; left time: 370.3163s
	iters: 400, epoch: 24 | loss: 0.2797455
	speed: 0.0346s/iter; left time: 372.1500s
Epoch: 24 cost time: 15.039925813674927
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.974 Test Loss: 0.232 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1253s/iter; left time: 1333.4659s
	iters: 200, epoch: 25 | loss: 0.0000013
	speed: 0.0372s/iter; left time: 392.4568s
	iters: 300, epoch: 25 | loss: 0.0000092
	speed: 0.0371s/iter; left time: 386.7706s
	iters: 400, epoch: 25 | loss: 0.0405293
	speed: 0.0329s/iter; left time: 340.1623s
Epoch: 25 cost time: 15.085129261016846
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1187s/iter; left time: 1213.9175s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 376.6278s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 374.6720s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 356.6939s
Epoch: 26 cost time: 15.236140489578247
Epoch: 26, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.980 Test Loss: 0.185 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1225s/iter; left time: 1202.4854s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 371.2489s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 402.5392s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 352.2044s
Epoch: 27 cost time: 16.324354648590088
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.982 Test Loss: 0.160 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1312s/iter; left time: 1233.4325s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 325.6591s
	iters: 300, epoch: 28 | loss: 0.0474227
	speed: 0.0378s/iter; left time: 348.0043s
	iters: 400, epoch: 28 | loss: 0.0000069
	speed: 0.0401s/iter; left time: 365.3580s
Epoch: 28 cost time: 16.091564893722534
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.1302s/iter; left time: 1170.4186s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 317.1705s
	iters: 300, epoch: 29 | loss: 0.0000939
	speed: 0.0326s/iter; left time: 286.1114s
	iters: 400, epoch: 29 | loss: 0.0001588
	speed: 0.0367s/iter; left time: 318.8759s
Epoch: 29 cost time: 14.918088912963867
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.346 Vali Acc: 0.973 Test Loss: 0.346 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 36937738
model size : 155.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8068376
	speed: 0.0585s/iter; left time: 1202.7606s
	iters: 200, epoch: 1 | loss: 0.2136109
	speed: 0.0354s/iter; left time: 723.3090s
	iters: 300, epoch: 1 | loss: 0.0855959
	speed: 0.0355s/iter; left time: 723.2325s
	iters: 400, epoch: 1 | loss: 0.0979849
	speed: 0.0370s/iter; left time: 748.7020s
Epoch: 1 cost time: 17.29304838180542
Epoch: 1, Steps: 413 | Train Loss: 0.576 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2494638
	speed: 0.1410s/iter; left time: 2838.6163s
	iters: 200, epoch: 2 | loss: 0.0207678
	speed: 0.0339s/iter; left time: 680.0647s
	iters: 300, epoch: 2 | loss: 0.0041542
	speed: 0.0355s/iter; left time: 707.3785s
	iters: 400, epoch: 2 | loss: 0.1809615
	speed: 0.0351s/iter; left time: 697.2279s
Epoch: 2 cost time: 15.178344488143921
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
Validation loss decreased (-0.964983 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0046984
	speed: 0.1555s/iter; left time: 3067.5090s
	iters: 200, epoch: 3 | loss: 0.0215155
	speed: 0.0338s/iter; left time: 664.2211s
	iters: 300, epoch: 3 | loss: 0.0032048
	speed: 0.0398s/iter; left time: 776.8084s
	iters: 400, epoch: 3 | loss: 0.0169586
	speed: 0.0382s/iter; left time: 741.1585s
Epoch: 3 cost time: 15.541987895965576
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0149911
	speed: 0.1344s/iter; left time: 2594.7774s
	iters: 200, epoch: 4 | loss: 0.0052014
	speed: 0.0396s/iter; left time: 761.4773s
	iters: 300, epoch: 4 | loss: 0.1057266
	speed: 0.0402s/iter; left time: 768.9672s
	iters: 400, epoch: 4 | loss: 0.0834362
	speed: 0.0392s/iter; left time: 744.9100s
Epoch: 4 cost time: 16.32416319847107
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2275051
	speed: 0.1394s/iter; left time: 2634.6666s
	iters: 200, epoch: 5 | loss: 0.0004188
	speed: 0.0408s/iter; left time: 766.3822s
	iters: 300, epoch: 5 | loss: 0.0032181
	speed: 0.0361s/iter; left time: 674.2310s
	iters: 400, epoch: 5 | loss: 0.0023372
	speed: 0.0404s/iter; left time: 752.2966s
Epoch: 5 cost time: 16.73753547668457
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000718
	speed: 0.1317s/iter; left time: 2435.4026s
	iters: 200, epoch: 6 | loss: 0.0011494
	speed: 0.0366s/iter; left time: 672.7301s
	iters: 300, epoch: 6 | loss: 0.0573721
	speed: 0.0394s/iter; left time: 720.5827s
	iters: 400, epoch: 6 | loss: 0.1440551
	speed: 0.0411s/iter; left time: 748.1619s
Epoch: 6 cost time: 16.481277465820312
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0192577
	speed: 0.1370s/iter; left time: 2476.5837s
	iters: 200, epoch: 7 | loss: 0.0004794
	speed: 0.0377s/iter; left time: 677.3272s
	iters: 300, epoch: 7 | loss: 0.0042345
	speed: 0.0359s/iter; left time: 641.0482s
	iters: 400, epoch: 7 | loss: 0.0320653
	speed: 0.0416s/iter; left time: 739.7750s
Epoch: 7 cost time: 16.135185480117798
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.955 Test Loss: 0.220 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0670325
	speed: 0.1422s/iter; left time: 2512.1145s
	iters: 200, epoch: 8 | loss: 0.0711870
	speed: 0.0332s/iter; left time: 583.5193s
	iters: 300, epoch: 8 | loss: 0.0000743
	speed: 0.0350s/iter; left time: 611.3073s
	iters: 400, epoch: 8 | loss: 0.0006528
	speed: 0.0372s/iter; left time: 645.3096s
Epoch: 8 cost time: 15.18790340423584
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000022
	speed: 0.1442s/iter; left time: 2487.5125s
	iters: 200, epoch: 9 | loss: 0.0116193
	speed: 0.0368s/iter; left time: 630.9175s
	iters: 300, epoch: 9 | loss: 0.0000148
	speed: 0.0372s/iter; left time: 634.3388s
	iters: 400, epoch: 9 | loss: 0.0009150
	speed: 0.0376s/iter; left time: 637.5834s
Epoch: 9 cost time: 15.705243825912476
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0002467
	speed: 0.1458s/iter; left time: 2454.1791s
	iters: 200, epoch: 10 | loss: 0.0334343
	speed: 0.0386s/iter; left time: 646.4403s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0352s/iter; left time: 585.5824s
	iters: 400, epoch: 10 | loss: 0.0097939
	speed: 0.0363s/iter; left time: 599.7260s
Epoch: 10 cost time: 15.952397346496582
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000227
	speed: 0.1408s/iter; left time: 2312.1201s
	iters: 200, epoch: 11 | loss: 0.0001401
	speed: 0.0384s/iter; left time: 626.4557s
	iters: 300, epoch: 11 | loss: 0.0020375
	speed: 0.0327s/iter; left time: 529.7941s
	iters: 400, epoch: 11 | loss: 0.0000634
	speed: 0.0339s/iter; left time: 546.9779s
Epoch: 11 cost time: 15.426124095916748
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000036
	speed: 0.1371s/iter; left time: 2194.3175s
	iters: 200, epoch: 12 | loss: 0.0000161
	speed: 0.0375s/iter; left time: 597.2729s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0359s/iter; left time: 568.2614s
	iters: 400, epoch: 12 | loss: 0.0049688
	speed: 0.0347s/iter; left time: 545.8279s
Epoch: 12 cost time: 15.83427619934082
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 36900874
model size : 155.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1504977
	speed: 0.1244s/iter; left time: 2555.8753s
	iters: 200, epoch: 1 | loss: 0.1487020
	speed: 0.0991s/iter; left time: 2026.9166s
	iters: 300, epoch: 1 | loss: 0.2145704
	speed: 0.0979s/iter; left time: 1992.7710s
	iters: 400, epoch: 1 | loss: 0.0038578
	speed: 0.1033s/iter; left time: 2091.6875s
Epoch: 1 cost time: 43.874749183654785
Epoch: 1, Steps: 413 | Train Loss: 0.575 Vali Loss: 0.266 Vali Acc: 0.947 Test Loss: 0.266 Test Acc: 0.947
Validation loss decreased (inf --> -0.947246).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5925950
	speed: 0.2943s/iter; left time: 5927.3964s
	iters: 200, epoch: 2 | loss: 0.9532159
	speed: 0.1068s/iter; left time: 2140.7787s
	iters: 300, epoch: 2 | loss: 0.0000035
	speed: 0.1026s/iter; left time: 2045.7880s
	iters: 400, epoch: 2 | loss: 0.0006852
	speed: 0.1146s/iter; left time: 2272.5395s
Epoch: 2 cost time: 44.959906578063965
Epoch: 2, Steps: 413 | Train Loss: 0.230 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
Validation loss decreased (-0.947246 --> -0.970439).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012822
	speed: 0.3254s/iter; left time: 6418.5515s
	iters: 200, epoch: 3 | loss: 0.0163335
	speed: 0.1056s/iter; left time: 2072.3566s
	iters: 300, epoch: 3 | loss: 0.0000359
	speed: 0.1096s/iter; left time: 2139.0342s
	iters: 400, epoch: 3 | loss: 0.0000087
	speed: 0.0896s/iter; left time: 1741.0711s
Epoch: 3 cost time: 42.87238430976868
Epoch: 3, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.267 Vali Acc: 0.973 Test Loss: 0.267 Test Acc: 0.973
Validation loss decreased (-0.970439 --> -0.972712).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8753873
	speed: 0.2518s/iter; left time: 4862.3547s
	iters: 200, epoch: 4 | loss: 0.0004331
	speed: 0.0820s/iter; left time: 1574.9327s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 1633.4784s
	iters: 400, epoch: 4 | loss: 0.0001367
	speed: 0.1002s/iter; left time: 1905.1284s
Epoch: 4 cost time: 36.128034591674805
Epoch: 4, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.190 Vali Acc: 0.979 Test Loss: 0.190 Test Acc: 0.979
Validation loss decreased (-0.972712 --> -0.979079).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2871s/iter; left time: 5425.7613s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1651.8424s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 1817.8765s
	iters: 400, epoch: 5 | loss: 0.0006571
	speed: 0.1064s/iter; left time: 1979.0798s
Epoch: 5 cost time: 40.478557109832764
Epoch: 5, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.346 Vali Acc: 0.973 Test Loss: 0.346 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000006
	speed: 0.3018s/iter; left time: 5578.7442s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 1837.2100s
	iters: 300, epoch: 6 | loss: 0.9564642
	speed: 0.0974s/iter; left time: 1780.8961s
	iters: 400, epoch: 6 | loss: 0.5223870
	speed: 0.1092s/iter; left time: 1986.2231s
Epoch: 6 cost time: 42.851956367492676
Epoch: 6, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.506 Vali Acc: 0.958 Test Loss: 0.506 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2845s/iter; left time: 5142.1034s
	iters: 200, epoch: 7 | loss: 0.0066699
	speed: 0.0958s/iter; left time: 1721.0557s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0989s/iter; left time: 1767.6587s
	iters: 400, epoch: 7 | loss: 0.6000127
	speed: 0.0992s/iter; left time: 1763.3815s
Epoch: 7 cost time: 40.51407051086426
Epoch: 7, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.407 Vali Acc: 0.974 Test Loss: 0.407 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2744s/iter; left time: 4845.5585s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0951s/iter; left time: 1670.5103s
	iters: 300, epoch: 8 | loss: 0.0019251
	speed: 0.0953s/iter; left time: 1663.9049s
	iters: 400, epoch: 8 | loss: 0.0028025
	speed: 0.0978s/iter; left time: 1697.9549s
Epoch: 8 cost time: 39.43997573852539
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.277 Vali Acc: 0.980 Test Loss: 0.277 Test Acc: 0.980
Validation loss decreased (-0.979079 --> -0.979533).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3084s/iter; left time: 5318.3884s
	iters: 200, epoch: 9 | loss: 0.2391539
	speed: 0.1040s/iter; left time: 1782.9891s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 1745.7952s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 1785.4438s
Epoch: 9 cost time: 43.782790184020996
Epoch: 9, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.586 Vali Acc: 0.969 Test Loss: 0.586 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3062s/iter; left time: 5154.1620s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 1594.5579s
	iters: 300, epoch: 10 | loss: 0.7857397
	speed: 0.0941s/iter; left time: 1565.7057s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1001s/iter; left time: 1654.6059s
Epoch: 10 cost time: 41.07158637046814
Epoch: 10, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.490 Vali Acc: 0.974 Test Loss: 0.490 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2841s/iter; left time: 4665.0492s
	iters: 200, epoch: 11 | loss: 0.0000049
	speed: 0.0835s/iter; left time: 1362.7509s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0871s/iter; left time: 1412.3701s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 1591.6071s
Epoch: 11 cost time: 37.97780084609985
Epoch: 11, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.702 Vali Acc: 0.977 Test Loss: 0.702 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2818s/iter; left time: 4510.4936s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 1334.1812s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1071s/iter; left time: 1692.5121s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1067s/iter; left time: 1675.5692s
Epoch: 12 cost time: 41.13124203681946
Epoch: 12, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.515 Vali Acc: 0.972 Test Loss: 0.515 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3084s/iter; left time: 4810.2382s
	iters: 200, epoch: 13 | loss: 0.0030030
	speed: 0.0987s/iter; left time: 1529.1401s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 1622.2499s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1063s/iter; left time: 1625.7240s
Epoch: 13 cost time: 43.392688512802124
Epoch: 13, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.986 Test Loss: 0.268 Test Acc: 0.986
Validation loss decreased (-0.979533 --> -0.986355).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3006s/iter; left time: 4563.2889s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0943s/iter; left time: 1422.7782s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 1381.4667s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0913s/iter; left time: 1358.5363s
Epoch: 14 cost time: 39.02165198326111
Epoch: 14, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.328 Vali Acc: 0.985 Test Loss: 0.328 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2724s/iter; left time: 4023.1294s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0898s/iter; left time: 1317.9189s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 1355.5227s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1023s/iter; left time: 1479.6264s
Epoch: 15 cost time: 39.43193054199219
Epoch: 15, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.392 Vali Acc: 0.978 Test Loss: 0.392 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3026s/iter; left time: 4344.4650s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0974s/iter; left time: 1389.0123s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1012s/iter; left time: 1432.1010s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1072s/iter; left time: 1507.2475s
Epoch: 16 cost time: 42.61477279663086
Epoch: 16, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.408 Vali Acc: 0.982 Test Loss: 0.408 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2537s/iter; left time: 3538.0049s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0837s/iter; left time: 1159.0890s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1050.8994s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 1264.6078s
Epoch: 17 cost time: 35.96147871017456
Epoch: 17, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.651 Vali Acc: 0.974 Test Loss: 0.651 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2698s/iter; left time: 3650.4389s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 1191.7136s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 1212.8046s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0928s/iter; left time: 1227.6504s
Epoch: 18 cost time: 37.87206482887268
Epoch: 18, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.326 Vali Acc: 0.986 Test Loss: 0.326 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 3619.9084s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1052s/iter; left time: 1369.0175s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1029s/iter; left time: 1328.9819s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0989s/iter; left time: 1268.0491s
Epoch: 19 cost time: 42.257086753845215
Epoch: 19, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.408 Vali Acc: 0.980 Test Loss: 0.408 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2981s/iter; left time: 3787.4820s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1060s/iter; left time: 1336.2141s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0933s/iter; left time: 1166.4830s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 1150.4676s
Epoch: 20 cost time: 41.990976095199585
Epoch: 20, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.656 Vali Acc: 0.978 Test Loss: 0.656 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2765s/iter; left time: 3398.8031s
	iters: 200, epoch: 21 | loss: 0.0055253
	speed: 0.0904s/iter; left time: 1102.2760s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0860s/iter; left time: 1039.6432s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0917s/iter; left time: 1099.2234s
Epoch: 21 cost time: 38.11099624633789
Epoch: 21, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.595 Vali Acc: 0.983 Test Loss: 0.595 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000008
	speed: 0.2751s/iter; left time: 3267.6966s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 1102.8534s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1005s/iter; left time: 1173.1798s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1046s/iter; left time: 1211.1004s
Epoch: 22 cost time: 41.033056020736694
Epoch: 22, Steps: 413 | Train Loss: 0.033 Vali Loss: 1.108 Vali Acc: 0.971 Test Loss: 1.108 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000020
	speed: 0.2443s/iter; left time: 2801.4217s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 1034.7044s
	iters: 300, epoch: 23 | loss: 0.0006935
	speed: 0.1045s/iter; left time: 1177.2251s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 1097.4524s
Epoch: 23 cost time: 39.46376037597656
Epoch: 23, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.780 Vali Acc: 0.979 Test Loss: 0.780 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 30156298
model size : 129.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7893903
	speed: 0.0974s/iter; left time: 2001.8475s
	iters: 200, epoch: 1 | loss: 0.7441557
	speed: 0.0680s/iter; left time: 1390.4692s
	iters: 300, epoch: 1 | loss: 0.1471354
	speed: 0.0487s/iter; left time: 991.2486s
	iters: 400, epoch: 1 | loss: 0.0004704
	speed: 0.0449s/iter; left time: 908.4384s
Epoch: 1 cost time: 26.655019760131836
Epoch: 1, Steps: 413 | Train Loss: 0.535 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0007975
	speed: 0.1924s/iter; left time: 3874.9512s
	iters: 200, epoch: 2 | loss: 0.0013491
	speed: 0.0627s/iter; left time: 1257.1128s
	iters: 300, epoch: 2 | loss: 0.1031945
	speed: 0.0517s/iter; left time: 1031.0189s
	iters: 400, epoch: 2 | loss: 0.0149366
	speed: 0.0493s/iter; left time: 977.7365s
Epoch: 2 cost time: 24.530802249908447
Epoch: 2, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
Validation loss decreased (-0.960890 --> -0.970894).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000008
	speed: 0.2099s/iter; left time: 4139.7441s
	iters: 200, epoch: 3 | loss: 0.0000005
	speed: 0.0686s/iter; left time: 1345.3932s
	iters: 300, epoch: 3 | loss: 1.8506808
	speed: 0.0618s/iter; left time: 1206.9458s
	iters: 400, epoch: 3 | loss: 0.0006869
	speed: 0.0566s/iter; left time: 1099.6045s
Epoch: 3 cost time: 27.56441640853882
Epoch: 3, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.970894 --> -0.980444).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2191s/iter; left time: 4231.5492s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 1076.4840s
	iters: 300, epoch: 4 | loss: 0.0007895
	speed: 0.0582s/iter; left time: 1111.4463s
	iters: 400, epoch: 4 | loss: 0.0002218
	speed: 0.0774s/iter; left time: 1470.8747s
Epoch: 4 cost time: 27.80594778060913
Epoch: 4, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
Validation loss decreased (-0.980444 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3331586
	speed: 0.1663s/iter; left time: 3142.2643s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 1052.1779s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 882.5492s
	iters: 400, epoch: 5 | loss: 0.0000005
	speed: 0.0445s/iter; left time: 827.2822s
Epoch: 5 cost time: 20.40432906150818
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.189 Vali Acc: 0.977 Test Loss: 0.189 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0014156
	speed: 0.1438s/iter; left time: 2657.9475s
	iters: 200, epoch: 6 | loss: 0.0009797
	speed: 0.0739s/iter; left time: 1358.6380s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0692s/iter; left time: 1266.1747s
	iters: 400, epoch: 6 | loss: 0.4008289
	speed: 0.0636s/iter; left time: 1155.8684s
Epoch: 6 cost time: 26.81675410270691
Epoch: 6, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.982 Test Loss: 0.142 Test Acc: 0.982
Validation loss decreased (-0.981809 --> -0.982263).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0006806
	speed: 0.2118s/iter; left time: 3828.5190s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 1016.3442s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0753s/iter; left time: 1345.9246s
	iters: 400, epoch: 7 | loss: 0.0000010
	speed: 0.0857s/iter; left time: 1522.6658s
Epoch: 7 cost time: 28.910634517669678
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.986 Test Loss: 0.130 Test Acc: 0.986
Validation loss decreased (-0.982263 --> -0.985901).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000055
	speed: 0.2409s/iter; left time: 4253.5356s
	iters: 200, epoch: 8 | loss: 0.0000008
	speed: 0.0790s/iter; left time: 1387.2195s
	iters: 300, epoch: 8 | loss: 0.0000435
	speed: 0.0832s/iter; left time: 1452.1430s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1328.0451s
Epoch: 8 cost time: 32.394561767578125
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2111s/iter; left time: 3640.0251s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0653s/iter; left time: 1120.3738s
	iters: 300, epoch: 9 | loss: 0.0000011
	speed: 0.0605s/iter; left time: 1031.8888s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 814.2223s
Epoch: 9 cost time: 25.308653354644775
Epoch: 9, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.987 Test Loss: 0.111 Test Acc: 0.987
Validation loss decreased (-0.985901 --> -0.986811).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6771153
	speed: 0.2307s/iter; left time: 3883.8577s
	iters: 200, epoch: 10 | loss: 0.0000006
	speed: 0.0584s/iter; left time: 978.0527s
	iters: 300, epoch: 10 | loss: 0.0000016
	speed: 0.0538s/iter; left time: 894.5856s
	iters: 400, epoch: 10 | loss: 1.1653934
	speed: 0.0658s/iter; left time: 1087.3888s
Epoch: 10 cost time: 26.057298183441162
Epoch: 10, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.336 Vali Acc: 0.971 Test Loss: 0.336 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2071s/iter; left time: 3400.3777s
	iters: 200, epoch: 11 | loss: 0.0023098
	speed: 0.0691s/iter; left time: 1127.2265s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 1294.3021s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0696s/iter; left time: 1122.1504s
Epoch: 11 cost time: 29.880337238311768
Epoch: 11, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.233 Vali Acc: 0.980 Test Loss: 0.233 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2118s/iter; left time: 3390.9556s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1398.4828s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0775s/iter; left time: 1224.8484s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 1131.7238s
Epoch: 12 cost time: 33.69381809234619
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.985 Test Loss: 0.185 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2113s/iter; left time: 3294.9760s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0642s/iter; left time: 995.4125s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0633s/iter; left time: 974.2111s
	iters: 400, epoch: 13 | loss: 0.0965177
	speed: 0.0708s/iter; left time: 1083.5240s
Epoch: 13 cost time: 27.161568641662598
Epoch: 13, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.437 Vali Acc: 0.978 Test Loss: 0.437 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1934s/iter; left time: 2936.9494s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0542s/iter; left time: 816.7697s
	iters: 300, epoch: 14 | loss: 0.0000144
	speed: 0.0704s/iter; left time: 1054.2209s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 1191.5688s
Epoch: 14 cost time: 27.48681902885437
Epoch: 14, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.254 Vali Acc: 0.984 Test Loss: 0.254 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1942s/iter; left time: 2868.4575s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 1030.0466s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 1032.4160s
	iters: 400, epoch: 15 | loss: 0.0281682
	speed: 0.0792s/iter; left time: 1146.0778s
Epoch: 15 cost time: 29.360703229904175
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.548 Vali Acc: 0.974 Test Loss: 0.548 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2366s/iter; left time: 3396.4505s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 1015.8867s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 969.1667s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 1094.7576s
Epoch: 16 cost time: 31.20520806312561
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.970 Test Loss: 0.547 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2342s/iter; left time: 3265.5361s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 764.0999s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 851.3421s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 955.8060s
Epoch: 17 cost time: 26.961729764938354
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.980 Test Loss: 0.305 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1956s/iter; left time: 2646.4381s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 1062.6814s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 778.3546s
	iters: 400, epoch: 18 | loss: 0.0000018
	speed: 0.0574s/iter; left time: 758.8171s
Epoch: 18 cost time: 27.18782615661621
Epoch: 18, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.715 Vali Acc: 0.970 Test Loss: 0.715 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2100s/iter; left time: 2755.0843s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0726s/iter; left time: 945.4095s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 881.5500s
	iters: 400, epoch: 19 | loss: 2.7899609
	speed: 0.0683s/iter; left time: 875.0198s
Epoch: 19 cost time: 30.341402292251587
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.456 Vali Acc: 0.981 Test Loss: 0.456 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 29741578
model size : 128.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2334590
	speed: 0.0784s/iter; left time: 1612.0139s
	iters: 200, epoch: 1 | loss: 0.0144315
	speed: 0.0508s/iter; left time: 1038.5424s
	iters: 300, epoch: 1 | loss: 0.7426863
	speed: 0.0446s/iter; left time: 906.7057s
	iters: 400, epoch: 1 | loss: 0.0047088
	speed: 0.0549s/iter; left time: 1111.3260s
Epoch: 1 cost time: 23.699714422225952
Epoch: 1, Steps: 413 | Train Loss: 0.523 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0132648
	speed: 0.1587s/iter; left time: 3196.1667s
	iters: 200, epoch: 2 | loss: 0.0056992
	speed: 0.0516s/iter; left time: 1034.6875s
	iters: 300, epoch: 2 | loss: 0.1417013
	speed: 0.0523s/iter; left time: 1043.2799s
	iters: 400, epoch: 2 | loss: 0.0984654
	speed: 0.0408s/iter; left time: 808.7523s
Epoch: 2 cost time: 20.54116201400757
Epoch: 2, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.969076 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4356022
	speed: 0.1570s/iter; left time: 3097.6654s
	iters: 200, epoch: 3 | loss: 0.0016523
	speed: 0.0269s/iter; left time: 528.4531s
	iters: 300, epoch: 3 | loss: 0.0086443
	speed: 0.0391s/iter; left time: 764.3632s
	iters: 400, epoch: 3 | loss: 0.0001850
	speed: 0.0427s/iter; left time: 828.9689s
Epoch: 3 cost time: 15.536186933517456
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.970895 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0028916
	speed: 0.1731s/iter; left time: 3343.3629s
	iters: 200, epoch: 4 | loss: 0.0078312
	speed: 0.0344s/iter; left time: 661.1233s
	iters: 300, epoch: 4 | loss: 0.0000044
	speed: 0.0373s/iter; left time: 712.0098s
	iters: 400, epoch: 4 | loss: 0.0000881
	speed: 0.0413s/iter; left time: 785.8100s
Epoch: 4 cost time: 16.49403142929077
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.979 Test Loss: 0.142 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0137266
	speed: 0.1818s/iter; left time: 3435.6270s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0556s/iter; left time: 1044.7119s
	iters: 300, epoch: 5 | loss: 0.0082511
	speed: 0.0519s/iter; left time: 971.2300s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0567s/iter; left time: 1054.2460s
Epoch: 5 cost time: 23.49739408493042
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.981354).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000017
	speed: 0.1874s/iter; left time: 3464.9807s
	iters: 200, epoch: 6 | loss: 0.0000266
	speed: 0.0679s/iter; left time: 1248.2085s
	iters: 300, epoch: 6 | loss: 0.0000788
	speed: 0.0590s/iter; left time: 1078.2019s
	iters: 400, epoch: 6 | loss: 0.0000095
	speed: 0.0554s/iter; left time: 1006.6523s
Epoch: 6 cost time: 25.198801040649414
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0046335
	speed: 0.1492s/iter; left time: 2697.1131s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0358s/iter; left time: 643.4020s
	iters: 300, epoch: 7 | loss: 0.0000032
	speed: 0.0474s/iter; left time: 846.3720s
	iters: 400, epoch: 7 | loss: 0.0003738
	speed: 0.0500s/iter; left time: 887.9595s
Epoch: 7 cost time: 18.61458969116211
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.984992).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003574
	speed: 0.1649s/iter; left time: 2911.8843s
	iters: 200, epoch: 8 | loss: 0.0000086
	speed: 0.0356s/iter; left time: 625.3278s
	iters: 300, epoch: 8 | loss: 0.0011897
	speed: 0.0382s/iter; left time: 666.7782s
	iters: 400, epoch: 8 | loss: 0.0163482
	speed: 0.0397s/iter; left time: 688.8853s
Epoch: 8 cost time: 16.208033323287964
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1632s/iter; left time: 2815.3029s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0478s/iter; left time: 819.9820s
	iters: 300, epoch: 9 | loss: 0.0000006
	speed: 0.0349s/iter; left time: 594.6807s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 839.4030s
Epoch: 9 cost time: 19.25675654411316
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1549s/iter; left time: 2607.6532s
	iters: 200, epoch: 10 | loss: 0.0000005
	speed: 0.0573s/iter; left time: 958.3015s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 1065.5517s
	iters: 400, epoch: 10 | loss: 0.0000007
	speed: 0.0621s/iter; left time: 1027.1821s
Epoch: 10 cost time: 24.92711567878723
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.148 Vali Acc: 0.988 Test Loss: 0.148 Test Acc: 0.988
Validation loss decreased (-0.984992 --> -0.987720).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1948s/iter; left time: 3198.5226s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 861.0469s
	iters: 300, epoch: 11 | loss: 0.1232353
	speed: 0.0617s/iter; left time: 1000.1896s
	iters: 400, epoch: 11 | loss: 0.0005054
	speed: 0.0673s/iter; left time: 1085.5832s
Epoch: 11 cost time: 25.241504907608032
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1787s/iter; left time: 2860.3554s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 709.7905s
	iters: 300, epoch: 12 | loss: 0.3161309
	speed: 0.0425s/iter; left time: 672.4590s
	iters: 400, epoch: 12 | loss: 0.0003574
	speed: 0.0406s/iter; left time: 637.4190s
Epoch: 12 cost time: 19.764183521270752
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0018991
	speed: 0.1661s/iter; left time: 2589.9255s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 657.8922s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 626.8564s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 634.2857s
Epoch: 13 cost time: 19.10714054107666
Epoch: 13, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1575s/iter; left time: 2391.7164s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 738.7917s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0507s/iter; left time: 759.6675s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 836.8513s
Epoch: 14 cost time: 21.510107040405273
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.178 Vali Acc: 0.984 Test Loss: 0.178 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1518s/iter; left time: 2242.5674s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 701.3874s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0705s/iter; left time: 1027.2374s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 865.1599s
Epoch: 15 cost time: 23.263227462768555
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.287 Vali Acc: 0.980 Test Loss: 0.287 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.1940s/iter; left time: 2784.9627s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 667.6704s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 691.5671s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 630.0706s
Epoch: 16 cost time: 21.58454418182373
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.987 Test Loss: 0.131 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1421s/iter; left time: 1981.4413s
	iters: 200, epoch: 17 | loss: 0.0109339
	speed: 0.0329s/iter; left time: 455.7085s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 488.7684s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 476.7384s
Epoch: 17 cost time: 14.91199278831482
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.987 Test Loss: 0.155 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0691273
	speed: 0.1351s/iter; left time: 1827.3682s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0312s/iter; left time: 418.8558s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 410.6032s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 463.0389s
Epoch: 18 cost time: 13.787436723709106
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.985 Test Loss: 0.186 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1636s/iter; left time: 2146.1208s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0408s/iter; left time: 531.2942s
	iters: 300, epoch: 19 | loss: 0.0239132
	speed: 0.0417s/iter; left time: 538.3409s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 489.7110s
Epoch: 19 cost time: 18.066903352737427
Epoch: 19, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.986 Test Loss: 0.215 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1654s/iter; left time: 2101.8190s
	iters: 200, epoch: 20 | loss: 0.0000019
	speed: 0.0494s/iter; left time: 622.0963s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 485.0983s
	iters: 400, epoch: 20 | loss: 0.0058245
	speed: 0.0322s/iter; left time: 398.9142s
Epoch: 20 cost time: 18.561400890350342
Epoch: 20, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.303 Vali Acc: 0.977 Test Loss: 0.303 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 29538826
model size : 127.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3663909
	speed: 0.1124s/iter; left time: 2309.3505s
	iters: 200, epoch: 1 | loss: 0.0017107
	speed: 0.0700s/iter; left time: 1430.8918s
	iters: 300, epoch: 1 | loss: 0.1341625
	speed: 0.0552s/iter; left time: 1123.0287s
	iters: 400, epoch: 1 | loss: 0.3181108
	speed: 0.0638s/iter; left time: 1291.8180s
Epoch: 1 cost time: 31.043474435806274
Epoch: 1, Steps: 413 | Train Loss: 0.522 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (inf --> -0.955887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1570156
	speed: 0.2218s/iter; left time: 4466.5832s
	iters: 200, epoch: 2 | loss: 0.2306569
	speed: 0.0569s/iter; left time: 1139.7598s
	iters: 300, epoch: 2 | loss: 0.0045121
	speed: 0.0483s/iter; left time: 962.5373s
	iters: 400, epoch: 2 | loss: 0.4236039
	speed: 0.0649s/iter; left time: 1287.6750s
Epoch: 2 cost time: 24.1746506690979
Epoch: 2, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
Validation loss decreased (-0.955887 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0019169
	speed: 0.2292s/iter; left time: 4520.9012s
	iters: 200, epoch: 3 | loss: 0.0006863
	speed: 0.0575s/iter; left time: 1127.8339s
	iters: 300, epoch: 3 | loss: 0.0007140
	speed: 0.0534s/iter; left time: 1043.1260s
	iters: 400, epoch: 3 | loss: 0.0000010
	speed: 0.0770s/iter; left time: 1496.4046s
Epoch: 3 cost time: 26.027924299240112
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.965892 --> -0.979989).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004583
	speed: 0.2321s/iter; left time: 4483.1545s
	iters: 200, epoch: 4 | loss: 0.0139139
	speed: 0.0623s/iter; left time: 1196.6241s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 1557.7306s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 1700.1962s
Epoch: 4 cost time: 32.15768504142761
Epoch: 4, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.198 Vali Acc: 0.979 Test Loss: 0.198 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000084
	speed: 0.2301s/iter; left time: 4347.8576s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 1498.1983s
	iters: 300, epoch: 5 | loss: 0.0000001
	speed: 0.0832s/iter; left time: 1555.0147s
	iters: 400, epoch: 5 | loss: 0.0000748
	speed: 0.0771s/iter; left time: 1433.2555s
Epoch: 5 cost time: 32.815747022628784
Epoch: 5, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001731
	speed: 0.1809s/iter; left time: 3343.8777s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 1397.8261s
	iters: 300, epoch: 6 | loss: 0.0000030
	speed: 0.0784s/iter; left time: 1434.5037s
	iters: 400, epoch: 6 | loss: 0.0000975
	speed: 0.0641s/iter; left time: 1165.8119s
Epoch: 6 cost time: 29.148371696472168
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.289 Vali Acc: 0.970 Test Loss: 0.289 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1817s/iter; left time: 3284.0817s
	iters: 200, epoch: 7 | loss: 0.0000684
	speed: 0.0775s/iter; left time: 1392.6737s
	iters: 300, epoch: 7 | loss: 0.0877857
	speed: 0.0733s/iter; left time: 1310.9383s
	iters: 400, epoch: 7 | loss: 0.0001070
	speed: 0.0634s/iter; left time: 1127.2449s
Epoch: 7 cost time: 28.763537645339966
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.192 Vali Acc: 0.982 Test Loss: 0.192 Test Acc: 0.982
Validation loss decreased (-0.979989 --> -0.981808).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.2302s/iter; left time: 4066.0660s
	iters: 200, epoch: 8 | loss: 0.0000205
	speed: 0.0899s/iter; left time: 1578.6388s
	iters: 300, epoch: 8 | loss: 0.0000647
	speed: 0.0803s/iter; left time: 1401.6468s
	iters: 400, epoch: 8 | loss: 0.0000013
	speed: 0.0614s/iter; left time: 1065.7937s
Epoch: 8 cost time: 32.91712307929993
Epoch: 8, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.184 Vali Acc: 0.978 Test Loss: 0.184 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1976s/iter; left time: 3408.5504s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 1162.8299s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 769.3438s
	iters: 400, epoch: 9 | loss: 0.0000007
	speed: 0.0476s/iter; left time: 806.4226s
Epoch: 9 cost time: 24.51350474357605
Epoch: 9, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.363 Vali Acc: 0.978 Test Loss: 0.363 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000009
	speed: 0.1672s/iter; left time: 2814.5678s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 853.3712s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 857.8962s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 994.3464s
Epoch: 10 cost time: 23.19691300392151
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.195 Vali Acc: 0.983 Test Loss: 0.195 Test Acc: 0.983
Validation loss decreased (-0.981808 --> -0.982717).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0555322
	speed: 0.2201s/iter; left time: 3614.3391s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 900.8300s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 1121.1742s
	iters: 400, epoch: 11 | loss: 0.5654851
	speed: 0.0705s/iter; left time: 1136.0239s
Epoch: 11 cost time: 26.801212787628174
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.982 Test Loss: 0.201 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0433088
	speed: 0.2186s/iter; left time: 3498.8612s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 1378.7943s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 1295.0575s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 1188.3021s
Epoch: 12 cost time: 32.99298858642578
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.406 Vali Acc: 0.969 Test Loss: 0.406 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000669
	speed: 0.2456s/iter; left time: 3829.7083s
	iters: 200, epoch: 13 | loss: 0.0000106
	speed: 0.0681s/iter; left time: 1055.5431s
	iters: 300, epoch: 13 | loss: 0.0000381
	speed: 0.0704s/iter; left time: 1083.5463s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 993.8702s
Epoch: 13 cost time: 30.533392906188965
Epoch: 13, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.284 Vali Acc: 0.979 Test Loss: 0.284 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2034s/iter; left time: 3088.1929s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 870.7576s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 1029.7330s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 1070.0800s
Epoch: 14 cost time: 27.463852167129517
Epoch: 14, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.228 Vali Acc: 0.984 Test Loss: 0.228 Test Acc: 0.984
Validation loss decreased (-0.982717 --> -0.984081).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1988s/iter; left time: 2936.3506s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 978.4798s
	iters: 300, epoch: 15 | loss: 0.0005069
	speed: 0.0798s/iter; left time: 1162.0517s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 950.3092s
Epoch: 15 cost time: 28.027098417282104
Epoch: 15, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.482 Vali Acc: 0.978 Test Loss: 0.482 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2237s/iter; left time: 3211.5061s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 1270.2575s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 1074.0421s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 1050.3337s
Epoch: 16 cost time: 33.35928964614868
Epoch: 16, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.306 Vali Acc: 0.981 Test Loss: 0.306 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2184s/iter; left time: 3045.0326s
	iters: 200, epoch: 17 | loss: 0.8407959
	speed: 0.0760s/iter; left time: 1052.5101s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0585s/iter; left time: 804.2855s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0607s/iter; left time: 828.2561s
Epoch: 17 cost time: 30.01400089263916
Epoch: 17, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.287 Vali Acc: 0.977 Test Loss: 0.287 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000063
	speed: 0.1834s/iter; left time: 2480.7288s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 512.9107s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 524.9995s
	iters: 400, epoch: 18 | loss: 0.7793717
	speed: 0.0473s/iter; left time: 625.6226s
Epoch: 18 cost time: 18.350309371948242
Epoch: 18, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.292 Vali Acc: 0.984 Test Loss: 0.292 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1409s/iter; left time: 1847.9429s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 518.6863s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 640.7788s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 936.4242s
Epoch: 19 cost time: 21.886786460876465
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.988 Test Loss: 0.193 Test Acc: 0.988
Validation loss decreased (-0.984081 --> -0.987720).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1872s/iter; left time: 2378.3389s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 991.5490s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 1068.4386s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 905.2900s
Epoch: 20 cost time: 29.704468727111816
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.270 Vali Acc: 0.987 Test Loss: 0.270 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1924s/iter; left time: 2364.9707s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 963.5256s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 829.9879s
	iters: 400, epoch: 21 | loss: 0.0339933
	speed: 0.0608s/iter; left time: 729.2260s
Epoch: 21 cost time: 30.226449012756348
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.672 Vali Acc: 0.970 Test Loss: 0.672 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.8274590
	speed: 0.1788s/iter; left time: 2124.0474s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 535.6332s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 499.7961s
	iters: 400, epoch: 22 | loss: 0.1141233
	speed: 0.0443s/iter; left time: 513.0016s
Epoch: 22 cost time: 19.909260749816895
Epoch: 22, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.992 Test Loss: 0.172 Test Acc: 0.992
Validation loss decreased (-0.987720 --> -0.992267).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1616s/iter; left time: 1852.9963s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 467.0865s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 555.6349s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 694.7952s
Epoch: 23 cost time: 21.28118324279785
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.284 Vali Acc: 0.988 Test Loss: 0.284 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2112s/iter; left time: 2334.6375s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 608.6256s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 608.6006s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0770s/iter; left time: 827.6620s
Epoch: 24 cost time: 26.1670823097229
Epoch: 24, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.378 Vali Acc: 0.985 Test Loss: 0.378 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2388s/iter; left time: 2540.4911s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 857.7197s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 828.5960s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 753.4490s
Epoch: 25 cost time: 32.544581174850464
Epoch: 25, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.203 Vali Acc: 0.989 Test Loss: 0.203 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2415s/iter; left time: 2469.5735s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 678.0846s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 542.3582s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 574.5593s
Epoch: 26 cost time: 27.84584879875183
Epoch: 26, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.989 Test Loss: 0.206 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2042s/iter; left time: 2004.0304s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 648.0384s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0689s/iter; left time: 662.7129s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 701.6853s
Epoch: 27 cost time: 29.452701091766357
Epoch: 27, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.431 Vali Acc: 0.983 Test Loss: 0.431 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000048
	speed: 0.1892s/iter; left time: 1778.6326s
	iters: 200, epoch: 28 | loss: 0.0002147
	speed: 0.0783s/iter; left time: 727.7490s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0705s/iter; left time: 648.6111s
	iters: 400, epoch: 28 | loss: 0.0788012
	speed: 0.0728s/iter; left time: 662.6194s
Epoch: 28 cost time: 29.66851568222046
Epoch: 28, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.405 Vali Acc: 0.986 Test Loss: 0.405 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2337s/iter; left time: 2100.2016s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0773s/iter; left time: 686.7456s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 693.8000s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 719.7867s
Epoch: 29 cost time: 34.026153802871704
Epoch: 29, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.987 Test Loss: 0.307 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2233s/iter; left time: 1914.7294s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 534.8615s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 634.6283s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 616.5299s
Epoch: 30 cost time: 29.797422409057617
Epoch: 30, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.321 Vali Acc: 0.990 Test Loss: 0.321 Test Acc: 0.990
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2139s/iter; left time: 1745.3579s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 498.1449s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 458.8086s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 545.1793s
Epoch: 31 cost time: 27.33903479576111
Epoch: 31, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.426 Vali Acc: 0.986 Test Loss: 0.426 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1930s/iter; left time: 1495.0339s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 373.6321s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 318.3504s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0426s/iter; left time: 317.2813s
Epoch: 32 cost time: 19.14545202255249
Epoch: 32, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.268 Vali Acc: 0.989 Test Loss: 0.268 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.992269213278763
model parameter : 29771530
model size : 128.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0980322
	speed: 0.0971s/iter; left time: 1996.0417s
	iters: 200, epoch: 1 | loss: 0.0106376
	speed: 0.0668s/iter; left time: 1365.6501s
	iters: 300, epoch: 1 | loss: 0.0389114
	speed: 0.0590s/iter; left time: 1199.7044s
	iters: 400, epoch: 1 | loss: 0.3196574
	speed: 0.0415s/iter; left time: 841.1522s
Epoch: 1 cost time: 27.05444860458374
Epoch: 1, Steps: 413 | Train Loss: 0.504 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0035885
	speed: 0.1543s/iter; left time: 3107.9564s
	iters: 200, epoch: 2 | loss: 0.0002442
	speed: 0.0418s/iter; left time: 836.7530s
	iters: 300, epoch: 2 | loss: 0.0043159
	speed: 0.0539s/iter; left time: 1073.7058s
	iters: 400, epoch: 2 | loss: 0.0024640
	speed: 0.0583s/iter; left time: 1157.4839s
Epoch: 2 cost time: 21.054993152618408
Epoch: 2, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.969076 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0736439
	speed: 0.1745s/iter; left time: 3441.2732s
	iters: 200, epoch: 3 | loss: 0.0056709
	speed: 0.0453s/iter; left time: 889.1815s
	iters: 300, epoch: 3 | loss: 0.0000408
	speed: 0.0502s/iter; left time: 980.6057s
	iters: 400, epoch: 3 | loss: 0.0000245
	speed: 0.0417s/iter; left time: 809.5149s
Epoch: 3 cost time: 19.449339389801025
Epoch: 3, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.979080).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5544568
	speed: 0.1920s/iter; left time: 3708.0534s
	iters: 200, epoch: 4 | loss: 0.4991331
	speed: 0.0580s/iter; left time: 1113.8016s
	iters: 300, epoch: 4 | loss: 0.0002434
	speed: 0.0586s/iter; left time: 1119.7255s
	iters: 400, epoch: 4 | loss: 0.0000286
	speed: 0.0497s/iter; left time: 945.0989s
Epoch: 4 cost time: 24.00807547569275
Epoch: 4, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.965 Test Loss: 0.261 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8466063
	speed: 0.1839s/iter; left time: 3475.8845s
	iters: 200, epoch: 5 | loss: 0.0000641
	speed: 0.0620s/iter; left time: 1166.3756s
	iters: 300, epoch: 5 | loss: 0.0000593
	speed: 0.0652s/iter; left time: 1218.7479s
	iters: 400, epoch: 5 | loss: 0.0000952
	speed: 0.0668s/iter; left time: 1241.7813s
Epoch: 5 cost time: 26.58997917175293
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.1673s/iter; left time: 3092.7103s
	iters: 200, epoch: 6 | loss: 0.0031861
	speed: 0.0483s/iter; left time: 888.3043s
	iters: 300, epoch: 6 | loss: 0.0071995
	speed: 0.0520s/iter; left time: 951.6771s
	iters: 400, epoch: 6 | loss: 0.0000047
	speed: 0.0423s/iter; left time: 770.0323s
Epoch: 6 cost time: 20.863182544708252
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.982 Test Loss: 0.127 Test Acc: 0.982
Validation loss decreased (-0.979080 --> -0.982263).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1537s/iter; left time: 2778.4723s
	iters: 200, epoch: 7 | loss: 0.0001248
	speed: 0.0344s/iter; left time: 617.5019s
	iters: 300, epoch: 7 | loss: 0.2714621
	speed: 0.0336s/iter; left time: 601.2487s
	iters: 400, epoch: 7 | loss: 0.0000003
	speed: 0.0324s/iter; left time: 575.8502s
Epoch: 7 cost time: 14.847613334655762
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.251 Vali Acc: 0.978 Test Loss: 0.251 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000317
	speed: 0.1346s/iter; left time: 2376.7900s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 574.0406s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 566.0192s
	iters: 400, epoch: 8 | loss: 0.0000096
	speed: 0.0491s/iter; left time: 852.6063s
Epoch: 8 cost time: 16.43773627281189
Epoch: 8, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000094
	speed: 0.1602s/iter; left time: 2762.6342s
	iters: 200, epoch: 9 | loss: 0.0000042
	speed: 0.0400s/iter; left time: 685.6667s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 677.8225s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 695.9092s
Epoch: 9 cost time: 17.29804754257202
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.393 Vali Acc: 0.971 Test Loss: 0.393 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0003545
	speed: 0.1904s/iter; left time: 3205.8811s
	iters: 200, epoch: 10 | loss: 0.0000139
	speed: 0.0562s/iter; left time: 940.8717s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 967.7711s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 867.8227s
Epoch: 10 cost time: 24.405402898788452
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0030951
	speed: 0.1809s/iter; left time: 2970.6680s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 961.5693s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 767.6279s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 794.7979s
Epoch: 11 cost time: 23.960520267486572
Epoch: 11, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.157 Vali Acc: 0.982 Test Loss: 0.157 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1576s/iter; left time: 2523.2348s
	iters: 200, epoch: 12 | loss: 0.0002608
	speed: 0.0521s/iter; left time: 829.0863s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 668.8784s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 651.6186s
Epoch: 12 cost time: 19.757428646087646
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.286 Vali Acc: 0.976 Test Loss: 0.286 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1482s/iter; left time: 2310.9867s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 665.3845s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 903.0632s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 757.6561s
Epoch: 13 cost time: 20.76131820678711
Epoch: 13, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.987 Test Loss: 0.144 Test Acc: 0.987
Validation loss decreased (-0.982263 --> -0.986811).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6305375
	speed: 0.1669s/iter; left time: 2534.6183s
	iters: 200, epoch: 14 | loss: 0.0306719
	speed: 0.0516s/iter; left time: 778.9447s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 830.1980s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 882.8821s
Epoch: 14 cost time: 22.22209858894348
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1670s/iter; left time: 2466.8171s
	iters: 200, epoch: 15 | loss: 0.5574478
	speed: 0.0527s/iter; left time: 772.4630s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 804.7821s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0693s/iter; left time: 1003.0907s
Epoch: 15 cost time: 23.861909866333008
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.986 Test Loss: 0.123 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1754s/iter; left time: 2518.3961s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 650.3615s
	iters: 300, epoch: 16 | loss: 0.0003475
	speed: 0.0556s/iter; left time: 786.3912s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 646.5349s
Epoch: 16 cost time: 21.138412475585938
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.988 Test Loss: 0.136 Test Acc: 0.988
Validation loss decreased (-0.986811 --> -0.988175).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1845s/iter; left time: 2572.9179s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 600.7109s
	iters: 300, epoch: 17 | loss: 0.5888122
	speed: 0.0393s/iter; left time: 539.8109s
	iters: 400, epoch: 17 | loss: 0.0000005
	speed: 0.0401s/iter; left time: 547.6474s
Epoch: 17 cost time: 18.296955823898315
Epoch: 17, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.420 Vali Acc: 0.979 Test Loss: 0.420 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000019
	speed: 0.1656s/iter; left time: 2240.7843s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0518s/iter; left time: 695.6734s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 583.3343s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 532.7544s
Epoch: 18 cost time: 20.610694885253906
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.203 Vali Acc: 0.985 Test Loss: 0.203 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1502s/iter; left time: 1970.7929s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 732.6216s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 636.9918s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 660.0234s
Epoch: 19 cost time: 21.76954483985901
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.266 Vali Acc: 0.983 Test Loss: 0.266 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1548s/iter; left time: 1967.2032s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 751.2765s
	iters: 300, epoch: 20 | loss: 0.0000082
	speed: 0.0709s/iter; left time: 885.9102s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 803.0498s
Epoch: 20 cost time: 25.835952281951904
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.326 Vali Acc: 0.981 Test Loss: 0.326 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1713s/iter; left time: 2105.7214s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 734.0755s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 759.5191s
	iters: 400, epoch: 21 | loss: 0.0204580
	speed: 0.0670s/iter; left time: 803.5502s
Epoch: 21 cost time: 25.469083070755005
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.988 Test Loss: 0.146 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1597s/iter; left time: 1897.3485s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 534.3046s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 554.2277s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 504.0098s
Epoch: 22 cost time: 18.61040496826172
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.264 Vali Acc: 0.984 Test Loss: 0.264 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1416s/iter; left time: 1623.0908s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0302s/iter; left time: 343.6304s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 403.8813s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 460.9879s
Epoch: 23 cost time: 15.581908464431763
Epoch: 23, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.987 Test Loss: 0.215 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1259s/iter; left time: 1391.0772s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 391.5783s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 380.9969s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 440.7662s
Epoch: 24 cost time: 15.82435941696167
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.364 Vali Acc: 0.979 Test Loss: 0.364 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1676s/iter; left time: 1783.4854s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 521.3139s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 539.8109s
	iters: 400, epoch: 25 | loss: 0.0000011
	speed: 0.0581s/iter; left time: 600.8303s
Epoch: 25 cost time: 22.646273374557495
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.438 Vali Acc: 0.978 Test Loss: 0.438 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000012
	speed: 0.1844s/iter; left time: 1885.2368s
	iters: 200, epoch: 26 | loss: 0.1055529
	speed: 0.0492s/iter; left time: 498.6663s
	iters: 300, epoch: 26 | loss: 0.4529415
	speed: 0.0526s/iter; left time: 527.4559s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 332.6314s
Epoch: 26 cost time: 20.41020941734314
Epoch: 26, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.302 Vali Acc: 0.985 Test Loss: 0.302 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 29633290
model size : 127.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8776968
	speed: 0.0753s/iter; left time: 1547.9464s
	iters: 200, epoch: 1 | loss: 0.1134704
	speed: 0.0526s/iter; left time: 1075.7286s
	iters: 300, epoch: 1 | loss: 0.4022098
	speed: 0.0353s/iter; left time: 718.3032s
	iters: 400, epoch: 1 | loss: 0.0359633
	speed: 0.0368s/iter; left time: 745.0838s
Epoch: 1 cost time: 20.5502028465271
Epoch: 1, Steps: 413 | Train Loss: 0.515 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (inf --> -0.979081).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0032251
	speed: 0.1469s/iter; left time: 2958.8831s
	iters: 200, epoch: 2 | loss: 0.0117079
	speed: 0.0517s/iter; left time: 1035.4959s
	iters: 300, epoch: 2 | loss: 0.0054908
	speed: 0.0452s/iter; left time: 900.3785s
	iters: 400, epoch: 2 | loss: 0.0399970
	speed: 0.0346s/iter; left time: 686.9381s
Epoch: 2 cost time: 19.24965810775757
Epoch: 2, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0020858
	speed: 0.1344s/iter; left time: 2650.3387s
	iters: 200, epoch: 3 | loss: 0.3678449
	speed: 0.0504s/iter; left time: 988.4874s
	iters: 300, epoch: 3 | loss: 0.0029448
	speed: 0.0510s/iter; left time: 995.1618s
	iters: 400, epoch: 3 | loss: 0.0000003
	speed: 0.0525s/iter; left time: 1020.3333s
Epoch: 3 cost time: 20.042704582214355
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0686881
	speed: 0.1462s/iter; left time: 2823.6910s
	iters: 200, epoch: 4 | loss: 0.6108931
	speed: 0.0567s/iter; left time: 1089.1922s
	iters: 300, epoch: 4 | loss: 0.0139100
	speed: 0.0623s/iter; left time: 1191.3281s
	iters: 400, epoch: 4 | loss: 0.0000806
	speed: 0.0559s/iter; left time: 1063.6306s
Epoch: 4 cost time: 22.962840795516968
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
Validation loss decreased (-0.979081 --> -0.980899).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000111
	speed: 0.1605s/iter; left time: 3034.2019s
	iters: 200, epoch: 5 | loss: 0.0119380
	speed: 0.0581s/iter; left time: 1092.0319s
	iters: 300, epoch: 5 | loss: 0.0000430
	speed: 0.0608s/iter; left time: 1136.1626s
	iters: 400, epoch: 5 | loss: 0.3562707
	speed: 0.0421s/iter; left time: 783.5403s
Epoch: 5 cost time: 21.204160451889038
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.966 Test Loss: 0.199 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0021147
	speed: 0.1370s/iter; left time: 2531.8314s
	iters: 200, epoch: 6 | loss: 0.0001553
	speed: 0.0393s/iter; left time: 723.4275s
	iters: 300, epoch: 6 | loss: 0.0001037
	speed: 0.0479s/iter; left time: 875.4280s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0492s/iter; left time: 894.5477s
Epoch: 6 cost time: 18.45705556869507
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.1405s/iter; left time: 2539.8074s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 665.4323s
	iters: 300, epoch: 7 | loss: 0.7018539
	speed: 0.0384s/iter; left time: 685.6181s
	iters: 400, epoch: 7 | loss: 0.1471257
	speed: 0.0516s/iter; left time: 916.5511s
Epoch: 7 cost time: 17.218801021575928
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000030
	speed: 0.1361s/iter; left time: 2403.3996s
	iters: 200, epoch: 8 | loss: 0.0000104
	speed: 0.0300s/iter; left time: 526.3030s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 624.8576s
	iters: 400, epoch: 8 | loss: 0.0258332
	speed: 0.0359s/iter; left time: 623.8029s
Epoch: 8 cost time: 14.649178743362427
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1594s/iter; left time: 2750.0193s
	iters: 200, epoch: 9 | loss: 0.0000082
	speed: 0.0455s/iter; left time: 780.9103s
	iters: 300, epoch: 9 | loss: 0.0000007
	speed: 0.0407s/iter; left time: 693.2476s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 703.5068s
Epoch: 9 cost time: 18.5696382522583
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.187 Vali Acc: 0.985 Test Loss: 0.187 Test Acc: 0.985
Validation loss decreased (-0.980899 --> -0.984991).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1794s/iter; left time: 3019.5537s
	iters: 200, epoch: 10 | loss: 0.2794670
	speed: 0.0421s/iter; left time: 704.5244s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 681.2288s
	iters: 400, epoch: 10 | loss: 0.0000526
	speed: 0.0406s/iter; left time: 671.4118s
Epoch: 10 cost time: 18.48853039741516
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.281 Vali Acc: 0.978 Test Loss: 0.281 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1280s/iter; left time: 2101.8512s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 597.2998s
	iters: 300, epoch: 11 | loss: 0.0003915
	speed: 0.0291s/iter; left time: 472.2526s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 514.1656s
Epoch: 11 cost time: 14.500871181488037
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.988 Test Loss: 0.198 Test Acc: 0.988
Validation loss decreased (-0.984991 --> -0.987720).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001423
	speed: 0.1370s/iter; left time: 2193.5843s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 552.8780s
	iters: 300, epoch: 12 | loss: 0.0005403
	speed: 0.0323s/iter; left time: 510.6716s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 491.6614s
Epoch: 12 cost time: 14.349234104156494
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.978 Test Loss: 0.209 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1105s/iter; left time: 1723.8485s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 653.4064s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 786.2896s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 716.5305s
Epoch: 13 cost time: 18.145631313323975
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.325 Vali Acc: 0.975 Test Loss: 0.325 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1430s/iter; left time: 2171.0307s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 594.3635s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 718.4985s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0531s/iter; left time: 789.8642s
Epoch: 14 cost time: 18.935689449310303
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.402 Vali Acc: 0.977 Test Loss: 0.402 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0001355
	speed: 0.1767s/iter; left time: 2609.2115s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 827.5290s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 716.9200s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 789.9766s
Epoch: 15 cost time: 23.19828987121582
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.282 Vali Acc: 0.978 Test Loss: 0.282 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000053
	speed: 0.1605s/iter; left time: 2304.4576s
	iters: 200, epoch: 16 | loss: 0.0001528
	speed: 0.0569s/iter; left time: 811.8788s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 818.0077s
	iters: 400, epoch: 16 | loss: 0.1296668
	speed: 0.0512s/iter; left time: 719.7490s
Epoch: 16 cost time: 23.342642545700073
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.982 Test Loss: 0.213 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1316s/iter; left time: 1834.3749s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 547.5835s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 491.5019s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0514s/iter; left time: 701.6978s
Epoch: 17 cost time: 17.456318855285645
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.982 Test Loss: 0.223 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1480s/iter; left time: 2002.0803s
	iters: 200, epoch: 18 | loss: 0.0000007
	speed: 0.0406s/iter; left time: 544.8495s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 530.7935s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 521.6332s
Epoch: 18 cost time: 17.174548864364624
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.982 Test Loss: 0.195 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000082
	speed: 0.1588s/iter; left time: 2083.6172s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0477s/iter; left time: 620.8512s
	iters: 300, epoch: 19 | loss: 0.0083232
	speed: 0.0453s/iter; left time: 584.8283s
	iters: 400, epoch: 19 | loss: 0.0000054
	speed: 0.0387s/iter; left time: 495.9625s
Epoch: 19 cost time: 19.009775161743164
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.163 Vali Acc: 0.987 Test Loss: 0.163 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1597s/iter; left time: 2028.6474s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 715.3104s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0590s/iter; left time: 737.1421s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 709.7432s
Epoch: 20 cost time: 23.950379610061646
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.353 Vali Acc: 0.977 Test Loss: 0.353 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0104388
	speed: 0.1711s/iter; left time: 2102.8976s
	iters: 200, epoch: 21 | loss: 0.0096449
	speed: 0.0435s/iter; left time: 529.8572s
	iters: 300, epoch: 21 | loss: 0.0012193
	speed: 0.0450s/iter; left time: 544.3796s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.0470s/iter; left time: 563.6208s
Epoch: 21 cost time: 20.40987515449524
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.984 Test Loss: 0.182 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 29522698
model size : 127.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4186428
	speed: 0.0928s/iter; left time: 1907.4389s
	iters: 200, epoch: 1 | loss: 0.1223643
	speed: 0.0568s/iter; left time: 1162.5972s
	iters: 300, epoch: 1 | loss: 0.7585483
	speed: 0.0589s/iter; left time: 1197.6742s
	iters: 400, epoch: 1 | loss: 0.1084973
	speed: 0.0557s/iter; left time: 1128.2115s
Epoch: 1 cost time: 27.438343048095703
Epoch: 1, Steps: 413 | Train Loss: 0.527 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0076792
	speed: 0.2074s/iter; left time: 4176.1757s
	iters: 200, epoch: 2 | loss: 0.0000262
	speed: 0.0751s/iter; left time: 1504.7362s
	iters: 300, epoch: 2 | loss: 0.0000377
	speed: 0.0704s/iter; left time: 1404.5445s
	iters: 400, epoch: 2 | loss: 0.0261934
	speed: 0.0733s/iter; left time: 1453.5018s
Epoch: 2 cost time: 29.51333999633789
Epoch: 2, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.962709 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0006065
	speed: 0.1989s/iter; left time: 3922.5344s
	iters: 200, epoch: 3 | loss: 0.0000080
	speed: 0.0579s/iter; left time: 1136.1549s
	iters: 300, epoch: 3 | loss: 0.0000484
	speed: 0.0525s/iter; left time: 1024.7839s
	iters: 400, epoch: 3 | loss: 0.0000448
	speed: 0.0474s/iter; left time: 919.9204s
Epoch: 3 cost time: 22.83959460258484
Epoch: 3, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0001156
	speed: 0.1617s/iter; left time: 3122.2153s
	iters: 200, epoch: 4 | loss: 0.0037640
	speed: 0.0848s/iter; left time: 1628.5659s
	iters: 300, epoch: 4 | loss: 0.0003604
	speed: 0.0843s/iter; left time: 1610.9048s
	iters: 400, epoch: 4 | loss: 0.0064843
	speed: 0.0697s/iter; left time: 1325.1115s
Epoch: 4 cost time: 30.879000186920166
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0022399
	speed: 0.2114s/iter; left time: 3995.6006s
	iters: 200, epoch: 5 | loss: 0.0000037
	speed: 0.0676s/iter; left time: 1269.9437s
	iters: 300, epoch: 5 | loss: 0.1647694
	speed: 0.0548s/iter; left time: 1024.7643s
	iters: 400, epoch: 5 | loss: 0.1600806
	speed: 0.0533s/iter; left time: 992.0996s
Epoch: 5 cost time: 26.083566188812256
Epoch: 5, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.061 Vali Acc: 0.989 Test Loss: 0.061 Test Acc: 0.989
Validation loss decreased (-0.977716 --> -0.989085).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006823
	speed: 0.1730s/iter; left time: 3198.8715s
	iters: 200, epoch: 6 | loss: 0.0000007
	speed: 0.0472s/iter; left time: 868.2852s
	iters: 300, epoch: 6 | loss: 0.0000005
	speed: 0.0455s/iter; left time: 831.3861s
	iters: 400, epoch: 6 | loss: 0.0002747
	speed: 0.0440s/iter; left time: 799.5527s
Epoch: 6 cost time: 19.810303211212158
Epoch: 6, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.986 Test Loss: 0.110 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1751s/iter; left time: 3164.9896s
	iters: 200, epoch: 7 | loss: 0.0568743
	speed: 0.0511s/iter; left time: 918.0091s
	iters: 300, epoch: 7 | loss: 0.0080342
	speed: 0.0440s/iter; left time: 785.6800s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 732.8931s
Epoch: 7 cost time: 20.071903467178345
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1779s/iter; left time: 3141.8769s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 1083.1172s
	iters: 300, epoch: 8 | loss: 0.0000009
	speed: 0.0547s/iter; left time: 955.5678s
	iters: 400, epoch: 8 | loss: 1.6060545
	speed: 0.0525s/iter; left time: 910.9700s
Epoch: 8 cost time: 24.361793756484985
Epoch: 8, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.143 Vali Acc: 0.983 Test Loss: 0.143 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1828s/iter; left time: 3152.6874s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 1179.6543s
	iters: 300, epoch: 9 | loss: 0.0005635
	speed: 0.0842s/iter; left time: 1436.1674s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 1038.5724s
Epoch: 9 cost time: 29.028928995132446
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.991 Test Loss: 0.073 Test Acc: 0.991
Validation loss decreased (-0.989085 --> -0.990904).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000058
	speed: 0.2200s/iter; left time: 3703.7967s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0765s/iter; left time: 1279.6705s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0488s/iter; left time: 811.9435s
	iters: 400, epoch: 10 | loss: 0.1687302
	speed: 0.0474s/iter; left time: 784.0689s
Epoch: 10 cost time: 26.717950344085693
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.984 Test Loss: 0.142 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1754s/iter; left time: 2880.9700s
	iters: 200, epoch: 11 | loss: 0.0000009
	speed: 0.0623s/iter; left time: 1017.3304s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 844.8914s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 772.6505s
Epoch: 11 cost time: 24.24700617790222
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.990 Test Loss: 0.118 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1956s/iter; left time: 3131.4415s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 946.9857s
	iters: 300, epoch: 12 | loss: 0.2402882
	speed: 0.0458s/iter; left time: 724.2566s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0531s/iter; left time: 834.4814s
Epoch: 12 cost time: 23.397311687469482
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.150 Vali Acc: 0.988 Test Loss: 0.150 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000011
	speed: 0.1954s/iter; left time: 3047.6344s
	iters: 200, epoch: 13 | loss: 0.0038953
	speed: 0.0622s/iter; left time: 963.9035s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 1059.7711s
	iters: 400, epoch: 13 | loss: 0.0000294
	speed: 0.0650s/iter; left time: 994.2702s
Epoch: 13 cost time: 26.418402194976807
Epoch: 13, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2220s/iter; left time: 3370.0205s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 997.1835s
	iters: 300, epoch: 14 | loss: 0.0000006
	speed: 0.0557s/iter; left time: 834.5303s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 818.0490s
Epoch: 14 cost time: 27.04148006439209
Epoch: 14, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.988 Test Loss: 0.146 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2074s/iter; left time: 3063.3238s
	iters: 200, epoch: 15 | loss: 0.0000008
	speed: 0.0471s/iter; left time: 690.7437s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 698.2495s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 732.1099s
Epoch: 15 cost time: 22.169498205184937
Epoch: 15, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.173 Vali Acc: 0.982 Test Loss: 0.173 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1978s/iter; left time: 2840.0361s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 634.9860s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 755.0017s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 815.1125s
Epoch: 16 cost time: 22.77679467201233
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.279 Vali Acc: 0.984 Test Loss: 0.279 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 2603.8431s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 807.3562s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 659.6367s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 638.8915s
Epoch: 17 cost time: 22.559126615524292
Epoch: 17, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.260 Vali Acc: 0.985 Test Loss: 0.260 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2285s/iter; left time: 3091.1541s
	iters: 200, epoch: 18 | loss: 0.0000010
	speed: 0.0566s/iter; left time: 760.1654s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 734.0156s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 720.4067s
Epoch: 18 cost time: 25.048596620559692
Epoch: 18, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.203 Vali Acc: 0.985 Test Loss: 0.203 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1830s/iter; left time: 2400.1578s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 638.6435s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 614.5972s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0501s/iter; left time: 642.4689s
Epoch: 19 cost time: 20.491661310195923
Epoch: 19, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.180 Vali Acc: 0.987 Test Loss: 0.180 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 29792266
model size : 128.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4974147
	speed: 0.0768s/iter; left time: 1578.1866s
	iters: 200, epoch: 1 | loss: 0.5289705
	speed: 0.0446s/iter; left time: 913.1053s
	iters: 300, epoch: 1 | loss: 0.4648253
	speed: 0.0360s/iter; left time: 733.2472s
	iters: 400, epoch: 1 | loss: 0.0182465
	speed: 0.0492s/iter; left time: 996.3958s
Epoch: 1 cost time: 21.386175870895386
Epoch: 1, Steps: 413 | Train Loss: 0.513 Vali Loss: 0.088 Vali Acc: 0.967 Test Loss: 0.088 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1613073
	speed: 0.1575s/iter; left time: 3172.4304s
	iters: 200, epoch: 2 | loss: 0.0046903
	speed: 0.0400s/iter; left time: 801.3499s
	iters: 300, epoch: 2 | loss: 0.0031262
	speed: 0.0348s/iter; left time: 693.3886s
	iters: 400, epoch: 2 | loss: 0.1991043
	speed: 0.0392s/iter; left time: 778.3540s
Epoch: 2 cost time: 17.163153171539307
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.966802 --> -0.973168).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1763247
	speed: 0.1781s/iter; left time: 3513.1758s
	iters: 200, epoch: 3 | loss: 0.0003080
	speed: 0.0436s/iter; left time: 854.8331s
	iters: 300, epoch: 3 | loss: 0.0000207
	speed: 0.0385s/iter; left time: 752.2469s
	iters: 400, epoch: 3 | loss: 0.0000001
	speed: 0.0398s/iter; left time: 773.4815s
Epoch: 3 cost time: 18.313546895980835
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
Validation loss decreased (-0.973168 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0007431
	speed: 0.1869s/iter; left time: 3608.8811s
	iters: 200, epoch: 4 | loss: 0.0000020
	speed: 0.0449s/iter; left time: 863.5078s
	iters: 300, epoch: 4 | loss: 0.0000004
	speed: 0.0395s/iter; left time: 754.6315s
	iters: 400, epoch: 4 | loss: 0.0433207
	speed: 0.0415s/iter; left time: 788.3656s
Epoch: 4 cost time: 18.279162168502808
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
Validation loss decreased (-0.974078 --> -0.984537).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000059
	speed: 0.1732s/iter; left time: 3273.8308s
	iters: 200, epoch: 5 | loss: 0.0001754
	speed: 0.0370s/iter; left time: 695.5812s
	iters: 300, epoch: 5 | loss: 0.0002166
	speed: 0.0339s/iter; left time: 633.4428s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 652.9862s
Epoch: 5 cost time: 15.950586318969727
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0001052
	speed: 0.1517s/iter; left time: 2803.7959s
	iters: 200, epoch: 6 | loss: 0.0049330
	speed: 0.0453s/iter; left time: 832.7391s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.0461s/iter; left time: 843.1474s
	iters: 400, epoch: 6 | loss: 0.0000024
	speed: 0.0361s/iter; left time: 655.6425s
Epoch: 6 cost time: 18.337352514266968
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000025
	speed: 0.1436s/iter; left time: 2595.8176s
	iters: 200, epoch: 7 | loss: 0.0000035
	speed: 0.0390s/iter; left time: 700.5091s
	iters: 300, epoch: 7 | loss: 0.0000060
	speed: 0.0436s/iter; left time: 778.4600s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 815.8022s
Epoch: 7 cost time: 17.854936599731445
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.066 Vali Acc: 0.995 Test Loss: 0.066 Test Acc: 0.995
Validation loss decreased (-0.984537 --> -0.994542).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.1634s/iter; left time: 2885.4747s
	iters: 200, epoch: 8 | loss: 0.2940737
	speed: 0.0351s/iter; left time: 616.3390s
	iters: 300, epoch: 8 | loss: 0.0000005
	speed: 0.0304s/iter; left time: 530.7480s
	iters: 400, epoch: 8 | loss: 0.9453903
	speed: 0.0443s/iter; left time: 769.2313s
Epoch: 8 cost time: 15.851293325424194
Epoch: 8, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1679s/iter; left time: 2895.9125s
	iters: 200, epoch: 9 | loss: 0.0000141
	speed: 0.0430s/iter; left time: 737.7225s
	iters: 300, epoch: 9 | loss: 0.0042025
	speed: 0.0462s/iter; left time: 787.4556s
	iters: 400, epoch: 9 | loss: 0.0000044
	speed: 0.0556s/iter; left time: 942.3764s
Epoch: 9 cost time: 20.347102880477905
Epoch: 9, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.094 Vali Acc: 0.989 Test Loss: 0.094 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000061
	speed: 0.1703s/iter; left time: 2866.4170s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 749.5556s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 822.0098s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 980.3799s
Epoch: 10 cost time: 21.382715940475464
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.981 Test Loss: 0.166 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3460630
	speed: 0.1448s/iter; left time: 2377.8006s
	iters: 200, epoch: 11 | loss: 0.6579439
	speed: 0.0419s/iter; left time: 684.0703s
	iters: 300, epoch: 11 | loss: 0.0000027
	speed: 0.0464s/iter; left time: 753.3122s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 612.2496s
Epoch: 11 cost time: 17.661699056625366
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.982 Test Loss: 0.175 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000025
	speed: 0.1630s/iter; left time: 2608.5911s
	iters: 200, epoch: 12 | loss: 0.6493046
	speed: 0.0453s/iter; left time: 720.7936s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 644.7903s
	iters: 400, epoch: 12 | loss: 0.9353031
	speed: 0.0398s/iter; left time: 625.1197s
Epoch: 12 cost time: 17.716329097747803
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.237 Vali Acc: 0.977 Test Loss: 0.237 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1691s/iter; left time: 2637.1154s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 701.8200s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 573.3417s
	iters: 400, epoch: 13 | loss: 0.0000078
	speed: 0.0376s/iter; left time: 575.5246s
Epoch: 13 cost time: 18.778547048568726
Epoch: 13, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.986 Test Loss: 0.115 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1702s/iter; left time: 2584.2537s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 875.8204s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 651.8278s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0411s/iter; left time: 612.3097s
Epoch: 14 cost time: 22.205499410629272
Epoch: 14, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1683s/iter; left time: 2485.3003s
	iters: 200, epoch: 15 | loss: 0.0000020
	speed: 0.0586s/iter; left time: 859.6506s
	iters: 300, epoch: 15 | loss: 0.0001364
	speed: 0.0565s/iter; left time: 823.3759s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.0498s/iter; left time: 720.3385s
Epoch: 15 cost time: 23.09629225730896
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.987 Test Loss: 0.123 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1631s/iter; left time: 2342.1167s
	iters: 200, epoch: 16 | loss: 0.0000015
	speed: 0.0496s/iter; left time: 706.4359s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 705.8626s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 602.1552s
Epoch: 16 cost time: 20.173710584640503
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.992 Test Loss: 0.076 Test Acc: 0.992
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1379s/iter; left time: 1923.3944s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 641.5539s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 707.9008s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 486.2513s
Epoch: 17 cost time: 18.05760431289673
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.990 Test Loss: 0.140 Test Acc: 0.990
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9945429740791268
model parameter : 29663242
model size : 127.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3204850
	speed: 0.0556s/iter; left time: 1143.1947s
	iters: 200, epoch: 1 | loss: 0.1550216
	speed: 0.0314s/iter; left time: 643.0827s
	iters: 300, epoch: 1 | loss: 0.3744426
	speed: 0.0296s/iter; left time: 601.8429s
	iters: 400, epoch: 1 | loss: 0.0131897
	speed: 0.0310s/iter; left time: 628.4143s
Epoch: 1 cost time: 15.203948259353638
Epoch: 1, Steps: 413 | Train Loss: 0.525 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0248363
	speed: 0.1352s/iter; left time: 2722.8367s
	iters: 200, epoch: 2 | loss: 0.0090089
	speed: 0.0383s/iter; left time: 767.4682s
	iters: 300, epoch: 2 | loss: 0.0001273
	speed: 0.0272s/iter; left time: 541.9260s
	iters: 400, epoch: 2 | loss: 0.0170603
	speed: 0.0371s/iter; left time: 735.7101s
Epoch: 2 cost time: 14.833722352981567
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.971350 --> -0.971804).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0059874
	speed: 0.1525s/iter; left time: 3008.3678s
	iters: 200, epoch: 3 | loss: 0.3009897
	speed: 0.0362s/iter; left time: 710.7296s
	iters: 300, epoch: 3 | loss: 0.0062065
	speed: 0.0407s/iter; left time: 795.0090s
	iters: 400, epoch: 3 | loss: 0.1625590
	speed: 0.0413s/iter; left time: 802.3687s
Epoch: 3 cost time: 16.64094567298889
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0079255
	speed: 0.1297s/iter; left time: 2504.2194s
	iters: 200, epoch: 4 | loss: 0.0000854
	speed: 0.0319s/iter; left time: 613.4345s
	iters: 300, epoch: 4 | loss: 0.0000471
	speed: 0.0316s/iter; left time: 604.8753s
	iters: 400, epoch: 4 | loss: 0.8259398
	speed: 0.0364s/iter; left time: 691.3226s
Epoch: 4 cost time: 14.255382776260376
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1743452
	speed: 0.1320s/iter; left time: 2494.4288s
	iters: 200, epoch: 5 | loss: 0.0001406
	speed: 0.0296s/iter; left time: 556.1635s
	iters: 300, epoch: 5 | loss: 0.0002751
	speed: 0.0265s/iter; left time: 496.4096s
	iters: 400, epoch: 5 | loss: 0.0010175
	speed: 0.0288s/iter; left time: 536.3227s
Epoch: 5 cost time: 12.615676403045654
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.971804 --> -0.973168).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0047353
	speed: 0.1562s/iter; left time: 2888.3699s
	iters: 200, epoch: 6 | loss: 0.0007369
	speed: 0.0324s/iter; left time: 596.3062s
	iters: 300, epoch: 6 | loss: 0.0130787
	speed: 0.0296s/iter; left time: 541.7758s
	iters: 400, epoch: 6 | loss: 0.0000373
	speed: 0.0290s/iter; left time: 527.6596s
Epoch: 6 cost time: 13.511989831924438
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.253 Vali Acc: 0.966 Test Loss: 0.253 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0009790
	speed: 0.1229s/iter; left time: 2221.7045s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 577.9797s
	iters: 300, epoch: 7 | loss: 0.1104118
	speed: 0.0338s/iter; left time: 603.5030s
	iters: 400, epoch: 7 | loss: 0.0000004
	speed: 0.0361s/iter; left time: 640.7475s
Epoch: 7 cost time: 14.079020261764526
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.210 Vali Acc: 0.971 Test Loss: 0.210 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3540345
	speed: 0.1211s/iter; left time: 2139.3300s
	iters: 200, epoch: 8 | loss: 0.0000004
	speed: 0.0367s/iter; left time: 643.8311s
	iters: 300, epoch: 8 | loss: 0.0000004
	speed: 0.0339s/iter; left time: 591.8977s
	iters: 400, epoch: 8 | loss: 0.0000003
	speed: 0.0293s/iter; left time: 508.1586s
Epoch: 8 cost time: 14.337806224822998
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000410
	speed: 0.1380s/iter; left time: 2380.5610s
	iters: 200, epoch: 9 | loss: 0.0000158
	speed: 0.0290s/iter; left time: 497.1480s
	iters: 300, epoch: 9 | loss: 0.0000082
	speed: 0.0338s/iter; left time: 576.7104s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 581.4575s
Epoch: 9 cost time: 14.440335512161255
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.973 Test Loss: 0.220 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0604254
	speed: 0.1192s/iter; left time: 2006.4782s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 539.6695s
	iters: 300, epoch: 10 | loss: 0.0000058
	speed: 0.0314s/iter; left time: 523.0434s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 509.1877s
Epoch: 10 cost time: 13.77104139328003
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
Validation loss decreased (-0.973168 --> -0.973623).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000090
	speed: 0.1212s/iter; left time: 1990.3204s
	iters: 200, epoch: 11 | loss: 0.0000283
	speed: 0.0283s/iter; left time: 462.4684s
	iters: 300, epoch: 11 | loss: 0.0009827
	speed: 0.0263s/iter; left time: 426.1467s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 426.7462s
Epoch: 11 cost time: 11.539929151535034
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.973623 --> -0.979989).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1330s/iter; left time: 2128.7142s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0275s/iter; left time: 436.6928s
	iters: 300, epoch: 12 | loss: 0.0000532
	speed: 0.0270s/iter; left time: 427.2952s
	iters: 400, epoch: 12 | loss: 0.0001204
	speed: 0.0249s/iter; left time: 391.5200s
Epoch: 12 cost time: 11.649355411529541
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.974 Test Loss: 0.209 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0013451
	speed: 0.1120s/iter; left time: 1746.7896s
	iters: 200, epoch: 13 | loss: 0.0000361
	speed: 0.0258s/iter; left time: 400.1922s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 428.2403s
	iters: 400, epoch: 13 | loss: 0.0002191
	speed: 0.0271s/iter; left time: 413.8688s
Epoch: 13 cost time: 11.666938781738281
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1089s/iter; left time: 1652.7894s
	iters: 200, epoch: 14 | loss: 0.0008826
	speed: 0.0264s/iter; left time: 397.5006s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0269s/iter; left time: 402.4446s
	iters: 400, epoch: 14 | loss: 0.0000006
	speed: 0.0263s/iter; left time: 390.6834s
Epoch: 14 cost time: 11.363233089447021
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1187s/iter; left time: 1752.5327s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 486.5247s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 530.4189s
	iters: 400, epoch: 15 | loss: 0.0000222
	speed: 0.0386s/iter; left time: 558.7291s
Epoch: 15 cost time: 14.52092957496643
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.982 Test Loss: 0.148 Test Acc: 0.982
Validation loss decreased (-0.979989 --> -0.982263).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1579s/iter; left time: 2266.4239s
	iters: 200, epoch: 16 | loss: 0.4022761
	speed: 0.0389s/iter; left time: 554.1209s
	iters: 300, epoch: 16 | loss: 0.0000106
	speed: 0.0334s/iter; left time: 472.9215s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 491.9355s
Epoch: 16 cost time: 15.477028608322144
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.976 Test Loss: 0.209 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1431s/iter; left time: 1995.6719s
	iters: 200, epoch: 17 | loss: 1.1854807
	speed: 0.0378s/iter; left time: 522.7120s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 520.7049s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 524.9839s
Epoch: 17 cost time: 16.652542114257812
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.979 Test Loss: 0.225 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1250s/iter; left time: 1690.7942s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 404.3655s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 424.6299s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 435.9294s
Epoch: 18 cost time: 13.316997766494751
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.982 Test Loss: 0.187 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1271s/iter; left time: 1667.6692s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 474.5213s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 454.8827s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0300s/iter; left time: 384.9631s
Epoch: 19 cost time: 14.412456512451172
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.273 Vali Acc: 0.976 Test Loss: 0.273 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000039
	speed: 0.1226s/iter; left time: 1557.5485s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0310s/iter; left time: 390.4794s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 431.9638s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 426.5202s
Epoch: 20 cost time: 14.192098617553711
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.247 Vali Acc: 0.980 Test Loss: 0.247 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0001181
	speed: 0.1423s/iter; left time: 1749.0424s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 402.4620s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 358.8019s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 397.5902s
Epoch: 21 cost time: 13.987963438034058
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.977 Test Loss: 0.285 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1262s/iter; left time: 1498.9587s
	iters: 200, epoch: 22 | loss: 0.0000019
	speed: 0.0385s/iter; left time: 453.2976s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 447.2586s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 486.0084s
Epoch: 22 cost time: 16.238335609436035
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.980 Test Loss: 0.189 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1424s/iter; left time: 1632.5327s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0364s/iter; left time: 413.3752s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 392.4645s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 477.0921s
Epoch: 23 cost time: 15.578842401504517
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.986 Test Loss: 0.161 Test Acc: 0.986
Validation loss decreased (-0.982263 --> -0.986356).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1503s/iter; left time: 1660.9128s
	iters: 200, epoch: 24 | loss: 0.0000080
	speed: 0.0383s/iter; left time: 419.3178s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 331.8172s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 320.2652s
Epoch: 24 cost time: 14.637993335723877
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.207 Vali Acc: 0.983 Test Loss: 0.207 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1106s/iter; left time: 1176.2497s
	iters: 200, epoch: 25 | loss: 0.4391703
	speed: 0.0298s/iter; left time: 314.1903s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0283s/iter; left time: 295.2530s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 300.8165s
Epoch: 25 cost time: 12.20729660987854
Epoch: 25, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.324 Vali Acc: 0.981 Test Loss: 0.324 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1292s/iter; left time: 1321.2241s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 354.2387s
	iters: 300, epoch: 26 | loss: 0.0018136
	speed: 0.0309s/iter; left time: 309.6100s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 337.6869s
Epoch: 26 cost time: 14.36813473701477
Epoch: 26, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.259 Vali Acc: 0.983 Test Loss: 0.259 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1294s/iter; left time: 1269.8896s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 370.0533s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 342.9833s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 340.2555s
Epoch: 27 cost time: 15.614561080932617
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.987 Test Loss: 0.153 Test Acc: 0.987
Validation loss decreased (-0.986356 --> -0.986811).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1479s/iter; left time: 1390.3630s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 272.2461s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 290.5974s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 298.9782s
Epoch: 28 cost time: 13.709945917129517
Epoch: 28, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.989 Test Loss: 0.148 Test Acc: 0.989
Validation loss decreased (-0.986811 --> -0.988630).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0477561
	speed: 0.1682s/iter; left time: 1511.5561s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0405s/iter; left time: 359.9738s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 312.6529s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0331s/iter; left time: 287.1455s
Epoch: 29 cost time: 15.887639045715332
Epoch: 29, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.238 Vali Acc: 0.984 Test Loss: 0.238 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1433s/iter; left time: 1228.8068s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 347.6019s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 338.0517s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 340.7064s
Epoch: 30 cost time: 16.57252073287964
Epoch: 30, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.307 Vali Acc: 0.981 Test Loss: 0.307 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1401s/iter; left time: 1143.0429s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 273.6642s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0339s/iter; left time: 269.4856s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 256.1362s
Epoch: 31 cost time: 14.185117244720459
Epoch: 31, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.987 Test Loss: 0.199 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1255s/iter; left time: 972.0496s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 245.2887s
	iters: 300, epoch: 32 | loss: 0.1902597
	speed: 0.0360s/iter; left time: 271.7394s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 277.1659s
Epoch: 32 cost time: 14.587011098861694
Epoch: 32, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.985 Test Loss: 0.256 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0395660
	speed: 0.1328s/iter; left time: 974.0682s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 230.2151s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 268.9979s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0349s/iter; left time: 245.2875s
Epoch: 33 cost time: 14.53266429901123
Epoch: 33, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.356 Vali Acc: 0.981 Test Loss: 0.356 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 947.3780s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 239.9886s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 237.4552s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 223.7493s
Epoch: 34 cost time: 15.011359453201294
Epoch: 34, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.404 Vali Acc: 0.975 Test Loss: 0.404 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1404s/iter; left time: 913.8380s
	iters: 200, epoch: 35 | loss: 0.9890327
	speed: 0.0366s/iter; left time: 234.5755s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 198.7244s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 191.9335s
Epoch: 35 cost time: 14.681334495544434
Epoch: 35, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1092s/iter; left time: 665.9176s
	iters: 200, epoch: 36 | loss: 0.0000007
	speed: 0.0440s/iter; left time: 263.9168s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 215.7376s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 204.3436s
Epoch: 36 cost time: 15.511006593704224
Epoch: 36, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.985 Test Loss: 0.202 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1244s/iter; left time: 706.8298s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 168.9629s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 175.1067s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 174.0668s
Epoch: 37 cost time: 13.734604597091675
Epoch: 37, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.347 Vali Acc: 0.979 Test Loss: 0.347 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1159s/iter; left time: 610.7530s
	iters: 200, epoch: 38 | loss: 0.0000159
	speed: 0.0297s/iter; left time: 153.6965s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 154.6530s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0291s/iter; left time: 144.7511s
Epoch: 38 cost time: 12.591817140579224
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.446 Vali Acc: 0.979 Test Loss: 0.446 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 29525002
model size : 127.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4171787
	speed: 0.0659s/iter; left time: 1355.2406s
	iters: 200, epoch: 1 | loss: 0.5341653
	speed: 0.0427s/iter; left time: 872.5803s
	iters: 300, epoch: 1 | loss: 0.0181319
	speed: 0.0432s/iter; left time: 880.0790s
	iters: 400, epoch: 1 | loss: 0.5890028
	speed: 0.0471s/iter; left time: 954.7780s
Epoch: 1 cost time: 20.72032880783081
Epoch: 1, Steps: 413 | Train Loss: 0.509 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0204597
	speed: 0.1940s/iter; left time: 3906.0750s
	iters: 200, epoch: 2 | loss: 0.0640879
	speed: 0.0533s/iter; left time: 1067.6376s
	iters: 300, epoch: 2 | loss: 0.0022127
	speed: 0.0658s/iter; left time: 1311.0597s
	iters: 400, epoch: 2 | loss: 0.0000102
	speed: 0.0791s/iter; left time: 1569.8699s
Epoch: 2 cost time: 26.44898557662964
Epoch: 2, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0120139
	speed: 0.2224s/iter; left time: 4387.6530s
	iters: 200, epoch: 3 | loss: 0.0039397
	speed: 0.0686s/iter; left time: 1346.5484s
	iters: 300, epoch: 3 | loss: 0.0000113
	speed: 0.0775s/iter; left time: 1512.5175s
	iters: 400, epoch: 3 | loss: 0.0569811
	speed: 0.0911s/iter; left time: 1769.6031s
Epoch: 3 cost time: 31.608081817626953
Epoch: 3, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.974987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0010129
	speed: 0.1875s/iter; left time: 3620.8499s
	iters: 200, epoch: 4 | loss: 0.2953721
	speed: 0.0707s/iter; left time: 1357.4224s
	iters: 300, epoch: 4 | loss: 0.2240969
	speed: 0.0761s/iter; left time: 1454.6200s
	iters: 400, epoch: 4 | loss: 0.0901121
	speed: 0.0572s/iter; left time: 1088.2473s
Epoch: 4 cost time: 26.4872407913208
Epoch: 4, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.266 Vali Acc: 0.966 Test Loss: 0.266 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0098310
	speed: 0.1839s/iter; left time: 3475.2226s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 1410.1899s
	iters: 300, epoch: 5 | loss: 0.0010471
	speed: 0.0685s/iter; left time: 1280.6264s
	iters: 400, epoch: 5 | loss: 0.2080903
	speed: 0.0522s/iter; left time: 970.9212s
Epoch: 5 cost time: 26.640117168426514
Epoch: 5, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.050 Vali Acc: 0.991 Test Loss: 0.050 Test Acc: 0.991
Validation loss decreased (-0.974987 --> -0.990904).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0007240
	speed: 0.2135s/iter; left time: 3946.3043s
	iters: 200, epoch: 6 | loss: 0.0001148
	speed: 0.0701s/iter; left time: 1288.0333s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1021.4943s
	iters: 400, epoch: 6 | loss: 0.0009161
	speed: 0.0584s/iter; left time: 1062.4449s
Epoch: 6 cost time: 27.084988355636597
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2596000
	speed: 0.2039s/iter; left time: 3685.1856s
	iters: 200, epoch: 7 | loss: 0.0000220
	speed: 0.0572s/iter; left time: 1027.9190s
	iters: 300, epoch: 7 | loss: 0.0088187
	speed: 0.0477s/iter; left time: 853.0077s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0442s/iter; left time: 784.8430s
Epoch: 7 cost time: 23.53182601928711
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0017999
	speed: 0.1885s/iter; left time: 3329.2437s
	iters: 200, epoch: 8 | loss: 0.1726688
	speed: 0.0729s/iter; left time: 1280.0305s
	iters: 300, epoch: 8 | loss: 0.6093917
	speed: 0.0668s/iter; left time: 1166.9461s
	iters: 400, epoch: 8 | loss: 0.0003001
	speed: 0.0707s/iter; left time: 1227.7404s
Epoch: 8 cost time: 28.92213726043701
Epoch: 8, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.253 Vali Acc: 0.981 Test Loss: 0.253 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.2364s/iter; left time: 4076.4462s
	iters: 200, epoch: 9 | loss: 0.0000010
	speed: 0.0711s/iter; left time: 1219.8084s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 1208.2208s
	iters: 400, epoch: 9 | loss: 0.0143222
	speed: 0.0908s/iter; left time: 1538.7545s
Epoch: 9 cost time: 32.406763553619385
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.985 Test Loss: 0.159 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0001653
	speed: 0.2061s/iter; left time: 3468.8609s
	iters: 200, epoch: 10 | loss: 0.2866467
	speed: 0.0507s/iter; left time: 848.3802s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 1190.8988s
	iters: 400, epoch: 10 | loss: 0.0000004
	speed: 0.0772s/iter; left time: 1276.2782s
Epoch: 10 cost time: 26.635029792785645
Epoch: 10, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.985 Test Loss: 0.199 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1854s/iter; left time: 3044.1809s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 842.0507s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0760s/iter; left time: 1232.1312s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.0743s/iter; left time: 1197.0552s
Epoch: 11 cost time: 26.718928575515747
Epoch: 11, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.217 Vali Acc: 0.985 Test Loss: 0.217 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000095
	speed: 0.1793s/iter; left time: 2870.0350s
	iters: 200, epoch: 12 | loss: 0.0000023
	speed: 0.0479s/iter; left time: 761.7553s
	iters: 300, epoch: 12 | loss: 0.0374634
	speed: 0.0516s/iter; left time: 815.7650s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 865.0321s
Epoch: 12 cost time: 22.492693185806274
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.350 Vali Acc: 0.974 Test Loss: 0.350 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000071
	speed: 0.1978s/iter; left time: 3084.3206s
	iters: 200, epoch: 13 | loss: 0.0000539
	speed: 0.0647s/iter; left time: 1002.2673s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 992.2388s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 867.7487s
Epoch: 13 cost time: 25.69879722595215
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.987 Test Loss: 0.194 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0009682
	speed: 0.1756s/iter; left time: 2666.2926s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 963.7834s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 819.1045s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 702.3288s
Epoch: 14 cost time: 24.130481004714966
Epoch: 14, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1667s/iter; left time: 2461.8791s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 1107.2645s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 1008.3668s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 705.8007s
Epoch: 15 cost time: 26.166385412216187
Epoch: 15, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.568 Vali Acc: 0.967 Test Loss: 0.568 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 29822218
model size : 128.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3500574
	speed: 0.0666s/iter; left time: 1368.3069s
	iters: 200, epoch: 1 | loss: 0.3000482
	speed: 0.0552s/iter; left time: 1129.2238s
	iters: 300, epoch: 1 | loss: 0.1842293
	speed: 0.0418s/iter; left time: 851.3864s
	iters: 400, epoch: 1 | loss: 0.0013079
	speed: 0.0491s/iter; left time: 993.9229s
Epoch: 1 cost time: 22.063519954681396
Epoch: 1, Steps: 413 | Train Loss: 0.504 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0304234
	speed: 0.1685s/iter; left time: 3394.1695s
	iters: 200, epoch: 2 | loss: 0.3010528
	speed: 0.0580s/iter; left time: 1161.6216s
	iters: 300, epoch: 2 | loss: 0.1994638
	speed: 0.0486s/iter; left time: 968.8529s
	iters: 400, epoch: 2 | loss: 0.0000435
	speed: 0.0475s/iter; left time: 942.6935s
Epoch: 2 cost time: 22.559722423553467
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.959980 --> -0.979990).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0004544
	speed: 0.1948s/iter; left time: 3842.1086s
	iters: 200, epoch: 3 | loss: 0.0356410
	speed: 0.0516s/iter; left time: 1012.9119s
	iters: 300, epoch: 3 | loss: 0.0174574
	speed: 0.0406s/iter; left time: 793.5179s
	iters: 400, epoch: 3 | loss: 0.0001338
	speed: 0.0386s/iter; left time: 749.4330s
Epoch: 3 cost time: 20.51566743850708
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0099912
	speed: 0.1535s/iter; left time: 2964.7580s
	iters: 200, epoch: 4 | loss: 0.0022357
	speed: 0.0459s/iter; left time: 881.4219s
	iters: 300, epoch: 4 | loss: 0.0078296
	speed: 0.0368s/iter; left time: 702.7527s
	iters: 400, epoch: 4 | loss: 0.7512412
	speed: 0.0397s/iter; left time: 754.5105s
Epoch: 4 cost time: 17.841085195541382
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.979990 --> -0.985447).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0003979
	speed: 0.1687s/iter; left time: 3188.1998s
	iters: 200, epoch: 5 | loss: 0.0000423
	speed: 0.0435s/iter; left time: 817.8564s
	iters: 300, epoch: 5 | loss: 0.0000003
	speed: 0.0415s/iter; left time: 776.8518s
	iters: 400, epoch: 5 | loss: 0.2451452
	speed: 0.0384s/iter; left time: 715.0979s
Epoch: 5 cost time: 18.076602935791016
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.985447 --> -0.985447).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.1683s/iter; left time: 3111.6638s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 847.1003s
	iters: 300, epoch: 6 | loss: 0.2322349
	speed: 0.0416s/iter; left time: 760.6611s
	iters: 400, epoch: 6 | loss: 0.0028181
	speed: 0.0367s/iter; left time: 667.0393s
Epoch: 6 cost time: 18.65124535560608
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000017
	speed: 0.1597s/iter; left time: 2887.1517s
	iters: 200, epoch: 7 | loss: 0.0000784
	speed: 0.0619s/iter; left time: 1111.7657s
	iters: 300, epoch: 7 | loss: 0.0000154
	speed: 0.0524s/iter; left time: 936.0127s
	iters: 400, epoch: 7 | loss: 0.0002487
	speed: 0.0537s/iter; left time: 954.8882s
Epoch: 7 cost time: 24.477948904037476
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.059 Vali Acc: 0.989 Test Loss: 0.059 Test Acc: 0.989
Validation loss decreased (-0.985447 --> -0.988631).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.1948s/iter; left time: 3439.6915s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 944.7277s
	iters: 300, epoch: 8 | loss: 0.0223816
	speed: 0.0469s/iter; left time: 819.0188s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0529s/iter; left time: 918.4334s
Epoch: 8 cost time: 22.892186641693115
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.188 Vali Acc: 0.977 Test Loss: 0.188 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000009
	speed: 0.1343s/iter; left time: 2316.6274s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 527.6369s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 596.2651s
	iters: 400, epoch: 9 | loss: 0.0020960
	speed: 0.0421s/iter; left time: 713.1337s
Epoch: 9 cost time: 15.441560745239258
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.986 Test Loss: 0.097 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1551s/iter; left time: 2610.7572s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 782.8371s
	iters: 300, epoch: 10 | loss: 0.0000110
	speed: 0.0422s/iter; left time: 702.4993s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 592.3153s
Epoch: 10 cost time: 18.096380472183228
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2677443
	speed: 0.1409s/iter; left time: 2313.3436s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 949.0053s
	iters: 300, epoch: 11 | loss: 0.0004889
	speed: 0.0445s/iter; left time: 721.9434s
	iters: 400, epoch: 11 | loss: 0.0001607
	speed: 0.0389s/iter; left time: 627.8061s
Epoch: 11 cost time: 19.15033507347107
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.249 Vali Acc: 0.981 Test Loss: 0.249 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1347s/iter; left time: 2155.5024s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 702.0869s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 516.7249s
	iters: 400, epoch: 12 | loss: 0.0000013
	speed: 0.0353s/iter; left time: 554.2193s
Epoch: 12 cost time: 15.159329652786255
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.982 Test Loss: 0.186 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1498s/iter; left time: 2335.5074s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 688.0142s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 583.4430s
	iters: 400, epoch: 13 | loss: 0.0331221
	speed: 0.0381s/iter; left time: 582.5739s
Epoch: 13 cost time: 17.916428089141846
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000023
	speed: 0.1413s/iter; left time: 2145.1444s
	iters: 200, epoch: 14 | loss: 0.0233971
	speed: 0.0404s/iter; left time: 609.9933s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 583.4014s
	iters: 400, epoch: 14 | loss: 0.0576747
	speed: 0.0402s/iter; left time: 597.6452s
Epoch: 14 cost time: 17.435079336166382
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.985 Test Loss: 0.162 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1345s/iter; left time: 1986.8774s
	iters: 200, epoch: 15 | loss: 0.4810625
	speed: 0.0312s/iter; left time: 457.7136s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0330s/iter; left time: 481.4686s
	iters: 400, epoch: 15 | loss: 0.0057292
	speed: 0.0337s/iter; left time: 487.8263s
Epoch: 15 cost time: 14.400384187698364
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.982 Test Loss: 0.175 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1713s/iter; left time: 2459.6770s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 532.0248s
	iters: 300, epoch: 16 | loss: 0.0009717
	speed: 0.0429s/iter; left time: 606.9671s
	iters: 400, epoch: 16 | loss: 0.0701730
	speed: 0.0453s/iter; left time: 636.5043s
Epoch: 16 cost time: 18.65251612663269
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.8854609
	speed: 0.1563s/iter; left time: 2179.1702s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.0494s/iter; left time: 683.3676s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 799.4748s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 481.3291s
Epoch: 17 cost time: 20.03646492958069
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.981 Test Loss: 0.243 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 29619466
model size : 127.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7005103
	speed: 0.0667s/iter; left time: 1370.1046s
	iters: 200, epoch: 1 | loss: 0.0250857
	speed: 0.0407s/iter; left time: 831.5870s
	iters: 300, epoch: 1 | loss: 0.2092022
	speed: 0.0367s/iter; left time: 747.3318s
	iters: 400, epoch: 1 | loss: 0.0902224
	speed: 0.0361s/iter; left time: 731.3251s
Epoch: 1 cost time: 18.68355941772461
Epoch: 1, Steps: 413 | Train Loss: 0.544 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0010492
	speed: 0.1462s/iter; left time: 2943.8930s
	iters: 200, epoch: 2 | loss: 0.0243979
	speed: 0.0473s/iter; left time: 947.3517s
	iters: 300, epoch: 2 | loss: 0.0005837
	speed: 0.0428s/iter; left time: 854.1040s
	iters: 400, epoch: 2 | loss: 0.2012014
	speed: 0.0417s/iter; left time: 826.7463s
Epoch: 2 cost time: 18.94196844100952
Epoch: 2, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
Validation loss decreased (-0.969531 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0109987
	speed: 0.1560s/iter; left time: 3077.3891s
	iters: 200, epoch: 3 | loss: 0.0436381
	speed: 0.0333s/iter; left time: 653.3108s
	iters: 300, epoch: 3 | loss: 0.1310988
	speed: 0.0334s/iter; left time: 652.0692s
	iters: 400, epoch: 3 | loss: 0.0000257
	speed: 0.0368s/iter; left time: 714.8255s
Epoch: 3 cost time: 15.502204895019531
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0208083
	speed: 0.1497s/iter; left time: 2891.7699s
	iters: 200, epoch: 4 | loss: 0.0185048
	speed: 0.0317s/iter; left time: 608.6980s
	iters: 300, epoch: 4 | loss: 0.0001390
	speed: 0.0316s/iter; left time: 603.7215s
	iters: 400, epoch: 4 | loss: 0.0016496
	speed: 0.0338s/iter; left time: 641.8622s
Epoch: 4 cost time: 14.351116180419922
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.972259 --> -0.981354).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0001250
	speed: 0.1425s/iter; left time: 2693.0364s
	iters: 200, epoch: 5 | loss: 0.0041719
	speed: 0.0379s/iter; left time: 712.1066s
	iters: 300, epoch: 5 | loss: 0.0002027
	speed: 0.0376s/iter; left time: 702.4073s
	iters: 400, epoch: 5 | loss: 0.0000861
	speed: 0.0379s/iter; left time: 705.2180s
Epoch: 5 cost time: 15.985808372497559
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0071535
	speed: 0.1362s/iter; left time: 2517.3626s
	iters: 200, epoch: 6 | loss: 0.0000200
	speed: 0.0301s/iter; left time: 553.7422s
	iters: 300, epoch: 6 | loss: 0.0000018
	speed: 0.0341s/iter; left time: 623.8310s
	iters: 400, epoch: 6 | loss: 0.0002661
	speed: 0.0394s/iter; left time: 716.4052s
Epoch: 6 cost time: 14.554007530212402
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001962
	speed: 0.1486s/iter; left time: 2686.4492s
	iters: 200, epoch: 7 | loss: 0.0000086
	speed: 0.0370s/iter; left time: 664.6191s
	iters: 300, epoch: 7 | loss: 0.0051650
	speed: 0.0377s/iter; left time: 674.3981s
	iters: 400, epoch: 7 | loss: 0.0000036
	speed: 0.0388s/iter; left time: 689.2710s
Epoch: 7 cost time: 16.02510142326355
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000102
	speed: 0.1500s/iter; left time: 2649.3957s
	iters: 200, epoch: 8 | loss: 0.0029115
	speed: 0.0469s/iter; left time: 824.3615s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.0485s/iter; left time: 847.5422s
	iters: 400, epoch: 8 | loss: 0.0482396
	speed: 0.0421s/iter; left time: 730.6525s
Epoch: 8 cost time: 19.22446608543396
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982719).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000004
	speed: 0.1546s/iter; left time: 2667.0081s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 752.0347s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.0456s/iter; left time: 776.6666s
	iters: 400, epoch: 9 | loss: 0.0020720
	speed: 0.0435s/iter; left time: 736.8852s
Epoch: 9 cost time: 18.030051469802856
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000057
	speed: 0.1430s/iter; left time: 2406.5227s
	iters: 200, epoch: 10 | loss: 0.0061496
	speed: 0.0350s/iter; left time: 585.7499s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 559.6603s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 552.2196s
Epoch: 10 cost time: 14.599100351333618
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.985 Test Loss: 0.144 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.984537).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1594s/iter; left time: 2618.0635s
	iters: 200, epoch: 11 | loss: 0.0000025
	speed: 0.0364s/iter; left time: 594.4981s
	iters: 300, epoch: 11 | loss: 0.0193253
	speed: 0.0312s/iter; left time: 505.4493s
	iters: 400, epoch: 11 | loss: 0.0004454
	speed: 0.0296s/iter; left time: 477.0028s
Epoch: 11 cost time: 14.95810604095459
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.988 Test Loss: 0.099 Test Acc: 0.988
Validation loss decreased (-0.984537 --> -0.987721).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000979
	speed: 0.1609s/iter; left time: 2575.5530s
	iters: 200, epoch: 12 | loss: 0.0000029
	speed: 0.0380s/iter; left time: 605.1571s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0370s/iter; left time: 585.5666s
	iters: 400, epoch: 12 | loss: 0.1420484
	speed: 0.0329s/iter; left time: 516.1029s
Epoch: 12 cost time: 15.93414831161499
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000014
	speed: 0.1359s/iter; left time: 2119.4465s
	iters: 200, epoch: 13 | loss: 0.0000012
	speed: 0.0280s/iter; left time: 434.0093s
	iters: 300, epoch: 13 | loss: 0.1208004
	speed: 0.0348s/iter; left time: 535.1103s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 607.3648s
Epoch: 13 cost time: 14.774797201156616
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1569s/iter; left time: 2382.0537s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 516.9993s
	iters: 300, epoch: 14 | loss: 0.0001142
	speed: 0.0341s/iter; left time: 511.5944s
	iters: 400, epoch: 14 | loss: 0.0000011
	speed: 0.0348s/iter; left time: 518.0639s
Epoch: 14 cost time: 15.364898920059204
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3213476
	speed: 0.1573s/iter; left time: 2323.6280s
	iters: 200, epoch: 15 | loss: 0.0000609
	speed: 0.0409s/iter; left time: 599.3200s
	iters: 300, epoch: 15 | loss: 0.0000006
	speed: 0.0424s/iter; left time: 617.4476s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 501.3368s
Epoch: 15 cost time: 17.46113610267639
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.982 Test Loss: 0.135 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000012
	speed: 0.1460s/iter; left time: 2095.4133s
	iters: 200, epoch: 16 | loss: 0.0000859
	speed: 0.0383s/iter; left time: 545.9580s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 567.9524s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0351s/iter; left time: 493.8728s
Epoch: 16 cost time: 15.945430517196655
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.279 Vali Acc: 0.974 Test Loss: 0.279 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1307s/iter; left time: 1822.9297s
	iters: 200, epoch: 17 | loss: 0.0021915
	speed: 0.0293s/iter; left time: 405.2240s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 440.2758s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 416.1180s
Epoch: 17 cost time: 13.439618349075317
Epoch: 17, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1467s/iter; left time: 1984.4678s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0350s/iter; left time: 470.6653s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 388.8780s
	iters: 400, epoch: 18 | loss: 0.0000006
	speed: 0.0309s/iter; left time: 408.6498s
Epoch: 18 cost time: 14.508586406707764
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.980 Test Loss: 0.196 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1237s/iter; left time: 1622.7436s
	iters: 200, epoch: 19 | loss: 0.5543609
	speed: 0.0353s/iter; left time: 459.7335s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 370.9721s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 361.5467s
Epoch: 19 cost time: 12.851961612701416
Epoch: 19, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.983 Test Loss: 0.183 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 1410.8452s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0287s/iter; left time: 361.5888s
	iters: 300, epoch: 20 | loss: 0.2891325
	speed: 0.0286s/iter; left time: 358.1033s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 351.9351s
Epoch: 20 cost time: 12.263370037078857
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 1365.6649s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 416.5176s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0337s/iter; left time: 407.8574s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0288s/iter; left time: 344.9340s
Epoch: 21 cost time: 13.538586854934692
Epoch: 21, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.980 Test Loss: 0.195 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 29536522
model size : 127.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2282589
	speed: 0.0897s/iter; left time: 1843.1951s
	iters: 200, epoch: 1 | loss: 0.0583386
	speed: 0.0803s/iter; left time: 1643.0396s
	iters: 300, epoch: 1 | loss: 0.0227167
	speed: 0.0888s/iter; left time: 1806.4349s
	iters: 400, epoch: 1 | loss: 0.6274979
	speed: 0.0849s/iter; left time: 1718.3431s
Epoch: 1 cost time: 35.18275475502014
Epoch: 1, Steps: 413 | Train Loss: 0.502 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (inf --> -0.955887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0959726
	speed: 0.1838s/iter; left time: 3701.8434s
	iters: 200, epoch: 2 | loss: 0.0959414
	speed: 0.0723s/iter; left time: 1448.1075s
	iters: 300, epoch: 2 | loss: 0.0178592
	speed: 0.0740s/iter; left time: 1476.0483s
	iters: 400, epoch: 2 | loss: 0.0810124
	speed: 0.0486s/iter; left time: 963.7278s
Epoch: 2 cost time: 26.459537029266357
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.955887 --> -0.980445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0052053
	speed: 0.1959s/iter; left time: 3864.4683s
	iters: 200, epoch: 3 | loss: 0.4409093
	speed: 0.0711s/iter; left time: 1396.3055s
	iters: 300, epoch: 3 | loss: 1.0704144
	speed: 0.0518s/iter; left time: 1010.9113s
	iters: 400, epoch: 3 | loss: 0.0147381
	speed: 0.0501s/iter; left time: 972.4570s
Epoch: 3 cost time: 26.406280755996704
Epoch: 3, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0034436
	speed: 0.1595s/iter; left time: 3081.1136s
	iters: 200, epoch: 4 | loss: 0.0057934
	speed: 0.0479s/iter; left time: 920.0486s
	iters: 300, epoch: 4 | loss: 1.2551414
	speed: 0.0434s/iter; left time: 828.6692s
	iters: 400, epoch: 4 | loss: 0.0000034
	speed: 0.0498s/iter; left time: 946.5853s
Epoch: 4 cost time: 21.001079559326172
Epoch: 4, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.237 Vali Acc: 0.980 Test Loss: 0.237 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3344485
	speed: 0.2046s/iter; left time: 3867.2785s
	iters: 200, epoch: 5 | loss: 0.0003120
	speed: 0.0650s/iter; left time: 1221.1891s
	iters: 300, epoch: 5 | loss: 0.0003029
	speed: 0.0652s/iter; left time: 1219.7131s
	iters: 400, epoch: 5 | loss: 0.0000320
	speed: 0.0622s/iter; left time: 1157.3487s
Epoch: 5 cost time: 28.03159189224243
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
Validation loss decreased (-0.980445 --> -0.986811).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0008452
	speed: 0.2104s/iter; left time: 3889.5101s
	iters: 200, epoch: 6 | loss: 0.0000002
	speed: 0.0573s/iter; left time: 1052.6336s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 1190.8175s
	iters: 400, epoch: 6 | loss: 0.0000766
	speed: 0.0695s/iter; left time: 1264.5124s
Epoch: 6 cost time: 27.11931300163269
Epoch: 6, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.192 Vali Acc: 0.977 Test Loss: 0.192 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3631316
	speed: 0.1635s/iter; left time: 2954.4029s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 845.0548s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 880.5008s
	iters: 400, epoch: 7 | loss: 0.6158091
	speed: 0.0769s/iter; left time: 1366.9290s
Epoch: 7 cost time: 23.04141402244568
Epoch: 7, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.986 Test Loss: 0.160 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0008216
	speed: 0.1632s/iter; left time: 2882.3243s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 763.9450s
	iters: 300, epoch: 8 | loss: 0.0115702
	speed: 0.0664s/iter; left time: 1159.0116s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0677s/iter; left time: 1174.7020s
Epoch: 8 cost time: 23.1219961643219
Epoch: 8, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.308 Vali Acc: 0.973 Test Loss: 0.308 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000007
	speed: 0.1760s/iter; left time: 3034.7043s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 1054.6452s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 1118.8618s
	iters: 400, epoch: 9 | loss: 0.1425327
	speed: 0.0671s/iter; left time: 1136.9201s
Epoch: 9 cost time: 25.990089178085327
Epoch: 9, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.202 Vali Acc: 0.978 Test Loss: 0.202 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1918s/iter; left time: 3229.3475s
	iters: 200, epoch: 10 | loss: 0.0000040
	speed: 0.0837s/iter; left time: 1401.0649s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0848s/iter; left time: 1411.2223s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 1086.0522s
Epoch: 10 cost time: 31.429826736450195
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.981 Test Loss: 0.208 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2212s/iter; left time: 3632.6302s
	iters: 200, epoch: 11 | loss: 1.4119831
	speed: 0.0729s/iter; left time: 1189.2591s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 990.1509s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 1048.0839s
Epoch: 11 cost time: 30.245940685272217
Epoch: 11, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.988 Test Loss: 0.109 Test Acc: 0.988
Validation loss decreased (-0.986811 --> -0.988175).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2001s/iter; left time: 3202.4726s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 850.1004s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 714.5146s
	iters: 400, epoch: 12 | loss: 0.0000009
	speed: 0.0631s/iter; left time: 991.0696s
Epoch: 12 cost time: 23.05807662010193
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.985 Test Loss: 0.164 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0927946
	speed: 0.1775s/iter; left time: 2767.8447s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 734.7249s
	iters: 300, epoch: 13 | loss: 0.0000172
	speed: 0.0424s/iter; left time: 652.0882s
	iters: 400, epoch: 13 | loss: 0.0000027
	speed: 0.0439s/iter; left time: 670.7786s
Epoch: 13 cost time: 19.143455743789673
Epoch: 13, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.136 Vali Acc: 0.984 Test Loss: 0.136 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1469s/iter; left time: 2230.4096s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 586.6307s
	iters: 300, epoch: 14 | loss: 0.1775524
	speed: 0.0397s/iter; left time: 594.3936s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 769.6862s
Epoch: 14 cost time: 18.242252111434937
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.986 Test Loss: 0.192 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.1750s/iter; left time: 2584.8131s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 864.4200s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 759.1152s
	iters: 400, epoch: 15 | loss: 0.0000026
	speed: 0.0612s/iter; left time: 886.1160s
Epoch: 15 cost time: 24.63686442375183
Epoch: 15, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.451 Vali Acc: 0.979 Test Loss: 0.451 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2147s/iter; left time: 3081.5928s
	iters: 200, epoch: 16 | loss: 0.0006431
	speed: 0.0579s/iter; left time: 825.7697s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0839s/iter; left time: 1187.5404s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1036.1528s
Epoch: 16 cost time: 28.712583541870117
Epoch: 16, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.356 Vali Acc: 0.979 Test Loss: 0.356 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1721s/iter; left time: 2399.2906s
	iters: 200, epoch: 17 | loss: 1.4734643
	speed: 0.0552s/iter; left time: 763.8967s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 881.5924s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 837.9724s
Epoch: 17 cost time: 24.641892433166504
Epoch: 17, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.365 Vali Acc: 0.978 Test Loss: 0.365 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1542s/iter; left time: 2085.7002s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 800.9401s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 946.8100s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 748.8924s
Epoch: 18 cost time: 23.985462427139282
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.329 Vali Acc: 0.984 Test Loss: 0.329 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1770s/iter; left time: 2321.5350s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 872.6320s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 758.9424s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0573s/iter; left time: 734.7949s
Epoch: 19 cost time: 25.51482319831848
Epoch: 19, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.339 Vali Acc: 0.985 Test Loss: 0.339 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2009s/iter; left time: 2551.7700s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 1000.8728s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 841.8714s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 735.2496s
Epoch: 20 cost time: 29.344568490982056
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.993 Test Loss: 0.095 Test Acc: 0.993
Validation loss decreased (-0.988175 --> -0.993178).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.7095878
	speed: 0.2303s/iter; left time: 2830.1551s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 727.1906s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 645.8742s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 563.8124s
Epoch: 21 cost time: 25.95602297782898
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.336 Vali Acc: 0.982 Test Loss: 0.336 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1866s/iter; left time: 2216.0462s
	iters: 200, epoch: 22 | loss: 0.3914841
	speed: 0.0437s/iter; left time: 515.1611s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 574.2466s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 786.1054s
Epoch: 22 cost time: 22.042858123779297
Epoch: 22, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.532 Vali Acc: 0.982 Test Loss: 0.532 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1633s/iter; left time: 1871.7734s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 635.4584s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 617.3803s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 653.6948s
Epoch: 23 cost time: 22.55763053894043
Epoch: 23, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.294 Vali Acc: 0.984 Test Loss: 0.294 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1644s/iter; left time: 1816.5891s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 491.5220s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 671.7939s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 859.3624s
Epoch: 24 cost time: 24.73992133140564
Epoch: 24, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.321 Vali Acc: 0.983 Test Loss: 0.321 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2090s/iter; left time: 2223.2105s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 941.8439s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 706.0881s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 616.2152s
Epoch: 25 cost time: 30.39048480987549
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.330 Vali Acc: 0.984 Test Loss: 0.330 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2158s/iter; left time: 2206.3335s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 704.4285s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 562.4823s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 469.3315s
Epoch: 26 cost time: 25.913169384002686
Epoch: 26, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.346 Vali Acc: 0.982 Test Loss: 0.346 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1890s/iter; left time: 1854.5980s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 477.2826s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 423.0390s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 463.6312s
Epoch: 27 cost time: 22.46751308441162
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.983 Test Loss: 0.469 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1847s/iter; left time: 1736.5524s
	iters: 200, epoch: 28 | loss: 0.0000075
	speed: 0.0443s/iter; left time: 411.9437s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 448.8376s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 513.4054s
Epoch: 28 cost time: 20.72463321685791
Epoch: 28, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.871 Vali Acc: 0.976 Test Loss: 0.871 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1393s/iter; left time: 1251.5664s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 326.6119s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 395.8161s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 477.5599s
Epoch: 29 cost time: 18.812397480010986
Epoch: 29, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.337 Vali Acc: 0.984 Test Loss: 0.337 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1979885
	speed: 0.1735s/iter; left time: 1487.9567s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 438.0265s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.0489s/iter; left time: 409.7004s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 423.6390s
Epoch: 30 cost time: 22.33344078063965
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.781 Vali Acc: 0.971 Test Loss: 0.781 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9931787175989086
model parameter : 29842954
model size : 128.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1411742
	speed: 0.0730s/iter; left time: 1499.8212s
	iters: 200, epoch: 1 | loss: 0.2979271
	speed: 0.0451s/iter; left time: 921.8173s
	iters: 300, epoch: 1 | loss: 0.5710266
	speed: 0.0502s/iter; left time: 1020.9954s
	iters: 400, epoch: 1 | loss: 0.0011598
	speed: 0.0517s/iter; left time: 1047.9318s
Epoch: 1 cost time: 22.798787832260132
Epoch: 1, Steps: 413 | Train Loss: 0.509 Vali Loss: 0.089 Vali Acc: 0.969 Test Loss: 0.089 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0245352
	speed: 0.1859s/iter; left time: 3742.9355s
	iters: 200, epoch: 2 | loss: 0.0004661
	speed: 0.0456s/iter; left time: 913.8151s
	iters: 300, epoch: 2 | loss: 0.0216141
	speed: 0.0439s/iter; left time: 875.4544s
	iters: 400, epoch: 2 | loss: 0.1222959
	speed: 0.0415s/iter; left time: 823.8101s
Epoch: 2 cost time: 19.902754545211792
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.969076 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000604
	speed: 0.1831s/iter; left time: 3612.0743s
	iters: 200, epoch: 3 | loss: 0.1072925
	speed: 0.0514s/iter; left time: 1008.7119s
	iters: 300, epoch: 3 | loss: 0.0000944
	speed: 0.0537s/iter; left time: 1048.8177s
	iters: 400, epoch: 3 | loss: 0.0147171
	speed: 0.0562s/iter; left time: 1091.3887s
Epoch: 3 cost time: 23.615289211273193
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.193 Vali Acc: 0.969 Test Loss: 0.193 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000048
	speed: 0.1625s/iter; left time: 3137.6163s
	iters: 200, epoch: 4 | loss: 0.0023584
	speed: 0.0578s/iter; left time: 1111.1527s
	iters: 300, epoch: 4 | loss: 0.0010559
	speed: 0.0596s/iter; left time: 1139.0188s
	iters: 400, epoch: 4 | loss: 0.0060170
	speed: 0.0698s/iter; left time: 1327.6421s
Epoch: 4 cost time: 24.63390350341797
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000075
	speed: 0.2034s/iter; left time: 3844.4727s
	iters: 200, epoch: 5 | loss: 0.0623764
	speed: 0.0541s/iter; left time: 1016.2374s
	iters: 300, epoch: 5 | loss: 0.0010154
	speed: 0.0539s/iter; left time: 1007.5618s
	iters: 400, epoch: 5 | loss: 0.0000358
	speed: 0.0499s/iter; left time: 927.8640s
Epoch: 5 cost time: 23.842013597488403
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.076 Vali Acc: 0.988 Test Loss: 0.076 Test Acc: 0.988
Validation loss decreased (-0.974078 --> -0.988176).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0047978
	speed: 0.1964s/iter; left time: 3630.7541s
	iters: 200, epoch: 6 | loss: 0.0002510
	speed: 0.0531s/iter; left time: 976.3678s
	iters: 300, epoch: 6 | loss: 0.3945876
	speed: 0.0678s/iter; left time: 1238.9853s
	iters: 400, epoch: 6 | loss: 0.0000138
	speed: 0.0705s/iter; left time: 1282.7622s
Epoch: 6 cost time: 26.623746156692505
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000319
	speed: 0.1955s/iter; left time: 3533.6029s
	iters: 200, epoch: 7 | loss: 0.0007154
	speed: 0.0548s/iter; left time: 985.1053s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 1222.7844s
	iters: 400, epoch: 7 | loss: 0.0000036
	speed: 0.0634s/iter; left time: 1127.4769s
Epoch: 7 cost time: 26.165561199188232
Epoch: 7, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.986 Test Loss: 0.085 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000027
	speed: 0.2119s/iter; left time: 3742.5198s
	iters: 200, epoch: 8 | loss: 0.0000356
	speed: 0.0651s/iter; left time: 1142.9395s
	iters: 300, epoch: 8 | loss: 0.0903846
	speed: 0.0555s/iter; left time: 969.3100s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0540s/iter; left time: 936.8402s
Epoch: 8 cost time: 26.114240884780884
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.081 Vali Acc: 0.986 Test Loss: 0.081 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0086010
	speed: 0.2147s/iter; left time: 3703.0958s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0871s/iter; left time: 1493.0463s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0855s/iter; left time: 1457.7704s
	iters: 400, epoch: 9 | loss: 0.0000542
	speed: 0.0798s/iter; left time: 1352.9570s
Epoch: 9 cost time: 35.15595984458923
Epoch: 9, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.984 Test Loss: 0.149 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2010s/iter; left time: 3383.2091s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 1060.2530s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 1296.2859s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0813s/iter; left time: 1344.8634s
Epoch: 10 cost time: 30.64532995223999
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2193s/iter; left time: 3601.6642s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 925.9250s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0634s/iter; left time: 1027.9562s
	iters: 400, epoch: 11 | loss: 0.0001025
	speed: 0.0562s/iter; left time: 905.6834s
Epoch: 11 cost time: 26.028899669647217
Epoch: 11, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.296 Vali Acc: 0.973 Test Loss: 0.296 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000011
	speed: 0.2055s/iter; left time: 3288.8629s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 1140.7215s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 1044.3659s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0659s/iter; left time: 1035.1628s
Epoch: 12 cost time: 29.257331132888794
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.092 Vali Acc: 0.989 Test Loss: 0.092 Test Acc: 0.989
Validation loss decreased (-0.988176 --> -0.988630).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2174s/iter; left time: 3389.9936s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 1076.8353s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 1092.4616s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 999.6145s
Epoch: 13 cost time: 28.87429428100586
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.979 Test Loss: 0.250 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000502
	speed: 0.2248s/iter; left time: 3413.6283s
	iters: 200, epoch: 14 | loss: 0.0000095
	speed: 0.0621s/iter; left time: 937.3405s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 1172.5588s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 1141.2284s
Epoch: 14 cost time: 31.196162939071655
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.067 Vali Acc: 0.990 Test Loss: 0.067 Test Acc: 0.990
Validation loss decreased (-0.988630 --> -0.990450).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2415s/iter; left time: 3567.0850s
	iters: 200, epoch: 15 | loss: 0.0000006
	speed: 0.0759s/iter; left time: 1113.3272s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 1167.0010s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 1248.7141s
Epoch: 15 cost time: 33.40168333053589
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.985 Test Loss: 0.155 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1915s/iter; left time: 2749.6550s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 876.1725s
	iters: 300, epoch: 16 | loss: 0.0000004
	speed: 0.0481s/iter; left time: 680.9392s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 969.2308s
Epoch: 16 cost time: 24.179852724075317
Epoch: 16, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.990 Test Loss: 0.082 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2064s/iter; left time: 2878.2841s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 958.1232s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 868.1988s
	iters: 400, epoch: 17 | loss: 0.0001487
	speed: 0.0579s/iter; left time: 789.6566s
Epoch: 17 cost time: 27.81137442588806
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.982 Test Loss: 0.169 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1698s/iter; left time: 2296.9584s
	iters: 200, epoch: 18 | loss: 0.0005201
	speed: 0.0800s/iter; left time: 1074.1002s
	iters: 300, epoch: 18 | loss: 0.0060108
	speed: 0.0511s/iter; left time: 680.6476s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 656.9849s
Epoch: 18 cost time: 23.653672695159912
Epoch: 18, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.112 Vali Acc: 0.988 Test Loss: 0.112 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000017
	speed: 0.1480s/iter; left time: 1940.9111s
	iters: 200, epoch: 19 | loss: 0.0000011
	speed: 0.0571s/iter; left time: 743.6203s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 736.9438s
	iters: 400, epoch: 19 | loss: 0.0000021
	speed: 0.0705s/iter; left time: 903.1470s
Epoch: 19 cost time: 24.459025144577026
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1632s/iter; left time: 2073.9136s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 555.7135s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 494.1788s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 640.2543s
Epoch: 20 cost time: 18.991762161254883
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.187 Vali Acc: 0.985 Test Loss: 0.187 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2109s/iter; left time: 2592.4381s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0744s/iter; left time: 906.7409s
	iters: 300, epoch: 21 | loss: 0.1477869
	speed: 0.0549s/iter; left time: 664.2212s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 712.6819s
Epoch: 21 cost time: 27.354910373687744
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.343 Vali Acc: 0.980 Test Loss: 0.343 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2026s/iter; left time: 2405.9805s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 943.8158s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0727s/iter; left time: 849.3283s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 809.2284s
Epoch: 22 cost time: 30.918225288391113
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.992 Test Loss: 0.179 Test Acc: 0.992
Validation loss decreased (-0.990450 --> -0.991813).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.2104s/iter; left time: 2412.3149s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 608.3779s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 597.4773s
	iters: 400, epoch: 23 | loss: 0.0003045
	speed: 0.0626s/iter; left time: 698.6029s
Epoch: 23 cost time: 24.83154535293579
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.990 Test Loss: 0.125 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1802s/iter; left time: 1991.8441s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 633.2219s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 648.2157s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 583.8321s
Epoch: 24 cost time: 24.296680212020874
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.985 Test Loss: 0.281 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1785s/iter; left time: 1898.9772s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 530.0127s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 639.4903s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0550s/iter; left time: 568.5879s
Epoch: 25 cost time: 23.706793546676636
Epoch: 25, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.172 Vali Acc: 0.990 Test Loss: 0.172 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1933s/iter; left time: 1976.2912s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 730.2736s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 676.0705s
	iters: 400, epoch: 26 | loss: 0.0008666
	speed: 0.0699s/iter; left time: 693.6597s
Epoch: 26 cost time: 29.49373984336853
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.269 Vali Acc: 0.984 Test Loss: 0.269 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1905s/iter; left time: 1869.2983s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 665.3891s
	iters: 300, epoch: 27 | loss: 0.1239009
	speed: 0.0717s/iter; left time: 689.3189s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0742s/iter; left time: 705.6008s
Epoch: 27 cost time: 28.857569694519043
Epoch: 27, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.590 Vali Acc: 0.971 Test Loss: 0.590 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2029s/iter; left time: 1907.0423s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 423.8683s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 400.1005s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 369.2644s
Epoch: 28 cost time: 20.869179248809814
Epoch: 28, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.985 Test Loss: 0.256 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1947s/iter; left time: 1750.2143s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 503.4542s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0607s/iter; left time: 533.3145s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 382.1364s
Epoch: 29 cost time: 24.33309817314148
Epoch: 29, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.236 Vali Acc: 0.985 Test Loss: 0.236 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1731s/iter; left time: 1484.0380s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 582.6523s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 575.9377s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 459.0727s
Epoch: 30 cost time: 26.690042734146118
Epoch: 30, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.988 Test Loss: 0.214 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1802s/iter; left time: 1470.4153s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 439.9692s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 623.8514s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 615.5850s
Epoch: 31 cost time: 28.510359525680542
Epoch: 31, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.336 Vali Acc: 0.983 Test Loss: 0.336 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1889s/iter; left time: 1463.2600s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 412.1215s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 400.4396s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 445.4225s
Epoch: 32 cost time: 24.06685495376587
Epoch: 32, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.987 Test Loss: 0.204 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 29649418
model size : 127.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5637636
	speed: 0.0731s/iter; left time: 1502.9922s
	iters: 200, epoch: 1 | loss: 0.2450600
	speed: 0.0389s/iter; left time: 796.0805s
	iters: 300, epoch: 1 | loss: 0.5142644
	speed: 0.0418s/iter; left time: 849.9588s
	iters: 400, epoch: 1 | loss: 0.1242441
	speed: 0.0454s/iter; left time: 918.7293s
Epoch: 1 cost time: 20.7234103679657
Epoch: 1, Steps: 413 | Train Loss: 0.554 Vali Loss: 0.151 Vali Acc: 0.952 Test Loss: 0.151 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0113111
	speed: 0.1612s/iter; left time: 3247.1943s
	iters: 200, epoch: 2 | loss: 0.0854063
	speed: 0.0418s/iter; left time: 838.1218s
	iters: 300, epoch: 2 | loss: 0.0004193
	speed: 0.0368s/iter; left time: 732.7898s
	iters: 400, epoch: 2 | loss: 0.0028165
	speed: 0.0380s/iter; left time: 753.7400s
Epoch: 2 cost time: 16.57332968711853
Epoch: 2, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.951795 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0004234
	speed: 0.1777s/iter; left time: 3504.8563s
	iters: 200, epoch: 3 | loss: 0.0004475
	speed: 0.0459s/iter; left time: 900.9222s
	iters: 300, epoch: 3 | loss: 0.1169192
	speed: 0.0417s/iter; left time: 814.8612s
	iters: 400, epoch: 3 | loss: 0.0078759
	speed: 0.0401s/iter; left time: 779.4628s
Epoch: 3 cost time: 18.361037254333496
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0573136
	speed: 0.1570s/iter; left time: 3031.4432s
	iters: 200, epoch: 4 | loss: 0.0163108
	speed: 0.0467s/iter; left time: 897.0318s
	iters: 300, epoch: 4 | loss: 0.0127929
	speed: 0.0464s/iter; left time: 886.0759s
	iters: 400, epoch: 4 | loss: 0.0011634
	speed: 0.0402s/iter; left time: 765.0149s
Epoch: 4 cost time: 18.963611364364624
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.970895 --> -0.975442).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000396
	speed: 0.1642s/iter; left time: 3103.3053s
	iters: 200, epoch: 5 | loss: 0.0005136
	speed: 0.0307s/iter; left time: 577.6684s
	iters: 300, epoch: 5 | loss: 0.0000495
	speed: 0.0299s/iter; left time: 558.9606s
	iters: 400, epoch: 5 | loss: 0.0001465
	speed: 0.0323s/iter; left time: 601.4983s
Epoch: 5 cost time: 13.557832717895508
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0007537
	speed: 0.1288s/iter; left time: 2381.5340s
	iters: 200, epoch: 6 | loss: 0.0003317
	speed: 0.0440s/iter; left time: 809.0667s
	iters: 300, epoch: 6 | loss: 0.0000033
	speed: 0.0424s/iter; left time: 774.8882s
	iters: 400, epoch: 6 | loss: 0.0021541
	speed: 0.0410s/iter; left time: 746.1884s
Epoch: 6 cost time: 16.87859082221985
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0119965
	speed: 0.1325s/iter; left time: 2395.3680s
	iters: 200, epoch: 7 | loss: 0.0000022
	speed: 0.0328s/iter; left time: 589.4264s
	iters: 300, epoch: 7 | loss: 0.0000318
	speed: 0.0282s/iter; left time: 503.1993s
	iters: 400, epoch: 7 | loss: 0.9436187
	speed: 0.0312s/iter; left time: 554.3614s
Epoch: 7 cost time: 13.719590425491333
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.967 Test Loss: 0.218 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1299s/iter; left time: 2293.5698s
	iters: 200, epoch: 8 | loss: 0.0017556
	speed: 0.0301s/iter; left time: 528.5349s
	iters: 300, epoch: 8 | loss: 0.4314167
	speed: 0.0329s/iter; left time: 574.9971s
	iters: 400, epoch: 8 | loss: 0.0007567
	speed: 0.0312s/iter; left time: 541.6662s
Epoch: 8 cost time: 13.52585744857788
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0022899
	speed: 0.1537s/iter; left time: 2650.7783s
	iters: 200, epoch: 9 | loss: 0.0000029
	speed: 0.0329s/iter; left time: 563.8325s
	iters: 300, epoch: 9 | loss: 0.1400209
	speed: 0.0377s/iter; left time: 642.4779s
	iters: 400, epoch: 9 | loss: 0.0000006
	speed: 0.0361s/iter; left time: 612.4726s
Epoch: 9 cost time: 15.604223012924194
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1235203
	speed: 0.1414s/iter; left time: 2380.2343s
	iters: 200, epoch: 10 | loss: 0.0006383
	speed: 0.0373s/iter; left time: 624.7043s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0389s/iter; left time: 647.7686s
	iters: 400, epoch: 10 | loss: 0.0001163
	speed: 0.0398s/iter; left time: 658.8234s
Epoch: 10 cost time: 16.754953622817993
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
Validation loss decreased (-0.975442 --> -0.978170).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000357
	speed: 0.1612s/iter; left time: 2647.2564s
	iters: 200, epoch: 11 | loss: 0.0000120
	speed: 0.0334s/iter; left time: 544.5367s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 713.3900s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 708.2186s
Epoch: 11 cost time: 17.26938223838806
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.978170 --> -0.979535).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002115
	speed: 0.1689s/iter; left time: 2703.0288s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.0380s/iter; left time: 604.3040s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 617.6686s
	iters: 400, epoch: 12 | loss: 0.0000285
	speed: 0.0383s/iter; left time: 602.1214s
Epoch: 12 cost time: 16.551512956619263
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
Validation loss decreased (-0.979535 --> -0.984537).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000013
	speed: 0.1618s/iter; left time: 2523.7448s
	iters: 200, epoch: 13 | loss: 0.0070959
	speed: 0.0361s/iter; left time: 558.8020s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 568.5743s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 574.0181s
Epoch: 13 cost time: 16.153727293014526
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.982 Test Loss: 0.131 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1395s/iter; left time: 2118.2292s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 656.9350s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 592.0034s
	iters: 400, epoch: 14 | loss: 0.0000125
	speed: 0.0393s/iter; left time: 585.4132s
Epoch: 14 cost time: 17.087270975112915
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.382 Vali Acc: 0.965 Test Loss: 0.382 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000300
	speed: 0.1440s/iter; left time: 2126.2412s
	iters: 200, epoch: 15 | loss: 0.0001847
	speed: 0.0331s/iter; left time: 485.9985s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0271s/iter; left time: 395.3438s
	iters: 400, epoch: 15 | loss: 0.0000006
	speed: 0.0388s/iter; left time: 560.7109s
Epoch: 15 cost time: 14.494571447372437
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.282 Vali Acc: 0.967 Test Loss: 0.282 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000050
	speed: 0.1462s/iter; left time: 2098.7230s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0335s/iter; left time: 477.8580s
	iters: 300, epoch: 16 | loss: 0.0035079
	speed: 0.0339s/iter; left time: 480.5714s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 465.0765s
Epoch: 16 cost time: 14.63013482093811
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.979 Test Loss: 0.146 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1554s/iter; left time: 2167.0660s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 590.8486s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 553.2838s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0413s/iter; left time: 563.4735s
Epoch: 17 cost time: 17.83499503135681
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1480s/iter; left time: 2002.7718s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 552.2578s
	iters: 300, epoch: 18 | loss: 0.0000294
	speed: 0.0413s/iter; left time: 551.0136s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 564.7587s
Epoch: 18 cost time: 17.702683687210083
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.315 Vali Acc: 0.970 Test Loss: 0.315 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0062402
	speed: 0.1516s/iter; left time: 1988.3932s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 537.2634s
	iters: 300, epoch: 19 | loss: 0.0014891
	speed: 0.0319s/iter; left time: 411.9625s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 470.4561s
Epoch: 19 cost time: 15.907191753387451
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.984 Test Loss: 0.149 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000002
	speed: 0.1426s/iter; left time: 1811.6162s
	iters: 200, epoch: 20 | loss: 0.0000006
	speed: 0.0361s/iter; left time: 454.4997s
	iters: 300, epoch: 20 | loss: 0.5255117
	speed: 0.0342s/iter; left time: 427.5412s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 435.8270s
Epoch: 20 cost time: 15.194242000579834
Epoch: 20, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.270 Vali Acc: 0.972 Test Loss: 0.270 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1414s/iter; left time: 1738.5458s
	iters: 200, epoch: 21 | loss: 0.0000033
	speed: 0.0399s/iter; left time: 486.5238s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 433.2094s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 448.2497s
Epoch: 21 cost time: 15.864959239959717
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.362 Vali Acc: 0.972 Test Loss: 0.362 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1382s/iter; left time: 1641.1780s
	iters: 200, epoch: 22 | loss: 0.0050280
	speed: 0.0352s/iter; left time: 414.9086s
	iters: 300, epoch: 22 | loss: 0.0002524
	speed: 0.0372s/iter; left time: 434.8159s
	iters: 400, epoch: 22 | loss: 0.0000006
	speed: 0.0363s/iter; left time: 420.8554s
Epoch: 22 cost time: 15.524970769882202
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 29548042
model size : 127.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3479256
	speed: 0.0923s/iter; left time: 1897.3097s
	iters: 200, epoch: 1 | loss: 0.3581938
	speed: 0.0653s/iter; left time: 1334.5815s
	iters: 300, epoch: 1 | loss: 0.0304692
	speed: 0.0658s/iter; left time: 1339.1070s
	iters: 400, epoch: 1 | loss: 0.0009308
	speed: 0.0622s/iter; left time: 1259.6670s
Epoch: 1 cost time: 29.594306707382202
Epoch: 1, Steps: 413 | Train Loss: 0.495 Vali Loss: 0.057 Vali Acc: 0.988 Test Loss: 0.057 Test Acc: 0.988
Validation loss decreased (inf --> -0.988176).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0358396
	speed: 0.1952s/iter; left time: 3931.8050s
	iters: 200, epoch: 2 | loss: 0.0371807
	speed: 0.0696s/iter; left time: 1395.3974s
	iters: 300, epoch: 2 | loss: 0.1559508
	speed: 0.0659s/iter; left time: 1314.4003s
	iters: 400, epoch: 2 | loss: 0.0000141
	speed: 0.0553s/iter; left time: 1096.9059s
Epoch: 2 cost time: 27.232724905014038
Epoch: 2, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0633553
	speed: 0.1696s/iter; left time: 3346.0414s
	iters: 200, epoch: 3 | loss: 0.0000121
	speed: 0.0554s/iter; left time: 1086.2941s
	iters: 300, epoch: 3 | loss: 0.0001942
	speed: 0.0546s/iter; left time: 1065.7180s
	iters: 400, epoch: 3 | loss: 1.2482413
	speed: 0.0569s/iter; left time: 1105.6816s
Epoch: 3 cost time: 24.076475858688354
Epoch: 3, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0004347
	speed: 0.1675s/iter; left time: 3234.6355s
	iters: 200, epoch: 4 | loss: 0.0072976
	speed: 0.0569s/iter; left time: 1092.2366s
	iters: 300, epoch: 4 | loss: 0.0000188
	speed: 0.0601s/iter; left time: 1149.1388s
	iters: 400, epoch: 4 | loss: 0.0000484
	speed: 0.0560s/iter; left time: 1065.0954s
Epoch: 4 cost time: 23.41685962677002
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.059 Vali Acc: 0.990 Test Loss: 0.059 Test Acc: 0.990
Validation loss decreased (-0.988176 --> -0.990450).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000436
	speed: 0.1718s/iter; left time: 3247.3935s
	iters: 200, epoch: 5 | loss: 0.0000286
	speed: 0.0663s/iter; left time: 1247.3040s
	iters: 300, epoch: 5 | loss: 0.0693809
	speed: 0.0681s/iter; left time: 1273.7149s
	iters: 400, epoch: 5 | loss: 0.0000055
	speed: 0.0681s/iter; left time: 1265.7100s
Epoch: 5 cost time: 25.890329122543335
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.987 Test Loss: 0.110 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000348
	speed: 0.1839s/iter; left time: 3398.7154s
	iters: 200, epoch: 6 | loss: 0.0000010
	speed: 0.0459s/iter; left time: 843.0859s
	iters: 300, epoch: 6 | loss: 0.0002193
	speed: 0.0664s/iter; left time: 1215.0795s
	iters: 400, epoch: 6 | loss: 0.0061458
	speed: 0.0632s/iter; left time: 1148.5279s
Epoch: 6 cost time: 24.759963512420654
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.089 Vali Acc: 0.988 Test Loss: 0.089 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000469
	speed: 0.1864s/iter; left time: 3367.9249s
	iters: 200, epoch: 7 | loss: 0.0000160
	speed: 0.0606s/iter; left time: 1088.3463s
	iters: 300, epoch: 7 | loss: 0.0000731
	speed: 0.0587s/iter; left time: 1048.7724s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0543s/iter; left time: 964.7290s
Epoch: 7 cost time: 24.921386003494263
Epoch: 7, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000005
	speed: 0.1629s/iter; left time: 2876.8722s
	iters: 200, epoch: 8 | loss: 0.0000002
	speed: 0.0590s/iter; left time: 1036.5746s
	iters: 300, epoch: 8 | loss: 0.0001617
	speed: 0.0513s/iter; left time: 895.1291s
	iters: 400, epoch: 8 | loss: 1.1671951
	speed: 0.0546s/iter; left time: 947.8265s
Epoch: 8 cost time: 22.894338607788086
Epoch: 8, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000006
	speed: 0.1613s/iter; left time: 2782.1690s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 913.8780s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 1009.6839s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 886.1850s
Epoch: 9 cost time: 23.365849018096924
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.988 Test Loss: 0.092 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000100
	speed: 0.1664s/iter; left time: 2801.4407s
	iters: 200, epoch: 10 | loss: 0.2285334
	speed: 0.0656s/iter; left time: 1097.3097s
	iters: 300, epoch: 10 | loss: 0.0000071
	speed: 0.0701s/iter; left time: 1165.8482s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0651s/iter; left time: 1077.0473s
Epoch: 10 cost time: 26.607993841171265
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.277 Vali Acc: 0.971 Test Loss: 0.277 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1883s/iter; left time: 3091.6456s
	iters: 200, epoch: 11 | loss: 0.0000009
	speed: 0.0629s/iter; left time: 1026.1737s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0627s/iter; left time: 1016.5783s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0663s/iter; left time: 1069.1220s
Epoch: 11 cost time: 27.19019317626953
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.979 Test Loss: 0.241 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000007
	speed: 0.1935s/iter; left time: 3097.1466s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 845.8998s
	iters: 300, epoch: 12 | loss: 0.0004721
	speed: 0.0552s/iter; left time: 872.3477s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 884.0745s
Epoch: 12 cost time: 24.50410008430481
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.983 Test Loss: 0.139 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0011908
	speed: 0.1799s/iter; left time: 2806.2880s
	iters: 200, epoch: 13 | loss: 0.0017176
	speed: 0.0553s/iter; left time: 856.6680s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 668.8179s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 833.3745s
Epoch: 13 cost time: 22.09055471420288
Epoch: 13, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.191 Vali Acc: 0.984 Test Loss: 0.191 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.1762s/iter; left time: 2674.9038s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 874.6317s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 788.6257s
	iters: 400, epoch: 14 | loss: 0.0000111
	speed: 0.0520s/iter; left time: 774.0039s
Epoch: 14 cost time: 23.489457368850708
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.987 Test Loss: 0.176 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 29743882
model size : 128.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2609152
	speed: 0.0837s/iter; left time: 1720.7509s
	iters: 200, epoch: 1 | loss: 0.3731563
	speed: 0.0627s/iter; left time: 1281.4205s
	iters: 300, epoch: 1 | loss: 0.0197961
	speed: 0.0596s/iter; left time: 1213.3579s
	iters: 400, epoch: 1 | loss: 0.2714430
	speed: 0.0633s/iter; left time: 1281.9815s
Epoch: 1 cost time: 27.86846423149109
Epoch: 1, Steps: 413 | Train Loss: 0.511 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2533544
	speed: 0.1808s/iter; left time: 3640.3313s
	iters: 200, epoch: 2 | loss: 0.0106538
	speed: 0.0537s/iter; left time: 1076.7129s
	iters: 300, epoch: 2 | loss: 0.2656194
	speed: 0.0590s/iter; left time: 1176.7912s
	iters: 400, epoch: 2 | loss: 0.0001946
	speed: 0.0477s/iter; left time: 947.0906s
Epoch: 2 cost time: 22.6862154006958
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0109946
	speed: 0.1448s/iter; left time: 2856.2024s
	iters: 200, epoch: 3 | loss: 0.0013793
	speed: 0.0294s/iter; left time: 577.3807s
	iters: 300, epoch: 3 | loss: 0.0988250
	speed: 0.0296s/iter; left time: 578.9139s
	iters: 400, epoch: 3 | loss: 0.2446687
	speed: 0.0364s/iter; left time: 706.4084s
Epoch: 3 cost time: 13.577127933502197
Epoch: 3, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.969076 --> -0.981809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2535658
	speed: 0.1421s/iter; left time: 2744.9642s
	iters: 200, epoch: 4 | loss: 0.0001516
	speed: 0.0411s/iter; left time: 788.7980s
	iters: 300, epoch: 4 | loss: 0.2873848
	speed: 0.0412s/iter; left time: 787.1795s
	iters: 400, epoch: 4 | loss: 0.2964908
	speed: 0.0424s/iter; left time: 806.6050s
Epoch: 4 cost time: 18.343097448349
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0031954
	speed: 0.1501s/iter; left time: 2837.6132s
	iters: 200, epoch: 5 | loss: 0.0002385
	speed: 0.0429s/iter; left time: 806.2922s
	iters: 300, epoch: 5 | loss: 0.0649113
	speed: 0.0400s/iter; left time: 747.8191s
	iters: 400, epoch: 5 | loss: 0.0000193
	speed: 0.0417s/iter; left time: 776.1492s
Epoch: 5 cost time: 18.383774757385254
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001047
	speed: 0.1586s/iter; left time: 2931.4827s
	iters: 200, epoch: 6 | loss: 0.0000721
	speed: 0.0602s/iter; left time: 1107.4599s
	iters: 300, epoch: 6 | loss: 0.0000008
	speed: 0.0541s/iter; left time: 988.9135s
	iters: 400, epoch: 6 | loss: 0.0001514
	speed: 0.0481s/iter; left time: 874.1423s
Epoch: 6 cost time: 23.815547704696655
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0043190
	speed: 0.1633s/iter; left time: 2951.1232s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0628s/iter; left time: 1128.9346s
	iters: 300, epoch: 7 | loss: 0.0000314
	speed: 0.0536s/iter; left time: 957.3778s
	iters: 400, epoch: 7 | loss: 0.0000027
	speed: 0.0519s/iter; left time: 923.2312s
Epoch: 7 cost time: 24.14985489845276
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000124
	speed: 0.1626s/iter; left time: 2871.8187s
	iters: 200, epoch: 8 | loss: 0.0000038
	speed: 0.0507s/iter; left time: 890.9660s
	iters: 300, epoch: 8 | loss: 0.0004985
	speed: 0.0434s/iter; left time: 758.2288s
	iters: 400, epoch: 8 | loss: 0.0000004
	speed: 0.0432s/iter; left time: 749.6942s
Epoch: 8 cost time: 20.117664098739624
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
Validation loss decreased (-0.981809 --> -0.985902).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0048981
	speed: 0.1574s/iter; left time: 2715.0133s
	iters: 200, epoch: 9 | loss: 0.0000017
	speed: 0.0457s/iter; left time: 783.1495s
	iters: 300, epoch: 9 | loss: 0.0000286
	speed: 0.0441s/iter; left time: 751.9474s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0448s/iter; left time: 759.2530s
Epoch: 9 cost time: 18.966851949691772
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.080 Vali Acc: 0.986 Test Loss: 0.080 Test Acc: 0.986
Validation loss decreased (-0.985902 --> -0.986357).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0014593
	speed: 0.1678s/iter; left time: 2823.9571s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0395s/iter; left time: 660.8558s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 660.4932s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0466s/iter; left time: 770.0092s
Epoch: 10 cost time: 18.347893476486206
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.985 Test Loss: 0.127 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1528s/iter; left time: 2508.4296s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 625.6564s
	iters: 300, epoch: 11 | loss: 0.0000881
	speed: 0.0518s/iter; left time: 840.9803s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 803.5644s
Epoch: 11 cost time: 19.930477619171143
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.360 Vali Acc: 0.973 Test Loss: 0.360 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1837s/iter; left time: 2941.2763s
	iters: 200, epoch: 12 | loss: 0.0462516
	speed: 0.0512s/iter; left time: 814.1491s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 816.2979s
	iters: 400, epoch: 12 | loss: 0.0000005
	speed: 0.0517s/iter; left time: 812.5835s
Epoch: 12 cost time: 22.604522705078125
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.984 Test Loss: 0.145 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000140
	speed: 0.1685s/iter; left time: 2627.9086s
	iters: 200, epoch: 13 | loss: 0.0011593
	speed: 0.0621s/iter; left time: 962.8814s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 713.2434s
	iters: 400, epoch: 13 | loss: 0.0000005
	speed: 0.0449s/iter; left time: 687.0556s
Epoch: 13 cost time: 22.495394945144653
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.986 Test Loss: 0.126 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0156158
	speed: 0.1581s/iter; left time: 2400.6872s
	iters: 200, epoch: 14 | loss: 0.0000145
	speed: 0.0491s/iter; left time: 740.7127s
	iters: 300, epoch: 14 | loss: 0.0317994
	speed: 0.0450s/iter; left time: 673.9632s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0390s/iter; left time: 580.4139s
Epoch: 14 cost time: 19.778846263885498
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.985 Test Loss: 0.139 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1098063
	speed: 0.1474s/iter; left time: 2176.4335s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 613.4579s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 704.4975s
	iters: 400, epoch: 15 | loss: 0.6388236
	speed: 0.0422s/iter; left time: 610.7901s
Epoch: 15 cost time: 18.405815601348877
Epoch: 15, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.293 Vali Acc: 0.976 Test Loss: 0.293 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000026
	speed: 0.1441s/iter; left time: 2068.9721s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 602.0390s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 554.8403s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 580.9534s
Epoch: 16 cost time: 17.815484285354614
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.985 Test Loss: 0.150 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1634s/iter; left time: 2278.6580s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 776.7611s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 646.8462s
	iters: 400, epoch: 17 | loss: 0.0032843
	speed: 0.0480s/iter; left time: 654.9007s
Epoch: 17 cost time: 21.963024854660034
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.987 Test Loss: 0.137 Test Acc: 0.987
Validation loss decreased (-0.986357 --> -0.986811).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1842s/iter; left time: 2492.0554s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 689.5248s
	iters: 300, epoch: 18 | loss: 0.0000020
	speed: 0.0474s/iter; left time: 631.5035s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 640.8816s
Epoch: 18 cost time: 21.751319408416748
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.986 Test Loss: 0.140 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1713s/iter; left time: 2247.2964s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 619.2937s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0427s/iter; left time: 552.1276s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 502.2867s
Epoch: 19 cost time: 19.941298484802246
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.991 Test Loss: 0.150 Test Acc: 0.991
Validation loss decreased (-0.986811 --> -0.990903).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1843s/iter; left time: 2341.3740s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 583.4406s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 607.6882s
	iters: 400, epoch: 20 | loss: 0.0000025
	speed: 0.0376s/iter; left time: 465.8854s
Epoch: 20 cost time: 19.085993766784668
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000049
	speed: 0.1436s/iter; left time: 1764.4237s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 562.0766s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0460s/iter; left time: 556.2323s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0461s/iter; left time: 552.4575s
Epoch: 21 cost time: 18.755547046661377
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.986 Test Loss: 0.109 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1412s/iter; left time: 1676.7714s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 570.7349s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 706.6608s
	iters: 400, epoch: 22 | loss: 0.0961560
	speed: 0.0622s/iter; left time: 720.0893s
Epoch: 22 cost time: 22.9454984664917
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.989 Test Loss: 0.115 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1522s/iter; left time: 1744.4574s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 551.2005s
	iters: 300, epoch: 23 | loss: 0.0026154
	speed: 0.0555s/iter; left time: 625.5664s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 631.5828s
Epoch: 23 cost time: 22.37527585029602
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.990 Test Loss: 0.109 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1758s/iter; left time: 1942.7424s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 468.7624s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 407.4462s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 397.9348s
Epoch: 24 cost time: 18.68067765235901
Epoch: 24, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.981 Test Loss: 0.253 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1598s/iter; left time: 1700.4630s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 476.6619s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 407.7588s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 446.1804s
Epoch: 25 cost time: 18.402575969696045
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.988 Test Loss: 0.169 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1430s/iter; left time: 1462.5730s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 411.8920s
	iters: 300, epoch: 26 | loss: 0.6323583
	speed: 0.0407s/iter; left time: 408.3825s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 531.0954s
Epoch: 26 cost time: 17.88752818107605
Epoch: 26, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.989 Test Loss: 0.143 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1266s/iter; left time: 1241.9252s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0299s/iter; left time: 290.3243s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 312.6768s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 325.1327s
Epoch: 27 cost time: 14.39132833480835
Epoch: 27, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.990 Test Loss: 0.145 Test Acc: 0.990
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1867s/iter; left time: 1754.8547s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 473.5554s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 560.2754s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 524.3094s
Epoch: 28 cost time: 24.83462929725647
Epoch: 28, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.989 Test Loss: 0.128 Test Acc: 0.989
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1860s/iter; left time: 1671.8578s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 610.1318s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 586.6395s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 454.9397s
Epoch: 29 cost time: 27.249683141708374
Epoch: 29, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.989 Test Loss: 0.155 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 29633290
model size : 127.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5036960
	speed: 0.0622s/iter; left time: 1277.7153s
	iters: 200, epoch: 1 | loss: 0.1985427
	speed: 0.0305s/iter; left time: 623.8313s
	iters: 300, epoch: 1 | loss: 0.2633737
	speed: 0.0397s/iter; left time: 808.0353s
	iters: 400, epoch: 1 | loss: 0.0783987
	speed: 0.0344s/iter; left time: 696.6041s
Epoch: 1 cost time: 17.22303605079651
Epoch: 1, Steps: 413 | Train Loss: 0.542 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0084017
	speed: 0.1094s/iter; left time: 2203.9391s
	iters: 200, epoch: 2 | loss: 0.3103648
	speed: 0.0341s/iter; left time: 682.7576s
	iters: 300, epoch: 2 | loss: 0.0399987
	speed: 0.0356s/iter; left time: 709.1245s
	iters: 400, epoch: 2 | loss: 0.2094131
	speed: 0.0363s/iter; left time: 721.0526s
Epoch: 2 cost time: 13.817075490951538
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.967257 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0074208
	speed: 0.1529s/iter; left time: 3015.5444s
	iters: 200, epoch: 3 | loss: 0.0034234
	speed: 0.0441s/iter; left time: 864.8813s
	iters: 300, epoch: 3 | loss: 0.0052729
	speed: 0.0457s/iter; left time: 892.5355s
	iters: 400, epoch: 3 | loss: 0.0250380
	speed: 0.0444s/iter; left time: 862.9866s
Epoch: 3 cost time: 18.216267108917236
Epoch: 3, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0172396
	speed: 0.1749s/iter; left time: 3377.0782s
	iters: 200, epoch: 4 | loss: 0.0028175
	speed: 0.0497s/iter; left time: 954.3352s
	iters: 300, epoch: 4 | loss: 0.0000879
	speed: 0.0500s/iter; left time: 955.1245s
	iters: 400, epoch: 4 | loss: 0.0406693
	speed: 0.0412s/iter; left time: 784.2016s
Epoch: 4 cost time: 19.955066919326782
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0945394
	speed: 0.1721s/iter; left time: 3252.4099s
	iters: 200, epoch: 5 | loss: 0.0000884
	speed: 0.0475s/iter; left time: 893.2610s
	iters: 300, epoch: 5 | loss: 0.0000104
	speed: 0.0377s/iter; left time: 704.4483s
	iters: 400, epoch: 5 | loss: 0.0077641
	speed: 0.0507s/iter; left time: 942.9167s
Epoch: 5 cost time: 19.389407634735107
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000473
	speed: 0.1821s/iter; left time: 3366.3637s
	iters: 200, epoch: 6 | loss: 0.0000099
	speed: 0.0463s/iter; left time: 851.2497s
	iters: 300, epoch: 6 | loss: 0.0002204
	speed: 0.0457s/iter; left time: 836.3625s
	iters: 400, epoch: 6 | loss: 0.0390270
	speed: 0.0475s/iter; left time: 864.6424s
Epoch: 6 cost time: 20.14069414138794
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000369
	speed: 0.1602s/iter; left time: 2894.3967s
	iters: 200, epoch: 7 | loss: 0.0000080
	speed: 0.0431s/iter; left time: 774.2185s
	iters: 300, epoch: 7 | loss: 0.0000004
	speed: 0.0478s/iter; left time: 853.5002s
	iters: 400, epoch: 7 | loss: 0.0000004
	speed: 0.0478s/iter; left time: 850.2773s
Epoch: 7 cost time: 18.803561210632324
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000148
	speed: 0.1593s/iter; left time: 2813.8423s
	iters: 200, epoch: 8 | loss: 0.0000207
	speed: 0.0391s/iter; left time: 686.6045s
	iters: 300, epoch: 8 | loss: 0.0000005
	speed: 0.0376s/iter; left time: 655.8401s
	iters: 400, epoch: 8 | loss: 0.0049896
	speed: 0.0393s/iter; left time: 682.1573s
Epoch: 8 cost time: 16.530473709106445
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000006
	speed: 0.1636s/iter; left time: 2822.2586s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0468s/iter; left time: 801.7714s
	iters: 300, epoch: 9 | loss: 0.0001657
	speed: 0.0466s/iter; left time: 793.8774s
	iters: 400, epoch: 9 | loss: 0.0009525
	speed: 0.0434s/iter; left time: 736.0920s
Epoch: 9 cost time: 19.500544548034668
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979535).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.1856s/iter; left time: 3123.8004s
	iters: 200, epoch: 10 | loss: 0.0030233
	speed: 0.0457s/iter; left time: 765.5350s
	iters: 300, epoch: 10 | loss: 0.0001353
	speed: 0.0465s/iter; left time: 774.1002s
	iters: 400, epoch: 10 | loss: 0.0001824
	speed: 0.0492s/iter; left time: 814.1846s
Epoch: 10 cost time: 19.795362949371338
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.981809).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1958s/iter; left time: 3215.7075s
	iters: 200, epoch: 11 | loss: 0.0022053
	speed: 0.0483s/iter; left time: 787.9226s
	iters: 300, epoch: 11 | loss: 0.0000194
	speed: 0.0462s/iter; left time: 748.6383s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 794.7597s
Epoch: 11 cost time: 20.46593976020813
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.973 Test Loss: 0.194 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0010151
	speed: 0.1722s/iter; left time: 2757.3585s
	iters: 200, epoch: 12 | loss: 0.0000270
	speed: 0.0490s/iter; left time: 779.6676s
	iters: 300, epoch: 12 | loss: 0.2484446
	speed: 0.0468s/iter; left time: 739.4971s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 780.4366s
Epoch: 12 cost time: 20.714250802993774
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.985447).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000072
	speed: 0.1690s/iter; left time: 2635.4412s
	iters: 200, epoch: 13 | loss: 0.0000081
	speed: 0.0460s/iter; left time: 713.2088s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 688.4794s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 673.2283s
Epoch: 13 cost time: 18.905494689941406
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000006
	speed: 0.1631s/iter; left time: 2476.2509s
	iters: 200, epoch: 14 | loss: 0.0000066
	speed: 0.0411s/iter; left time: 620.1415s
	iters: 300, epoch: 14 | loss: 0.0000009
	speed: 0.0392s/iter; left time: 586.9901s
	iters: 400, epoch: 14 | loss: 0.0000042
	speed: 0.0426s/iter; left time: 633.8545s
Epoch: 14 cost time: 17.75469446182251
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1526s/iter; left time: 2253.1262s
	iters: 200, epoch: 15 | loss: 0.0092518
	speed: 0.0437s/iter; left time: 641.6245s
	iters: 300, epoch: 15 | loss: 0.0000407
	speed: 0.0464s/iter; left time: 676.6038s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 686.2820s
Epoch: 15 cost time: 19.573261499404907
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.981 Test Loss: 0.164 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1592s/iter; left time: 2285.7592s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 648.5460s
	iters: 300, epoch: 16 | loss: 0.0000033
	speed: 0.0419s/iter; left time: 593.6780s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0425s/iter; left time: 598.0536s
Epoch: 16 cost time: 18.15630793571472
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.980 Test Loss: 0.190 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1617s/iter; left time: 2255.1579s
	iters: 200, epoch: 17 | loss: 0.0000166
	speed: 0.0419s/iter; left time: 580.6214s
	iters: 300, epoch: 17 | loss: 0.0004563
	speed: 0.0409s/iter; left time: 562.4076s
	iters: 400, epoch: 17 | loss: 1.1179993
	speed: 0.0403s/iter; left time: 549.3221s
Epoch: 17 cost time: 17.876133918762207
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.981 Test Loss: 0.156 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1426s/iter; left time: 1928.7707s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 632.8077s
	iters: 300, epoch: 18 | loss: 0.0000085
	speed: 0.0444s/iter; left time: 591.4709s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0491s/iter; left time: 649.9280s
Epoch: 18 cost time: 18.73207712173462
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.380 Vali Acc: 0.973 Test Loss: 0.380 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1818s/iter; left time: 2384.1602s
	iters: 200, epoch: 19 | loss: 1.5432057
	speed: 0.0544s/iter; left time: 707.9397s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 716.1721s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 646.0569s
Epoch: 19 cost time: 22.69615626335144
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.248 Vali Acc: 0.977 Test Loss: 0.248 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1826s/iter; left time: 2319.3185s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 662.1148s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 561.3095s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 571.0811s
Epoch: 20 cost time: 20.39475131034851
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.988 Test Loss: 0.162 Test Acc: 0.988
Validation loss decreased (-0.985447 --> -0.987720).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 2266.2447s
	iters: 200, epoch: 21 | loss: 0.0000481
	speed: 0.0439s/iter; left time: 535.4882s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 534.1968s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 496.2916s
Epoch: 21 cost time: 18.178266763687134
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.979 Test Loss: 0.262 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0071402
	speed: 0.1545s/iter; left time: 1835.2851s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 522.5211s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 480.5782s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 511.5811s
Epoch: 22 cost time: 18.67975401878357
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.298 Vali Acc: 0.980 Test Loss: 0.298 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1599s/iter; left time: 1833.6925s
	iters: 200, epoch: 23 | loss: 0.0000116
	speed: 0.0439s/iter; left time: 498.9985s
	iters: 300, epoch: 23 | loss: 0.0000063
	speed: 0.0453s/iter; left time: 510.1380s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 489.7156s
Epoch: 23 cost time: 18.50480628013611
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.487 Vali Acc: 0.966 Test Loss: 0.487 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1602s/iter; left time: 1770.5955s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 343.9183s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 390.0751s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.0378s/iter; left time: 406.2162s
Epoch: 24 cost time: 14.952844858169556
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.461 Vali Acc: 0.976 Test Loss: 0.461 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1348s/iter; left time: 1433.9586s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 435.9335s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 531.1047s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 512.9053s
Epoch: 25 cost time: 19.00442886352539
Epoch: 25, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.262 Vali Acc: 0.980 Test Loss: 0.262 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1638s/iter; left time: 1674.6679s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 406.6306s
	iters: 300, epoch: 26 | loss: 0.0000049
	speed: 0.0391s/iter; left time: 391.5198s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 398.8049s
Epoch: 26 cost time: 17.358906507492065
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.367 Vali Acc: 0.968 Test Loss: 0.367 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1550s/iter; left time: 1520.8111s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 419.3171s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 383.5576s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 395.2460s
Epoch: 27 cost time: 17.891980409622192
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.980 Test Loss: 0.257 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1498s/iter; left time: 1407.8435s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0391s/iter; left time: 363.7823s
	iters: 300, epoch: 28 | loss: 0.0000153
	speed: 0.0411s/iter; left time: 378.1115s
	iters: 400, epoch: 28 | loss: 0.0000062
	speed: 0.0402s/iter; left time: 366.1079s
Epoch: 28 cost time: 16.28636336326599
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.264 Vali Acc: 0.978 Test Loss: 0.264 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000110
	speed: 0.1505s/iter; left time: 1352.5479s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 371.2978s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 354.5224s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 296.0239s
Epoch: 29 cost time: 16.52585768699646
Epoch: 29, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.986 Test Loss: 0.193 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1596s/iter; left time: 1368.3517s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 388.2094s
	iters: 300, epoch: 30 | loss: 0.0001903
	speed: 0.0430s/iter; left time: 360.3309s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 331.1921s
Epoch: 30 cost time: 18.23919916152954
Epoch: 30, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.242 Vali Acc: 0.980 Test Loss: 0.242 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 29568778
model size : 127.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1607463
	speed: 0.0939s/iter; left time: 1929.2965s
	iters: 200, epoch: 1 | loss: 0.4319498
	speed: 0.0691s/iter; left time: 1412.3919s
	iters: 300, epoch: 1 | loss: 0.1682220
	speed: 0.0540s/iter; left time: 1099.2948s
	iters: 400, epoch: 1 | loss: 0.4103918
	speed: 0.0622s/iter; left time: 1259.0573s
Epoch: 1 cost time: 28.657488107681274
Epoch: 1, Steps: 413 | Train Loss: 0.482 Vali Loss: 0.039 Vali Acc: 0.986 Test Loss: 0.039 Test Acc: 0.986
Validation loss decreased (inf --> -0.986357).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0551292
	speed: 0.1985s/iter; left time: 3996.9590s
	iters: 200, epoch: 2 | loss: 0.0016319
	speed: 0.0640s/iter; left time: 1281.9647s
	iters: 300, epoch: 2 | loss: 0.0211806
	speed: 0.0643s/iter; left time: 1282.9349s
	iters: 400, epoch: 2 | loss: 0.0000391
	speed: 0.0543s/iter; left time: 1076.9857s
Epoch: 2 cost time: 26.23392605781555
Epoch: 2, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1809900
	speed: 0.1895s/iter; left time: 3737.9754s
	iters: 200, epoch: 3 | loss: 0.0031966
	speed: 0.0472s/iter; left time: 926.4693s
	iters: 300, epoch: 3 | loss: 0.0002979
	speed: 0.0607s/iter; left time: 1185.0656s
	iters: 400, epoch: 3 | loss: 0.0309687
	speed: 0.0492s/iter; left time: 955.9262s
Epoch: 3 cost time: 22.496575593948364
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5062121
	speed: 0.1560s/iter; left time: 3012.2975s
	iters: 200, epoch: 4 | loss: 0.0018535
	speed: 0.0474s/iter; left time: 909.8265s
	iters: 300, epoch: 4 | loss: 0.0053690
	speed: 0.0446s/iter; left time: 853.2610s
	iters: 400, epoch: 4 | loss: 0.0000073
	speed: 0.0474s/iter; left time: 901.3109s
Epoch: 4 cost time: 20.22395944595337
Epoch: 4, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0011728
	speed: 0.1756s/iter; left time: 3319.2030s
	iters: 200, epoch: 5 | loss: 0.0000127
	speed: 0.0741s/iter; left time: 1392.3334s
	iters: 300, epoch: 5 | loss: 0.0001327
	speed: 0.0735s/iter; left time: 1374.3217s
	iters: 400, epoch: 5 | loss: 0.0000012
	speed: 0.0719s/iter; left time: 1337.4341s
Epoch: 5 cost time: 30.016205310821533
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0004918
	speed: 0.1847s/iter; left time: 3414.5924s
	iters: 200, epoch: 6 | loss: 0.2018751
	speed: 0.0608s/iter; left time: 1118.2931s
	iters: 300, epoch: 6 | loss: 0.0007474
	speed: 0.0612s/iter; left time: 1118.5981s
	iters: 400, epoch: 6 | loss: 0.0000017
	speed: 0.0597s/iter; left time: 1085.3177s
Epoch: 6 cost time: 25.5191593170166
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000001
	speed: 0.1765s/iter; left time: 3189.2785s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 1060.4775s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0611s/iter; left time: 1091.4337s
	iters: 400, epoch: 7 | loss: 0.0000005
	speed: 0.0598s/iter; left time: 1062.2832s
Epoch: 7 cost time: 25.217490911483765
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.978 Test Loss: 0.229 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0743325
	speed: 0.1669s/iter; left time: 2947.3098s
	iters: 200, epoch: 8 | loss: 0.3362401
	speed: 0.0614s/iter; left time: 1078.3725s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 991.4435s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.0788s/iter; left time: 1368.7506s
Epoch: 8 cost time: 26.560171604156494
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2022s/iter; left time: 3486.9592s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 1103.2617s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 1248.2507s
	iters: 400, epoch: 9 | loss: 0.0004377
	speed: 0.0688s/iter; left time: 1165.3766s
Epoch: 9 cost time: 28.900153398513794
Epoch: 9, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.191 Vali Acc: 0.981 Test Loss: 0.191 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2011s/iter; left time: 3385.5867s
	iters: 200, epoch: 10 | loss: 0.0000128
	speed: 0.0630s/iter; left time: 1054.5122s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 880.5328s
	iters: 400, epoch: 10 | loss: 0.0000011
	speed: 0.0574s/iter; left time: 949.1089s
Epoch: 10 cost time: 25.585880756378174
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1759s/iter; left time: 2888.1201s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 969.9295s
	iters: 300, epoch: 11 | loss: 0.0537033
	speed: 0.0565s/iter; left time: 915.9461s
	iters: 400, epoch: 11 | loss: 0.0003852
	speed: 0.0538s/iter; left time: 867.8539s
Epoch: 11 cost time: 23.887688875198364
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.142 Vali Acc: 0.987 Test Loss: 0.142 Test Acc: 0.987
Validation loss decreased (-0.986357 --> -0.987266).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1869s/iter; left time: 2991.4987s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 904.6836s
	iters: 300, epoch: 12 | loss: 0.0000010
	speed: 0.0582s/iter; left time: 919.6863s
	iters: 400, epoch: 12 | loss: 0.0751879
	speed: 0.0662s/iter; left time: 1039.6964s
Epoch: 12 cost time: 24.777474641799927
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.987 Test Loss: 0.145 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1819s/iter; left time: 2837.2714s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 1080.0906s
	iters: 300, epoch: 13 | loss: 0.0000051
	speed: 0.0733s/iter; left time: 1127.9962s
	iters: 400, epoch: 13 | loss: 0.0000004
	speed: 0.0714s/iter; left time: 1092.6995s
Epoch: 13 cost time: 29.38082504272461
Epoch: 13, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.202 Vali Acc: 0.982 Test Loss: 0.202 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0002740
	speed: 0.1948s/iter; left time: 2957.3727s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 896.7181s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0639s/iter; left time: 957.0440s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 1075.6984s
Epoch: 14 cost time: 26.868765592575073
Epoch: 14, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.243 Vali Acc: 0.984 Test Loss: 0.243 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000011
	speed: 0.1816s/iter; left time: 2681.5705s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 724.2650s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 724.5432s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 662.9088s
Epoch: 15 cost time: 21.273641347885132
Epoch: 15, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.279 Vali Acc: 0.980 Test Loss: 0.279 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1811s/iter; left time: 2600.4039s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 900.3208s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 744.4072s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0474s/iter; left time: 666.7409s
Epoch: 16 cost time: 24.012258052825928
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.984 Test Loss: 0.170 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1819s/iter; left time: 2536.3488s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 895.8517s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0747s/iter; left time: 1026.0700s
	iters: 400, epoch: 17 | loss: 0.0780631
	speed: 0.0600s/iter; left time: 818.1736s
Epoch: 17 cost time: 28.07639217376709
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.318 Vali Acc: 0.982 Test Loss: 0.318 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2041s/iter; left time: 2761.8767s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0793s/iter; left time: 1065.4320s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0814s/iter; left time: 1084.7641s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 943.4249s
Epoch: 18 cost time: 32.055391788482666
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.428 Vali Acc: 0.979 Test Loss: 0.428 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0784555
	speed: 0.1907s/iter; left time: 2501.9984s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 674.0722s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 771.7889s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 520.7251s
Epoch: 19 cost time: 22.544589519500732
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.301 Vali Acc: 0.984 Test Loss: 0.301 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1348s/iter; left time: 1713.1199s
	iters: 200, epoch: 20 | loss: 0.4268467
	speed: 0.0481s/iter; left time: 606.0597s
	iters: 300, epoch: 20 | loss: 0.0000056
	speed: 0.0476s/iter; left time: 594.7514s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 533.0710s
Epoch: 20 cost time: 18.351153135299683
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.302 Vali Acc: 0.986 Test Loss: 0.302 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1367s/iter; left time: 1679.9091s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 489.8068s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 575.8821s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 697.7709s
Epoch: 21 cost time: 20.032882690429688
Epoch: 21, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.280 Vali Acc: 0.982 Test Loss: 0.280 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 29764618
model size : 128.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3847064
	speed: 0.0702s/iter; left time: 1441.7592s
	iters: 200, epoch: 1 | loss: 0.6882241
	speed: 0.0463s/iter; left time: 946.2061s
	iters: 300, epoch: 1 | loss: 0.0277186
	speed: 0.0561s/iter; left time: 1142.3025s
	iters: 400, epoch: 1 | loss: 0.1488231
	speed: 0.0661s/iter; left time: 1337.9734s
Epoch: 1 cost time: 24.9164457321167
Epoch: 1, Steps: 413 | Train Loss: 0.508 Vali Loss: 0.126 Vali Acc: 0.956 Test Loss: 0.126 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3179179
	speed: 0.1625s/iter; left time: 3272.8044s
	iters: 200, epoch: 2 | loss: 0.1881930
	speed: 0.0401s/iter; left time: 803.8346s
	iters: 300, epoch: 2 | loss: 0.1754969
	speed: 0.0385s/iter; left time: 767.1436s
	iters: 400, epoch: 2 | loss: 0.0120284
	speed: 0.0438s/iter; left time: 869.2687s
Epoch: 2 cost time: 17.02088165283203
Epoch: 2, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.046 Vali Acc: 0.984 Test Loss: 0.046 Test Acc: 0.984
Validation loss decreased (-0.955888 --> -0.983628).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0545714
	speed: 0.1481s/iter; left time: 2921.2856s
	iters: 200, epoch: 3 | loss: 0.1238360
	speed: 0.0289s/iter; left time: 567.3880s
	iters: 300, epoch: 3 | loss: 0.0020879
	speed: 0.0269s/iter; left time: 524.4082s
	iters: 400, epoch: 3 | loss: 0.0113034
	speed: 0.0305s/iter; left time: 593.0132s
Epoch: 3 cost time: 12.370589256286621
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0022793
	speed: 0.1113s/iter; left time: 2148.6555s
	iters: 200, epoch: 4 | loss: 0.0113383
	speed: 0.0304s/iter; left time: 584.7872s
	iters: 300, epoch: 4 | loss: 0.0005165
	speed: 0.0301s/iter; left time: 575.9400s
	iters: 400, epoch: 4 | loss: 0.0000073
	speed: 0.0269s/iter; left time: 511.9076s
Epoch: 4 cost time: 13.066266536712646
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000074
	speed: 0.1131s/iter; left time: 2138.0470s
	iters: 200, epoch: 5 | loss: 0.0084121
	speed: 0.0325s/iter; left time: 611.4332s
	iters: 300, epoch: 5 | loss: 0.0000146
	speed: 0.0515s/iter; left time: 963.2092s
	iters: 400, epoch: 5 | loss: 0.0001025
	speed: 0.0505s/iter; left time: 939.8674s
Epoch: 5 cost time: 18.22486186027527
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001211
	speed: 0.1418s/iter; left time: 2620.4611s
	iters: 200, epoch: 6 | loss: 0.0000005
	speed: 0.0586s/iter; left time: 1077.2749s
	iters: 300, epoch: 6 | loss: 0.0082000
	speed: 0.0647s/iter; left time: 1182.9928s
	iters: 400, epoch: 6 | loss: 0.0064441
	speed: 0.0539s/iter; left time: 979.4124s
Epoch: 6 cost time: 23.076011896133423
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984537).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000048
	speed: 0.1608s/iter; left time: 2906.1632s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 1039.8009s
	iters: 300, epoch: 7 | loss: 0.0000246
	speed: 0.0667s/iter; left time: 1191.3314s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 786.5986s
Epoch: 7 cost time: 22.194592237472534
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.985447).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1379s/iter; left time: 2435.7936s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 705.2417s
	iters: 300, epoch: 8 | loss: 0.1469198
	speed: 0.0541s/iter; left time: 943.9731s
	iters: 400, epoch: 8 | loss: 0.0108069
	speed: 0.0480s/iter; left time: 833.7597s
Epoch: 8 cost time: 18.60711669921875
Epoch: 8, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.1226s/iter; left time: 2114.5095s
	iters: 200, epoch: 9 | loss: 0.0000013
	speed: 0.0352s/iter; left time: 604.3875s
	iters: 300, epoch: 9 | loss: 0.0000029
	speed: 0.0524s/iter; left time: 893.2749s
	iters: 400, epoch: 9 | loss: 0.0000019
	speed: 0.0530s/iter; left time: 898.5851s
Epoch: 9 cost time: 18.43638277053833
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1234s/iter; left time: 2077.2965s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 586.9541s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0328s/iter; left time: 546.1401s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 884.5831s
Epoch: 10 cost time: 16.68048334121704
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.985 Test Loss: 0.122 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1504s/iter; left time: 2470.0357s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 796.3071s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0394s/iter; left time: 638.4983s
	iters: 400, epoch: 11 | loss: 0.0005153
	speed: 0.0622s/iter; left time: 1002.0634s
Epoch: 11 cost time: 20.675639390945435
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.137 Vali Acc: 0.984 Test Loss: 0.137 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000115
	speed: 0.1638s/iter; left time: 2622.8669s
	iters: 200, epoch: 12 | loss: 0.0000010
	speed: 0.0452s/iter; left time: 719.5417s
	iters: 300, epoch: 12 | loss: 0.0234801
	speed: 0.0458s/iter; left time: 724.5045s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 686.4643s
Epoch: 12 cost time: 19.958881855010986
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.980 Test Loss: 0.217 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0634877
	speed: 0.1477s/iter; left time: 2303.0657s
	iters: 200, epoch: 13 | loss: 0.0000011
	speed: 0.0373s/iter; left time: 578.1399s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0308s/iter; left time: 474.8699s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0343s/iter; left time: 524.2646s
Epoch: 13 cost time: 14.64498496055603
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.981 Test Loss: 0.182 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1403s/iter; left time: 2130.5218s
	iters: 200, epoch: 14 | loss: 0.0000006
	speed: 0.0392s/iter; left time: 591.7723s
	iters: 300, epoch: 14 | loss: 0.0000959
	speed: 0.0351s/iter; left time: 525.8578s
	iters: 400, epoch: 14 | loss: 0.0026849
	speed: 0.0298s/iter; left time: 443.0253s
Epoch: 14 cost time: 16.452263355255127
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.974 Test Loss: 0.220 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0002354
	speed: 0.1350s/iter; left time: 1993.5629s
	iters: 200, epoch: 15 | loss: 0.0024158
	speed: 0.0467s/iter; left time: 685.0155s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 571.0690s
	iters: 400, epoch: 15 | loss: 0.1742907
	speed: 0.0333s/iter; left time: 481.4645s
Epoch: 15 cost time: 18.047661542892456
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.986 Test Loss: 0.117 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.986356).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1353s/iter; left time: 1942.3883s
	iters: 200, epoch: 16 | loss: 0.0095892
	speed: 0.0382s/iter; left time: 545.2841s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0286s/iter; left time: 404.5266s
	iters: 400, epoch: 16 | loss: 0.0000422
	speed: 0.0336s/iter; left time: 472.8953s
Epoch: 16 cost time: 14.098067998886108
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.979 Test Loss: 0.231 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.1255s/iter; left time: 1749.8107s
	iters: 200, epoch: 17 | loss: 0.5504737
	speed: 0.0394s/iter; left time: 546.1003s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0313s/iter; left time: 429.7706s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0341s/iter; left time: 465.6703s
Epoch: 17 cost time: 15.384120225906372
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0031761
	speed: 0.1246s/iter; left time: 1685.5209s
	iters: 200, epoch: 18 | loss: 0.0000014
	speed: 0.0410s/iter; left time: 550.5950s
	iters: 300, epoch: 18 | loss: 0.0000039
	speed: 0.0335s/iter; left time: 447.1748s
	iters: 400, epoch: 18 | loss: 0.0533884
	speed: 0.0335s/iter; left time: 443.4066s
Epoch: 18 cost time: 15.932398796081543
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1139s/iter; left time: 1493.3762s
	iters: 200, epoch: 19 | loss: 0.0000328
	speed: 0.0322s/iter; left time: 419.6401s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0274s/iter; left time: 353.8080s
	iters: 400, epoch: 19 | loss: 0.0000051
	speed: 0.0294s/iter; left time: 376.6099s
Epoch: 19 cost time: 13.358204364776611
Epoch: 19, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.075 Vali Acc: 0.991 Test Loss: 0.075 Test Acc: 0.991
Validation loss decreased (-0.986356 --> -0.990904).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000088
	speed: 0.1610s/iter; left time: 2045.3028s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 568.7504s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 468.9186s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 455.0851s
Epoch: 20 cost time: 18.25803852081299
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.985 Test Loss: 0.208 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1428s/iter; left time: 1755.4991s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 648.2845s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 567.4766s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0403s/iter; left time: 483.1655s
Epoch: 21 cost time: 20.552008390426636
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.983 Test Loss: 0.215 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000004
	speed: 0.1376s/iter; left time: 1633.8553s
	iters: 200, epoch: 22 | loss: 0.0000216
	speed: 0.0564s/iter; left time: 664.3474s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 742.0303s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 667.2907s
Epoch: 22 cost time: 23.701299905776978
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.988 Test Loss: 0.156 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.1626s/iter; left time: 1864.5926s
	iters: 200, epoch: 23 | loss: 0.0000034
	speed: 0.0487s/iter; left time: 553.2833s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 512.7459s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 551.4327s
Epoch: 23 cost time: 20.786559581756592
Epoch: 23, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.987 Test Loss: 0.211 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2314637
	speed: 0.1757s/iter; left time: 1942.1244s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 513.4524s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 418.9716s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0317s/iter; left time: 340.4967s
Epoch: 24 cost time: 19.016350269317627
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.979 Test Loss: 0.222 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1471s/iter; left time: 1564.6011s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 555.4470s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 458.5293s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 464.9590s
Epoch: 25 cost time: 20.280710697174072
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.308 Vali Acc: 0.977 Test Loss: 0.308 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1346s/iter; left time: 1376.6426s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 417.2207s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 432.5252s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 454.4915s
Epoch: 26 cost time: 18.485917329788208
Epoch: 26, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.317 Vali Acc: 0.981 Test Loss: 0.317 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0122585
	speed: 0.1482s/iter; left time: 1454.3868s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 423.6939s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 406.9170s
	iters: 400, epoch: 27 | loss: 0.4764348
	speed: 0.0367s/iter; left time: 349.5614s
Epoch: 27 cost time: 17.434041023254395
Epoch: 27, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.991 Test Loss: 0.104 Test Acc: 0.991
Validation loss decreased (-0.990904 --> -0.991359).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000002
	speed: 0.1918s/iter; left time: 1802.8953s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 561.4351s
	iters: 300, epoch: 28 | loss: 0.0060238
	speed: 0.0552s/iter; left time: 507.6808s
	iters: 400, epoch: 28 | loss: 0.0000338
	speed: 0.0451s/iter; left time: 410.5419s
Epoch: 28 cost time: 23.856655836105347
Epoch: 28, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.991 Test Loss: 0.127 Test Acc: 0.991
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1743s/iter; left time: 1566.3090s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 577.8126s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 544.3516s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 360.9700s
Epoch: 29 cost time: 24.600723028182983
Epoch: 29, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.989 Test Loss: 0.109 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1430s/iter; left time: 1226.0947s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 356.7994s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 397.2754s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 386.4323s
Epoch: 30 cost time: 19.122394800186157
Epoch: 30, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.980 Test Loss: 0.291 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1435s/iter; left time: 1171.0974s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0400s/iter; left time: 322.3148s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 302.5891s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 355.3923s
Epoch: 31 cost time: 17.511154413223267
Epoch: 31, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.323 Vali Acc: 0.981 Test Loss: 0.323 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1593s/iter; left time: 1234.3948s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 313.6597s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0367s/iter; left time: 277.1322s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 293.4683s
Epoch: 32 cost time: 17.20796775817871
Epoch: 32, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.980 Test Loss: 0.447 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000730
	speed: 0.1728s/iter; left time: 1267.4946s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 438.1782s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 429.8901s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 306.5845s
Epoch: 33 cost time: 24.03022837638855
Epoch: 33, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.989 Test Loss: 0.188 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1649s/iter; left time: 1141.5926s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 419.5849s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 399.6863s
	iters: 400, epoch: 34 | loss: 0.0020232
	speed: 0.0546s/iter; left time: 361.5532s
Epoch: 34 cost time: 23.860394716262817
Epoch: 34, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.985 Test Loss: 0.206 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1525s/iter; left time: 992.5128s
	iters: 200, epoch: 35 | loss: 0.0202978
	speed: 0.0372s/iter; left time: 238.5852s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.0387s/iter; left time: 244.2299s
	iters: 400, epoch: 35 | loss: 0.0000003
	speed: 0.0505s/iter; left time: 313.7712s
Epoch: 35 cost time: 17.651580333709717
Epoch: 35, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.984 Test Loss: 0.184 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0132800
	speed: 0.1492s/iter; left time: 909.2990s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 232.8959s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 220.8977s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 235.6894s
Epoch: 36 cost time: 16.756535291671753
Epoch: 36, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.992 Test Loss: 0.105 Test Acc: 0.992
Validation loss decreased (-0.991359 --> -0.991813).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1675s/iter; left time: 952.1722s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 247.0096s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 233.0093s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 221.6925s
Epoch: 37 cost time: 18.83564066886902
Epoch: 37, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.990 Test Loss: 0.099 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1613s/iter; left time: 849.8845s
	iters: 200, epoch: 38 | loss: 0.2677675
	speed: 0.0635s/iter; left time: 328.5441s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 338.7885s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 284.2463s
Epoch: 38 cost time: 25.91944146156311
Epoch: 38, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.989 Test Loss: 0.208 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.1620s/iter; left time: 786.9180s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 279.9062s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 310.1693s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 288.9275s
Epoch: 39 cost time: 24.686509370803833
Epoch: 39, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.992 Test Loss: 0.133 Test Acc: 0.992
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.1558s/iter; left time: 692.5633s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 196.3281s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 185.5516s
	iters: 400, epoch: 40 | loss: 0.1205157
	speed: 0.0489s/iter; left time: 202.6111s
Epoch: 40 cost time: 18.399301528930664
Epoch: 40, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.989 Test Loss: 0.155 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.1519s/iter; left time: 612.3173s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 177.4355s
	iters: 300, epoch: 41 | loss: 0.0000232
	speed: 0.0401s/iter; left time: 153.5645s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0388s/iter; left time: 144.5784s
Epoch: 41 cost time: 17.328534603118896
Epoch: 41, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.180 Vali Acc: 0.989 Test Loss: 0.180 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.1676s/iter; left time: 606.4964s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 178.1587s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 137.2265s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 122.8240s
Epoch: 42 cost time: 18.867472171783447
Epoch: 42, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.1614s/iter; left time: 517.3313s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 214.4450s
	iters: 300, epoch: 43 | loss: 0.0248270
	speed: 0.0632s/iter; left time: 189.8298s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 157.9378s
Epoch: 43 cost time: 26.365337133407593
Epoch: 43, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.989 Test Loss: 0.191 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.1528s/iter; left time: 426.6859s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 84.9833s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 132.1266s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 122.0247s
Epoch: 44 cost time: 19.2811381816864
Epoch: 44, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.990 Test Loss: 0.127 Test Acc: 0.990
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.1860s/iter; left time: 442.4708s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 135.4097s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 109.6339s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 109.6763s
Epoch: 45 cost time: 23.576992511749268
Epoch: 45, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.259 Vali Acc: 0.987 Test Loss: 0.259 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.1772s/iter; left time: 348.2887s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 112.1667s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 104.0904s
	iters: 400, epoch: 46 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 99.9174s
Epoch: 46 cost time: 24.791734218597412
Epoch: 46, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.228 Vali Acc: 0.988 Test Loss: 0.228 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 29663242
model size : 127.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8247377
	speed: 0.0626s/iter; left time: 1285.9819s
	iters: 200, epoch: 1 | loss: 0.1228856
	speed: 0.0401s/iter; left time: 820.0847s
	iters: 300, epoch: 1 | loss: 0.0697668
	speed: 0.0385s/iter; left time: 784.5302s
	iters: 400, epoch: 1 | loss: 0.0253365
	speed: 0.0403s/iter; left time: 815.6602s
Epoch: 1 cost time: 18.762041807174683
Epoch: 1, Steps: 413 | Train Loss: 0.566 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (inf --> -0.974078).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1095652
	speed: 0.1448s/iter; left time: 2916.8045s
	iters: 200, epoch: 2 | loss: 0.1688890
	speed: 0.0364s/iter; left time: 729.3963s
	iters: 300, epoch: 2 | loss: 0.0118144
	speed: 0.0379s/iter; left time: 754.8831s
	iters: 400, epoch: 2 | loss: 0.0904119
	speed: 0.0335s/iter; left time: 664.5462s
Epoch: 2 cost time: 15.696597814559937
Epoch: 2, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0005091
	speed: 0.1371s/iter; left time: 2704.2422s
	iters: 200, epoch: 3 | loss: 0.0011569
	speed: 0.0412s/iter; left time: 807.8816s
	iters: 300, epoch: 3 | loss: 0.5462506
	speed: 0.0417s/iter; left time: 814.0674s
	iters: 400, epoch: 3 | loss: 0.7635631
	speed: 0.0420s/iter; left time: 814.9110s
Epoch: 3 cost time: 17.374265670776367
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0019068
	speed: 0.1292s/iter; left time: 2494.6472s
	iters: 200, epoch: 4 | loss: 0.0001079
	speed: 0.0298s/iter; left time: 572.5039s
	iters: 300, epoch: 4 | loss: 0.2663201
	speed: 0.0320s/iter; left time: 612.3588s
	iters: 400, epoch: 4 | loss: 0.0136325
	speed: 0.0309s/iter; left time: 586.8380s
Epoch: 4 cost time: 13.64645004272461
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.055 Vali Acc: 0.984 Test Loss: 0.055 Test Acc: 0.984
Validation loss decreased (-0.974078 --> -0.983628).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000136
	speed: 0.1268s/iter; left time: 2395.8397s
	iters: 200, epoch: 5 | loss: 0.0001317
	speed: 0.0357s/iter; left time: 670.8300s
	iters: 300, epoch: 5 | loss: 0.3124675
	speed: 0.0350s/iter; left time: 655.2204s
	iters: 400, epoch: 5 | loss: 0.0006027
	speed: 0.0356s/iter; left time: 662.3542s
Epoch: 5 cost time: 15.09189510345459
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0278224
	speed: 0.1199s/iter; left time: 2215.6392s
	iters: 200, epoch: 6 | loss: 0.0008253
	speed: 0.0328s/iter; left time: 602.3236s
	iters: 300, epoch: 6 | loss: 0.0000017
	speed: 0.0314s/iter; left time: 573.5364s
	iters: 400, epoch: 6 | loss: 0.0001998
	speed: 0.0305s/iter; left time: 555.3569s
Epoch: 6 cost time: 13.485140800476074
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0004919
	speed: 0.1219s/iter; left time: 2202.4081s
	iters: 200, epoch: 7 | loss: 0.0000346
	speed: 0.0362s/iter; left time: 649.9223s
	iters: 300, epoch: 7 | loss: 0.0000023
	speed: 0.0348s/iter; left time: 622.2972s
	iters: 400, epoch: 7 | loss: 0.0000007
	speed: 0.0349s/iter; left time: 619.4294s
Epoch: 7 cost time: 15.033414840698242
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0584380
	speed: 0.1251s/iter; left time: 2208.8162s
	iters: 200, epoch: 8 | loss: 0.0001110
	speed: 0.0390s/iter; left time: 684.3916s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0387s/iter; left time: 676.2321s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0324s/iter; left time: 561.8004s
Epoch: 8 cost time: 15.193965435028076
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000012
	speed: 0.1230s/iter; left time: 2121.8871s
	iters: 200, epoch: 9 | loss: 0.0000278
	speed: 0.0414s/iter; left time: 709.5566s
	iters: 300, epoch: 9 | loss: 0.0000006
	speed: 0.0417s/iter; left time: 711.5057s
	iters: 400, epoch: 9 | loss: 0.0000885
	speed: 0.0416s/iter; left time: 704.6040s
Epoch: 9 cost time: 16.32393169403076
Epoch: 9, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.963 Test Loss: 0.270 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5258733
	speed: 0.1379s/iter; left time: 2321.1354s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 643.1471s
	iters: 300, epoch: 10 | loss: 0.0000786
	speed: 0.0382s/iter; left time: 634.7494s
	iters: 400, epoch: 10 | loss: 0.0003175
	speed: 0.0335s/iter; left time: 554.4322s
Epoch: 10 cost time: 15.738033294677734
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.978 Test Loss: 0.177 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1267s/iter; left time: 2080.0684s
	iters: 200, epoch: 11 | loss: 0.0236282
	speed: 0.0317s/iter; left time: 516.7497s
	iters: 300, epoch: 11 | loss: 0.0000992
	speed: 0.0324s/iter; left time: 525.3118s
	iters: 400, epoch: 11 | loss: 0.0000301
	speed: 0.0351s/iter; left time: 566.5257s
Epoch: 11 cost time: 14.510443210601807
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000056
	speed: 0.1256s/iter; left time: 2011.1759s
	iters: 200, epoch: 12 | loss: 0.0001412
	speed: 0.0353s/iter; left time: 561.9137s
	iters: 300, epoch: 12 | loss: 0.0055135
	speed: 0.0327s/iter; left time: 516.4863s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 479.6947s
Epoch: 12 cost time: 14.056250810623169
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000149
	speed: 0.1219s/iter; left time: 1901.4343s
	iters: 200, epoch: 13 | loss: 0.0338338
	speed: 0.0341s/iter; left time: 528.7419s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0339s/iter; left time: 522.1245s
	iters: 400, epoch: 13 | loss: 0.0000006
	speed: 0.0290s/iter; left time: 444.1485s
Epoch: 13 cost time: 13.950209617614746
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000010
	speed: 0.1225s/iter; left time: 1859.5557s
	iters: 200, epoch: 14 | loss: 0.0128939
	speed: 0.0347s/iter; left time: 523.8322s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 476.7639s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0295s/iter; left time: 438.7792s
Epoch: 14 cost time: 13.796950817108154
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.978 Test Loss: 0.155 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 29589514
model size : 127.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6249756
	speed: 0.0853s/iter; left time: 1753.9535s
	iters: 200, epoch: 1 | loss: 1.4244123
	speed: 0.0545s/iter; left time: 1114.0705s
	iters: 300, epoch: 1 | loss: 0.0431576
	speed: 0.0570s/iter; left time: 1159.7884s
	iters: 400, epoch: 1 | loss: 0.0132620
	speed: 0.0509s/iter; left time: 1030.1442s
Epoch: 1 cost time: 25.56716752052307
Epoch: 1, Steps: 413 | Train Loss: 0.477 Vali Loss: 0.113 Vali Acc: 0.958 Test Loss: 0.113 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0228552
	speed: 0.1872s/iter; left time: 3769.0853s
	iters: 200, epoch: 2 | loss: 0.0002006
	speed: 0.0838s/iter; left time: 1678.5656s
	iters: 300, epoch: 2 | loss: 0.4760146
	speed: 0.0747s/iter; left time: 1488.8841s
	iters: 400, epoch: 2 | loss: 0.0004418
	speed: 0.0605s/iter; left time: 1200.7920s
Epoch: 2 cost time: 30.476829051971436
Epoch: 2, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (-0.957707 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0151174
	speed: 0.1871s/iter; left time: 3689.6866s
	iters: 200, epoch: 3 | loss: 0.1166868
	speed: 0.0653s/iter; left time: 1282.1245s
	iters: 300, epoch: 3 | loss: 0.0002017
	speed: 0.0694s/iter; left time: 1354.4909s
	iters: 400, epoch: 3 | loss: 0.0036300
	speed: 0.0686s/iter; left time: 1333.4895s
Epoch: 3 cost time: 26.851110696792603
Epoch: 3, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.966802 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000112
	speed: 0.1923s/iter; left time: 3714.5171s
	iters: 200, epoch: 4 | loss: 0.6550758
	speed: 0.0478s/iter; left time: 918.2672s
	iters: 300, epoch: 4 | loss: 0.7961583
	speed: 0.0661s/iter; left time: 1264.2130s
	iters: 400, epoch: 4 | loss: 0.0003916
	speed: 0.0695s/iter; left time: 1321.9063s
Epoch: 4 cost time: 25.234010696411133
Epoch: 4, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981354).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7613933
	speed: 0.1896s/iter; left time: 3584.0066s
	iters: 200, epoch: 5 | loss: 0.0000223
	speed: 0.0629s/iter; left time: 1183.1275s
	iters: 300, epoch: 5 | loss: 0.0001638
	speed: 0.0620s/iter; left time: 1160.0211s
	iters: 400, epoch: 5 | loss: 0.0000105
	speed: 0.0693s/iter; left time: 1288.5623s
Epoch: 5 cost time: 26.9008150100708
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.985447).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000013
	speed: 0.2301s/iter; left time: 4252.7617s
	iters: 200, epoch: 6 | loss: 0.2383159
	speed: 0.0666s/iter; left time: 1225.2764s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0647s/iter; left time: 1182.4662s
	iters: 400, epoch: 6 | loss: 0.0083756
	speed: 0.0540s/iter; left time: 981.2132s
Epoch: 6 cost time: 27.309454441070557
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1557460
	speed: 0.1977s/iter; left time: 3572.7350s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0644s/iter; left time: 1156.6680s
	iters: 300, epoch: 7 | loss: 0.1768696
	speed: 0.0652s/iter; left time: 1164.4659s
	iters: 400, epoch: 7 | loss: 0.0042757
	speed: 0.0499s/iter; left time: 887.6209s
Epoch: 7 cost time: 26.19796895980835
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000003
	speed: 0.1831s/iter; left time: 3233.8336s
	iters: 200, epoch: 8 | loss: 0.0000188
	speed: 0.0611s/iter; left time: 1072.2186s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0634s/iter; left time: 1107.3893s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 1041.9401s
Epoch: 8 cost time: 25.647388696670532
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.194 Vali Acc: 0.980 Test Loss: 0.194 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6116173
	speed: 0.1766s/iter; left time: 3046.4306s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 1039.4297s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0545s/iter; left time: 929.5837s
	iters: 400, epoch: 9 | loss: 0.0002365
	speed: 0.0573s/iter; left time: 971.8062s
Epoch: 9 cost time: 24.64738392829895
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.165 Vali Acc: 0.984 Test Loss: 0.165 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1969s/iter; left time: 3314.2636s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0580s/iter; left time: 970.7220s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 807.3370s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 871.9248s
Epoch: 10 cost time: 23.720855474472046
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.222 Vali Acc: 0.979 Test Loss: 0.222 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1194258
	speed: 0.1659s/iter; left time: 2723.7522s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 974.7335s
	iters: 300, epoch: 11 | loss: 0.0000198
	speed: 0.0507s/iter; left time: 822.3100s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0712s/iter; left time: 1148.5558s
Epoch: 11 cost time: 25.140361309051514
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.567 Vali Acc: 0.961 Test Loss: 0.567 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1808s/iter; left time: 2893.7490s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0754s/iter; left time: 1199.5894s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 1271.2028s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0808s/iter; left time: 1269.5951s
Epoch: 12 cost time: 30.358177185058594
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.981 Test Loss: 0.173 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0015696
	speed: 0.1985s/iter; left time: 3095.3146s
	iters: 200, epoch: 13 | loss: 1.1115580
	speed: 0.0646s/iter; left time: 1000.9832s
	iters: 300, epoch: 13 | loss: 0.0004831
	speed: 0.0626s/iter; left time: 963.8437s
	iters: 400, epoch: 13 | loss: 0.3450496
	speed: 0.0776s/iter; left time: 1186.4031s
Epoch: 13 cost time: 28.39067029953003
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0770051
	speed: 0.1916s/iter; left time: 2908.6957s
	iters: 200, epoch: 14 | loss: 0.0006124
	speed: 0.0554s/iter; left time: 835.0375s
	iters: 300, epoch: 14 | loss: 0.0088989
	speed: 0.0493s/iter; left time: 738.9928s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 858.7233s
Epoch: 14 cost time: 22.96048641204834
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1921s/iter; left time: 2837.7982s
	iters: 200, epoch: 15 | loss: 0.1158040
	speed: 0.0707s/iter; left time: 1036.9264s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 734.9368s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 754.3650s
Epoch: 15 cost time: 25.733700275421143
Epoch: 15, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 29794570
model size : 128.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3410032
	speed: 0.0684s/iter; left time: 1405.9905s
	iters: 200, epoch: 1 | loss: 0.2632711
	speed: 0.0419s/iter; left time: 857.0593s
	iters: 300, epoch: 1 | loss: 0.0616803
	speed: 0.0476s/iter; left time: 969.1811s
	iters: 400, epoch: 1 | loss: 0.0445657
	speed: 0.0466s/iter; left time: 942.8032s
Epoch: 1 cost time: 21.23250961303711
Epoch: 1, Steps: 413 | Train Loss: 0.515 Vali Loss: 0.090 Vali Acc: 0.967 Test Loss: 0.090 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0836719
	speed: 0.1736s/iter; left time: 3495.8235s
	iters: 200, epoch: 2 | loss: 0.0006875
	speed: 0.0468s/iter; left time: 938.6914s
	iters: 300, epoch: 2 | loss: 0.0001109
	speed: 0.0431s/iter; left time: 859.4230s
	iters: 400, epoch: 2 | loss: 0.0016565
	speed: 0.0431s/iter; left time: 854.9346s
Epoch: 2 cost time: 19.017895936965942
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0028012
	speed: 0.1569s/iter; left time: 3095.6186s
	iters: 200, epoch: 3 | loss: 0.0046561
	speed: 0.0418s/iter; left time: 820.6531s
	iters: 300, epoch: 3 | loss: 0.0151916
	speed: 0.0459s/iter; left time: 895.8776s
	iters: 400, epoch: 3 | loss: 0.6745531
	speed: 0.0434s/iter; left time: 842.8824s
Epoch: 3 cost time: 18.27951169013977
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0665780
	speed: 0.1561s/iter; left time: 3013.7184s
	iters: 200, epoch: 4 | loss: 0.0066435
	speed: 0.0384s/iter; left time: 737.2864s
	iters: 300, epoch: 4 | loss: 0.0066121
	speed: 0.0397s/iter; left time: 758.9168s
	iters: 400, epoch: 4 | loss: 0.0000835
	speed: 0.0407s/iter; left time: 773.4574s
Epoch: 4 cost time: 17.06518268585205
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.967257 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8526487
	speed: 0.1580s/iter; left time: 2986.2047s
	iters: 200, epoch: 5 | loss: 0.0001151
	speed: 0.0434s/iter; left time: 816.3822s
	iters: 300, epoch: 5 | loss: 0.0005729
	speed: 0.0403s/iter; left time: 753.5323s
	iters: 400, epoch: 5 | loss: 0.1362390
	speed: 0.0427s/iter; left time: 793.3577s
Epoch: 5 cost time: 17.564693689346313
Epoch: 5, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.294 Vali Acc: 0.955 Test Loss: 0.294 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0020772
	speed: 0.1447s/iter; left time: 2674.5747s
	iters: 200, epoch: 6 | loss: 0.0001209
	speed: 0.0452s/iter; left time: 831.7863s
	iters: 300, epoch: 6 | loss: 0.0249716
	speed: 0.0453s/iter; left time: 828.6824s
	iters: 400, epoch: 6 | loss: 0.1181152
	speed: 0.0422s/iter; left time: 768.2028s
Epoch: 6 cost time: 17.647884368896484
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
Validation loss decreased (-0.974533 --> -0.986357).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0006010
	speed: 0.1808s/iter; left time: 3268.3094s
	iters: 200, epoch: 7 | loss: 0.0003197
	speed: 0.0451s/iter; left time: 810.2633s
	iters: 300, epoch: 7 | loss: 0.0000177
	speed: 0.0472s/iter; left time: 844.2379s
	iters: 400, epoch: 7 | loss: 0.0004235
	speed: 0.0461s/iter; left time: 819.8390s
Epoch: 7 cost time: 19.735716819763184
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0238622
	speed: 0.1615s/iter; left time: 2851.5676s
	iters: 200, epoch: 8 | loss: 0.0000056
	speed: 0.0460s/iter; left time: 808.5652s
	iters: 300, epoch: 8 | loss: 0.0520619
	speed: 0.0478s/iter; left time: 835.3966s
	iters: 400, epoch: 8 | loss: 0.0025861
	speed: 0.0467s/iter; left time: 809.9704s
Epoch: 8 cost time: 19.49909543991089
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000016
	speed: 0.1707s/iter; left time: 2944.6035s
	iters: 200, epoch: 9 | loss: 0.0113086
	speed: 0.0438s/iter; left time: 750.9088s
	iters: 300, epoch: 9 | loss: 0.0000050
	speed: 0.0360s/iter; left time: 613.1066s
	iters: 400, epoch: 9 | loss: 0.0757469
	speed: 0.0418s/iter; left time: 708.5876s
Epoch: 9 cost time: 17.438926219940186
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 0.1602s/iter; left time: 2697.0737s
	iters: 200, epoch: 10 | loss: 0.0512019
	speed: 0.0444s/iter; left time: 742.4492s
	iters: 300, epoch: 10 | loss: 0.0000046
	speed: 0.0448s/iter; left time: 745.2765s
	iters: 400, epoch: 10 | loss: 0.1622470
	speed: 0.0407s/iter; left time: 673.4044s
Epoch: 10 cost time: 18.357359886169434
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000397
	speed: 0.1467s/iter; left time: 2408.5304s
	iters: 200, epoch: 11 | loss: 0.0050471
	speed: 0.0387s/iter; left time: 632.3406s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 596.7087s
	iters: 400, epoch: 11 | loss: 0.1694184
	speed: 0.0424s/iter; left time: 683.5272s
Epoch: 11 cost time: 16.818773984909058
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000277
	speed: 0.1272s/iter; left time: 2035.9621s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0273s/iter; left time: 433.7879s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0310s/iter; left time: 489.6735s
	iters: 400, epoch: 12 | loss: 0.0000195
	speed: 0.0250s/iter; left time: 393.1016s
Epoch: 12 cost time: 12.13133978843689
Epoch: 12, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.208 Vali Acc: 0.976 Test Loss: 0.208 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1187747
	speed: 0.1482s/iter; left time: 2311.1763s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0420s/iter; left time: 651.0832s
	iters: 300, epoch: 13 | loss: 0.0000067
	speed: 0.0436s/iter; left time: 671.2929s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0425s/iter; left time: 650.3312s
Epoch: 13 cost time: 18.432186603546143
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000195
	speed: 0.1552s/iter; left time: 2355.9325s
	iters: 200, epoch: 14 | loss: 0.0000012
	speed: 0.0433s/iter; left time: 653.5304s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 631.4422s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 625.5798s
Epoch: 14 cost time: 18.268717288970947
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.980 Test Loss: 0.203 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1610s/iter; left time: 2377.8454s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 544.8006s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 635.0048s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 516.5661s
Epoch: 15 cost time: 16.601995706558228
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.991 Test Loss: 0.074 Test Acc: 0.991
Validation loss decreased (-0.986357 --> -0.991359).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1573s/iter; left time: 2258.0458s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 554.8240s
	iters: 300, epoch: 16 | loss: 0.0006327
	speed: 0.0386s/iter; left time: 546.8981s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 533.8982s
Epoch: 16 cost time: 16.21908926963806
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.983 Test Loss: 0.177 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.1467s/iter; left time: 2046.0045s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0300s/iter; left time: 415.4045s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 503.6052s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 365.6010s
Epoch: 17 cost time: 13.866034746170044
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.987 Test Loss: 0.116 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1198s/iter; left time: 1621.4109s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0292s/iter; left time: 392.7794s
	iters: 300, epoch: 18 | loss: 0.0013023
	speed: 0.0282s/iter; left time: 375.8783s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0297s/iter; left time: 392.9646s
Epoch: 18 cost time: 12.655567169189453
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.202 Vali Acc: 0.981 Test Loss: 0.202 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 1543.7077s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0278s/iter; left time: 361.7426s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0316s/iter; left time: 407.7520s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 441.2139s
Epoch: 19 cost time: 12.887343883514404
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.195 Vali Acc: 0.980 Test Loss: 0.195 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1318s/iter; left time: 1673.8771s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.0423s/iter; left time: 533.0969s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 536.6904s
	iters: 400, epoch: 20 | loss: 0.0000106
	speed: 0.0416s/iter; left time: 515.6585s
Epoch: 20 cost time: 17.96083426475525
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.150 Vali Acc: 0.984 Test Loss: 0.150 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1419s/iter; left time: 1743.7848s
	iters: 200, epoch: 21 | loss: 0.0000115
	speed: 0.0402s/iter; left time: 489.6816s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0473s/iter; left time: 572.2905s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 516.0017s
Epoch: 21 cost time: 18.086182594299316
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1517s/iter; left time: 1801.9866s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 444.1616s
	iters: 300, epoch: 22 | loss: 0.0000087
	speed: 0.0385s/iter; left time: 449.3550s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 426.8944s
Epoch: 22 cost time: 15.782268047332764
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.986 Test Loss: 0.167 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1364s/iter; left time: 1563.5989s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 344.4966s
	iters: 300, epoch: 23 | loss: 0.0000010
	speed: 0.0322s/iter; left time: 363.0874s
	iters: 400, epoch: 23 | loss: 0.0000020
	speed: 0.0361s/iter; left time: 402.7765s
Epoch: 23 cost time: 14.616674661636353
Epoch: 23, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.984 Test Loss: 0.158 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0003005
	speed: 0.1462s/iter; left time: 1615.9787s
	iters: 200, epoch: 24 | loss: 0.0000079
	speed: 0.0396s/iter; left time: 434.0304s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0362s/iter; left time: 392.9573s
	iters: 400, epoch: 24 | loss: 0.0204773
	speed: 0.0356s/iter; left time: 383.1495s
Epoch: 24 cost time: 15.876488208770752
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.984 Test Loss: 0.195 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1360s/iter; left time: 1447.1799s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 394.1782s
	iters: 300, epoch: 25 | loss: 0.0682424
	speed: 0.0413s/iter; left time: 431.3640s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 395.6535s
Epoch: 25 cost time: 16.23393702507019
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.987 Test Loss: 0.166 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9913597089586176
model parameter : 29665546
model size : 127.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6621704
	speed: 0.0534s/iter; left time: 1098.1611s
	iters: 200, epoch: 1 | loss: 0.0459633
	speed: 0.0360s/iter; left time: 735.8675s
	iters: 300, epoch: 1 | loss: 0.1644297
	speed: 0.0336s/iter; left time: 683.5296s
	iters: 400, epoch: 1 | loss: 0.0451282
	speed: 0.0325s/iter; left time: 659.1594s
Epoch: 1 cost time: 16.1393780708313
Epoch: 1, Steps: 413 | Train Loss: 0.559 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2263207
	speed: 0.1360s/iter; left time: 2737.9585s
	iters: 200, epoch: 2 | loss: 0.1536618
	speed: 0.0344s/iter; left time: 688.7630s
	iters: 300, epoch: 2 | loss: 0.0058713
	speed: 0.0362s/iter; left time: 720.7772s
	iters: 400, epoch: 2 | loss: 0.0003559
	speed: 0.0352s/iter; left time: 697.5188s
Epoch: 2 cost time: 15.320461988449097
Epoch: 2, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.096 Vali Acc: 0.966 Test Loss: 0.096 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0005872
	speed: 0.1322s/iter; left time: 2607.0653s
	iters: 200, epoch: 3 | loss: 0.0004465
	speed: 0.0315s/iter; left time: 619.0903s
	iters: 300, epoch: 3 | loss: 0.0082873
	speed: 0.0333s/iter; left time: 649.7411s
	iters: 400, epoch: 3 | loss: 0.0000623
	speed: 0.0344s/iter; left time: 668.3956s
Epoch: 3 cost time: 14.497378587722778
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.972714 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000510
	speed: 0.1516s/iter; left time: 2927.5238s
	iters: 200, epoch: 4 | loss: 0.0192125
	speed: 0.0307s/iter; left time: 589.3414s
	iters: 300, epoch: 4 | loss: 0.1456185
	speed: 0.0343s/iter; left time: 656.0383s
	iters: 400, epoch: 4 | loss: 0.0000244
	speed: 0.0303s/iter; left time: 575.8350s
Epoch: 4 cost time: 13.450914859771729
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.964 Test Loss: 0.171 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000989
	speed: 0.1266s/iter; left time: 2393.1956s
	iters: 200, epoch: 5 | loss: 0.0000054
	speed: 0.0321s/iter; left time: 602.5367s
	iters: 300, epoch: 5 | loss: 0.0178544
	speed: 0.0345s/iter; left time: 644.4291s
	iters: 400, epoch: 5 | loss: 0.0017612
	speed: 0.0278s/iter; left time: 517.6571s
Epoch: 5 cost time: 13.777772426605225
Epoch: 5, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000019
	speed: 0.1325s/iter; left time: 2448.5228s
	iters: 200, epoch: 6 | loss: 0.0001689
	speed: 0.0342s/iter; left time: 629.0257s
	iters: 300, epoch: 6 | loss: 0.0004206
	speed: 0.0322s/iter; left time: 589.4488s
	iters: 400, epoch: 6 | loss: 0.0182894
	speed: 0.0338s/iter; left time: 613.8351s
Epoch: 6 cost time: 14.669254779815674
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.966 Test Loss: 0.173 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0026410
	speed: 0.1299s/iter; left time: 2348.4896s
	iters: 200, epoch: 7 | loss: 0.0010928
	speed: 0.0294s/iter; left time: 529.2400s
	iters: 300, epoch: 7 | loss: 0.2015408
	speed: 0.0322s/iter; left time: 575.4550s
	iters: 400, epoch: 7 | loss: 0.0002404
	speed: 0.0387s/iter; left time: 687.0660s
Epoch: 7 cost time: 14.18187165260315
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.324 Vali Acc: 0.955 Test Loss: 0.324 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002442
	speed: 0.1297s/iter; left time: 2290.3173s
	iters: 200, epoch: 8 | loss: 0.0005494
	speed: 0.0348s/iter; left time: 611.6654s
	iters: 300, epoch: 8 | loss: 0.0031792
	speed: 0.0311s/iter; left time: 542.8265s
	iters: 400, epoch: 8 | loss: 0.0000044
	speed: 0.0328s/iter; left time: 569.6441s
Epoch: 8 cost time: 14.011382579803467
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1346s/iter; left time: 2321.8329s
	iters: 200, epoch: 9 | loss: 0.1674761
	speed: 0.0355s/iter; left time: 609.0415s
	iters: 300, epoch: 9 | loss: 0.0002272
	speed: 0.0337s/iter; left time: 574.3323s
	iters: 400, epoch: 9 | loss: 0.0035125
	speed: 0.0342s/iter; left time: 580.3240s
Epoch: 9 cost time: 14.842478036880493
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1295s/iter; left time: 2180.2645s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.0285s/iter; left time: 476.2534s
	iters: 300, epoch: 10 | loss: 0.0002017
	speed: 0.0383s/iter; left time: 636.3234s
	iters: 400, epoch: 10 | loss: 0.0000006
	speed: 0.0355s/iter; left time: 586.2108s
Epoch: 10 cost time: 14.616615295410156
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000004
	speed: 0.1248s/iter; left time: 2049.6843s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0318s/iter; left time: 518.9484s
	iters: 300, epoch: 11 | loss: 0.0000190
	speed: 0.0304s/iter; left time: 493.4882s
	iters: 400, epoch: 11 | loss: 0.0000121
	speed: 0.0306s/iter; left time: 493.3721s
Epoch: 11 cost time: 13.48674726486206
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.976 Test Loss: 0.198 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.1257s/iter; left time: 2012.2327s
	iters: 200, epoch: 12 | loss: 0.0000126
	speed: 0.0273s/iter; left time: 433.5184s
	iters: 300, epoch: 12 | loss: 0.0000016
	speed: 0.0268s/iter; left time: 423.5503s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0280s/iter; left time: 440.5353s
Epoch: 12 cost time: 12.08380913734436
Epoch: 12, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.973 Test Loss: 0.237 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000156
	speed: 0.1117s/iter; left time: 1742.2229s
	iters: 200, epoch: 13 | loss: 0.0000038
	speed: 0.0263s/iter; left time: 407.4401s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0285s/iter; left time: 438.6238s
	iters: 400, epoch: 13 | loss: 0.0000025
	speed: 0.0289s/iter; left time: 442.4503s
Epoch: 13 cost time: 12.059236526489258
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.333 Vali Acc: 0.970 Test Loss: 0.333 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 29610250
model size : 127.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4886176
	speed: 0.1023s/iter; left time: 2101.7470s
	iters: 200, epoch: 1 | loss: 0.0869335
	speed: 0.0758s/iter; left time: 1550.8043s
	iters: 300, epoch: 1 | loss: 0.0216405
	speed: 0.0969s/iter; left time: 1972.5608s
	iters: 400, epoch: 1 | loss: 0.0083930
	speed: 0.0971s/iter; left time: 1966.7803s
Epoch: 1 cost time: 39.012649059295654
Epoch: 1, Steps: 413 | Train Loss: 0.486 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0420460
	speed: 0.3325s/iter; left time: 6695.4496s
	iters: 200, epoch: 2 | loss: 0.0113690
	speed: 0.1408s/iter; left time: 2821.4425s
	iters: 300, epoch: 2 | loss: 0.0002828
	speed: 0.1202s/iter; left time: 2396.5769s
	iters: 400, epoch: 2 | loss: 0.0166451
	speed: 0.1401s/iter; left time: 2780.0434s
Epoch: 2 cost time: 56.16420245170593
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
Validation loss decreased (-0.967712 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0103469
	speed: 0.3936s/iter; left time: 7764.5845s
	iters: 200, epoch: 3 | loss: 0.1060005
	speed: 0.1123s/iter; left time: 2203.6852s
	iters: 300, epoch: 3 | loss: 0.0002138
	speed: 0.1162s/iter; left time: 2268.8281s
	iters: 400, epoch: 3 | loss: 0.0031908
	speed: 0.1404s/iter; left time: 2726.3469s
Epoch: 3 cost time: 53.28016448020935
Epoch: 3, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000397
	speed: 0.2781s/iter; left time: 5370.1948s
	iters: 200, epoch: 4 | loss: 0.0000001
	speed: 0.0858s/iter; left time: 1647.4699s
	iters: 300, epoch: 4 | loss: 0.0024267
	speed: 0.0959s/iter; left time: 1833.3866s
	iters: 400, epoch: 4 | loss: 0.0000700
	speed: 0.1010s/iter; left time: 1920.4538s
Epoch: 4 cost time: 37.17895150184631
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.426 Vali Acc: 0.955 Test Loss: 0.426 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5600463
	speed: 0.3028s/iter; left time: 5722.8459s
	iters: 200, epoch: 5 | loss: 0.0621067
	speed: 0.0786s/iter; left time: 1476.7851s
	iters: 300, epoch: 5 | loss: 0.0000005
	speed: 0.0801s/iter; left time: 1497.1573s
	iters: 400, epoch: 5 | loss: 0.0017434
	speed: 0.1077s/iter; left time: 2002.9741s
Epoch: 5 cost time: 38.45692682266235
Epoch: 5, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.152 Vali Acc: 0.984 Test Loss: 0.152 Test Acc: 0.984
Validation loss decreased (-0.977716 --> -0.983627).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000081
	speed: 0.3070s/iter; left time: 5675.4520s
	iters: 200, epoch: 6 | loss: 0.0000001
	speed: 0.0937s/iter; left time: 1722.9696s
	iters: 300, epoch: 6 | loss: 0.0381321
	speed: 0.1096s/iter; left time: 2003.3659s
	iters: 400, epoch: 6 | loss: 0.0173503
	speed: 0.1197s/iter; left time: 2176.2298s
Epoch: 6 cost time: 42.29262900352478
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.988 Test Loss: 0.102 Test Acc: 0.988
Validation loss decreased (-0.983627 --> -0.988175).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000002
	speed: 0.3064s/iter; left time: 5537.0970s
	iters: 200, epoch: 7 | loss: 0.1929393
	speed: 0.0871s/iter; left time: 1564.8606s
	iters: 300, epoch: 7 | loss: 0.1148486
	speed: 0.0689s/iter; left time: 1231.5750s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0817s/iter; left time: 1452.3379s
Epoch: 7 cost time: 35.31420588493347
Epoch: 7, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000058
	speed: 0.2699s/iter; left time: 4765.5545s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0818s/iter; left time: 1436.9045s
	iters: 300, epoch: 8 | loss: 0.0000262
	speed: 0.0818s/iter; left time: 1427.5382s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0780s/iter; left time: 1354.8132s
Epoch: 8 cost time: 35.07525873184204
Epoch: 8, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.357 Vali Acc: 0.972 Test Loss: 0.357 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2264s/iter; left time: 3905.2490s
	iters: 200, epoch: 9 | loss: 0.0000006
	speed: 0.0904s/iter; left time: 1549.6472s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0915s/iter; left time: 1559.4789s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0775s/iter; left time: 1312.8013s
Epoch: 9 cost time: 35.34446358680725
Epoch: 9, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.199 Vali Acc: 0.986 Test Loss: 0.199 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2332s/iter; left time: 3925.2076s
	iters: 200, epoch: 10 | loss: 0.0252021
	speed: 0.0888s/iter; left time: 1486.3472s
	iters: 300, epoch: 10 | loss: 0.0000059
	speed: 0.1012s/iter; left time: 1683.3485s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1016s/iter; left time: 1680.4530s
Epoch: 10 cost time: 39.76857852935791
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3106s/iter; left time: 5100.3338s
	iters: 200, epoch: 11 | loss: 0.1393807
	speed: 0.1325s/iter; left time: 2162.7398s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1331s/iter; left time: 2159.1585s
	iters: 400, epoch: 11 | loss: 0.0000022
	speed: 0.1247s/iter; left time: 2009.5079s
Epoch: 11 cost time: 53.10264205932617
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.255 Vali Acc: 0.973 Test Loss: 0.255 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0007590
	speed: 0.3248s/iter; left time: 5199.6711s
	iters: 200, epoch: 12 | loss: 0.0000020
	speed: 0.0874s/iter; left time: 1390.1150s
	iters: 300, epoch: 12 | loss: 0.0037700
	speed: 0.0738s/iter; left time: 1166.1159s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 1172.3024s
Epoch: 12 cost time: 36.75156378746033
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.991 Test Loss: 0.101 Test Acc: 0.991
Validation loss decreased (-0.988175 --> -0.991359).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8801488
	speed: 0.2935s/iter; left time: 4577.1938s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0805s/iter; left time: 1246.8693s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 952.5975s
	iters: 400, epoch: 13 | loss: 0.0029702
	speed: 0.0704s/iter; left time: 1076.1066s
Epoch: 13 cost time: 31.22907066345215
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.987 Test Loss: 0.161 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2711s/iter; left time: 4116.1361s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 1114.9080s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 1038.4996s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 1050.7538s
Epoch: 14 cost time: 32.94941830635071
Epoch: 14, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.982 Test Loss: 0.199 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.3190s/iter; left time: 4710.6810s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1048s/iter; left time: 1536.6791s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1211s/iter; left time: 1764.0257s
	iters: 400, epoch: 15 | loss: 1.0217909
	speed: 0.1109s/iter; left time: 1604.0661s
Epoch: 15 cost time: 48.28657054901123
Epoch: 15, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.181 Vali Acc: 0.984 Test Loss: 0.181 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3315s/iter; left time: 4759.5506s
	iters: 200, epoch: 16 | loss: 0.0000030
	speed: 0.0922s/iter; left time: 1314.1772s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 1203.3928s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 1111.1971s
Epoch: 16 cost time: 39.878395318984985
Epoch: 16, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.351 Vali Acc: 0.979 Test Loss: 0.351 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3012s/iter; left time: 4200.0628s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 1312.7797s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1182s/iter; left time: 1624.1245s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1158s/iter; left time: 1580.1426s
Epoch: 17 cost time: 45.43856883049011
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.257 Vali Acc: 0.983 Test Loss: 0.257 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0027079
	speed: 0.2707s/iter; left time: 3662.7616s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 1359.9379s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1057s/iter; left time: 1409.6291s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1127s/iter; left time: 1491.0147s
Epoch: 18 cost time: 42.70585298538208
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.239 Vali Acc: 0.984 Test Loss: 0.239 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2206s/iter; left time: 2894.0248s
	iters: 200, epoch: 19 | loss: 0.2536805
	speed: 0.0508s/iter; left time: 661.8771s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 976.9050s
	iters: 400, epoch: 19 | loss: 1.2577384
	speed: 0.0873s/iter; left time: 1119.1346s
Epoch: 19 cost time: 29.502178192138672
Epoch: 19, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.416 Vali Acc: 0.982 Test Loss: 0.416 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 3796.7285s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1206s/iter; left time: 1520.3549s
	iters: 300, epoch: 20 | loss: 0.0000276
	speed: 0.1003s/iter; left time: 1254.1688s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1243s/iter; left time: 1541.3476s
Epoch: 20 cost time: 46.62511134147644
Epoch: 20, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.214 Vali Acc: 0.986 Test Loss: 0.214 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2832s/iter; left time: 3480.7863s
	iters: 200, epoch: 21 | loss: 0.0001739
	speed: 0.0844s/iter; left time: 1029.0185s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 967.9416s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0925s/iter; left time: 1109.3381s
Epoch: 21 cost time: 35.68552494049072
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.987 Test Loss: 0.201 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000022
	speed: 0.2561s/iter; left time: 3041.9022s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 863.5460s
	iters: 300, epoch: 22 | loss: 0.0000180
	speed: 0.0858s/iter; left time: 1001.9862s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 1046.4043s
Epoch: 22 cost time: 34.470783710479736
Epoch: 22, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.990 Test Loss: 0.143 Test Acc: 0.990
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9913597089586176
model parameter : 29824522
model size : 128.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6625193
	speed: 0.0589s/iter; left time: 1210.0343s
	iters: 200, epoch: 1 | loss: 0.0798881
	speed: 0.0384s/iter; left time: 785.3216s
	iters: 300, epoch: 1 | loss: 0.1852904
	speed: 0.0421s/iter; left time: 856.7755s
	iters: 400, epoch: 1 | loss: 0.0988853
	speed: 0.0406s/iter; left time: 822.2306s
Epoch: 1 cost time: 18.493483304977417
Epoch: 1, Steps: 413 | Train Loss: 0.506 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (inf --> -0.976352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0372462
	speed: 0.1568s/iter; left time: 3157.8253s
	iters: 200, epoch: 2 | loss: 0.0154690
	speed: 0.0435s/iter; left time: 871.1802s
	iters: 300, epoch: 2 | loss: 0.0006273
	speed: 0.0432s/iter; left time: 860.7465s
	iters: 400, epoch: 2 | loss: 0.0187853
	speed: 0.0444s/iter; left time: 881.5793s
Epoch: 2 cost time: 18.426961183547974
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
Validation loss decreased (-0.976352 --> -0.983628).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001094
	speed: 0.2240s/iter; left time: 4419.2770s
	iters: 200, epoch: 3 | loss: 0.7131935
	speed: 0.0514s/iter; left time: 1009.6393s
	iters: 300, epoch: 3 | loss: 0.0165065
	speed: 0.0494s/iter; left time: 964.2894s
	iters: 400, epoch: 3 | loss: 0.0014825
	speed: 0.0518s/iter; left time: 1006.7974s
Epoch: 3 cost time: 21.55414080619812
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000220
	speed: 0.1860s/iter; left time: 3592.4018s
	iters: 200, epoch: 4 | loss: 0.0000378
	speed: 0.0510s/iter; left time: 980.5219s
	iters: 300, epoch: 4 | loss: 0.0000161
	speed: 0.0501s/iter; left time: 958.0086s
	iters: 400, epoch: 4 | loss: 0.0003142
	speed: 0.0510s/iter; left time: 970.3347s
Epoch: 4 cost time: 21.42458462715149
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.964 Test Loss: 0.229 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000032
	speed: 0.1608s/iter; left time: 3039.7463s
	iters: 200, epoch: 5 | loss: 0.0017223
	speed: 0.0503s/iter; left time: 945.1966s
	iters: 300, epoch: 5 | loss: 0.0000296
	speed: 0.0579s/iter; left time: 1081.7484s
	iters: 400, epoch: 5 | loss: 0.0062574
	speed: 0.0611s/iter; left time: 1136.8916s
Epoch: 5 cost time: 22.287230730056763
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2718327
	speed: 0.1946s/iter; left time: 3597.5198s
	iters: 200, epoch: 6 | loss: 0.0000011
	speed: 0.0707s/iter; left time: 1300.4931s
	iters: 300, epoch: 6 | loss: 0.0000054
	speed: 0.0541s/iter; left time: 988.3763s
	iters: 400, epoch: 6 | loss: 0.0006389
	speed: 0.0517s/iter; left time: 939.9802s
Epoch: 6 cost time: 24.56085228919983
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.389 Vali Acc: 0.964 Test Loss: 0.389 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000897
	speed: 0.2040s/iter; left time: 3686.7184s
	iters: 200, epoch: 7 | loss: 0.0000008
	speed: 0.0600s/iter; left time: 1078.5584s
	iters: 300, epoch: 7 | loss: 0.0003130
	speed: 0.0546s/iter; left time: 975.1866s
	iters: 400, epoch: 7 | loss: 0.0002182
	speed: 0.0625s/iter; left time: 1111.5260s
Epoch: 7 cost time: 25.089269161224365
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984537).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.2059s/iter; left time: 3635.6025s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 908.3295s
	iters: 300, epoch: 8 | loss: 0.0000005
	speed: 0.0481s/iter; left time: 839.6234s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.0642s/iter; left time: 1114.7486s
Epoch: 8 cost time: 22.67308759689331
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.239 Vali Acc: 0.973 Test Loss: 0.239 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000015
	speed: 0.2144s/iter; left time: 3698.0991s
	iters: 200, epoch: 9 | loss: 0.0000090
	speed: 0.0488s/iter; left time: 837.4423s
	iters: 300, epoch: 9 | loss: 0.1547327
	speed: 0.0504s/iter; left time: 859.0111s
	iters: 400, epoch: 9 | loss: 0.0000001
	speed: 0.0460s/iter; left time: 780.3118s
Epoch: 9 cost time: 20.73822546005249
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0204114
	speed: 0.2017s/iter; left time: 3396.0770s
	iters: 200, epoch: 10 | loss: 0.0000059
	speed: 0.0550s/iter; left time: 919.6900s
	iters: 300, epoch: 10 | loss: 0.0000034
	speed: 0.0505s/iter; left time: 839.6314s
	iters: 400, epoch: 10 | loss: 0.0000004
	speed: 0.0539s/iter; left time: 891.5564s
Epoch: 10 cost time: 22.465051651000977
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0228137
	speed: 0.1482s/iter; left time: 2432.8548s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0491s/iter; left time: 801.2324s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0445s/iter; left time: 722.2685s
	iters: 400, epoch: 11 | loss: 0.0000009
	speed: 0.0458s/iter; left time: 738.3005s
Epoch: 11 cost time: 19.26646113395691
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.986 Test Loss: 0.112 Test Acc: 0.986
Validation loss decreased (-0.984537 --> -0.986356).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000005
	speed: 0.2126s/iter; left time: 3403.4646s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 830.4333s
	iters: 300, epoch: 12 | loss: 0.0000041
	speed: 0.0626s/iter; left time: 990.0338s
	iters: 400, epoch: 12 | loss: 0.0000361
	speed: 0.0598s/iter; left time: 939.8384s
Epoch: 12 cost time: 24.312231063842773
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.341 Vali Acc: 0.970 Test Loss: 0.341 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1978s/iter; left time: 3084.5127s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 746.8652s
	iters: 300, epoch: 13 | loss: 0.0000007
	speed: 0.0458s/iter; left time: 705.5148s
	iters: 400, epoch: 13 | loss: 0.0003072
	speed: 0.0498s/iter; left time: 761.4621s
Epoch: 13 cost time: 20.247710704803467
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.249 Vali Acc: 0.976 Test Loss: 0.249 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1453096
	speed: 0.2028s/iter; left time: 3078.4503s
	iters: 200, epoch: 14 | loss: 0.3872382
	speed: 0.0568s/iter; left time: 856.4428s
	iters: 300, epoch: 14 | loss: 0.0000024
	speed: 0.0583s/iter; left time: 873.4184s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 685.7816s
Epoch: 14 cost time: 22.407360076904297
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.986 Test Loss: 0.089 Test Acc: 0.986
Validation loss decreased (-0.986356 --> -0.986357).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000091
	speed: 0.2527s/iter; left time: 3731.7697s
	iters: 200, epoch: 15 | loss: 0.0000011
	speed: 0.0696s/iter; left time: 1021.6750s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 1151.0151s
	iters: 400, epoch: 15 | loss: 0.0000037
	speed: 0.0677s/iter; left time: 979.7641s
Epoch: 15 cost time: 28.92125964164734
Epoch: 15, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000010
	speed: 0.2607s/iter; left time: 3742.5869s
	iters: 200, epoch: 16 | loss: 0.0758349
	speed: 0.0752s/iter; left time: 1071.6631s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 1127.6083s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0780s/iter; left time: 1095.8066s
Epoch: 16 cost time: 32.67810249328613
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000009
	speed: 0.2437s/iter; left time: 3397.8170s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 894.2335s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0587s/iter; left time: 807.2569s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 725.9707s
Epoch: 17 cost time: 25.843605279922485
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.342 Vali Acc: 0.974 Test Loss: 0.342 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2563s/iter; left time: 3467.9293s
	iters: 200, epoch: 18 | loss: 1.2459700
	speed: 0.0670s/iter; left time: 900.4285s
	iters: 300, epoch: 18 | loss: 0.0000015
	speed: 0.0673s/iter; left time: 897.6623s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 735.0017s
Epoch: 18 cost time: 27.98373770713806
Epoch: 18, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7590381
	speed: 0.1840s/iter; left time: 2413.2623s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.0496s/iter; left time: 645.4831s
	iters: 300, epoch: 19 | loss: 0.0000007
	speed: 0.0407s/iter; left time: 525.3962s
	iters: 400, epoch: 19 | loss: 0.0011097
	speed: 0.0455s/iter; left time: 583.5655s
Epoch: 19 cost time: 18.945209980010986
Epoch: 19, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.981 Test Loss: 0.215 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0017718
	speed: 0.1593s/iter; left time: 2023.8996s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 509.4186s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 559.2810s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 530.4529s
Epoch: 20 cost time: 17.46926736831665
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.270 Vali Acc: 0.980 Test Loss: 0.270 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1706s/iter; left time: 2096.6174s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0362s/iter; left time: 441.8221s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0516s/iter; left time: 623.4206s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 541.5040s
Epoch: 21 cost time: 19.336085557937622
Epoch: 21, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.978 Test Loss: 0.224 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1910s/iter; left time: 2268.7082s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 552.4165s
	iters: 300, epoch: 22 | loss: 1.2946961
	speed: 0.0415s/iter; left time: 484.1959s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0408s/iter; left time: 472.0471s
Epoch: 22 cost time: 18.29975724220276
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.978 Test Loss: 0.302 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1501s/iter; left time: 1721.0664s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 401.5464s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 527.7913s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 444.8059s
Epoch: 23 cost time: 17.230642795562744
Epoch: 23, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.983 Test Loss: 0.192 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000048
	speed: 0.1636s/iter; left time: 1808.5716s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 420.0208s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0313s/iter; left time: 339.3762s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0424s/iter; left time: 455.3641s
Epoch: 24 cost time: 16.06726360321045
Epoch: 24, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.197 Vali Acc: 0.986 Test Loss: 0.197 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 29695498
model size : 127.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7155210
	speed: 0.0772s/iter; left time: 1586.5508s
	iters: 200, epoch: 1 | loss: 0.0931727
	speed: 0.0529s/iter; left time: 1081.3362s
	iters: 300, epoch: 1 | loss: 0.0432014
	speed: 0.0504s/iter; left time: 1025.2162s
	iters: 400, epoch: 1 | loss: 0.7977112
	speed: 0.0541s/iter; left time: 1095.6223s
Epoch: 1 cost time: 24.48198699951172
Epoch: 1, Steps: 413 | Train Loss: 0.562 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0213309
	speed: 0.2100s/iter; left time: 4229.4392s
	iters: 200, epoch: 2 | loss: 0.1576805
	speed: 0.0589s/iter; left time: 1180.9700s
	iters: 300, epoch: 2 | loss: 0.0219307
	speed: 0.0575s/iter; left time: 1146.1417s
	iters: 400, epoch: 2 | loss: 0.0018634
	speed: 0.0517s/iter; left time: 1026.5420s
Epoch: 2 cost time: 24.179613828659058
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.959071 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005124
	speed: 0.2313s/iter; left time: 4563.2193s
	iters: 200, epoch: 3 | loss: 0.0063371
	speed: 0.0606s/iter; left time: 1188.7399s
	iters: 300, epoch: 3 | loss: 0.0034972
	speed: 0.0518s/iter; left time: 1011.1435s
	iters: 400, epoch: 3 | loss: 0.0995807
	speed: 0.0555s/iter; left time: 1078.9457s
Epoch: 3 cost time: 23.537423133850098
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.968166 --> -0.973623).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0033990
	speed: 0.2382s/iter; left time: 4600.7540s
	iters: 200, epoch: 4 | loss: 0.1976993
	speed: 0.0475s/iter; left time: 913.0772s
	iters: 300, epoch: 4 | loss: 0.0633688
	speed: 0.0530s/iter; left time: 1013.1153s
	iters: 400, epoch: 4 | loss: 0.1468425
	speed: 0.0512s/iter; left time: 973.0481s
Epoch: 4 cost time: 21.33815026283264
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0087010
	speed: 0.1829s/iter; left time: 3455.8977s
	iters: 200, epoch: 5 | loss: 0.0000725
	speed: 0.0486s/iter; left time: 913.5185s
	iters: 300, epoch: 5 | loss: 0.0000797
	speed: 0.0505s/iter; left time: 944.9892s
	iters: 400, epoch: 5 | loss: 0.0008662
	speed: 0.0567s/iter; left time: 1054.7240s
Epoch: 5 cost time: 21.8446147441864
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.973623 --> -0.978171).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1332263
	speed: 0.1650s/iter; left time: 3050.3376s
	iters: 200, epoch: 6 | loss: 0.0014015
	speed: 0.0418s/iter; left time: 767.8654s
	iters: 300, epoch: 6 | loss: 0.0016941
	speed: 0.0390s/iter; left time: 714.0522s
	iters: 400, epoch: 6 | loss: 0.0003430
	speed: 0.0445s/iter; left time: 808.3979s
Epoch: 6 cost time: 17.288973808288574
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0005947
	speed: 0.1806s/iter; left time: 3264.0762s
	iters: 200, epoch: 7 | loss: 0.0000018
	speed: 0.0554s/iter; left time: 996.6026s
	iters: 300, epoch: 7 | loss: 0.0000027
	speed: 0.0563s/iter; left time: 1006.3458s
	iters: 400, epoch: 7 | loss: 0.0003979
	speed: 0.0585s/iter; left time: 1040.2312s
Epoch: 7 cost time: 24.525930166244507
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0016066
	speed: 0.1984s/iter; left time: 3503.5584s
	iters: 200, epoch: 8 | loss: 0.0009266
	speed: 0.0508s/iter; left time: 891.2612s
	iters: 300, epoch: 8 | loss: 0.0000027
	speed: 0.0456s/iter; left time: 796.6836s
	iters: 400, epoch: 8 | loss: 0.0000031
	speed: 0.0411s/iter; left time: 713.5097s
Epoch: 8 cost time: 20.74620294570923
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979535).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000027
	speed: 0.2006s/iter; left time: 3459.6141s
	iters: 200, epoch: 9 | loss: 0.0019933
	speed: 0.0480s/iter; left time: 823.4528s
	iters: 300, epoch: 9 | loss: 0.0000034
	speed: 0.0495s/iter; left time: 844.3256s
	iters: 400, epoch: 9 | loss: 0.0000333
	speed: 0.0376s/iter; left time: 637.5424s
Epoch: 9 cost time: 20.444364309310913
Epoch: 9, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000050
	speed: 0.1715s/iter; left time: 2887.8590s
	iters: 200, epoch: 10 | loss: 0.0000041
	speed: 0.0479s/iter; left time: 801.1591s
	iters: 300, epoch: 10 | loss: 0.0000021
	speed: 0.0574s/iter; left time: 954.1970s
	iters: 400, epoch: 10 | loss: 0.0365008
	speed: 0.0533s/iter; left time: 881.8153s
Epoch: 10 cost time: 21.97265601158142
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.979535 --> -0.983628).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.2325s/iter; left time: 3817.3321s
	iters: 200, epoch: 11 | loss: 0.1523961
	speed: 0.0244s/iter; left time: 398.1968s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0347s/iter; left time: 562.7846s
	iters: 400, epoch: 11 | loss: 0.0001082
	speed: 0.0330s/iter; left time: 532.3495s
Epoch: 11 cost time: 13.192851781845093
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0062517
	speed: 0.1549s/iter; left time: 2479.5923s
	iters: 200, epoch: 12 | loss: 0.2015200
	speed: 0.0380s/iter; left time: 605.2662s
	iters: 300, epoch: 12 | loss: 0.0046314
	speed: 0.0450s/iter; left time: 711.4796s
	iters: 400, epoch: 12 | loss: 0.0000311
	speed: 0.0453s/iter; left time: 711.7371s
Epoch: 12 cost time: 18.342040300369263
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.969 Test Loss: 0.221 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000150
	speed: 0.1407s/iter; left time: 2193.7915s
	iters: 200, epoch: 13 | loss: 0.0000065
	speed: 0.0465s/iter; left time: 719.8242s
	iters: 300, epoch: 13 | loss: 0.0000416
	speed: 0.0579s/iter; left time: 890.7945s
	iters: 400, epoch: 13 | loss: 0.4693905
	speed: 0.0608s/iter; left time: 930.1044s
Epoch: 13 cost time: 22.435698986053467
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000087
	speed: 0.1941s/iter; left time: 2946.2442s
	iters: 200, epoch: 14 | loss: 0.2004746
	speed: 0.0567s/iter; left time: 855.5283s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 760.0377s
	iters: 400, epoch: 14 | loss: 0.0017007
	speed: 0.0370s/iter; left time: 549.9997s
Epoch: 14 cost time: 21.52364468574524
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000015
	speed: 0.1641s/iter; left time: 2423.9461s
	iters: 200, epoch: 15 | loss: 0.0000012
	speed: 0.0498s/iter; left time: 730.1961s
	iters: 300, epoch: 15 | loss: 0.0000040
	speed: 0.0471s/iter; left time: 685.6763s
	iters: 400, epoch: 15 | loss: 0.0000027
	speed: 0.0518s/iter; left time: 749.1042s
Epoch: 15 cost time: 20.394564390182495
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000018
	speed: 0.1857s/iter; left time: 2665.3099s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 885.0138s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0541s/iter; left time: 765.9346s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 816.7725s
Epoch: 16 cost time: 24.865220546722412
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.976 Test Loss: 0.193 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1698s/iter; left time: 2367.9674s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.0490s/iter; left time: 678.6111s
	iters: 300, epoch: 17 | loss: 0.0071157
	speed: 0.0563s/iter; left time: 773.7990s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0580s/iter; left time: 790.6648s
Epoch: 17 cost time: 22.39323878288269
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.983628).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2264s/iter; left time: 3063.1037s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0366s/iter; left time: 491.2651s
	iters: 300, epoch: 18 | loss: 0.4312790
	speed: 0.0472s/iter; left time: 629.2429s
	iters: 400, epoch: 18 | loss: 0.2406252
	speed: 0.0499s/iter; left time: 660.3461s
Epoch: 18 cost time: 18.414182901382446
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.983 Test Loss: 0.159 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1610s/iter; left time: 2111.2032s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0471s/iter; left time: 613.5758s
	iters: 300, epoch: 19 | loss: 0.1602550
	speed: 0.0483s/iter; left time: 623.2519s
	iters: 400, epoch: 19 | loss: 0.0000005
	speed: 0.0502s/iter; left time: 643.9557s
Epoch: 19 cost time: 20.50170660018921
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.985 Test Loss: 0.109 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984992).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000023
	speed: 0.1793s/iter; left time: 2278.4400s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 522.3465s
	iters: 300, epoch: 20 | loss: 0.0000011
	speed: 0.0458s/iter; left time: 573.2160s
	iters: 400, epoch: 20 | loss: 0.0018179
	speed: 0.0413s/iter; left time: 511.8315s
Epoch: 20 cost time: 18.281534433364868
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.280 Vali Acc: 0.969 Test Loss: 0.280 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1653s/iter; left time: 2032.2771s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.0437s/iter; left time: 532.4158s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 429.5324s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 542.5352s
Epoch: 21 cost time: 18.057602167129517
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1793s/iter; left time: 2130.2417s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 628.8025s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 660.5588s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 604.6282s
Epoch: 22 cost time: 23.445596933364868
Epoch: 22, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
Validation loss decreased (-0.984992 --> -0.985447).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2058s/iter; left time: 2359.0544s
	iters: 200, epoch: 23 | loss: 0.5848522
	speed: 0.0600s/iter; left time: 682.0454s
	iters: 300, epoch: 23 | loss: 0.0000114
	speed: 0.0619s/iter; left time: 696.8069s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 713.3738s
Epoch: 23 cost time: 25.823099613189697
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.988 Test Loss: 0.092 Test Acc: 0.988
Validation loss decreased (-0.985447 --> -0.987721).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2371s/iter; left time: 2620.8475s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 779.3813s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 742.2824s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0627s/iter; left time: 674.2771s
Epoch: 24 cost time: 28.68698239326477
Epoch: 24, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.2779517
	speed: 0.1469s/iter; left time: 1563.1542s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 555.0886s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 517.4073s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 641.5912s
Epoch: 25 cost time: 22.83005952835083
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.981 Test Loss: 0.198 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1891s/iter; left time: 1933.6992s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 652.2065s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 645.5645s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 630.2759s
Epoch: 26 cost time: 26.262990713119507
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.980 Test Loss: 0.198 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2161s/iter; left time: 2120.4407s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 481.4989s
	iters: 300, epoch: 27 | loss: 0.0000030
	speed: 0.0530s/iter; left time: 509.3558s
	iters: 400, epoch: 27 | loss: 0.0000347
	speed: 0.0511s/iter; left time: 486.2571s
Epoch: 27 cost time: 22.256650924682617
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1766s/iter; left time: 1660.2878s
	iters: 200, epoch: 28 | loss: 0.0000473
	speed: 0.0557s/iter; left time: 517.8088s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0601s/iter; left time: 552.7953s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 528.6244s
Epoch: 28 cost time: 22.93390703201294
Epoch: 28, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.979 Test Loss: 0.192 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2038s/iter; left time: 1831.1095s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 636.6523s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 560.5483s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 525.4098s
Epoch: 29 cost time: 27.109683513641357
Epoch: 29, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.982 Test Loss: 0.176 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1968s/iter; left time: 1687.3683s
	iters: 200, epoch: 30 | loss: 0.0000011
	speed: 0.0472s/iter; left time: 399.6405s
	iters: 300, epoch: 30 | loss: 0.0000001
	speed: 0.0521s/iter; left time: 436.6093s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 431.0240s
Epoch: 30 cost time: 22.028220415115356
Epoch: 30, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.978 Test Loss: 0.231 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1834s/iter; left time: 1496.9057s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 457.4164s
	iters: 300, epoch: 31 | loss: 0.0000146
	speed: 0.0550s/iter; left time: 437.7978s
	iters: 400, epoch: 31 | loss: 0.0001760
	speed: 0.0631s/iter; left time: 496.1312s
Epoch: 31 cost time: 24.66957378387451
Epoch: 31, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.980 Test Loss: 0.203 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1748s/iter; left time: 1354.3517s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 365.4409s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0541s/iter; left time: 408.0482s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0577s/iter; left time: 429.6921s
Epoch: 32 cost time: 22.405277729034424
Epoch: 32, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1989s/iter; left time: 1459.0588s
	iters: 200, epoch: 33 | loss: 0.0000363
	speed: 0.0532s/iter; left time: 384.5952s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0640s/iter; left time: 456.6365s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 339.2860s
Epoch: 33 cost time: 24.107272386550903
Epoch: 33, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.981 Test Loss: 0.192 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 29630986
model size : 127.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1811195
	speed: 0.1488s/iter; left time: 3058.5196s
	iters: 200, epoch: 1 | loss: 0.0946545
	speed: 0.1170s/iter; left time: 2393.2204s
	iters: 300, epoch: 1 | loss: 0.1651471
	speed: 0.1093s/iter; left time: 2223.4855s
	iters: 400, epoch: 1 | loss: 0.0055703
	speed: 0.1026s/iter; left time: 2077.7058s
Epoch: 1 cost time: 49.031479835510254
Epoch: 1, Steps: 413 | Train Loss: 0.487 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (inf --> -0.963619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1092907
	speed: 0.3081s/iter; left time: 6204.8326s
	iters: 200, epoch: 2 | loss: 0.0114777
	speed: 0.1396s/iter; left time: 2796.5506s
	iters: 300, epoch: 2 | loss: 0.0000304
	speed: 0.1119s/iter; left time: 2230.8671s
	iters: 400, epoch: 2 | loss: 0.0000587
	speed: 0.1278s/iter; left time: 2534.3872s
Epoch: 2 cost time: 50.606648683547974
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0012539
	speed: 0.2229s/iter; left time: 4396.6914s
	iters: 200, epoch: 3 | loss: 0.1425359
	speed: 0.0703s/iter; left time: 1380.0748s
	iters: 300, epoch: 3 | loss: 0.0576834
	speed: 0.1032s/iter; left time: 2015.5988s
	iters: 400, epoch: 3 | loss: 0.0007745
	speed: 0.1209s/iter; left time: 2348.9277s
Epoch: 3 cost time: 38.30231809616089
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.963619 --> -0.984538).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0016743
	speed: 0.3097s/iter; left time: 5980.1025s
	iters: 200, epoch: 4 | loss: 0.0185982
	speed: 0.0774s/iter; left time: 1487.3763s
	iters: 300, epoch: 4 | loss: 0.0000082
	speed: 0.0980s/iter; left time: 1873.5911s
	iters: 400, epoch: 4 | loss: 0.0099699
	speed: 0.0939s/iter; left time: 1785.5508s
Epoch: 4 cost time: 35.65316581726074
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0013107
	speed: 0.2631s/iter; left time: 4972.1868s
	iters: 200, epoch: 5 | loss: 0.0095266
	speed: 0.0602s/iter; left time: 1132.3876s
	iters: 300, epoch: 5 | loss: 0.0084067
	speed: 0.0855s/iter; left time: 1598.6739s
	iters: 400, epoch: 5 | loss: 0.0000390
	speed: 0.0873s/iter; left time: 1624.0048s
Epoch: 5 cost time: 33.69959592819214
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.174 Vali Acc: 0.979 Test Loss: 0.174 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0021503
	speed: 0.2669s/iter; left time: 4934.6219s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 1410.2788s
	iters: 300, epoch: 6 | loss: 0.0000952
	speed: 0.1052s/iter; left time: 1923.1416s
	iters: 400, epoch: 6 | loss: 0.0011120
	speed: 0.1178s/iter; left time: 2141.8769s
Epoch: 6 cost time: 40.91233277320862
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000015
	speed: 0.2833s/iter; left time: 5120.5969s
	iters: 200, epoch: 7 | loss: 0.0000070
	speed: 0.1219s/iter; left time: 2190.0984s
	iters: 300, epoch: 7 | loss: 0.0028918
	speed: 0.1232s/iter; left time: 2201.4238s
	iters: 400, epoch: 7 | loss: 0.0000005
	speed: 0.1184s/iter; left time: 2103.8972s
Epoch: 7 cost time: 48.664571046829224
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000008
	speed: 0.2611s/iter; left time: 4611.7616s
	iters: 200, epoch: 8 | loss: 0.0000013
	speed: 0.1136s/iter; left time: 1994.8942s
	iters: 300, epoch: 8 | loss: 0.0034838
	speed: 0.1301s/iter; left time: 2270.8578s
	iters: 400, epoch: 8 | loss: 0.0015455
	speed: 0.1182s/iter; left time: 2051.7664s
Epoch: 8 cost time: 46.68672966957092
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.986 Test Loss: 0.114 Test Acc: 0.986
Validation loss decreased (-0.984538 --> -0.986356).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000703
	speed: 0.2653s/iter; left time: 4576.1980s
	iters: 200, epoch: 9 | loss: 0.0196680
	speed: 0.1065s/iter; left time: 1826.8756s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0959s/iter; left time: 1635.3952s
	iters: 400, epoch: 9 | loss: 0.0000996
	speed: 0.1014s/iter; left time: 1718.0278s
Epoch: 9 cost time: 40.5326726436615
Epoch: 9, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.124 Vali Acc: 0.985 Test Loss: 0.124 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000499
	speed: 0.1959s/iter; left time: 3298.3787s
	iters: 200, epoch: 10 | loss: 0.0523935
	speed: 0.0572s/iter; left time: 956.7321s
	iters: 300, epoch: 10 | loss: 0.1756012
	speed: 0.0637s/iter; left time: 1059.4317s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0894s/iter; left time: 1478.7891s
Epoch: 10 cost time: 28.413936614990234
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.985 Test Loss: 0.134 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000129
	speed: 0.2646s/iter; left time: 4344.5230s
	iters: 200, epoch: 11 | loss: 0.0000141
	speed: 0.1024s/iter; left time: 1671.9921s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 1578.2750s
	iters: 400, epoch: 11 | loss: 0.0224748
	speed: 0.1041s/iter; left time: 1678.2769s
Epoch: 11 cost time: 41.959380865097046
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.985 Test Loss: 0.145 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.3045s/iter; left time: 4873.7752s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.1115s/iter; left time: 1773.2458s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1205s/iter; left time: 1904.9625s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 1762.2154s
Epoch: 12 cost time: 49.42206072807312
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.988 Test Loss: 0.115 Test Acc: 0.988
Validation loss decreased (-0.986356 --> -0.987721).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000217
	speed: 0.3171s/iter; left time: 4944.7718s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 1352.4375s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 1011.9620s
	iters: 400, epoch: 13 | loss: 0.0145470
	speed: 0.0647s/iter; left time: 989.0272s
Epoch: 13 cost time: 34.06231880187988
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.220 Vali Acc: 0.985 Test Loss: 0.220 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000106
	speed: 0.2215s/iter; left time: 3362.7132s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.0938s/iter; left time: 1415.3566s
	iters: 300, epoch: 14 | loss: 0.0003957
	speed: 0.0872s/iter; left time: 1305.8095s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 926.9048s
Epoch: 14 cost time: 31.438043117523193
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000046
	speed: 0.2026s/iter; left time: 2992.5984s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 832.9245s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 1032.4462s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.0692s/iter; left time: 1001.8861s
Epoch: 15 cost time: 28.465280771255493
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.985 Test Loss: 0.180 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2928s/iter; left time: 4202.8755s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.1100s/iter; left time: 1568.0562s
	iters: 300, epoch: 16 | loss: 0.4933592
	speed: 0.1243s/iter; left time: 1759.1986s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1038s/iter; left time: 1459.3033s
Epoch: 16 cost time: 48.16033673286438
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.236 Vali Acc: 0.985 Test Loss: 0.236 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3132s/iter; left time: 4366.8728s
	iters: 200, epoch: 17 | loss: 0.4187998
	speed: 0.1068s/iter; left time: 1478.0557s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1111s/iter; left time: 1526.6603s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1096s/iter; left time: 1495.2052s
Epoch: 17 cost time: 47.25153112411499
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.206 Vali Acc: 0.981 Test Loss: 0.206 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2347s/iter; left time: 3175.9597s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 818.1418s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 857.2328s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 884.3176s
Epoch: 18 cost time: 27.52073311805725
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.987 Test Loss: 0.145 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2218s/iter; left time: 2909.9436s
	iters: 200, epoch: 19 | loss: 0.1279386
	speed: 0.0788s/iter; left time: 1025.2379s
	iters: 300, epoch: 19 | loss: 0.0000151
	speed: 0.0771s/iter; left time: 996.5200s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 940.2221s
Epoch: 19 cost time: 33.386531352996826
Epoch: 19, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.983 Test Loss: 0.269 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2335s/iter; left time: 2966.5972s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 857.6037s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 785.2987s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 813.5866s
Epoch: 20 cost time: 27.804957628250122
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.981 Test Loss: 0.278 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 0.2885s/iter; left time: 3546.2374s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 1081.2546s
	iters: 300, epoch: 21 | loss: 0.0000338
	speed: 0.0877s/iter; left time: 1060.9256s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0893s/iter; left time: 1070.6441s
Epoch: 21 cost time: 39.390443563461304
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.531 Vali Acc: 0.980 Test Loss: 0.531 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2900s/iter; left time: 3444.6730s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1190s/iter; left time: 1401.4713s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1164s/iter; left time: 1359.7812s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1119s/iter; left time: 1295.5528s
Epoch: 22 cost time: 48.66109800338745
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.987 Test Loss: 0.293 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 29810698
model size : 128.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5591846
	speed: 0.0839s/iter; left time: 1724.3077s
	iters: 200, epoch: 1 | loss: 0.1795863
	speed: 0.0583s/iter; left time: 1192.8860s
	iters: 300, epoch: 1 | loss: 0.3257136
	speed: 0.0553s/iter; left time: 1126.2973s
	iters: 400, epoch: 1 | loss: 0.2714832
	speed: 0.0570s/iter; left time: 1153.6384s
Epoch: 1 cost time: 26.463351726531982
Epoch: 1, Steps: 413 | Train Loss: 0.529 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (inf --> -0.967712).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0612106
	speed: 0.2266s/iter; left time: 4563.0683s
	iters: 200, epoch: 2 | loss: 0.0022185
	speed: 0.0654s/iter; left time: 1310.0282s
	iters: 300, epoch: 2 | loss: 0.0011839
	speed: 0.0631s/iter; left time: 1259.0059s
	iters: 400, epoch: 2 | loss: 0.0012996
	speed: 0.0686s/iter; left time: 1361.3518s
Epoch: 2 cost time: 28.145267486572266
Epoch: 2, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.967712 --> -0.971349).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002318
	speed: 0.2205s/iter; left time: 4349.2874s
	iters: 200, epoch: 3 | loss: 0.0006605
	speed: 0.0449s/iter; left time: 880.6414s
	iters: 300, epoch: 3 | loss: 0.0032032
	speed: 0.0410s/iter; left time: 799.8745s
	iters: 400, epoch: 3 | loss: 0.0000461
	speed: 0.0608s/iter; left time: 1181.2846s
Epoch: 3 cost time: 20.871680974960327
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000204
	speed: 0.1812s/iter; left time: 3500.2671s
	iters: 200, epoch: 4 | loss: 0.0000579
	speed: 0.0401s/iter; left time: 769.7984s
	iters: 300, epoch: 4 | loss: 0.0007197
	speed: 0.0668s/iter; left time: 1276.4375s
	iters: 400, epoch: 4 | loss: 0.0001352
	speed: 0.0756s/iter; left time: 1437.3963s
Epoch: 4 cost time: 23.72569489479065
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000095
	speed: 0.2426s/iter; left time: 4585.0564s
	iters: 200, epoch: 5 | loss: 0.1470883
	speed: 0.0616s/iter; left time: 1158.1972s
	iters: 300, epoch: 5 | loss: 0.0000900
	speed: 0.0601s/iter; left time: 1123.0231s
	iters: 400, epoch: 5 | loss: 0.0009877
	speed: 0.0533s/iter; left time: 990.6252s
Epoch: 5 cost time: 25.05594253540039
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
Validation loss decreased (-0.971349 --> -0.974078).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0005940
	speed: 0.1813s/iter; left time: 3351.5590s
	iters: 200, epoch: 6 | loss: 0.0006985
	speed: 0.0365s/iter; left time: 671.6029s
	iters: 300, epoch: 6 | loss: 0.0000042
	speed: 0.0337s/iter; left time: 615.5305s
	iters: 400, epoch: 6 | loss: 0.1645576
	speed: 0.0404s/iter; left time: 734.5978s
Epoch: 6 cost time: 16.17178702354431
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976351).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0284435
	speed: 0.1737s/iter; left time: 3138.8098s
	iters: 200, epoch: 7 | loss: 0.0000040
	speed: 0.0394s/iter; left time: 707.8749s
	iters: 300, epoch: 7 | loss: 0.0001089
	speed: 0.0478s/iter; left time: 855.2061s
	iters: 400, epoch: 7 | loss: 0.0034707
	speed: 0.0390s/iter; left time: 693.3317s
Epoch: 7 cost time: 17.514414310455322
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.976351 --> -0.979990).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000184
	speed: 0.2688s/iter; left time: 4746.1951s
	iters: 200, epoch: 8 | loss: 1.1072266
	speed: 0.0607s/iter; left time: 1065.5702s
	iters: 300, epoch: 8 | loss: 0.0000011
	speed: 0.0462s/iter; left time: 807.2659s
	iters: 400, epoch: 8 | loss: 0.0009868
	speed: 0.0421s/iter; left time: 731.3915s
Epoch: 8 cost time: 22.77259850502014
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000053
	speed: 0.2205s/iter; left time: 3802.1956s
	iters: 200, epoch: 9 | loss: 0.0000704
	speed: 0.0458s/iter; left time: 785.1779s
	iters: 300, epoch: 9 | loss: 0.0000050
	speed: 0.0437s/iter; left time: 745.1498s
	iters: 400, epoch: 9 | loss: 0.0000002
	speed: 0.0520s/iter; left time: 881.5699s
Epoch: 9 cost time: 21.101675033569336
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.965 Test Loss: 0.227 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000013
	speed: 0.2137s/iter; left time: 3597.9258s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 1219.9691s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 1001.6427s
	iters: 400, epoch: 10 | loss: 0.0039935
	speed: 0.0687s/iter; left time: 1135.6854s
Epoch: 10 cost time: 28.563058853149414
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2440s/iter; left time: 4006.8961s
	iters: 200, epoch: 11 | loss: 0.0022199
	speed: 0.0810s/iter; left time: 1321.7755s
	iters: 300, epoch: 11 | loss: 0.0000025
	speed: 0.0683s/iter; left time: 1107.3395s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 841.2322s
Epoch: 11 cost time: 29.441184043884277
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.971 Test Loss: 0.210 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0199261
	speed: 0.2372s/iter; left time: 3797.4775s
	iters: 200, epoch: 12 | loss: 0.0005931
	speed: 0.0455s/iter; left time: 723.9188s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 683.9039s
	iters: 400, epoch: 12 | loss: 0.2182714
	speed: 0.0529s/iter; left time: 830.4747s
Epoch: 12 cost time: 21.668365240097046
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.2264s/iter; left time: 3531.0210s
	iters: 200, epoch: 13 | loss: 0.0000004
	speed: 0.0529s/iter; left time: 819.7895s
	iters: 300, epoch: 13 | loss: 0.2083453
	speed: 0.0416s/iter; left time: 640.8765s
	iters: 400, epoch: 13 | loss: 0.0005480
	speed: 0.0488s/iter; left time: 745.7986s
Epoch: 13 cost time: 21.21188759803772
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.272 Vali Acc: 0.972 Test Loss: 0.272 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1957s/iter; left time: 2971.1048s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 780.0443s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 566.1657s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 515.6298s
Epoch: 14 cost time: 17.994131326675415
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.173 Vali Acc: 0.982 Test Loss: 0.173 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.981808).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001375
	speed: 0.1815s/iter; left time: 2680.5734s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 813.7774s
	iters: 300, epoch: 15 | loss: 0.0491357
	speed: 0.0633s/iter; left time: 922.7587s
	iters: 400, epoch: 15 | loss: 0.0000816
	speed: 0.0497s/iter; left time: 718.5765s
Epoch: 15 cost time: 23.494690418243408
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.251 Vali Acc: 0.977 Test Loss: 0.251 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0668431
	speed: 0.1994s/iter; left time: 2862.3094s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 682.4183s
	iters: 300, epoch: 16 | loss: 0.0000065
	speed: 0.0579s/iter; left time: 819.9828s
	iters: 400, epoch: 16 | loss: 0.0000413
	speed: 0.0673s/iter; left time: 945.5989s
Epoch: 16 cost time: 23.761104345321655
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.981 Test Loss: 0.185 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2400s/iter; left time: 3345.6741s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0492s/iter; left time: 680.7565s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 687.3634s
	iters: 400, epoch: 17 | loss: 0.0000063
	speed: 0.0515s/iter; left time: 703.2113s
Epoch: 17 cost time: 22.595072031021118
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.976 Test Loss: 0.204 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000820
	speed: 0.1818s/iter; left time: 2459.5848s
	iters: 200, epoch: 18 | loss: 0.0193026
	speed: 0.0421s/iter; left time: 565.8628s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 641.8644s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 515.4367s
Epoch: 18 cost time: 18.62710213661194
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.974 Test Loss: 0.243 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0004860
	speed: 0.1840s/iter; left time: 2413.1821s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 492.7254s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 618.3768s
	iters: 400, epoch: 19 | loss: 0.0001462
	speed: 0.0448s/iter; left time: 573.8395s
Epoch: 19 cost time: 18.4357647895813
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.985 Test Loss: 0.148 Test Acc: 0.985
Validation loss decreased (-0.981808 --> -0.984537).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2015s/iter; left time: 2559.2904s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 402.5481s
	iters: 300, epoch: 20 | loss: 0.0000004
	speed: 0.0388s/iter; left time: 485.6225s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 627.5628s
Epoch: 20 cost time: 16.10325026512146
Epoch: 20, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.985 Test Loss: 0.170 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.985446).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1988s/iter; left time: 2443.8306s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 504.3853s
	iters: 300, epoch: 21 | loss: 0.4626985
	speed: 0.0461s/iter; left time: 557.5515s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 499.1870s
Epoch: 21 cost time: 18.76522731781006
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.988 Test Loss: 0.088 Test Acc: 0.988
Validation loss decreased (-0.985446 --> -0.988176).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0931732
	speed: 0.2310s/iter; left time: 2743.8315s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 810.1771s
	iters: 300, epoch: 22 | loss: 0.0003650
	speed: 0.0677s/iter; left time: 790.0226s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 790.1086s
Epoch: 22 cost time: 28.690898656845093
Epoch: 22, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.987 Test Loss: 0.094 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1747s/iter; left time: 2002.7752s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 675.5662s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 739.3596s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 717.6327s
Epoch: 23 cost time: 25.89949083328247
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.988 Test Loss: 0.126 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2104s/iter; left time: 2324.9055s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 638.6902s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 562.1428s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 513.5808s
Epoch: 24 cost time: 22.698853492736816
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.985 Test Loss: 0.167 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000002
	speed: 0.1874s/iter; left time: 1994.0508s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0507s/iter; left time: 533.9528s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 578.3078s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.0628s/iter; left time: 649.3423s
Epoch: 25 cost time: 23.53947877883911
Epoch: 25, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.987 Test Loss: 0.130 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000010
	speed: 0.1969s/iter; left time: 2013.5929s
	iters: 200, epoch: 26 | loss: 0.0000029
	speed: 0.0491s/iter; left time: 497.4696s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0425s/iter; left time: 426.5015s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 399.7607s
Epoch: 26 cost time: 19.78450107574463
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.382 Vali Acc: 0.970 Test Loss: 0.382 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1722s/iter; left time: 1689.5269s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 608.2507s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0642s/iter; left time: 616.8071s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 588.9593s
Epoch: 27 cost time: 24.969810962677002
Epoch: 27, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.978 Test Loss: 0.256 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1998s/iter; left time: 1878.1848s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 517.1503s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 417.5427s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 590.8090s
Epoch: 28 cost time: 22.93574595451355
Epoch: 28, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.985 Test Loss: 0.170 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000003
	speed: 0.2499s/iter; left time: 2245.7767s
	iters: 200, epoch: 29 | loss: 0.0000046
	speed: 0.0715s/iter; left time: 635.1482s
	iters: 300, epoch: 29 | loss: 0.0000785
	speed: 0.0577s/iter; left time: 507.0652s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 585.9205s
Epoch: 29 cost time: 28.41362977027893
Epoch: 29, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.978 Test Loss: 0.278 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1411s/iter; left time: 1209.8626s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 286.6020s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 305.7958s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 382.1692s
Epoch: 30 cost time: 16.426300525665283
Epoch: 30, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.984 Test Loss: 0.225 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1929s/iter; left time: 1574.4423s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 447.6139s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 445.7750s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 441.2910s
Epoch: 31 cost time: 23.071714401245117
Epoch: 31, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.987 Test Loss: 0.143 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 29736970
model size : 128.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8097488
	speed: 0.0673s/iter; left time: 1384.0915s
	iters: 200, epoch: 1 | loss: 0.0934907
	speed: 0.0367s/iter; left time: 750.2666s
	iters: 300, epoch: 1 | loss: 0.0922008
	speed: 0.0389s/iter; left time: 790.7663s
	iters: 400, epoch: 1 | loss: 0.0549572
	speed: 0.0403s/iter; left time: 815.5285s
Epoch: 1 cost time: 19.208150148391724
Epoch: 1, Steps: 413 | Train Loss: 0.583 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0046014
	speed: 0.1850s/iter; left time: 3725.7664s
	iters: 200, epoch: 2 | loss: 0.0424526
	speed: 0.0635s/iter; left time: 1271.6010s
	iters: 300, epoch: 2 | loss: 0.0106143
	speed: 0.0609s/iter; left time: 1213.7014s
	iters: 400, epoch: 2 | loss: 0.2939301
	speed: 0.0639s/iter; left time: 1267.9794s
Epoch: 2 cost time: 25.52544069290161
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
Validation loss decreased (-0.951340 --> -0.973624).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0427043
	speed: 0.2232s/iter; left time: 4403.5552s
	iters: 200, epoch: 3 | loss: 0.0305044
	speed: 0.0610s/iter; left time: 1196.9331s
	iters: 300, epoch: 3 | loss: 0.0027232
	speed: 0.0592s/iter; left time: 1155.3716s
	iters: 400, epoch: 3 | loss: 0.1615644
	speed: 0.0535s/iter; left time: 1039.0325s
Epoch: 3 cost time: 24.97827696800232
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0005489
	speed: 0.2034s/iter; left time: 3928.5084s
	iters: 200, epoch: 4 | loss: 0.0330954
	speed: 0.0571s/iter; left time: 1097.2967s
	iters: 300, epoch: 4 | loss: 0.2073276
	speed: 0.0533s/iter; left time: 1018.9701s
	iters: 400, epoch: 4 | loss: 0.0048408
	speed: 0.0505s/iter; left time: 959.9513s
Epoch: 4 cost time: 22.556318044662476
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0478965
	speed: 0.1918s/iter; left time: 3625.6823s
	iters: 200, epoch: 5 | loss: 0.0036896
	speed: 0.0533s/iter; left time: 1001.5070s
	iters: 300, epoch: 5 | loss: 0.0467924
	speed: 0.0560s/iter; left time: 1046.2530s
	iters: 400, epoch: 5 | loss: 0.0000187
	speed: 0.0448s/iter; left time: 833.0742s
Epoch: 5 cost time: 21.935385942459106
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000377
	speed: 0.1465s/iter; left time: 2707.8798s
	iters: 200, epoch: 6 | loss: 0.0000461
	speed: 0.0438s/iter; left time: 806.0304s
	iters: 300, epoch: 6 | loss: 0.0086670
	speed: 0.0378s/iter; left time: 691.7235s
	iters: 400, epoch: 6 | loss: 0.0001385
	speed: 0.0426s/iter; left time: 774.9972s
Epoch: 6 cost time: 17.363525390625
Epoch: 6, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000210
	speed: 0.1514s/iter; left time: 2735.4971s
	iters: 200, epoch: 7 | loss: 0.0000191
	speed: 0.0487s/iter; left time: 875.0239s
	iters: 300, epoch: 7 | loss: 0.0752724
	speed: 0.0481s/iter; left time: 859.7974s
	iters: 400, epoch: 7 | loss: 0.0018956
	speed: 0.0395s/iter; left time: 702.6679s
Epoch: 7 cost time: 18.63055443763733
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0004183
	speed: 0.1336s/iter; left time: 2360.1553s
	iters: 200, epoch: 8 | loss: 0.0000040
	speed: 0.0252s/iter; left time: 442.2426s
	iters: 300, epoch: 8 | loss: 0.0005486
	speed: 0.0265s/iter; left time: 463.4112s
	iters: 400, epoch: 8 | loss: 0.0003062
	speed: 0.0237s/iter; left time: 412.1311s
Epoch: 8 cost time: 11.158761501312256
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2164233
	speed: 0.1660s/iter; left time: 2862.8104s
	iters: 200, epoch: 9 | loss: 0.0737031
	speed: 0.0512s/iter; left time: 877.9377s
	iters: 300, epoch: 9 | loss: 0.0000117
	speed: 0.0479s/iter; left time: 815.7515s
	iters: 400, epoch: 9 | loss: 0.0000936
	speed: 0.0575s/iter; left time: 974.9858s
Epoch: 9 cost time: 22.566450834274292
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.973624 --> -0.974987).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0004617
	speed: 0.1873s/iter; left time: 3152.8690s
	iters: 200, epoch: 10 | loss: 0.0000335
	speed: 0.0460s/iter; left time: 769.4799s
	iters: 300, epoch: 10 | loss: 0.0000010
	speed: 0.0404s/iter; left time: 672.3414s
	iters: 400, epoch: 10 | loss: 0.0000321
	speed: 0.0473s/iter; left time: 781.4500s
Epoch: 10 cost time: 19.39582133293152
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.1805s/iter; left time: 2964.7932s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.0524s/iter; left time: 855.5182s
	iters: 300, epoch: 11 | loss: 0.0000028
	speed: 0.0553s/iter; left time: 896.4788s
	iters: 400, epoch: 11 | loss: 0.0000019
	speed: 0.0550s/iter; left time: 886.2601s
Epoch: 11 cost time: 22.840980529785156
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
Validation loss decreased (-0.974987 --> -0.975897).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2634s/iter; left time: 4216.0399s
	iters: 200, epoch: 12 | loss: 0.0000019
	speed: 0.0368s/iter; left time: 584.7116s
	iters: 300, epoch: 12 | loss: 0.0000028
	speed: 0.0375s/iter; left time: 593.2753s
	iters: 400, epoch: 12 | loss: 0.0000012
	speed: 0.0491s/iter; left time: 770.8497s
Epoch: 12 cost time: 18.34894609451294
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006491
	speed: 0.1693s/iter; left time: 2639.5539s
	iters: 200, epoch: 13 | loss: 0.0008757
	speed: 0.0403s/iter; left time: 624.4012s
	iters: 300, epoch: 13 | loss: 0.0000023
	speed: 0.0373s/iter; left time: 574.8401s
	iters: 400, epoch: 13 | loss: 0.0000294
	speed: 0.0405s/iter; left time: 619.1357s
Epoch: 13 cost time: 16.85227918624878
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1309s/iter; left time: 1986.7120s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 568.9753s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.0387s/iter; left time: 579.2249s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0332s/iter; left time: 493.3829s
Epoch: 14 cost time: 14.874198913574219
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000118
	speed: 0.1431s/iter; left time: 2113.1551s
	iters: 200, epoch: 15 | loss: 0.0000451
	speed: 0.0474s/iter; left time: 695.1478s
	iters: 300, epoch: 15 | loss: 0.0079677
	speed: 0.0451s/iter; left time: 656.6389s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 606.0791s
Epoch: 15 cost time: 19.116493701934814
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.975897 --> -0.980444).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1670s/iter; left time: 2397.7028s
	iters: 200, epoch: 16 | loss: 0.0293798
	speed: 0.0390s/iter; left time: 555.4699s
	iters: 300, epoch: 16 | loss: 0.0019955
	speed: 0.0406s/iter; left time: 575.1412s
	iters: 400, epoch: 16 | loss: 0.0000458
	speed: 0.0424s/iter; left time: 596.3543s
Epoch: 16 cost time: 17.36395788192749
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0175897
	speed: 0.1604s/iter; left time: 2236.5934s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0427s/iter; left time: 590.4483s
	iters: 300, epoch: 17 | loss: 0.0002983
	speed: 0.0470s/iter; left time: 645.6649s
	iters: 400, epoch: 17 | loss: 0.0028871
	speed: 0.0466s/iter; left time: 636.0704s
Epoch: 17 cost time: 19.440666675567627
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1423s/iter; left time: 1924.6610s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 556.3440s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 574.2113s
	iters: 400, epoch: 18 | loss: 0.0000109
	speed: 0.0452s/iter; left time: 597.9622s
Epoch: 18 cost time: 17.977631330490112
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.971 Test Loss: 0.217 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.1605s/iter; left time: 2105.6329s
	iters: 200, epoch: 19 | loss: 0.0004069
	speed: 0.0384s/iter; left time: 499.3679s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0414s/iter; left time: 534.5555s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 584.0394s
Epoch: 19 cost time: 17.82416343688965
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1871s/iter; left time: 2376.7370s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 567.7060s
	iters: 300, epoch: 20 | loss: 0.0000016
	speed: 0.0461s/iter; left time: 576.0863s
	iters: 400, epoch: 20 | loss: 0.0043023
	speed: 0.0491s/iter; left time: 608.5047s
Epoch: 20 cost time: 20.911962509155273
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000674
	speed: 0.1603s/iter; left time: 1970.8100s
	iters: 200, epoch: 21 | loss: 0.0000745
	speed: 0.0449s/iter; left time: 547.5440s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0437s/iter; left time: 528.7647s
	iters: 400, epoch: 21 | loss: 0.0000251
	speed: 0.0417s/iter; left time: 499.9750s
Epoch: 21 cost time: 18.39555048942566
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.974 Test Loss: 0.152 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1786s/iter; left time: 2121.8763s
	iters: 200, epoch: 22 | loss: 0.0000093
	speed: 0.0400s/iter; left time: 471.6937s
	iters: 300, epoch: 22 | loss: 0.0009720
	speed: 0.0424s/iter; left time: 495.0640s
	iters: 400, epoch: 22 | loss: 0.0022888
	speed: 0.0409s/iter; left time: 473.8073s
Epoch: 22 cost time: 18.889437437057495
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.974 Test Loss: 0.189 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1508s/iter; left time: 1728.5194s
	iters: 200, epoch: 23 | loss: 0.0000186
	speed: 0.0444s/iter; left time: 504.7173s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 506.0533s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 521.6592s
Epoch: 23 cost time: 18.419917106628418
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.974 Test Loss: 0.196 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1546s/iter; left time: 1709.0078s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 412.7755s
	iters: 300, epoch: 24 | loss: 0.0130051
	speed: 0.0360s/iter; left time: 390.3932s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 505.5552s
Epoch: 24 cost time: 17.313183069229126
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.351 Vali Acc: 0.967 Test Loss: 0.351 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1295s/iter; left time: 1377.7294s
	iters: 200, epoch: 25 | loss: 0.0000777
	speed: 0.0386s/iter; left time: 406.9900s
	iters: 300, epoch: 25 | loss: 0.0000126
	speed: 0.0424s/iter; left time: 442.5036s
	iters: 400, epoch: 25 | loss: 0.1156707
	speed: 0.0521s/iter; left time: 538.6049s
Epoch: 25 cost time: 18.442692279815674
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.495 Vali Acc: 0.963 Test Loss: 0.495 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 29681674
model size : 127.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2021361
	speed: 0.1218s/iter; left time: 2502.6923s
	iters: 200, epoch: 1 | loss: 0.0810547
	speed: 0.0908s/iter; left time: 1857.7006s
	iters: 300, epoch: 1 | loss: 0.1364484
	speed: 0.0848s/iter; left time: 1725.0751s
	iters: 400, epoch: 1 | loss: 0.0400108
	speed: 0.0620s/iter; left time: 1256.2405s
Epoch: 1 cost time: 36.94961762428284
Epoch: 1, Steps: 413 | Train Loss: 0.478 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0001600
	speed: 0.2148s/iter; left time: 4325.8656s
	iters: 200, epoch: 2 | loss: 0.0064798
	speed: 0.0884s/iter; left time: 1770.7977s
	iters: 300, epoch: 2 | loss: 0.1635084
	speed: 0.0914s/iter; left time: 1821.5305s
	iters: 400, epoch: 2 | loss: 0.0435505
	speed: 0.0900s/iter; left time: 1785.7662s
Epoch: 2 cost time: 35.905306339263916
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.964983 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0022245
	speed: 0.2557s/iter; left time: 5044.0779s
	iters: 200, epoch: 3 | loss: 0.0000686
	speed: 0.0527s/iter; left time: 1034.1019s
	iters: 300, epoch: 3 | loss: 0.0002185
	speed: 0.0590s/iter; left time: 1152.3619s
	iters: 400, epoch: 3 | loss: 0.0012824
	speed: 0.0651s/iter; left time: 1264.8150s
Epoch: 3 cost time: 26.987947940826416
Epoch: 3, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.975897 --> -0.981809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001218
	speed: 0.3031s/iter; left time: 5853.1231s
	iters: 200, epoch: 4 | loss: 0.0015174
	speed: 0.0677s/iter; left time: 1300.8166s
	iters: 300, epoch: 4 | loss: 0.0058861
	speed: 0.0886s/iter; left time: 1694.0046s
	iters: 400, epoch: 4 | loss: 0.0008842
	speed: 0.0903s/iter; left time: 1717.0508s
Epoch: 4 cost time: 34.0399649143219
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0004002
	speed: 0.2723s/iter; left time: 5146.9727s
	iters: 200, epoch: 5 | loss: 0.0000001
	speed: 0.0770s/iter; left time: 1448.0524s
	iters: 300, epoch: 5 | loss: 0.0041947
	speed: 0.0791s/iter; left time: 1479.9451s
	iters: 400, epoch: 5 | loss: 0.0002970
	speed: 0.0711s/iter; left time: 1321.8489s
Epoch: 5 cost time: 34.5041708946228
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0006544
	speed: 0.2857s/iter; left time: 5282.3366s
	iters: 200, epoch: 6 | loss: 0.0006428
	speed: 0.0987s/iter; left time: 1814.5194s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 1195.0666s
	iters: 400, epoch: 6 | loss: 0.0080595
	speed: 0.0727s/iter; left time: 1321.7706s
Epoch: 6 cost time: 36.534122467041016
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.069 Vali Acc: 0.988 Test Loss: 0.069 Test Acc: 0.988
Validation loss decreased (-0.981809 --> -0.988176).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001355
	speed: 0.2645s/iter; left time: 4779.6121s
	iters: 200, epoch: 7 | loss: 0.0000101
	speed: 0.0868s/iter; left time: 1559.4719s
	iters: 300, epoch: 7 | loss: 0.0042158
	speed: 0.0746s/iter; left time: 1334.2047s
	iters: 400, epoch: 7 | loss: 0.3342937
	speed: 0.0576s/iter; left time: 1024.4469s
Epoch: 7 cost time: 32.517504930496216
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0152180
	speed: 0.2100s/iter; left time: 3709.3641s
	iters: 200, epoch: 8 | loss: 0.0000087
	speed: 0.0803s/iter; left time: 1410.1586s
	iters: 300, epoch: 8 | loss: 0.0000387
	speed: 0.0868s/iter; left time: 1515.1004s
	iters: 400, epoch: 8 | loss: 0.0000660
	speed: 0.0702s/iter; left time: 1219.2877s
Epoch: 8 cost time: 32.071961641311646
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0002325
	speed: 0.1825s/iter; left time: 3147.3143s
	iters: 200, epoch: 9 | loss: 0.0002704
	speed: 0.0684s/iter; left time: 1173.5494s
	iters: 300, epoch: 9 | loss: 0.0000434
	speed: 0.0782s/iter; left time: 1333.8131s
	iters: 400, epoch: 9 | loss: 0.0000708
	speed: 0.1108s/iter; left time: 1876.9329s
Epoch: 9 cost time: 33.02281951904297
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.977 Test Loss: 0.213 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0003403
	speed: 0.2628s/iter; left time: 4423.5427s
	iters: 200, epoch: 10 | loss: 0.0000011
	speed: 0.0717s/iter; left time: 1200.4404s
	iters: 300, epoch: 10 | loss: 1.4243282
	speed: 0.0849s/iter; left time: 1411.5527s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.0697s/iter; left time: 1153.1317s
Epoch: 10 cost time: 33.52717638015747
Epoch: 10, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.328 Vali Acc: 0.971 Test Loss: 0.328 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000011
	speed: 0.2211s/iter; left time: 3631.0491s
	iters: 200, epoch: 11 | loss: 0.5629424
	speed: 0.0460s/iter; left time: 750.2726s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0540s/iter; left time: 876.1147s
	iters: 400, epoch: 11 | loss: 0.0006249
	speed: 0.0616s/iter; left time: 993.2149s
Epoch: 11 cost time: 24.258118867874146
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000241
	speed: 0.1912s/iter; left time: 3060.2735s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0502s/iter; left time: 798.3258s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0685s/iter; left time: 1082.9548s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 679.1111s
Epoch: 12 cost time: 23.919655561447144
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.979 Test Loss: 0.207 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1832s/iter; left time: 2857.0224s
	iters: 200, epoch: 13 | loss: 0.0000015
	speed: 0.0512s/iter; left time: 793.1246s
	iters: 300, epoch: 13 | loss: 0.0000190
	speed: 0.0639s/iter; left time: 984.0769s
	iters: 400, epoch: 13 | loss: 0.0003016
	speed: 0.0468s/iter; left time: 715.7199s
Epoch: 13 cost time: 22.6092209815979
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.980 Test Loss: 0.205 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2530s/iter; left time: 3841.7841s
	iters: 200, epoch: 14 | loss: 0.0000039
	speed: 0.0827s/iter; left time: 1247.2902s
	iters: 300, epoch: 14 | loss: 0.0000011
	speed: 0.0649s/iter; left time: 971.6187s
	iters: 400, epoch: 14 | loss: 0.1182521
	speed: 0.0941s/iter; left time: 1400.5562s
Epoch: 14 cost time: 37.96619510650635
Epoch: 14, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.988 Test Loss: 0.139 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3243s/iter; left time: 4789.4378s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1267s/iter; left time: 1857.8860s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1144s/iter; left time: 1667.3340s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1127s/iter; left time: 1631.0914s
Epoch: 15 cost time: 48.899083375930786
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.979 Test Loss: 0.159 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2790s/iter; left time: 4004.9234s
	iters: 200, epoch: 16 | loss: 0.0000004
	speed: 0.0753s/iter; left time: 1073.5561s
	iters: 300, epoch: 16 | loss: 0.0001737
	speed: 0.1040s/iter; left time: 1471.9493s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 1254.3851s
Epoch: 16 cost time: 38.156452655792236
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.979 Test Loss: 0.205 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 29870602
model size : 128.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2871985
	speed: 0.0759s/iter; left time: 1558.8263s
	iters: 200, epoch: 1 | loss: 0.0494963
	speed: 0.0622s/iter; left time: 1271.0956s
	iters: 300, epoch: 1 | loss: 0.0661120
	speed: 0.0634s/iter; left time: 1290.2314s
	iters: 400, epoch: 1 | loss: 0.1216306
	speed: 0.0676s/iter; left time: 1369.6379s
Epoch: 1 cost time: 27.755937337875366
Epoch: 1, Steps: 413 | Train Loss: 0.513 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0122556
	speed: 0.2299s/iter; left time: 4628.9969s
	iters: 200, epoch: 2 | loss: 0.0208420
	speed: 0.0633s/iter; left time: 1269.1407s
	iters: 300, epoch: 2 | loss: 0.4609371
	speed: 0.0642s/iter; left time: 1279.7110s
	iters: 400, epoch: 2 | loss: 0.0846666
	speed: 0.0561s/iter; left time: 1112.7258s
Epoch: 2 cost time: 25.861443996429443
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
Validation loss decreased (-0.964528 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0010206
	speed: 0.2256s/iter; left time: 4449.2514s
	iters: 200, epoch: 3 | loss: 0.0214589
	speed: 0.0671s/iter; left time: 1317.2785s
	iters: 300, epoch: 3 | loss: 0.0002591
	speed: 0.0550s/iter; left time: 1074.2613s
	iters: 400, epoch: 3 | loss: 0.0001687
	speed: 0.0427s/iter; left time: 828.6945s
Epoch: 3 cost time: 23.92326784133911
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.968621 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0081203
	speed: 0.2274s/iter; left time: 4391.6279s
	iters: 200, epoch: 4 | loss: 0.0000127
	speed: 0.0580s/iter; left time: 1114.2621s
	iters: 300, epoch: 4 | loss: 0.0111103
	speed: 0.0703s/iter; left time: 1343.5505s
	iters: 400, epoch: 4 | loss: 0.2044380
	speed: 0.0506s/iter; left time: 962.7700s
Epoch: 4 cost time: 25.81326150894165
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001964
	speed: 0.2140s/iter; left time: 4044.3512s
	iters: 200, epoch: 5 | loss: 0.1421907
	speed: 0.0631s/iter; left time: 1185.2816s
	iters: 300, epoch: 5 | loss: 0.0029593
	speed: 0.0644s/iter; left time: 1204.8310s
	iters: 400, epoch: 5 | loss: 0.0000003
	speed: 0.0581s/iter; left time: 1080.1538s
Epoch: 5 cost time: 26.28144860267639
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0043169
	speed: 0.2319s/iter; left time: 4286.8205s
	iters: 200, epoch: 6 | loss: 0.1084590
	speed: 0.0606s/iter; left time: 1114.1799s
	iters: 300, epoch: 6 | loss: 0.0146322
	speed: 0.0500s/iter; left time: 913.6910s
	iters: 400, epoch: 6 | loss: 0.0901082
	speed: 0.0552s/iter; left time: 1004.1279s
Epoch: 6 cost time: 24.476879119873047
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0007300
	speed: 0.2320s/iter; left time: 4193.2057s
	iters: 200, epoch: 7 | loss: 0.0000011
	speed: 0.0512s/iter; left time: 919.8396s
	iters: 300, epoch: 7 | loss: 0.0000002
	speed: 0.0544s/iter; left time: 972.4885s
	iters: 400, epoch: 7 | loss: 0.1669443
	speed: 0.0564s/iter; left time: 1002.3263s
Epoch: 7 cost time: 23.308966159820557
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0073842
	speed: 0.2328s/iter; left time: 4111.2441s
	iters: 200, epoch: 8 | loss: 0.0000301
	speed: 0.0461s/iter; left time: 808.9138s
	iters: 300, epoch: 8 | loss: 0.0004164
	speed: 0.0502s/iter; left time: 877.2515s
	iters: 400, epoch: 8 | loss: 0.0005585
	speed: 0.0391s/iter; left time: 678.6838s
Epoch: 8 cost time: 20.98568558692932
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.170 Vali Acc: 0.974 Test Loss: 0.170 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0006847
	speed: 0.1960s/iter; left time: 3380.2148s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0642s/iter; left time: 1101.3238s
	iters: 300, epoch: 9 | loss: 0.0909877
	speed: 0.0567s/iter; left time: 967.0873s
	iters: 400, epoch: 9 | loss: 0.3314363
	speed: 0.0513s/iter; left time: 869.0268s
Epoch: 9 cost time: 24.730979442596436
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0067013
	speed: 0.1550s/iter; left time: 2608.8789s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0427s/iter; left time: 714.1094s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0483s/iter; left time: 803.7732s
	iters: 400, epoch: 10 | loss: 0.0001370
	speed: 0.0461s/iter; left time: 762.3099s
Epoch: 10 cost time: 19.946961164474487
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.968 Test Loss: 0.233 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000005
	speed: 0.1753s/iter; left time: 2878.9431s
	iters: 200, epoch: 11 | loss: 0.0000274
	speed: 0.0450s/iter; left time: 734.9248s
	iters: 300, epoch: 11 | loss: 0.0000074
	speed: 0.0420s/iter; left time: 681.9498s
	iters: 400, epoch: 11 | loss: 0.0000012
	speed: 0.0422s/iter; left time: 680.3157s
Epoch: 11 cost time: 19.058486461639404
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000074
	speed: 0.1613s/iter; left time: 2581.4975s
	iters: 200, epoch: 12 | loss: 0.0000158
	speed: 0.0385s/iter; left time: 612.3131s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.0415s/iter; left time: 655.5615s
	iters: 400, epoch: 12 | loss: 0.0000293
	speed: 0.0569s/iter; left time: 894.1296s
Epoch: 12 cost time: 19.374143600463867
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.977 Test Loss: 0.177 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000031
	speed: 0.1780s/iter; left time: 2776.6708s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 980.2551s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 796.0619s
	iters: 400, epoch: 13 | loss: 0.0003200
	speed: 0.0430s/iter; left time: 657.1242s
Epoch: 13 cost time: 21.434407234191895
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 29778442
model size : 128.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8689056
	speed: 0.0641s/iter; left time: 1317.0845s
	iters: 200, epoch: 1 | loss: 0.3377396
	speed: 0.0443s/iter; left time: 906.1745s
	iters: 300, epoch: 1 | loss: 0.1067953
	speed: 0.0477s/iter; left time: 971.2781s
	iters: 400, epoch: 1 | loss: 0.0192797
	speed: 0.0408s/iter; left time: 826.1750s
Epoch: 1 cost time: 20.388248682022095
Epoch: 1, Steps: 413 | Train Loss: 0.572 Vali Loss: 0.129 Vali Acc: 0.956 Test Loss: 0.129 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0363060
	speed: 0.1584s/iter; left time: 3189.2566s
	iters: 200, epoch: 2 | loss: 0.0336989
	speed: 0.0497s/iter; left time: 995.3049s
	iters: 300, epoch: 2 | loss: 0.0014423
	speed: 0.0485s/iter; left time: 967.4270s
	iters: 400, epoch: 2 | loss: 0.0169516
	speed: 0.0488s/iter; left time: 968.2077s
Epoch: 2 cost time: 20.37841272354126
Epoch: 2, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
Validation loss decreased (-0.955888 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031302
	speed: 0.1818s/iter; left time: 3585.7056s
	iters: 200, epoch: 3 | loss: 0.0028339
	speed: 0.0392s/iter; left time: 769.2514s
	iters: 300, epoch: 3 | loss: 0.0112928
	speed: 0.0375s/iter; left time: 731.6783s
	iters: 400, epoch: 3 | loss: 0.0012901
	speed: 0.0354s/iter; left time: 687.9397s
Epoch: 3 cost time: 16.24361753463745
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0011942
	speed: 0.1662s/iter; left time: 3210.0686s
	iters: 200, epoch: 4 | loss: 0.0002381
	speed: 0.0445s/iter; left time: 854.1774s
	iters: 300, epoch: 4 | loss: 0.0002907
	speed: 0.0442s/iter; left time: 844.3104s
	iters: 400, epoch: 4 | loss: 0.0003666
	speed: 0.0416s/iter; left time: 791.7924s
Epoch: 4 cost time: 18.488291263580322
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0194246
	speed: 0.1642s/iter; left time: 3103.0035s
	iters: 200, epoch: 5 | loss: 0.0017067
	speed: 0.0514s/iter; left time: 966.9946s
	iters: 300, epoch: 5 | loss: 0.0000467
	speed: 0.0483s/iter; left time: 903.7117s
	iters: 400, epoch: 5 | loss: 0.0002771
	speed: 0.0347s/iter; left time: 646.0185s
Epoch: 5 cost time: 18.892398357391357
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.984993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1607637
	speed: 0.1835s/iter; left time: 3391.7671s
	iters: 200, epoch: 6 | loss: 0.0003729
	speed: 0.0394s/iter; left time: 724.7264s
	iters: 300, epoch: 6 | loss: 0.0086583
	speed: 0.0561s/iter; left time: 1025.6965s
	iters: 400, epoch: 6 | loss: 0.0000939
	speed: 0.0525s/iter; left time: 953.8909s
Epoch: 6 cost time: 19.386093139648438
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001119
	speed: 0.1925s/iter; left time: 3478.9677s
	iters: 200, epoch: 7 | loss: 0.0029489
	speed: 0.0421s/iter; left time: 757.5526s
	iters: 300, epoch: 7 | loss: 0.0023496
	speed: 0.0432s/iter; left time: 771.7552s
	iters: 400, epoch: 7 | loss: 0.0000320
	speed: 0.0389s/iter; left time: 691.2157s
Epoch: 7 cost time: 19.058469533920288
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0519083
	speed: 0.1476s/iter; left time: 2605.8977s
	iters: 200, epoch: 8 | loss: 0.0006888
	speed: 0.0439s/iter; left time: 771.5245s
	iters: 300, epoch: 8 | loss: 0.0001040
	speed: 0.0406s/iter; left time: 708.8237s
	iters: 400, epoch: 8 | loss: 0.0001399
	speed: 0.0465s/iter; left time: 806.9459s
Epoch: 8 cost time: 18.603580474853516
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1412217
	speed: 0.1810s/iter; left time: 3121.4824s
	iters: 200, epoch: 9 | loss: 0.0450786
	speed: 0.0599s/iter; left time: 1026.5535s
	iters: 300, epoch: 9 | loss: 0.0000006
	speed: 0.0590s/iter; left time: 1006.0178s
	iters: 400, epoch: 9 | loss: 0.0000145
	speed: 0.0580s/iter; left time: 982.4667s
Epoch: 9 cost time: 23.963215827941895
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1952s/iter; left time: 3286.3848s
	iters: 200, epoch: 10 | loss: 0.0000681
	speed: 0.0515s/iter; left time: 861.3958s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0495s/iter; left time: 823.7041s
	iters: 400, epoch: 10 | loss: 0.0000028
	speed: 0.0423s/iter; left time: 699.2444s
Epoch: 10 cost time: 20.893365621566772
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000207
	speed: 0.1687s/iter; left time: 2769.9789s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0484s/iter; left time: 789.5447s
	iters: 300, epoch: 11 | loss: 0.0000073
	speed: 0.0610s/iter; left time: 988.8335s
	iters: 400, epoch: 11 | loss: 0.0000017
	speed: 0.0549s/iter; left time: 885.0811s
Epoch: 11 cost time: 22.56388521194458
Epoch: 11, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000054
	speed: 0.1804s/iter; left time: 2888.0609s
	iters: 200, epoch: 12 | loss: 0.0000262
	speed: 0.0411s/iter; left time: 653.3448s
	iters: 300, epoch: 12 | loss: 0.0002242
	speed: 0.0400s/iter; left time: 632.0352s
	iters: 400, epoch: 12 | loss: 0.0003177
	speed: 0.0486s/iter; left time: 762.9468s
Epoch: 12 cost time: 19.138587474822998
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.973 Test Loss: 0.199 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0001506
	speed: 0.1670s/iter; left time: 2604.0116s
	iters: 200, epoch: 13 | loss: 0.0107968
	speed: 0.0355s/iter; left time: 549.3255s
	iters: 300, epoch: 13 | loss: 0.0000622
	speed: 0.0438s/iter; left time: 673.5609s
	iters: 400, epoch: 13 | loss: 0.0000068
	speed: 0.0367s/iter; left time: 560.7147s
Epoch: 13 cost time: 17.31421184539795
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000033
	speed: 0.1460s/iter; left time: 2217.2765s
	iters: 200, epoch: 14 | loss: 0.0000029
	speed: 0.0562s/iter; left time: 847.1728s
	iters: 300, epoch: 14 | loss: 0.0003520
	speed: 0.0377s/iter; left time: 565.5688s
	iters: 400, epoch: 14 | loss: 0.0018431
	speed: 0.0366s/iter; left time: 544.6724s
Epoch: 14 cost time: 17.924564599990845
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.1340s/iter; left time: 1979.1842s
	iters: 200, epoch: 15 | loss: 0.0000050
	speed: 0.0344s/iter; left time: 504.8210s
	iters: 300, epoch: 15 | loss: 0.0002686
	speed: 0.0430s/iter; left time: 626.1507s
	iters: 400, epoch: 15 | loss: 0.0000011
	speed: 0.0458s/iter; left time: 662.3004s
Epoch: 15 cost time: 17.844989776611328
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.980 Test Loss: 0.181 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 29732362
model size : 128.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3398386
	speed: 0.0790s/iter; left time: 1623.3265s
	iters: 200, epoch: 1 | loss: 0.4376604
	speed: 0.0538s/iter; left time: 1101.2431s
	iters: 300, epoch: 1 | loss: 0.1268229
	speed: 0.0469s/iter; left time: 955.2183s
	iters: 400, epoch: 1 | loss: 0.0156743
	speed: 0.0341s/iter; left time: 689.8222s
Epoch: 1 cost time: 21.903485536575317
Epoch: 1, Steps: 413 | Train Loss: 0.484 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (inf --> -0.963618).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0342808
	speed: 0.1748s/iter; left time: 3519.6345s
	iters: 200, epoch: 2 | loss: 0.1743261
	speed: 0.0534s/iter; left time: 1069.7006s
	iters: 300, epoch: 2 | loss: 0.0058387
	speed: 0.0527s/iter; left time: 1051.2106s
	iters: 400, epoch: 2 | loss: 0.0114677
	speed: 0.0621s/iter; left time: 1231.6824s
Epoch: 2 cost time: 23.9735164642334
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.963618 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0020826
	speed: 0.2436s/iter; left time: 4804.2294s
	iters: 200, epoch: 3 | loss: 0.0003893
	speed: 0.0544s/iter; left time: 1067.9609s
	iters: 300, epoch: 3 | loss: 0.0067122
	speed: 0.0532s/iter; left time: 1039.0396s
	iters: 400, epoch: 3 | loss: 0.0009118
	speed: 0.0569s/iter; left time: 1105.3315s
Epoch: 3 cost time: 23.28363537788391
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.978171 --> -0.984538).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000681
	speed: 0.2236s/iter; left time: 4318.6605s
	iters: 200, epoch: 4 | loss: 0.0000841
	speed: 0.0397s/iter; left time: 763.4360s
	iters: 300, epoch: 4 | loss: 0.0000884
	speed: 0.0432s/iter; left time: 826.4053s
	iters: 400, epoch: 4 | loss: 0.0000691
	speed: 0.0506s/iter; left time: 961.3359s
Epoch: 4 cost time: 19.27124524116516
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.052 Vali Acc: 0.986 Test Loss: 0.052 Test Acc: 0.986
Validation loss decreased (-0.984538 --> -0.986357).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0030497
	speed: 0.1930s/iter; left time: 3648.1960s
	iters: 200, epoch: 5 | loss: 0.0006275
	speed: 0.0434s/iter; left time: 815.9671s
	iters: 300, epoch: 5 | loss: 0.0087857
	speed: 0.0477s/iter; left time: 892.0721s
	iters: 400, epoch: 5 | loss: 0.0000010
	speed: 0.0374s/iter; left time: 695.4639s
Epoch: 5 cost time: 19.248698949813843
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0009505
	speed: 0.1397s/iter; left time: 2583.0737s
	iters: 200, epoch: 6 | loss: 0.0676448
	speed: 0.0396s/iter; left time: 728.4909s
	iters: 300, epoch: 6 | loss: 0.0000082
	speed: 0.0406s/iter; left time: 742.4594s
	iters: 400, epoch: 6 | loss: 0.0000821
	speed: 0.0477s/iter; left time: 867.2992s
Epoch: 6 cost time: 17.89769673347473
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0006499
	speed: 0.1543s/iter; left time: 2789.2245s
	iters: 200, epoch: 7 | loss: 0.7845231
	speed: 0.0286s/iter; left time: 513.5710s
	iters: 300, epoch: 7 | loss: 0.0000005
	speed: 0.0304s/iter; left time: 543.6391s
	iters: 400, epoch: 7 | loss: 0.0000075
	speed: 0.0363s/iter; left time: 645.0630s
Epoch: 7 cost time: 13.978148937225342
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0056363
	speed: 0.2485s/iter; left time: 4389.1578s
	iters: 200, epoch: 8 | loss: 0.0000227
	speed: 0.0711s/iter; left time: 1248.2711s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 988.0325s
	iters: 400, epoch: 8 | loss: 0.1321237
	speed: 0.0519s/iter; left time: 901.7116s
Epoch: 8 cost time: 26.37073516845703
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0001310
	speed: 0.2517s/iter; left time: 4340.9362s
	iters: 200, epoch: 9 | loss: 0.0000413
	speed: 0.0882s/iter; left time: 1512.6554s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 1242.4082s
	iters: 400, epoch: 9 | loss: 0.0045270
	speed: 0.0464s/iter; left time: 786.1755s
Epoch: 9 cost time: 30.77395987510681
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.466 Vali Acc: 0.965 Test Loss: 0.466 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0013625
	speed: 0.1764s/iter; left time: 2968.9001s
	iters: 200, epoch: 10 | loss: 0.0000030
	speed: 0.0570s/iter; left time: 953.2140s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 819.1687s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 824.4393s
Epoch: 10 cost time: 20.62611675262451
Epoch: 10, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.230 Vali Acc: 0.974 Test Loss: 0.230 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1658s/iter; left time: 2722.7321s
	iters: 200, epoch: 11 | loss: 0.0000720
	speed: 0.0446s/iter; left time: 727.7637s
	iters: 300, epoch: 11 | loss: 0.0000011
	speed: 0.0589s/iter; left time: 954.8059s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0558s/iter; left time: 900.2625s
Epoch: 11 cost time: 22.25409460067749
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.982 Test Loss: 0.155 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0013934
	speed: 0.2196s/iter; left time: 3514.9895s
	iters: 200, epoch: 12 | loss: 0.0003790
	speed: 0.0511s/iter; left time: 813.2437s
	iters: 300, epoch: 12 | loss: 0.0000161
	speed: 0.0493s/iter; left time: 779.4102s
	iters: 400, epoch: 12 | loss: 0.0002068
	speed: 0.0506s/iter; left time: 795.4759s
Epoch: 12 cost time: 21.02126932144165
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1371s/iter; left time: 2137.8972s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 500.4782s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0361s/iter; left time: 556.0881s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 874.1355s
Epoch: 13 cost time: 17.762439966201782
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.2537s/iter; left time: 3852.0797s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 1003.3067s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.0747s/iter; left time: 1119.5292s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0734s/iter; left time: 1092.8137s
Epoch: 14 cost time: 30.210108757019043
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.265 Vali Acc: 0.968 Test Loss: 0.265 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 29914378
model size : 128.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5636761
	speed: 0.0834s/iter; left time: 1714.6707s
	iters: 200, epoch: 1 | loss: 0.1427779
	speed: 0.0387s/iter; left time: 790.8902s
	iters: 300, epoch: 1 | loss: 0.0313305
	speed: 0.0509s/iter; left time: 1036.4298s
	iters: 400, epoch: 1 | loss: 0.0105981
	speed: 0.0476s/iter; left time: 963.6898s
Epoch: 1 cost time: 22.844417095184326
Epoch: 1, Steps: 413 | Train Loss: 0.520 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0197929
	speed: 0.1689s/iter; left time: 3401.7204s
	iters: 200, epoch: 2 | loss: 0.0037043
	speed: 0.0501s/iter; left time: 1003.4412s
	iters: 300, epoch: 2 | loss: 0.0843176
	speed: 0.0481s/iter; left time: 959.7804s
	iters: 400, epoch: 2 | loss: 0.0011937
	speed: 0.0471s/iter; left time: 934.3563s
Epoch: 2 cost time: 20.092950105667114
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0140279
	speed: 0.1642s/iter; left time: 3238.3518s
	iters: 200, epoch: 3 | loss: 0.0007944
	speed: 0.0451s/iter; left time: 884.9766s
	iters: 300, epoch: 3 | loss: 0.0000109
	speed: 0.0434s/iter; left time: 848.1598s
	iters: 400, epoch: 3 | loss: 0.6758700
	speed: 0.0465s/iter; left time: 902.8853s
Epoch: 3 cost time: 19.71840786933899
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.977262 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0009594
	speed: 0.2273s/iter; left time: 4388.7460s
	iters: 200, epoch: 4 | loss: 0.0004527
	speed: 0.0418s/iter; left time: 802.5414s
	iters: 300, epoch: 4 | loss: 0.0006074
	speed: 0.0570s/iter; left time: 1088.4322s
	iters: 400, epoch: 4 | loss: 0.1763068
	speed: 0.0703s/iter; left time: 1336.8720s
Epoch: 4 cost time: 22.752458572387695
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0009340
	speed: 0.2195s/iter; left time: 4147.9162s
	iters: 200, epoch: 5 | loss: 0.0000218
	speed: 0.0565s/iter; left time: 1062.1306s
	iters: 300, epoch: 5 | loss: 0.1943588
	speed: 0.0525s/iter; left time: 982.3483s
	iters: 400, epoch: 5 | loss: 0.0023328
	speed: 0.0711s/iter; left time: 1321.7937s
Epoch: 5 cost time: 26.758702278137207
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
Validation loss decreased (-0.978171 --> -0.984083).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006698
	speed: 0.2087s/iter; left time: 3857.7711s
	iters: 200, epoch: 6 | loss: 0.1602913
	speed: 0.0577s/iter; left time: 1061.3753s
	iters: 300, epoch: 6 | loss: 0.0000170
	speed: 0.0719s/iter; left time: 1315.4076s
	iters: 400, epoch: 6 | loss: 0.0014642
	speed: 0.0680s/iter; left time: 1235.7511s
Epoch: 6 cost time: 26.75480580329895
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.2110s/iter; left time: 3814.2042s
	iters: 200, epoch: 7 | loss: 0.0000127
	speed: 0.0567s/iter; left time: 1019.8984s
	iters: 300, epoch: 7 | loss: 0.0001992
	speed: 0.0467s/iter; left time: 835.4231s
	iters: 400, epoch: 7 | loss: 0.0005414
	speed: 0.0471s/iter; left time: 836.6855s
Epoch: 7 cost time: 21.926085710525513
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0001224
	speed: 0.1715s/iter; left time: 3027.9880s
	iters: 200, epoch: 8 | loss: 0.0000826
	speed: 0.0504s/iter; left time: 884.9472s
	iters: 300, epoch: 8 | loss: 0.0008916
	speed: 0.0546s/iter; left time: 953.0284s
	iters: 400, epoch: 8 | loss: 0.0000007
	speed: 0.0477s/iter; left time: 828.7164s
Epoch: 8 cost time: 21.79074239730835
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0937995
	speed: 0.1516s/iter; left time: 2615.2646s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.0403s/iter; left time: 691.1670s
	iters: 300, epoch: 9 | loss: 0.0000165
	speed: 0.0389s/iter; left time: 663.0874s
	iters: 400, epoch: 9 | loss: 0.0032664
	speed: 0.0538s/iter; left time: 911.7599s
Epoch: 9 cost time: 19.12447452545166
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000009
	speed: 0.1653s/iter; left time: 2782.3673s
	iters: 200, epoch: 10 | loss: 0.0089703
	speed: 0.0389s/iter; left time: 650.2910s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 682.4280s
	iters: 400, epoch: 10 | loss: 0.0335345
	speed: 0.0470s/iter; left time: 777.0147s
Epoch: 10 cost time: 18.661591053009033
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.278 Vali Acc: 0.965 Test Loss: 0.278 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000020
	speed: 0.1976s/iter; left time: 3244.6013s
	iters: 200, epoch: 11 | loss: 0.0000064
	speed: 0.0632s/iter; left time: 1031.7441s
	iters: 300, epoch: 11 | loss: 0.0014120
	speed: 0.0521s/iter; left time: 845.9156s
	iters: 400, epoch: 11 | loss: 0.0000144
	speed: 0.0487s/iter; left time: 785.6037s
Epoch: 11 cost time: 23.50047016143799
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000131
	speed: 0.1504s/iter; left time: 2407.4750s
	iters: 200, epoch: 12 | loss: 0.0003663
	speed: 0.0616s/iter; left time: 979.6540s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 759.6234s
	iters: 400, epoch: 12 | loss: 0.0003467
	speed: 0.0561s/iter; left time: 881.4918s
Epoch: 12 cost time: 22.258004903793335
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.191 Vali Acc: 0.974 Test Loss: 0.191 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0002103
	speed: 0.2234s/iter; left time: 3483.5505s
	iters: 200, epoch: 13 | loss: 0.0000013
	speed: 0.0670s/iter; left time: 1037.9806s
	iters: 300, epoch: 13 | loss: 0.0000005
	speed: 0.0517s/iter; left time: 795.3480s
	iters: 400, epoch: 13 | loss: 0.0346958
	speed: 0.0489s/iter; left time: 748.3170s
Epoch: 13 cost time: 25.076231479644775
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000026
	speed: 0.2029s/iter; left time: 3080.1524s
	iters: 200, epoch: 14 | loss: 0.0014351
	speed: 0.0585s/iter; left time: 882.6870s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 715.9610s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 732.2035s
Epoch: 14 cost time: 22.86880326271057
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0131335
	speed: 0.1765s/iter; left time: 2606.5719s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.0462s/iter; left time: 678.3447s
	iters: 300, epoch: 15 | loss: 0.0000040
	speed: 0.0443s/iter; left time: 644.7443s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0448s/iter; left time: 648.5223s
Epoch: 15 cost time: 19.55392289161682
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.977 Test Loss: 0.224 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 29849866
model size : 128.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8246440
	speed: 0.0720s/iter; left time: 1480.2475s
	iters: 200, epoch: 1 | loss: 0.3147631
	speed: 0.0383s/iter; left time: 783.0380s
	iters: 300, epoch: 1 | loss: 0.1240771
	speed: 0.0548s/iter; left time: 1115.3292s
	iters: 400, epoch: 1 | loss: 0.4173899
	speed: 0.0454s/iter; left time: 920.3021s
Epoch: 1 cost time: 21.508601903915405
Epoch: 1, Steps: 413 | Train Loss: 0.566 Vali Loss: 0.082 Vali Acc: 0.966 Test Loss: 0.082 Test Acc: 0.966
Validation loss decreased (inf --> -0.966348).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0332970
	speed: 0.1555s/iter; left time: 3131.4534s
	iters: 200, epoch: 2 | loss: 0.1426894
	speed: 0.0439s/iter; left time: 880.5472s
	iters: 300, epoch: 2 | loss: 0.0069195
	speed: 0.0556s/iter; left time: 1108.4341s
	iters: 400, epoch: 2 | loss: 0.0645123
	speed: 0.0410s/iter; left time: 812.4215s
Epoch: 2 cost time: 19.284137725830078
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.059 Vali Acc: 0.979 Test Loss: 0.059 Test Acc: 0.979
Validation loss decreased (-0.966348 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0038496
	speed: 0.1817s/iter; left time: 3584.5587s
	iters: 200, epoch: 3 | loss: 0.0041304
	speed: 0.0487s/iter; left time: 955.9150s
	iters: 300, epoch: 3 | loss: 0.0012708
	speed: 0.0383s/iter; left time: 746.9357s
	iters: 400, epoch: 3 | loss: 0.0039189
	speed: 0.0352s/iter; left time: 683.3040s
Epoch: 3 cost time: 17.09811544418335
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0135947
	speed: 0.1382s/iter; left time: 2668.2082s
	iters: 200, epoch: 4 | loss: 0.0002195
	speed: 0.0390s/iter; left time: 748.5004s
	iters: 300, epoch: 4 | loss: 0.0004764
	speed: 0.0386s/iter; left time: 738.6606s
	iters: 400, epoch: 4 | loss: 0.0003778
	speed: 0.0352s/iter; left time: 668.7027s
Epoch: 4 cost time: 15.718885898590088
Epoch: 4, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0042728
	speed: 0.1619s/iter; left time: 3059.2685s
	iters: 200, epoch: 5 | loss: 0.0001838
	speed: 0.0541s/iter; left time: 1017.3030s
	iters: 300, epoch: 5 | loss: 0.0473422
	speed: 0.0520s/iter; left time: 972.7191s
	iters: 400, epoch: 5 | loss: 0.1475300
	speed: 0.0491s/iter; left time: 913.6701s
Epoch: 5 cost time: 21.970715045928955
Epoch: 5, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000793
	speed: 0.1504s/iter; left time: 2779.5391s
	iters: 200, epoch: 6 | loss: 0.0001030
	speed: 0.0369s/iter; left time: 678.7749s
	iters: 300, epoch: 6 | loss: 0.5038528
	speed: 0.0395s/iter; left time: 722.9682s
	iters: 400, epoch: 6 | loss: 0.0042897
	speed: 0.0388s/iter; left time: 704.9170s
Epoch: 6 cost time: 16.36524796485901
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0001172
	speed: 0.1589s/iter; left time: 2871.0294s
	iters: 200, epoch: 7 | loss: 0.0005158
	speed: 0.0490s/iter; left time: 881.3020s
	iters: 300, epoch: 7 | loss: 0.0024034
	speed: 0.0432s/iter; left time: 771.9579s
	iters: 400, epoch: 7 | loss: 0.0650333
	speed: 0.0403s/iter; left time: 716.3364s
Epoch: 7 cost time: 18.894665718078613
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0370944
	speed: 0.1516s/iter; left time: 2677.7398s
	iters: 200, epoch: 8 | loss: 0.0000675
	speed: 0.0481s/iter; left time: 845.0072s
	iters: 300, epoch: 8 | loss: 0.1659522
	speed: 0.0526s/iter; left time: 919.1964s
	iters: 400, epoch: 8 | loss: 0.0002845
	speed: 0.0498s/iter; left time: 864.1623s
Epoch: 8 cost time: 20.309208631515503
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0014557
	speed: 0.1672s/iter; left time: 2884.3514s
	iters: 200, epoch: 9 | loss: 0.0000153
	speed: 0.0377s/iter; left time: 647.1777s
	iters: 300, epoch: 9 | loss: 0.0001607
	speed: 0.0413s/iter; left time: 703.9530s
	iters: 400, epoch: 9 | loss: 0.0000393
	speed: 0.0431s/iter; left time: 731.0860s
Epoch: 9 cost time: 17.62190055847168
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.978626 --> -0.982719).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000237
	speed: 0.1685s/iter; left time: 2836.7482s
	iters: 200, epoch: 10 | loss: 0.0001892
	speed: 0.0461s/iter; left time: 771.8030s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0582s/iter; left time: 967.6725s
	iters: 400, epoch: 10 | loss: 0.0000304
	speed: 0.0487s/iter; left time: 805.4689s
Epoch: 10 cost time: 21.528644323349
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.984083).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0639663
	speed: 0.1924s/iter; left time: 3159.5940s
	iters: 200, epoch: 11 | loss: 0.0000220
	speed: 0.0406s/iter; left time: 662.5826s
	iters: 300, epoch: 11 | loss: 0.0001723
	speed: 0.0399s/iter; left time: 646.4365s
	iters: 400, epoch: 11 | loss: 0.0000006
	speed: 0.0381s/iter; left time: 613.4503s
Epoch: 11 cost time: 16.90133810043335
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000234
	speed: 0.1345s/iter; left time: 2152.4719s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 710.3280s
	iters: 300, epoch: 12 | loss: 0.0004747
	speed: 0.0448s/iter; left time: 708.5010s
	iters: 400, epoch: 12 | loss: 0.0002445
	speed: 0.0455s/iter; left time: 715.3650s
Epoch: 12 cost time: 17.95901370048523
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000105
	speed: 0.1594s/iter; left time: 2486.1861s
	iters: 200, epoch: 13 | loss: 0.1954872
	speed: 0.0341s/iter; left time: 528.7083s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.0329s/iter; left time: 506.7588s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0436s/iter; left time: 666.7894s
Epoch: 13 cost time: 16.164150953292847
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.981 Test Loss: 0.136 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000221
	speed: 0.1677s/iter; left time: 2546.6006s
	iters: 200, epoch: 14 | loss: 0.0022804
	speed: 0.0375s/iter; left time: 565.7907s
	iters: 300, epoch: 14 | loss: 0.0000038
	speed: 0.0315s/iter; left time: 472.5611s
	iters: 400, epoch: 14 | loss: 0.0016621
	speed: 0.0314s/iter; left time: 467.5263s
Epoch: 14 cost time: 15.412209033966064
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000288
	speed: 0.1622s/iter; left time: 2395.5980s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0441s/iter; left time: 647.4155s
	iters: 300, epoch: 15 | loss: 0.0000020
	speed: 0.0535s/iter; left time: 779.5038s
	iters: 400, epoch: 15 | loss: 0.0000008
	speed: 0.0600s/iter; left time: 868.5687s
Epoch: 15 cost time: 21.227067232131958
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1896s/iter; left time: 2721.9212s
	iters: 200, epoch: 16 | loss: 0.0000161
	speed: 0.0540s/iter; left time: 770.4999s
	iters: 300, epoch: 16 | loss: 0.0000027
	speed: 0.0539s/iter; left time: 762.6090s
	iters: 400, epoch: 16 | loss: 0.0000456
	speed: 0.0564s/iter; left time: 792.7991s
Epoch: 16 cost time: 22.743215322494507
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000013
	speed: 0.1723s/iter; left time: 2402.4027s
	iters: 200, epoch: 17 | loss: 0.0000030
	speed: 0.0397s/iter; left time: 549.4031s
	iters: 300, epoch: 17 | loss: 0.0000003
	speed: 0.0445s/iter; left time: 611.0648s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 648.2506s
Epoch: 17 cost time: 19.88607621192932
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1980s/iter; left time: 2678.4028s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0499s/iter; left time: 669.7748s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0652s/iter; left time: 869.2897s
	iters: 400, epoch: 18 | loss: 0.0000018
	speed: 0.0502s/iter; left time: 664.6873s
Epoch: 18 cost time: 24.260484218597412
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000004
	speed: 0.1552s/iter; left time: 2035.1579s
	iters: 200, epoch: 19 | loss: 0.0000557
	speed: 0.0548s/iter; left time: 713.5960s
	iters: 300, epoch: 19 | loss: 0.0000002
	speed: 0.0623s/iter; left time: 804.5017s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0611s/iter; left time: 783.1743s
Epoch: 19 cost time: 23.20205855369568
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0751034
	speed: 0.1828s/iter; left time: 2322.8176s
	iters: 200, epoch: 20 | loss: 0.0000004
	speed: 0.0468s/iter; left time: 590.4692s
	iters: 300, epoch: 20 | loss: 0.0007259
	speed: 0.0459s/iter; left time: 573.7219s
	iters: 400, epoch: 20 | loss: 0.0264314
	speed: 0.0384s/iter; left time: 476.2203s
Epoch: 20 cost time: 18.40933918952942
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.976 Test Loss: 0.159 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 29813002
model size : 128.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6371561
	speed: 0.1483s/iter; left time: 3048.6435s
	iters: 200, epoch: 1 | loss: 0.3305381
	speed: 0.1252s/iter; left time: 2560.7605s
	iters: 300, epoch: 1 | loss: 0.8933981
	speed: 0.1071s/iter; left time: 2178.7106s
	iters: 400, epoch: 1 | loss: 0.3279471
	speed: 0.1295s/iter; left time: 2623.4059s
Epoch: 1 cost time: 52.882779359817505
Epoch: 1, Steps: 413 | Train Loss: 0.565 Vali Loss: 0.173 Vali Acc: 0.961 Test Loss: 0.173 Test Acc: 0.961
Validation loss decreased (inf --> -0.961344).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0011084
	speed: 0.4150s/iter; left time: 8356.5487s
	iters: 200, epoch: 2 | loss: 1.2652555
	speed: 0.1072s/iter; left time: 2148.2013s
	iters: 300, epoch: 2 | loss: 0.0018781
	speed: 0.1365s/iter; left time: 2721.6521s
	iters: 400, epoch: 2 | loss: 0.1289475
	speed: 0.1249s/iter; left time: 2477.8513s
Epoch: 2 cost time: 53.947102308273315
Epoch: 2, Steps: 413 | Train Loss: 0.232 Vali Loss: 0.243 Vali Acc: 0.962 Test Loss: 0.243 Test Acc: 0.962
Validation loss decreased (-0.961344 --> -0.961798).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2184676
	speed: 0.4105s/iter; left time: 8097.7181s
	iters: 200, epoch: 3 | loss: 0.0000015
	speed: 0.1250s/iter; left time: 2452.2074s
	iters: 300, epoch: 3 | loss: 0.0467519
	speed: 0.0973s/iter; left time: 1899.5437s
	iters: 400, epoch: 3 | loss: 0.0000184
	speed: 0.1089s/iter; left time: 2114.8878s
Epoch: 3 cost time: 48.94501280784607
Epoch: 3, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
Validation loss decreased (-0.961798 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1149183
	speed: 0.3296s/iter; left time: 6365.0951s
	iters: 200, epoch: 4 | loss: 0.0000111
	speed: 0.1309s/iter; left time: 2515.2993s
	iters: 300, epoch: 4 | loss: 0.0000003
	speed: 0.1340s/iter; left time: 2560.0849s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.1539s/iter; left time: 2926.1742s
Epoch: 4 cost time: 56.2826623916626
Epoch: 4, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.284 Vali Acc: 0.976 Test Loss: 0.284 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000002
	speed: 0.4527s/iter; left time: 8555.8156s
	iters: 200, epoch: 5 | loss: 0.0013992
	speed: 0.1824s/iter; left time: 3428.3924s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.1724s/iter; left time: 3223.9472s
	iters: 400, epoch: 5 | loss: 0.0000293
	speed: 0.1460s/iter; left time: 2716.1909s
Epoch: 5 cost time: 69.92248392105103
Epoch: 5, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.323 Vali Acc: 0.970 Test Loss: 0.323 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2985097
	speed: 0.3163s/iter; left time: 5846.3523s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 1220.5948s
	iters: 300, epoch: 6 | loss: 0.0001558
	speed: 0.0657s/iter; left time: 1200.8786s
	iters: 400, epoch: 6 | loss: 0.0197998
	speed: 0.0806s/iter; left time: 1465.9035s
Epoch: 6 cost time: 31.445557117462158
Epoch: 6, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.233 Vali Acc: 0.982 Test Loss: 0.233 Test Acc: 0.982
Validation loss decreased (-0.977716 --> -0.982262).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002125
	speed: 0.3282s/iter; left time: 5931.0887s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 1753.8767s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.1187s/iter; left time: 2121.5875s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.1200s/iter; left time: 2132.8445s
Epoch: 7 cost time: 47.152833700180054
Epoch: 7, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.423 Vali Acc: 0.967 Test Loss: 0.423 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.2796s/iter; left time: 4938.3880s
	iters: 200, epoch: 8 | loss: 0.0000011
	speed: 0.1259s/iter; left time: 2210.7345s
	iters: 300, epoch: 8 | loss: 3.3107817
	speed: 0.1252s/iter; left time: 2186.3864s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1218s/iter; left time: 2114.6402s
Epoch: 8 cost time: 49.57088565826416
Epoch: 8, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.325 Vali Acc: 0.981 Test Loss: 0.325 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001519
	speed: 0.3993s/iter; left time: 6887.0194s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1334s/iter; left time: 2286.9302s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1121s/iter; left time: 1911.2640s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.1287s/iter; left time: 2181.8165s
Epoch: 9 cost time: 53.58379149436951
Epoch: 9, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.371 Vali Acc: 0.975 Test Loss: 0.371 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3518s/iter; left time: 5922.7046s
	iters: 200, epoch: 10 | loss: 0.5123826
	speed: 0.1104s/iter; left time: 1847.3719s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1137s/iter; left time: 1890.5008s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.1392s/iter; left time: 2301.3083s
Epoch: 10 cost time: 49.98688268661499
Epoch: 10, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.612 Vali Acc: 0.968 Test Loss: 0.612 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.0372808
	speed: 0.3432s/iter; left time: 5635.9515s
	iters: 200, epoch: 11 | loss: 0.0000539
	speed: 0.1273s/iter; left time: 2077.2624s
	iters: 300, epoch: 11 | loss: 0.0000009
	speed: 0.1490s/iter; left time: 2416.1604s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1418s/iter; left time: 2285.5782s
Epoch: 11 cost time: 56.43335843086243
Epoch: 11, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.513 Vali Acc: 0.978 Test Loss: 0.513 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3283085
	speed: 0.3885s/iter; left time: 6219.1477s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1177s/iter; left time: 1872.8746s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.1469s/iter; left time: 2321.8985s
	iters: 400, epoch: 12 | loss: 0.0000006
	speed: 0.1425s/iter; left time: 2238.0737s
Epoch: 12 cost time: 57.835129261016846
Epoch: 12, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.980 Test Loss: 0.296 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3724s/iter; left time: 5807.0220s
	iters: 200, epoch: 13 | loss: 0.0016138
	speed: 0.1345s/iter; left time: 2084.5826s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.1334s/iter; left time: 2054.4485s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1128s/iter; left time: 1725.8754s
Epoch: 13 cost time: 53.32089281082153
Epoch: 13, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.278 Vali Acc: 0.983 Test Loss: 0.278 Test Acc: 0.983
Validation loss decreased (-0.982262 --> -0.983171).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3150s/iter; left time: 4781.9320s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.1128s/iter; left time: 1700.7988s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0997s/iter; left time: 1493.2596s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1104s/iter; left time: 1642.6963s
Epoch: 14 cost time: 44.69462871551514
Epoch: 14, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.567 Vali Acc: 0.980 Test Loss: 0.567 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2941s/iter; left time: 4343.1696s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1344s/iter; left time: 1971.5757s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1396s/iter; left time: 2034.4771s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1403s/iter; left time: 2030.3273s
Epoch: 15 cost time: 53.96593451499939
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.592 Vali Acc: 0.980 Test Loss: 0.592 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3075s/iter; left time: 4413.8716s
	iters: 200, epoch: 16 | loss: 3.2130568
	speed: 0.1235s/iter; left time: 1761.2585s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1226s/iter; left time: 1735.9090s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1448s/iter; left time: 2035.4353s
Epoch: 16 cost time: 51.8718421459198
Epoch: 16, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.384 Vali Acc: 0.984 Test Loss: 0.384 Test Acc: 0.984
Validation loss decreased (-0.983171 --> -0.983625).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3735s/iter; left time: 5207.9445s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.1321s/iter; left time: 1829.0136s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1441s/iter; left time: 1980.1174s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1213s/iter; left time: 1654.8816s
Epoch: 17 cost time: 54.93399953842163
Epoch: 17, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.457 Vali Acc: 0.978 Test Loss: 0.457 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3876s/iter; left time: 5243.8749s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1773s/iter; left time: 2380.7876s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1612s/iter; left time: 2148.7776s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.1504s/iter; left time: 1990.4003s
Epoch: 18 cost time: 65.09771084785461
Epoch: 18, Steps: 413 | Train Loss: 0.025 Vali Loss: 1.085 Vali Acc: 0.966 Test Loss: 1.085 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3922s/iter; left time: 5143.8822s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1358s/iter; left time: 1767.7534s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1227s/iter; left time: 1584.9038s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1240s/iter; left time: 1588.9329s
Epoch: 19 cost time: 54.16834902763367
Epoch: 19, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.441 Vali Acc: 0.985 Test Loss: 0.441 Test Acc: 0.985
Validation loss decreased (-0.983625 --> -0.985444).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2493s/iter; left time: 3167.6954s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1072s/iter; left time: 1350.5783s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 1127.6831s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0884s/iter; left time: 1096.7609s
Epoch: 20 cost time: 37.58914613723755
Epoch: 20, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.283 Vali Acc: 0.989 Test Loss: 0.283 Test Acc: 0.989
Validation loss decreased (-0.985444 --> -0.989083).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.3104s/iter; left time: 3815.7013s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1218s/iter; left time: 1484.5450s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1316s/iter; left time: 1591.0193s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1475s/iter; left time: 1768.8787s
Epoch: 21 cost time: 52.54708218574524
Epoch: 21, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.287 Vali Acc: 0.986 Test Loss: 0.287 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.4508s/iter; left time: 5354.0839s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1298s/iter; left time: 1528.9554s
	iters: 300, epoch: 22 | loss: 3.9998264
	speed: 0.1348s/iter; left time: 1574.7141s
	iters: 400, epoch: 22 | loss: 0.4684629
	speed: 0.1598s/iter; left time: 1849.9916s
Epoch: 22 cost time: 61.28216052055359
Epoch: 22, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.638 Vali Acc: 0.979 Test Loss: 0.638 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.3686s/iter; left time: 4225.9725s
	iters: 200, epoch: 23 | loss: 0.8612023
	speed: 0.1157s/iter; left time: 1315.1750s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.1437s/iter; left time: 1618.6491s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1239s/iter; left time: 1382.9794s
Epoch: 23 cost time: 52.47232365608215
Epoch: 23, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.990 Test Loss: 0.245 Test Acc: 0.990
Validation loss decreased (-0.989083 --> -0.989993).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.3805s/iter; left time: 4204.8196s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 804.0371s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1033s/iter; left time: 1121.1233s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1446s/iter; left time: 1554.8849s
Epoch: 24 cost time: 45.13853621482849
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.327 Vali Acc: 0.988 Test Loss: 0.327 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.3866s/iter; left time: 4113.4124s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.1542s/iter; left time: 1625.4623s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.1395s/iter; left time: 1456.5941s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.1272s/iter; left time: 1314.6685s
Epoch: 25 cost time: 58.07141923904419
Epoch: 25, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.244 Vali Acc: 0.990 Test Loss: 0.244 Test Acc: 0.990
Validation loss decreased (-0.989993 --> -0.989993).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.4323s/iter; left time: 4420.8979s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.1237s/iter; left time: 1252.2263s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1233s/iter; left time: 1235.8561s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 937.0003s
Epoch: 26 cost time: 51.86082220077515
Epoch: 26, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.652 Vali Acc: 0.980 Test Loss: 0.652 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3455s/iter; left time: 3390.2203s
	iters: 200, epoch: 27 | loss: 1.0315850
	speed: 0.1226s/iter; left time: 1190.6835s
	iters: 300, epoch: 27 | loss: 0.0000018
	speed: 0.1116s/iter; left time: 1072.4878s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1267s/iter; left time: 1205.3934s
Epoch: 27 cost time: 50.52563786506653
Epoch: 27, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.542 Vali Acc: 0.980 Test Loss: 0.542 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3334s/iter; left time: 3134.3917s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1405s/iter; left time: 1307.1102s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1151s/iter; left time: 1058.4997s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1562s/iter; left time: 1421.4947s
Epoch: 28 cost time: 56.020368337631226
Epoch: 28, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.558 Vali Acc: 0.984 Test Loss: 0.558 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.4496s/iter; left time: 4040.6573s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.1492s/iter; left time: 1326.2216s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1395s/iter; left time: 1225.6310s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1379s/iter; left time: 1197.8903s
Epoch: 29 cost time: 59.124175786972046
Epoch: 29, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.180 Vali Acc: 0.993 Test Loss: 0.180 Test Acc: 0.993
Validation loss decreased (-0.989993 --> -0.992722).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.3603s/iter; left time: 3088.9614s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.1037s/iter; left time: 878.3720s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 531.5323s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 518.0421s
Epoch: 30 cost time: 35.58374619483948
Epoch: 30, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.993 Test Loss: 0.185 Test Acc: 0.993
Validation loss decreased (-0.992722 --> -0.993177).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2478s/iter; left time: 2022.5787s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 691.7776s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 725.0336s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 846.8487s
Epoch: 31 cost time: 39.482298374176025
Epoch: 31, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.372 Vali Acc: 0.988 Test Loss: 0.372 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.3079s/iter; left time: 2385.8234s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.1118s/iter; left time: 855.1667s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.1399s/iter; left time: 1055.8747s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.1302s/iter; left time: 969.4451s
Epoch: 32 cost time: 47.94658088684082
Epoch: 32, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.416 Vali Acc: 0.987 Test Loss: 0.416 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.3535s/iter; left time: 2593.0087s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.1432s/iter; left time: 1036.3404s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0926s/iter; left time: 660.6923s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0771s/iter; left time: 542.3149s
Epoch: 33 cost time: 45.77685332298279
Epoch: 33, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.986 Test Loss: 0.533 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.3467s/iter; left time: 2399.8932s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.1146s/iter; left time: 781.6538s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.1196s/iter; left time: 803.7712s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.1306s/iter; left time: 864.7018s
Epoch: 34 cost time: 51.81561589241028
Epoch: 34, Steps: 413 | Train Loss: 0.116 Vali Loss: 1.234 Vali Acc: 0.975 Test Loss: 1.234 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.3085s/iter; left time: 2007.7517s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0829s/iter; left time: 531.6085s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.1228s/iter; left time: 774.4761s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.1180s/iter; left time: 732.5171s
Epoch: 35 cost time: 43.22991490364075
Epoch: 35, Steps: 413 | Train Loss: 0.023 Vali Loss: 1.414 Vali Acc: 0.975 Test Loss: 1.414 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.3844s/iter; left time: 2343.5238s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.1273s/iter; left time: 763.3803s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 514.9251s
	iters: 400, epoch: 36 | loss: 0.7872741
	speed: 0.1218s/iter; left time: 705.8496s
Epoch: 36 cost time: 49.922749042510986
Epoch: 36, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.433 Vali Acc: 0.988 Test Loss: 0.433 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2929s/iter; left time: 1664.4744s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 437.9021s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.1030s/iter; left time: 564.5718s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.1124s/iter; left time: 604.9086s
Epoch: 37 cost time: 39.19488310813904
Epoch: 37, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.408 Vali Acc: 0.985 Test Loss: 0.408 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.2797s/iter; left time: 1474.2118s
	iters: 200, epoch: 38 | loss: 1.0938740
	speed: 0.0808s/iter; left time: 417.8531s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 592.3810s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.1091s/iter; left time: 542.3016s
Epoch: 38 cost time: 40.73497295379639
Epoch: 38, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.462 Vali Acc: 0.989 Test Loss: 0.462 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2642s/iter; left time: 1283.1014s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 416.9484s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.1078s/iter; left time: 502.1967s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.1093s/iter; left time: 498.2262s
Epoch: 39 cost time: 41.201380491256714
Epoch: 39, Steps: 413 | Train Loss: 0.086 Vali Loss: 1.295 Vali Acc: 0.977 Test Loss: 1.295 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2356s/iter; left time: 1047.2122s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0960s/iter; left time: 417.1349s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 315.3535s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 334.7837s
Epoch: 40 cost time: 33.997257232666016
Epoch: 40, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.994 Vali Acc: 0.981 Test Loss: 0.994 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9931787175989086
model parameter : 23068426
model size : 102.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5950765
	speed: 0.1372s/iter; left time: 2819.0427s
	iters: 200, epoch: 1 | loss: 0.6852660
	speed: 0.0972s/iter; left time: 1987.9091s
	iters: 300, epoch: 1 | loss: 0.0041271
	speed: 0.1226s/iter; left time: 2495.9414s
	iters: 400, epoch: 1 | loss: 0.0420835
	speed: 0.1008s/iter; left time: 2040.9749s
Epoch: 1 cost time: 46.693188190460205
Epoch: 1, Steps: 413 | Train Loss: 0.537 Vali Loss: 0.249 Vali Acc: 0.947 Test Loss: 0.249 Test Acc: 0.947
Validation loss decreased (inf --> -0.946792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2071072
	speed: 0.2704s/iter; left time: 5446.1130s
	iters: 200, epoch: 2 | loss: 0.1555723
	speed: 0.0831s/iter; left time: 1665.6098s
	iters: 300, epoch: 2 | loss: 0.0154704
	speed: 0.0662s/iter; left time: 1319.8327s
	iters: 400, epoch: 2 | loss: 0.0457012
	speed: 0.0659s/iter; left time: 1307.8434s
Epoch: 2 cost time: 32.049307346343994
Epoch: 2, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
Validation loss decreased (-0.946792 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000056
	speed: 0.2945s/iter; left time: 5809.4395s
	iters: 200, epoch: 3 | loss: 0.0000029
	speed: 0.0720s/iter; left time: 1413.6890s
	iters: 300, epoch: 3 | loss: 0.9760033
	speed: 0.0690s/iter; left time: 1346.9265s
	iters: 400, epoch: 3 | loss: 0.5925884
	speed: 0.0585s/iter; left time: 1136.5197s
Epoch: 3 cost time: 31.714054107666016
Epoch: 3, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.142 Vali Acc: 0.981 Test Loss: 0.142 Test Acc: 0.981
Validation loss decreased (-0.962254 --> -0.980899).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004674
	speed: 0.2520s/iter; left time: 4867.4230s
	iters: 200, epoch: 4 | loss: 0.0000363
	speed: 0.0614s/iter; left time: 1179.9394s
	iters: 300, epoch: 4 | loss: 0.0005375
	speed: 0.0542s/iter; left time: 1035.4449s
	iters: 400, epoch: 4 | loss: 0.0012466
	speed: 0.0689s/iter; left time: 1309.2618s
Epoch: 4 cost time: 26.71181011199951
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000032
	speed: 0.2333s/iter; left time: 4410.0029s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1651.7759s
	iters: 300, epoch: 5 | loss: 0.0000004
	speed: 0.0847s/iter; left time: 1583.7181s
	iters: 400, epoch: 5 | loss: 0.0388747
	speed: 0.0691s/iter; left time: 1284.7618s
Epoch: 5 cost time: 33.70867872238159
Epoch: 5, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.317 Vali Acc: 0.968 Test Loss: 0.317 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4924302
	speed: 0.2326s/iter; left time: 4300.3519s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 1711.3798s
	iters: 300, epoch: 6 | loss: 0.6683025
	speed: 0.0957s/iter; left time: 1750.5430s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 1356.5256s
Epoch: 6 cost time: 36.36045479774475
Epoch: 6, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2102s/iter; left time: 3798.7344s
	iters: 200, epoch: 7 | loss: 0.0000277
	speed: 0.1086s/iter; left time: 1951.2196s
	iters: 300, epoch: 7 | loss: 0.0000011
	speed: 0.1026s/iter; left time: 1833.0990s
	iters: 400, epoch: 7 | loss: 0.0405680
	speed: 0.1001s/iter; left time: 1778.3910s
Epoch: 7 cost time: 39.95409369468689
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000708
	speed: 0.2571s/iter; left time: 4541.0734s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1035s/iter; left time: 1817.2141s
	iters: 300, epoch: 8 | loss: 0.0009791
	speed: 0.0982s/iter; left time: 1714.4886s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1024s/iter; left time: 1777.8232s
Epoch: 8 cost time: 39.30500245094299
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.187 Vali Acc: 0.979 Test Loss: 0.187 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000034
	speed: 0.1797s/iter; left time: 3098.6581s
	iters: 200, epoch: 9 | loss: 0.0000005
	speed: 0.0489s/iter; left time: 838.3110s
	iters: 300, epoch: 9 | loss: 0.0000005
	speed: 0.0952s/iter; left time: 1622.9415s
	iters: 400, epoch: 9 | loss: 0.0087947
	speed: 0.1099s/iter; left time: 1861.8887s
Epoch: 9 cost time: 32.366520166397095
Epoch: 9, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.981 Test Loss: 0.211 Test Acc: 0.981
Validation loss decreased (-0.980899 --> -0.981353).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0132300
	speed: 0.2259s/iter; left time: 3802.9095s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.0525s/iter; left time: 879.2818s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 1127.7016s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 1169.9541s
Epoch: 10 cost time: 26.32994294166565
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.987 Test Loss: 0.138 Test Acc: 0.987
Validation loss decreased (-0.981353 --> -0.986811).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000045
	speed: 0.3304s/iter; left time: 5424.7579s
	iters: 200, epoch: 11 | loss: 0.0000005
	speed: 0.0818s/iter; left time: 1334.5699s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 1281.1337s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1095s/iter; left time: 1765.1064s
Epoch: 11 cost time: 38.04941201210022
Epoch: 11, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.317 Vali Acc: 0.979 Test Loss: 0.317 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2879s/iter; left time: 4608.6080s
	iters: 200, epoch: 12 | loss: 0.0000003
	speed: 0.0774s/iter; left time: 1231.7503s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0789s/iter; left time: 1248.0382s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 1085.3340s
Epoch: 12 cost time: 33.419533252716064
Epoch: 12, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.205 Vali Acc: 0.986 Test Loss: 0.205 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2455s/iter; left time: 3827.9284s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 1118.4858s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 1128.1901s
	iters: 400, epoch: 13 | loss: 0.0000017
	speed: 0.0645s/iter; left time: 986.9562s
Epoch: 13 cost time: 29.3465313911438
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.468 Vali Acc: 0.972 Test Loss: 0.468 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2515s/iter; left time: 3817.6251s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 926.4509s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 1239.1173s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.1190s/iter; left time: 1770.3782s
Epoch: 14 cost time: 36.35885691642761
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.378 Vali Acc: 0.976 Test Loss: 0.378 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000148
	speed: 0.2432s/iter; left time: 3591.4784s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 1083.8115s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 1078.4491s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 819.8779s
Epoch: 15 cost time: 28.520057439804077
Epoch: 15, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3059s/iter; left time: 4391.6586s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1116s/iter; left time: 1590.9794s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 1654.0376s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0916s/iter; left time: 1286.8471s
Epoch: 16 cost time: 45.237703800201416
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.267 Vali Acc: 0.983 Test Loss: 0.267 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.3243s/iter; left time: 4521.5673s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0977s/iter; left time: 1352.2895s
	iters: 300, epoch: 17 | loss: 0.0000129
	speed: 0.0887s/iter; left time: 1218.6580s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 1144.6128s
Epoch: 17 cost time: 40.602965354919434
Epoch: 17, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.351 Vali Acc: 0.985 Test Loss: 0.351 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2725s/iter; left time: 3686.4796s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 916.7314s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0851s/iter; left time: 1134.3150s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.0836s/iter; left time: 1105.7604s
Epoch: 18 cost time: 33.268999338150024
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.985 Test Loss: 0.271 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2601s/iter; left time: 3411.6451s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 903.9946s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 823.3817s
	iters: 400, epoch: 19 | loss: 0.0000029
	speed: 0.0734s/iter; left time: 940.9303s
Epoch: 19 cost time: 29.39296245574951
Epoch: 19, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.420 Vali Acc: 0.982 Test Loss: 0.420 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.2907742
	speed: 0.2287s/iter; left time: 2905.4163s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 774.5201s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 710.9477s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 972.8706s
Epoch: 20 cost time: 27.28670644760132
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.341 Vali Acc: 0.985 Test Loss: 0.341 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 22653706
model size : 101.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4180346
	speed: 0.1091s/iter; left time: 2241.6717s
	iters: 200, epoch: 1 | loss: 0.1082725
	speed: 0.0703s/iter; left time: 1436.6963s
	iters: 300, epoch: 1 | loss: 0.8717002
	speed: 0.0662s/iter; left time: 1346.5271s
	iters: 400, epoch: 1 | loss: 0.0169908
	speed: 0.0651s/iter; left time: 1319.0102s
Epoch: 1 cost time: 32.02197194099426
Epoch: 1, Steps: 413 | Train Loss: 0.533 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (inf --> -0.979081).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0083851
	speed: 0.2369s/iter; left time: 4771.4324s
	iters: 200, epoch: 2 | loss: 0.0993692
	speed: 0.0720s/iter; left time: 1441.9168s
	iters: 300, epoch: 2 | loss: 0.1006566
	speed: 0.0644s/iter; left time: 1283.0659s
	iters: 400, epoch: 2 | loss: 0.0002465
	speed: 0.0706s/iter; left time: 1399.8237s
Epoch: 2 cost time: 29.50890040397644
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5480452
	speed: 0.2401s/iter; left time: 4736.4174s
	iters: 200, epoch: 3 | loss: 0.0001781
	speed: 0.0634s/iter; left time: 1244.3898s
	iters: 300, epoch: 3 | loss: 0.0068234
	speed: 0.0668s/iter; left time: 1303.9439s
	iters: 400, epoch: 3 | loss: 0.0000193
	speed: 0.0592s/iter; left time: 1150.5197s
Epoch: 3 cost time: 29.169383764266968
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0049927
	speed: 0.2576s/iter; left time: 4975.3137s
	iters: 200, epoch: 4 | loss: 0.0204682
	speed: 0.0671s/iter; left time: 1288.4794s
	iters: 300, epoch: 4 | loss: 0.1140487
	speed: 0.0595s/iter; left time: 1137.3712s
	iters: 400, epoch: 4 | loss: 0.0073998
	speed: 0.0630s/iter; left time: 1198.2871s
Epoch: 4 cost time: 29.64225745201111
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.982264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0011306
	speed: 0.2544s/iter; left time: 4808.7324s
	iters: 200, epoch: 5 | loss: 0.0000815
	speed: 0.0762s/iter; left time: 1431.6088s
	iters: 300, epoch: 5 | loss: 0.1939048
	speed: 0.0608s/iter; left time: 1136.2293s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0972s/iter; left time: 1808.5666s
Epoch: 5 cost time: 32.23716139793396
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000243
	speed: 0.2124s/iter; left time: 3926.3934s
	iters: 200, epoch: 6 | loss: 0.0000081
	speed: 0.0586s/iter; left time: 1077.4445s
	iters: 300, epoch: 6 | loss: 0.0001288
	speed: 0.0680s/iter; left time: 1243.0600s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 1180.3976s
Epoch: 6 cost time: 27.654804706573486
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.2362s/iter; left time: 4268.7996s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0718s/iter; left time: 1290.8254s
	iters: 300, epoch: 7 | loss: 0.0013318
	speed: 0.0600s/iter; left time: 1071.8727s
	iters: 400, epoch: 7 | loss: 0.1696659
	speed: 0.0543s/iter; left time: 965.9260s
Epoch: 7 cost time: 28.422868728637695
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.360 Vali Acc: 0.971 Test Loss: 0.360 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000024
	speed: 0.1999s/iter; left time: 3530.6224s
	iters: 200, epoch: 8 | loss: 0.0000017
	speed: 0.0492s/iter; left time: 863.9206s
	iters: 300, epoch: 8 | loss: 0.0000901
	speed: 0.0478s/iter; left time: 835.4280s
	iters: 400, epoch: 8 | loss: 0.0001899
	speed: 0.0500s/iter; left time: 868.3394s
Epoch: 8 cost time: 22.377023696899414
Epoch: 8, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2672107
	speed: 0.1508s/iter; left time: 2600.8417s
	iters: 200, epoch: 9 | loss: 0.0000220
	speed: 0.0507s/iter; left time: 869.0617s
	iters: 300, epoch: 9 | loss: 0.0218632
	speed: 0.0480s/iter; left time: 818.3564s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0327s/iter; left time: 553.4215s
Epoch: 9 cost time: 18.220882892608643
Epoch: 9, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000187
	speed: 0.1766s/iter; left time: 2972.6234s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0709s/iter; left time: 1185.9948s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0724s/iter; left time: 1203.6087s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 580.3412s
Epoch: 10 cost time: 23.773961067199707
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.215 Vali Acc: 0.978 Test Loss: 0.215 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1808s/iter; left time: 2968.7403s
	iters: 200, epoch: 11 | loss: 0.0000025
	speed: 0.0658s/iter; left time: 1074.0503s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 1216.3689s
	iters: 400, epoch: 11 | loss: 0.0002033
	speed: 0.0538s/iter; left time: 867.7469s
Epoch: 11 cost time: 25.854417085647583
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.307 Vali Acc: 0.973 Test Loss: 0.307 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0059768
	speed: 0.2301s/iter; left time: 3683.4913s
	iters: 200, epoch: 12 | loss: 0.0001582
	speed: 0.0777s/iter; left time: 1235.2785s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0693s/iter; left time: 1096.1677s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0698s/iter; left time: 1097.0429s
Epoch: 12 cost time: 31.301080226898193
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.984 Test Loss: 0.182 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.984082).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.2667s/iter; left time: 4159.4660s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0536s/iter; left time: 830.4682s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.0571s/iter; left time: 878.9018s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 824.2728s
Epoch: 13 cost time: 25.5010666847229
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.982 Test Loss: 0.156 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000251
	speed: 0.2143s/iter; left time: 3254.2305s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0512s/iter; left time: 772.4727s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0504s/iter; left time: 755.3188s
	iters: 400, epoch: 14 | loss: 0.0000004
	speed: 0.0384s/iter; left time: 571.4202s
Epoch: 14 cost time: 21.686574697494507
Epoch: 14, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.985 Test Loss: 0.218 Test Acc: 0.985
Validation loss decreased (-0.984082 --> -0.984536).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1933s/iter; left time: 2855.2518s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0835s/iter; left time: 1224.9722s
	iters: 300, epoch: 15 | loss: 0.0000592
	speed: 0.0590s/iter; left time: 859.2414s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0449s/iter; left time: 649.3206s
Epoch: 15 cost time: 26.321181774139404
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.385 Vali Acc: 0.978 Test Loss: 0.385 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1557s/iter; left time: 2235.0002s
	iters: 200, epoch: 16 | loss: 0.0000245
	speed: 0.0564s/iter; left time: 804.2673s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 941.4843s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 798.3678s
Epoch: 16 cost time: 23.78366708755493
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.273 Vali Acc: 0.983 Test Loss: 0.273 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1585s/iter; left time: 2209.6997s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 631.2782s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 928.7937s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 1067.4735s
Epoch: 17 cost time: 25.09389305114746
Epoch: 17, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.981 Test Loss: 0.226 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2353s/iter; left time: 3183.0897s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 920.0220s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0843s/iter; left time: 1124.0207s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 804.1442s
Epoch: 18 cost time: 29.787949800491333
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.259 Vali Acc: 0.983 Test Loss: 0.259 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2258s/iter; left time: 2961.6073s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 990.8984s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 898.3703s
	iters: 400, epoch: 19 | loss: 0.0002179
	speed: 0.0664s/iter; left time: 850.6774s
Epoch: 19 cost time: 31.152071714401245
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.375 Vali Acc: 0.977 Test Loss: 0.375 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1928s/iter; left time: 2449.1072s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 638.2577s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 577.9439s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 508.7014s
Epoch: 20 cost time: 21.445176362991333
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.271 Vali Acc: 0.984 Test Loss: 0.271 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1709s/iter; left time: 2100.6792s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 698.6738s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 487.9718s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 503.8802s
Epoch: 21 cost time: 20.500608205795288
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.985 Test Loss: 0.195 Test Acc: 0.985
Validation loss decreased (-0.984536 --> -0.984536).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1720s/iter; left time: 2042.7178s
	iters: 200, epoch: 22 | loss: 0.0000034
	speed: 0.0468s/iter; left time: 550.7035s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 511.1618s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0407s/iter; left time: 470.7769s
Epoch: 22 cost time: 19.204190492630005
Epoch: 22, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.986 Test Loss: 0.171 Test Acc: 0.986
Validation loss decreased (-0.984536 --> -0.986356).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2068s/iter; left time: 2371.1233s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 766.5945s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 662.0700s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 556.2439s
Epoch: 23 cost time: 25.130314826965332
Epoch: 23, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.355 Vali Acc: 0.978 Test Loss: 0.355 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2227s/iter; left time: 2461.3878s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 722.4924s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 828.2550s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 889.8819s
Epoch: 24 cost time: 31.70184636116028
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.987 Test Loss: 0.155 Test Acc: 0.987
Validation loss decreased (-0.986356 --> -0.987265).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2571s/iter; left time: 2735.6847s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0720s/iter; left time: 758.8722s
	iters: 300, epoch: 25 | loss: 0.7441384
	speed: 0.0724s/iter; left time: 755.6669s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0708s/iter; left time: 732.4287s
Epoch: 25 cost time: 30.377631425857544
Epoch: 25, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.253 Vali Acc: 0.982 Test Loss: 0.253 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000655
	speed: 0.1857s/iter; left time: 1899.2841s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 613.9777s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 646.0417s
	iters: 400, epoch: 26 | loss: 0.5353312
	speed: 0.0650s/iter; left time: 645.6117s
Epoch: 26 cost time: 25.50122570991516
Epoch: 26, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.336 Vali Acc: 0.980 Test Loss: 0.336 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2075s/iter; left time: 2036.4108s
	iters: 200, epoch: 27 | loss: 0.0007917
	speed: 0.0619s/iter; left time: 600.9284s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 558.1896s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.0719s/iter; left time: 684.2714s
Epoch: 27 cost time: 27.128708362579346
Epoch: 27, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.337 Vali Acc: 0.985 Test Loss: 0.337 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2390s/iter; left time: 2246.5816s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 586.7234s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 554.2794s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 319.6216s
Epoch: 28 cost time: 25.521159172058105
Epoch: 28, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.981 Test Loss: 0.280 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2044s/iter; left time: 1836.6691s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 804.4632s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0834s/iter; left time: 732.4287s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0781s/iter; left time: 678.8364s
Epoch: 29 cost time: 34.715983629226685
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.484 Vali Acc: 0.976 Test Loss: 0.484 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2374s/iter; left time: 2035.8028s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 654.0847s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 527.3230s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 659.8529s
Epoch: 30 cost time: 31.23252296447754
Epoch: 30, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.338 Vali Acc: 0.982 Test Loss: 0.338 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2395s/iter; left time: 1954.9519s
	iters: 200, epoch: 31 | loss: 0.0000285
	speed: 0.0807s/iter; left time: 650.7150s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 426.1109s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 609.7780s
Epoch: 31 cost time: 30.171974182128906
Epoch: 31, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.174 Vali Acc: 0.989 Test Loss: 0.174 Test Acc: 0.989
Validation loss decreased (-0.987265 --> -0.989084).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2425s/iter; left time: 1878.9392s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 609.3704s
	iters: 300, epoch: 32 | loss: 0.0179216
	speed: 0.0786s/iter; left time: 592.9799s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 559.5534s
Epoch: 32 cost time: 32.95748543739319
Epoch: 32, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.986 Test Loss: 0.212 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2136s/iter; left time: 1566.6027s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 484.3403s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0653s/iter; left time: 465.8635s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 414.1894s
Epoch: 33 cost time: 27.67509150505066
Epoch: 33, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.988 Test Loss: 0.161 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2660s/iter; left time: 1841.0386s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 645.8907s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 548.6619s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 567.7906s
Epoch: 34 cost time: 36.73631238937378
Epoch: 34, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.470 Vali Acc: 0.979 Test Loss: 0.470 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2170s/iter; left time: 1412.7081s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 556.2157s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 561.4051s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0815s/iter; left time: 505.9906s
Epoch: 35 cost time: 34.12763690948486
Epoch: 35, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.317 Vali Acc: 0.982 Test Loss: 0.317 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2354s/iter; left time: 1435.2740s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 454.6077s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0876s/iter; left time: 516.2922s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 374.2160s
Epoch: 36 cost time: 31.48218059539795
Epoch: 36, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.990 Test Loss: 0.190 Test Acc: 0.990
Validation loss decreased (-0.989084 --> -0.989539).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2547s/iter; left time: 1447.4232s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0795s/iter; left time: 443.8683s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 445.4320s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0794s/iter; left time: 427.5203s
Epoch: 37 cost time: 33.84560465812683
Epoch: 37, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.988 Test Loss: 0.193 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1949s/iter; left time: 1027.0269s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 303.7458s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 374.7865s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 368.0773s
Epoch: 38 cost time: 27.544386863708496
Epoch: 38, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.990 Test Loss: 0.235 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0082349
	speed: 0.1929s/iter; left time: 937.0404s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 234.1585s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0417s/iter; left time: 194.3052s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 288.9358s
Epoch: 39 cost time: 22.09932017326355
Epoch: 39, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.319 Vali Acc: 0.984 Test Loss: 0.319 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2241s/iter; left time: 995.7008s
	iters: 200, epoch: 40 | loss: 0.0000028
	speed: 0.0829s/iter; left time: 359.9200s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 356.1185s
	iters: 400, epoch: 40 | loss: 0.5829746
	speed: 0.0861s/iter; left time: 356.9794s
Epoch: 40 cost time: 34.2281973361969
Epoch: 40, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.549 Vali Acc: 0.982 Test Loss: 0.549 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2126s/iter; left time: 856.8248s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0607s/iter; left time: 238.4601s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0543s/iter; left time: 208.0659s
	iters: 400, epoch: 41 | loss: 0.0252149
	speed: 0.0769s/iter; left time: 287.0639s
Epoch: 41 cost time: 26.110655784606934
Epoch: 41, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.403 Vali Acc: 0.987 Test Loss: 0.403 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.2564s/iter; left time: 927.7846s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0731s/iter; left time: 257.3263s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 211.3791s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0495s/iter; left time: 164.1205s
Epoch: 42 cost time: 27.867367267608643
Epoch: 42, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.428 Vali Acc: 0.984 Test Loss: 0.428 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.2078s/iter; left time: 666.1456s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0560s/iter; left time: 174.0249s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 174.6819s
	iters: 400, epoch: 43 | loss: 0.0000047
	speed: 0.0547s/iter; left time: 158.7872s
Epoch: 43 cost time: 24.574179649353027
Epoch: 43, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.520 Vali Acc: 0.977 Test Loss: 0.520 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.1895s/iter; left time: 529.0044s
	iters: 200, epoch: 44 | loss: 0.1915021
	speed: 0.0546s/iter; left time: 146.9458s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 156.5455s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 136.8752s
Epoch: 44 cost time: 23.494759559631348
Epoch: 44, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.313 Vali Acc: 0.986 Test Loss: 0.313 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0033669
	speed: 0.2324s/iter; left time: 552.7996s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 164.7113s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 104.3388s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 91.1954s
Epoch: 45 cost time: 25.52947235107422
Epoch: 45, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.371 Vali Acc: 0.984 Test Loss: 0.371 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.2269s/iter; left time: 446.1348s
	iters: 200, epoch: 46 | loss: 0.0000000
	speed: 0.0714s/iter; left time: 133.2836s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 163.7849s
	iters: 400, epoch: 46 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 147.7706s
Epoch: 46 cost time: 34.65151929855347
Epoch: 46, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.310 Vali Acc: 0.986 Test Loss: 0.310 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 22450954
model size : 100.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6460858
	speed: 0.1296s/iter; left time: 2663.7557s
	iters: 200, epoch: 1 | loss: 0.0046628
	speed: 0.1047s/iter; left time: 2141.1127s
	iters: 300, epoch: 1 | loss: 0.0600813
	speed: 0.1130s/iter; left time: 2299.5483s
	iters: 400, epoch: 1 | loss: 0.1458518
	speed: 0.1007s/iter; left time: 2039.0014s
Epoch: 1 cost time: 45.81537437438965
Epoch: 1, Steps: 413 | Train Loss: 0.538 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0225977
	speed: 0.1905s/iter; left time: 3837.0182s
	iters: 200, epoch: 2 | loss: 0.2612518
	speed: 0.0667s/iter; left time: 1335.9582s
	iters: 300, epoch: 2 | loss: 0.5971459
	speed: 0.0749s/iter; left time: 1493.2064s
	iters: 400, epoch: 2 | loss: 0.1212033
	speed: 0.0769s/iter; left time: 1524.5527s
Epoch: 2 cost time: 28.79578948020935
Epoch: 2, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0271212
	speed: 0.2318s/iter; left time: 4572.6377s
	iters: 200, epoch: 3 | loss: 0.0000017
	speed: 0.0885s/iter; left time: 1736.7203s
	iters: 300, epoch: 3 | loss: 0.0000201
	speed: 0.0711s/iter; left time: 1387.7131s
	iters: 400, epoch: 3 | loss: 0.0000020
	speed: 0.0743s/iter; left time: 1443.3155s
Epoch: 3 cost time: 32.765469789505005
Epoch: 3, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0001289
	speed: 0.2481s/iter; left time: 4790.8473s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.0853s/iter; left time: 1639.4117s
	iters: 300, epoch: 4 | loss: 0.0000100
	speed: 0.0892s/iter; left time: 1704.9719s
	iters: 400, epoch: 4 | loss: 0.0000029
	speed: 0.0612s/iter; left time: 1163.8496s
Epoch: 4 cost time: 33.60303092002869
Epoch: 4, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.972714 --> -0.977261).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.3098s/iter; left time: 5854.9969s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 1700.1861s
	iters: 300, epoch: 5 | loss: 0.0000002
	speed: 0.0953s/iter; left time: 1781.9900s
	iters: 400, epoch: 5 | loss: 0.0000027
	speed: 0.1080s/iter; left time: 2007.7955s
Epoch: 5 cost time: 40.45687818527222
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.978 Test Loss: 0.153 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.978170).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0035843
	speed: 0.2699s/iter; left time: 4989.5530s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 1078.0605s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 1334.9151s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0810s/iter; left time: 1473.1670s
Epoch: 6 cost time: 31.047609567642212
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
Validation loss decreased (-0.978170 --> -0.982718).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4908782
	speed: 0.2694s/iter; left time: 4869.2507s
	iters: 200, epoch: 7 | loss: 0.4761125
	speed: 0.0805s/iter; left time: 1446.8294s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0672s/iter; left time: 1200.7869s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 1355.6843s
Epoch: 7 cost time: 32.49378514289856
Epoch: 7, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.073 Vali Acc: 0.988 Test Loss: 0.073 Test Acc: 0.988
Validation loss decreased (-0.982718 --> -0.987721).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2320952
	speed: 0.2762s/iter; left time: 4877.1134s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 1132.5830s
	iters: 300, epoch: 8 | loss: 0.0000014
	speed: 0.0733s/iter; left time: 1279.9745s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0810s/iter; left time: 1405.6299s
Epoch: 8 cost time: 29.5386221408844
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000139
	speed: 0.2488s/iter; left time: 4290.8196s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 1846.1147s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0967s/iter; left time: 1647.9064s
	iters: 400, epoch: 9 | loss: 0.0022340
	speed: 0.0864s/iter; left time: 1465.0420s
Epoch: 9 cost time: 39.59311270713806
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.981 Test Loss: 0.253 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0005873
	speed: 0.2600s/iter; left time: 4376.2941s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0961s/iter; left time: 1607.3059s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0936s/iter; left time: 1557.4154s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0932s/iter; left time: 1540.3875s
Epoch: 10 cost time: 39.21861910820007
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.229 Vali Acc: 0.985 Test Loss: 0.229 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2102s/iter; left time: 3451.0334s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 1201.6880s
	iters: 300, epoch: 11 | loss: 0.0000240
	speed: 0.0787s/iter; left time: 1276.6130s
	iters: 400, epoch: 11 | loss: 0.0000099
	speed: 0.0810s/iter; left time: 1305.7459s
Epoch: 11 cost time: 31.743355751037598
Epoch: 11, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.133 Vali Acc: 0.985 Test Loss: 0.133 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0001722
	speed: 0.2268s/iter; left time: 3629.9360s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 938.7147s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0835s/iter; left time: 1319.6777s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0904s/iter; left time: 1420.0927s
Epoch: 12 cost time: 30.915162324905396
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.981 Test Loss: 0.299 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2561s/iter; left time: 3994.3446s
	iters: 200, epoch: 13 | loss: 0.0000007
	speed: 0.0801s/iter; left time: 1240.9740s
	iters: 300, epoch: 13 | loss: 0.0014559
	speed: 0.0802s/iter; left time: 1234.5781s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0665s/iter; left time: 1016.6151s
Epoch: 13 cost time: 32.29846215248108
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.987 Test Loss: 0.207 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2386s/iter; left time: 3622.4001s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 1304.8483s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 1295.4592s
	iters: 400, epoch: 14 | loss: 0.0067669
	speed: 0.0834s/iter; left time: 1240.7059s
Epoch: 14 cost time: 36.676422119140625
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.989 Test Loss: 0.115 Test Acc: 0.989
Validation loss decreased (-0.987721 --> -0.988630).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000174
	speed: 0.1917s/iter; left time: 2830.5037s
	iters: 200, epoch: 15 | loss: 0.0000791
	speed: 0.0551s/iter; left time: 808.9611s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 1046.0505s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 1229.7031s
Epoch: 15 cost time: 27.395572662353516
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.313 Vali Acc: 0.983 Test Loss: 0.313 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2243s/iter; left time: 3220.2153s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0644s/iter; left time: 918.0676s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 1136.6146s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 986.1840s
Epoch: 16 cost time: 29.330729246139526
Epoch: 16, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.197 Vali Acc: 0.986 Test Loss: 0.197 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1627s/iter; left time: 2268.6434s
	iters: 200, epoch: 17 | loss: 0.0347249
	speed: 0.0521s/iter; left time: 721.0556s
	iters: 300, epoch: 17 | loss: 0.0000020
	speed: 0.0672s/iter; left time: 923.3033s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 978.8214s
Epoch: 17 cost time: 24.9158136844635
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.989 Test Loss: 0.161 Test Acc: 0.989
Validation loss decreased (-0.988630 --> -0.989084).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000177
	speed: 0.2452s/iter; left time: 3317.9841s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 931.6290s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 1127.1097s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 1141.8515s
Epoch: 18 cost time: 33.55978775024414
Epoch: 18, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.985 Test Loss: 0.222 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2638s/iter; left time: 3460.7631s
	iters: 200, epoch: 19 | loss: 1.4906031
	speed: 0.0896s/iter; left time: 1166.5330s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 1273.0142s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1133s/iter; left time: 1451.7231s
Epoch: 19 cost time: 40.48601961135864
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.584 Vali Acc: 0.977 Test Loss: 0.584 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.9276819
	speed: 0.2892s/iter; left time: 3674.4166s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 886.9741s
	iters: 300, epoch: 20 | loss: 0.1423768
	speed: 0.0835s/iter; left time: 1044.6924s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 827.3042s
Epoch: 20 cost time: 33.35598969459534
Epoch: 20, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.162 Vali Acc: 0.990 Test Loss: 0.162 Test Acc: 0.990
Validation loss decreased (-0.989084 --> -0.990449).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2360s/iter; left time: 2901.0986s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 984.7649s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 952.6835s
	iters: 400, epoch: 21 | loss: 1.5393152
	speed: 0.0767s/iter; left time: 920.0500s
Epoch: 21 cost time: 32.11180591583252
Epoch: 21, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.431 Vali Acc: 0.980 Test Loss: 0.431 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2497s/iter; left time: 2965.5348s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0973s/iter; left time: 1145.5607s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 1015.4717s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0951s/iter; left time: 1101.5510s
Epoch: 22 cost time: 38.59069275856018
Epoch: 22, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.331 Vali Acc: 0.982 Test Loss: 0.331 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2603s/iter; left time: 2983.9034s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 754.3409s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 809.3931s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1014s/iter; left time: 1132.3834s
Epoch: 23 cost time: 35.58751630783081
Epoch: 23, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.432 Vali Acc: 0.978 Test Loss: 0.432 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2776s/iter; left time: 3068.5192s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0850s/iter; left time: 931.0391s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.1130s/iter; left time: 1226.4660s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0947s/iter; left time: 1018.3212s
Epoch: 24 cost time: 40.18556261062622
Epoch: 24, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.987 Test Loss: 0.271 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2003s/iter; left time: 2130.7970s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 527.1460s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 524.1789s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 728.3184s
Epoch: 25 cost time: 22.664916038513184
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.270 Vali Acc: 0.982 Test Loss: 0.270 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1798115
	speed: 0.2112s/iter; left time: 2159.4580s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0783s/iter; left time: 793.3588s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 822.3785s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 717.3499s
Epoch: 26 cost time: 31.591057777404785
Epoch: 26, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.383 Vali Acc: 0.986 Test Loss: 0.383 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2171s/iter; left time: 2130.4597s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 671.4823s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 795.0088s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.1137s/iter; left time: 1082.0305s
Epoch: 27 cost time: 34.88438391685486
Epoch: 27, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.983 Test Loss: 0.519 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3597s/iter; left time: 3381.1591s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0836s/iter; left time: 777.0399s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 844.9950s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1106s/iter; left time: 1006.8311s
Epoch: 28 cost time: 42.87686109542847
Epoch: 28, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.325 Vali Acc: 0.990 Test Loss: 0.325 Test Acc: 0.990
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 2521.2560s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 507.6779s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 524.8354s
	iters: 400, epoch: 29 | loss: 0.0004070
	speed: 0.0695s/iter; left time: 603.9859s
Epoch: 29 cost time: 26.820945978164673
Epoch: 29, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.986 Test Loss: 0.436 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1726s/iter; left time: 1479.4529s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 463.5222s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 599.2522s
	iters: 400, epoch: 30 | loss: 0.0000015
	speed: 0.0575s/iter; left time: 475.8092s
Epoch: 30 cost time: 24.150770664215088
Epoch: 30, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.405 Vali Acc: 0.987 Test Loss: 0.405 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 22683658
model size : 101.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1426478
	speed: 0.0653s/iter; left time: 1341.0108s
	iters: 200, epoch: 1 | loss: 0.0269748
	speed: 0.0273s/iter; left time: 559.3288s
	iters: 300, epoch: 1 | loss: 0.0255129
	speed: 0.0385s/iter; left time: 782.7042s
	iters: 400, epoch: 1 | loss: 0.3984381
	speed: 0.0306s/iter; left time: 619.2101s
Epoch: 1 cost time: 16.63733410835266
Epoch: 1, Steps: 413 | Train Loss: 0.516 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0031935
	speed: 0.2133s/iter; left time: 4295.9065s
	iters: 200, epoch: 2 | loss: 0.0083630
	speed: 0.0915s/iter; left time: 1832.4934s
	iters: 300, epoch: 2 | loss: 0.0000975
	speed: 0.0971s/iter; left time: 1936.5553s
	iters: 400, epoch: 2 | loss: 0.0135783
	speed: 0.0701s/iter; left time: 1390.1708s
Epoch: 2 cost time: 36.10919117927551
Epoch: 2, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.318 Vali Acc: 0.952 Test Loss: 0.318 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0068755
	speed: 0.2200s/iter; left time: 4338.7053s
	iters: 200, epoch: 3 | loss: 0.1258233
	speed: 0.0775s/iter; left time: 1520.7942s
	iters: 300, epoch: 3 | loss: 0.0106056
	speed: 0.0858s/iter; left time: 1674.5374s
	iters: 400, epoch: 3 | loss: 0.0000416
	speed: 0.0885s/iter; left time: 1719.7798s
Epoch: 3 cost time: 35.61690020561218
Epoch: 3, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.975443 --> -0.981354).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6183974
	speed: 0.2247s/iter; left time: 4339.1721s
	iters: 200, epoch: 4 | loss: 0.0019980
	speed: 0.0526s/iter; left time: 1010.1837s
	iters: 300, epoch: 4 | loss: 0.0009609
	speed: 0.0636s/iter; left time: 1216.0065s
	iters: 400, epoch: 4 | loss: 0.0000626
	speed: 0.0678s/iter; left time: 1289.3056s
Epoch: 4 cost time: 25.742064952850342
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2356389
	speed: 0.2171s/iter; left time: 4103.3901s
	iters: 200, epoch: 5 | loss: 0.0000033
	speed: 0.0731s/iter; left time: 1374.7718s
	iters: 300, epoch: 5 | loss: 0.0000023
	speed: 0.0814s/iter; left time: 1521.9710s
	iters: 400, epoch: 5 | loss: 0.0183756
	speed: 0.0754s/iter; left time: 1401.8711s
Epoch: 5 cost time: 31.028549671173096
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.309 Vali Acc: 0.959 Test Loss: 0.309 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0005283
	speed: 0.1972s/iter; left time: 3645.4622s
	iters: 200, epoch: 6 | loss: 1.2093394
	speed: 0.0965s/iter; left time: 1773.6969s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 1534.9203s
	iters: 400, epoch: 6 | loss: 0.0000701
	speed: 0.1037s/iter; left time: 1886.4512s
Epoch: 6 cost time: 34.73321080207825
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.968 Test Loss: 0.249 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2653s/iter; left time: 4795.0181s
	iters: 200, epoch: 7 | loss: 0.0108037
	speed: 0.0898s/iter; left time: 1613.6874s
	iters: 300, epoch: 7 | loss: 0.0473264
	speed: 0.0986s/iter; left time: 1762.3085s
	iters: 400, epoch: 7 | loss: 0.0000014
	speed: 0.0662s/iter; left time: 1176.0458s
Epoch: 7 cost time: 35.333494424819946
Epoch: 7, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.256 Vali Acc: 0.974 Test Loss: 0.256 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2355s/iter; left time: 4158.9782s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 1368.0583s
	iters: 300, epoch: 8 | loss: 0.0000027
	speed: 0.0700s/iter; left time: 1221.9593s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 989.0603s
Epoch: 8 cost time: 30.848037481307983
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2299s/iter; left time: 3964.3780s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0854s/iter; left time: 1464.4721s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 1191.4554s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0706s/iter; left time: 1195.9706s
Epoch: 9 cost time: 31.48067808151245
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000229
	speed: 0.1989s/iter; left time: 3348.5050s
	iters: 200, epoch: 10 | loss: 0.0213244
	speed: 0.0563s/iter; left time: 942.0751s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 877.2462s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 1052.5953s
Epoch: 10 cost time: 24.3760666847229
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.983 Test Loss: 0.231 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.983172).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0003509
	speed: 0.2415s/iter; left time: 3965.9377s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 986.7047s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0758s/iter; left time: 1229.9342s
	iters: 400, epoch: 11 | loss: 0.0023080
	speed: 0.0665s/iter; left time: 1072.6343s
Epoch: 11 cost time: 27.794851064682007
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.263 Vali Acc: 0.979 Test Loss: 0.263 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.2346s/iter; left time: 3755.8285s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0716s/iter; left time: 1138.3167s
	iters: 300, epoch: 12 | loss: 0.0000010
	speed: 0.0631s/iter; left time: 998.0501s
	iters: 400, epoch: 12 | loss: 0.0000023
	speed: 0.0836s/iter; left time: 1313.2413s
Epoch: 12 cost time: 31.249797344207764
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.986 Test Loss: 0.234 Test Acc: 0.986
Validation loss decreased (-0.983172 --> -0.985900).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.3164s/iter; left time: 4933.8544s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1026s/iter; left time: 1589.3607s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 1302.3001s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 1149.7988s
Epoch: 13 cost time: 38.878320932388306
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.235 Vali Acc: 0.983 Test Loss: 0.235 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000122
	speed: 0.2242s/iter; left time: 3403.4430s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0740s/iter; left time: 1115.6788s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0767s/iter; left time: 1149.4572s
	iters: 400, epoch: 14 | loss: 0.0000008
	speed: 0.0776s/iter; left time: 1154.5205s
Epoch: 14 cost time: 31.333117723464966
Epoch: 14, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.982 Test Loss: 0.224 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000012
	speed: 0.1914s/iter; left time: 2827.1794s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 705.2326s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 660.0447s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 844.5554s
Epoch: 15 cost time: 21.54629397392273
Epoch: 15, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.285 Vali Acc: 0.986 Test Loss: 0.285 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2061s/iter; left time: 2959.1247s
	iters: 200, epoch: 16 | loss: 0.0216347
	speed: 0.0519s/iter; left time: 739.9051s
	iters: 300, epoch: 16 | loss: 0.0004000
	speed: 0.0628s/iter; left time: 888.4063s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 738.2460s
Epoch: 16 cost time: 23.894479036331177
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.187 Vali Acc: 0.988 Test Loss: 0.187 Test Acc: 0.988
Validation loss decreased (-0.985900 --> -0.987720).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000035
	speed: 0.2761s/iter; left time: 3850.1534s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.1131s/iter; left time: 1565.4258s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1180s/iter; left time: 1621.1538s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 1346.4510s
Epoch: 17 cost time: 45.86444425582886
Epoch: 17, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.324 Vali Acc: 0.974 Test Loss: 0.324 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1571538
	speed: 0.2686s/iter; left time: 3634.0634s
	iters: 200, epoch: 18 | loss: 0.0000302
	speed: 0.0618s/iter; left time: 830.2590s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 882.0042s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 925.1917s
Epoch: 18 cost time: 30.678379774093628
Epoch: 18, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.414 Vali Acc: 0.979 Test Loss: 0.414 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2188s/iter; left time: 2870.1901s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0704s/iter; left time: 917.0323s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 735.6622s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 892.5876s
Epoch: 19 cost time: 27.271782159805298
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.436 Vali Acc: 0.977 Test Loss: 0.436 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2319s/iter; left time: 2945.6496s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0735s/iter; left time: 926.7309s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 904.1232s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0593s/iter; left time: 736.1020s
Epoch: 20 cost time: 29.994470834732056
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.333 Vali Acc: 0.980 Test Loss: 0.333 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2401s/iter; left time: 2951.3964s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0920s/iter; left time: 1122.1135s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1090s/iter; left time: 1317.8542s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0912s/iter; left time: 1094.0414s
Epoch: 21 cost time: 39.60521745681763
Epoch: 21, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.989 Test Loss: 0.147 Test Acc: 0.989
Validation loss decreased (-0.987720 --> -0.989084).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 3339.9668s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1035.3810s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.1014s/iter; left time: 1184.3472s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0852s/iter; left time: 986.9003s
Epoch: 22 cost time: 38.58552575111389
Epoch: 22, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.321 Vali Acc: 0.981 Test Loss: 0.321 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2453s/iter; left time: 2812.5855s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0784s/iter; left time: 891.3361s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 663.0937s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 712.2743s
Epoch: 23 cost time: 30.6630539894104
Epoch: 23, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.985 Test Loss: 0.253 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2534s/iter; left time: 2800.9922s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 963.2157s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0686s/iter; left time: 744.6450s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 771.0976s
Epoch: 24 cost time: 32.03139042854309
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.992 Test Loss: 0.157 Test Acc: 0.992
Validation loss decreased (-0.989084 --> -0.991813).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2474s/iter; left time: 2632.5422s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 863.7501s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 810.4839s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.0864s/iter; left time: 893.2970s
Epoch: 25 cost time: 34.56189823150635
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.295 Vali Acc: 0.984 Test Loss: 0.295 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2460s/iter; left time: 2515.4767s
	iters: 200, epoch: 26 | loss: 0.0002866
	speed: 0.0787s/iter; left time: 796.8764s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 742.4736s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 716.6073s
Epoch: 26 cost time: 32.865854024887085
Epoch: 26, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.495 Vali Acc: 0.979 Test Loss: 0.495 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2401s/iter; left time: 2355.9128s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 775.3554s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0980s/iter; left time: 942.4645s
	iters: 400, epoch: 27 | loss: 0.1245840
	speed: 0.0813s/iter; left time: 773.1133s
Epoch: 27 cost time: 35.01692795753479
Epoch: 27, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.986 Test Loss: 0.261 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2467s/iter; left time: 2319.3678s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 693.5473s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 789.0735s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 808.4283s
Epoch: 28 cost time: 35.07676577568054
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.988 Test Loss: 0.210 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2632s/iter; left time: 2365.0759s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0882s/iter; left time: 783.3988s
	iters: 300, epoch: 29 | loss: 0.0000002
	speed: 0.0872s/iter; left time: 765.8090s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0736s/iter; left time: 638.9944s
Epoch: 29 cost time: 35.425015926361084
Epoch: 29, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.331 Vali Acc: 0.986 Test Loss: 0.331 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2398s/iter; left time: 2056.1359s
	iters: 200, epoch: 30 | loss: 0.0019511
	speed: 0.0814s/iter; left time: 689.5878s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 547.6672s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0802s/iter; left time: 663.2155s
Epoch: 30 cost time: 31.301310539245605
Epoch: 30, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.312 Vali Acc: 0.985 Test Loss: 0.312 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2627s/iter; left time: 2143.9087s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0914s/iter; left time: 737.0942s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0911s/iter; left time: 725.6320s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0858s/iter; left time: 674.6869s
Epoch: 31 cost time: 38.08416414260864
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.987 Test Loss: 0.238 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.1472530
	speed: 0.2387s/iter; left time: 1849.2972s
	iters: 200, epoch: 32 | loss: 0.0000184
	speed: 0.0712s/iter; left time: 544.6573s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 492.0552s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 482.5180s
Epoch: 32 cost time: 29.289461851119995
Epoch: 32, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.354 Vali Acc: 0.982 Test Loss: 0.354 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2319s/iter; left time: 1700.7682s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 553.0268s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 475.1099s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 469.0343s
Epoch: 33 cost time: 29.48755955696106
Epoch: 33, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.259 Vali Acc: 0.990 Test Loss: 0.259 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2049s/iter; left time: 1418.2145s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 500.9362s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 404.6780s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 532.5020s
Epoch: 34 cost time: 29.57315731048584
Epoch: 34, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.326 Vali Acc: 0.989 Test Loss: 0.326 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 22545418
model size : 100.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7832618
	speed: 0.1203s/iter; left time: 2472.0229s
	iters: 200, epoch: 1 | loss: 0.0756802
	speed: 0.1084s/iter; left time: 2216.7182s
	iters: 300, epoch: 1 | loss: 0.4504489
	speed: 0.1122s/iter; left time: 2284.3810s
	iters: 400, epoch: 1 | loss: 0.0430929
	speed: 0.1028s/iter; left time: 2082.0028s
Epoch: 1 cost time: 46.02313208580017
Epoch: 1, Steps: 413 | Train Loss: 0.526 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0010203
	speed: 0.2354s/iter; left time: 4740.5466s
	iters: 200, epoch: 2 | loss: 0.0647224
	speed: 0.0695s/iter; left time: 1392.9824s
	iters: 300, epoch: 2 | loss: 0.0087581
	speed: 0.0769s/iter; left time: 1532.5430s
	iters: 400, epoch: 2 | loss: 0.0017381
	speed: 0.0701s/iter; left time: 1390.0354s
Epoch: 2 cost time: 29.394736528396606
Epoch: 2, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
Validation loss decreased (-0.967257 --> -0.970894).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0014584
	speed: 0.2427s/iter; left time: 4787.3365s
	iters: 200, epoch: 3 | loss: 0.0129494
	speed: 0.0421s/iter; left time: 827.0402s
	iters: 300, epoch: 3 | loss: 0.0014513
	speed: 0.0548s/iter; left time: 1070.7997s
	iters: 400, epoch: 3 | loss: 0.0000846
	speed: 0.0567s/iter; left time: 1101.8076s
Epoch: 3 cost time: 24.07170271873474
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.970894 --> -0.972258).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0545251
	speed: 0.2098s/iter; left time: 4051.9407s
	iters: 200, epoch: 4 | loss: 0.4709895
	speed: 0.0502s/iter; left time: 963.7277s
	iters: 300, epoch: 4 | loss: 0.0031390
	speed: 0.0558s/iter; left time: 1066.6010s
	iters: 400, epoch: 4 | loss: 0.0012562
	speed: 0.0451s/iter; left time: 857.2521s
Epoch: 4 cost time: 21.66452193260193
Epoch: 4, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
Validation loss decreased (-0.972258 --> -0.979080).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000004
	speed: 0.1944s/iter; left time: 3673.1526s
	iters: 200, epoch: 5 | loss: 0.0003894
	speed: 0.0691s/iter; left time: 1298.5145s
	iters: 300, epoch: 5 | loss: 0.0008217
	speed: 0.0707s/iter; left time: 1322.5361s
	iters: 400, epoch: 5 | loss: 0.0029190
	speed: 0.0738s/iter; left time: 1372.3563s
Epoch: 5 cost time: 28.520456790924072
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.064 Vali Acc: 0.991 Test Loss: 0.064 Test Acc: 0.991
Validation loss decreased (-0.979080 --> -0.991359).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0039639
	speed: 0.1914s/iter; left time: 3537.9082s
	iters: 200, epoch: 6 | loss: 0.0000427
	speed: 0.0642s/iter; left time: 1179.7642s
	iters: 300, epoch: 6 | loss: 0.0018745
	speed: 0.0713s/iter; left time: 1303.6544s
	iters: 400, epoch: 6 | loss: 0.0000068
	speed: 0.0695s/iter; left time: 1263.6000s
Epoch: 6 cost time: 27.66776728630066
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.419 Vali Acc: 0.970 Test Loss: 0.419 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000017
	speed: 0.1775s/iter; left time: 3208.6701s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0656s/iter; left time: 1179.0794s
	iters: 300, epoch: 7 | loss: 0.0000003
	speed: 0.0458s/iter; left time: 819.3669s
	iters: 400, epoch: 7 | loss: 0.3066978
	speed: 0.0542s/iter; left time: 962.5256s
Epoch: 7 cost time: 23.145789861679077
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000006
	speed: 0.1914s/iter; left time: 3380.4060s
	iters: 200, epoch: 8 | loss: 0.0043471
	speed: 0.0651s/iter; left time: 1143.0265s
	iters: 300, epoch: 8 | loss: 0.1049197
	speed: 0.0609s/iter; left time: 1063.1437s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0436s/iter; left time: 756.1340s
Epoch: 8 cost time: 23.697968244552612
Epoch: 8, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.984 Test Loss: 0.129 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000898
	speed: 0.1697s/iter; left time: 2926.5127s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 1070.3221s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 1074.1619s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 1070.3132s
Epoch: 9 cost time: 25.02891182899475
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.976 Test Loss: 0.287 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000065
	speed: 0.1580s/iter; left time: 2659.8706s
	iters: 200, epoch: 10 | loss: 0.0002411
	speed: 0.0425s/iter; left time: 711.5618s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0748s/iter; left time: 1244.6537s
	iters: 400, epoch: 10 | loss: 0.0000207
	speed: 0.0595s/iter; left time: 982.9831s
Epoch: 10 cost time: 23.00470757484436
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.187 Vali Acc: 0.980 Test Loss: 0.187 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2408s/iter; left time: 3953.9091s
	iters: 200, epoch: 11 | loss: 0.0007875
	speed: 0.0840s/iter; left time: 1370.3165s
	iters: 300, epoch: 11 | loss: 0.0000080
	speed: 0.0943s/iter; left time: 1529.2880s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.0981s/iter; left time: 1581.6941s
Epoch: 11 cost time: 37.531707525253296
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.324 Vali Acc: 0.971 Test Loss: 0.324 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.2237s/iter; left time: 3580.3719s
	iters: 200, epoch: 12 | loss: 0.1460332
	speed: 0.0703s/iter; left time: 1117.8977s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0529s/iter; left time: 836.2568s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 920.1036s
Epoch: 12 cost time: 25.792604446411133
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.239 Vali Acc: 0.983 Test Loss: 0.239 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000165
	speed: 0.1355s/iter; left time: 2113.7827s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 803.0303s
	iters: 300, epoch: 13 | loss: 0.0000309
	speed: 0.0513s/iter; left time: 790.1394s
	iters: 400, epoch: 13 | loss: 0.0000005
	speed: 0.0535s/iter; left time: 817.8597s
Epoch: 13 cost time: 19.946306467056274
Epoch: 13, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.985 Test Loss: 0.163 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.1840s/iter; left time: 2793.5149s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0620s/iter; left time: 935.7881s
	iters: 300, epoch: 14 | loss: 0.0019922
	speed: 0.0405s/iter; left time: 607.2725s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 747.3787s
Epoch: 14 cost time: 23.369139194488525
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.987 Test Loss: 0.113 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000602
	speed: 0.1782s/iter; left time: 2631.3982s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 876.3345s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 877.4493s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0572s/iter; left time: 827.0096s
Epoch: 15 cost time: 24.353696584701538
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.988 Test Loss: 0.083 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9913597089586176
model parameter : 22434826
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5760511
	speed: 0.1142s/iter; left time: 2346.6157s
	iters: 200, epoch: 1 | loss: 0.1447480
	speed: 0.0920s/iter; left time: 1881.6024s
	iters: 300, epoch: 1 | loss: 0.1534081
	speed: 0.1008s/iter; left time: 2051.6080s
	iters: 400, epoch: 1 | loss: 0.1090577
	speed: 0.0947s/iter; left time: 1918.4769s
Epoch: 1 cost time: 41.61514925956726
Epoch: 1, Steps: 413 | Train Loss: 0.528 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
Validation loss decreased (inf --> -0.963618).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0012792
	speed: 0.2438s/iter; left time: 4910.4220s
	iters: 200, epoch: 2 | loss: 0.0000795
	speed: 0.0716s/iter; left time: 1435.0821s
	iters: 300, epoch: 2 | loss: 0.0000512
	speed: 0.0799s/iter; left time: 1592.7921s
	iters: 400, epoch: 2 | loss: 0.0066271
	speed: 0.0888s/iter; left time: 1761.9928s
Epoch: 2 cost time: 33.097086906433105
Epoch: 2, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.221 Vali Acc: 0.966 Test Loss: 0.221 Test Acc: 0.966
Validation loss decreased (-0.963618 --> -0.966346).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000358
	speed: 0.2561s/iter; left time: 5052.3109s
	iters: 200, epoch: 3 | loss: 0.0000004
	speed: 0.0765s/iter; left time: 1501.1834s
	iters: 300, epoch: 3 | loss: 0.0000153
	speed: 0.0836s/iter; left time: 1632.4944s
	iters: 400, epoch: 3 | loss: 0.0079334
	speed: 0.0727s/iter; left time: 1411.3843s
Epoch: 3 cost time: 31.965827465057373
Epoch: 3, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
Validation loss decreased (-0.966346 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0014253
	speed: 0.2414s/iter; left time: 4662.7751s
	iters: 200, epoch: 4 | loss: 0.0108378
	speed: 0.0524s/iter; left time: 1007.2718s
	iters: 300, epoch: 4 | loss: 0.0214857
	speed: 0.0623s/iter; left time: 1191.0024s
	iters: 400, epoch: 4 | loss: 0.0000000
	speed: 0.0816s/iter; left time: 1550.8521s
Epoch: 4 cost time: 27.549970626831055
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
Validation loss decreased (-0.972259 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0014131
	speed: 0.2178s/iter; left time: 4116.6180s
	iters: 200, epoch: 5 | loss: 0.0000000
	speed: 0.0652s/iter; left time: 1225.0498s
	iters: 300, epoch: 5 | loss: 0.0000368
	speed: 0.0720s/iter; left time: 1347.1434s
	iters: 400, epoch: 5 | loss: 0.1954444
	speed: 0.0738s/iter; left time: 1373.4022s
Epoch: 5 cost time: 28.516355514526367
Epoch: 5, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2397s/iter; left time: 4430.8472s
	iters: 200, epoch: 6 | loss: 0.0000201
	speed: 0.0981s/iter; left time: 1803.8994s
	iters: 300, epoch: 6 | loss: 0.4178556
	speed: 0.0876s/iter; left time: 1602.5410s
	iters: 400, epoch: 6 | loss: 0.0289530
	speed: 0.1098s/iter; left time: 1997.4069s
Epoch: 6 cost time: 37.483356952667236
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000005
	speed: 0.2243s/iter; left time: 4054.0103s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 1198.8008s
	iters: 300, epoch: 7 | loss: 0.0001603
	speed: 0.0769s/iter; left time: 1375.2236s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 1348.8652s
Epoch: 7 cost time: 30.76119065284729
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.156 Vali Acc: 0.984 Test Loss: 0.156 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.983627).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1908s/iter; left time: 3369.9964s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 1223.3380s
	iters: 300, epoch: 8 | loss: 0.0151130
	speed: 0.0794s/iter; left time: 1385.5542s
	iters: 400, epoch: 8 | loss: 0.0000031
	speed: 0.0810s/iter; left time: 1406.4344s
Epoch: 8 cost time: 29.918693780899048
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
Validation loss decreased (-0.983627 --> -0.984082).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2431s/iter; left time: 4193.2388s
	iters: 200, epoch: 9 | loss: 0.5892618
	speed: 0.0841s/iter; left time: 1442.5515s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 1723.1170s
	iters: 400, epoch: 9 | loss: 0.0000010
	speed: 0.0917s/iter; left time: 1553.9711s
Epoch: 9 cost time: 36.89823293685913
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.147 Vali Acc: 0.984 Test Loss: 0.147 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.2481s/iter; left time: 4176.4428s
	iters: 200, epoch: 10 | loss: 0.0000012
	speed: 0.0953s/iter; left time: 1595.0813s
	iters: 300, epoch: 10 | loss: 0.0018049
	speed: 0.0922s/iter; left time: 1533.5020s
	iters: 400, epoch: 10 | loss: 0.0000028
	speed: 0.0866s/iter; left time: 1431.5462s
Epoch: 10 cost time: 36.29467058181763
Epoch: 10, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.084 Vali Acc: 0.990 Test Loss: 0.084 Test Acc: 0.990
Validation loss decreased (-0.984082 --> -0.989540).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001333
	speed: 0.2678s/iter; left time: 4398.0149s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0778s/iter; left time: 1270.2490s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 779.0805s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0476s/iter; left time: 767.6360s
Epoch: 11 cost time: 26.985509157180786
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.986 Test Loss: 0.144 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1636668
	speed: 0.1887s/iter; left time: 3020.0265s
	iters: 200, epoch: 12 | loss: 0.0000317
	speed: 0.0740s/iter; left time: 1177.9805s
	iters: 300, epoch: 12 | loss: 0.1610168
	speed: 0.0648s/iter; left time: 1024.4767s
	iters: 400, epoch: 12 | loss: 0.0009368
	speed: 0.0637s/iter; left time: 1000.5335s
Epoch: 12 cost time: 28.164849281311035
Epoch: 12, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.990 Test Loss: 0.131 Test Acc: 0.990
Validation loss decreased (-0.989540 --> -0.989994).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2265s/iter; left time: 3532.5890s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0725s/iter; left time: 1122.9755s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 915.0950s
	iters: 400, epoch: 13 | loss: 0.1523483
	speed: 0.0457s/iter; left time: 698.7590s
Epoch: 13 cost time: 26.917325735092163
Epoch: 13, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.360 Vali Acc: 0.972 Test Loss: 0.360 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2160s/iter; left time: 3280.0562s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0699s/iter; left time: 1054.6731s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0500s/iter; left time: 748.4114s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 803.8887s
Epoch: 14 cost time: 28.84501051902771
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.140 Vali Acc: 0.987 Test Loss: 0.140 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2976s/iter; left time: 4394.5761s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0988s/iter; left time: 1448.7145s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 1305.0346s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0790s/iter; left time: 1143.1560s
Epoch: 15 cost time: 40.468745708465576
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.993 Test Loss: 0.092 Test Acc: 0.993
Validation loss decreased (-0.989994 --> -0.993178).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2746s/iter; left time: 3941.5670s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 941.8383s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0584s/iter; left time: 826.8114s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0928s/iter; left time: 1304.0674s
Epoch: 16 cost time: 30.47720742225647
Epoch: 16, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.176 Vali Acc: 0.989 Test Loss: 0.176 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0068777
	speed: 0.2213s/iter; left time: 3085.4864s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 655.2065s
	iters: 300, epoch: 17 | loss: 0.0000034
	speed: 0.0438s/iter; left time: 601.9284s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 617.7104s
Epoch: 17 cost time: 19.849653720855713
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.987 Test Loss: 0.240 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0383976
	speed: 0.1668s/iter; left time: 2256.7187s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 635.4381s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0671s/iter; left time: 894.7528s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 893.4314s
Epoch: 18 cost time: 24.792593717575073
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.247 Vali Acc: 0.985 Test Loss: 0.247 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2147s/iter; left time: 2816.6935s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0930s/iter; left time: 1211.0794s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0657s/iter; left time: 848.3141s
	iters: 400, epoch: 19 | loss: 0.0009705
	speed: 0.0786s/iter; left time: 1006.7907s
Epoch: 19 cost time: 32.83401894569397
Epoch: 19, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.081 Vali Acc: 0.991 Test Loss: 0.081 Test Acc: 0.991
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000002
	speed: 0.2648s/iter; left time: 3363.3960s
	iters: 200, epoch: 20 | loss: 0.0020300
	speed: 0.0628s/iter; left time: 791.6863s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 779.8169s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0870s/iter; left time: 1078.6726s
Epoch: 20 cost time: 33.01952862739563
Epoch: 20, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.990 Test Loss: 0.133 Test Acc: 0.990
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1994s/iter; left time: 2450.7528s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0463s/iter; left time: 564.6423s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 554.6668s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 879.8059s
Epoch: 21 cost time: 23.177205085754395
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.993 Test Loss: 0.129 Test Acc: 0.993
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1844s/iter; left time: 2190.1579s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 607.6170s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0612s/iter; left time: 714.3742s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 746.7285s
Epoch: 22 cost time: 24.12101411819458
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.985 Test Loss: 0.219 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1938s/iter; left time: 2221.3483s
	iters: 200, epoch: 23 | loss: 0.0004202
	speed: 0.0684s/iter; left time: 777.6023s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 700.3674s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 771.5179s
Epoch: 23 cost time: 28.109979152679443
Epoch: 23, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.190 Vali Acc: 0.986 Test Loss: 0.190 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2347s/iter; left time: 2594.4375s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 744.7460s
	iters: 300, epoch: 24 | loss: 0.0000443
	speed: 0.0724s/iter; left time: 785.9323s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0779s/iter; left time: 837.6479s
Epoch: 24 cost time: 30.887127161026
Epoch: 24, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.066 Vali Acc: 0.993 Test Loss: 0.066 Test Acc: 0.993
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2089s/iter; left time: 2222.5529s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 772.1686s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 754.5701s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0935s/iter; left time: 966.9205s
Epoch: 25 cost time: 32.14184784889221
Epoch: 25, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.994 Test Loss: 0.098 Test Acc: 0.994
Validation loss decreased (-0.993178 --> -0.993632).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2285s/iter; left time: 2336.4770s
	iters: 200, epoch: 26 | loss: 0.0000007
	speed: 0.0575s/iter; left time: 582.2150s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0844s/iter; left time: 846.5530s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0618s/iter; left time: 613.0747s
Epoch: 26 cost time: 27.219233989715576
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.991 Test Loss: 0.195 Test Acc: 0.991
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1979s/iter; left time: 1941.9204s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 666.1477s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0664s/iter; left time: 638.6700s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 569.0608s
Epoch: 27 cost time: 27.979716777801514
Epoch: 27, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.988 Test Loss: 0.238 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2026s/iter; left time: 1904.2881s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0570s/iter; left time: 529.6626s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0552s/iter; left time: 507.5835s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 454.1411s
Epoch: 28 cost time: 24.76467752456665
Epoch: 28, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.336 Vali Acc: 0.987 Test Loss: 0.336 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1764s/iter; left time: 1585.1139s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 647.8106s
	iters: 300, epoch: 29 | loss: 0.0000194
	speed: 0.0806s/iter; left time: 708.2668s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0718s/iter; left time: 624.0232s
Epoch: 29 cost time: 29.959254264831543
Epoch: 29, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.329 Vali Acc: 0.987 Test Loss: 0.329 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2125s/iter; left time: 1821.8189s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0679s/iter; left time: 575.0181s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 727.6014s
	iters: 400, epoch: 30 | loss: 1.0830469
	speed: 0.0695s/iter; left time: 574.8306s
Epoch: 30 cost time: 30.818340063095093
Epoch: 30, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.990 Test Loss: 0.150 Test Acc: 0.990
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2001s/iter; left time: 1632.6959s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 696.1600s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 588.3517s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 614.9241s
Epoch: 31 cost time: 31.492284536361694
Epoch: 31, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.831 Vali Acc: 0.972 Test Loss: 0.831 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0002572
	speed: 0.2220s/iter; left time: 1720.2409s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 513.5701s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 508.5662s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 502.3674s
Epoch: 32 cost time: 28.20393204689026
Epoch: 32, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.719 Vali Acc: 0.977 Test Loss: 0.719 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1889s/iter; left time: 1385.3953s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 342.5791s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 352.0175s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 499.2361s
Epoch: 33 cost time: 23.562119960784912
Epoch: 33, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.330 Vali Acc: 0.988 Test Loss: 0.330 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1959s/iter; left time: 1355.8054s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0697s/iter; left time: 475.6062s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0610s/iter; left time: 409.9503s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 523.6033s
Epoch: 34 cost time: 26.51053261756897
Epoch: 34, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.387 Vali Acc: 0.988 Test Loss: 0.387 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.1989s/iter; left time: 1294.4731s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0511s/iter; left time: 327.8167s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 366.9991s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 360.7549s
Epoch: 35 cost time: 23.167256355285645
Epoch: 35, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.996 Test Loss: 0.098 Test Acc: 0.996
Validation loss decreased (-0.993632 --> -0.995906).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.2237s/iter; left time: 1363.8040s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 345.5303s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 268.5948s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0322s/iter; left time: 186.8435s
Epoch: 36 cost time: 22.198980569839478
Epoch: 36, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.992 Test Loss: 0.203 Test Acc: 0.992
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.1766s/iter; left time: 1003.4431s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 306.0968s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 333.8413s
	iters: 400, epoch: 37 | loss: 0.0000002
	speed: 0.0391s/iter; left time: 210.5227s
Epoch: 37 cost time: 23.135313510894775
Epoch: 37, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.992 Test Loss: 0.187 Test Acc: 0.992
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.1908s/iter; left time: 1005.6392s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0951s/iter; left time: 491.4143s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.0922s/iter; left time: 467.5713s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0831s/iter; left time: 412.7775s
Epoch: 38 cost time: 37.07487773895264
Epoch: 38, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.991 Test Loss: 0.212 Test Acc: 0.991
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.2257s/iter; left time: 1096.1680s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 254.1223s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 267.7324s
	iters: 400, epoch: 39 | loss: 0.0000013
	speed: 0.0711s/iter; left time: 323.9272s
Epoch: 39 cost time: 25.2112295627594
Epoch: 39, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.401 Vali Acc: 0.987 Test Loss: 0.401 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.2253s/iter; left time: 1001.4173s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 200.5856s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.0605s/iter; left time: 256.7956s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 266.3979s
Epoch: 40 cost time: 24.35916495323181
Epoch: 40, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.239 Vali Acc: 0.989 Test Loss: 0.239 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.2241s/iter; left time: 903.1581s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.0678s/iter; left time: 266.3427s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0597s/iter; left time: 228.6013s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 250.6983s
Epoch: 41 cost time: 27.856472730636597
Epoch: 41, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.370 Vali Acc: 0.989 Test Loss: 0.370 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.4250469
	speed: 0.2155s/iter; left time: 779.5262s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.0756s/iter; left time: 266.0057s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 237.9258s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.1050s/iter; left time: 348.3367s
Epoch: 42 cost time: 33.87274098396301
Epoch: 42, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.269 Vali Acc: 0.990 Test Loss: 0.269 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.2888s/iter; left time: 925.4586s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0811s/iter; left time: 251.7139s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.0865s/iter; left time: 259.8361s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.0669s/iter; left time: 194.4067s
Epoch: 43 cost time: 33.37990736961365
Epoch: 43, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.993 Test Loss: 0.198 Test Acc: 0.993
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.2755s/iter; left time: 769.1286s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 215.6193s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 224.6994s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0985s/iter; left time: 245.4381s
Epoch: 44 cost time: 36.23540210723877
Epoch: 44, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.990 Test Loss: 0.219 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.2610s/iter; left time: 621.0042s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 128.7558s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 176.3379s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.0764s/iter; left time: 158.7604s
Epoch: 45 cost time: 31.570059299468994
Epoch: 45, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.991 Test Loss: 0.212 Test Acc: 0.991
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9959072305593452
model parameter : 22704394
model size : 101.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3925589
	speed: 0.0944s/iter; left time: 1939.0584s
	iters: 200, epoch: 1 | loss: 0.3016583
	speed: 0.0825s/iter; left time: 1686.9822s
	iters: 300, epoch: 1 | loss: 0.5135459
	speed: 0.0805s/iter; left time: 1637.2555s
	iters: 400, epoch: 1 | loss: 0.0421693
	speed: 0.0490s/iter; left time: 992.8349s
Epoch: 1 cost time: 31.298401832580566
Epoch: 1, Steps: 413 | Train Loss: 0.512 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0500143
	speed: 0.1733s/iter; left time: 3490.3547s
	iters: 200, epoch: 2 | loss: 0.0042310
	speed: 0.0677s/iter; left time: 1356.5768s
	iters: 300, epoch: 2 | loss: 0.0100253
	speed: 0.0718s/iter; left time: 1431.5913s
	iters: 400, epoch: 2 | loss: 0.0004383
	speed: 0.0769s/iter; left time: 1526.3149s
Epoch: 2 cost time: 29.2901713848114
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.966347 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000011
	speed: 0.2341s/iter; left time: 4617.9799s
	iters: 200, epoch: 3 | loss: 0.0178830
	speed: 0.0774s/iter; left time: 1519.1504s
	iters: 300, epoch: 3 | loss: 0.0000031
	speed: 0.0631s/iter; left time: 1231.2421s
	iters: 400, epoch: 3 | loss: 0.7498218
	speed: 0.0805s/iter; left time: 1563.5884s
Epoch: 3 cost time: 30.4618182182312
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.311 Vali Acc: 0.949 Test Loss: 0.311 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000002
	speed: 0.1474s/iter; left time: 2847.2095s
	iters: 200, epoch: 4 | loss: 0.0004759
	speed: 0.0344s/iter; left time: 661.3698s
	iters: 300, epoch: 4 | loss: 0.0000457
	speed: 0.0344s/iter; left time: 657.8349s
	iters: 400, epoch: 4 | loss: 0.0000030
	speed: 0.0309s/iter; left time: 586.8247s
Epoch: 4 cost time: 14.157639026641846
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000010
	speed: 0.1275s/iter; left time: 2410.0739s
	iters: 200, epoch: 5 | loss: 0.0000203
	speed: 0.0409s/iter; left time: 768.2523s
	iters: 300, epoch: 5 | loss: 0.0000316
	speed: 0.0615s/iter; left time: 1149.4073s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.0630s/iter; left time: 1172.4339s
Epoch: 5 cost time: 21.347098350524902
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
Validation loss decreased (-0.975897 --> -0.980899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000006
	speed: 0.1531s/iter; left time: 2830.4516s
	iters: 200, epoch: 6 | loss: 0.0000002
	speed: 0.0633s/iter; left time: 1163.4678s
	iters: 300, epoch: 6 | loss: 0.0043099
	speed: 0.0593s/iter; left time: 1084.6711s
	iters: 400, epoch: 6 | loss: 0.0001074
	speed: 0.0701s/iter; left time: 1275.3008s
Epoch: 6 cost time: 24.79934024810791
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
Validation loss decreased (-0.980899 --> -0.986357).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000515
	speed: 0.2134s/iter; left time: 3856.8880s
	iters: 200, epoch: 7 | loss: 0.0004436
	speed: 0.0425s/iter; left time: 763.9744s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 1215.8506s
	iters: 400, epoch: 7 | loss: 0.0001271
	speed: 0.0696s/iter; left time: 1236.6492s
Epoch: 7 cost time: 25.25723934173584
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.984 Test Loss: 0.133 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2269s/iter; left time: 4006.7008s
	iters: 200, epoch: 8 | loss: 0.0003473
	speed: 0.0642s/iter; left time: 1127.1102s
	iters: 300, epoch: 8 | loss: 0.0045297
	speed: 0.0691s/iter; left time: 1206.4521s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0610s/iter; left time: 1059.7069s
Epoch: 8 cost time: 28.221069812774658
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.143 Vali Acc: 0.983 Test Loss: 0.143 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0245998
	speed: 0.2468s/iter; left time: 4257.3650s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0582s/iter; left time: 998.4752s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0410s/iter; left time: 698.2024s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 707.5562s
Epoch: 9 cost time: 23.73741602897644
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.986 Test Loss: 0.113 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000011
	speed: 0.1664s/iter; left time: 2800.4634s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 974.7896s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0743s/iter; left time: 1236.3224s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 920.8301s
Epoch: 10 cost time: 25.710806846618652
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1834s/iter; left time: 3012.0928s
	iters: 200, epoch: 11 | loss: 1.3308555
	speed: 0.0273s/iter; left time: 444.8864s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 555.3604s
	iters: 400, epoch: 11 | loss: 0.0009091
	speed: 0.0614s/iter; left time: 989.3311s
Epoch: 11 cost time: 18.663533210754395
Epoch: 11, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.206 Vali Acc: 0.984 Test Loss: 0.206 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0192559
	speed: 0.1843s/iter; left time: 2950.1132s
	iters: 200, epoch: 12 | loss: 0.0002514
	speed: 0.0429s/iter; left time: 683.1721s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0509s/iter; left time: 804.4298s
	iters: 400, epoch: 12 | loss: 0.1741375
	speed: 0.0716s/iter; left time: 1124.8164s
Epoch: 12 cost time: 23.457745790481567
Epoch: 12, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.217 Vali Acc: 0.980 Test Loss: 0.217 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2732s/iter; left time: 4259.8181s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 1299.2787s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 1211.7878s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 1032.6270s
Epoch: 13 cost time: 33.65840291976929
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.059 Vali Acc: 0.992 Test Loss: 0.059 Test Acc: 0.992
Validation loss decreased (-0.986357 --> -0.991814).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000020
	speed: 0.2160s/iter; left time: 3279.5157s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0675s/iter; left time: 1017.4046s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 937.6716s
	iters: 400, epoch: 14 | loss: 0.0000032
	speed: 0.0734s/iter; left time: 1092.0344s
Epoch: 14 cost time: 28.86769390106201
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.982 Test Loss: 0.213 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1896s/iter; left time: 2800.7670s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 706.2516s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0562s/iter; left time: 818.1691s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 847.2189s
Epoch: 15 cost time: 22.675883769989014
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.983 Test Loss: 0.196 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1936s/iter; left time: 2778.9686s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 806.0047s
	iters: 300, epoch: 16 | loss: 0.0000537
	speed: 0.0431s/iter; left time: 609.7347s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 646.4670s
Epoch: 16 cost time: 20.746667861938477
Epoch: 16, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.102 Vali Acc: 0.990 Test Loss: 0.102 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2059s/iter; left time: 2870.7619s
	iters: 200, epoch: 17 | loss: 0.1066192
	speed: 0.0479s/iter; left time: 662.5593s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 686.1404s
	iters: 400, epoch: 17 | loss: 0.0002811
	speed: 0.0558s/iter; left time: 760.9791s
Epoch: 17 cost time: 22.406734943389893
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.980 Test Loss: 0.243 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1986s/iter; left time: 2687.2922s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 478.3820s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 917.5936s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 942.4452s
Epoch: 18 cost time: 24.55887007713318
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.163 Vali Acc: 0.990 Test Loss: 0.163 Test Acc: 0.990
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2369s/iter; left time: 3107.6834s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 1022.4525s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 1105.1637s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0734s/iter; left time: 940.9503s
Epoch: 19 cost time: 33.18954515457153
Epoch: 19, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.990 Test Loss: 0.104 Test Acc: 0.990
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2223s/iter; left time: 2824.6473s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0638s/iter; left time: 804.1138s
	iters: 300, epoch: 20 | loss: 1.2820432
	speed: 0.0458s/iter; left time: 572.5434s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0430s/iter; left time: 533.9291s
Epoch: 20 cost time: 23.797815322875977
Epoch: 20, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.986 Test Loss: 0.179 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1889s/iter; left time: 2321.7685s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0691s/iter; left time: 842.3258s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 503.0037s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 618.3311s
Epoch: 21 cost time: 24.029338836669922
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.988 Test Loss: 0.146 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1673s/iter; left time: 1987.1718s
	iters: 200, epoch: 22 | loss: 0.0000080
	speed: 0.0413s/iter; left time: 485.9744s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 451.6346s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 542.0349s
Epoch: 22 cost time: 18.328712940216064
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.300 Vali Acc: 0.978 Test Loss: 0.300 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1828s/iter; left time: 2095.9033s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 551.8380s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 485.4636s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 333.1741s
Epoch: 23 cost time: 18.437509536743164
Epoch: 23, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.990 Test Loss: 0.127 Test Acc: 0.990
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 22575370
model size : 100.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3723311
	speed: 0.0645s/iter; left time: 1325.8724s
	iters: 200, epoch: 1 | loss: 0.2769201
	speed: 0.0441s/iter; left time: 901.9387s
	iters: 300, epoch: 1 | loss: 0.4962659
	speed: 0.0534s/iter; left time: 1086.0082s
	iters: 400, epoch: 1 | loss: 0.0142212
	speed: 0.0574s/iter; left time: 1161.6933s
Epoch: 1 cost time: 22.66386580467224
Epoch: 1, Steps: 413 | Train Loss: 0.535 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (inf --> -0.979990).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0281737
	speed: 0.1668s/iter; left time: 3359.3293s
	iters: 200, epoch: 2 | loss: 0.0770628
	speed: 0.0311s/iter; left time: 622.6726s
	iters: 300, epoch: 2 | loss: 0.0020263
	speed: 0.0304s/iter; left time: 607.0103s
	iters: 400, epoch: 2 | loss: 0.0014166
	speed: 0.0277s/iter; left time: 549.4320s
Epoch: 2 cost time: 13.187241792678833
Epoch: 2, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2242202
	speed: 0.1373s/iter; left time: 2707.3059s
	iters: 200, epoch: 3 | loss: 0.0024174
	speed: 0.0310s/iter; left time: 607.7831s
	iters: 300, epoch: 3 | loss: 0.0013334
	speed: 0.0297s/iter; left time: 579.8565s
	iters: 400, epoch: 3 | loss: 0.0567920
	speed: 0.0423s/iter; left time: 820.9346s
Epoch: 3 cost time: 14.078163385391235
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0001631
	speed: 0.1612s/iter; left time: 3112.4521s
	iters: 200, epoch: 4 | loss: 0.0014038
	speed: 0.0370s/iter; left time: 710.2241s
	iters: 300, epoch: 4 | loss: 0.0009528
	speed: 0.0264s/iter; left time: 504.8360s
	iters: 400, epoch: 4 | loss: 1.1314504
	speed: 0.0263s/iter; left time: 500.6528s
Epoch: 4 cost time: 13.76960015296936
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0049641
	speed: 0.1359s/iter; left time: 2567.4935s
	iters: 200, epoch: 5 | loss: 0.6683278
	speed: 0.0326s/iter; left time: 612.0483s
	iters: 300, epoch: 5 | loss: 0.0003573
	speed: 0.0289s/iter; left time: 541.0387s
	iters: 400, epoch: 5 | loss: 0.0288797
	speed: 0.0376s/iter; left time: 699.2043s
Epoch: 5 cost time: 13.934391498565674
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.253 Vali Acc: 0.966 Test Loss: 0.253 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000999
	speed: 0.1359s/iter; left time: 2511.9481s
	iters: 200, epoch: 6 | loss: 0.0000830
	speed: 0.0476s/iter; left time: 874.5653s
	iters: 300, epoch: 6 | loss: 0.0014443
	speed: 0.0350s/iter; left time: 639.5608s
	iters: 400, epoch: 6 | loss: 0.0000033
	speed: 0.0329s/iter; left time: 598.7051s
Epoch: 6 cost time: 15.9063880443573
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.979990 --> -0.982719).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000570
	speed: 0.1666s/iter; left time: 3010.9695s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 908.9884s
	iters: 300, epoch: 7 | loss: 0.0000011
	speed: 0.0515s/iter; left time: 920.7473s
	iters: 400, epoch: 7 | loss: 0.0012458
	speed: 0.0506s/iter; left time: 899.9916s
Epoch: 7 cost time: 21.274735927581787
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.259 Vali Acc: 0.966 Test Loss: 0.259 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001540
	speed: 0.1596s/iter; left time: 2818.8168s
	iters: 200, epoch: 8 | loss: 0.0568195
	speed: 0.0433s/iter; left time: 760.6538s
	iters: 300, epoch: 8 | loss: 0.0211500
	speed: 0.0418s/iter; left time: 730.4320s
	iters: 400, epoch: 8 | loss: 0.0002849
	speed: 0.0400s/iter; left time: 693.7437s
Epoch: 8 cost time: 17.454540491104126
Epoch: 8, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1702s/iter; left time: 2935.7612s
	iters: 200, epoch: 9 | loss: 0.0000059
	speed: 0.0486s/iter; left time: 833.9214s
	iters: 300, epoch: 9 | loss: 0.0000996
	speed: 0.0397s/iter; left time: 677.3922s
	iters: 400, epoch: 9 | loss: 0.0063902
	speed: 0.0524s/iter; left time: 888.4898s
Epoch: 9 cost time: 20.221052169799805
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000066
	speed: 0.1826s/iter; left time: 3073.2485s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0361s/iter; left time: 603.4959s
	iters: 300, epoch: 10 | loss: 0.0000162
	speed: 0.0454s/iter; left time: 755.9194s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0325s/iter; left time: 537.9575s
Epoch: 10 cost time: 16.564222812652588
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.979 Test Loss: 0.202 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1383s/iter; left time: 2271.8429s
	iters: 200, epoch: 11 | loss: 0.0044130
	speed: 0.0318s/iter; left time: 519.2889s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 509.3357s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 484.6104s
Epoch: 11 cost time: 13.410616159439087
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1369s/iter; left time: 2190.8736s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0380s/iter; left time: 604.7739s
	iters: 300, epoch: 12 | loss: 0.0000007
	speed: 0.0278s/iter; left time: 438.8701s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 423.4957s
Epoch: 12 cost time: 13.564258098602295
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984537).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1654s/iter; left time: 2579.2695s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 449.8324s
	iters: 300, epoch: 13 | loss: 0.0003825
	speed: 0.0286s/iter; left time: 440.5489s
	iters: 400, epoch: 13 | loss: 0.0000171
	speed: 0.0244s/iter; left time: 373.3124s
Epoch: 13 cost time: 12.90962028503418
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.275 Vali Acc: 0.977 Test Loss: 0.275 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1472s/iter; left time: 2235.3840s
	iters: 200, epoch: 14 | loss: 0.0000007
	speed: 0.0369s/iter; left time: 556.1389s
	iters: 300, epoch: 14 | loss: 0.0000048
	speed: 0.0421s/iter; left time: 630.4818s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 696.2837s
Epoch: 14 cost time: 18.179197549819946
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.978 Test Loss: 0.229 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000105
	speed: 0.1451s/iter; left time: 2142.5544s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 645.7369s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 726.9503s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 602.4604s
Epoch: 15 cost time: 17.734418630599976
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000176
	speed: 0.1964s/iter; left time: 2819.1378s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 697.6072s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 650.5473s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0482s/iter; left time: 677.7422s
Epoch: 16 cost time: 21.857038736343384
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.979 Test Loss: 0.217 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1640s/iter; left time: 2286.2679s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 684.5061s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 665.2025s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 509.8158s
Epoch: 17 cost time: 18.83912682533264
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.246 Vali Acc: 0.981 Test Loss: 0.246 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0927886
	speed: 0.1277s/iter; left time: 1727.6633s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 501.2925s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0452s/iter; left time: 602.0408s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 681.6087s
Epoch: 18 cost time: 17.683463096618652
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.982 Test Loss: 0.204 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1825s/iter; left time: 2394.3221s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 608.1837s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 553.9217s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 552.2186s
Epoch: 19 cost time: 19.227869272232056
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.980 Test Loss: 0.219 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1618s/iter; left time: 2055.5945s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 480.1374s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0376s/iter; left time: 470.3528s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 538.7906s
Epoch: 20 cost time: 16.99506711959839
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.988 Test Loss: 0.140 Test Acc: 0.988
Validation loss decreased (-0.984537 --> -0.988175).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1934s/iter; left time: 2376.8004s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 669.8670s
	iters: 300, epoch: 21 | loss: 0.0951115
	speed: 0.0586s/iter; left time: 708.6006s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 712.7029s
Epoch: 21 cost time: 23.336060762405396
Epoch: 21, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.353 Vali Acc: 0.974 Test Loss: 0.353 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.1999s/iter; left time: 2374.7308s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 530.3503s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 479.7441s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 522.0717s
Epoch: 22 cost time: 19.691155910491943
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.980 Test Loss: 0.223 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000359
	speed: 0.1622s/iter; left time: 1859.4776s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0574s/iter; left time: 652.3169s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0455s/iter; left time: 512.1611s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 470.9351s
Epoch: 23 cost time: 19.5817129611969
Epoch: 23, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.303 Vali Acc: 0.980 Test Loss: 0.303 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1769s/iter; left time: 1955.4364s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 513.3291s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 414.1440s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 451.0531s
Epoch: 24 cost time: 19.088858127593994
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.544 Vali Acc: 0.969 Test Loss: 0.544 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000003
	speed: 0.1797s/iter; left time: 1911.5580s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 398.5516s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 612.8964s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 592.6421s
Epoch: 25 cost time: 21.26502513885498
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.983 Test Loss: 0.287 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000003
	speed: 0.1943s/iter; left time: 1986.7181s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 351.9844s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0397s/iter; left time: 398.2030s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0436s/iter; left time: 432.9360s
Epoch: 26 cost time: 18.01268243789673
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.989 Test Loss: 0.129 Test Acc: 0.989
Validation loss decreased (-0.988175 --> -0.988630).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2186s/iter; left time: 2145.3906s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 574.2604s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 537.6809s
	iters: 400, epoch: 27 | loss: 0.0000016
	speed: 0.0588s/iter; left time: 559.8051s
Epoch: 27 cost time: 24.799729585647583
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.988 Test Loss: 0.132 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1952s/iter; left time: 1835.3115s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 395.6297s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 364.2578s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 380.2451s
Epoch: 28 cost time: 19.34116816520691
Epoch: 28, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.390 Vali Acc: 0.976 Test Loss: 0.390 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1658s/iter; left time: 1490.0375s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 367.2809s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0381s/iter; left time: 334.5993s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 481.8027s
Epoch: 29 cost time: 18.909891366958618
Epoch: 29, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.977 Test Loss: 0.335 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1673s/iter; left time: 1434.1368s
	iters: 200, epoch: 30 | loss: 1.5270965
	speed: 0.0526s/iter; left time: 445.9911s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 288.6463s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 305.9420s
Epoch: 30 cost time: 17.532875537872314
Epoch: 30, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.185 Vali Acc: 0.986 Test Loss: 0.185 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1662s/iter; left time: 1356.0153s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 348.3498s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 284.8271s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0442s/iter; left time: 347.4859s
Epoch: 31 cost time: 17.42570948600769
Epoch: 31, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.334 Vali Acc: 0.982 Test Loss: 0.334 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.1144149
	speed: 0.1343s/iter; left time: 1040.3938s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 320.1913s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0409s/iter; left time: 308.8214s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0429s/iter; left time: 319.5553s
Epoch: 32 cost time: 17.570305347442627
Epoch: 32, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.985 Test Loss: 0.179 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.1612s/iter; left time: 1182.5635s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 378.7954s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 375.6650s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 294.5637s
Epoch: 33 cost time: 21.425232648849487
Epoch: 33, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.989 Test Loss: 0.166 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.2387s/iter; left time: 1652.4090s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0682s/iter; left time: 465.3689s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 459.5685s
	iters: 400, epoch: 34 | loss: 0.0000135
	speed: 0.0656s/iter; left time: 434.3530s
Epoch: 34 cost time: 27.860687017440796
Epoch: 34, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.986 Test Loss: 0.259 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.2038s/iter; left time: 1326.3874s
	iters: 200, epoch: 35 | loss: 0.0000005
	speed: 0.0567s/iter; left time: 363.5926s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0548s/iter; left time: 345.5675s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 349.5190s
Epoch: 35 cost time: 23.597028017044067
Epoch: 35, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.983 Test Loss: 0.267 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0059864
	speed: 0.2031s/iter; left time: 1237.9180s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 309.6512s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 282.3132s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 302.8573s
Epoch: 36 cost time: 21.357537031173706
Epoch: 36, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.308 Vali Acc: 0.980 Test Loss: 0.308 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 22437130
model size : 100.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5091476
	speed: 0.0787s/iter; left time: 1616.8064s
	iters: 200, epoch: 1 | loss: 0.1786638
	speed: 0.0508s/iter; left time: 1038.0225s
	iters: 300, epoch: 1 | loss: 0.1744461
	speed: 0.0554s/iter; left time: 1127.2228s
	iters: 400, epoch: 1 | loss: 0.1089134
	speed: 0.0704s/iter; left time: 1425.7035s
Epoch: 1 cost time: 26.165477514266968
Epoch: 1, Steps: 413 | Train Loss: 0.523 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0030402
	speed: 0.2199s/iter; left time: 4427.4235s
	iters: 200, epoch: 2 | loss: 0.0223210
	speed: 0.0605s/iter; left time: 1212.4150s
	iters: 300, epoch: 2 | loss: 0.0001514
	speed: 0.0448s/iter; left time: 893.4026s
	iters: 400, epoch: 2 | loss: 0.0000086
	speed: 0.0627s/iter; left time: 1243.6204s
Epoch: 2 cost time: 25.752284288406372
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2906316
	speed: 0.2007s/iter; left time: 3959.3973s
	iters: 200, epoch: 3 | loss: 0.0009159
	speed: 0.0685s/iter; left time: 1343.3470s
	iters: 300, epoch: 3 | loss: 0.0000095
	speed: 0.0950s/iter; left time: 1855.0571s
	iters: 400, epoch: 3 | loss: 0.0000039
	speed: 0.1131s/iter; left time: 2197.1316s
Epoch: 3 cost time: 37.21322822570801
Epoch: 3, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.964983 --> -0.983628).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000003
	speed: 0.2441s/iter; left time: 4714.0648s
	iters: 200, epoch: 4 | loss: 0.0067925
	speed: 0.0975s/iter; left time: 1873.5096s
	iters: 300, epoch: 4 | loss: 0.0000246
	speed: 0.1002s/iter; left time: 1915.2252s
	iters: 400, epoch: 4 | loss: 0.0000802
	speed: 0.0909s/iter; left time: 1728.6796s
Epoch: 4 cost time: 36.37958526611328
Epoch: 4, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.065 Vali Acc: 0.989 Test Loss: 0.065 Test Acc: 0.989
Validation loss decreased (-0.983628 --> -0.989085).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000004
	speed: 0.1900s/iter; left time: 3590.6170s
	iters: 200, epoch: 5 | loss: 0.0000019
	speed: 0.0745s/iter; left time: 1400.5509s
	iters: 300, epoch: 5 | loss: 0.2558645
	speed: 0.0737s/iter; left time: 1377.4459s
	iters: 400, epoch: 5 | loss: 0.0313480
	speed: 0.0626s/iter; left time: 1164.0435s
Epoch: 5 cost time: 26.57862949371338
Epoch: 5, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0094972
	speed: 0.2291s/iter; left time: 4235.3263s
	iters: 200, epoch: 6 | loss: 0.0004096
	speed: 0.0972s/iter; left time: 1787.0949s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1348.0509s
	iters: 400, epoch: 6 | loss: 0.0003043
	speed: 0.0619s/iter; left time: 1125.5910s
Epoch: 6 cost time: 32.774850606918335
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.200 Vali Acc: 0.981 Test Loss: 0.200 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0008274
	speed: 0.2051s/iter; left time: 3706.2828s
	iters: 200, epoch: 7 | loss: 0.0000041
	speed: 0.0583s/iter; left time: 1047.5225s
	iters: 300, epoch: 7 | loss: 0.0015538
	speed: 0.0689s/iter; left time: 1232.0715s
	iters: 400, epoch: 7 | loss: 0.0000001
	speed: 0.0709s/iter; left time: 1260.6845s
Epoch: 7 cost time: 28.90399694442749
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.987 Test Loss: 0.144 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0136166
	speed: 0.2141s/iter; left time: 3780.6048s
	iters: 200, epoch: 8 | loss: 1.5492991
	speed: 0.0708s/iter; left time: 1243.7444s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0730s/iter; left time: 1274.7372s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0879s/iter; left time: 1525.2550s
Epoch: 8 cost time: 31.431633710861206
Epoch: 8, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.315 Vali Acc: 0.980 Test Loss: 0.315 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2322s/iter; left time: 4004.8317s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 1178.9518s
	iters: 300, epoch: 9 | loss: 0.0000079
	speed: 0.0671s/iter; left time: 1143.4492s
	iters: 400, epoch: 9 | loss: 0.0028070
	speed: 0.0638s/iter; left time: 1081.1525s
Epoch: 9 cost time: 28.713546752929688
Epoch: 9, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.564 Vali Acc: 0.969 Test Loss: 0.564 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1827s/iter; left time: 3076.2059s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0872s/iter; left time: 1458.7201s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1226.6447s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0501s/iter; left time: 828.4404s
Epoch: 10 cost time: 26.81041646003723
Epoch: 10, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.333 Vali Acc: 0.976 Test Loss: 0.333 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000639
	speed: 0.2166s/iter; left time: 3556.5160s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0861s/iter; left time: 1405.3566s
	iters: 300, epoch: 11 | loss: 0.0000788
	speed: 0.0829s/iter; left time: 1344.9525s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 1479.2781s
Epoch: 11 cost time: 36.2180278301239
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.979 Test Loss: 0.246 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2667s/iter; left time: 4268.9628s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1025s/iter; left time: 1630.4091s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 1263.7790s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.0750s/iter; left time: 1178.7285s
Epoch: 12 cost time: 37.01016855239868
Epoch: 12, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.301 Vali Acc: 0.979 Test Loss: 0.301 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000030
	speed: 0.2381s/iter; left time: 3713.2164s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0768s/iter; left time: 1189.3755s
	iters: 300, epoch: 13 | loss: 1.0128099
	speed: 0.0842s/iter; left time: 1295.6506s
	iters: 400, epoch: 13 | loss: 0.0000152
	speed: 0.0744s/iter; left time: 1138.2425s
Epoch: 13 cost time: 32.81721091270447
Epoch: 13, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.475 Vali Acc: 0.971 Test Loss: 0.475 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1793s/iter; left time: 2722.6422s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 800.7717s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 664.2486s
	iters: 400, epoch: 14 | loss: 0.0001581
	speed: 0.0482s/iter; left time: 717.8019s
Epoch: 14 cost time: 20.84412693977356
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.405 Vali Acc: 0.976 Test Loss: 0.405 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 22734346
model size : 101.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3777512
	speed: 0.0591s/iter; left time: 1213.6766s
	iters: 200, epoch: 1 | loss: 0.5613526
	speed: 0.0365s/iter; left time: 747.3623s
	iters: 300, epoch: 1 | loss: 0.1204552
	speed: 0.0315s/iter; left time: 641.1275s
	iters: 400, epoch: 1 | loss: 0.0017822
	speed: 0.0338s/iter; left time: 684.0507s
Epoch: 1 cost time: 16.60390853881836
Epoch: 1, Steps: 413 | Train Loss: 0.507 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0152407
	speed: 0.1320s/iter; left time: 2658.6095s
	iters: 200, epoch: 2 | loss: 0.0624672
	speed: 0.0471s/iter; left time: 943.8039s
	iters: 300, epoch: 2 | loss: 0.3714816
	speed: 0.0731s/iter; left time: 1458.3002s
	iters: 400, epoch: 2 | loss: 0.0001126
	speed: 0.0443s/iter; left time: 878.4378s
Epoch: 2 cost time: 21.12917733192444
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.967257 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000035
	speed: 0.1824s/iter; left time: 3597.2314s
	iters: 200, epoch: 3 | loss: 0.0000050
	speed: 0.0635s/iter; left time: 1246.8058s
	iters: 300, epoch: 3 | loss: 0.0231445
	speed: 0.0633s/iter; left time: 1236.7466s
	iters: 400, epoch: 3 | loss: 0.0158538
	speed: 0.0448s/iter; left time: 869.5059s
Epoch: 3 cost time: 22.76482892036438
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.981355).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002174
	speed: 0.1416s/iter; left time: 2735.5313s
	iters: 200, epoch: 4 | loss: 0.0000350
	speed: 0.0460s/iter; left time: 884.5030s
	iters: 300, epoch: 4 | loss: 0.0008883
	speed: 0.0366s/iter; left time: 699.1564s
	iters: 400, epoch: 4 | loss: 0.0128143
	speed: 0.0411s/iter; left time: 781.6588s
Epoch: 4 cost time: 16.764575719833374
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
Validation loss decreased (-0.981355 --> -0.988631).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000002
	speed: 0.1685s/iter; left time: 3183.6318s
	iters: 200, epoch: 5 | loss: 0.0000010
	speed: 0.0412s/iter; left time: 774.4931s
	iters: 300, epoch: 5 | loss: 0.0000027
	speed: 0.0441s/iter; left time: 824.6387s
	iters: 400, epoch: 5 | loss: 0.0007524
	speed: 0.0524s/iter; left time: 973.7821s
Epoch: 5 cost time: 19.742841720581055
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000023
	speed: 0.1834s/iter; left time: 3389.5259s
	iters: 200, epoch: 6 | loss: 0.0000189
	speed: 0.0745s/iter; left time: 1369.8151s
	iters: 300, epoch: 6 | loss: 0.0000062
	speed: 0.0896s/iter; left time: 1638.7540s
	iters: 400, epoch: 6 | loss: 0.0001747
	speed: 0.0887s/iter; left time: 1613.9576s
Epoch: 6 cost time: 32.82075500488281
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000027
	speed: 0.1961s/iter; left time: 3543.9212s
	iters: 200, epoch: 7 | loss: 0.7143055
	speed: 0.0720s/iter; left time: 1293.4233s
	iters: 300, epoch: 7 | loss: 0.0000006
	speed: 0.0645s/iter; left time: 1153.3146s
	iters: 400, epoch: 7 | loss: 0.1688008
	speed: 0.0527s/iter; left time: 936.5844s
Epoch: 7 cost time: 26.22558832168579
Epoch: 7, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000028
	speed: 0.1471s/iter; left time: 2597.4693s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 1076.7741s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 1122.4326s
	iters: 400, epoch: 8 | loss: 0.0107272
	speed: 0.0678s/iter; left time: 1176.2936s
Epoch: 8 cost time: 24.28772258758545
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000014
	speed: 0.1534s/iter; left time: 2645.6936s
	iters: 200, epoch: 9 | loss: 0.0000004
	speed: 0.0469s/iter; left time: 803.8592s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 613.8615s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0502s/iter; left time: 851.4965s
Epoch: 9 cost time: 18.63331174850464
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1924s/iter; left time: 3238.5384s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 947.6881s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0490s/iter; left time: 814.2895s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0504s/iter; left time: 833.5143s
Epoch: 10 cost time: 22.741236209869385
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.084 Vali Acc: 0.986 Test Loss: 0.084 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0301429
	speed: 0.1874s/iter; left time: 3076.9232s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0428s/iter; left time: 699.1085s
	iters: 300, epoch: 11 | loss: 0.0000004
	speed: 0.0375s/iter; left time: 608.4201s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0412s/iter; left time: 663.7713s
Epoch: 11 cost time: 17.91267156600952
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.990 Test Loss: 0.077 Test Acc: 0.990
Validation loss decreased (-0.988631 --> -0.989540).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0537210
	speed: 0.1722s/iter; left time: 2757.3379s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0319s/iter; left time: 507.9274s
	iters: 300, epoch: 12 | loss: 0.1039237
	speed: 0.0316s/iter; left time: 500.1678s
	iters: 400, epoch: 12 | loss: 0.0000013
	speed: 0.0374s/iter; left time: 586.7067s
Epoch: 12 cost time: 14.553887605667114
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.986 Test Loss: 0.117 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1896s/iter; left time: 2956.8536s
	iters: 200, epoch: 13 | loss: 0.0000260
	speed: 0.0525s/iter; left time: 813.0863s
	iters: 300, epoch: 13 | loss: 0.0009477
	speed: 0.0437s/iter; left time: 672.9082s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 805.7330s
Epoch: 13 cost time: 22.628039836883545
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.385 Vali Acc: 0.963 Test Loss: 0.385 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000968
	speed: 0.2080s/iter; left time: 3157.3664s
	iters: 200, epoch: 14 | loss: 0.0042370
	speed: 0.0623s/iter; left time: 939.4059s
	iters: 300, epoch: 14 | loss: 1.2526383
	speed: 0.0450s/iter; left time: 674.4551s
	iters: 400, epoch: 14 | loss: 0.0000291
	speed: 0.0419s/iter; left time: 623.6184s
Epoch: 14 cost time: 23.549442768096924
Epoch: 14, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.351 Vali Acc: 0.967 Test Loss: 0.351 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1785s/iter; left time: 2636.5805s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 997.7173s
	iters: 300, epoch: 15 | loss: 0.0000003
	speed: 0.0514s/iter; left time: 748.1744s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0382s/iter; left time: 552.6788s
Epoch: 15 cost time: 23.84365177154541
Epoch: 15, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.172 Vali Acc: 0.982 Test Loss: 0.172 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.1623s/iter; left time: 2330.6273s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 455.6483s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 432.6660s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0268s/iter; left time: 376.5038s
Epoch: 16 cost time: 14.653344869613647
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.977 Test Loss: 0.214 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1283s/iter; left time: 1789.0811s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 495.4457s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0416s/iter; left time: 571.3766s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0387s/iter; left time: 528.1825s
Epoch: 17 cost time: 16.153404712677002
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.277 Vali Acc: 0.977 Test Loss: 0.277 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000025
	speed: 0.1844s/iter; left time: 2495.0930s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.0533s/iter; left time: 715.4361s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 601.8436s
	iters: 400, epoch: 18 | loss: 0.0000007
	speed: 0.0487s/iter; left time: 644.2960s
Epoch: 18 cost time: 21.408438682556152
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.984 Test Loss: 0.203 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2011s/iter; left time: 2637.8985s
	iters: 200, epoch: 19 | loss: 0.0005865
	speed: 0.0570s/iter; left time: 742.0542s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 808.8148s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0453s/iter; left time: 580.8241s
Epoch: 19 cost time: 24.39189887046814
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.976 Test Loss: 0.208 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1933s/iter; left time: 2455.4541s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 765.9406s
	iters: 300, epoch: 20 | loss: 0.0000014
	speed: 0.0728s/iter; left time: 910.3822s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0713s/iter; left time: 883.8963s
Epoch: 20 cost time: 27.54837155342102
Epoch: 20, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.5287040
	speed: 0.1764s/iter; left time: 2168.5243s
	iters: 200, epoch: 21 | loss: 0.0008311
	speed: 0.0507s/iter; left time: 618.3103s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0418s/iter; left time: 505.1556s
	iters: 400, epoch: 21 | loss: 0.0040757
	speed: 0.0526s/iter; left time: 630.9506s
Epoch: 21 cost time: 20.51289391517639
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.985 Test Loss: 0.219 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 22531594
model size : 100.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7923918
	speed: 0.0640s/iter; left time: 1315.3979s
	iters: 200, epoch: 1 | loss: 0.0308437
	speed: 0.0436s/iter; left time: 892.5857s
	iters: 300, epoch: 1 | loss: 0.0981273
	speed: 0.0388s/iter; left time: 789.5266s
	iters: 400, epoch: 1 | loss: 0.0485392
	speed: 0.0420s/iter; left time: 850.9505s
Epoch: 1 cost time: 19.538573741912842
Epoch: 1, Steps: 413 | Train Loss: 0.569 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0006281
	speed: 0.1523s/iter; left time: 3066.9551s
	iters: 200, epoch: 2 | loss: 0.0237118
	speed: 0.0349s/iter; left time: 698.9691s
	iters: 300, epoch: 2 | loss: 0.0296261
	speed: 0.0415s/iter; left time: 826.6347s
	iters: 400, epoch: 2 | loss: 0.0296272
	speed: 0.0346s/iter; left time: 687.2158s
Epoch: 2 cost time: 15.355625629425049
Epoch: 2, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.964528 --> -0.975442).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0127553
	speed: 0.1813s/iter; left time: 3575.4316s
	iters: 200, epoch: 3 | loss: 0.0163550
	speed: 0.0440s/iter; left time: 862.5428s
	iters: 300, epoch: 3 | loss: 0.0059334
	speed: 0.0383s/iter; left time: 748.1111s
	iters: 400, epoch: 3 | loss: 0.0081191
	speed: 0.0418s/iter; left time: 812.7147s
Epoch: 3 cost time: 17.859388828277588
Epoch: 3, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0064304
	speed: 0.1920s/iter; left time: 3708.8448s
	iters: 200, epoch: 4 | loss: 0.0036028
	speed: 0.0444s/iter; left time: 852.7649s
	iters: 300, epoch: 4 | loss: 0.0014061
	speed: 0.0439s/iter; left time: 838.2241s
	iters: 400, epoch: 4 | loss: 0.0016872
	speed: 0.0500s/iter; left time: 950.6618s
Epoch: 4 cost time: 18.55984330177307
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.979535 --> -0.985447).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0003159
	speed: 0.1976s/iter; left time: 3734.0977s
	iters: 200, epoch: 5 | loss: 0.0019414
	speed: 0.0494s/iter; left time: 928.7762s
	iters: 300, epoch: 5 | loss: 0.0016955
	speed: 0.0551s/iter; left time: 1030.1253s
	iters: 400, epoch: 5 | loss: 0.0000099
	speed: 0.0525s/iter; left time: 975.5491s
Epoch: 5 cost time: 22.449292182922363
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.984 Test Loss: 0.092 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000588
	speed: 0.1940s/iter; left time: 3585.3716s
	iters: 200, epoch: 6 | loss: 0.0000242
	speed: 0.0528s/iter; left time: 970.9735s
	iters: 300, epoch: 6 | loss: 0.0001276
	speed: 0.0476s/iter; left time: 871.3034s
	iters: 400, epoch: 6 | loss: 0.2328511
	speed: 0.0466s/iter; left time: 847.8101s
Epoch: 6 cost time: 21.051711082458496
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000003
	speed: 0.1742s/iter; left time: 3148.5376s
	iters: 200, epoch: 7 | loss: 0.0108866
	speed: 0.0447s/iter; left time: 803.1358s
	iters: 300, epoch: 7 | loss: 0.0000356
	speed: 0.0539s/iter; left time: 963.8019s
	iters: 400, epoch: 7 | loss: 0.0864795
	speed: 0.0477s/iter; left time: 848.2438s
Epoch: 7 cost time: 20.28185200691223
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0006973
	speed: 0.1566s/iter; left time: 2765.9056s
	iters: 200, epoch: 8 | loss: 0.0000025
	speed: 0.0421s/iter; left time: 738.5173s
	iters: 300, epoch: 8 | loss: 0.0002350
	speed: 0.0407s/iter; left time: 710.6323s
	iters: 400, epoch: 8 | loss: 0.1202290
	speed: 0.0452s/iter; left time: 785.1933s
Epoch: 8 cost time: 17.237614631652832
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1681s/iter; left time: 2899.5295s
	iters: 200, epoch: 9 | loss: 0.0009012
	speed: 0.0439s/iter; left time: 752.4028s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0437s/iter; left time: 744.2301s
	iters: 400, epoch: 9 | loss: 0.0043333
	speed: 0.0380s/iter; left time: 643.2794s
Epoch: 9 cost time: 18.347529888153076
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.226 Vali Acc: 0.977 Test Loss: 0.226 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1479s/iter; left time: 2489.5396s
	iters: 200, epoch: 10 | loss: 0.0253478
	speed: 0.0386s/iter; left time: 645.1972s
	iters: 300, epoch: 10 | loss: 0.0000083
	speed: 0.0376s/iter; left time: 624.6943s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0378s/iter; left time: 624.6888s
Epoch: 10 cost time: 16.128185510635376
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000011
	speed: 0.1488s/iter; left time: 2443.3212s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0340s/iter; left time: 554.8779s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 496.2962s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 716.5061s
Epoch: 11 cost time: 15.02299952507019
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1777s/iter; left time: 2844.2363s
	iters: 200, epoch: 12 | loss: 0.0000592
	speed: 0.0470s/iter; left time: 747.3686s
	iters: 300, epoch: 12 | loss: 0.0021105
	speed: 0.0423s/iter; left time: 668.9223s
	iters: 400, epoch: 12 | loss: 0.0000010
	speed: 0.0476s/iter; left time: 746.9522s
Epoch: 12 cost time: 19.462889432907104
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.976 Test Loss: 0.209 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000099
	speed: 0.1721s/iter; left time: 2683.4072s
	iters: 200, epoch: 13 | loss: 0.0035409
	speed: 0.0476s/iter; left time: 737.4477s
	iters: 300, epoch: 13 | loss: 0.0003040
	speed: 0.0496s/iter; left time: 763.5892s
	iters: 400, epoch: 13 | loss: 0.0003153
	speed: 0.0504s/iter; left time: 771.0413s
Epoch: 13 cost time: 21.128471851348877
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.286 Vali Acc: 0.973 Test Loss: 0.286 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1722s/iter; left time: 2613.7840s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0363s/iter; left time: 548.1215s
	iters: 300, epoch: 14 | loss: 0.0000009
	speed: 0.0414s/iter; left time: 620.9680s
	iters: 400, epoch: 14 | loss: 0.0040649
	speed: 0.0387s/iter; left time: 575.4487s
Epoch: 14 cost time: 16.917787075042725
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 22448650
model size : 100.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2274161
	speed: 0.1002s/iter; left time: 2058.4034s
	iters: 200, epoch: 1 | loss: 0.0296582
	speed: 0.0864s/iter; left time: 1767.0325s
	iters: 300, epoch: 1 | loss: 0.3509749
	speed: 0.0712s/iter; left time: 1449.7989s
	iters: 400, epoch: 1 | loss: 0.7573985
	speed: 0.0713s/iter; left time: 1443.9571s
Epoch: 1 cost time: 34.264952182769775
Epoch: 1, Steps: 413 | Train Loss: 0.510 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
Validation loss decreased (inf --> -0.965437).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0028570
	speed: 0.2215s/iter; left time: 4459.9940s
	iters: 200, epoch: 2 | loss: 0.3858354
	speed: 0.0543s/iter; left time: 1088.2505s
	iters: 300, epoch: 2 | loss: 0.0002064
	speed: 0.0398s/iter; left time: 793.5314s
	iters: 400, epoch: 2 | loss: 0.0000609
	speed: 0.0563s/iter; left time: 1116.8842s
Epoch: 2 cost time: 22.99197244644165
Epoch: 2, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.965437 --> -0.975442).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7058926
	speed: 0.2158s/iter; left time: 4255.7449s
	iters: 200, epoch: 3 | loss: 0.0010000
	speed: 0.0849s/iter; left time: 1665.3765s
	iters: 300, epoch: 3 | loss: 0.0018828
	speed: 0.0931s/iter; left time: 1818.1119s
	iters: 400, epoch: 3 | loss: 0.0030555
	speed: 0.1051s/iter; left time: 2041.3554s
Epoch: 3 cost time: 36.56878423690796
Epoch: 3, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000007
	speed: 0.2285s/iter; left time: 4412.0035s
	iters: 200, epoch: 4 | loss: 0.0000010
	speed: 0.0852s/iter; left time: 1636.9673s
	iters: 300, epoch: 4 | loss: 0.1768762
	speed: 0.0848s/iter; left time: 1619.9014s
	iters: 400, epoch: 4 | loss: 0.0000868
	speed: 0.0861s/iter; left time: 1636.1083s
Epoch: 4 cost time: 33.34232783317566
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.2234s/iter; left time: 4222.0272s
	iters: 200, epoch: 5 | loss: 0.0000036
	speed: 0.0629s/iter; left time: 1183.2699s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 1110.4856s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 1084.1938s
Epoch: 5 cost time: 27.628878355026245
Epoch: 5, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
Validation loss decreased (-0.979535 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000412
	speed: 0.2351s/iter; left time: 4346.2236s
	iters: 200, epoch: 6 | loss: 0.2096129
	speed: 0.0656s/iter; left time: 1206.6612s
	iters: 300, epoch: 6 | loss: 0.0000005
	speed: 0.0605s/iter; left time: 1106.3629s
	iters: 400, epoch: 6 | loss: 0.0032633
	speed: 0.0557s/iter; left time: 1013.6313s
Epoch: 6 cost time: 26.7313494682312
Epoch: 6, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.310 Vali Acc: 0.973 Test Loss: 0.310 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0004155
	speed: 0.2193s/iter; left time: 3963.6659s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.0594s/iter; left time: 1067.0148s
	iters: 300, epoch: 7 | loss: 0.0000013
	speed: 0.0610s/iter; left time: 1090.6044s
	iters: 400, epoch: 7 | loss: 0.0000021
	speed: 0.0727s/iter; left time: 1292.0539s
Epoch: 7 cost time: 28.56217360496521
Epoch: 7, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.984 Test Loss: 0.126 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.984082).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5185694
	speed: 0.2946s/iter; left time: 5201.8252s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0900s/iter; left time: 1580.0098s
	iters: 300, epoch: 8 | loss: 0.0000016
	speed: 0.0767s/iter; left time: 1338.5286s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0924s/iter; left time: 1603.7602s
Epoch: 8 cost time: 38.78717350959778
Epoch: 8, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2701s/iter; left time: 4657.8142s
	iters: 200, epoch: 9 | loss: 0.7218370
	speed: 0.1013s/iter; left time: 1737.7628s
	iters: 300, epoch: 9 | loss: 0.0000004
	speed: 0.0936s/iter; left time: 1595.0154s
	iters: 400, epoch: 9 | loss: 0.1466607
	speed: 0.0872s/iter; left time: 1478.0942s
Epoch: 9 cost time: 39.12781882286072
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2334s/iter; left time: 3928.6509s
	iters: 200, epoch: 10 | loss: 0.0258036
	speed: 0.0844s/iter; left time: 1411.9610s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0798s/iter; left time: 1327.5127s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 1045.0728s
Epoch: 10 cost time: 32.376485109329224
Epoch: 10, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2021s/iter; left time: 3318.2273s
	iters: 200, epoch: 11 | loss: 0.2068082
	speed: 0.0760s/iter; left time: 1239.8849s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0739s/iter; left time: 1198.6682s
	iters: 400, epoch: 11 | loss: 0.0000012
	speed: 0.0717s/iter; left time: 1155.2836s
Epoch: 11 cost time: 28.819820642471313
Epoch: 11, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.177 Vali Acc: 0.986 Test Loss: 0.177 Test Acc: 0.986
Validation loss decreased (-0.984082 --> -0.986356).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2207s/iter; left time: 3533.2689s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 1140.8872s
	iters: 300, epoch: 12 | loss: 0.0000022
	speed: 0.0576s/iter; left time: 910.7986s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 845.4341s
Epoch: 12 cost time: 26.65436339378357
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.984 Test Loss: 0.222 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2217s/iter; left time: 3456.8435s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0986s/iter; left time: 1527.3681s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 1387.4322s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0864s/iter; left time: 1322.0514s
Epoch: 13 cost time: 38.47596335411072
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.993 Test Loss: 0.117 Test Acc: 0.993
Validation loss decreased (-0.986356 --> -0.992723).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2382s/iter; left time: 3617.0975s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0635s/iter; left time: 957.7632s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0611s/iter; left time: 915.2538s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0728s/iter; left time: 1083.6341s
Epoch: 14 cost time: 27.671789169311523
Epoch: 14, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.164 Vali Acc: 0.987 Test Loss: 0.164 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2230s/iter; left time: 3293.4014s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0737s/iter; left time: 1081.6533s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 1094.5517s
	iters: 400, epoch: 15 | loss: 0.2489249
	speed: 0.0517s/iter; left time: 748.2977s
Epoch: 15 cost time: 28.69619345664978
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.989 Test Loss: 0.148 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2267s/iter; left time: 3253.9708s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 780.0677s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 830.4792s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 748.2035s
Epoch: 16 cost time: 25.22702169418335
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.989 Test Loss: 0.170 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2298s/iter; left time: 3204.3489s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0517s/iter; left time: 715.9589s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 934.6870s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 921.4439s
Epoch: 17 cost time: 26.945045471191406
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.245 Vali Acc: 0.987 Test Loss: 0.245 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000231
	speed: 0.2383s/iter; left time: 3223.5763s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1001s/iter; left time: 1343.8472s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0712s/iter; left time: 948.7184s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 1053.4273s
Epoch: 18 cost time: 35.899118185043335
Epoch: 18, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.470 Vali Acc: 0.979 Test Loss: 0.470 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2536s/iter; left time: 3326.4193s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0787s/iter; left time: 1024.8678s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0822s/iter; left time: 1061.3661s
	iters: 400, epoch: 19 | loss: 0.2246820
	speed: 0.0929s/iter; left time: 1191.3300s
Epoch: 19 cost time: 35.05180311203003
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.310 Vali Acc: 0.987 Test Loss: 0.310 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2308s/iter; left time: 2932.4588s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0890s/iter; left time: 1121.8132s
	iters: 300, epoch: 20 | loss: 0.0006173
	speed: 0.0786s/iter; left time: 982.9686s
	iters: 400, epoch: 20 | loss: 0.0000276
	speed: 0.0658s/iter; left time: 816.3070s
Epoch: 20 cost time: 32.40081787109375
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.505 Vali Acc: 0.976 Test Loss: 0.505 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2423s/iter; left time: 2978.1627s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 773.0880s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0683s/iter; left time: 825.3212s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 757.3179s
Epoch: 21 cost time: 30.004902839660645
Epoch: 21, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.599 Vali Acc: 0.971 Test Loss: 0.599 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0482756
	speed: 0.1973s/iter; left time: 2343.4168s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 681.7556s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 539.9164s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0692s/iter; left time: 801.6367s
Epoch: 22 cost time: 23.90316891670227
Epoch: 22, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.400 Vali Acc: 0.983 Test Loss: 0.400 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2022s/iter; left time: 2318.5077s
	iters: 200, epoch: 23 | loss: 0.0792179
	speed: 0.0801s/iter; left time: 910.1408s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0880s/iter; left time: 991.6651s
	iters: 400, epoch: 23 | loss: 0.0020687
	speed: 0.0884s/iter; left time: 987.2486s
Epoch: 23 cost time: 34.27571749687195
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.990 Test Loss: 0.153 Test Acc: 0.990
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9927239654388358
model parameter : 22755082
model size : 101.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1639586
	speed: 0.0941s/iter; left time: 1933.8696s
	iters: 200, epoch: 1 | loss: 0.2205169
	speed: 0.0695s/iter; left time: 1421.6364s
	iters: 300, epoch: 1 | loss: 0.6751399
	speed: 0.0644s/iter; left time: 1311.1048s
	iters: 400, epoch: 1 | loss: 0.1663965
	speed: 0.0549s/iter; left time: 1111.0731s
Epoch: 1 cost time: 29.25111961364746
Epoch: 1, Steps: 413 | Train Loss: 0.519 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0530708
	speed: 0.1595s/iter; left time: 3212.4862s
	iters: 200, epoch: 2 | loss: 0.0376651
	speed: 0.0548s/iter; left time: 1098.6917s
	iters: 300, epoch: 2 | loss: 0.0260104
	speed: 0.0605s/iter; left time: 1206.5315s
	iters: 400, epoch: 2 | loss: 0.0503481
	speed: 0.0441s/iter; left time: 874.6556s
Epoch: 2 cost time: 21.199570655822754
Epoch: 2, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0286032
	speed: 0.1654s/iter; left time: 3262.7221s
	iters: 200, epoch: 3 | loss: 0.3200225
	speed: 0.0540s/iter; left time: 1059.9594s
	iters: 300, epoch: 3 | loss: 0.0002379
	speed: 0.0736s/iter; left time: 1436.2951s
	iters: 400, epoch: 3 | loss: 0.0221223
	speed: 0.0485s/iter; left time: 941.9845s
Epoch: 3 cost time: 23.83842706680298
Epoch: 3, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.965 Test Loss: 0.235 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0005251
	speed: 0.1588s/iter; left time: 3066.8621s
	iters: 200, epoch: 4 | loss: 0.0000323
	speed: 0.0440s/iter; left time: 845.1693s
	iters: 300, epoch: 4 | loss: 0.0025475
	speed: 0.0339s/iter; left time: 647.6073s
	iters: 400, epoch: 4 | loss: 0.0826091
	speed: 0.0361s/iter; left time: 686.3067s
Epoch: 4 cost time: 16.30038070678711
Epoch: 4, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
Validation loss decreased (-0.972259 --> -0.979080).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000326
	speed: 0.1695s/iter; left time: 3203.0864s
	iters: 200, epoch: 5 | loss: 0.0000267
	speed: 0.0453s/iter; left time: 850.8443s
	iters: 300, epoch: 5 | loss: 0.0817738
	speed: 0.0377s/iter; left time: 704.3859s
	iters: 400, epoch: 5 | loss: 0.0041808
	speed: 0.0504s/iter; left time: 936.9381s
Epoch: 5 cost time: 20.138607501983643
Epoch: 5, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
Validation loss decreased (-0.979080 --> -0.981354).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000014
	speed: 0.1954s/iter; left time: 3612.7471s
	iters: 200, epoch: 6 | loss: 0.0000126
	speed: 0.0739s/iter; left time: 1359.0186s
	iters: 300, epoch: 6 | loss: 0.0000756
	speed: 0.0775s/iter; left time: 1417.6001s
	iters: 400, epoch: 6 | loss: 0.0002988
	speed: 0.0685s/iter; left time: 1246.6471s
Epoch: 6 cost time: 29.487334489822388
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000016
	speed: 0.2074s/iter; left time: 3747.7811s
	iters: 200, epoch: 7 | loss: 0.0005598
	speed: 0.0743s/iter; left time: 1334.5300s
	iters: 300, epoch: 7 | loss: 0.0000020
	speed: 0.0720s/iter; left time: 1286.9008s
	iters: 400, epoch: 7 | loss: 0.0000539
	speed: 0.0679s/iter; left time: 1206.2624s
Epoch: 7 cost time: 29.288747549057007
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.287 Vali Acc: 0.967 Test Loss: 0.287 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000030
	speed: 0.1980s/iter; left time: 3496.8458s
	iters: 200, epoch: 8 | loss: 0.0000159
	speed: 0.0506s/iter; left time: 889.2212s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.0531s/iter; left time: 927.8684s
	iters: 400, epoch: 8 | loss: 0.0004688
	speed: 0.0583s/iter; left time: 1012.4994s
Epoch: 8 cost time: 23.687416791915894
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001814
	speed: 0.1815s/iter; left time: 3129.5944s
	iters: 200, epoch: 9 | loss: 0.0043038
	speed: 0.0417s/iter; left time: 715.7153s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 746.1257s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 921.3868s
Epoch: 9 cost time: 20.79696488380432
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.982718).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0016722
	speed: 0.1751s/iter; left time: 2947.8918s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0466s/iter; left time: 780.2398s
	iters: 300, epoch: 10 | loss: 0.0000684
	speed: 0.0438s/iter; left time: 729.1576s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0334s/iter; left time: 551.5428s
Epoch: 10 cost time: 18.515320777893066
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.982718 --> -0.984992).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1769s/iter; left time: 2904.2031s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0563s/iter; left time: 919.3584s
	iters: 300, epoch: 11 | loss: 0.0044837
	speed: 0.0562s/iter; left time: 911.9630s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.0493s/iter; left time: 794.5861s
Epoch: 11 cost time: 23.089988231658936
Epoch: 11, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.986 Test Loss: 0.159 Test Acc: 0.986
Validation loss decreased (-0.984992 --> -0.986356).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2049s/iter; left time: 3279.7705s
	iters: 200, epoch: 12 | loss: 0.0000567
	speed: 0.0785s/iter; left time: 1248.8128s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 1053.9317s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0569s/iter; left time: 894.0412s
Epoch: 12 cost time: 28.751269102096558
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.141 Vali Acc: 0.984 Test Loss: 0.141 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1979s/iter; left time: 3086.4174s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0667s/iter; left time: 1033.8781s
	iters: 300, epoch: 13 | loss: 0.0010139
	speed: 0.0616s/iter; left time: 948.6643s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 915.5829s
Epoch: 13 cost time: 26.89424157142639
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.983 Test Loss: 0.221 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1801s/iter; left time: 2733.8397s
	iters: 200, epoch: 14 | loss: 0.0000038
	speed: 0.0530s/iter; left time: 798.9382s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.0561s/iter; left time: 840.4998s
	iters: 400, epoch: 14 | loss: 0.3994284
	speed: 0.0613s/iter; left time: 911.9600s
Epoch: 14 cost time: 23.73416829109192
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.979 Test Loss: 0.206 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1520s/iter; left time: 2245.2110s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0329s/iter; left time: 483.0426s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 505.8891s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0403s/iter; left time: 583.4468s
Epoch: 15 cost time: 15.61147665977478
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.983 Test Loss: 0.149 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1513s/iter; left time: 2172.0611s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 531.6191s
	iters: 300, epoch: 16 | loss: 0.0008453
	speed: 0.0337s/iter; left time: 476.4541s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 517.4936s
Epoch: 16 cost time: 15.615338325500488
Epoch: 16, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.375 Vali Acc: 0.978 Test Loss: 0.375 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1691s/iter; left time: 2357.8052s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 740.3929s
	iters: 300, epoch: 17 | loss: 0.0000003
	speed: 0.0293s/iter; left time: 403.0400s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0359s/iter; left time: 490.0488s
Epoch: 17 cost time: 18.941784858703613
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.984 Test Loss: 0.205 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1577s/iter; left time: 2134.0485s
	iters: 200, epoch: 18 | loss: 0.0000013
	speed: 0.0742s/iter; left time: 996.8819s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 1000.8273s
	iters: 400, epoch: 18 | loss: 0.0000394
	speed: 0.0670s/iter; left time: 885.8944s
Epoch: 18 cost time: 28.401891469955444
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.985 Test Loss: 0.182 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1948s/iter; left time: 2555.6355s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0535s/iter; left time: 696.0013s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 905.9359s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0636s/iter; left time: 815.5413s
Epoch: 19 cost time: 26.840615034103394
Epoch: 19, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.987 Test Loss: 0.205 Test Acc: 0.987
Validation loss decreased (-0.986356 --> -0.987265).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1683s/iter; left time: 2137.7239s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 625.9153s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 568.1424s
	iters: 400, epoch: 20 | loss: 0.0075022
	speed: 0.0644s/iter; left time: 799.2472s
Epoch: 20 cost time: 21.177525281906128
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.982 Test Loss: 0.254 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1680s/iter; left time: 2064.5421s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0413s/iter; left time: 503.6133s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 446.6916s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0357s/iter; left time: 428.4290s
Epoch: 21 cost time: 17.42486047744751
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.983 Test Loss: 0.217 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1596s/iter; left time: 1895.3089s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 546.1973s
	iters: 300, epoch: 22 | loss: 0.0000694
	speed: 0.0445s/iter; left time: 519.8893s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0365s/iter; left time: 422.1850s
Epoch: 22 cost time: 18.8279390335083
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.991 Test Loss: 0.100 Test Acc: 0.991
Validation loss decreased (-0.987265 --> -0.991359).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1742s/iter; left time: 1997.6035s
	iters: 200, epoch: 23 | loss: 0.0000006
	speed: 0.0501s/iter; left time: 568.9817s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0544s/iter; left time: 612.3713s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0546s/iter; left time: 609.7675s
Epoch: 23 cost time: 22.155351161956787
Epoch: 23, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.978 Test Loss: 0.245 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000018
	speed: 0.1619s/iter; left time: 1789.4934s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0475s/iter; left time: 519.9078s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0547s/iter; left time: 593.9846s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0668s/iter; left time: 718.6317s
Epoch: 24 cost time: 22.791363954544067
Epoch: 24, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.985 Test Loss: 0.216 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1738s/iter; left time: 1848.7025s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 551.4908s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0622s/iter; left time: 649.0737s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 589.8410s
Epoch: 25 cost time: 23.10441279411316
Epoch: 25, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.209 Vali Acc: 0.988 Test Loss: 0.209 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1975s/iter; left time: 2019.3742s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0531s/iter; left time: 537.6036s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0578s/iter; left time: 579.1004s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0623s/iter; left time: 618.4321s
Epoch: 26 cost time: 24.625588417053223
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.984 Test Loss: 0.222 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2124s/iter; left time: 2084.2403s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0571s/iter; left time: 555.0667s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 458.7141s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0494s/iter; left time: 470.3490s
Epoch: 27 cost time: 23.590704441070557
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.987 Test Loss: 0.245 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1739s/iter; left time: 1634.7772s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 439.4887s
	iters: 300, epoch: 28 | loss: 0.0000151
	speed: 0.0471s/iter; left time: 432.8799s
	iters: 400, epoch: 28 | loss: 0.0000003
	speed: 0.0447s/iter; left time: 406.5732s
Epoch: 28 cost time: 20.249183893203735
Epoch: 28, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.240 Vali Acc: 0.986 Test Loss: 0.240 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1500s/iter; left time: 1347.9553s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 415.7758s
	iters: 300, epoch: 29 | loss: 0.0000203
	speed: 0.0559s/iter; left time: 491.5804s
	iters: 400, epoch: 29 | loss: 0.0000005
	speed: 0.0565s/iter; left time: 491.0189s
Epoch: 29 cost time: 21.462961673736572
Epoch: 29, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.523 Vali Acc: 0.977 Test Loss: 0.523 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1602s/iter; left time: 1373.6106s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 365.2687s
	iters: 300, epoch: 30 | loss: 0.0002513
	speed: 0.0434s/iter; left time: 363.5672s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0538s/iter; left time: 444.8617s
Epoch: 30 cost time: 19.05602788925171
Epoch: 30, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.230 Vali Acc: 0.987 Test Loss: 0.230 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1482s/iter; left time: 1209.6285s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 310.4312s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 391.7792s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 364.7548s
Epoch: 31 cost time: 19.084938049316406
Epoch: 31, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.194 Vali Acc: 0.985 Test Loss: 0.194 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2158s/iter; left time: 1672.1220s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 341.9033s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0377s/iter; left time: 284.2497s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 259.0229s
Epoch: 32 cost time: 19.480263233184814
Epoch: 32, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.988 Test Loss: 0.186 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9913597089586176
model parameter : 22561546
model size : 100.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7695400
	speed: 0.0605s/iter; left time: 1243.4027s
	iters: 200, epoch: 1 | loss: 0.3672607
	speed: 0.0515s/iter; left time: 1053.4645s
	iters: 300, epoch: 1 | loss: 0.4459112
	speed: 0.0401s/iter; left time: 815.2546s
	iters: 400, epoch: 1 | loss: 0.0234326
	speed: 0.0296s/iter; left time: 599.7726s
Epoch: 1 cost time: 18.671696662902832
Epoch: 1, Steps: 413 | Train Loss: 0.570 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0148153
	speed: 0.1403s/iter; left time: 2825.2828s
	iters: 200, epoch: 2 | loss: 0.0276465
	speed: 0.0378s/iter; left time: 756.6753s
	iters: 300, epoch: 2 | loss: 0.0000522
	speed: 0.0333s/iter; left time: 664.1839s
	iters: 400, epoch: 2 | loss: 0.0118043
	speed: 0.0362s/iter; left time: 718.8559s
Epoch: 2 cost time: 14.940634489059448
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.969531 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0004329
	speed: 0.1563s/iter; left time: 3082.4440s
	iters: 200, epoch: 3 | loss: 0.0197804
	speed: 0.0331s/iter; left time: 650.3015s
	iters: 300, epoch: 3 | loss: 0.0057582
	speed: 0.0320s/iter; left time: 625.5868s
	iters: 400, epoch: 3 | loss: 0.0012928
	speed: 0.0339s/iter; left time: 659.1493s
Epoch: 3 cost time: 14.416993379592896
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1809795
	speed: 0.1318s/iter; left time: 2544.9198s
	iters: 200, epoch: 4 | loss: 0.0152354
	speed: 0.0316s/iter; left time: 607.9504s
	iters: 300, epoch: 4 | loss: 0.0244519
	speed: 0.0312s/iter; left time: 596.5488s
	iters: 400, epoch: 4 | loss: 0.0002236
	speed: 0.0368s/iter; left time: 699.7607s
Epoch: 4 cost time: 14.390283346176147
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0006965
	speed: 0.1477s/iter; left time: 2791.3407s
	iters: 200, epoch: 5 | loss: 0.0000830
	speed: 0.0286s/iter; left time: 536.8041s
	iters: 300, epoch: 5 | loss: 0.0001209
	speed: 0.0297s/iter; left time: 556.1045s
	iters: 400, epoch: 5 | loss: 0.0000203
	speed: 0.0303s/iter; left time: 564.1231s
Epoch: 5 cost time: 12.781634092330933
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001349
	speed: 0.1300s/iter; left time: 2402.5229s
	iters: 200, epoch: 6 | loss: 0.0097453
	speed: 0.0316s/iter; left time: 580.9718s
	iters: 300, epoch: 6 | loss: 0.0000383
	speed: 0.0296s/iter; left time: 540.4043s
	iters: 400, epoch: 6 | loss: 0.0000008
	speed: 0.0290s/iter; left time: 527.2540s
Epoch: 6 cost time: 13.211780309677124
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.968 Test Loss: 0.205 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0024202
	speed: 0.1494s/iter; left time: 2700.7357s
	iters: 200, epoch: 7 | loss: 0.0001912
	speed: 0.0378s/iter; left time: 680.0602s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0391s/iter; left time: 698.2277s
	iters: 400, epoch: 7 | loss: 0.0007313
	speed: 0.0313s/iter; left time: 556.9063s
Epoch: 7 cost time: 16.000375270843506
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979535).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000848
	speed: 0.1767s/iter; left time: 3120.4187s
	iters: 200, epoch: 8 | loss: 0.0121697
	speed: 0.0512s/iter; left time: 898.8142s
	iters: 300, epoch: 8 | loss: 0.0068815
	speed: 0.0507s/iter; left time: 884.7699s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 885.9948s
Epoch: 8 cost time: 21.144665479660034
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.964 Test Loss: 0.244 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0005154
	speed: 0.1759s/iter; left time: 3034.4515s
	iters: 200, epoch: 9 | loss: 0.0005889
	speed: 0.0354s/iter; left time: 607.4504s
	iters: 300, epoch: 9 | loss: 0.0000007
	speed: 0.0462s/iter; left time: 788.3238s
	iters: 400, epoch: 9 | loss: 0.0000009
	speed: 0.0451s/iter; left time: 763.8911s
Epoch: 9 cost time: 18.474489450454712
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
Validation loss decreased (-0.979535 --> -0.984537).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.1871s/iter; left time: 3149.9181s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 593.0012s
	iters: 300, epoch: 10 | loss: 0.0000907
	speed: 0.0327s/iter; left time: 543.9839s
	iters: 400, epoch: 10 | loss: 0.0000037
	speed: 0.0387s/iter; left time: 640.6506s
Epoch: 10 cost time: 15.550170421600342
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1501s/iter; left time: 2465.3235s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0340s/iter; left time: 554.4591s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.0307s/iter; left time: 497.5345s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 535.0902s
Epoch: 11 cost time: 14.300202131271362
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.985447).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000030
	speed: 0.1513s/iter; left time: 2422.3697s
	iters: 200, epoch: 12 | loss: 0.0203775
	speed: 0.0291s/iter; left time: 462.5162s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 457.1986s
	iters: 400, epoch: 12 | loss: 0.0000008
	speed: 0.0270s/iter; left time: 423.7991s
Epoch: 12 cost time: 12.729973793029785
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.268 Vali Acc: 0.965 Test Loss: 0.268 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0003357
	speed: 0.1423s/iter; left time: 2219.1510s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0390s/iter; left time: 603.7056s
	iters: 300, epoch: 13 | loss: 0.0002679
	speed: 0.0344s/iter; left time: 529.6735s
	iters: 400, epoch: 13 | loss: 0.0137434
	speed: 0.0318s/iter; left time: 486.3873s
Epoch: 13 cost time: 15.396912336349487
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.981 Test Loss: 0.163 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.1136s/iter; left time: 1724.1556s
	iters: 200, epoch: 14 | loss: 0.0000010
	speed: 0.0319s/iter; left time: 481.2338s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 631.7150s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0488s/iter; left time: 726.9008s
Epoch: 14 cost time: 15.981515645980835
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.986 Test Loss: 0.098 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.986356).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0007273
	speed: 0.1808s/iter; left time: 2669.5871s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 537.5383s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0333s/iter; left time: 485.4376s
	iters: 400, epoch: 15 | loss: 0.0000094
	speed: 0.0438s/iter; left time: 634.0005s
Epoch: 15 cost time: 16.727833032608032
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000097
	speed: 0.1834s/iter; left time: 2633.3605s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 674.8666s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0421s/iter; left time: 595.7656s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0394s/iter; left time: 554.4657s
Epoch: 16 cost time: 19.194794178009033
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.284 Vali Acc: 0.976 Test Loss: 0.284 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1486s/iter; left time: 2072.1372s
	iters: 200, epoch: 17 | loss: 0.0000209
	speed: 0.0362s/iter; left time: 501.1938s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0369s/iter; left time: 506.9585s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0368s/iter; left time: 502.6917s
Epoch: 17 cost time: 15.748673915863037
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.978 Test Loss: 0.194 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1370s/iter; left time: 1853.4800s
	iters: 200, epoch: 18 | loss: 0.0000715
	speed: 0.0324s/iter; left time: 434.6899s
	iters: 300, epoch: 18 | loss: 0.7087584
	speed: 0.0324s/iter; left time: 431.4375s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 384.0582s
Epoch: 18 cost time: 13.797213792800903
Epoch: 18, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.980 Test Loss: 0.249 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0184720
	speed: 0.1213s/iter; left time: 1590.6127s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0262s/iter; left time: 340.8995s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.0257s/iter; left time: 331.5097s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0253s/iter; left time: 324.6551s
Epoch: 19 cost time: 11.467872858047485
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.297 Vali Acc: 0.980 Test Loss: 0.297 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1148s/iter; left time: 1458.6116s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0306s/iter; left time: 385.6122s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 315.4745s
	iters: 400, epoch: 20 | loss: 0.0019424
	speed: 0.0308s/iter; left time: 381.9340s
Epoch: 20 cost time: 12.42589020729065
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.986 Test Loss: 0.175 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1218s/iter; left time: 1496.8896s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 354.1241s
	iters: 300, epoch: 21 | loss: 0.0000518
	speed: 0.0284s/iter; left time: 343.9180s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0308s/iter; left time: 369.8453s
Epoch: 21 cost time: 12.532986402511597
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.983 Test Loss: 0.150 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000050
	speed: 0.1336s/iter; left time: 1587.4288s
	iters: 200, epoch: 22 | loss: 0.0001252
	speed: 0.0355s/iter; left time: 418.1741s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 374.4459s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0345s/iter; left time: 399.0662s
Epoch: 22 cost time: 14.382883787155151
Epoch: 22, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.982 Test Loss: 0.248 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.6094351
	speed: 0.1476s/iter; left time: 1692.5518s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 426.3636s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 367.5656s
	iters: 400, epoch: 23 | loss: 0.0012563
	speed: 0.0365s/iter; left time: 407.1028s
Epoch: 23 cost time: 15.309247970581055
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.977 Test Loss: 0.294 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000227
	speed: 0.1559s/iter; left time: 1722.9043s
	iters: 200, epoch: 24 | loss: 0.0000220
	speed: 0.0381s/iter; left time: 417.3398s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 391.1701s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0326s/iter; left time: 350.7582s
Epoch: 24 cost time: 15.440732717514038
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.979 Test Loss: 0.293 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 22460170
model size : 100.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5388833
	speed: 0.0688s/iter; left time: 1413.6412s
	iters: 200, epoch: 1 | loss: 0.8251125
	speed: 0.0397s/iter; left time: 812.1319s
	iters: 300, epoch: 1 | loss: 0.0928009
	speed: 0.0414s/iter; left time: 842.3478s
	iters: 400, epoch: 1 | loss: 0.0004530
	speed: 0.0400s/iter; left time: 810.2285s
Epoch: 1 cost time: 19.643765449523926
Epoch: 1, Steps: 413 | Train Loss: 0.484 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
Validation loss decreased (inf --> -0.980900).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0015871
	speed: 0.1539s/iter; left time: 3098.3727s
	iters: 200, epoch: 2 | loss: 0.0856084
	speed: 0.0364s/iter; left time: 728.4704s
	iters: 300, epoch: 2 | loss: 0.1532101
	speed: 0.0362s/iter; left time: 722.3617s
	iters: 400, epoch: 2 | loss: 0.0048615
	speed: 0.0452s/iter; left time: 895.7707s
Epoch: 2 cost time: 18.032084465026855
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.981354).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0103596
	speed: 0.1737s/iter; left time: 3426.9742s
	iters: 200, epoch: 3 | loss: 0.0141217
	speed: 0.0294s/iter; left time: 577.2677s
	iters: 300, epoch: 3 | loss: 0.0002637
	speed: 0.0485s/iter; left time: 947.2437s
	iters: 400, epoch: 3 | loss: 0.1226653
	speed: 0.0585s/iter; left time: 1136.7919s
Epoch: 3 cost time: 19.284138917922974
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0662725
	speed: 0.1912s/iter; left time: 3691.4902s
	iters: 200, epoch: 4 | loss: 0.0000263
	speed: 0.0553s/iter; left time: 1061.6514s
	iters: 300, epoch: 4 | loss: 0.0000481
	speed: 0.0513s/iter; left time: 981.0294s
	iters: 400, epoch: 4 | loss: 0.0005141
	speed: 0.0593s/iter; left time: 1127.3520s
Epoch: 4 cost time: 23.580241918563843
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0006117
	speed: 0.1746s/iter; left time: 3298.8411s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.0448s/iter; left time: 841.6087s
	iters: 300, epoch: 5 | loss: 0.0007340
	speed: 0.0402s/iter; left time: 752.1267s
	iters: 400, epoch: 5 | loss: 0.0000008
	speed: 0.0638s/iter; left time: 1187.1761s
Epoch: 5 cost time: 21.06666374206543
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.984537).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1597s/iter; left time: 2953.0073s
	iters: 200, epoch: 6 | loss: 0.0022405
	speed: 0.0335s/iter; left time: 615.7457s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 601.6744s
	iters: 400, epoch: 6 | loss: 0.0000004
	speed: 0.0305s/iter; left time: 554.1886s
Epoch: 6 cost time: 14.1388840675354
Epoch: 6, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000032
	speed: 0.1541s/iter; left time: 2784.2075s
	iters: 200, epoch: 7 | loss: 0.0000077
	speed: 0.0384s/iter; left time: 689.5538s
	iters: 300, epoch: 7 | loss: 0.0000463
	speed: 0.0302s/iter; left time: 540.1696s
	iters: 400, epoch: 7 | loss: 0.0226866
	speed: 0.0369s/iter; left time: 655.1893s
Epoch: 7 cost time: 15.63094687461853
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.987 Test Loss: 0.106 Test Acc: 0.987
Validation loss decreased (-0.984537 --> -0.986811).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000176
	speed: 0.1381s/iter; left time: 2439.5340s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0270s/iter; left time: 473.7466s
	iters: 300, epoch: 8 | loss: 0.0000006
	speed: 0.0428s/iter; left time: 746.4978s
	iters: 400, epoch: 8 | loss: 0.0000344
	speed: 0.0294s/iter; left time: 509.5339s
Epoch: 8 cost time: 13.94072437286377
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.071 Vali Acc: 0.991 Test Loss: 0.071 Test Acc: 0.991
Validation loss decreased (-0.986811 --> -0.990904).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0041332
	speed: 0.1408s/iter; left time: 2428.6841s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 578.6115s
	iters: 300, epoch: 9 | loss: 0.0000380
	speed: 0.0310s/iter; left time: 529.1781s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 532.8312s
Epoch: 9 cost time: 14.488224983215332
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.052 Vali Acc: 0.992 Test Loss: 0.052 Test Acc: 0.992
Validation loss decreased (-0.990904 --> -0.992269).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0113246
	speed: 0.1647s/iter; left time: 2771.9273s
	iters: 200, epoch: 10 | loss: 0.0000034
	speed: 0.0491s/iter; left time: 822.3420s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 877.8859s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 963.8317s
Epoch: 10 cost time: 23.19819951057434
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.342 Vali Acc: 0.971 Test Loss: 0.342 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0003652
	speed: 0.1385s/iter; left time: 2274.0004s
	iters: 200, epoch: 11 | loss: 0.1666958
	speed: 0.0327s/iter; left time: 534.2241s
	iters: 300, epoch: 11 | loss: 0.0016047
	speed: 0.0297s/iter; left time: 482.4311s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0425s/iter; left time: 685.8264s
Epoch: 11 cost time: 15.225054740905762
Epoch: 11, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.037 Vali Acc: 0.993 Test Loss: 0.037 Test Acc: 0.993
Validation loss decreased (-0.992269 --> -0.992724).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1288s/iter; left time: 2061.8934s
	iters: 200, epoch: 12 | loss: 0.0023942
	speed: 0.0347s/iter; left time: 552.6009s
	iters: 300, epoch: 12 | loss: 0.0144699
	speed: 0.0284s/iter; left time: 448.9560s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 680.5289s
Epoch: 12 cost time: 14.7298743724823
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.063 Vali Acc: 0.992 Test Loss: 0.063 Test Acc: 0.992
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000014
	speed: 0.1278s/iter; left time: 1993.6622s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0458s/iter; left time: 709.6817s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0408s/iter; left time: 627.4375s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 524.3995s
Epoch: 13 cost time: 17.076796531677246
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.987 Test Loss: 0.145 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000008
	speed: 0.1371s/iter; left time: 2081.3674s
	iters: 200, epoch: 14 | loss: 0.0000004
	speed: 0.0393s/iter; left time: 592.6630s
	iters: 300, epoch: 14 | loss: 0.5879651
	speed: 0.0453s/iter; left time: 679.3802s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0467s/iter; left time: 694.4375s
Epoch: 14 cost time: 17.968743085861206
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.981 Test Loss: 0.201 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000003
	speed: 0.1419s/iter; left time: 2096.3693s
	iters: 200, epoch: 15 | loss: 0.0004230
	speed: 0.0360s/iter; left time: 528.0226s
	iters: 300, epoch: 15 | loss: 0.0003064
	speed: 0.0347s/iter; left time: 505.3463s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 554.2823s
Epoch: 15 cost time: 15.527069568634033
Epoch: 15, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.990 Test Loss: 0.130 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0032673
	speed: 0.1488s/iter; left time: 2135.9288s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0399s/iter; left time: 568.5539s
	iters: 300, epoch: 16 | loss: 0.0000278
	speed: 0.0361s/iter; left time: 511.1780s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 526.7351s
Epoch: 16 cost time: 16.225818872451782
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.096 Vali Acc: 0.992 Test Loss: 0.096 Test Acc: 0.992
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1604s/iter; left time: 2236.0405s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0654s/iter; left time: 904.6654s
	iters: 300, epoch: 17 | loss: 0.0084034
	speed: 0.0547s/iter; left time: 752.0570s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0480s/iter; left time: 654.3450s
Epoch: 17 cost time: 24.005722045898438
Epoch: 17, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.352 Vali Acc: 0.979 Test Loss: 0.352 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2001s/iter; left time: 2707.2493s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 792.0387s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0456s/iter; left time: 607.9323s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 560.1120s
Epoch: 18 cost time: 23.020634651184082
Epoch: 18, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.986 Test Loss: 0.132 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1792s/iter; left time: 2350.0046s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 774.2101s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 680.3777s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 530.9611s
Epoch: 19 cost time: 22.40847086906433
Epoch: 19, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.190 Vali Acc: 0.987 Test Loss: 0.190 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1452s/iter; left time: 1845.2148s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0454s/iter; left time: 572.6799s
	iters: 300, epoch: 20 | loss: 0.0000006
	speed: 0.0515s/iter; left time: 644.5391s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 534.7895s
Epoch: 20 cost time: 19.82674741744995
Epoch: 20, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.988 Test Loss: 0.136 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1345s/iter; left time: 1652.5887s
	iters: 200, epoch: 21 | loss: 0.0032353
	speed: 0.0316s/iter; left time: 384.8245s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 426.2172s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0386s/iter; left time: 462.9255s
Epoch: 21 cost time: 15.140084505081177
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.178 Vali Acc: 0.989 Test Loss: 0.178 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9927239654388358
model parameter : 22656010
model size : 101.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2844747
	speed: 0.0581s/iter; left time: 1194.3775s
	iters: 200, epoch: 1 | loss: 0.3673688
	speed: 0.0336s/iter; left time: 687.1988s
	iters: 300, epoch: 1 | loss: 0.0073615
	speed: 0.0350s/iter; left time: 712.1138s
	iters: 400, epoch: 1 | loss: 0.2027338
	speed: 0.0342s/iter; left time: 692.5077s
Epoch: 1 cost time: 16.46788501739502
Epoch: 1, Steps: 413 | Train Loss: 0.521 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7771794
	speed: 0.1576s/iter; left time: 3174.7062s
	iters: 200, epoch: 2 | loss: 0.0093527
	speed: 0.0444s/iter; left time: 889.4151s
	iters: 300, epoch: 2 | loss: 0.0278139
	speed: 0.0330s/iter; left time: 657.2805s
	iters: 400, epoch: 2 | loss: 0.0035998
	speed: 0.0365s/iter; left time: 723.2601s
Epoch: 2 cost time: 16.933031797409058
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.959071 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000271
	speed: 0.2108s/iter; left time: 4158.0187s
	iters: 200, epoch: 3 | loss: 0.0022011
	speed: 0.0485s/iter; left time: 951.6611s
	iters: 300, epoch: 3 | loss: 0.0035719
	speed: 0.0361s/iter; left time: 704.6962s
	iters: 400, epoch: 3 | loss: 0.0143709
	speed: 0.0380s/iter; left time: 737.6102s
Epoch: 3 cost time: 17.90516448020935
Epoch: 3, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
Validation loss decreased (-0.962254 --> -0.981809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0254377
	speed: 0.1388s/iter; left time: 2679.7042s
	iters: 200, epoch: 4 | loss: 0.0000017
	speed: 0.0269s/iter; left time: 517.5850s
	iters: 300, epoch: 4 | loss: 0.0187576
	speed: 0.0395s/iter; left time: 754.1251s
	iters: 400, epoch: 4 | loss: 0.0000147
	speed: 0.0348s/iter; left time: 660.7091s
Epoch: 4 cost time: 13.585670232772827
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000006
	speed: 0.1014s/iter; left time: 1916.0050s
	iters: 200, epoch: 5 | loss: 0.0000667
	speed: 0.0224s/iter; left time: 421.2366s
	iters: 300, epoch: 5 | loss: 0.0002501
	speed: 0.0293s/iter; left time: 548.3038s
	iters: 400, epoch: 5 | loss: 0.0000162
	speed: 0.0341s/iter; left time: 633.7924s
Epoch: 5 cost time: 11.769142389297485
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.1047s/iter; left time: 1936.2873s
	iters: 200, epoch: 6 | loss: 0.0005552
	speed: 0.0230s/iter; left time: 423.1610s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0231s/iter; left time: 422.4003s
	iters: 400, epoch: 6 | loss: 0.0000001
	speed: 0.0337s/iter; left time: 612.6232s
Epoch: 6 cost time: 11.115111589431763
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.979 Test Loss: 0.166 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001113
	speed: 0.0985s/iter; left time: 1780.1325s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.0305s/iter; left time: 548.3640s
	iters: 300, epoch: 7 | loss: 0.0000309
	speed: 0.0385s/iter; left time: 688.7168s
	iters: 400, epoch: 7 | loss: 0.0000470
	speed: 0.0328s/iter; left time: 583.2940s
Epoch: 7 cost time: 13.545439004898071
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.984083).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1328s/iter; left time: 2344.9861s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 575.9116s
	iters: 300, epoch: 8 | loss: 0.0006613
	speed: 0.0318s/iter; left time: 556.0858s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.0303s/iter; left time: 525.3973s
Epoch: 8 cost time: 13.464327573776245
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.973 Test Loss: 0.260 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000728
	speed: 0.1527s/iter; left time: 2633.8768s
	iters: 200, epoch: 9 | loss: 0.0000037
	speed: 0.0505s/iter; left time: 866.4084s
	iters: 300, epoch: 9 | loss: 0.1498633
	speed: 0.0482s/iter; left time: 821.0927s
	iters: 400, epoch: 9 | loss: 0.0000438
	speed: 0.0440s/iter; left time: 746.1955s
Epoch: 9 cost time: 20.970077753067017
Epoch: 9, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1682s/iter; left time: 2832.2600s
	iters: 200, epoch: 10 | loss: 0.0000122
	speed: 0.0330s/iter; left time: 553.0213s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 621.7765s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.0380s/iter; left time: 628.5368s
Epoch: 10 cost time: 16.894567728042603
Epoch: 10, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.989 Test Loss: 0.110 Test Acc: 0.989
Validation loss decreased (-0.984083 --> -0.989085).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000008
	speed: 0.1743s/iter; left time: 2861.4338s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0353s/iter; left time: 575.3163s
	iters: 300, epoch: 11 | loss: 0.0002955
	speed: 0.0397s/iter; left time: 643.3628s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 561.4567s
Epoch: 11 cost time: 16.84012222290039
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.982 Test Loss: 0.147 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1539s/iter; left time: 2464.3643s
	iters: 200, epoch: 12 | loss: 0.6869649
	speed: 0.0529s/iter; left time: 841.5358s
	iters: 300, epoch: 12 | loss: 0.0006339
	speed: 0.0459s/iter; left time: 725.3177s
	iters: 400, epoch: 12 | loss: 0.0000128
	speed: 0.0364s/iter; left time: 571.2879s
Epoch: 12 cost time: 19.726891040802002
Epoch: 12, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.989 Test Loss: 0.068 Test Acc: 0.989
Validation loss decreased (-0.989085 --> -0.989085).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1595s/iter; left time: 2487.6556s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0704s/iter; left time: 1090.1778s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 1092.6365s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0556s/iter; left time: 850.9579s
Epoch: 13 cost time: 26.12370777130127
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.357 Vali Acc: 0.968 Test Loss: 0.357 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1787s/iter; left time: 2713.3741s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0567s/iter; left time: 855.3576s
	iters: 300, epoch: 14 | loss: 0.0000014
	speed: 0.0698s/iter; left time: 1045.2643s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 826.3075s
Epoch: 14 cost time: 25.52892518043518
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.988 Test Loss: 0.083 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1451s/iter; left time: 2143.0672s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 830.0534s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 868.7242s
	iters: 400, epoch: 15 | loss: 0.0000007
	speed: 0.0481s/iter; left time: 695.5121s
Epoch: 15 cost time: 22.33212685585022
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.987 Test Loss: 0.123 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1337s/iter; left time: 1919.3131s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0406s/iter; left time: 578.3660s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 671.0135s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0402s/iter; left time: 565.2983s
Epoch: 16 cost time: 17.6154944896698
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.982 Test Loss: 0.164 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.1417s/iter; left time: 1975.7955s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0493s/iter; left time: 682.0513s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 722.9451s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 735.0103s
Epoch: 17 cost time: 21.425893306732178
Epoch: 17, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.187 Vali Acc: 0.980 Test Loss: 0.187 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1394s/iter; left time: 1886.2137s
	iters: 200, epoch: 18 | loss: 0.0008204
	speed: 0.0466s/iter; left time: 625.6927s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 640.5667s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 705.2705s
Epoch: 18 cost time: 19.50701403617859
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.385 Vali Acc: 0.968 Test Loss: 0.385 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1535s/iter; left time: 2013.7909s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0545s/iter; left time: 710.0370s
	iters: 300, epoch: 19 | loss: 0.8306929
	speed: 0.0627s/iter; left time: 810.5038s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 925.5244s
Epoch: 19 cost time: 25.649823665618896
Epoch: 19, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.987 Test Loss: 0.128 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1835s/iter; left time: 2331.3875s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 517.1946s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 563.9652s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 610.1169s
Epoch: 20 cost time: 20.089987993240356
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.985 Test Loss: 0.154 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1641s/iter; left time: 2017.5356s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0469s/iter; left time: 572.3309s
	iters: 300, epoch: 21 | loss: 0.0143988
	speed: 0.0402s/iter; left time: 485.7475s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 405.2482s
Epoch: 21 cost time: 18.183449506759644
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.988 Test Loss: 0.180 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1426s/iter; left time: 1693.3069s
	iters: 200, epoch: 22 | loss: 1.5531161
	speed: 0.0307s/iter; left time: 361.0019s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 492.8789s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0374s/iter; left time: 432.7142s
Epoch: 22 cost time: 16.093772172927856
Epoch: 22, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.983 Test Loss: 0.220 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 22545418
model size : 100.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5506342
	speed: 0.0592s/iter; left time: 1217.2378s
	iters: 200, epoch: 1 | loss: 0.3192373
	speed: 0.0379s/iter; left time: 774.3709s
	iters: 300, epoch: 1 | loss: 0.2301659
	speed: 0.0290s/iter; left time: 590.8919s
	iters: 400, epoch: 1 | loss: 0.0219514
	speed: 0.0305s/iter; left time: 618.3647s
Epoch: 1 cost time: 16.357897520065308
Epoch: 1, Steps: 413 | Train Loss: 0.565 Vali Loss: 0.122 Vali Acc: 0.958 Test Loss: 0.122 Test Acc: 0.958
Validation loss decreased (inf --> -0.958162).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0145124
	speed: 0.1226s/iter; left time: 2468.1700s
	iters: 200, epoch: 2 | loss: 0.0782912
	speed: 0.0213s/iter; left time: 426.8948s
	iters: 300, epoch: 2 | loss: 0.0094994
	speed: 0.0211s/iter; left time: 421.6731s
	iters: 400, epoch: 2 | loss: 0.0292742
	speed: 0.0344s/iter; left time: 683.2905s
Epoch: 2 cost time: 11.689703464508057
Epoch: 2, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.958162 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002389
	speed: 0.1436s/iter; left time: 2833.2289s
	iters: 200, epoch: 3 | loss: 0.0068740
	speed: 0.0391s/iter; left time: 768.0301s
	iters: 300, epoch: 3 | loss: 0.0001011
	speed: 0.0354s/iter; left time: 690.9252s
	iters: 400, epoch: 3 | loss: 0.1395141
	speed: 0.0398s/iter; left time: 772.4938s
Epoch: 3 cost time: 15.702640056610107
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.964528 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000783
	speed: 0.1462s/iter; left time: 2823.7894s
	iters: 200, epoch: 4 | loss: 0.0015252
	speed: 0.0369s/iter; left time: 708.9480s
	iters: 300, epoch: 4 | loss: 0.0261577
	speed: 0.0379s/iter; left time: 725.2992s
	iters: 400, epoch: 4 | loss: 0.0226639
	speed: 0.0345s/iter; left time: 656.1252s
Epoch: 4 cost time: 15.751617193222046
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.972714 --> -0.977261).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0009840
	speed: 0.1580s/iter; left time: 2985.8789s
	iters: 200, epoch: 5 | loss: 0.0749190
	speed: 0.0394s/iter; left time: 740.6434s
	iters: 300, epoch: 5 | loss: 0.0000551
	speed: 0.0411s/iter; left time: 769.1460s
	iters: 400, epoch: 5 | loss: 0.0000045
	speed: 0.0360s/iter; left time: 670.4205s
Epoch: 5 cost time: 16.888916730880737
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.977261 --> -0.984992).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0281637
	speed: 0.1373s/iter; left time: 2537.9239s
	iters: 200, epoch: 6 | loss: 0.0008331
	speed: 0.0315s/iter; left time: 579.9485s
	iters: 300, epoch: 6 | loss: 0.0002225
	speed: 0.0330s/iter; left time: 604.0271s
	iters: 400, epoch: 6 | loss: 0.0000546
	speed: 0.0306s/iter; left time: 555.6738s
Epoch: 6 cost time: 14.008941888809204
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000045
	speed: 0.1172s/iter; left time: 2118.5014s
	iters: 200, epoch: 7 | loss: 0.0000003
	speed: 0.0279s/iter; left time: 500.9752s
	iters: 300, epoch: 7 | loss: 0.0000155
	speed: 0.0298s/iter; left time: 533.0046s
	iters: 400, epoch: 7 | loss: 0.0188233
	speed: 0.0313s/iter; left time: 555.4209s
Epoch: 7 cost time: 12.637251138687134
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000368
	speed: 0.1193s/iter; left time: 2106.1983s
	iters: 200, epoch: 8 | loss: 0.0000039
	speed: 0.0352s/iter; left time: 618.4705s
	iters: 300, epoch: 8 | loss: 0.0000257
	speed: 0.0352s/iter; left time: 614.7679s
	iters: 400, epoch: 8 | loss: 0.0007172
	speed: 0.0310s/iter; left time: 537.5045s
Epoch: 8 cost time: 13.95432734489441
Epoch: 8, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0065034
	speed: 0.1355s/iter; left time: 2336.3951s
	iters: 200, epoch: 9 | loss: 0.0006233
	speed: 0.0283s/iter; left time: 484.4558s
	iters: 300, epoch: 9 | loss: 0.0003459
	speed: 0.0261s/iter; left time: 444.1944s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 447.6278s
Epoch: 9 cost time: 12.083822965621948
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1507s/iter; left time: 2537.2747s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0456s/iter; left time: 763.4447s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0394s/iter; left time: 655.6971s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0338s/iter; left time: 558.4731s
Epoch: 10 cost time: 16.89841341972351
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1545s/iter; left time: 2536.6300s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.0489s/iter; left time: 797.3337s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0470s/iter; left time: 762.0262s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0415s/iter; left time: 669.5361s
Epoch: 11 cost time: 19.400364637374878
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000037
	speed: 0.1455s/iter; left time: 2329.7607s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 632.4239s
	iters: 300, epoch: 12 | loss: 0.0000292
	speed: 0.0372s/iter; left time: 587.5610s
	iters: 400, epoch: 12 | loss: 0.0065312
	speed: 0.0380s/iter; left time: 597.4264s
Epoch: 12 cost time: 16.355242252349854
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.223 Vali Acc: 0.970 Test Loss: 0.223 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1210304
	speed: 0.1130s/iter; left time: 1762.0304s
	iters: 200, epoch: 13 | loss: 0.0000015
	speed: 0.0300s/iter; left time: 465.1648s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0328s/iter; left time: 505.1208s
	iters: 400, epoch: 13 | loss: 0.0000005
	speed: 0.0351s/iter; left time: 536.3745s
Epoch: 13 cost time: 13.871301412582397
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0306309
	speed: 0.1140s/iter; left time: 1730.1823s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.0337s/iter; left time: 507.8452s
	iters: 300, epoch: 14 | loss: 0.0000514
	speed: 0.0309s/iter; left time: 463.1001s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.0339s/iter; left time: 503.8064s
Epoch: 14 cost time: 13.190362930297852
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.191 Vali Acc: 0.977 Test Loss: 0.191 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1388s/iter; left time: 2050.0278s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 482.0738s
	iters: 300, epoch: 15 | loss: 0.1753385
	speed: 0.0279s/iter; left time: 406.2730s
	iters: 400, epoch: 15 | loss: 0.0000191
	speed: 0.0250s/iter; left time: 362.0492s
Epoch: 15 cost time: 12.557240009307861
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.286 Vali Acc: 0.968 Test Loss: 0.286 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 22480906
model size : 100.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1377446
	speed: 0.1017s/iter; left time: 2090.9329s
	iters: 200, epoch: 1 | loss: 0.2080727
	speed: 0.0724s/iter; left time: 1480.7793s
	iters: 300, epoch: 1 | loss: 0.0376196
	speed: 0.0728s/iter; left time: 1482.5544s
	iters: 400, epoch: 1 | loss: 0.0332271
	speed: 0.0593s/iter; left time: 1201.1334s
Epoch: 1 cost time: 31.49953603744507
Epoch: 1, Steps: 413 | Train Loss: 0.496 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0272006
	speed: 0.1785s/iter; left time: 3595.2332s
	iters: 200, epoch: 2 | loss: 0.0344103
	speed: 0.0556s/iter; left time: 1113.4975s
	iters: 300, epoch: 2 | loss: 0.0005141
	speed: 0.0478s/iter; left time: 952.3507s
	iters: 400, epoch: 2 | loss: 0.0554095
	speed: 0.0525s/iter; left time: 1041.9693s
Epoch: 2 cost time: 22.81120753288269
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0039486
	speed: 0.1842s/iter; left time: 3632.9635s
	iters: 200, epoch: 3 | loss: 0.0000969
	speed: 0.0420s/iter; left time: 823.7788s
	iters: 300, epoch: 3 | loss: 0.0085376
	speed: 0.0378s/iter; left time: 737.8229s
	iters: 400, epoch: 3 | loss: 0.0184846
	speed: 0.0341s/iter; left time: 661.9101s
Epoch: 3 cost time: 17.579619884490967
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.970895 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000781
	speed: 0.1908s/iter; left time: 3684.6858s
	iters: 200, epoch: 4 | loss: 0.0000002
	speed: 0.0445s/iter; left time: 855.6122s
	iters: 300, epoch: 4 | loss: 0.0062472
	speed: 0.0419s/iter; left time: 801.4172s
	iters: 400, epoch: 4 | loss: 0.0000289
	speed: 0.0355s/iter; left time: 675.4237s
Epoch: 4 cost time: 18.919217109680176
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000444
	speed: 0.1616s/iter; left time: 3054.8086s
	iters: 200, epoch: 5 | loss: 0.0000034
	speed: 0.0425s/iter; left time: 798.0837s
	iters: 300, epoch: 5 | loss: 0.0000288
	speed: 0.0472s/iter; left time: 882.7859s
	iters: 400, epoch: 5 | loss: 0.0000171
	speed: 0.0426s/iter; left time: 791.6051s
Epoch: 5 cost time: 18.779134273529053
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.980900 --> -0.982718).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000236
	speed: 0.1736s/iter; left time: 3209.4977s
	iters: 200, epoch: 6 | loss: 0.0000264
	speed: 0.0352s/iter; left time: 646.7435s
	iters: 300, epoch: 6 | loss: 0.0010503
	speed: 0.0438s/iter; left time: 800.3040s
	iters: 400, epoch: 6 | loss: 0.0000481
	speed: 0.0577s/iter; left time: 1048.4964s
Epoch: 6 cost time: 19.141497135162354
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0002480
	speed: 0.1627s/iter; left time: 2941.0458s
	iters: 200, epoch: 7 | loss: 0.0000027
	speed: 0.0533s/iter; left time: 957.9193s
	iters: 300, epoch: 7 | loss: 0.7060797
	speed: 0.0438s/iter; left time: 783.4972s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 915.4602s
Epoch: 7 cost time: 20.800446271896362
Epoch: 7, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0254741
	speed: 0.1371s/iter; left time: 2420.9912s
	iters: 200, epoch: 8 | loss: 0.3950344
	speed: 0.0307s/iter; left time: 539.3531s
	iters: 300, epoch: 8 | loss: 0.0000027
	speed: 0.0299s/iter; left time: 521.3540s
	iters: 400, epoch: 8 | loss: 0.0019505
	speed: 0.0407s/iter; left time: 707.4131s
Epoch: 8 cost time: 14.577649116516113
Epoch: 8, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000014
	speed: 0.1696s/iter; left time: 2924.4029s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0521s/iter; left time: 893.5166s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.0424s/iter; left time: 722.0028s
	iters: 400, epoch: 9 | loss: 0.0685645
	speed: 0.0593s/iter; left time: 1005.4260s
Epoch: 9 cost time: 21.747960567474365
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000252
	speed: 0.1674s/iter; left time: 2817.2205s
	iters: 200, epoch: 10 | loss: 0.0958046
	speed: 0.0352s/iter; left time: 589.2950s
	iters: 300, epoch: 10 | loss: 0.0000438
	speed: 0.0312s/iter; left time: 518.2895s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0464s/iter; left time: 767.2397s
Epoch: 10 cost time: 18.334813833236694
Epoch: 10, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.980 Test Loss: 0.269 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1419s/iter; left time: 2330.9086s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 671.4424s
	iters: 300, epoch: 11 | loss: 0.6637883
	speed: 0.0310s/iter; left time: 503.3244s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 558.1148s
Epoch: 11 cost time: 15.782557964324951
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.986 Test Loss: 0.144 Test Acc: 0.986
Validation loss decreased (-0.982718 --> -0.985901).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1727s/iter; left time: 2764.9248s
	iters: 200, epoch: 12 | loss: 0.0000040
	speed: 0.0463s/iter; left time: 737.0222s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 662.0184s
	iters: 400, epoch: 12 | loss: 0.0000004
	speed: 0.0326s/iter; left time: 512.8414s
Epoch: 12 cost time: 18.302018880844116
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1310s/iter; left time: 2042.2207s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 654.2786s
	iters: 300, epoch: 13 | loss: 0.0000029
	speed: 0.0398s/iter; left time: 613.3793s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0351s/iter; left time: 537.1329s
Epoch: 13 cost time: 16.737741947174072
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.289 Vali Acc: 0.977 Test Loss: 0.289 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0002379
	speed: 0.1316s/iter; left time: 1998.6108s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 637.8106s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.0476s/iter; left time: 713.5690s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0492s/iter; left time: 731.6134s
Epoch: 14 cost time: 18.45017147064209
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.372 Vali Acc: 0.970 Test Loss: 0.372 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000004
	speed: 0.1566s/iter; left time: 2312.3528s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 867.9727s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.0536s/iter; left time: 780.4546s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0632s/iter; left time: 914.1057s
Epoch: 15 cost time: 24.407413959503174
Epoch: 15, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.233 Vali Acc: 0.981 Test Loss: 0.233 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1809s/iter; left time: 2596.8047s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 711.3160s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0569s/iter; left time: 805.1825s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0646s/iter; left time: 908.7093s
Epoch: 16 cost time: 24.28836989402771
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.985 Test Loss: 0.196 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2305016
	speed: 0.1943s/iter; left time: 2709.6223s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 689.7227s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 633.5493s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0489s/iter; left time: 666.7084s
Epoch: 17 cost time: 21.44041395187378
Epoch: 17, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.604 Vali Acc: 0.958 Test Loss: 0.604 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0046745
	speed: 0.1658s/iter; left time: 2243.3753s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0461s/iter; left time: 618.9964s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 640.6125s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 570.8981s
Epoch: 18 cost time: 19.20432734489441
Epoch: 18, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.163 Vali Acc: 0.989 Test Loss: 0.163 Test Acc: 0.989
Validation loss decreased (-0.985901 --> -0.989084).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1538s/iter; left time: 2017.3027s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 452.1559s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 458.3992s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0375s/iter; left time: 480.6414s
Epoch: 19 cost time: 14.831424713134766
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.981 Test Loss: 0.244 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1405s/iter; left time: 1784.3699s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 501.5140s
	iters: 300, epoch: 20 | loss: 0.0034324
	speed: 0.0350s/iter; left time: 437.4545s
	iters: 400, epoch: 20 | loss: 0.0054941
	speed: 0.0395s/iter; left time: 489.4346s
Epoch: 20 cost time: 16.719430685043335
Epoch: 20, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.986 Test Loss: 0.134 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1487s/iter; left time: 1827.8361s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0661s/iter; left time: 805.2677s
	iters: 300, epoch: 21 | loss: 0.0000707
	speed: 0.0535s/iter; left time: 646.8458s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 701.7824s
Epoch: 21 cost time: 24.494253158569336
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.987 Test Loss: 0.214 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1811s/iter; left time: 2151.6037s
	iters: 200, epoch: 22 | loss: 0.0001916
	speed: 0.0639s/iter; left time: 752.4097s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0595s/iter; left time: 695.0075s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 716.7968s
Epoch: 22 cost time: 26.92380428314209
Epoch: 22, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.989 Test Loss: 0.200 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1630s/iter; left time: 1869.3512s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0527s/iter; left time: 599.3661s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0510s/iter; left time: 574.0065s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0433s/iter; left time: 482.9039s
Epoch: 23 cost time: 20.610810041427612
Epoch: 23, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.258 Vali Acc: 0.985 Test Loss: 0.258 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1568s/iter; left time: 1732.4578s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0446s/iter; left time: 488.1144s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0410s/iter; left time: 444.8319s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 476.6478s
Epoch: 24 cost time: 17.85578989982605
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.991 Test Loss: 0.181 Test Acc: 0.991
Validation loss decreased (-0.989084 --> -0.990903).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1374s/iter; left time: 1462.0289s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 390.8434s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0352s/iter; left time: 366.9984s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0396s/iter; left time: 408.9200s
Epoch: 25 cost time: 15.031527042388916
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.992 Test Loss: 0.182 Test Acc: 0.992
Validation loss decreased (-0.990903 --> -0.992267).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1513s/iter; left time: 1547.7036s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 327.3028s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0289s/iter; left time: 289.2934s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0323s/iter; left time: 321.0985s
Epoch: 26 cost time: 14.347098112106323
Epoch: 26, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.156 Vali Acc: 0.993 Test Loss: 0.156 Test Acc: 0.993
Validation loss decreased (-0.992267 --> -0.992722).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.1745s/iter; left time: 1712.1260s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 537.5544s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 385.5939s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 532.1188s
Epoch: 27 cost time: 22.558430433273315
Epoch: 27, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.990 Test Loss: 0.205 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1770s/iter; left time: 1663.9641s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0479s/iter; left time: 445.2796s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 424.7829s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0631s/iter; left time: 574.2063s
Epoch: 28 cost time: 22.77384614944458
Epoch: 28, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.987 Test Loss: 0.204 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1726s/iter; left time: 1551.5290s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0458s/iter; left time: 406.6209s
	iters: 300, epoch: 29 | loss: 0.6688250
	speed: 0.0360s/iter; left time: 316.2130s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 454.2899s
Epoch: 29 cost time: 19.643359422683716
Epoch: 29, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.989 Test Loss: 0.198 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1621s/iter; left time: 1389.4785s
	iters: 200, epoch: 30 | loss: 0.0059582
	speed: 0.0342s/iter; left time: 290.0774s
	iters: 300, epoch: 30 | loss: 0.5086423
	speed: 0.0570s/iter; left time: 476.9914s
	iters: 400, epoch: 30 | loss: 0.0000003
	speed: 0.0488s/iter; left time: 403.4196s
Epoch: 30 cost time: 18.864927291870117
Epoch: 30, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.320 Vali Acc: 0.985 Test Loss: 0.320 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.1579s/iter; left time: 1289.0286s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0459s/iter; left time: 370.0295s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 552.8344s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0684s/iter; left time: 537.3914s
Epoch: 31 cost time: 23.81711483001709
Epoch: 31, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.433 Vali Acc: 0.978 Test Loss: 0.433 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.1699s/iter; left time: 1316.4022s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 406.9181s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 451.7617s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0462s/iter; left time: 343.7844s
Epoch: 32 cost time: 22.190491676330566
Epoch: 32, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.389 Vali Acc: 0.983 Test Loss: 0.389 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2157s/iter; left time: 1582.0028s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0892s/iter; left time: 645.1939s
	iters: 300, epoch: 33 | loss: 0.0003861
	speed: 0.0552s/iter; left time: 393.9843s
	iters: 400, epoch: 33 | loss: 0.0014558
	speed: 0.0537s/iter; left time: 377.6931s
Epoch: 33 cost time: 29.950632095336914
Epoch: 33, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.334 Vali Acc: 0.984 Test Loss: 0.334 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1904s/iter; left time: 1318.1708s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 488.9494s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0698s/iter; left time: 469.0201s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 352.5026s
Epoch: 34 cost time: 27.987370014190674
Epoch: 34, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.284 Vali Acc: 0.987 Test Loss: 0.284 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000003
	speed: 0.2144s/iter; left time: 1395.5252s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0539s/iter; left time: 345.3143s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 306.9335s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 321.6643s
Epoch: 35 cost time: 24.914487838745117
Epoch: 35, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.989 Test Loss: 0.297 Test Acc: 0.989
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.1996s/iter; left time: 1216.8706s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0414s/iter; left time: 248.0700s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.0393s/iter; left time: 231.5516s
	iters: 400, epoch: 36 | loss: 0.0000195
	speed: 0.0450s/iter; left time: 261.0796s
Epoch: 36 cost time: 19.696574449539185
Epoch: 36, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.499 Vali Acc: 0.979 Test Loss: 0.499 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9927239654388358
model parameter : 22676746
model size : 101.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5731152
	speed: 0.1041s/iter; left time: 2139.2119s
	iters: 200, epoch: 1 | loss: 0.5104575
	speed: 0.0726s/iter; left time: 1483.8459s
	iters: 300, epoch: 1 | loss: 0.0177391
	speed: 0.0703s/iter; left time: 1431.4255s
	iters: 400, epoch: 1 | loss: 0.0486855
	speed: 0.0776s/iter; left time: 1572.0295s
Epoch: 1 cost time: 33.777297258377075
Epoch: 1, Steps: 413 | Train Loss: 0.514 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (inf --> -0.943609).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2422139
	speed: 0.2698s/iter; left time: 5432.6718s
	iters: 200, epoch: 2 | loss: 0.0023741
	speed: 0.0955s/iter; left time: 1912.9029s
	iters: 300, epoch: 2 | loss: 0.2472441
	speed: 0.0987s/iter; left time: 1967.5922s
	iters: 400, epoch: 2 | loss: 0.0024763
	speed: 0.0643s/iter; left time: 1276.3054s
Epoch: 2 cost time: 39.250677824020386
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
Validation loss decreased (-0.943609 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1340687
	speed: 0.3393s/iter; left time: 6692.9798s
	iters: 200, epoch: 3 | loss: 0.0004880
	speed: 0.0820s/iter; left time: 1609.2254s
	iters: 300, epoch: 3 | loss: 0.0095788
	speed: 0.0731s/iter; left time: 1427.2994s
	iters: 400, epoch: 3 | loss: 0.0001374
	speed: 0.0954s/iter; left time: 1852.4792s
Epoch: 3 cost time: 38.62381410598755
Epoch: 3, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000035
	speed: 0.2432s/iter; left time: 4697.6174s
	iters: 200, epoch: 4 | loss: 0.0000123
	speed: 0.0654s/iter; left time: 1256.0221s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 1242.3045s
	iters: 400, epoch: 4 | loss: 0.0000309
	speed: 0.0828s/iter; left time: 1574.0611s
Epoch: 4 cost time: 29.565054655075073
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.980900).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000689
	speed: 0.2819s/iter; left time: 5328.1271s
	iters: 200, epoch: 5 | loss: 0.0003987
	speed: 0.0849s/iter; left time: 1595.8706s
	iters: 300, epoch: 5 | loss: 0.0000447
	speed: 0.0882s/iter; left time: 1649.1180s
	iters: 400, epoch: 5 | loss: 0.0000006
	speed: 0.0857s/iter; left time: 1594.8258s
Epoch: 5 cost time: 35.70014691352844
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
Validation loss decreased (-0.980900 --> -0.984992).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0004048
	speed: 0.2426s/iter; left time: 4484.9197s
	iters: 200, epoch: 6 | loss: 0.3358318
	speed: 0.0514s/iter; left time: 945.4793s
	iters: 300, epoch: 6 | loss: 0.0000013
	speed: 0.0618s/iter; left time: 1130.6731s
	iters: 400, epoch: 6 | loss: 0.0001103
	speed: 0.0655s/iter; left time: 1190.9284s
Epoch: 6 cost time: 24.886836528778076
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.984992 --> -0.984992).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1448438
	speed: 0.2990s/iter; left time: 5403.3694s
	iters: 200, epoch: 7 | loss: 0.0000006
	speed: 0.1085s/iter; left time: 1950.6401s
	iters: 300, epoch: 7 | loss: 0.0000098
	speed: 0.1215s/iter; left time: 2172.4229s
	iters: 400, epoch: 7 | loss: 0.0001318
	speed: 0.1393s/iter; left time: 2475.6629s
Epoch: 7 cost time: 49.02001929283142
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
Validation loss decreased (-0.984992 --> -0.985447).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000019
	speed: 0.2850s/iter; left time: 5032.9414s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.1038s/iter; left time: 1823.0977s
	iters: 300, epoch: 8 | loss: 0.0000189
	speed: 0.0809s/iter; left time: 1412.0281s
	iters: 400, epoch: 8 | loss: 0.0226785
	speed: 0.0550s/iter; left time: 955.2450s
Epoch: 8 cost time: 34.72465538978577
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3101276
	speed: 0.1930s/iter; left time: 3328.1617s
	iters: 200, epoch: 9 | loss: 0.0572627
	speed: 0.0630s/iter; left time: 1080.6672s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 1170.8691s
	iters: 400, epoch: 9 | loss: 0.0000035
	speed: 0.0930s/iter; left time: 1576.2571s
Epoch: 9 cost time: 31.85160517692566
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.989 Test Loss: 0.093 Test Acc: 0.989
Validation loss decreased (-0.985447 --> -0.989085).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0010412
	speed: 0.2088s/iter; left time: 3515.2185s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0785s/iter; left time: 1314.2698s
	iters: 300, epoch: 10 | loss: 0.0000003
	speed: 0.0926s/iter; left time: 1540.4372s
	iters: 400, epoch: 10 | loss: 0.0000009
	speed: 0.0593s/iter; left time: 980.0465s
Epoch: 10 cost time: 30.282272338867188
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000004
	speed: 0.2000s/iter; left time: 3284.7191s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0891s/iter; left time: 1453.8699s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0703s/iter; left time: 1140.4150s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0466s/iter; left time: 751.1761s
Epoch: 11 cost time: 28.390597581863403
Epoch: 11, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.983 Test Loss: 0.140 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0003634
	speed: 0.1643s/iter; left time: 2630.1467s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0562s/iter; left time: 894.7702s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0718s/iter; left time: 1135.1932s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1231s/iter; left time: 1934.1056s
Epoch: 12 cost time: 31.99411129951477
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.988 Test Loss: 0.086 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2689s/iter; left time: 4193.5924s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0941s/iter; left time: 1458.4979s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0867s/iter; left time: 1335.2635s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0659s/iter; left time: 1007.6141s
Epoch: 13 cost time: 35.350024938583374
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0422319
	speed: 0.2756s/iter; left time: 4183.4661s
	iters: 200, epoch: 14 | loss: 0.0000009
	speed: 0.1030s/iter; left time: 1553.3220s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1051s/iter; left time: 1573.9678s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 1115.1880s
Epoch: 14 cost time: 39.97860240936279
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.979 Test Loss: 0.200 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000063
	speed: 0.2242s/iter; left time: 3311.7026s
	iters: 200, epoch: 15 | loss: 0.2122427
	speed: 0.0812s/iter; left time: 1191.4731s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0723s/iter; left time: 1053.0634s
	iters: 400, epoch: 15 | loss: 0.0000007
	speed: 0.0398s/iter; left time: 575.4819s
Epoch: 15 cost time: 27.566913843154907
Epoch: 15, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.987 Test Loss: 0.137 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2139s/iter; left time: 3071.3144s
	iters: 200, epoch: 16 | loss: 0.0956599
	speed: 0.0692s/iter; left time: 985.9317s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 1131.5873s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 1010.6366s
Epoch: 16 cost time: 30.34893250465393
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.990 Test Loss: 0.113 Test Acc: 0.990
Validation loss decreased (-0.989085 --> -0.989540).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.2255s/iter; left time: 3144.8164s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 981.4822s
	iters: 300, epoch: 17 | loss: 0.0000101
	speed: 0.0515s/iter; left time: 708.0114s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 857.6005s
Epoch: 17 cost time: 25.792519092559814
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.991 Test Loss: 0.112 Test Acc: 0.991
Validation loss decreased (-0.989540 --> -0.990904).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2520s/iter; left time: 3409.0749s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.1218s/iter; left time: 1636.3020s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0942s/iter; left time: 1255.5711s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0951s/iter; left time: 1257.5620s
Epoch: 18 cost time: 42.5082950592041
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.989 Test Loss: 0.143 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2831s/iter; left time: 3713.2125s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 1025.9657s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0604s/iter; left time: 780.6064s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0785s/iter; left time: 1006.3682s
Epoch: 19 cost time: 34.720032691955566
Epoch: 19, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.980 Test Loss: 0.229 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000448
	speed: 0.2289s/iter; left time: 2907.5618s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0696s/iter; left time: 877.2162s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0817s/iter; left time: 1022.0282s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.0706s/iter; left time: 876.1339s
Epoch: 20 cost time: 31.911811590194702
Epoch: 20, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.991 Test Loss: 0.085 Test Acc: 0.991
Validation loss decreased (-0.990904 --> -0.991359).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2104s/iter; left time: 2585.9254s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 729.5703s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 873.2170s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0967s/iter; left time: 1159.9507s
Epoch: 21 cost time: 31.280526876449585
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.986 Test Loss: 0.198 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2435s/iter; left time: 2892.5163s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0505s/iter; left time: 594.4464s
	iters: 300, epoch: 22 | loss: 0.0000012
	speed: 0.0465s/iter; left time: 542.7971s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0518s/iter; left time: 600.1601s
Epoch: 22 cost time: 23.630435466766357
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.986 Test Loss: 0.169 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1575s/iter; left time: 1805.5249s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 377.8516s
	iters: 300, epoch: 23 | loss: 0.0000005
	speed: 0.0584s/iter; left time: 657.8349s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 660.4560s
Epoch: 23 cost time: 20.739116430282593
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.317 Vali Acc: 0.980 Test Loss: 0.317 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2041s/iter; left time: 2255.9762s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 480.7645s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 468.3738s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 412.1566s
Epoch: 24 cost time: 20.99072289466858
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.145 Vali Acc: 0.985 Test Loss: 0.145 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000981
	speed: 0.2057s/iter; left time: 2188.4544s
	iters: 200, epoch: 25 | loss: 0.6789620
	speed: 0.0870s/iter; left time: 917.3775s
	iters: 300, epoch: 25 | loss: 1.3373233
	speed: 0.0690s/iter; left time: 719.8607s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0658s/iter; left time: 680.4929s
Epoch: 25 cost time: 32.62129306793213
Epoch: 25, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.990 Test Loss: 0.161 Test Acc: 0.990
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0002694
	speed: 0.2113s/iter; left time: 2160.5572s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 703.9806s
	iters: 300, epoch: 26 | loss: 0.0026375
	speed: 0.0763s/iter; left time: 765.1802s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0589s/iter; left time: 584.1897s
Epoch: 26 cost time: 28.895988702774048
Epoch: 26, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.991 Test Loss: 0.108 Test Acc: 0.991
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000140
	speed: 0.2297s/iter; left time: 2253.6029s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0927s/iter; left time: 899.9380s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0868s/iter; left time: 834.3263s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 660.7743s
Epoch: 27 cost time: 35.195350646972656
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.985 Test Loss: 0.227 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1676038
	speed: 0.2769s/iter; left time: 2602.6722s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 732.6079s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 550.3131s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 615.0298s
Epoch: 28 cost time: 31.442594051361084
Epoch: 28, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.247 Vali Acc: 0.984 Test Loss: 0.247 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1043125
	speed: 0.2479s/iter; left time: 2227.8852s
	iters: 200, epoch: 29 | loss: 0.0006296
	speed: 0.0781s/iter; left time: 693.9466s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0564s/iter; left time: 495.7876s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 476.6013s
Epoch: 29 cost time: 27.636770725250244
Epoch: 29, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.990 Test Loss: 0.212 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2625s/iter; left time: 2250.8750s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0848s/iter; left time: 718.6806s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0803s/iter; left time: 672.5000s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0905s/iter; left time: 748.6671s
Epoch: 30 cost time: 37.94064426422119
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.988 Test Loss: 0.177 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9913597089586176
model parameter : 22575370
model size : 100.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7637991
	speed: 0.0607s/iter; left time: 1246.9982s
	iters: 200, epoch: 1 | loss: 0.1394528
	speed: 0.0315s/iter; left time: 643.6356s
	iters: 300, epoch: 1 | loss: 0.0207134
	speed: 0.0380s/iter; left time: 773.0409s
	iters: 400, epoch: 1 | loss: 0.0063990
	speed: 0.0279s/iter; left time: 564.2983s
Epoch: 1 cost time: 16.525748014450073
Epoch: 1, Steps: 413 | Train Loss: 0.584 Vali Loss: 0.078 Vali Acc: 0.971 Test Loss: 0.078 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0464135
	speed: 0.1219s/iter; left time: 2454.4563s
	iters: 200, epoch: 2 | loss: 0.3448552
	speed: 0.0268s/iter; left time: 537.0620s
	iters: 300, epoch: 2 | loss: 0.0015138
	speed: 0.0347s/iter; left time: 692.4089s
	iters: 400, epoch: 2 | loss: 0.0196650
	speed: 0.0305s/iter; left time: 604.1609s
Epoch: 2 cost time: 13.11496114730835
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.970895 --> -0.971349).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0003355
	speed: 0.1592s/iter; left time: 3140.1570s
	iters: 200, epoch: 3 | loss: 0.0006196
	speed: 0.0402s/iter; left time: 788.5541s
	iters: 300, epoch: 3 | loss: 0.1979019
	speed: 0.0455s/iter; left time: 888.3663s
	iters: 400, epoch: 3 | loss: 0.0046244
	speed: 0.0473s/iter; left time: 919.0418s
Epoch: 3 cost time: 18.688178539276123
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
Validation loss decreased (-0.971349 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0005462
	speed: 0.1693s/iter; left time: 3270.3166s
	iters: 200, epoch: 4 | loss: 0.0422051
	speed: 0.0426s/iter; left time: 817.8793s
	iters: 300, epoch: 4 | loss: 0.2188246
	speed: 0.0413s/iter; left time: 789.0464s
	iters: 400, epoch: 4 | loss: 0.0020863
	speed: 0.0507s/iter; left time: 963.8871s
Epoch: 4 cost time: 18.34103035926819
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002762
	speed: 0.1725s/iter; left time: 3259.8447s
	iters: 200, epoch: 5 | loss: 0.0006953
	speed: 0.0386s/iter; left time: 725.0359s
	iters: 300, epoch: 5 | loss: 0.0000563
	speed: 0.0317s/iter; left time: 593.2052s
	iters: 400, epoch: 5 | loss: 0.0002343
	speed: 0.0494s/iter; left time: 918.2852s
Epoch: 5 cost time: 17.456252098083496
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.972259 --> -0.975897).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0053077
	speed: 0.2079s/iter; left time: 3843.3990s
	iters: 200, epoch: 6 | loss: 0.0000401
	speed: 0.0419s/iter; left time: 770.9460s
	iters: 300, epoch: 6 | loss: 0.1087729
	speed: 0.0456s/iter; left time: 833.4847s
	iters: 400, epoch: 6 | loss: 0.0003913
	speed: 0.0338s/iter; left time: 614.3862s
Epoch: 6 cost time: 18.542733907699585
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.978625).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002037
	speed: 0.1930s/iter; left time: 3487.5514s
	iters: 200, epoch: 7 | loss: 0.0079560
	speed: 0.0530s/iter; left time: 952.2919s
	iters: 300, epoch: 7 | loss: 0.0000012
	speed: 0.0743s/iter; left time: 1327.0715s
	iters: 400, epoch: 7 | loss: 0.0001559
	speed: 0.0581s/iter; left time: 1032.9188s
Epoch: 7 cost time: 25.802451848983765
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000098
	speed: 0.2125s/iter; left time: 3752.4498s
	iters: 200, epoch: 8 | loss: 0.2844431
	speed: 0.0649s/iter; left time: 1140.3222s
	iters: 300, epoch: 8 | loss: 0.0000243
	speed: 0.0730s/iter; left time: 1274.5379s
	iters: 400, epoch: 8 | loss: 0.0000155
	speed: 0.0769s/iter; left time: 1335.6996s
Epoch: 8 cost time: 29.31195855140686
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2128s/iter; left time: 3669.3708s
	iters: 200, epoch: 9 | loss: 0.0367212
	speed: 0.0582s/iter; left time: 997.7449s
	iters: 300, epoch: 9 | loss: 0.0000687
	speed: 0.0608s/iter; left time: 1037.0669s
	iters: 400, epoch: 9 | loss: 0.0227521
	speed: 0.0485s/iter; left time: 822.0570s
Epoch: 9 cost time: 22.55280089378357
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000566
	speed: 0.1719s/iter; left time: 2892.9515s
	iters: 200, epoch: 10 | loss: 0.0000103
	speed: 0.0368s/iter; left time: 615.9502s
	iters: 300, epoch: 10 | loss: 0.0000007
	speed: 0.0315s/iter; left time: 523.9715s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 520.0887s
Epoch: 10 cost time: 14.58132553100586
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000446
	speed: 0.1539s/iter; left time: 2527.6578s
	iters: 200, epoch: 11 | loss: 0.0458488
	speed: 0.0549s/iter; left time: 896.6433s
	iters: 300, epoch: 11 | loss: 0.0000002
	speed: 0.0498s/iter; left time: 807.7631s
	iters: 400, epoch: 11 | loss: 0.0000032
	speed: 0.0600s/iter; left time: 967.2066s
Epoch: 11 cost time: 22.199721574783325
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.986 Test Loss: 0.098 Test Acc: 0.986
Validation loss decreased (-0.978625 --> -0.985902).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0008311
	speed: 0.2185s/iter; left time: 3496.9775s
	iters: 200, epoch: 12 | loss: 0.0018320
	speed: 0.0617s/iter; left time: 980.8729s
	iters: 300, epoch: 12 | loss: 0.0059466
	speed: 0.0467s/iter; left time: 738.0549s
	iters: 400, epoch: 12 | loss: 0.0000017
	speed: 0.0400s/iter; left time: 627.8425s
Epoch: 12 cost time: 19.480587005615234
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.055 Vali Acc: 0.989 Test Loss: 0.055 Test Acc: 0.989
Validation loss decreased (-0.985902 --> -0.989085).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0001160
	speed: 0.1660s/iter; left time: 2589.1747s
	iters: 200, epoch: 13 | loss: 0.0000549
	speed: 0.0764s/iter; left time: 1183.7954s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0710s/iter; left time: 1092.6490s
	iters: 400, epoch: 13 | loss: 0.0000126
	speed: 0.0783s/iter; left time: 1197.2295s
Epoch: 13 cost time: 30.645702600479126
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0407131
	speed: 0.2034s/iter; left time: 3088.3287s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0520s/iter; left time: 784.7525s
	iters: 300, epoch: 14 | loss: 0.0170443
	speed: 0.0412s/iter; left time: 617.2541s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 1020.2944s
Epoch: 14 cost time: 24.199870347976685
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.987 Test Loss: 0.094 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2143s/iter; left time: 3164.5633s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 1037.0773s
	iters: 300, epoch: 15 | loss: 0.0000717
	speed: 0.0670s/iter; left time: 975.4326s
	iters: 400, epoch: 15 | loss: 0.0066797
	speed: 0.0689s/iter; left time: 997.0240s
Epoch: 15 cost time: 29.630118370056152
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.978 Test Loss: 0.185 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.1972s/iter; left time: 2830.7035s
	iters: 200, epoch: 16 | loss: 0.0000012
	speed: 0.0651s/iter; left time: 927.9653s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.0617s/iter; left time: 873.4858s
	iters: 400, epoch: 16 | loss: 0.0000758
	speed: 0.0638s/iter; left time: 896.9665s
Epoch: 16 cost time: 27.84959316253662
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0051495
	speed: 0.1579s/iter; left time: 2201.9952s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 869.0208s
	iters: 300, epoch: 17 | loss: 0.0019262
	speed: 0.0677s/iter; left time: 930.9549s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0686s/iter; left time: 935.8708s
Epoch: 17 cost time: 25.901448011398315
Epoch: 17, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.982 Test Loss: 0.128 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000063
	speed: 0.1985s/iter; left time: 2685.2675s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 700.5015s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.0500s/iter; left time: 666.9322s
	iters: 400, epoch: 18 | loss: 0.0000055
	speed: 0.0430s/iter; left time: 568.4848s
Epoch: 18 cost time: 21.91505193710327
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1920s/iter; left time: 2518.9043s
	iters: 200, epoch: 19 | loss: 0.0000706
	speed: 0.0722s/iter; left time: 939.8325s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0614s/iter; left time: 793.5697s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 527.1432s
Epoch: 19 cost time: 26.01839590072632
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.989 Test Loss: 0.090 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1785s/iter; left time: 2268.2854s
	iters: 200, epoch: 20 | loss: 0.0000023
	speed: 0.0846s/iter; left time: 1065.8020s
	iters: 300, epoch: 20 | loss: 0.0000327
	speed: 0.0780s/iter; left time: 974.7151s
	iters: 400, epoch: 20 | loss: 0.0127032
	speed: 0.0841s/iter; left time: 1042.7051s
Epoch: 20 cost time: 32.430784702301025
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2386s/iter; left time: 2932.4007s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0635s/iter; left time: 773.8277s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 849.8568s
	iters: 400, epoch: 21 | loss: 0.0000010
	speed: 0.0702s/iter; left time: 841.6550s
Epoch: 21 cost time: 29.556188821792603
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.981 Test Loss: 0.175 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0001194
	speed: 0.2346s/iter; left time: 2786.9709s
	iters: 200, epoch: 22 | loss: 0.0000351
	speed: 0.0626s/iter; left time: 737.2549s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 643.4014s
	iters: 400, epoch: 22 | loss: 0.0000010
	speed: 0.0607s/iter; left time: 703.3289s
Epoch: 22 cost time: 26.299741983413696
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.981 Test Loss: 0.177 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 22501642
model size : 100.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5947809
	speed: 0.1050s/iter; left time: 2158.8473s
	iters: 200, epoch: 1 | loss: 1.0292245
	speed: 0.0611s/iter; left time: 1249.4183s
	iters: 300, epoch: 1 | loss: 0.0025718
	speed: 0.0795s/iter; left time: 1617.2707s
	iters: 400, epoch: 1 | loss: 0.1481129
	speed: 0.1191s/iter; left time: 2411.3813s
Epoch: 1 cost time: 38.053438663482666
Epoch: 1, Steps: 413 | Train Loss: 0.493 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6213670
	speed: 0.2641s/iter; left time: 5318.8084s
	iters: 200, epoch: 2 | loss: 0.9491118
	speed: 0.0865s/iter; left time: 1733.1165s
	iters: 300, epoch: 2 | loss: 0.0536060
	speed: 0.1132s/iter; left time: 2256.8247s
	iters: 400, epoch: 2 | loss: 0.0013777
	speed: 0.0763s/iter; left time: 1513.8440s
Epoch: 2 cost time: 38.58578634262085
Epoch: 2, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000242
	speed: 0.2573s/iter; left time: 5075.0510s
	iters: 200, epoch: 3 | loss: 0.0762304
	speed: 0.1463s/iter; left time: 2870.2029s
	iters: 300, epoch: 3 | loss: 0.0000785
	speed: 0.1479s/iter; left time: 2887.9377s
	iters: 400, epoch: 3 | loss: 0.0000004
	speed: 0.1380s/iter; left time: 2681.3446s
Epoch: 3 cost time: 55.803184270858765
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.965438 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001733
	speed: 0.2938s/iter; left time: 5674.7366s
	iters: 200, epoch: 4 | loss: 0.0000601
	speed: 0.0856s/iter; left time: 1644.3559s
	iters: 300, epoch: 4 | loss: 0.0001676
	speed: 0.0977s/iter; left time: 1866.6017s
	iters: 400, epoch: 4 | loss: 0.0011507
	speed: 0.1070s/iter; left time: 2034.6175s
Epoch: 4 cost time: 40.03582286834717
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1734942
	speed: 0.2781s/iter; left time: 5256.4452s
	iters: 200, epoch: 5 | loss: 0.0000074
	speed: 0.0909s/iter; left time: 1709.1125s
	iters: 300, epoch: 5 | loss: 0.0000044
	speed: 0.0692s/iter; left time: 1293.4435s
	iters: 400, epoch: 5 | loss: 0.0000003
	speed: 0.1161s/iter; left time: 2158.4456s
Epoch: 5 cost time: 38.21614718437195
Epoch: 5, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.978171 --> -0.987266).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000011
	speed: 0.3089s/iter; left time: 5709.6968s
	iters: 200, epoch: 6 | loss: 0.0977413
	speed: 0.0953s/iter; left time: 1752.7900s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.0649s/iter; left time: 1186.6980s
	iters: 400, epoch: 6 | loss: 0.1348470
	speed: 0.1037s/iter; left time: 1886.5249s
Epoch: 6 cost time: 39.713733434677124
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.974 Test Loss: 0.193 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000041
	speed: 0.3205s/iter; left time: 5792.6199s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1476s/iter; left time: 2651.9921s
	iters: 300, epoch: 7 | loss: 0.0000102
	speed: 0.1495s/iter; left time: 2672.6900s
	iters: 400, epoch: 7 | loss: 0.0002196
	speed: 0.1223s/iter; left time: 2172.8028s
Epoch: 7 cost time: 56.06631684303284
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.990 Test Loss: 0.092 Test Acc: 0.990
Validation loss decreased (-0.987266 --> -0.990449).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.3265s/iter; left time: 5766.6273s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.1395s/iter; left time: 2448.7758s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1254s/iter; left time: 2190.3294s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.0989s/iter; left time: 1716.7760s
Epoch: 8 cost time: 52.37216401100159
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.984 Test Loss: 0.126 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0418102
	speed: 0.3180s/iter; left time: 5483.7123s
	iters: 200, epoch: 9 | loss: 0.0029980
	speed: 0.0999s/iter; left time: 1712.1322s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 1276.7208s
	iters: 400, epoch: 9 | loss: 0.0000173
	speed: 0.0652s/iter; left time: 1104.3631s
Epoch: 9 cost time: 38.33635663986206
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.243 Vali Acc: 0.970 Test Loss: 0.243 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 4749.4616s
	iters: 200, epoch: 10 | loss: 0.0011867
	speed: 0.0861s/iter; left time: 1440.4709s
	iters: 300, epoch: 10 | loss: 0.0071901
	speed: 0.0857s/iter; left time: 1425.6760s
	iters: 400, epoch: 10 | loss: 0.0014998
	speed: 0.0996s/iter; left time: 1647.3763s
Epoch: 10 cost time: 38.882474184036255
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.532 Vali Acc: 0.959 Test Loss: 0.532 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0002759
	speed: 0.2249s/iter; left time: 3693.0993s
	iters: 200, epoch: 11 | loss: 0.0568798
	speed: 0.0972s/iter; left time: 1586.7480s
	iters: 300, epoch: 11 | loss: 0.0105368
	speed: 0.0893s/iter; left time: 1448.6371s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.1224s/iter; left time: 1972.7177s
Epoch: 11 cost time: 40.04736661911011
Epoch: 11, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.986 Test Loss: 0.115 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2786s/iter; left time: 4459.0842s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 1363.6412s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.1147s/iter; left time: 1812.9085s
	iters: 400, epoch: 12 | loss: 0.0000241
	speed: 0.1165s/iter; left time: 1829.2593s
Epoch: 12 cost time: 42.58208417892456
Epoch: 12, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.191 Vali Acc: 0.985 Test Loss: 0.191 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3341s/iter; left time: 5210.2056s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1208s/iter; left time: 1871.4068s
	iters: 300, epoch: 13 | loss: 0.0000014
	speed: 0.0726s/iter; left time: 1116.9515s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 1217.1199s
Epoch: 13 cost time: 41.86740517616272
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.319 Vali Acc: 0.978 Test Loss: 0.319 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.4023367
	speed: 0.2183s/iter; left time: 3314.0178s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0799s/iter; left time: 1205.3247s
	iters: 300, epoch: 14 | loss: 0.0000017
	speed: 0.0840s/iter; left time: 1258.7154s
	iters: 400, epoch: 14 | loss: 0.0216407
	speed: 0.0635s/iter; left time: 945.6443s
Epoch: 14 cost time: 31.683865308761597
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.985 Test Loss: 0.188 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1775s/iter; left time: 2621.2392s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0782s/iter; left time: 1146.6013s
	iters: 300, epoch: 15 | loss: 0.4156814
	speed: 0.0779s/iter; left time: 1134.7894s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0703s/iter; left time: 1016.6880s
Epoch: 15 cost time: 31.203397512435913
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.390 Vali Acc: 0.973 Test Loss: 0.390 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2686s/iter; left time: 3856.6583s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.1378s/iter; left time: 1964.1394s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1255s/iter; left time: 1776.0368s
	iters: 400, epoch: 16 | loss: 0.3416570
	speed: 0.1346s/iter; left time: 1891.2542s
Epoch: 16 cost time: 54.71489095687866
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.270 Vali Acc: 0.981 Test Loss: 0.270 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2881s/iter; left time: 4016.8906s
	iters: 200, epoch: 17 | loss: 0.0000056
	speed: 0.0880s/iter; left time: 1218.6244s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1114s/iter; left time: 1531.3011s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1206s/iter; left time: 1644.9541s
Epoch: 17 cost time: 43.97758102416992
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.418 Vali Acc: 0.975 Test Loss: 0.418 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 22706698
model size : 101.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6496629
	speed: 0.0766s/iter; left time: 1573.9428s
	iters: 200, epoch: 1 | loss: 0.2861260
	speed: 0.0466s/iter; left time: 952.3190s
	iters: 300, epoch: 1 | loss: 0.0976251
	speed: 0.0537s/iter; left time: 1092.8737s
	iters: 400, epoch: 1 | loss: 0.0160616
	speed: 0.0641s/iter; left time: 1297.6124s
Epoch: 1 cost time: 25.297459840774536
Epoch: 1, Steps: 413 | Train Loss: 0.535 Vali Loss: 0.116 Vali Acc: 0.961 Test Loss: 0.116 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0049794
	speed: 0.2141s/iter; left time: 4311.3247s
	iters: 200, epoch: 2 | loss: 0.0055736
	speed: 0.0598s/iter; left time: 1198.2303s
	iters: 300, epoch: 2 | loss: 0.0005853
	speed: 0.0546s/iter; left time: 1089.4848s
	iters: 400, epoch: 2 | loss: 0.0000649
	speed: 0.0572s/iter; left time: 1135.4316s
Epoch: 2 cost time: 22.86464548110962
Epoch: 2, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.961345 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0388035
	speed: 0.2164s/iter; left time: 4267.8522s
	iters: 200, epoch: 3 | loss: 0.0005429
	speed: 0.0510s/iter; left time: 1001.6448s
	iters: 300, epoch: 3 | loss: 0.1196876
	speed: 0.0612s/iter; left time: 1194.6386s
	iters: 400, epoch: 3 | loss: 0.2281390
	speed: 0.0443s/iter; left time: 860.1831s
Epoch: 3 cost time: 21.79510235786438
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.053 Vali Acc: 0.986 Test Loss: 0.053 Test Acc: 0.986
Validation loss decreased (-0.970440 --> -0.985902).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1706440
	speed: 0.2061s/iter; left time: 3980.0395s
	iters: 200, epoch: 4 | loss: 0.0013726
	speed: 0.0433s/iter; left time: 831.4061s
	iters: 300, epoch: 4 | loss: 0.0000359
	speed: 0.0404s/iter; left time: 773.0620s
	iters: 400, epoch: 4 | loss: 0.0000056
	speed: 0.0505s/iter; left time: 959.9056s
Epoch: 4 cost time: 19.988823413848877
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.216 Vali Acc: 0.974 Test Loss: 0.216 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0033075
	speed: 0.2202s/iter; left time: 4161.2734s
	iters: 200, epoch: 5 | loss: 0.0002802
	speed: 0.0662s/iter; left time: 1244.9247s
	iters: 300, epoch: 5 | loss: 0.3620857
	speed: 0.0584s/iter; left time: 1091.9184s
	iters: 400, epoch: 5 | loss: 0.0023265
	speed: 0.0609s/iter; left time: 1132.6368s
Epoch: 5 cost time: 26.669020414352417
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0348906
	speed: 0.1987s/iter; left time: 3673.1836s
	iters: 200, epoch: 6 | loss: 0.0001999
	speed: 0.0540s/iter; left time: 993.2135s
	iters: 300, epoch: 6 | loss: 0.0000056
	speed: 0.0404s/iter; left time: 737.9801s
	iters: 400, epoch: 6 | loss: 0.0007869
	speed: 0.0370s/iter; left time: 673.2744s
Epoch: 6 cost time: 18.901538372039795
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.189 Vali Acc: 0.966 Test Loss: 0.189 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0020482
	speed: 0.1339s/iter; left time: 2420.3214s
	iters: 200, epoch: 7 | loss: 0.0084623
	speed: 0.0286s/iter; left time: 513.7368s
	iters: 300, epoch: 7 | loss: 0.0000296
	speed: 0.0288s/iter; left time: 514.3820s
	iters: 400, epoch: 7 | loss: 0.0005969
	speed: 0.0289s/iter; left time: 513.7729s
Epoch: 7 cost time: 13.038456916809082
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000263
	speed: 0.1352s/iter; left time: 2387.6964s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0513s/iter; left time: 900.3819s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.0325s/iter; left time: 567.3625s
	iters: 400, epoch: 8 | loss: 0.3938844
	speed: 0.0469s/iter; left time: 814.1515s
Epoch: 8 cost time: 17.67574405670166
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0996915
	speed: 0.1395s/iter; left time: 2405.3335s
	iters: 200, epoch: 9 | loss: 0.0013811
	speed: 0.0397s/iter; left time: 681.5455s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0366s/iter; left time: 624.6744s
	iters: 400, epoch: 9 | loss: 0.0000225
	speed: 0.0378s/iter; left time: 640.5758s
Epoch: 9 cost time: 16.444266080856323
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0004091
	speed: 0.1338s/iter; left time: 2252.8417s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.0485s/iter; left time: 811.0129s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0432s/iter; left time: 717.8657s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0499s/iter; left time: 824.2703s
Epoch: 10 cost time: 19.231762647628784
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.986811).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4819244
	speed: 0.1442s/iter; left time: 2367.5732s
	iters: 200, epoch: 11 | loss: 0.0000070
	speed: 0.0268s/iter; left time: 437.1428s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.0275s/iter; left time: 446.4633s
	iters: 400, epoch: 11 | loss: 0.0894255
	speed: 0.0226s/iter; left time: 364.3366s
Epoch: 11 cost time: 11.3621666431427
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000019
	speed: 0.1296s/iter; left time: 2074.4604s
	iters: 200, epoch: 12 | loss: 0.0000079
	speed: 0.0567s/iter; left time: 901.9606s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0670s/iter; left time: 1058.9120s
	iters: 400, epoch: 12 | loss: 0.0000032
	speed: 0.0824s/iter; left time: 1293.7183s
Epoch: 12 cost time: 26.150464057922363
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000004
	speed: 0.2570s/iter; left time: 4007.6942s
	iters: 200, epoch: 13 | loss: 0.2397614
	speed: 0.0495s/iter; left time: 766.9276s
	iters: 300, epoch: 13 | loss: 0.0000084
	speed: 0.0421s/iter; left time: 648.0513s
	iters: 400, epoch: 13 | loss: 0.0000012
	speed: 0.0588s/iter; left time: 898.6483s
Epoch: 13 cost time: 24.683637142181396
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.442 Vali Acc: 0.964 Test Loss: 0.442 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2211s/iter; left time: 3356.0963s
	iters: 200, epoch: 14 | loss: 0.0000261
	speed: 0.0742s/iter; left time: 1118.6627s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0766s/iter; left time: 1147.9774s
	iters: 400, epoch: 14 | loss: 0.1606956
	speed: 0.0786s/iter; left time: 1169.9733s
Epoch: 14 cost time: 31.446691513061523
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.983 Test Loss: 0.172 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000024
	speed: 0.2084s/iter; left time: 3077.9639s
	iters: 200, epoch: 15 | loss: 0.0413045
	speed: 0.0681s/iter; left time: 999.3578s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 855.0481s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0576s/iter; left time: 834.0202s
Epoch: 15 cost time: 25.532063007354736
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.341 Vali Acc: 0.974 Test Loss: 0.341 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000073
	speed: 0.1613s/iter; left time: 2315.1980s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 597.3032s
	iters: 300, epoch: 16 | loss: 0.0000025
	speed: 0.0401s/iter; left time: 567.7170s
	iters: 400, epoch: 16 | loss: 0.0321120
	speed: 0.0511s/iter; left time: 718.3708s
Epoch: 16 cost time: 19.144105195999146
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.984 Test Loss: 0.129 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1702s/iter; left time: 2373.4482s
	iters: 200, epoch: 17 | loss: 0.0000032
	speed: 0.0408s/iter; left time: 564.2076s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 765.8508s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 702.1915s
Epoch: 17 cost time: 20.666991472244263
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.984 Test Loss: 0.193 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2103s/iter; left time: 2845.2284s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 886.4948s
	iters: 300, epoch: 18 | loss: 0.1128351
	speed: 0.0643s/iter; left time: 857.6737s
	iters: 400, epoch: 18 | loss: 0.0127503
	speed: 0.0605s/iter; left time: 801.0340s
Epoch: 18 cost time: 27.4479341506958
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.990 Test Loss: 0.097 Test Acc: 0.990
Validation loss decreased (-0.986811 --> -0.990449).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.2288s/iter; left time: 3001.2429s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0630s/iter; left time: 820.4695s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 530.6403s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0660s/iter; left time: 845.4491s
Epoch: 19 cost time: 25.090961933135986
Epoch: 19, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.986 Test Loss: 0.120 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2155s/iter; left time: 2737.0914s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0808s/iter; left time: 1018.0073s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0450s/iter; left time: 562.2951s
	iters: 400, epoch: 20 | loss: 0.0003228
	speed: 0.0692s/iter; left time: 858.7817s
Epoch: 20 cost time: 28.487571001052856
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.051 Vali Acc: 0.994 Test Loss: 0.051 Test Acc: 0.994
Validation loss decreased (-0.990449 --> -0.993633).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000002
	speed: 0.2283s/iter; left time: 2805.4607s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0779s/iter; left time: 949.1816s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 854.8168s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.0579s/iter; left time: 694.3734s
Epoch: 21 cost time: 29.11219573020935
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.988 Test Loss: 0.131 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.2031s/iter; left time: 2411.8610s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0593s/iter; left time: 698.0073s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0675s/iter; left time: 787.8166s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 670.8021s
Epoch: 22 cost time: 26.112439393997192
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.991 Test Loss: 0.074 Test Acc: 0.991
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1856s/iter; left time: 2127.3516s
	iters: 200, epoch: 23 | loss: 1.0901059
	speed: 0.0479s/iter; left time: 543.8760s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0485s/iter; left time: 545.8479s
	iters: 400, epoch: 23 | loss: 0.0000132
	speed: 0.0459s/iter; left time: 512.3309s
Epoch: 23 cost time: 20.158387660980225
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.986 Test Loss: 0.135 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1966s/iter; left time: 2172.3106s
	iters: 200, epoch: 24 | loss: 0.4748802
	speed: 0.0518s/iter; left time: 566.8232s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0566s/iter; left time: 613.7553s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 693.6465s
Epoch: 24 cost time: 25.172390699386597
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.986 Test Loss: 0.140 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2414s/iter; left time: 2568.0971s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0472s/iter; left time: 497.0585s
	iters: 300, epoch: 25 | loss: 0.0000116
	speed: 0.0396s/iter; left time: 413.6739s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0404s/iter; left time: 418.1930s
Epoch: 25 cost time: 20.96623969078064
Epoch: 25, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.066 Vali Acc: 0.992 Test Loss: 0.066 Test Acc: 0.992
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.1447s/iter; left time: 1479.9561s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0356s/iter; left time: 360.8792s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0422s/iter; left time: 422.6957s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.0467s/iter; left time: 463.4674s
Epoch: 26 cost time: 16.647579193115234
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.985 Test Loss: 0.193 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2153s/iter; left time: 2113.0232s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.0707s/iter; left time: 686.3667s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0729s/iter; left time: 700.9414s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0701s/iter; left time: 667.2420s
Epoch: 27 cost time: 28.410086154937744
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.991 Test Loss: 0.109 Test Acc: 0.991
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.1729s/iter; left time: 1625.6029s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 404.0799s
	iters: 300, epoch: 28 | loss: 0.6028008
	speed: 0.0427s/iter; left time: 393.2729s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0573s/iter; left time: 521.7125s
Epoch: 28 cost time: 19.98633575439453
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.988 Test Loss: 0.097 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.1591s/iter; left time: 1430.1750s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0440s/iter; left time: 390.6466s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 396.2720s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0626s/iter; left time: 543.7274s
Epoch: 29 cost time: 20.53046154975891
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.986 Test Loss: 0.175 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2219s/iter; left time: 1902.5467s
	iters: 200, epoch: 30 | loss: 0.0000004
	speed: 0.0790s/iter; left time: 669.5758s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0832s/iter; left time: 696.7316s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0770s/iter; left time: 637.3997s
Epoch: 30 cost time: 33.288655281066895
Epoch: 30, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.203 Vali Acc: 0.987 Test Loss: 0.203 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9936334697589814
model parameter : 22577674
model size : 100.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9500672
	speed: 0.0750s/iter; left time: 1540.9641s
	iters: 200, epoch: 1 | loss: 0.0995987
	speed: 0.0463s/iter; left time: 947.1508s
	iters: 300, epoch: 1 | loss: 0.1650652
	speed: 0.0440s/iter; left time: 895.4765s
	iters: 400, epoch: 1 | loss: 0.0376487
	speed: 0.0388s/iter; left time: 786.5391s
Epoch: 1 cost time: 21.03088402748108
Epoch: 1, Steps: 413 | Train Loss: 0.584 Vali Loss: 0.078 Vali Acc: 0.972 Test Loss: 0.078 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3448455
	speed: 0.1638s/iter; left time: 3299.5704s
	iters: 200, epoch: 2 | loss: 0.0094384
	speed: 0.0347s/iter; left time: 694.5967s
	iters: 300, epoch: 2 | loss: 0.0088230
	speed: 0.0343s/iter; left time: 684.4229s
	iters: 400, epoch: 2 | loss: 0.0001500
	speed: 0.0367s/iter; left time: 727.9700s
Epoch: 2 cost time: 17.195608615875244
Epoch: 2, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.060 Vali Acc: 0.978 Test Loss: 0.060 Test Acc: 0.978
Validation loss decreased (-0.972259 --> -0.977717).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034582
	speed: 0.1602s/iter; left time: 3160.1978s
	iters: 200, epoch: 3 | loss: 0.0041599
	speed: 0.0462s/iter; left time: 907.5504s
	iters: 300, epoch: 3 | loss: 0.0022820
	speed: 0.0372s/iter; left time: 727.1854s
	iters: 400, epoch: 3 | loss: 0.0021188
	speed: 0.0408s/iter; left time: 791.9564s
Epoch: 3 cost time: 17.6744863986969
Epoch: 3, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
Validation loss decreased (-0.977717 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0011020
	speed: 0.1851s/iter; left time: 3574.0986s
	iters: 200, epoch: 4 | loss: 0.0211022
	speed: 0.0380s/iter; left time: 730.3809s
	iters: 300, epoch: 4 | loss: 0.0856360
	speed: 0.0403s/iter; left time: 769.5984s
	iters: 400, epoch: 4 | loss: 0.0000521
	speed: 0.0360s/iter; left time: 684.8680s
Epoch: 4 cost time: 16.74185538291931
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0055368
	speed: 0.1747s/iter; left time: 3301.9705s
	iters: 200, epoch: 5 | loss: 0.0000117
	speed: 0.0428s/iter; left time: 804.5356s
	iters: 300, epoch: 5 | loss: 0.1803011
	speed: 0.0363s/iter; left time: 678.7180s
	iters: 400, epoch: 5 | loss: 0.0021750
	speed: 0.0392s/iter; left time: 729.0371s
Epoch: 5 cost time: 16.922723531723022
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0029906
	speed: 0.1323s/iter; left time: 2446.5319s
	iters: 200, epoch: 6 | loss: 0.2609841
	speed: 0.0304s/iter; left time: 558.1155s
	iters: 300, epoch: 6 | loss: 0.0108013
	speed: 0.0363s/iter; left time: 663.4631s
	iters: 400, epoch: 6 | loss: 0.0000003
	speed: 0.0332s/iter; left time: 603.3713s
Epoch: 6 cost time: 14.272852897644043
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0003414
	speed: 0.1487s/iter; left time: 2686.9837s
	iters: 200, epoch: 7 | loss: 0.0001368
	speed: 0.0665s/iter; left time: 1194.5419s
	iters: 300, epoch: 7 | loss: 0.0721629
	speed: 0.0651s/iter; left time: 1164.0557s
	iters: 400, epoch: 7 | loss: 0.0003372
	speed: 0.0728s/iter; left time: 1294.1232s
Epoch: 7 cost time: 25.596452713012695
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000747
	speed: 0.1947s/iter; left time: 3437.7730s
	iters: 200, epoch: 8 | loss: 0.7908075
	speed: 0.0705s/iter; left time: 1238.2195s
	iters: 300, epoch: 8 | loss: 0.0000091
	speed: 0.0677s/iter; left time: 1181.9191s
	iters: 400, epoch: 8 | loss: 0.2510403
	speed: 0.0694s/iter; left time: 1205.4371s
Epoch: 8 cost time: 28.156493663787842
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0004618
	speed: 0.1968s/iter; left time: 3394.7513s
	iters: 200, epoch: 9 | loss: 0.0020695
	speed: 0.0563s/iter; left time: 965.9440s
	iters: 300, epoch: 9 | loss: 0.0107770
	speed: 0.0679s/iter; left time: 1157.3394s
	iters: 400, epoch: 9 | loss: 0.0386886
	speed: 0.0630s/iter; left time: 1067.0753s
Epoch: 9 cost time: 27.000877141952515
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000076
	speed: 0.1830s/iter; left time: 3080.4274s
	iters: 200, epoch: 10 | loss: 0.0000050
	speed: 0.0566s/iter; left time: 946.6970s
	iters: 300, epoch: 10 | loss: 0.0000173
	speed: 0.0493s/iter; left time: 820.1048s
	iters: 400, epoch: 10 | loss: 0.0000093
	speed: 0.0575s/iter; left time: 950.6153s
Epoch: 10 cost time: 22.62912368774414
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000262
	speed: 0.1632s/iter; left time: 2680.5742s
	iters: 200, epoch: 11 | loss: 0.0000029
	speed: 0.0509s/iter; left time: 829.9724s
	iters: 300, epoch: 11 | loss: 0.0000607
	speed: 0.0508s/iter; left time: 824.5349s
	iters: 400, epoch: 11 | loss: 0.0000014
	speed: 0.0321s/iter; left time: 518.1137s
Epoch: 11 cost time: 18.9544460773468
Epoch: 11, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1381s/iter; left time: 2210.8921s
	iters: 200, epoch: 12 | loss: 0.0000041
	speed: 0.0399s/iter; left time: 634.5611s
	iters: 300, epoch: 12 | loss: 0.0000031
	speed: 0.0322s/iter; left time: 509.3781s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0314s/iter; left time: 493.0447s
Epoch: 12 cost time: 14.58774471282959
Epoch: 12, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
Validation loss decreased (-0.979081 --> -0.984083).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0016424
	speed: 0.1745s/iter; left time: 2722.0384s
	iters: 200, epoch: 13 | loss: 0.0000327
	speed: 0.0364s/iter; left time: 563.9503s
	iters: 300, epoch: 13 | loss: 0.0001551
	speed: 0.0357s/iter; left time: 549.8572s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 514.9935s
Epoch: 13 cost time: 15.205254316329956
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0856906
	speed: 0.1279s/iter; left time: 1941.5512s
	iters: 200, epoch: 14 | loss: 0.0002780
	speed: 0.0408s/iter; left time: 614.8925s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 504.7215s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0370s/iter; left time: 550.6890s
Epoch: 14 cost time: 16.43719482421875
Epoch: 14, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000173
	speed: 0.1679s/iter; left time: 2479.6877s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 738.0313s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0474s/iter; left time: 690.4161s
	iters: 400, epoch: 15 | loss: 0.0000025
	speed: 0.0489s/iter; left time: 707.6107s
Epoch: 15 cost time: 20.76505470275879
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.971 Test Loss: 0.193 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000024
	speed: 0.1809s/iter; left time: 2597.3014s
	iters: 200, epoch: 16 | loss: 0.0043921
	speed: 0.0491s/iter; left time: 699.9977s
	iters: 300, epoch: 16 | loss: 0.0000273
	speed: 0.0444s/iter; left time: 628.9290s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0508s/iter; left time: 713.7053s
Epoch: 16 cost time: 20.51891779899597
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.282 Vali Acc: 0.969 Test Loss: 0.282 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000036
	speed: 0.1745s/iter; left time: 2432.3806s
	iters: 200, epoch: 17 | loss: 0.0000014
	speed: 0.0376s/iter; left time: 520.4618s
	iters: 300, epoch: 17 | loss: 0.0000191
	speed: 0.0343s/iter; left time: 471.7313s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0329s/iter; left time: 448.7739s
Epoch: 17 cost time: 16.49836015701294
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.978 Test Loss: 0.201 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1592s/iter; left time: 2154.2490s
	iters: 200, epoch: 18 | loss: 0.0000096
	speed: 0.0373s/iter; left time: 500.3356s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0264s/iter; left time: 352.4482s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0241s/iter; left time: 318.3624s
Epoch: 18 cost time: 13.617762565612793
Epoch: 18, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1340s/iter; left time: 1757.2856s
	iters: 200, epoch: 19 | loss: 0.0006092
	speed: 0.0332s/iter; left time: 432.0888s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0336s/iter; left time: 434.3527s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 542.5175s
Epoch: 19 cost time: 16.42262029647827
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1653s/iter; left time: 2100.4751s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0384s/iter; left time: 483.8052s
	iters: 300, epoch: 20 | loss: 0.0057764
	speed: 0.0385s/iter; left time: 481.6275s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0355s/iter; left time: 440.0628s
Epoch: 20 cost time: 17.190864086151123
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.350 Vali Acc: 0.977 Test Loss: 0.350 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1379s/iter; left time: 1695.4561s
	iters: 200, epoch: 21 | loss: 0.0000010
	speed: 0.0296s/iter; left time: 360.2588s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 347.3065s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0354s/iter; left time: 424.8147s
Epoch: 21 cost time: 13.692588806152344
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.982 Test Loss: 0.244 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1849s/iter; left time: 2196.7044s
	iters: 200, epoch: 22 | loss: 0.0000229
	speed: 0.0484s/iter; left time: 569.8648s
	iters: 300, epoch: 22 | loss: 0.0004206
	speed: 0.0350s/iter; left time: 409.0456s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.0398s/iter; left time: 461.3502s
Epoch: 22 cost time: 19.187281847000122
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.979 Test Loss: 0.241 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 22522378
model size : 100.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5381085
	speed: 0.0770s/iter; left time: 1583.0941s
	iters: 200, epoch: 1 | loss: 0.1136631
	speed: 0.0903s/iter; left time: 1845.8113s
	iters: 300, epoch: 1 | loss: 0.0125673
	speed: 0.1052s/iter; left time: 2140.4117s
	iters: 400, epoch: 1 | loss: 0.0018939
	speed: 0.0899s/iter; left time: 1821.4227s
Epoch: 1 cost time: 37.53523302078247
Epoch: 1, Steps: 413 | Train Loss: 0.496 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1508051
	speed: 0.2353s/iter; left time: 4738.2359s
	iters: 200, epoch: 2 | loss: 0.0503246
	speed: 0.0713s/iter; left time: 1429.4644s
	iters: 300, epoch: 2 | loss: 0.0055061
	speed: 0.0708s/iter; left time: 1411.4896s
	iters: 400, epoch: 2 | loss: 0.0001114
	speed: 0.0670s/iter; left time: 1328.4099s
Epoch: 2 cost time: 30.069955348968506
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0665194
	speed: 0.1816s/iter; left time: 3583.0105s
	iters: 200, epoch: 3 | loss: 0.0000805
	speed: 0.0666s/iter; left time: 1307.0469s
	iters: 300, epoch: 3 | loss: 0.0005346
	speed: 0.0480s/iter; left time: 937.8239s
	iters: 400, epoch: 3 | loss: 0.2883409
	speed: 0.0470s/iter; left time: 912.6693s
Epoch: 3 cost time: 23.21264934539795
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.975443 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003724
	speed: 0.1811s/iter; left time: 3497.9020s
	iters: 200, epoch: 4 | loss: 0.0000156
	speed: 0.0557s/iter; left time: 1070.0534s
	iters: 300, epoch: 4 | loss: 0.0075662
	speed: 0.0555s/iter; left time: 1061.6138s
	iters: 400, epoch: 4 | loss: 0.0000047
	speed: 0.0877s/iter; left time: 1667.1554s
Epoch: 4 cost time: 28.715232372283936
Epoch: 4, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0312961
	speed: 0.3318s/iter; left time: 6270.9857s
	iters: 200, epoch: 5 | loss: 0.0000192
	speed: 0.0952s/iter; left time: 1788.9397s
	iters: 300, epoch: 5 | loss: 0.0000016
	speed: 0.0902s/iter; left time: 1686.9579s
	iters: 400, epoch: 5 | loss: 0.0000178
	speed: 0.0993s/iter; left time: 1846.4147s
Epoch: 5 cost time: 44.217252254486084
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.175 Vali Acc: 0.976 Test Loss: 0.175 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.3072s/iter; left time: 5679.1055s
	iters: 200, epoch: 6 | loss: 0.0000114
	speed: 0.1300s/iter; left time: 2390.4502s
	iters: 300, epoch: 6 | loss: 0.2692176
	speed: 0.0895s/iter; left time: 1637.3802s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.1009s/iter; left time: 1834.5710s
Epoch: 6 cost time: 47.1458580493927
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.985 Test Loss: 0.153 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.984537).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3020s/iter; left time: 5457.5861s
	iters: 200, epoch: 7 | loss: 0.0000029
	speed: 0.0881s/iter; left time: 1584.0716s
	iters: 300, epoch: 7 | loss: 0.0668405
	speed: 0.0708s/iter; left time: 1265.5506s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.0857s/iter; left time: 1523.4818s
Epoch: 7 cost time: 35.32499384880066
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000030
	speed: 0.2458s/iter; left time: 4340.1196s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.0886s/iter; left time: 1555.9635s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.1108s/iter; left time: 1934.6601s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.1034s/iter; left time: 1794.9317s
Epoch: 8 cost time: 43.28822565078735
Epoch: 8, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.979 Test Loss: 0.163 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2848s/iter; left time: 4911.4031s
	iters: 200, epoch: 9 | loss: 0.0196851
	speed: 0.1187s/iter; left time: 2035.2826s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.1203s/iter; left time: 2050.0949s
	iters: 400, epoch: 9 | loss: 0.0000043
	speed: 0.1313s/iter; left time: 2225.4168s
Epoch: 9 cost time: 48.285454511642456
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.183 Vali Acc: 0.983 Test Loss: 0.183 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3133s/iter; left time: 5273.3119s
	iters: 200, epoch: 10 | loss: 0.0147387
	speed: 0.1178s/iter; left time: 1971.4769s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.1188s/iter; left time: 1976.4134s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.1198s/iter; left time: 1980.4481s
Epoch: 10 cost time: 48.25425934791565
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.974 Test Loss: 0.210 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2484s/iter; left time: 4078.7674s
	iters: 200, epoch: 11 | loss: 0.3271843
	speed: 0.0544s/iter; left time: 888.3258s
	iters: 300, epoch: 11 | loss: 0.0000900
	speed: 0.0696s/iter; left time: 1129.2473s
	iters: 400, epoch: 11 | loss: 0.0000045
	speed: 0.0757s/iter; left time: 1221.1344s
Epoch: 11 cost time: 30.1877920627594
Epoch: 11, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.984 Test Loss: 0.118 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2135s/iter; left time: 3418.2837s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0638s/iter; left time: 1014.9557s
	iters: 300, epoch: 12 | loss: 0.0222143
	speed: 0.0593s/iter; left time: 937.4937s
	iters: 400, epoch: 12 | loss: 0.1618311
	speed: 0.0646s/iter; left time: 1015.4811s
Epoch: 12 cost time: 27.08456015586853
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.245 Vali Acc: 0.976 Test Loss: 0.245 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0001334
	speed: 0.2080s/iter; left time: 3243.7561s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0486s/iter; left time: 752.7097s
	iters: 300, epoch: 13 | loss: 0.0000014
	speed: 0.0624s/iter; left time: 961.2851s
	iters: 400, epoch: 13 | loss: 0.0000037
	speed: 0.0733s/iter; left time: 1121.7541s
Epoch: 13 cost time: 26.01713514328003
Epoch: 13, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.981 Test Loss: 0.201 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1874s/iter; left time: 2845.2959s
	iters: 200, epoch: 14 | loss: 0.0000062
	speed: 0.0791s/iter; left time: 1193.6886s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0820s/iter; left time: 1228.9251s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 1116.1131s
Epoch: 14 cost time: 31.892960786819458
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.987 Test Loss: 0.132 Test Acc: 0.987
Validation loss decreased (-0.984537 --> -0.987266).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2709589
	speed: 0.2519s/iter; left time: 3720.8297s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1167s/iter; left time: 1711.7527s
	iters: 300, epoch: 15 | loss: 2.1421332
	speed: 0.1059s/iter; left time: 1543.0861s
	iters: 400, epoch: 15 | loss: 0.2101914
	speed: 0.0622s/iter; left time: 900.2446s
Epoch: 15 cost time: 40.617871046066284
Epoch: 15, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.089 Vali Acc: 0.989 Test Loss: 0.089 Test Acc: 0.989
Validation loss decreased (-0.987266 --> -0.989085).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.2545s/iter; left time: 3654.2575s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0776s/iter; left time: 1106.5400s
	iters: 300, epoch: 16 | loss: 0.0000213
	speed: 0.0810s/iter; left time: 1146.0000s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0990s/iter; left time: 1391.5607s
Epoch: 16 cost time: 35.565953493118286
Epoch: 16, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.985 Test Loss: 0.240 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2121s/iter; left time: 2957.3082s
	iters: 200, epoch: 17 | loss: 0.0000078
	speed: 0.0534s/iter; left time: 739.2424s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0440s/iter; left time: 604.1651s
	iters: 400, epoch: 17 | loss: 0.0000008
	speed: 0.0495s/iter; left time: 675.9177s
Epoch: 17 cost time: 21.612764835357666
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.991 Test Loss: 0.101 Test Acc: 0.991
Validation loss decreased (-0.989085 --> -0.990904).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.1352270
	speed: 0.3085s/iter; left time: 4174.5874s
	iters: 200, epoch: 18 | loss: 0.0805444
	speed: 0.1155s/iter; left time: 1551.2919s
	iters: 300, epoch: 18 | loss: 1.9424964
	speed: 0.1113s/iter; left time: 1483.5783s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.1237s/iter; left time: 1637.1740s
Epoch: 18 cost time: 49.81179213523865
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.230 Vali Acc: 0.979 Test Loss: 0.230 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1339571
	speed: 0.2893s/iter; left time: 3794.4209s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0971s/iter; left time: 1263.5428s
	iters: 300, epoch: 19 | loss: 0.0004149
	speed: 0.0941s/iter; left time: 1215.1660s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 1250.6439s
Epoch: 19 cost time: 40.98505926132202
Epoch: 19, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.231 Vali Acc: 0.980 Test Loss: 0.231 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2545s/iter; left time: 3233.2998s
	iters: 200, epoch: 20 | loss: 0.0001114
	speed: 0.0731s/iter; left time: 921.2660s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 951.0048s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 821.4152s
Epoch: 20 cost time: 30.593801975250244
Epoch: 20, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.990 Test Loss: 0.128 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1943s/iter; left time: 2388.4992s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0804s/iter; left time: 980.1727s
	iters: 300, epoch: 21 | loss: 0.0004303
	speed: 0.0867s/iter; left time: 1048.1518s
	iters: 400, epoch: 21 | loss: 0.0199885
	speed: 0.0693s/iter; left time: 830.3847s
Epoch: 21 cost time: 32.26935815811157
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.262 Vali Acc: 0.984 Test Loss: 0.262 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1887s/iter; left time: 2241.6182s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0567s/iter; left time: 667.4513s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 691.2328s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1191s/iter; left time: 1378.4526s
Epoch: 22 cost time: 31.941871643066406
Epoch: 22, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.990 Test Loss: 0.130 Test Acc: 0.990
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2518s/iter; left time: 2886.7649s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1335s/iter; left time: 1517.6688s
	iters: 300, epoch: 23 | loss: 0.0000036
	speed: 0.1361s/iter; left time: 1532.8950s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1321s/iter; left time: 1474.7315s
Epoch: 23 cost time: 52.70913314819336
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.988 Test Loss: 0.182 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2574s/iter; left time: 2844.9816s
	iters: 200, epoch: 24 | loss: 0.0118842
	speed: 0.0948s/iter; left time: 1037.7709s
	iters: 300, epoch: 24 | loss: 0.0000004
	speed: 0.0988s/iter; left time: 1072.3468s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1092s/iter; left time: 1174.1228s
Epoch: 24 cost time: 40.35973119735718
Epoch: 24, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.425 Vali Acc: 0.979 Test Loss: 0.425 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2065s/iter; left time: 2196.4741s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0901s/iter; left time: 949.8255s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 1020.6566s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 898.5079s
Epoch: 25 cost time: 36.05299234390259
Epoch: 25, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.991 Test Loss: 0.153 Test Acc: 0.991
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2699s/iter; left time: 2759.8693s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 835.6074s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 1031.1255s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1333s/iter; left time: 1322.7130s
Epoch: 26 cost time: 45.53800964355469
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.407 Vali Acc: 0.978 Test Loss: 0.407 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3368s/iter; left time: 3304.8136s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.1165s/iter; left time: 1131.7532s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0923s/iter; left time: 887.6547s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 619.5760s
Epoch: 27 cost time: 42.25102472305298
Epoch: 27, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.473 Vali Acc: 0.980 Test Loss: 0.473 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 22736650
model size : 101.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6402888
	speed: 0.0460s/iter; left time: 945.5004s
	iters: 200, epoch: 1 | loss: 0.4227493
	speed: 0.0204s/iter; left time: 416.4477s
	iters: 300, epoch: 1 | loss: 0.0930393
	speed: 0.0454s/iter; left time: 923.1993s
	iters: 400, epoch: 1 | loss: 0.0827022
	speed: 0.0528s/iter; left time: 1070.2157s
Epoch: 1 cost time: 17.172279596328735
Epoch: 1, Steps: 413 | Train Loss: 0.529 Vali Loss: 0.116 Vali Acc: 0.956 Test Loss: 0.116 Test Acc: 0.956
Validation loss decreased (inf --> -0.956343).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0971709
	speed: 0.1626s/iter; left time: 3275.2514s
	iters: 200, epoch: 2 | loss: 0.0499966
	speed: 0.0331s/iter; left time: 662.7707s
	iters: 300, epoch: 2 | loss: 0.0048047
	speed: 0.0307s/iter; left time: 612.9826s
	iters: 400, epoch: 2 | loss: 0.0191022
	speed: 0.0435s/iter; left time: 862.5006s
Epoch: 2 cost time: 16.019661903381348
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.050 Vali Acc: 0.985 Test Loss: 0.050 Test Acc: 0.985
Validation loss decreased (-0.956343 --> -0.984538).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0187881
	speed: 0.2055s/iter; left time: 4052.6547s
	iters: 200, epoch: 3 | loss: 0.0039780
	speed: 0.0387s/iter; left time: 758.9605s
	iters: 300, epoch: 3 | loss: 0.0000063
	speed: 0.0356s/iter; left time: 696.0073s
	iters: 400, epoch: 3 | loss: 0.0013405
	speed: 0.0345s/iter; left time: 671.0227s
Epoch: 3 cost time: 16.182547569274902
Epoch: 3, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0019910
	speed: 0.2051s/iter; left time: 3961.0098s
	iters: 200, epoch: 4 | loss: 0.0003641
	speed: 0.0256s/iter; left time: 491.8298s
	iters: 300, epoch: 4 | loss: 0.0022069
	speed: 0.0284s/iter; left time: 542.7837s
	iters: 400, epoch: 4 | loss: 0.0000006
	speed: 0.0307s/iter; left time: 583.8513s
Epoch: 4 cost time: 14.07796049118042
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0002909
	speed: 0.2395s/iter; left time: 4527.0998s
	iters: 200, epoch: 5 | loss: 0.0001278
	speed: 0.0736s/iter; left time: 1384.4119s
	iters: 300, epoch: 5 | loss: 0.0000332
	speed: 0.0832s/iter; left time: 1556.4824s
	iters: 400, epoch: 5 | loss: 0.1283214
	speed: 0.0841s/iter; left time: 1564.0488s
Epoch: 5 cost time: 33.15156555175781
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000045
	speed: 0.2973s/iter; left time: 5496.3501s
	iters: 200, epoch: 6 | loss: 0.0113682
	speed: 0.0908s/iter; left time: 1669.3420s
	iters: 300, epoch: 6 | loss: 0.0000004
	speed: 0.0982s/iter; left time: 1795.7583s
	iters: 400, epoch: 6 | loss: 0.2385667
	speed: 0.0985s/iter; left time: 1791.8087s
Epoch: 6 cost time: 39.327608585357666
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0000057
	speed: 0.2592s/iter; left time: 4684.7384s
	iters: 200, epoch: 7 | loss: 0.0000106
	speed: 0.0679s/iter; left time: 1219.9371s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.0903s/iter; left time: 1614.4322s
	iters: 400, epoch: 7 | loss: 0.3604947
	speed: 0.0687s/iter; left time: 1220.2990s
Epoch: 7 cost time: 30.55315113067627
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.983 Test Loss: 0.142 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000002
	speed: 0.2617s/iter; left time: 4620.9955s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 1317.8575s
	iters: 300, epoch: 8 | loss: 0.0001316
	speed: 0.0787s/iter; left time: 1373.9276s
	iters: 400, epoch: 8 | loss: 0.0000643
	speed: 0.0765s/iter; left time: 1328.6246s
Epoch: 8 cost time: 31.838802337646484
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0009098
	speed: 0.2480s/iter; left time: 4277.1509s
	iters: 200, epoch: 9 | loss: 0.0088382
	speed: 0.0692s/iter; left time: 1186.0537s
	iters: 300, epoch: 9 | loss: 0.0000015
	speed: 0.0753s/iter; left time: 1283.6475s
	iters: 400, epoch: 9 | loss: 0.0005550
	speed: 0.0698s/iter; left time: 1183.1065s
Epoch: 9 cost time: 29.158019542694092
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000207
	speed: 0.2597s/iter; left time: 4371.3244s
	iters: 200, epoch: 10 | loss: 0.0000060
	speed: 0.0787s/iter; left time: 1316.5558s
	iters: 300, epoch: 10 | loss: 0.0000033
	speed: 0.0878s/iter; left time: 1461.0866s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0817s/iter; left time: 1350.3484s
Epoch: 10 cost time: 33.520155906677246
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.2763s/iter; left time: 4537.8059s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.0993s/iter; left time: 1620.4231s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.1059s/iter; left time: 1717.0041s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0759s/iter; left time: 1223.4351s
Epoch: 11 cost time: 38.588191509246826
Epoch: 11, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.980 Test Loss: 0.219 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000019
	speed: 0.2884s/iter; left time: 4616.0576s
	iters: 200, epoch: 12 | loss: 0.3730893
	speed: 0.0891s/iter; left time: 1417.5541s
	iters: 300, epoch: 12 | loss: 0.0000019
	speed: 0.0953s/iter; left time: 1506.2415s
	iters: 400, epoch: 12 | loss: 0.0000052
	speed: 0.0858s/iter; left time: 1348.3747s
Epoch: 12 cost time: 37.91550302505493
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.977 Test Loss: 0.223 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 22607626
model size : 100.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7789747
	speed: 0.0995s/iter; left time: 2045.3237s
	iters: 200, epoch: 1 | loss: 0.0877142
	speed: 0.0742s/iter; left time: 1517.4175s
	iters: 300, epoch: 1 | loss: 0.0519725
	speed: 0.0564s/iter; left time: 1147.1659s
	iters: 400, epoch: 1 | loss: 0.7873979
	speed: 0.0487s/iter; left time: 986.2689s
Epoch: 1 cost time: 28.67328429222107
Epoch: 1, Steps: 413 | Train Loss: 0.580 Vali Loss: 0.120 Vali Acc: 0.952 Test Loss: 0.120 Test Acc: 0.952
Validation loss decreased (inf --> -0.952250).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0733963
	speed: 0.1874s/iter; left time: 3773.9481s
	iters: 200, epoch: 2 | loss: 0.0923562
	speed: 0.0599s/iter; left time: 1199.8325s
	iters: 300, epoch: 2 | loss: 0.1902342
	speed: 0.0676s/iter; left time: 1346.9985s
	iters: 400, epoch: 2 | loss: 0.0202888
	speed: 0.0485s/iter; left time: 962.1351s
Epoch: 2 cost time: 24.059898853302002
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.952250 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005189
	speed: 0.2450s/iter; left time: 4832.4574s
	iters: 200, epoch: 3 | loss: 0.0198877
	speed: 0.0682s/iter; left time: 1338.5357s
	iters: 300, epoch: 3 | loss: 0.0007487
	speed: 0.0579s/iter; left time: 1130.1406s
	iters: 400, epoch: 3 | loss: 0.0172628
	speed: 0.0456s/iter; left time: 885.0499s
Epoch: 3 cost time: 23.97040891647339
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0030176
	speed: 0.2341s/iter; left time: 4521.6203s
	iters: 200, epoch: 4 | loss: 0.0006484
	speed: 0.0450s/iter; left time: 864.2468s
	iters: 300, epoch: 4 | loss: 0.0017133
	speed: 0.0517s/iter; left time: 987.2582s
	iters: 400, epoch: 4 | loss: 0.0002787
	speed: 0.0675s/iter; left time: 1282.7537s
Epoch: 4 cost time: 21.785966396331787
Epoch: 4, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0063346
	speed: 0.1913s/iter; left time: 3615.0544s
	iters: 200, epoch: 5 | loss: 0.1483804
	speed: 0.0531s/iter; left time: 998.8799s
	iters: 300, epoch: 5 | loss: 0.0002642
	speed: 0.0487s/iter; left time: 910.9624s
	iters: 400, epoch: 5 | loss: 0.0139710
	speed: 0.0446s/iter; left time: 828.8787s
Epoch: 5 cost time: 21.66956353187561
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0259825
	speed: 0.1396s/iter; left time: 2581.4812s
	iters: 200, epoch: 6 | loss: 0.1843816
	speed: 0.0613s/iter; left time: 1126.5073s
	iters: 300, epoch: 6 | loss: 0.0001376
	speed: 0.0687s/iter; left time: 1257.1496s
	iters: 400, epoch: 6 | loss: 0.0018031
	speed: 0.0704s/iter; left time: 1279.4283s
Epoch: 6 cost time: 25.646514892578125
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.976352 --> -0.980900).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000012
	speed: 0.2618s/iter; left time: 4731.1378s
	iters: 200, epoch: 7 | loss: 0.0000042
	speed: 0.0733s/iter; left time: 1318.0282s
	iters: 300, epoch: 7 | loss: 0.0030548
	speed: 0.0828s/iter; left time: 1479.7638s
	iters: 400, epoch: 7 | loss: 0.0236444
	speed: 0.0734s/iter; left time: 1304.4977s
Epoch: 7 cost time: 33.25577902793884
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0079845
	speed: 0.2119s/iter; left time: 3741.3869s
	iters: 200, epoch: 8 | loss: 0.0001139
	speed: 0.0739s/iter; left time: 1298.0832s
	iters: 300, epoch: 8 | loss: 0.0000044
	speed: 0.0740s/iter; left time: 1291.3838s
	iters: 400, epoch: 8 | loss: 0.0000011
	speed: 0.0690s/iter; left time: 1197.8881s
Epoch: 8 cost time: 30.603883266448975
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000020
	speed: 0.2177s/iter; left time: 3755.5100s
	iters: 200, epoch: 9 | loss: 0.0021802
	speed: 0.0520s/iter; left time: 892.1877s
	iters: 300, epoch: 9 | loss: 0.0061048
	speed: 0.0436s/iter; left time: 743.7964s
	iters: 400, epoch: 9 | loss: 0.0000015
	speed: 0.0494s/iter; left time: 836.4851s
Epoch: 9 cost time: 22.81055784225464
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0030788
	speed: 0.2014s/iter; left time: 3390.1293s
	iters: 200, epoch: 10 | loss: 0.0000004
	speed: 0.0755s/iter; left time: 1263.5290s
	iters: 300, epoch: 10 | loss: 0.0009286
	speed: 0.0664s/iter; left time: 1105.0141s
	iters: 400, epoch: 10 | loss: 0.0001955
	speed: 0.0633s/iter; left time: 1046.6806s
Epoch: 10 cost time: 28.786874532699585
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2121s/iter; left time: 3483.1601s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.0634s/iter; left time: 1035.3857s
	iters: 300, epoch: 11 | loss: 0.0395879
	speed: 0.0570s/iter; left time: 925.1813s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0583s/iter; left time: 940.6279s
Epoch: 11 cost time: 25.85585904121399
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.965 Test Loss: 0.205 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000001
	speed: 0.1858s/iter; left time: 2973.8986s
	iters: 200, epoch: 12 | loss: 0.0000111
	speed: 0.0655s/iter; left time: 1041.8111s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.0504s/iter; left time: 796.9669s
	iters: 400, epoch: 12 | loss: 0.0000099
	speed: 0.0459s/iter; left time: 721.4360s
Epoch: 12 cost time: 23.605363607406616
Epoch: 12, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0696080
	speed: 0.1738s/iter; left time: 2710.9694s
	iters: 200, epoch: 13 | loss: 0.1964720
	speed: 0.0498s/iter; left time: 771.7947s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0491s/iter; left time: 755.3931s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0696s/iter; left time: 1064.9586s
Epoch: 13 cost time: 22.736051559448242
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1874s/iter; left time: 2845.8567s
	iters: 200, epoch: 14 | loss: 0.0010227
	speed: 0.0623s/iter; left time: 939.3958s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0628s/iter; left time: 941.2741s
	iters: 400, epoch: 14 | loss: 0.0008228
	speed: 0.0822s/iter; left time: 1223.4214s
Epoch: 14 cost time: 29.498085260391235
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2331s/iter; left time: 3442.9331s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0825s/iter; left time: 1210.1905s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0856s/iter; left time: 1246.4270s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 1192.5548s
Epoch: 15 cost time: 34.89096236228943
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.986 Test Loss: 0.101 Test Acc: 0.986
Validation loss decreased (-0.980900 --> -0.986356).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.2404s/iter; left time: 3451.7310s
	iters: 200, epoch: 16 | loss: 0.0690761
	speed: 0.0628s/iter; left time: 895.8489s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 956.4563s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0627s/iter; left time: 881.2706s
Epoch: 16 cost time: 29.094995975494385
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1884s/iter; left time: 2626.5599s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.0606s/iter; left time: 838.2774s
	iters: 300, epoch: 17 | loss: 0.4331422
	speed: 0.0668s/iter; left time: 917.7700s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0703s/iter; left time: 959.5413s
Epoch: 17 cost time: 26.62160348892212
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1983s/iter; left time: 2683.6615s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 889.2927s
	iters: 300, epoch: 18 | loss: 0.0000140
	speed: 0.0536s/iter; left time: 714.5388s
	iters: 400, epoch: 18 | loss: 0.0001106
	speed: 0.0565s/iter; left time: 747.4996s
Epoch: 18 cost time: 25.240002155303955
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000005
	speed: 0.1817s/iter; left time: 2383.4215s
	iters: 200, epoch: 19 | loss: 0.0000002
	speed: 0.0509s/iter; left time: 662.1549s
	iters: 300, epoch: 19 | loss: 0.0000025
	speed: 0.0537s/iter; left time: 694.0047s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.0620s/iter; left time: 794.9253s
Epoch: 19 cost time: 23.21308946609497
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000912
	speed: 0.1716s/iter; left time: 2179.8890s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0423s/iter; left time: 533.4007s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0379s/iter; left time: 473.5341s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.0419s/iter; left time: 519.8720s
Epoch: 20 cost time: 18.328017711639404
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.982 Test Loss: 0.146 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1645s/iter; left time: 2021.3768s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0733s/iter; left time: 893.3674s
	iters: 300, epoch: 21 | loss: 0.0000433
	speed: 0.0462s/iter; left time: 559.1426s
	iters: 400, epoch: 21 | loss: 0.0004811
	speed: 0.0402s/iter; left time: 481.8784s
Epoch: 21 cost time: 23.192774772644043
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.1485s/iter; left time: 1763.4307s
	iters: 200, epoch: 22 | loss: 0.0000009
	speed: 0.0554s/iter; left time: 652.5353s
	iters: 300, epoch: 22 | loss: 0.0000018
	speed: 0.0716s/iter; left time: 835.6729s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0751s/iter; left time: 869.5624s
Epoch: 22 cost time: 27.88460659980774
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.977 Test Loss: 0.183 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000004
	speed: 0.2142s/iter; left time: 2456.1880s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0745s/iter; left time: 846.1612s
	iters: 300, epoch: 23 | loss: 0.0001819
	speed: 0.0641s/iter; left time: 721.6276s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0581s/iter; left time: 648.4198s
Epoch: 23 cost time: 27.444413423538208
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1809s/iter; left time: 1999.0874s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 543.4846s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0451s/iter; left time: 489.9459s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0481s/iter; left time: 517.0853s
Epoch: 24 cost time: 20.626641988754272
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0244659
	speed: 0.1701s/iter; left time: 1809.4620s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.0621s/iter; left time: 654.4643s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0523s/iter; left time: 545.6488s
	iters: 400, epoch: 25 | loss: 0.0066843
	speed: 0.0574s/iter; left time: 593.8747s
Epoch: 25 cost time: 24.804836988449097
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.976 Test Loss: 0.241 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 22543114
model size : 100.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1515099
	speed: 0.1120s/iter; left time: 2302.6127s
	iters: 200, epoch: 1 | loss: 0.0269581
	speed: 0.1041s/iter; left time: 2128.5573s
	iters: 300, epoch: 1 | loss: 0.0632475
	speed: 0.1099s/iter; left time: 2236.4807s
	iters: 400, epoch: 1 | loss: 0.0162909
	speed: 0.1503s/iter; left time: 3044.6373s
Epoch: 1 cost time: 49.27524399757385
Epoch: 1, Steps: 413 | Train Loss: 0.498 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0864899
	speed: 0.3541s/iter; left time: 7131.7005s
	iters: 200, epoch: 2 | loss: 0.1673329
	speed: 0.1373s/iter; left time: 2752.0980s
	iters: 300, epoch: 2 | loss: 0.0011063
	speed: 0.1305s/iter; left time: 2600.9433s
	iters: 400, epoch: 2 | loss: 0.0009061
	speed: 0.1253s/iter; left time: 2485.0302s
Epoch: 2 cost time: 54.66150426864624
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0039323
	speed: 0.3551s/iter; left time: 7004.2266s
	iters: 200, epoch: 3 | loss: 0.0694482
	speed: 0.1175s/iter; left time: 2306.4651s
	iters: 300, epoch: 3 | loss: 0.0002699
	speed: 0.0762s/iter; left time: 1488.3410s
	iters: 400, epoch: 3 | loss: 0.0025699
	speed: 0.1080s/iter; left time: 2098.2796s
Epoch: 3 cost time: 47.276161193847656
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
Validation loss decreased (-0.971804 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000436
	speed: 0.3964s/iter; left time: 7654.8321s
	iters: 200, epoch: 4 | loss: 0.0001940
	speed: 0.0939s/iter; left time: 1804.8475s
	iters: 300, epoch: 4 | loss: 0.0003761
	speed: 0.1064s/iter; left time: 2033.4938s
	iters: 400, epoch: 4 | loss: 0.1210310
	speed: 0.1055s/iter; left time: 2005.3848s
Epoch: 4 cost time: 41.51179075241089
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.978626 --> -0.983173).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0108525
	speed: 0.3000s/iter; left time: 5670.3115s
	iters: 200, epoch: 5 | loss: 0.0000135
	speed: 0.1054s/iter; left time: 1981.2973s
	iters: 300, epoch: 5 | loss: 0.0010159
	speed: 0.1428s/iter; left time: 2670.8675s
	iters: 400, epoch: 5 | loss: 0.0000400
	speed: 0.1310s/iter; left time: 2437.1369s
Epoch: 5 cost time: 52.04274940490723
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000332
	speed: 0.2729s/iter; left time: 5045.2703s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.1240s/iter; left time: 2279.5529s
	iters: 300, epoch: 6 | loss: 0.0000253
	speed: 0.1447s/iter; left time: 2646.7224s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0836s/iter; left time: 1520.7180s
Epoch: 6 cost time: 47.42073917388916
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000022
	speed: 0.3541s/iter; left time: 6400.4525s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.1442s/iter; left time: 2591.0433s
	iters: 300, epoch: 7 | loss: 0.0000023
	speed: 0.1709s/iter; left time: 3054.2086s
	iters: 400, epoch: 7 | loss: 0.0004191
	speed: 0.1696s/iter; left time: 3014.9511s
Epoch: 7 cost time: 62.93807244300842
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000021
	speed: 0.3760s/iter; left time: 6640.0492s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.0772s/iter; left time: 1355.7961s
	iters: 300, epoch: 8 | loss: 0.0002224
	speed: 0.0755s/iter; left time: 1317.7083s
	iters: 400, epoch: 8 | loss: 0.0013940
	speed: 0.1111s/iter; left time: 1928.0270s
Epoch: 8 cost time: 40.078004121780396
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000843
	speed: 0.2719s/iter; left time: 4688.6826s
	iters: 200, epoch: 9 | loss: 0.2869906
	speed: 0.1085s/iter; left time: 1861.0949s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 1624.2649s
	iters: 400, epoch: 9 | loss: 0.0490762
	speed: 0.1151s/iter; left time: 1950.2966s
Epoch: 9 cost time: 42.90718078613281
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0010352
	speed: 0.2608s/iter; left time: 4389.5172s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0722s/iter; left time: 1208.6859s
	iters: 300, epoch: 10 | loss: 0.0000043
	speed: 0.1246s/iter; left time: 2072.3726s
	iters: 400, epoch: 10 | loss: 0.0040163
	speed: 0.1553s/iter; left time: 2568.5289s
Epoch: 10 cost time: 47.9637131690979
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.986 Test Loss: 0.110 Test Acc: 0.986
Validation loss decreased (-0.983173 --> -0.986356).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3914s/iter; left time: 6427.1450s
	iters: 200, epoch: 11 | loss: 0.0000158
	speed: 0.1559s/iter; left time: 2544.8513s
	iters: 300, epoch: 11 | loss: 0.0000721
	speed: 0.1787s/iter; left time: 2898.6297s
	iters: 400, epoch: 11 | loss: 0.0004644
	speed: 0.1394s/iter; left time: 2247.9435s
Epoch: 11 cost time: 64.12572741508484
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.987 Test Loss: 0.142 Test Acc: 0.987
Validation loss decreased (-0.986356 --> -0.987266).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002127
	speed: 0.3723s/iter; left time: 5959.2342s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 1784.9291s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.0557s/iter; left time: 880.2903s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0752s/iter; left time: 1181.2137s
Epoch: 12 cost time: 40.24124240875244
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.136 Vali Acc: 0.987 Test Loss: 0.136 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000248
	speed: 0.2390s/iter; left time: 3726.4511s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0931s/iter; left time: 1441.9506s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0976s/iter; left time: 1502.3977s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0983s/iter; left time: 1502.9579s
Epoch: 13 cost time: 37.85436749458313
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.990 Test Loss: 0.102 Test Acc: 0.990
Validation loss decreased (-0.987266 --> -0.989994).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3216s/iter; left time: 4882.1186s
	iters: 200, epoch: 14 | loss: 0.0000008
	speed: 0.1020s/iter; left time: 1538.7755s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1207s/iter; left time: 1808.1677s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0978s/iter; left time: 1456.1571s
Epoch: 14 cost time: 45.2332866191864
Epoch: 14, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.981 Test Loss: 0.265 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000005
	speed: 0.4148s/iter; left time: 6125.8432s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.1700s/iter; left time: 2493.3635s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.1818s/iter; left time: 2648.3160s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1485s/iter; left time: 2148.0974s
Epoch: 15 cost time: 69.6491014957428
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.989 Test Loss: 0.147 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0038796
	speed: 0.3921s/iter; left time: 5628.9936s
	iters: 200, epoch: 16 | loss: 0.0001043
	speed: 0.1292s/iter; left time: 1841.8715s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 1278.0975s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1101s/iter; left time: 1548.2358s
Epoch: 16 cost time: 50.957672119140625
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.986 Test Loss: 0.169 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0006709
	speed: 0.2471s/iter; left time: 3445.3381s
	iters: 200, epoch: 17 | loss: 2.2842355
	speed: 0.0786s/iter; left time: 1087.3752s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 1132.4569s
	iters: 400, epoch: 17 | loss: 0.1808814
	speed: 0.1078s/iter; left time: 1470.7178s
Epoch: 17 cost time: 34.857892990112305
Epoch: 17, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3580s/iter; left time: 4843.9588s
	iters: 200, epoch: 18 | loss: 0.0000041
	speed: 0.0983s/iter; left time: 1319.9778s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.1168s/iter; left time: 1556.5880s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 1286.1425s
Epoch: 18 cost time: 46.55182886123657
Epoch: 18, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.991 Test Loss: 0.072 Test Acc: 0.991
Validation loss decreased (-0.989994 --> -0.990904).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000120
	speed: 0.4018s/iter; left time: 5270.3219s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.1374s/iter; left time: 1788.9307s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1446s/iter; left time: 1867.6653s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1054s/iter; left time: 1351.4472s
Epoch: 19 cost time: 57.02015566825867
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.988 Test Loss: 0.149 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0208443
	speed: 0.3097s/iter; left time: 3934.8265s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1373s/iter; left time: 1730.0347s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.1553s/iter; left time: 1942.3058s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.1490s/iter; left time: 1847.8676s
Epoch: 20 cost time: 59.27001452445984
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.283 Vali Acc: 0.979 Test Loss: 0.283 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0084431
	speed: 0.3166s/iter; left time: 3891.4421s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.1233s/iter; left time: 1502.6913s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.1152s/iter; left time: 1392.5678s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.1028s/iter; left time: 1232.4648s
Epoch: 21 cost time: 45.430171251297
Epoch: 21, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 3343.0117s
	iters: 200, epoch: 22 | loss: 0.1129243
	speed: 0.1099s/iter; left time: 1294.2878s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0958s/iter; left time: 1118.4873s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1422s/iter; left time: 1646.5620s
Epoch: 22 cost time: 44.83021378517151
Epoch: 22, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.308 Vali Acc: 0.977 Test Loss: 0.308 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2770s/iter; left time: 3175.9144s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0966s/iter; left time: 1098.2142s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0960s/iter; left time: 1081.1809s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1082s/iter; left time: 1207.7819s
Epoch: 23 cost time: 39.94561696052551
Epoch: 23, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.987 Test Loss: 0.180 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2311s/iter; left time: 2553.7303s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0862s/iter; left time: 943.6116s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0828s/iter; left time: 898.7193s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0903s/iter; left time: 971.2762s
Epoch: 24 cost time: 36.77720403671265
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.981 Test Loss: 0.272 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2448s/iter; left time: 2604.1782s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0796s/iter; left time: 838.9791s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 552.0940s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0974s/iter; left time: 1006.6794s
Epoch: 25 cost time: 32.39703011512756
Epoch: 25, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.973 Test Loss: 0.473 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.1473s/iter; left time: 1506.3482s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 929.9344s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.1181s/iter; left time: 1183.7088s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.1160s/iter; left time: 1151.2950s
Epoch: 26 cost time: 38.30338668823242
Epoch: 26, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.987 Test Loss: 0.207 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000008
	speed: 0.3526s/iter; left time: 3460.4457s
	iters: 200, epoch: 27 | loss: 0.0000324
	speed: 0.1392s/iter; left time: 1352.3328s
	iters: 300, epoch: 27 | loss: 0.0000138
	speed: 0.1032s/iter; left time: 992.1147s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0929s/iter; left time: 883.4722s
Epoch: 27 cost time: 48.69809031486511
Epoch: 27, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.378 Vali Acc: 0.979 Test Loss: 0.378 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2943s/iter; left time: 2766.6009s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.1107s/iter; left time: 1029.5178s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.1318s/iter; left time: 1212.5918s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.1417s/iter; left time: 1289.6249s
Epoch: 28 cost time: 52.64481496810913
Epoch: 28, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.226 Vali Acc: 0.984 Test Loss: 0.226 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 22722826
model size : 101.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6328939
	speed: 0.1099s/iter; left time: 2257.8582s
	iters: 200, epoch: 1 | loss: 0.1420951
	speed: 0.0678s/iter; left time: 1387.5947s
	iters: 300, epoch: 1 | loss: 0.1790151
	speed: 0.0694s/iter; left time: 1412.4965s
	iters: 400, epoch: 1 | loss: 0.4621817
	speed: 0.0503s/iter; left time: 1017.8740s
Epoch: 1 cost time: 30.48710536956787
Epoch: 1, Steps: 413 | Train Loss: 0.553 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0359241
	speed: 0.1825s/iter; left time: 3676.1914s
	iters: 200, epoch: 2 | loss: 0.0712510
	speed: 0.0667s/iter; left time: 1335.7956s
	iters: 300, epoch: 2 | loss: 0.0045223
	speed: 0.0687s/iter; left time: 1370.5774s
	iters: 400, epoch: 2 | loss: 0.0010836
	speed: 0.0731s/iter; left time: 1450.5044s
Epoch: 2 cost time: 27.516535758972168
Epoch: 2, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0028267
	speed: 0.2781s/iter; left time: 5484.7514s
	iters: 200, epoch: 3 | loss: 0.0035716
	speed: 0.0721s/iter; left time: 1415.7227s
	iters: 300, epoch: 3 | loss: 0.0450420
	speed: 0.0612s/iter; left time: 1195.6747s
	iters: 400, epoch: 3 | loss: 0.0002839
	speed: 0.0695s/iter; left time: 1350.6874s
Epoch: 3 cost time: 30.196105003356934
Epoch: 3, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0012293
	speed: 0.2009s/iter; left time: 3879.7285s
	iters: 200, epoch: 4 | loss: 0.0002624
	speed: 0.0528s/iter; left time: 1014.7230s
	iters: 300, epoch: 4 | loss: 0.0001337
	speed: 0.0640s/iter; left time: 1223.5135s
	iters: 400, epoch: 4 | loss: 0.0000865
	speed: 0.0779s/iter; left time: 1481.7464s
Epoch: 4 cost time: 25.435865879058838
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0002031
	speed: 0.2655s/iter; left time: 5017.8793s
	iters: 200, epoch: 5 | loss: 0.0003627
	speed: 0.0937s/iter; left time: 1761.2780s
	iters: 300, epoch: 5 | loss: 0.0000100
	speed: 0.0799s/iter; left time: 1494.2612s
	iters: 400, epoch: 5 | loss: 0.0051270
	speed: 0.0741s/iter; left time: 1377.5744s
Epoch: 5 cost time: 33.29283404350281
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.970895 --> -0.979535).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0023644
	speed: 0.3339s/iter; left time: 6171.9001s
	iters: 200, epoch: 6 | loss: 0.0002165
	speed: 0.0904s/iter; left time: 1662.0129s
	iters: 300, epoch: 6 | loss: 0.0042856
	speed: 0.0946s/iter; left time: 1730.4730s
	iters: 400, epoch: 6 | loss: 0.0947886
	speed: 0.0903s/iter; left time: 1642.6988s
Epoch: 6 cost time: 37.915305614471436
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000111
	speed: 0.2988s/iter; left time: 5399.8726s
	iters: 200, epoch: 7 | loss: 0.0000034
	speed: 0.0538s/iter; left time: 967.5260s
	iters: 300, epoch: 7 | loss: 0.0760741
	speed: 0.0578s/iter; left time: 1032.2953s
	iters: 400, epoch: 7 | loss: 0.2880121
	speed: 0.0605s/iter; left time: 1075.6229s
Epoch: 7 cost time: 25.98099184036255
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.189 Vali Acc: 0.978 Test Loss: 0.189 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0001731
	speed: 0.2525s/iter; left time: 4458.6138s
	iters: 200, epoch: 8 | loss: 0.0000235
	speed: 0.0801s/iter; left time: 1406.3957s
	iters: 300, epoch: 8 | loss: 0.3083506
	speed: 0.0621s/iter; left time: 1084.1812s
	iters: 400, epoch: 8 | loss: 0.0003455
	speed: 0.0575s/iter; left time: 998.0079s
Epoch: 8 cost time: 28.828176498413086
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
Validation loss decreased (-0.979535 --> -0.984538).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000162
	speed: 0.2332s/iter; left time: 4022.8454s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0763s/iter; left time: 1307.6614s
	iters: 300, epoch: 9 | loss: 0.0002126
	speed: 0.0879s/iter; left time: 1498.5721s
	iters: 400, epoch: 9 | loss: 0.0000006
	speed: 0.0582s/iter; left time: 985.7125s
Epoch: 9 cost time: 31.5261812210083
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.2689s/iter; left time: 4527.1797s
	iters: 200, epoch: 10 | loss: 0.0000214
	speed: 0.0861s/iter; left time: 1441.5575s
	iters: 300, epoch: 10 | loss: 0.0010226
	speed: 0.0897s/iter; left time: 1492.1458s
	iters: 400, epoch: 10 | loss: 0.0000134
	speed: 0.0835s/iter; left time: 1380.5653s
Epoch: 10 cost time: 35.821577072143555
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0909136
	speed: 0.3107s/iter; left time: 5102.7707s
	iters: 200, epoch: 11 | loss: 0.0000075
	speed: 0.0976s/iter; left time: 1593.4682s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0828s/iter; left time: 1342.9093s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0824s/iter; left time: 1328.8329s
Epoch: 11 cost time: 36.80378699302673
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000050
	speed: 0.2761s/iter; left time: 4420.5367s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0797s/iter; left time: 1268.3925s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.0670s/iter; left time: 1059.8328s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 1164.4539s
Epoch: 12 cost time: 31.507350206375122
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2123s/iter; left time: 3310.8500s
	iters: 200, epoch: 13 | loss: 0.0002755
	speed: 0.0575s/iter; left time: 890.5582s
	iters: 300, epoch: 13 | loss: 0.0000036
	speed: 0.0546s/iter; left time: 840.5466s
	iters: 400, epoch: 13 | loss: 0.0000369
	speed: 0.0551s/iter; left time: 843.2827s
Epoch: 13 cost time: 24.802236318588257
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0011123
	speed: 0.2076s/iter; left time: 3151.3639s
	iters: 200, epoch: 14 | loss: 0.5412898
	speed: 0.0831s/iter; left time: 1253.4275s
	iters: 300, epoch: 14 | loss: 0.0000025
	speed: 0.0499s/iter; left time: 747.2820s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0774s/iter; left time: 1152.1487s
Epoch: 14 cost time: 30.08035707473755
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.974 Test Loss: 0.249 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2242s/iter; left time: 3310.9536s
	iters: 200, epoch: 15 | loss: 0.0000106
	speed: 0.0628s/iter; left time: 920.6647s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 1047.3617s
	iters: 400, epoch: 15 | loss: 0.0112499
	speed: 0.0874s/iter; left time: 1264.5033s
Epoch: 15 cost time: 29.520728826522827
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000047
	speed: 0.3273s/iter; left time: 4698.3159s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0960s/iter; left time: 1368.4345s
	iters: 300, epoch: 16 | loss: 0.0000006
	speed: 0.0997s/iter; left time: 1411.7035s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 1179.7656s
Epoch: 16 cost time: 39.276779890060425
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2962s/iter; left time: 4130.1453s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0847s/iter; left time: 1172.4991s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0833s/iter; left time: 1144.8165s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0749s/iter; left time: 1021.8103s
Epoch: 17 cost time: 34.76443672180176
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.973 Test Loss: 0.270 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000120
	speed: 0.2570s/iter; left time: 3476.7726s
	iters: 200, epoch: 18 | loss: 0.0027953
	speed: 0.0612s/iter; left time: 821.6334s
	iters: 300, epoch: 18 | loss: 0.0259857
	speed: 0.0708s/iter; left time: 943.8501s
	iters: 400, epoch: 18 | loss: 0.0000040
	speed: 0.0684s/iter; left time: 904.6393s
Epoch: 18 cost time: 29.783835411071777
Epoch: 18, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.245 Vali Acc: 0.970 Test Loss: 0.245 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 22649098
model size : 101.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7474187
	speed: 0.0860s/iter; left time: 1767.8344s
	iters: 200, epoch: 1 | loss: 0.1491811
	speed: 0.0507s/iter; left time: 1037.6663s
	iters: 300, epoch: 1 | loss: 0.0650140
	speed: 0.0527s/iter; left time: 1072.4690s
	iters: 400, epoch: 1 | loss: 0.0039852
	speed: 0.0519s/iter; left time: 1051.5871s
Epoch: 1 cost time: 25.231881856918335
Epoch: 1, Steps: 413 | Train Loss: 0.603 Vali Loss: 0.105 Vali Acc: 0.961 Test Loss: 0.105 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0021030
	speed: 0.1987s/iter; left time: 4001.5556s
	iters: 200, epoch: 2 | loss: 0.0132857
	speed: 0.0578s/iter; left time: 1158.9680s
	iters: 300, epoch: 2 | loss: 0.0083185
	speed: 0.0593s/iter; left time: 1182.9705s
	iters: 400, epoch: 2 | loss: 0.1012718
	speed: 0.0649s/iter; left time: 1288.2630s
Epoch: 2 cost time: 24.731117248535156
Epoch: 2, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.095 Vali Acc: 0.966 Test Loss: 0.095 Test Acc: 0.966
Validation loss decreased (-0.961345 --> -0.965893).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0007155
	speed: 0.2049s/iter; left time: 4041.0673s
	iters: 200, epoch: 3 | loss: 0.0114286
	speed: 0.0530s/iter; left time: 1039.9734s
	iters: 300, epoch: 3 | loss: 0.0532155
	speed: 0.0562s/iter; left time: 1096.4824s
	iters: 400, epoch: 3 | loss: 0.2191773
	speed: 0.0618s/iter; left time: 1201.0695s
Epoch: 3 cost time: 24.124825716018677
Epoch: 3, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0002358
	speed: 0.2089s/iter; left time: 4034.8896s
	iters: 200, epoch: 4 | loss: 0.0002141
	speed: 0.0604s/iter; left time: 1159.6856s
	iters: 300, epoch: 4 | loss: 0.5172036
	speed: 0.0695s/iter; left time: 1328.8741s
	iters: 400, epoch: 4 | loss: 0.0006830
	speed: 0.0505s/iter; left time: 959.8713s
Epoch: 4 cost time: 25.82427716255188
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.965893 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0017398
	speed: 0.2046s/iter; left time: 3867.1109s
	iters: 200, epoch: 5 | loss: 0.0107738
	speed: 0.0532s/iter; left time: 999.7853s
	iters: 300, epoch: 5 | loss: 0.0057441
	speed: 0.0626s/iter; left time: 1170.0906s
	iters: 400, epoch: 5 | loss: 0.0000317
	speed: 0.0498s/iter; left time: 926.5737s
Epoch: 5 cost time: 24.731712341308594
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.975897).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0080514
	speed: 0.2229s/iter; left time: 4120.5074s
	iters: 200, epoch: 6 | loss: 0.0000998
	speed: 0.0668s/iter; left time: 1227.4448s
	iters: 300, epoch: 6 | loss: 0.0298571
	speed: 0.0779s/iter; left time: 1424.3275s
	iters: 400, epoch: 6 | loss: 0.0006538
	speed: 0.0657s/iter; left time: 1195.2335s
Epoch: 6 cost time: 28.729008197784424
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0866404
	speed: 0.1704s/iter; left time: 3078.8777s
	iters: 200, epoch: 7 | loss: 0.0001505
	speed: 0.0505s/iter; left time: 908.4611s
	iters: 300, epoch: 7 | loss: 0.0000345
	speed: 0.0618s/iter; left time: 1104.6559s
	iters: 400, epoch: 7 | loss: 0.0002068
	speed: 0.0613s/iter; left time: 1090.2003s
Epoch: 7 cost time: 23.600682735443115
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000410
	speed: 0.2123s/iter; left time: 3748.7175s
	iters: 200, epoch: 8 | loss: 0.0000017
	speed: 0.0647s/iter; left time: 1135.6752s
	iters: 300, epoch: 8 | loss: 0.0000225
	speed: 0.0669s/iter; left time: 1168.2896s
	iters: 400, epoch: 8 | loss: 0.0006085
	speed: 0.0570s/iter; left time: 990.3121s
Epoch: 8 cost time: 26.217395544052124
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0716069
	speed: 0.1755s/iter; left time: 3026.0615s
	iters: 200, epoch: 9 | loss: 0.0371745
	speed: 0.0366s/iter; left time: 627.0921s
	iters: 300, epoch: 9 | loss: 0.0020229
	speed: 0.0385s/iter; left time: 656.5556s
	iters: 400, epoch: 9 | loss: 0.0123119
	speed: 0.0515s/iter; left time: 872.9154s
Epoch: 9 cost time: 17.93423819541931
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
Validation loss decreased (-0.980445 --> -0.984992).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000041
	speed: 0.1898s/iter; left time: 3194.7330s
	iters: 200, epoch: 10 | loss: 0.0006729
	speed: 0.0544s/iter; left time: 910.7476s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0553s/iter; left time: 919.3323s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0599s/iter; left time: 990.4313s
Epoch: 10 cost time: 23.704246282577515
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0136355
	speed: 0.1730s/iter; left time: 2841.6451s
	iters: 200, epoch: 11 | loss: 0.0000006
	speed: 0.0457s/iter; left time: 745.4336s
	iters: 300, epoch: 11 | loss: 0.0000100
	speed: 0.0524s/iter; left time: 849.4666s
	iters: 400, epoch: 11 | loss: 0.0000010
	speed: 0.0694s/iter; left time: 1118.4381s
Epoch: 11 cost time: 22.34317445755005
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000019
	speed: 0.2110s/iter; left time: 3377.7270s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.0708s/iter; left time: 1126.4522s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0606s/iter; left time: 957.4913s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0596s/iter; left time: 935.9433s
Epoch: 12 cost time: 27.340763568878174
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0198208
	speed: 0.2039s/iter; left time: 3179.8022s
	iters: 200, epoch: 13 | loss: 0.0147134
	speed: 0.0620s/iter; left time: 960.1601s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0721s/iter; left time: 1110.7431s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0675s/iter; left time: 1032.0891s
Epoch: 13 cost time: 27.85052800178528
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000009
	speed: 0.2043s/iter; left time: 3101.1326s
	iters: 200, epoch: 14 | loss: 0.0000330
	speed: 0.0659s/iter; left time: 993.3743s
	iters: 300, epoch: 14 | loss: 0.0000073
	speed: 0.0594s/iter; left time: 890.3044s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 921.7438s
Epoch: 14 cost time: 26.574628114700317
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
Validation loss decreased (-0.984992 --> -0.985447).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1884s/iter; left time: 2782.0911s
	iters: 200, epoch: 15 | loss: 0.0000002
	speed: 0.0582s/iter; left time: 853.3614s
	iters: 300, epoch: 15 | loss: 0.0000569
	speed: 0.0507s/iter; left time: 738.4930s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0529s/iter; left time: 765.3161s
Epoch: 15 cost time: 22.24552321434021
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.986357).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.1871s/iter; left time: 2686.5163s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 805.2508s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.0619s/iter; left time: 876.5568s
	iters: 400, epoch: 16 | loss: 0.0000046
	speed: 0.0552s/iter; left time: 775.6109s
Epoch: 16 cost time: 23.119179248809814
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.986 Test Loss: 0.084 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000233
	speed: 0.1716s/iter; left time: 2392.5947s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 733.6883s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0464s/iter; left time: 637.3358s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0478s/iter; left time: 652.2275s
Epoch: 17 cost time: 21.166374683380127
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.1906s/iter; left time: 2578.7795s
	iters: 200, epoch: 18 | loss: 0.0006405
	speed: 0.0406s/iter; left time: 544.7441s
	iters: 300, epoch: 18 | loss: 0.0002231
	speed: 0.0400s/iter; left time: 533.7220s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0355s/iter; left time: 469.0402s
Epoch: 18 cost time: 17.86493468284607
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1441s/iter; left time: 1889.8768s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0533s/iter; left time: 693.8096s
	iters: 300, epoch: 19 | loss: 0.4344554
	speed: 0.0606s/iter; left time: 783.0228s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0498s/iter; left time: 638.5858s
Epoch: 19 cost time: 21.93765687942505
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1795s/iter; left time: 2280.9374s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 547.7730s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 539.1526s
	iters: 400, epoch: 20 | loss: 0.0000056
	speed: 0.0490s/iter; left time: 607.3804s
Epoch: 20 cost time: 20.79030203819275
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000180
	speed: 0.1701s/iter; left time: 2091.2412s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0447s/iter; left time: 545.1745s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 746.0399s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 632.7310s
Epoch: 21 cost time: 21.550743103027344
Epoch: 21, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.279 Vali Acc: 0.966 Test Loss: 0.279 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000468
	speed: 0.1718s/iter; left time: 2041.1603s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0371s/iter; left time: 437.2933s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0301s/iter; left time: 351.9371s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0373s/iter; left time: 431.2820s
Epoch: 22 cost time: 16.237893104553223
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.979 Test Loss: 0.179 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000004
	speed: 0.1697s/iter; left time: 1945.8922s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0439s/iter; left time: 499.1401s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0506s/iter; left time: 569.8562s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 713.0778s
Epoch: 23 cost time: 22.090544939041138
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.981 Test Loss: 0.149 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2022s/iter; left time: 2234.3164s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 638.7772s
	iters: 300, epoch: 24 | loss: 0.0000072
	speed: 0.0580s/iter; left time: 629.6418s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0690s/iter; left time: 741.7235s
Epoch: 24 cost time: 26.40948748588562
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1729633
	speed: 0.1969s/iter; left time: 2094.4797s
	iters: 200, epoch: 25 | loss: 0.0000002
	speed: 0.0624s/iter; left time: 658.0152s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0583s/iter; left time: 608.9839s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0551s/iter; left time: 569.5626s
Epoch: 25 cost time: 24.75053358078003
Epoch: 25, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.979 Test Loss: 0.219 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 22593802
model size : 100.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2774989
	speed: 0.1479s/iter; left time: 3039.2624s
	iters: 200, epoch: 1 | loss: 0.0333469
	speed: 0.1095s/iter; left time: 2239.0218s
	iters: 300, epoch: 1 | loss: 0.0092244
	speed: 0.0955s/iter; left time: 1943.0571s
	iters: 400, epoch: 1 | loss: 0.0740591
	speed: 0.1285s/iter; left time: 2603.2510s
Epoch: 1 cost time: 50.09010934829712
Epoch: 1, Steps: 413 | Train Loss: 0.494 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000790
	speed: 0.3685s/iter; left time: 7420.6229s
	iters: 200, epoch: 2 | loss: 0.0101122
	speed: 0.0681s/iter; left time: 1364.1540s
	iters: 300, epoch: 2 | loss: 0.0163803
	speed: 0.1589s/iter; left time: 3167.7409s
	iters: 400, epoch: 2 | loss: 0.0008678
	speed: 0.1315s/iter; left time: 2608.1321s
Epoch: 2 cost time: 51.599398136138916
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.957252 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0511516
	speed: 0.3630s/iter; left time: 7160.9320s
	iters: 200, epoch: 3 | loss: 0.0056101
	speed: 0.1052s/iter; left time: 2063.8625s
	iters: 300, epoch: 3 | loss: 0.0004633
	speed: 0.1017s/iter; left time: 1985.6347s
	iters: 400, epoch: 3 | loss: 0.1185296
	speed: 0.1152s/iter; left time: 2237.9002s
Epoch: 3 cost time: 43.91452383995056
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0062899
	speed: 0.3145s/iter; left time: 6074.2801s
	iters: 200, epoch: 4 | loss: 0.0008292
	speed: 0.1252s/iter; left time: 2405.7045s
	iters: 300, epoch: 4 | loss: 0.0001295
	speed: 0.1117s/iter; left time: 2135.0750s
	iters: 400, epoch: 4 | loss: 0.0000204
	speed: 0.1115s/iter; left time: 2118.9664s
Epoch: 4 cost time: 49.086114168167114
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.978171 --> -0.978626).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000007
	speed: 0.2871s/iter; left time: 5425.4154s
	iters: 200, epoch: 5 | loss: 0.0001881
	speed: 0.1115s/iter; left time: 2096.2553s
	iters: 300, epoch: 5 | loss: 0.0003938
	speed: 0.1311s/iter; left time: 2451.6267s
	iters: 400, epoch: 5 | loss: 0.0009623
	speed: 0.1349s/iter; left time: 2509.6648s
Epoch: 5 cost time: 49.8814971446991
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0013181
	speed: 0.2970s/iter; left time: 5489.4414s
	iters: 200, epoch: 6 | loss: 0.0000878
	speed: 0.1436s/iter; left time: 2640.2237s
	iters: 300, epoch: 6 | loss: 0.0674316
	speed: 0.1468s/iter; left time: 2684.3669s
	iters: 400, epoch: 6 | loss: 0.0000138
	speed: 0.1317s/iter; left time: 2394.7949s
Epoch: 6 cost time: 54.96957087516785
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.088 Vali Acc: 0.986 Test Loss: 0.088 Test Acc: 0.986
Validation loss decreased (-0.978626 --> -0.986357).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0007483
	speed: 0.3726s/iter; left time: 6734.1544s
	iters: 200, epoch: 7 | loss: 0.0464370
	speed: 0.1024s/iter; left time: 1841.0577s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.0999s/iter; left time: 1784.8420s
	iters: 400, epoch: 7 | loss: 0.0000008
	speed: 0.1176s/iter; left time: 2090.3977s
Epoch: 7 cost time: 46.818440675735474
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.979 Test Loss: 0.144 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000929
	speed: 0.2987s/iter; left time: 5274.8244s
	iters: 200, epoch: 8 | loss: 0.0000006
	speed: 0.1232s/iter; left time: 2162.5439s
	iters: 300, epoch: 8 | loss: 0.1252378
	speed: 0.0671s/iter; left time: 1170.9918s
	iters: 400, epoch: 8 | loss: 0.0000060
	speed: 0.0822s/iter; left time: 1426.5969s
Epoch: 8 cost time: 40.79784893989563
Epoch: 8, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.973 Test Loss: 0.253 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000077
	speed: 0.1812s/iter; left time: 3124.6189s
	iters: 200, epoch: 9 | loss: 0.0460309
	speed: 0.0421s/iter; left time: 721.8476s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 493.8408s
	iters: 400, epoch: 9 | loss: 0.0019436
	speed: 0.0272s/iter; left time: 460.2800s
Epoch: 9 cost time: 16.080515384674072
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.136 Vali Acc: 0.987 Test Loss: 0.136 Test Acc: 0.987
Validation loss decreased (-0.986357 --> -0.986811).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000023
	speed: 0.2273s/iter; left time: 3826.8003s
	iters: 200, epoch: 10 | loss: 0.0000015
	speed: 0.1300s/iter; left time: 2175.2138s
	iters: 300, epoch: 10 | loss: 0.0000118
	speed: 0.1345s/iter; left time: 2236.9790s
	iters: 400, epoch: 10 | loss: 0.0000011
	speed: 0.1406s/iter; left time: 2324.4654s
Epoch: 10 cost time: 51.176607608795166
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.232 Vali Acc: 0.980 Test Loss: 0.232 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2578s/iter; left time: 4233.4776s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.0819s/iter; left time: 1336.7720s
	iters: 300, epoch: 11 | loss: 0.0670269
	speed: 0.0564s/iter; left time: 914.5203s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.0532s/iter; left time: 857.4306s
Epoch: 11 cost time: 26.522940635681152
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.984 Test Loss: 0.144 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.2363s/iter; left time: 3782.4747s
	iters: 200, epoch: 12 | loss: 0.0006510
	speed: 0.0740s/iter; left time: 1176.7367s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0888s/iter; left time: 1403.7369s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.1250s/iter; left time: 1962.8999s
Epoch: 12 cost time: 39.731340408325195
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.166 Vali Acc: 0.981 Test Loss: 0.166 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3588s/iter; left time: 5594.7528s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.1409s/iter; left time: 2183.1187s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0948s/iter; left time: 1458.9778s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.0603s/iter; left time: 922.3234s
Epoch: 13 cost time: 43.53259754180908
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.989 Test Loss: 0.090 Test Acc: 0.989
Validation loss decreased (-0.986811 --> -0.988630).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0063436
	speed: 0.3218s/iter; left time: 4886.2451s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.1005s/iter; left time: 1515.0977s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.1014s/iter; left time: 1518.9923s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.1245s/iter; left time: 1853.4045s
Epoch: 14 cost time: 46.700833320617676
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.990 Test Loss: 0.105 Test Acc: 0.990
Validation loss decreased (-0.988630 --> -0.989994).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3044s/iter; left time: 4496.1551s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0962s/iter; left time: 1410.5738s
	iters: 300, epoch: 15 | loss: 0.4411591
	speed: 0.1109s/iter; left time: 1615.5163s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.1112s/iter; left time: 1608.8725s
Epoch: 15 cost time: 45.000709772109985
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.983 Test Loss: 0.179 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4555135
	speed: 0.2924s/iter; left time: 4197.4106s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1130s/iter; left time: 1610.9293s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.1149s/iter; left time: 1627.2152s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.1146s/iter; left time: 1611.4447s
Epoch: 16 cost time: 46.972031593322754
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.326 Vali Acc: 0.978 Test Loss: 0.326 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3221s/iter; left time: 4491.1124s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0916s/iter; left time: 1268.2927s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.1012s/iter; left time: 1391.3737s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 1185.1716s
Epoch: 17 cost time: 41.89007592201233
Epoch: 17, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.132 Vali Acc: 0.987 Test Loss: 0.132 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000020
	speed: 0.3096s/iter; left time: 4188.9526s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0784s/iter; left time: 1052.9929s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0873s/iter; left time: 1163.0637s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0671s/iter; left time: 887.3983s
Epoch: 18 cost time: 36.764708280563354
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.985 Test Loss: 0.176 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2858s/iter; left time: 3749.0763s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0953s/iter; left time: 1240.3763s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.1094s/iter; left time: 1412.9780s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1191s/iter; left time: 1527.0169s
Epoch: 19 cost time: 44.44590926170349
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.979 Test Loss: 0.236 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1909801
	speed: 0.3053s/iter; left time: 3878.7492s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.1001s/iter; left time: 1261.1103s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0944s/iter; left time: 1180.0293s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0650s/iter; left time: 806.1916s
Epoch: 20 cost time: 39.13248944282532
Epoch: 20, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.987 Test Loss: 0.193 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2852s/iter; left time: 3504.9754s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.1223s/iter; left time: 1490.4598s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0899s/iter; left time: 1087.4339s
	iters: 400, epoch: 21 | loss: 0.0000529
	speed: 0.1071s/iter; left time: 1283.6478s
Epoch: 21 cost time: 46.98330760002136
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.988 Test Loss: 0.166 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3590s/iter; left time: 4264.4424s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1011s/iter; left time: 1190.8220s
	iters: 300, epoch: 22 | loss: 0.0000013
	speed: 0.1190s/iter; left time: 1389.7889s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.1178s/iter; left time: 1363.7196s
Epoch: 22 cost time: 48.62709641456604
Epoch: 22, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.454 Vali Acc: 0.975 Test Loss: 0.454 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2186s/iter; left time: 2506.1869s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0846s/iter; left time: 961.0167s
	iters: 300, epoch: 23 | loss: 0.0000028
	speed: 0.0433s/iter; left time: 487.7256s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.0229s/iter; left time: 255.8620s
Epoch: 23 cost time: 20.366802215576172
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.983 Test Loss: 0.265 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2477s/iter; left time: 2737.9001s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 787.5378s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0608s/iter; left time: 659.8838s
	iters: 400, epoch: 24 | loss: 0.0000003
	speed: 0.0489s/iter; left time: 526.2990s
Epoch: 24 cost time: 29.38509774208069
Epoch: 24, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.417 Vali Acc: 0.980 Test Loss: 0.417 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 22782730
model size : 101.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3236794
	speed: 0.0818s/iter; left time: 1681.0432s
	iters: 200, epoch: 1 | loss: 0.1237125
	speed: 0.0844s/iter; left time: 1726.0142s
	iters: 300, epoch: 1 | loss: 0.0312937
	speed: 0.0888s/iter; left time: 1808.1741s
	iters: 400, epoch: 1 | loss: 0.0177282
	speed: 0.0814s/iter; left time: 1648.4625s
Epoch: 1 cost time: 34.92310094833374
Epoch: 1, Steps: 413 | Train Loss: 0.540 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (inf --> -0.952249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1088533
	speed: 0.2834s/iter; left time: 5706.5302s
	iters: 200, epoch: 2 | loss: 0.0024322
	speed: 0.0925s/iter; left time: 1852.8732s
	iters: 300, epoch: 2 | loss: 0.2060943
	speed: 0.0846s/iter; left time: 1686.3330s
	iters: 400, epoch: 2 | loss: 0.0729322
	speed: 0.0872s/iter; left time: 1729.8556s
Epoch: 2 cost time: 36.50188899040222
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.952249 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0013592
	speed: 0.2865s/iter; left time: 5650.9621s
	iters: 200, epoch: 3 | loss: 0.0015219
	speed: 0.0662s/iter; left time: 1300.0834s
	iters: 300, epoch: 3 | loss: 0.0001424
	speed: 0.0540s/iter; left time: 1054.3202s
	iters: 400, epoch: 3 | loss: 0.0461632
	speed: 0.0488s/iter; left time: 947.9481s
Epoch: 3 cost time: 26.237720727920532
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0024166
	speed: 0.1969s/iter; left time: 3802.2887s
	iters: 200, epoch: 4 | loss: 0.0022369
	speed: 0.0592s/iter; left time: 1137.2649s
	iters: 300, epoch: 4 | loss: 0.1563189
	speed: 0.0506s/iter; left time: 967.3388s
	iters: 400, epoch: 4 | loss: 0.0001926
	speed: 0.0569s/iter; left time: 1082.4044s
Epoch: 4 cost time: 23.575911283493042
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.972714 --> -0.980445).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0005424
	speed: 0.2176s/iter; left time: 4112.3381s
	iters: 200, epoch: 5 | loss: 0.0000427
	speed: 0.0564s/iter; left time: 1060.8182s
	iters: 300, epoch: 5 | loss: 0.0181937
	speed: 0.0507s/iter; left time: 947.6841s
	iters: 400, epoch: 5 | loss: 0.0051678
	speed: 0.0611s/iter; left time: 1137.2923s
Epoch: 5 cost time: 24.890889167785645
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2216103
	speed: 0.1751s/iter; left time: 3237.0551s
	iters: 200, epoch: 6 | loss: 0.0001471
	speed: 0.0386s/iter; left time: 708.8612s
	iters: 300, epoch: 6 | loss: 0.0003646
	speed: 0.0487s/iter; left time: 890.1194s
	iters: 400, epoch: 6 | loss: 0.0252305
	speed: 0.0579s/iter; left time: 1053.2724s
Epoch: 6 cost time: 20.059478998184204
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000053
	speed: 0.2634s/iter; left time: 4760.2131s
	iters: 200, epoch: 7 | loss: 0.0000004
	speed: 0.0913s/iter; left time: 1640.5872s
	iters: 300, epoch: 7 | loss: 0.0000574
	speed: 0.0842s/iter; left time: 1504.5459s
	iters: 400, epoch: 7 | loss: 0.0019155
	speed: 0.0892s/iter; left time: 1586.1286s
Epoch: 7 cost time: 37.96867752075195
Epoch: 7, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000240
	speed: 0.2556s/iter; left time: 4513.9085s
	iters: 200, epoch: 8 | loss: 0.0154962
	speed: 0.0790s/iter; left time: 1387.5721s
	iters: 300, epoch: 8 | loss: 0.0000339
	speed: 0.0744s/iter; left time: 1298.6525s
	iters: 400, epoch: 8 | loss: 0.0000007
	speed: 0.0637s/iter; left time: 1105.3278s
Epoch: 8 cost time: 30.68625235557556
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
Validation loss decreased (-0.980445 --> -0.984537).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000145
	speed: 0.2770s/iter; left time: 4777.5483s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.0823s/iter; left time: 1410.9346s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.0794s/iter; left time: 1353.0023s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0897s/iter; left time: 1519.4049s
Epoch: 9 cost time: 32.75188374519348
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0001332
	speed: 0.2306s/iter; left time: 3882.1482s
	iters: 200, epoch: 10 | loss: 0.0000219
	speed: 0.0706s/iter; left time: 1181.3362s
	iters: 300, epoch: 10 | loss: 0.0000270
	speed: 0.0662s/iter; left time: 1100.8272s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.0565s/iter; left time: 934.8369s
Epoch: 10 cost time: 25.17341709136963
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0667143
	speed: 0.2215s/iter; left time: 3637.0819s
	iters: 200, epoch: 11 | loss: 0.0001113
	speed: 0.0679s/iter; left time: 1108.7938s
	iters: 300, epoch: 11 | loss: 0.0480248
	speed: 0.0667s/iter; left time: 1081.7166s
	iters: 400, epoch: 11 | loss: 0.0008685
	speed: 0.0626s/iter; left time: 1009.6882s
Epoch: 11 cost time: 27.198338270187378
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0046795
	speed: 0.2323s/iter; left time: 3718.3406s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.0472s/iter; left time: 751.3570s
	iters: 300, epoch: 12 | loss: 0.0000079
	speed: 0.0632s/iter; left time: 999.5722s
	iters: 400, epoch: 12 | loss: 0.0000702
	speed: 0.0797s/iter; left time: 1251.8570s
Epoch: 12 cost time: 27.76797890663147
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.983 Test Loss: 0.148 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0214259
	speed: 0.2673s/iter; left time: 4168.6339s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.0681s/iter; left time: 1055.7007s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0809s/iter; left time: 1244.7554s
	iters: 400, epoch: 13 | loss: 0.0001977
	speed: 0.0925s/iter; left time: 1415.1317s
Epoch: 13 cost time: 34.66460680961609
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0012438
	speed: 0.2921s/iter; left time: 4434.7637s
	iters: 200, epoch: 14 | loss: 0.0488816
	speed: 0.0890s/iter; left time: 1342.1248s
	iters: 300, epoch: 14 | loss: 0.0000031
	speed: 0.0888s/iter; left time: 1330.8157s
	iters: 400, epoch: 14 | loss: 0.0004116
	speed: 0.0771s/iter; left time: 1146.8631s
Epoch: 14 cost time: 36.1825897693634
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.236 Vali Acc: 0.969 Test Loss: 0.236 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000012
	speed: 0.2822s/iter; left time: 4168.3455s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.0839s/iter; left time: 1231.0068s
	iters: 300, epoch: 15 | loss: 0.3057635
	speed: 0.0613s/iter; left time: 893.5892s
	iters: 400, epoch: 15 | loss: 0.0000003
	speed: 0.0524s/iter; left time: 758.3406s
Epoch: 15 cost time: 27.719794273376465
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.2080s/iter; left time: 2985.7012s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0619s/iter; left time: 883.1493s
	iters: 300, epoch: 16 | loss: 0.0000023
	speed: 0.0448s/iter; left time: 633.9735s
	iters: 400, epoch: 16 | loss: 0.0000025
	speed: 0.0606s/iter; left time: 852.0153s
Epoch: 16 cost time: 23.438600540161133
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000111
	speed: 0.2393s/iter; left time: 3336.8447s
	iters: 200, epoch: 17 | loss: 0.0009338
	speed: 0.0489s/iter; left time: 677.5724s
	iters: 300, epoch: 17 | loss: 0.0008335
	speed: 0.0507s/iter; left time: 696.2330s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0549s/iter; left time: 749.1978s
Epoch: 17 cost time: 23.874085187911987
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
Validation loss decreased (-0.984537 --> -0.987266).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.2452s/iter; left time: 3317.4330s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0389s/iter; left time: 522.8516s
	iters: 300, epoch: 18 | loss: 0.0001763
	speed: 0.0702s/iter; left time: 935.5671s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0887s/iter; left time: 1173.5039s
Epoch: 18 cost time: 25.94748282432556
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2615s/iter; left time: 3430.2178s
	iters: 200, epoch: 19 | loss: 0.0430758
	speed: 0.0706s/iter; left time: 919.2109s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0526s/iter; left time: 679.9272s
	iters: 400, epoch: 19 | loss: 0.0000011
	speed: 0.0477s/iter; left time: 611.2254s
Epoch: 19 cost time: 24.85665225982666
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000013
	speed: 0.2330s/iter; left time: 2959.5475s
	iters: 200, epoch: 20 | loss: 0.0000139
	speed: 0.0721s/iter; left time: 908.8935s
	iters: 300, epoch: 20 | loss: 0.0000619
	speed: 0.0433s/iter; left time: 542.0428s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0460s/iter; left time: 570.1650s
Epoch: 20 cost time: 26.738661527633667
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.966 Test Loss: 0.267 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4757380
	speed: 0.2581s/iter; left time: 3172.3044s
	iters: 200, epoch: 21 | loss: 0.0245418
	speed: 0.0473s/iter; left time: 576.1313s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 676.2302s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0710s/iter; left time: 851.1311s
Epoch: 21 cost time: 26.31108832359314
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1927s/iter; left time: 2288.8651s
	iters: 200, epoch: 22 | loss: 0.0502648
	speed: 0.0671s/iter; left time: 790.6860s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 404.8795s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 363.0894s
Epoch: 22 cost time: 20.488726139068604
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000100
	speed: 0.2454s/iter; left time: 2813.3127s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0807s/iter; left time: 917.6447s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0634s/iter; left time: 713.7350s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0788s/iter; left time: 879.6722s
Epoch: 23 cost time: 32.04199957847595
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.982 Test Loss: 0.194 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2285s/iter; left time: 2524.8578s
	iters: 200, epoch: 24 | loss: 0.0000014
	speed: 0.0591s/iter; left time: 647.7993s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0738s/iter; left time: 800.6684s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0732s/iter; left time: 786.8640s
Epoch: 24 cost time: 29.416884899139404
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.982 Test Loss: 0.154 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2540s/iter; left time: 2702.0682s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0487s/iter; left time: 513.5696s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0460s/iter; left time: 479.6974s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0801s/iter; left time: 827.8649s
Epoch: 25 cost time: 26.640350341796875
Epoch: 25, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.981 Test Loss: 0.189 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2939s/iter; left time: 3005.7832s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0830s/iter; left time: 840.6774s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0791s/iter; left time: 792.8686s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0869s/iter; left time: 862.8619s
Epoch: 26 cost time: 34.721757888793945
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.969 Test Loss: 0.350 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2523s/iter; left time: 2475.7062s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0534s/iter; left time: 518.4565s
	iters: 300, epoch: 27 | loss: 0.0611039
	speed: 0.0606s/iter; left time: 582.2480s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 653.9646s
Epoch: 27 cost time: 25.21688723564148
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.976 Test Loss: 0.264 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 22690570
model size : 101.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9168897
	speed: 0.0833s/iter; left time: 1711.0613s
	iters: 200, epoch: 1 | loss: 0.2785168
	speed: 0.0456s/iter; left time: 932.8003s
	iters: 300, epoch: 1 | loss: 0.1032906
	speed: 0.0423s/iter; left time: 861.0131s
	iters: 400, epoch: 1 | loss: 0.0525264
	speed: 0.0505s/iter; left time: 1023.2520s
Epoch: 1 cost time: 22.92397451400757
Epoch: 1, Steps: 413 | Train Loss: 0.589 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0982507
	speed: 0.1949s/iter; left time: 3924.9849s
	iters: 200, epoch: 2 | loss: 0.0499260
	speed: 0.0469s/iter; left time: 938.8319s
	iters: 300, epoch: 2 | loss: 0.0057101
	speed: 0.0627s/iter; left time: 1250.0853s
	iters: 400, epoch: 2 | loss: 0.1321466
	speed: 0.0648s/iter; left time: 1285.4730s
Epoch: 2 cost time: 24.73995614051819
Epoch: 2, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.060 Vali Acc: 0.979 Test Loss: 0.060 Test Acc: 0.979
Validation loss decreased (-0.968166 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0275320
	speed: 0.1931s/iter; left time: 3808.3363s
	iters: 200, epoch: 3 | loss: 0.0014424
	speed: 0.0490s/iter; left time: 961.4464s
	iters: 300, epoch: 3 | loss: 0.0889526
	speed: 0.0378s/iter; left time: 737.6701s
	iters: 400, epoch: 3 | loss: 0.2310908
	speed: 0.0453s/iter; left time: 880.7536s
Epoch: 3 cost time: 19.003284454345703
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0006967
	speed: 0.1623s/iter; left time: 3134.0468s
	iters: 200, epoch: 4 | loss: 0.0000585
	speed: 0.0376s/iter; left time: 723.1285s
	iters: 300, epoch: 4 | loss: 0.0137244
	speed: 0.0480s/iter; left time: 916.4222s
	iters: 400, epoch: 4 | loss: 0.0126337
	speed: 0.0617s/iter; left time: 1173.9285s
Epoch: 4 cost time: 19.6298406124115
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0261691
	speed: 0.1854s/iter; left time: 3503.6256s
	iters: 200, epoch: 5 | loss: 0.0424571
	speed: 0.0523s/iter; left time: 982.9133s
	iters: 300, epoch: 5 | loss: 0.0002705
	speed: 0.0502s/iter; left time: 938.0448s
	iters: 400, epoch: 5 | loss: 0.0006276
	speed: 0.0557s/iter; left time: 1035.6793s
Epoch: 5 cost time: 22.891127586364746
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.056 Vali Acc: 0.982 Test Loss: 0.056 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.982264).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000102
	speed: 0.2086s/iter; left time: 3856.0160s
	iters: 200, epoch: 6 | loss: 0.0002981
	speed: 0.0496s/iter; left time: 911.1785s
	iters: 300, epoch: 6 | loss: 0.0070151
	speed: 0.0398s/iter; left time: 728.5435s
	iters: 400, epoch: 6 | loss: 0.0000199
	speed: 0.0482s/iter; left time: 876.9772s
Epoch: 6 cost time: 19.815166473388672
Epoch: 6, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0012347
	speed: 0.1717s/iter; left time: 3103.6184s
	iters: 200, epoch: 7 | loss: 0.0392096
	speed: 0.0471s/iter; left time: 846.7340s
	iters: 300, epoch: 7 | loss: 0.0004113
	speed: 0.0452s/iter; left time: 807.7750s
	iters: 400, epoch: 7 | loss: 0.0000014
	speed: 0.0335s/iter; left time: 595.7273s
Epoch: 7 cost time: 19.107906341552734
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0694052
	speed: 0.1312s/iter; left time: 2317.1212s
	iters: 200, epoch: 8 | loss: 0.0000517
	speed: 0.0414s/iter; left time: 727.2412s
	iters: 300, epoch: 8 | loss: 0.0000369
	speed: 0.0479s/iter; left time: 835.8921s
	iters: 400, epoch: 8 | loss: 0.0000049
	speed: 0.0434s/iter; left time: 753.9226s
Epoch: 8 cost time: 17.22145438194275
Epoch: 8, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000014
	speed: 0.1327s/iter; left time: 2287.8657s
	iters: 200, epoch: 9 | loss: 0.0001355
	speed: 0.0264s/iter; left time: 453.3036s
	iters: 300, epoch: 9 | loss: 0.0003598
	speed: 0.0354s/iter; left time: 602.7983s
	iters: 400, epoch: 9 | loss: 0.0421931
	speed: 0.0406s/iter; left time: 688.0250s
Epoch: 9 cost time: 14.544891357421875
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1816s/iter; left time: 3057.5058s
	iters: 200, epoch: 10 | loss: 0.0000080
	speed: 0.0556s/iter; left time: 929.8258s
	iters: 300, epoch: 10 | loss: 0.0177179
	speed: 0.0583s/iter; left time: 970.5451s
	iters: 400, epoch: 10 | loss: 0.0000685
	speed: 0.0564s/iter; left time: 932.3254s
Epoch: 10 cost time: 23.8965904712677
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.266 Vali Acc: 0.960 Test Loss: 0.266 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0044127
	speed: 0.1936s/iter; left time: 3179.0820s
	iters: 200, epoch: 11 | loss: 0.0000690
	speed: 0.0495s/iter; left time: 808.6787s
	iters: 300, epoch: 11 | loss: 0.0305206
	speed: 0.0523s/iter; left time: 848.4867s
	iters: 400, epoch: 11 | loss: 0.0000001
	speed: 0.0439s/iter; left time: 708.0514s
Epoch: 11 cost time: 20.831969261169434
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.286 Vali Acc: 0.967 Test Loss: 0.286 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0011280
	speed: 0.1467s/iter; left time: 2347.9645s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.0233s/iter; left time: 370.4746s
	iters: 300, epoch: 12 | loss: 0.0000016
	speed: 0.0241s/iter; left time: 380.6898s
	iters: 400, epoch: 12 | loss: 0.0137347
	speed: 0.0316s/iter; left time: 496.3753s
Epoch: 12 cost time: 12.454214811325073
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0190623
	speed: 0.1170s/iter; left time: 1823.8819s
	iters: 200, epoch: 13 | loss: 0.0000644
	speed: 0.0213s/iter; left time: 330.0126s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.0233s/iter; left time: 359.0280s
	iters: 400, epoch: 13 | loss: 0.0342258
	speed: 0.0185s/iter; left time: 283.2196s
Epoch: 13 cost time: 9.75161337852478
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1358s/iter; left time: 2061.3621s
	iters: 200, epoch: 14 | loss: 0.0000189
	speed: 0.0488s/iter; left time: 735.5953s
	iters: 300, epoch: 14 | loss: 0.0000033
	speed: 0.0476s/iter; left time: 713.4619s
	iters: 400, epoch: 14 | loss: 0.0000222
	speed: 0.0585s/iter; left time: 870.9457s
Epoch: 14 cost time: 21.740676641464233
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0155552
	speed: 0.1796s/iter; left time: 2652.4306s
	iters: 200, epoch: 15 | loss: 0.0000104
	speed: 0.0479s/iter; left time: 703.1826s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0482s/iter; left time: 701.7671s
	iters: 400, epoch: 15 | loss: 0.0026013
	speed: 0.0460s/iter; left time: 665.2292s
Epoch: 15 cost time: 21.155328035354614
Epoch: 15, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 22644490
model size : 101.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4697666
	speed: 0.0981s/iter; left time: 2015.8061s
	iters: 200, epoch: 1 | loss: 0.4225428
	speed: 0.0644s/iter; left time: 1317.3564s
	iters: 300, epoch: 1 | loss: 0.1277488
	speed: 0.0607s/iter; left time: 1236.1151s
	iters: 400, epoch: 1 | loss: 0.0104519
	speed: 0.0939s/iter; left time: 1901.7682s
Epoch: 1 cost time: 32.77554750442505
Epoch: 1, Steps: 413 | Train Loss: 0.492 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7990155
	speed: 0.2413s/iter; left time: 4859.1986s
	iters: 200, epoch: 2 | loss: 0.0128328
	speed: 0.0753s/iter; left time: 1509.3637s
	iters: 300, epoch: 2 | loss: 0.0314608
	speed: 0.0765s/iter; left time: 1525.9452s
	iters: 400, epoch: 2 | loss: 0.1024182
	speed: 0.0462s/iter; left time: 917.4080s
Epoch: 2 cost time: 27.312448501586914
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0052381
	speed: 0.2687s/iter; left time: 5299.8530s
	iters: 200, epoch: 3 | loss: 0.0004864
	speed: 0.0384s/iter; left time: 753.9739s
	iters: 300, epoch: 3 | loss: 0.0379286
	speed: 0.0410s/iter; left time: 799.9544s
	iters: 400, epoch: 3 | loss: 0.0016873
	speed: 0.0429s/iter; left time: 833.9240s
Epoch: 3 cost time: 18.507137298583984
Epoch: 3, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.975897 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002133
	speed: 0.2264s/iter; left time: 4371.7786s
	iters: 200, epoch: 4 | loss: 0.0781819
	speed: 0.0469s/iter; left time: 900.4189s
	iters: 300, epoch: 4 | loss: 0.0008057
	speed: 0.0363s/iter; left time: 693.1915s
	iters: 400, epoch: 4 | loss: 0.0416816
	speed: 0.0366s/iter; left time: 696.1400s
Epoch: 4 cost time: 17.611307382583618
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.248 Vali Acc: 0.963 Test Loss: 0.248 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000047
	speed: 0.1699s/iter; left time: 3211.4576s
	iters: 200, epoch: 5 | loss: 0.0001345
	speed: 0.0580s/iter; left time: 1091.0426s
	iters: 300, epoch: 5 | loss: 0.0000224
	speed: 0.0619s/iter; left time: 1158.2257s
	iters: 400, epoch: 5 | loss: 0.0000074
	speed: 0.0768s/iter; left time: 1428.9678s
Epoch: 5 cost time: 26.064183473587036
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000145
	speed: 0.2236s/iter; left time: 4132.6257s
	iters: 200, epoch: 6 | loss: 0.0000170
	speed: 0.0503s/iter; left time: 923.9973s
	iters: 300, epoch: 6 | loss: 0.0000113
	speed: 0.0236s/iter; left time: 431.8327s
	iters: 400, epoch: 6 | loss: 0.0000221
	speed: 0.0277s/iter; left time: 503.3217s
Epoch: 6 cost time: 17.0046546459198
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000994
	speed: 0.1812s/iter; left time: 3275.1236s
	iters: 200, epoch: 7 | loss: 0.0988813
	speed: 0.0785s/iter; left time: 1411.4220s
	iters: 300, epoch: 7 | loss: 0.0000061
	speed: 0.0750s/iter; left time: 1340.7288s
	iters: 400, epoch: 7 | loss: 0.0137717
	speed: 0.0810s/iter; left time: 1440.4176s
Epoch: 7 cost time: 31.452380418777466
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000046
	speed: 0.2566s/iter; left time: 4532.1196s
	iters: 200, epoch: 8 | loss: 0.0096113
	speed: 0.0813s/iter; left time: 1428.0451s
	iters: 300, epoch: 8 | loss: 0.0000025
	speed: 0.0805s/iter; left time: 1404.9892s
	iters: 400, epoch: 8 | loss: 0.0000200
	speed: 0.0844s/iter; left time: 1465.6421s
Epoch: 8 cost time: 35.27237343788147
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000007
	speed: 0.2420s/iter; left time: 4173.9469s
	iters: 200, epoch: 9 | loss: 0.0000032
	speed: 0.0689s/iter; left time: 1181.4640s
	iters: 300, epoch: 9 | loss: 0.0000130
	speed: 0.0689s/iter; left time: 1174.7890s
	iters: 400, epoch: 9 | loss: 0.0006928
	speed: 0.0632s/iter; left time: 1071.4848s
Epoch: 9 cost time: 27.03989601135254
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0002703
	speed: 0.2525s/iter; left time: 4250.4215s
	iters: 200, epoch: 10 | loss: 0.0076479
	speed: 0.0728s/iter; left time: 1217.7172s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0663s/iter; left time: 1102.1735s
	iters: 400, epoch: 10 | loss: 0.0001390
	speed: 0.0675s/iter; left time: 1115.3563s
Epoch: 10 cost time: 28.994831085205078
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.976 Test Loss: 0.198 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2366s/iter; left time: 3885.4539s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.0392s/iter; left time: 639.0357s
	iters: 300, epoch: 11 | loss: 0.0093256
	speed: 0.0605s/iter; left time: 981.3505s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.0649s/iter; left time: 1046.7370s
Epoch: 11 cost time: 25.139397144317627
Epoch: 11, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.986 Test Loss: 0.119 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.985901).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004384
	speed: 0.1841s/iter; left time: 2946.4777s
	iters: 200, epoch: 12 | loss: 0.0000631
	speed: 0.0446s/iter; left time: 709.8867s
	iters: 300, epoch: 12 | loss: 0.0002015
	speed: 0.0550s/iter; left time: 868.9966s
	iters: 400, epoch: 12 | loss: 0.0004677
	speed: 0.0529s/iter; left time: 830.3418s
Epoch: 12 cost time: 20.476939916610718
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0007293
	speed: 0.2264s/iter; left time: 3530.9430s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.0827s/iter; left time: 1282.0205s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 1103.3841s
	iters: 400, epoch: 13 | loss: 0.2797295
	speed: 0.0568s/iter; left time: 868.1179s
Epoch: 13 cost time: 29.301256895065308
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.980 Test Loss: 0.185 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2645s/iter; left time: 4016.2026s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 998.4194s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.0532s/iter; left time: 796.9101s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.0587s/iter; left time: 874.0357s
Epoch: 14 cost time: 27.26312565803528
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.159 Vali Acc: 0.982 Test Loss: 0.159 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000008
	speed: 0.2266s/iter; left time: 3347.3765s
	iters: 200, epoch: 15 | loss: 0.0000111
	speed: 0.0531s/iter; left time: 778.9785s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0479s/iter; left time: 697.1446s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0358s/iter; left time: 518.1050s
Epoch: 15 cost time: 21.200348615646362
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.266 Vali Acc: 0.980 Test Loss: 0.266 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000072
	speed: 0.1095s/iter; left time: 1571.8183s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 461.4302s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0516s/iter; left time: 730.7334s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 779.0356s
Epoch: 16 cost time: 18.1238374710083
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.986 Test Loss: 0.160 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1921s/iter; left time: 2678.0307s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0540s/iter; left time: 747.3341s
	iters: 300, epoch: 17 | loss: 0.7152168
	speed: 0.0495s/iter; left time: 680.4192s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 601.4282s
Epoch: 17 cost time: 21.21004819869995
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000005
	speed: 0.1743s/iter; left time: 2358.3217s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 705.6400s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0588s/iter; left time: 783.2315s
	iters: 400, epoch: 18 | loss: 0.5541725
	speed: 0.0509s/iter; left time: 673.9525s
Epoch: 18 cost time: 21.70604681968689
Epoch: 18, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.989 Test Loss: 0.163 Test Acc: 0.989
Validation loss decreased (-0.985901 --> -0.988630).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0010315
	speed: 0.2595s/iter; left time: 3403.6123s
	iters: 200, epoch: 19 | loss: 0.0007780
	speed: 0.0690s/iter; left time: 897.9656s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 676.6561s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0617s/iter; left time: 791.1277s
Epoch: 19 cost time: 27.418887853622437
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.981 Test Loss: 0.166 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2352s/iter; left time: 2987.6224s
	iters: 200, epoch: 20 | loss: 0.0013987
	speed: 0.0580s/iter; left time: 730.4238s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.0575s/iter; left time: 718.9675s
	iters: 400, epoch: 20 | loss: 0.0000657
	speed: 0.0663s/iter; left time: 822.6943s
Epoch: 20 cost time: 26.270681381225586
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2072s/iter; left time: 2546.9893s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0621s/iter; left time: 756.6028s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0629s/iter; left time: 760.9575s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 709.5585s
Epoch: 21 cost time: 25.391284227371216
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.986 Test Loss: 0.222 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0167362
	speed: 0.1517s/iter; left time: 1801.8311s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 722.3294s
	iters: 300, epoch: 22 | loss: 0.0000009
	speed: 0.0501s/iter; left time: 584.5825s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 778.6501s
Epoch: 22 cost time: 25.89818572998047
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.989 Test Loss: 0.097 Test Acc: 0.989
Validation loss decreased (-0.988630 --> -0.989085).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2241s/iter; left time: 2569.3814s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 667.7062s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 719.9870s
	iters: 400, epoch: 23 | loss: 0.1465950
	speed: 0.0552s/iter; left time: 616.0113s
Epoch: 23 cost time: 26.20231342315674
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.297 Vali Acc: 0.979 Test Loss: 0.297 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1982s/iter; left time: 2189.9575s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0464s/iter; left time: 508.5608s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0443s/iter; left time: 480.7156s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.0401s/iter; left time: 431.2862s
Epoch: 24 cost time: 19.14239525794983
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.983 Test Loss: 0.243 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2119s/iter; left time: 2254.9326s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0637s/iter; left time: 671.4934s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 672.9682s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.0579s/iter; left time: 598.2461s
Epoch: 25 cost time: 25.38896346092224
Epoch: 25, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.424 Vali Acc: 0.973 Test Loss: 0.424 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.4302352
	speed: 0.2201s/iter; left time: 2250.9844s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 670.7947s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 445.5235s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0503s/iter; left time: 499.1995s
Epoch: 26 cost time: 24.460947513580322
Epoch: 26, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.462 Vali Acc: 0.973 Test Loss: 0.462 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0012980
	speed: 0.2583s/iter; left time: 2534.7642s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 481.7145s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0602s/iter; left time: 578.6122s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 504.3723s
Epoch: 27 cost time: 24.567418575286865
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.983 Test Loss: 0.273 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2089s/iter; left time: 1963.4820s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0673s/iter; left time: 626.2203s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0786s/iter; left time: 723.1877s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0590s/iter; left time: 537.2975s
Epoch: 28 cost time: 28.2816321849823
Epoch: 28, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.981 Test Loss: 0.338 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.2482s/iter; left time: 2230.7202s
	iters: 200, epoch: 29 | loss: 2.1444063
	speed: 0.0628s/iter; left time: 558.3104s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0688s/iter; left time: 604.8759s
	iters: 400, epoch: 29 | loss: 0.7555755
	speed: 0.0718s/iter; left time: 623.3967s
Epoch: 29 cost time: 28.583555459976196
Epoch: 29, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.979 Test Loss: 0.214 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2377s/iter; left time: 2038.1757s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.0519s/iter; left time: 439.8946s
	iters: 300, epoch: 30 | loss: 0.0002387
	speed: 0.0527s/iter; left time: 441.5057s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0681s/iter; left time: 563.8011s
Epoch: 30 cost time: 25.2549786567688
Epoch: 30, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.977 Test Loss: 0.242 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.2187s/iter; left time: 1784.4812s
	iters: 200, epoch: 31 | loss: 0.0000064
	speed: 0.0571s/iter; left time: 460.5454s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0685s/iter; left time: 544.9739s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0592s/iter; left time: 465.6262s
Epoch: 31 cost time: 26.432419776916504
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.984 Test Loss: 0.200 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2219s/iter; left time: 1719.4600s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0755s/iter; left time: 577.4257s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0709s/iter; left time: 535.3217s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0671s/iter; left time: 499.4557s
Epoch: 32 cost time: 28.048308849334717
Epoch: 32, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.981 Test Loss: 0.230 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 22826506
model size : 101.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7263028
	speed: 0.0621s/iter; left time: 1276.9111s
	iters: 200, epoch: 1 | loss: 0.1518849
	speed: 0.0387s/iter; left time: 791.8125s
	iters: 300, epoch: 1 | loss: 0.1953580
	speed: 0.0422s/iter; left time: 858.0696s
	iters: 400, epoch: 1 | loss: 0.1231611
	speed: 0.0491s/iter; left time: 995.1602s
Epoch: 1 cost time: 20.16154146194458
Epoch: 1, Steps: 413 | Train Loss: 0.544 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (inf --> -0.977262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0068666
	speed: 0.1640s/iter; left time: 3301.9069s
	iters: 200, epoch: 2 | loss: 0.0902865
	speed: 0.0351s/iter; left time: 704.0176s
	iters: 300, epoch: 2 | loss: 0.0161363
	speed: 0.0371s/iter; left time: 740.0716s
	iters: 400, epoch: 2 | loss: 0.0015640
	speed: 0.0399s/iter; left time: 792.2175s
Epoch: 2 cost time: 16.010932445526123
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3940119
	speed: 0.1722s/iter; left time: 3397.1451s
	iters: 200, epoch: 3 | loss: 0.0004396
	speed: 0.0449s/iter; left time: 880.5259s
	iters: 300, epoch: 3 | loss: 0.0000592
	speed: 0.0467s/iter; left time: 911.1409s
	iters: 400, epoch: 3 | loss: 0.0097746
	speed: 0.0357s/iter; left time: 693.3910s
Epoch: 3 cost time: 18.25121521949768
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0080303
	speed: 0.1075s/iter; left time: 2076.4161s
	iters: 200, epoch: 4 | loss: 0.0002865
	speed: 0.0247s/iter; left time: 475.2554s
	iters: 300, epoch: 4 | loss: 0.0010960
	speed: 0.0338s/iter; left time: 645.4887s
	iters: 400, epoch: 4 | loss: 0.0027305
	speed: 0.0389s/iter; left time: 739.7412s
Epoch: 4 cost time: 13.287142276763916
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0018600
	speed: 0.1395s/iter; left time: 2636.4325s
	iters: 200, epoch: 5 | loss: 0.0000208
	speed: 0.0366s/iter; left time: 688.3041s
	iters: 300, epoch: 5 | loss: 0.0024657
	speed: 0.0331s/iter; left time: 619.0407s
	iters: 400, epoch: 5 | loss: 0.0005677
	speed: 0.0436s/iter; left time: 811.5967s
Epoch: 5 cost time: 16.450576543807983
Epoch: 5, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.979535).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006588
	speed: 0.1725s/iter; left time: 3189.6016s
	iters: 200, epoch: 6 | loss: 0.0008614
	speed: 0.0273s/iter; left time: 501.6388s
	iters: 300, epoch: 6 | loss: 0.0116992
	speed: 0.0323s/iter; left time: 590.2983s
	iters: 400, epoch: 6 | loss: 0.0000104
	speed: 0.0371s/iter; left time: 675.2419s
Epoch: 6 cost time: 14.993956804275513
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000247
	speed: 0.1200s/iter; left time: 2168.2327s
	iters: 200, epoch: 7 | loss: 0.0000078
	speed: 0.0446s/iter; left time: 800.7750s
	iters: 300, epoch: 7 | loss: 0.0026074
	speed: 0.0309s/iter; left time: 551.9686s
	iters: 400, epoch: 7 | loss: 0.0000303
	speed: 0.0288s/iter; left time: 511.9737s
Epoch: 7 cost time: 15.361358880996704
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0002295
	speed: 0.1307s/iter; left time: 2307.4196s
	iters: 200, epoch: 8 | loss: 0.0002366
	speed: 0.0421s/iter; left time: 738.5056s
	iters: 300, epoch: 8 | loss: 0.0000280
	speed: 0.0396s/iter; left time: 691.1785s
	iters: 400, epoch: 8 | loss: 0.0001387
	speed: 0.0459s/iter; left time: 797.2387s
Epoch: 8 cost time: 17.832823276519775
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0018758
	speed: 0.1502s/iter; left time: 2591.3422s
	iters: 200, epoch: 9 | loss: 0.0053572
	speed: 0.0371s/iter; left time: 635.3184s
	iters: 300, epoch: 9 | loss: 0.0002122
	speed: 0.0377s/iter; left time: 642.1923s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.0401s/iter; left time: 679.3142s
Epoch: 9 cost time: 16.44896674156189
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000352
	speed: 0.1362s/iter; left time: 2292.9527s
	iters: 200, epoch: 10 | loss: 0.0932871
	speed: 0.0394s/iter; left time: 658.7018s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.0449s/iter; left time: 747.3840s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0513s/iter; left time: 848.9131s
Epoch: 10 cost time: 19.678651571273804
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.977 Test Loss: 0.193 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0027306
	speed: 0.1601s/iter; left time: 2628.7769s
	iters: 200, epoch: 11 | loss: 0.0001203
	speed: 0.0469s/iter; left time: 766.0350s
	iters: 300, epoch: 11 | loss: 0.1739189
	speed: 0.0422s/iter; left time: 685.2709s
	iters: 400, epoch: 11 | loss: 0.0001636
	speed: 0.0419s/iter; left time: 676.2247s
Epoch: 11 cost time: 19.3479061126709
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.976 Test Loss: 0.192 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0024663
	speed: 0.1447s/iter; left time: 2316.4845s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.0414s/iter; left time: 658.7095s
	iters: 300, epoch: 12 | loss: 0.0003589
	speed: 0.0298s/iter; left time: 470.5787s
	iters: 400, epoch: 12 | loss: 0.0000047
	speed: 0.0415s/iter; left time: 652.5354s
Epoch: 12 cost time: 16.037216424942017
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.974 Test Loss: 0.197 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1603s/iter; left time: 2500.0200s
	iters: 200, epoch: 13 | loss: 0.0033901
	speed: 0.0417s/iter; left time: 645.5714s
	iters: 300, epoch: 13 | loss: 0.0000120
	speed: 0.0511s/iter; left time: 786.8549s
	iters: 400, epoch: 13 | loss: 0.6623489
	speed: 0.0439s/iter; left time: 670.9169s
Epoch: 13 cost time: 19.31393551826477
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.258 Vali Acc: 0.977 Test Loss: 0.258 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1729s/iter; left time: 2625.6562s
	iters: 200, epoch: 14 | loss: 0.0001151
	speed: 0.0330s/iter; left time: 497.7167s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.0220s/iter; left time: 329.5556s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0214s/iter; left time: 318.6144s
Epoch: 14 cost time: 13.053158283233643
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.981 Test Loss: 0.172 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.981353).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000203
	speed: 0.1868s/iter; left time: 2758.1249s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.0619s/iter; left time: 908.3601s
	iters: 300, epoch: 15 | loss: 0.0000083
	speed: 0.0495s/iter; left time: 721.7608s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.0410s/iter; left time: 592.8128s
Epoch: 15 cost time: 21.733738660812378
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.978 Test Loss: 0.226 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000025
	speed: 0.1800s/iter; left time: 2584.4655s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0344s/iter; left time: 490.5795s
	iters: 300, epoch: 16 | loss: 0.0000198
	speed: 0.0435s/iter; left time: 615.9724s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0591s/iter; left time: 830.7230s
Epoch: 16 cost time: 19.90479278564453
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.973 Test Loss: 0.203 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.1522s/iter; left time: 2121.5895s
	iters: 200, epoch: 17 | loss: 0.0000006
	speed: 0.0359s/iter; left time: 497.1596s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 610.8643s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 719.7708s
Epoch: 17 cost time: 18.83245825767517
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.246 Vali Acc: 0.973 Test Loss: 0.246 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000007
	speed: 0.1227s/iter; left time: 1660.2482s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0252s/iter; left time: 338.1508s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.0496s/iter; left time: 660.8417s
	iters: 400, epoch: 18 | loss: 0.0000004
	speed: 0.0502s/iter; left time: 664.4901s
Epoch: 18 cost time: 16.17418336868286
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.296 Vali Acc: 0.967 Test Loss: 0.296 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000015
	speed: 0.1367s/iter; left time: 1793.0048s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0409s/iter; left time: 532.6364s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0557s/iter; left time: 719.2750s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0555s/iter; left time: 711.8137s
Epoch: 19 cost time: 20.479121685028076
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1500s/iter; left time: 1906.0216s
	iters: 200, epoch: 20 | loss: 0.0004242
	speed: 0.0483s/iter; left time: 608.8723s
	iters: 300, epoch: 20 | loss: 0.0007471
	speed: 0.0554s/iter; left time: 692.2400s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0392s/iter; left time: 485.6752s
Epoch: 20 cost time: 18.890252351760864
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.343 Vali Acc: 0.969 Test Loss: 0.343 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1873s/iter; left time: 2302.0660s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.0524s/iter; left time: 638.4377s
	iters: 300, epoch: 21 | loss: 0.0014917
	speed: 0.0665s/iter; left time: 804.4043s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0383s/iter; left time: 459.0850s
Epoch: 21 cost time: 21.72354245185852
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1604s/iter; left time: 1904.8170s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 658.1930s
	iters: 300, epoch: 22 | loss: 0.1208740
	speed: 0.0638s/iter; left time: 744.5905s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0687s/iter; left time: 795.8191s
Epoch: 22 cost time: 25.985630750656128
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.974 Test Loss: 0.222 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2022s/iter; left time: 2318.0531s
	iters: 200, epoch: 23 | loss: 0.0001476
	speed: 0.0591s/iter; left time: 671.4425s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 693.6916s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0676s/iter; left time: 754.2625s
Epoch: 23 cost time: 27.090436697006226
Epoch: 23, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1723s/iter; left time: 1904.0190s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.0443s/iter; left time: 485.4711s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0431s/iter; left time: 468.2311s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0434s/iter; left time: 466.2226s
Epoch: 24 cost time: 19.230043649673462
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.358 Vali Acc: 0.968 Test Loss: 0.358 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 22761994
model size : 101.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0314553
	speed: 0.0719s/iter; left time: 1478.6120s
	iters: 200, epoch: 1 | loss: 0.3502094
	speed: 0.0412s/iter; left time: 842.5787s
	iters: 300, epoch: 1 | loss: 0.0887941
	speed: 0.0469s/iter; left time: 955.4282s
	iters: 400, epoch: 1 | loss: 0.3670580
	speed: 0.0422s/iter; left time: 853.7957s
Epoch: 1 cost time: 21.10737705230713
Epoch: 1, Steps: 413 | Train Loss: 0.582 Vali Loss: 0.085 Vali Acc: 0.969 Test Loss: 0.085 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1795088
	speed: 0.1672s/iter; left time: 3366.2482s
	iters: 200, epoch: 2 | loss: 0.0382847
	speed: 0.0437s/iter; left time: 874.6646s
	iters: 300, epoch: 2 | loss: 0.0093351
	speed: 0.0425s/iter; left time: 848.2554s
	iters: 400, epoch: 2 | loss: 0.0863227
	speed: 0.0508s/iter; left time: 1008.2522s
Epoch: 2 cost time: 19.689998865127563
Epoch: 2, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.968621 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0276974
	speed: 0.2284s/iter; left time: 4505.3987s
	iters: 200, epoch: 3 | loss: 0.0003406
	speed: 0.0487s/iter; left time: 955.4861s
	iters: 300, epoch: 3 | loss: 0.0515287
	speed: 0.0498s/iter; left time: 971.4346s
	iters: 400, epoch: 3 | loss: 0.0138923
	speed: 0.0520s/iter; left time: 1009.9766s
Epoch: 3 cost time: 20.21331000328064
Epoch: 3, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.972 Test Loss: 0.078 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0624640
	speed: 0.1491s/iter; left time: 2880.0790s
	iters: 200, epoch: 4 | loss: 0.0678560
	speed: 0.0442s/iter; left time: 849.0005s
	iters: 300, epoch: 4 | loss: 0.0002885
	speed: 0.0493s/iter; left time: 941.5928s
	iters: 400, epoch: 4 | loss: 0.0279527
	speed: 0.0453s/iter; left time: 861.6612s
Epoch: 4 cost time: 19.150579929351807
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0804944
	speed: 0.1521s/iter; left time: 2873.9620s
	iters: 200, epoch: 5 | loss: 0.0000671
	speed: 0.0533s/iter; left time: 1001.4033s
	iters: 300, epoch: 5 | loss: 0.0026979
	speed: 0.0489s/iter; left time: 913.4847s
	iters: 400, epoch: 5 | loss: 0.0027055
	speed: 0.0377s/iter; left time: 701.6570s
Epoch: 5 cost time: 20.33240294456482
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001107
	speed: 0.1541s/iter; left time: 2849.1003s
	iters: 200, epoch: 6 | loss: 0.0011552
	speed: 0.0368s/iter; left time: 676.1342s
	iters: 300, epoch: 6 | loss: 0.0780548
	speed: 0.0447s/iter; left time: 817.0778s
	iters: 400, epoch: 6 | loss: 0.0000486
	speed: 0.0468s/iter; left time: 850.3483s
Epoch: 6 cost time: 17.845790147781372
Epoch: 6, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0005246
	speed: 0.1529s/iter; left time: 2764.0432s
	iters: 200, epoch: 7 | loss: 0.0009701
	speed: 0.0368s/iter; left time: 662.1806s
	iters: 300, epoch: 7 | loss: 0.0007840
	speed: 0.0344s/iter; left time: 614.2243s
	iters: 400, epoch: 7 | loss: 0.0049699
	speed: 0.0425s/iter; left time: 755.7985s
Epoch: 7 cost time: 16.252471208572388
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000637
	speed: 0.1866s/iter; left time: 3294.9278s
	iters: 200, epoch: 8 | loss: 0.0006247
	speed: 0.0508s/iter; left time: 892.0337s
	iters: 300, epoch: 8 | loss: 0.0000275
	speed: 0.0463s/iter; left time: 809.2047s
	iters: 400, epoch: 8 | loss: 0.0001072
	speed: 0.0475s/iter; left time: 824.0765s
Epoch: 8 cost time: 21.15698218345642
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.966 Test Loss: 0.225 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1219563
	speed: 0.1582s/iter; left time: 2728.6168s
	iters: 200, epoch: 9 | loss: 0.0001867
	speed: 0.0442s/iter; left time: 758.3124s
	iters: 300, epoch: 9 | loss: 0.0000038
	speed: 0.0370s/iter; left time: 630.9399s
	iters: 400, epoch: 9 | loss: 0.0002167
	speed: 0.0349s/iter; left time: 590.8645s
Epoch: 9 cost time: 17.045628786087036
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.984 Test Loss: 0.090 Test Acc: 0.984
Validation loss decreased (-0.976807 --> -0.983628).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000320
	speed: 0.2762s/iter; left time: 4649.1800s
	iters: 200, epoch: 10 | loss: 0.0000740
	speed: 0.0456s/iter; left time: 763.4409s
	iters: 300, epoch: 10 | loss: 0.0000015
	speed: 0.0360s/iter; left time: 598.5023s
	iters: 400, epoch: 10 | loss: 0.0002843
	speed: 0.0326s/iter; left time: 538.3720s
Epoch: 10 cost time: 16.276040077209473
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0012347
	speed: 0.1082s/iter; left time: 1776.3355s
	iters: 200, epoch: 11 | loss: 0.0071296
	speed: 0.0369s/iter; left time: 602.4748s
	iters: 300, epoch: 11 | loss: 0.0773880
	speed: 0.0500s/iter; left time: 810.7573s
	iters: 400, epoch: 11 | loss: 0.0000210
	speed: 0.0433s/iter; left time: 698.6621s
Epoch: 11 cost time: 16.563602924346924
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000073
	speed: 0.1307s/iter; left time: 2091.6948s
	iters: 200, epoch: 12 | loss: 0.0000146
	speed: 0.0345s/iter; left time: 548.9770s
	iters: 300, epoch: 12 | loss: 0.0000044
	speed: 0.0433s/iter; left time: 684.7649s
	iters: 400, epoch: 12 | loss: 0.0141641
	speed: 0.0386s/iter; left time: 606.1696s
Epoch: 12 cost time: 16.132522583007812
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000004
	speed: 0.1170s/iter; left time: 1823.9548s
	iters: 200, epoch: 13 | loss: 0.0161189
	speed: 0.0285s/iter; left time: 441.9326s
	iters: 300, epoch: 13 | loss: 0.0000906
	speed: 0.0292s/iter; left time: 449.7091s
	iters: 400, epoch: 13 | loss: 0.0000111
	speed: 0.0237s/iter; left time: 362.7186s
Epoch: 13 cost time: 11.689575910568237
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000242
	speed: 0.0892s/iter; left time: 1353.7787s
	iters: 200, epoch: 14 | loss: 0.0000185
	speed: 0.0302s/iter; left time: 455.8288s
	iters: 300, epoch: 14 | loss: 0.0003325
	speed: 0.0369s/iter; left time: 552.7021s
	iters: 400, epoch: 14 | loss: 0.0011001
	speed: 0.0357s/iter; left time: 531.7710s
Epoch: 14 cost time: 14.353507041931152
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000049
	speed: 0.1501s/iter; left time: 2216.1110s
	iters: 200, epoch: 15 | loss: 0.0000057
	speed: 0.0484s/iter; left time: 710.5613s
	iters: 300, epoch: 15 | loss: 0.0000013
	speed: 0.0422s/iter; left time: 615.1732s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.0398s/iter; left time: 575.8398s
Epoch: 15 cost time: 18.546263933181763
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1014078
	speed: 0.1482s/iter; left time: 2127.7155s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.0347s/iter; left time: 495.3722s
	iters: 300, epoch: 16 | loss: 0.0000009
	speed: 0.0436s/iter; left time: 617.4887s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.0404s/iter; left time: 568.0221s
Epoch: 16 cost time: 16.433069229125977
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000012
	speed: 0.1366s/iter; left time: 1904.1396s
	iters: 200, epoch: 17 | loss: 0.0000058
	speed: 0.0409s/iter; left time: 566.5346s
	iters: 300, epoch: 17 | loss: 0.0003418
	speed: 0.0358s/iter; left time: 492.2606s
	iters: 400, epoch: 17 | loss: 0.0000017
	speed: 0.0460s/iter; left time: 627.8795s
Epoch: 17 cost time: 17.29065728187561
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1577s/iter; left time: 2133.8684s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.0408s/iter; left time: 548.3723s
	iters: 300, epoch: 18 | loss: 0.0003496
	speed: 0.0415s/iter; left time: 553.3388s
	iters: 400, epoch: 18 | loss: 0.0000608
	speed: 0.0445s/iter; left time: 588.0848s
Epoch: 18 cost time: 18.363484859466553
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.142 Vali Acc: 0.979 Test Loss: 0.142 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1576s/iter; left time: 2067.0613s
	iters: 200, epoch: 19 | loss: 0.0000002
	speed: 0.0366s/iter; left time: 476.5268s
	iters: 300, epoch: 19 | loss: 0.0000004
	speed: 0.0388s/iter; left time: 500.8094s
	iters: 400, epoch: 19 | loss: 0.0000246
	speed: 0.0397s/iter; left time: 508.4970s
Epoch: 19 cost time: 17.08708620071411
Epoch: 19, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.979 Test Loss: 0.147 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_GPT4TS_UEA_ftM_sl93_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 22725130
model size : 101.36MB
